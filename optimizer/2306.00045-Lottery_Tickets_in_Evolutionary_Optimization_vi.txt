# Vé Số Trong Tối Ưu Hóa Tiến Hóa:
Về Khả Năng Huấn Luyện Thưa Thớt Không Cần Lan Truyền Ngược

**Tóm tắt**

Hiện tượng vé số có phải là một đặc điểm riêng của việc huấn luyện dựa trên gradient hay nó có thể tổng quát hóa sang tối ưu hóa tiến hóa? Trong bài báo này, chúng tôi thiết lập sự tồn tại của các khởi tạo thưa thớt có thể huấn luyện được cho các chiến lược tiến hóa (ES) và đặc trưng hóa những khác biệt định tính so với việc huấn luyện thưa thớt dựa trên gradient descent (GD). Chúng tôi giới thiệu một quy trình cắt tỉa lặp mới dựa trên tỷ lệ tín hiệu trên nhiễu, kết hợp thông tin độ cong của hàm mất mát vào bước cắt tỉa mạng. Điều này có thể cho phép khám phá các khởi tạo mạng có thể huấn luyện được thưa thớt hơn khi sử dụng tiến hóa hộp đen so với tối ưu hóa dựa trên GD. Hơn nữa, chúng tôi thấy rằng các khởi tạo này mã hóa một thiên kiến quy nạp, có thể chuyển giao giữa các ES khác nhau, các tác vụ liên quan và thậm chí sang việc huấn luyện dựa trên GD. Cuối cùng, chúng tôi so sánh các tối ưu cục bộ thu được từ các mô hình tối ưu hóa khác nhau và mức độ thưa thớt. Trái ngược với GD, ES khám phá các tối ưu cục bộ đa dạng và phẳng, không bảo toàn kết nối tuyến tính giữa các mức độ thưa thớt và các lần chạy độc lập. Kết quả làm nổi bật những khác biệt định tính giữa động lực học tập tiến hóa và dựa trên gradient, có thể được khám phá thông qua nghiên cứu các quy trình cắt tỉa lặp.

**1. Giới thiệu**

Các chiến lược tiến hóa gần đây đã cho thấy cung cấp một giải pháp thay thế cạnh tranh cho việc huấn luyện mạng nơ-ron dựa trên gradient. Thay vì giả định quyền truy cập tường minh vào việc đánh giá gradient, ES tinh chỉnh các thống kê đầy đủ của một phân phối tìm kiếm bằng cách sử dụng thông tin thu thập từ việc đánh giá hộp đen của các giải pháp ứng viên được lấy mẫu. Khi làm như vậy, các ES hiện đại phải đối mặt với một số thách thức về mở rộng: Yêu cầu bộ nhớ để đánh giá quần thể các mạng lớn nhanh chóng trở nên không khả thi đối với các thiết lập phần cứng thông thường. Hơn nữa, việc ước tính hiệp phương sai tìm kiếm thường không hiệu quả về mặt thống kê. Nhưng liệu có thực sự cần thiết phải tiến hóa các mạng dày đặc hoàn chỉnh hay những thách thức này về nguyên tắc có thể được khắc phục bằng cách tiến hóa các mạng thưa thớt? Giả thuyết vé số gần đây đã thiết lập thực nghiệm sự tồn tại của các khởi tạo mạng thưa thớt có thể được huấn luyện đến mức hiệu suất tương tự như các đối tác dày đặc của chúng. Trong nghiên cứu này, chúng tôi bắt đầu trả lời liệu sự tồn tại của các khởi tạo thắng cuộc như vậy có liên quan cơ bản đến việc huấn luyện dựa trên gradient hay khả năng huấn luyện thưa thớt cũng có thể đạt được trong bối cảnh ES. Hơn nữa, LTH đã chứng minh một ứng dụng khác của việc nghiên cứu khả năng huấn luyện thưa thớt: Phân tích thực nghiệm về động lực học tập và bề mặt mất mát. Do đó, chúng tôi làm sáng tỏ những khác biệt giữa gradient descent và tối ưu hóa tiến hóa. Evci và cộng sự đã chỉ ra rằng các vé số thưa thớt bị giảm dòng gradient. Các vé số dựa trên GD vượt qua hạn chế này bằng cách thiên lệch mạng để huấn luyện lại về giải pháp dày đặc ban đầu. Nhưng liệu "diễn giải vé regurgitating" này cũng có áp dụng cho việc tối ưu hóa không cần gradient không? Chúng tôi tóm tắt đóng góp của mình như sau:

1. Chúng tôi áp dụng cắt tỉa độ lớn lặp (IMP) cho cài đặt ES và thiết lập sự tồn tại của các khởi tạo có thể tiến hóa được rất thưa thớt. Chúng tồn tại một cách nhất quán trên các ES khác nhau, kiến trúc (perceptron đa lớp/MLP và mạng nơ-ron tích chập/CNN) và tác vụ (9 tác vụ điều khiển và 3 tác vụ thị giác). Do đó, hiện tượng LTH không phụ thuộc vào việc huấn luyện dựa trên gradient hoặc dòng gradient có mặt nạ được ngụ ý.

2. Chúng tôi giới thiệu một quy trình cắt tỉa lặp mới dựa trên tỷ lệ tín hiệu trên nhiễu (SNR) của phân phối tìm kiếm ES, chiếm thông tin hình học mất mát được mã hóa bởi hiệp phương sai tìm kiếm. Lược đồ cắt tỉa này dẫn đến các khởi tạo có thể huấn luyện được ở mức độ thưa thớt cao hơn.

3. Các vé ES vượt trội so với các khởi tạo ngẫu nhiên thưa thớt khi được chuyển giao sang các tác vụ liên quan. Chúng có thể được chuyển giao giữa các chiến lược tiến hóa khác nhau và sang việc huấn luyện dựa trên GD. Do đó, các vé ES không overfit với mô hình huấn luyện hoặc cài đặt tác vụ của chúng. Thay vào đó, chúng nắm bắt các thiên kiến quy nạp tương đối tổng quát về tác vụ, có thể được phân bổ trong các cài đặt khác nhau.

4. Các vé số dựa trên GD không phù hợp để huấn luyện các mạng nơ-ron có kích thước vừa phải ở mức độ thưa thớt rất cao. Mặt khác, đối với các vé số dẫn xuất từ ES, chúng tôi thấy rằng chúng vẫn có thể huấn luyện được ở mức thưa thớt rất cao. Đối với các tác vụ dựa trên thị giác, sự suy giảm hiệu suất của GD tăng tốc và tương quan với sự gia tăng mạnh độ sắc nét của các tối ưu cục bộ thu được. Ngược lại, các tối ưu ES vẫn phẳng ở mức thưa thớt cao hơn.

5. Trong khi các khởi tạo vé được huấn luyện dựa trên GD bảo toàn kết nối chế độ tuyến tính ở mức thưa thớt thấp, các vé ES thì không. Thay vào đó, chúng hội tụ về một tập hợp đa dạng các tối ưu cục bộ phẳng trên các mức độ thưa thớt. Điều này đặt câu hỏi về "diễn giải vé regurgitation" và thiên kiến cảnh quan mất mát ngầm của các vé dựa trên ES: Các vé ES tồn tại mặc dù thực tế là chúng không liên tục hội tụ về cùng một lưu vực mất mát. Điều này làm nổi bật tiềm năng của các phương pháp ensemble dựa trên ES để bù đắp cho quy trình cắt tỉa đắt đỏ.

**2. Bối cảnh & Quy trình Cắt tỉa SNR**

**Cắt tỉa Độ lớn Lặp trong Học sâu.** Các khởi tạo vé số truyền thống được tìm thấy bằng cách sử dụng một quy trình cắt tỉa lặp đắt đỏ: Cho một khởi tạo mạng dày đặc θ₀, người ta huấn luyện các tham số bằng GD. Các trọng số cuối cùng θ sau đó được sử dụng để xây dựng một mặt nạ nhị phân m dựa trên một heuristic đơn giản: Cắt tỉa phần p∈(0,1) của các trọng số có độ lớn nhỏ nhất. Ngưỡng cắt được xây dựng toàn cục và do đó ngụ ý một tỷ lệ cắt tỉa khác nhau cho mỗi lớp. Sau đó, người ta đặt lại các trọng số còn lại về khởi tạo ban đầu của chúng và lặp lại quy trình bằng cách sử dụng các trọng số khác không còn lại, m⊙θ₀. Hiệu ứng vé cho một mức độ thưa thớt nhất định (1-p)ᵏ có thể được đo bằng sự khác biệt hiệu suất giữa một mạng được cắt tỉa ngẫu nhiên có độ thưa thớt phù hợp và khởi tạo IMP tương ứng, mᵏ⊙θ₀. Trước đây, đã được chỉ ra rằng một hiệu ứng vé tích cực có thể được quan sát thông qua các mô hình huấn luyện dựa trên GD khác nhau bao gồm thị giác máy tính, học tăng cường, xử lý ngôn ngữ tự nhiên, mạng nơ-ron đồ thị và mô hình sinh. Trái ngược với công trình trước đây, chúng tôi điều tra liệu hiện tượng vé số có phải là một hiện tượng đặc thù cho tối ưu hóa dựa trên gradient hay không.

**Chiến lược Tiến hóa.** ES tạo thành một tập hợp các thuật toán tìm kiếm ngẫu nhiên dựa trên các nguyên tắc tiến hóa sinh học. Chúng thích ứng một phân phối được tham số hóa để lặp lại tìm kiếm các giải pháp có hiệu suất tốt. Sau khi lấy mẫu một quần thể ứng viên, độ thích nghi của chúng được ước tính bằng cách sử dụng các đánh giá Monte Carlo (MC). Các điểm số kết quả được sử dụng để cập nhật phân phối tìm kiếm. Chúng tôi tập trung vào hai lớp ES đại diện, đã được sử dụng trong neuroevolution.

**ES dựa trên Sai phân Hữu hạn:** Một tập con của ES sử dụng các nhiễu loạn ngẫu nhiên để ước tính MC một gradient sai phân hữu hạn. Ước tính này sau đó được sử dụng cùng với các trình tối ưu hóa dựa trên GD tiêu chuẩn để tinh chỉnh trung bình phân phối tìm kiếm θ. Chúng khác nhau trong việc sử dụng định hình độ thích nghi, nhiễu phản tương quan, lựa chọn ưu tú và cấu trúc hiệp phương sai.

**ES Ước tính Phân phối:** Một lớp ES thứ hai không dựa vào nhiễu loạn nhiễu hoặc xấp xỉ chiều thấp đến gradient độ thích nghi. Thay vào đó, các thuật toán như CMA-ES dựa vào cập nhật trung bình có trọng số ưu tú và ước tính ma trận hiệp phương sai lặp. Chúng nhằm mục đích chuyển phân phối tìm kiếm theo hướng tối đa hóa khả năng cải thiện độ thích nghi.

**Độ thưa thớt & Cắt tỉa trong Tối ưu hóa Không có Gradient.** Thuật toán NEAT đồng tiến hóa kiến trúc mạng và trọng số của chúng. Kết nối được thay đổi trong suốt quy trình, thường dẫn đến sự xuất hiện tự nhiên của các kiến trúc thưa thớt. Mocanu và cộng sự đã sử dụng một thuật toán huấn luyện thưa thớt động lấy cảm hứng từ nguyên tắc tiến hóa để huấn luyện mạng với cấu trúc linh hoạt động. Cuối cùng, Mocanu và cộng sự đã điều tra hiệu suất của các Máy Boltzmann thưa thớt, không dựa vào tính toán gradient thông qua lan truyền ngược. Ở đây, chúng tôi điều tra khả năng huấn luyện thưa thớt của các mạng nơ-ron tĩnh khác và LTH trong ES.

**Tìm kiếm Vé số trong Chiến lược Tiến hóa.** Chúng tôi giới thiệu một quy trình cắt tỉa lặp tổng quát hóa ES và tập trung vào các chiến lược tìm kiếm thích ứng thống kê đầy đủ của phân phối Gaussian đường chéo đa biến. Tại mỗi lần lặp cắt tỉa, khởi tạo trung bình được cắt tỉa dựa trên ước tính cuối cùng của nó. Hơn nữa, chúng tôi xem xét một heuristic cắt tỉa tỷ lệ tín hiệu trên nhiễu, cắt tỉa trọng số dựa trên tỷ lệ độ lớn trung bình và độ lệch chuẩn của phân phối tìm kiếm, |θ|/σ. Cắt tỉa SNR ngầm kết hợp thông tin về hình học/độ cong mất mát vào việc thưa thớt hóa. Quy trình được tóm tắt trong Thuật toán 1.

Quan trọng là, cắt tỉa cho ES làm giảm yêu cầu bộ nhớ do chiều nhỏ hơn của các ước tính trung bình và hiệp phương sai được lưu trữ. Trong khi hầu hết ES khởi tạo trung bình tìm kiếm ở zero, chúng tôi thay vào đó lấy mẫu khởi tạo theo các khởi tạo mạng tiêu chuẩn cho phép một hiệu ứng khởi tạo. Điều này đảm bảo khả năng so sánh giữa cắt tỉa lặp dựa trên GD và ES. Trong văn bản chính, chúng tôi chủ yếu tập trung vào 4 ES bao gồm PGPE, SNES, Sep-CMA-ES và DES. Tất cả chúng đều sử dụng hiệp phương sai đường chéo, cho phép tính toán SNR cụ thể cho trọng số được sử dụng để tính ngưỡng cắt tỉa. Tất cả các thuật toán huấn luyện ES và GD đều được điều chỉnh bằng cách sử dụng cùng một lượng tính toán.

**Đo lường Đóng góp Hiệu ứng Vé.** Hiệu ứng vé có thể được phân tách thành ba thành phần: Mặt nạ dẫn xuất từ cắt tỉa, khởi tạo ngụ ý của các trọng số không bị cắt tỉa còn lại, và tỷ lệ cắt tỉa theo lớp. Vischer và cộng sự đã đề xuất ước tính mỗi đóng góp bằng cách sử dụng một tập hợp các thí nghiệm hoán vị. Bằng cách hoán vị các trọng số không bị che tại mỗi lần lặp cắt tỉa, người ta có thể ước tính đóng góp của khởi tạo trọng số được trích xuất. Nếu hiệu suất của các mạng thưa thớt vẫn không bị tổn hại, hiệu ứng trọng số là nhỏ. Nếu thêm vào đó việc hoán vị mặt nạ nhị phân làm tổn hại đáng kể khả năng huấn luyện, hiệu ứng mặt nạ là lớn. Cuối cùng, việc so sánh một mạng được cắt tỉa ngẫu nhiên với đường cơ sở hoán vị kép cho phép chúng tôi ước tính tác động của tỷ lệ cắt tỉa theo lớp được ngụ ý bởi cắt tỉa lặp. Trong công trình này, chúng tôi thêm xem xét khoảng cách giữa các khởi tạo mạng được cắt tỉa IMP và SNR. Sự khác biệt có thể được quy cho thông tin kết quả từ ước tính độ cong của hiệp phương sai ES.

**3. Khởi tạo Vé số Thắng cuộc Tồn tại cho Tối ưu hóa Tiến hóa**

Công trình trước đây gợi ý rằng các khởi tạo vé GD vượt qua việc giảm dòng gradient do thưa thớt bằng cách thiên lệch khởi tạo để huấn luyện lại về cùng một lưu vực mất mát. Cho rằng ES dễ bị tính ngẫu nhiên cao hơn trong quá trình học tập, có khả năng hội tụ về các lưu vực mất mát đa dạng hơn, đặt ra câu hỏi liệu hiện tượng LTH có phải là duy nhất đối với huấn luyện GD sử dụng lan truyền ngược hay không.

Để điều tra câu hỏi này, chúng tôi bắt đầu bằng cách đánh giá một cách toàn diện sự tồn tại của các vé số thắng cuộc trong ES. Chúng tôi tập trung vào 12 tác vụ, các kiến trúc mạng khác nhau và 3 ES: Đầu tiên, chúng tôi tiến hóa các tác nhân MLP (1 đến 3 lớp) trên 9 tác vụ Học tăng cường tập trung vào thiết lập điều khiển liên tục. Chúng tôi tiến hóa các tác nhân để tối đa hóa lợi nhuận theo tập phim sử dụng Sep-CMA-ES, SNES và PGPE. Các môi trường được thực hiện bởi gói Brax và việc đánh giá tác nhân được thực hiện bằng cách sử dụng lợi nhuận trung bình trên một tập hợp các tập phim thử nghiệm. Tiếp theo, chúng tôi tiến hóa các kiến trúc CNN trên cả các tác vụ phân loại chữ số MNIST, Fashion-MNIST (F-MNIST) và Kuzushiji-MNIST (K-MNIST) tiêu chuẩn và để tối thiểu hóa mất mát cross-entropy. Trong trường hợp này, chúng tôi đánh giá hiệu suất thông qua độ chính xác kiểm tra của thống kê tìm kiếm trung bình cuối cùng θG,t. Đối với mỗi kết hợp tác vụ-mạng-ES, chúng tôi chạy quy trình cắt tỉa thích ứng ES và cắt tỉa tại mỗi lần lặp 20 phần trăm của các trọng số không bị cắt tỉa còn lại (p = 0.2). Để đảm bảo khả năng huấn luyện ở mức độ thưa thớt cao hơn, chúng tôi đã hiệu chỉnh một cách hào phóng số lượng thế hệ ES.

**Các vé số thắng cuộc tồn tại một cách nhất quán cho nhiều ES khác nhau.** Chúng tôi thấy rằng cấu hình vé số dựa trên độ lớn vượt trội so với đường cơ sở khởi tạo lại ngẫu nhiên trên phần lớn các tác vụ, kiến trúc mạng và kết hợp ES. Trong khi hiệu ứng định tính mạnh mẽ trên hầu hết các cài đặt, độ lớn định lượng khác nhau đáng kể giữa các độ phức tạp tác vụ và mức độ over-parametrization mạng: Đối với phân loại đơn giản hơn và tác vụ con lắc, hiệu ứng vé quan sát được lớn so với các tác vụ điều khiển phức tạp hơn như HalfCheetah và tác vụ Hopper. Điều này chỉ ra mối quan hệ giữa độ phức tạp tác vụ và việc over-parametrization cần thiết để đạt hiệu suất cao.

**IMP dựa trên SNR dẫn đến các vé có thể huấn luyện thưa thớt hơn.** Tiếp theo, chúng tôi so sánh các vé số ES kết quả từ cắt tỉa dựa trên độ lớn và SNR. Chúng tôi thấy rằng các vé dẫn xuất từ SNR có thể huấn luyện một cách nhất quán ở mức độ thưa thớt cao hơn. Độ lệch chuẩn tìm kiếm của một trọng số cụ thể gián tiếp kết hợp thông tin về hình học cảnh quan mất mát cục bộ. Một cách trực quan, các trọng số có độ lệch chuẩn liên quan cao ngụ ý khả năng chống chịu mạnh đối với nhiễu loạn và do đó một hướng phẳng trong bề mặt mất mát. Do đó, chúng tôi có thể mong đợi các trọng số có SNR tương đối nhỏ có đóng góp hiệu suất không đáng kể.

**Khả năng huấn luyện rất thưa thớt có thể đạt được bằng ES.** Chúng tôi so sánh hiệu suất của IMP dựa trên GD và cắt tỉa SNR dựa trên ES. Chúng tôi thấy rằng các khởi tạo ES thưa thớt có khả năng vượt trội so với các phương pháp huấn luyện dựa trên GD trên một số tác vụ. Quan trọng hơn, chúng tôi quan sát thấy rằng các phương pháp dựa trên ES mạnh mẽ hơn trong việc huấn luyện các mạng rất thưa thớt. Đối với các tác vụ điều khiển, ES cũng có thể vượt trội so với GD cho các mức độ thưa thớt vừa phải. Đối với các tác vụ dựa trên thị giác, mặt khác, GD-IMP bắt đầu suy giảm hiệu suất nhanh hơn khi độ thưa thớt tăng.

Tóm lại, các vé số thắng cuộc có thể được xác định cho các ES không cần gradient khác nhau, tác vụ và kiến trúc. Kích thước của hiệu ứng vé quan sát được và do đó khả năng huấn luyện thưa thớt có thể được cải thiện bằng cách xem xét không chỉ độ lớn trung bình mà còn cả hiệp phương sai như một sự phản ánh của độ cong mất mát. Hiện tượng chung về khả năng huấn luyện thưa thớt của mạng nơ-ron, do đó, không phải là duy nhất đối với gradient descent và tổng quát hóa sang các thuật toán có tính ngẫu nhiên cao hơn về bản chất. Kích thước hiệu ứng và các đóng góp cơ bản nhạy cảm với tác vụ và mạng nhưng phần lớn mạnh mẽ đối với lược đồ tối ưu hóa. Cuối cùng, ES huấn luyện một cách nhất quán đến hiệu suất cao hơn ở mức độ thưa thớt cao.

**4. Các Vé số dựa trên ES Chuyển giao giữa Tác vụ, ES và sang Huấn luyện dựa trên GD**

Việc tạo ra các vé thắng cuộc dựa trên cắt tỉa lặp là một quy trình tốn kém đòi hỏi việc tiến hóa tuần tự các khởi tạo mạng ở các mức độ thưa thớt khác nhau. Do đó, nó vẫn không thực tế cho hầu hết các ứng dụng thế giới thực. Nhưng liệu có thể phân bổ việc tạo vé tốn kém cho một tác vụ bằng cách áp dụng thành công nó cho một tác vụ khác không? Công trình trước đây cho thấy rằng mặt nạ lớp đầu vào dẫn xuất từ GD-IMP nắm bắt thông tin cụ thể về tác vụ, loại bỏ các chiều không liên quan đến tác vụ. Chúng tôi tự hỏi liệu các vé ES có trích xuất các thiên kiến quy nạp hữu ích có thể chuyển giao tương tự hay chúng có overfit với cài đặt tạo ra của chúng (tức là, tác vụ, thuật toán ES hoặc mô hình huấn luyện). Nếu chúng vẫn có thể chuyển giao, chúng tôi có thể hy vọng cho một ứng dụng tổng quát về tác vụ của các khởi tạo vé thưa thớt trong bối cảnh ES.

Chúng tôi bắt đầu bằng cách kiểm tra khả năng chuyển giao của các khởi tạo dựa trên SNR được tạo ra với cắt tỉa SNR dựa trên ES sang các tác vụ mới chưa được thấy nhưng có liên quan. Chúng tôi lấy cảm hứng từ công trình của Morcos và cộng sự và huấn luyện lại các khởi tạo thưa thớt được tạo ra cho một cấu hình tác vụ-ES trên một cài đặt khác với kiến trúc mạng được chia sẻ.

**Các vé ES thắng cuộc có thể được chuyển giao sang các tác vụ liên quan.** Việc chuyển giao khởi tạo vé dẫn xuất từ một tác vụ liên quan cải thiện hiệu suất của một mạng được huấn luyện trên một tác vụ 'anh em' mới. Hiệu ứng được đo bằng sự khác biệt hiệu suất của các khởi tạo được chuyển giao và đường cơ sở cắt tỉa ngẫu nhiên là đáng kể trên cả hai tác vụ được xem xét. Vé được chuyển giao không vượt trội so với vé số SNR bản địa của tác vụ (ở độ thưa thớt cao), chỉ ra rằng các vé có xu hướng nắm bắt cả thông tin tổng quát và cụ thể về tác vụ. Hiệu ứng chuyển giao tích cực này có thể được quan sát cho cả tác vụ điều khiển (MLP) và thị giác (CNN).

Tiếp theo, chúng tôi điều tra liệu có thể tiến hóa các khởi tạo thưa thớt được tạo ra bởi một chiến lược tiến hóa với một chiến lược tối ưu hóa khác hay không. Chúng tôi xem xét việc chuyển giao trong lớp ES dựa trên sai phân hữu hạn, sang một ES kiểu thích ứng ma trận hiệp phương sai và sang huấn luyện dựa trên GD.

**Các vé ES thắng cuộc có thể được chuyển giao giữa các ES.** Các khởi tạo vé cũng chuyển giao tốt giữa các thuật toán tối ưu hóa ES khác nhau. Thường thì các khởi tạo được chuyển giao huấn luyện đến cùng mức hiệu suất của khởi tạo vé cụ thể ES, chỉ ra rằng việc chuyển giao trong tác vụ dễ dàng hơn so với cài đặt giữa các tác vụ trước đó. Quan sát này một lần nữa đúng cho cả cài đặt tác vụ (điều khiển và thị giác) cũng như các kết hợp ES khác nhau.

**Các vé ES thắng cuộc có thể được chuyển giao sang Huấn luyện GD.** Cuối cùng, chúng tôi lặp lại quy trình từ các đoạn phụ trước đó, nhưng lần này chuyển giao các khởi tạo thưa thớt dẫn xuất từ ES sang huấn luyện downstream với GD. Một lần nữa, chúng tôi tìm thấy một hiệu ứng tích cực cho việc chuyển giao một khởi tạo được thu được bởi ES. Như đã thảo luận trong Phần 3, các vé ES có thể hoạt động kém hơn so với huấn luyện dựa trên GD cho các mức độ thưa thớt vừa phải. Phù hợp với quan sát này, chúng tôi thấy rằng kích thước của hiệu ứng chuyển giao tương quan với sự khác biệt hiệu suất tương đối giữa hai mô hình. Chúng tôi không tìm thấy hiệu ứng tích cực mạnh cho các mức độ thưa thớt mà đường cơ sở vé GD vượt trội so với vé ES. Thú vị hơn, đối với các mạng rất thưa thớt, khởi tạo được chuyển giao từ ES thậm chí có thể vượt trội so với vé GD, chỉ ra rằng các mặt nạ cắt tỉa ES rất thưa thớt có thể chuyển giao tốt sang huấn luyện GD.

**5. Kết nối Chế độ Tuyến tính & Cắt tỉa SNR**

**Các tối ưu ES và GD không được kết nối tuyến tính.** Dựa trên kết quả trước đó, chúng tôi tự hỏi các mô hình được huấn luyện thu được bởi ES và GD khác nhau như thế nào. Do đó, chúng tôi đã so sánh kết nối tuyến tính của các tối ưu cục bộ trên các mức độ thưa thớt. Chúng tôi tính toán rào cản lỗi độ chính xác kiểm tra (A) giữa hai mạng được huấn luyện cho một phạm vi α, so sánh các kết hợp mạng tại các lần lặp IMP khác nhau. Phù hợp với công trình trước đây, các tối ưu cục bộ dựa trên GD vẫn được kết nối mạnh mẽ cho các mức độ thưa thớt vừa phải. Mặt khác, các giải pháp dựa trên ES đã trải qua một rào cản hiệu suất giữa các lần lặp IMP sớm, nhưng vẫn được kết nối tốt hơn ở mức độ thưa thớt cao hơn. Các tối ưu được tìm thấy bởi GD và ES nói chung không thể kết nối tuyến tính, chỉ ra rằng GD và ES tìm thấy các giải pháp cơ bản khác nhau. Hơn nữa, nó đặt câu hỏi về việc tổng quát hóa diễn giải vé regurgitating sang ES: Các khởi tạo vé ES tồn tại mặc dù thực tế là chúng không liên tục huấn luyện về cùng một lưu vực mất mát.

**ES có xu hướng hội tụ về các tối ưu phẳng hơn.** Một câu hỏi tiếp theo tự nhiên là: Độ cong của các tối ưu cục bộ thu được bởi các mô hình huấn luyện khác nhau khác nhau như thế nào? Chúng tôi sử dụng các phép chiếu ngẫu nhiên một chiều của mất mát kiểm tra để kiểm tra độ nhạy cảm của tối ưu cục bộ được khám phá cho các cường độ khác nhau. Chúng tôi định lượng độ cong xấp xỉ bằng cách khớp một đa thức bậc hai với mất mát được chiếu như một hàm của cường độ nhiễu loạn. Chúng tôi quan sát thấy rằng độ sắc nét xấp xỉ của các tối ưu GD tăng nhanh chóng với mức độ thưa thớt. Mặt khác, đối với các tối ưu dựa trên ES, độ cong tăng với tốc độ nhỏ hơn qua các lần lặp IMP.

**Cắt tỉa SNR tính toán động cho độ cong fitness.** Cuối cùng, chúng tôi điều tra các điều kiện mà trong đó cắt tỉa dựa trên SNR cải thiện so với IMP. Chúng tôi vẽ biểu đồ tương quan của độ lớn trọng số và SNR qua các giai đoạn cắt tỉa. Tương quan giảm cho cả SNR và các lần chạy cắt tỉa dựa trên IMP khi độ thưa thớt tăng. Khoảng cách hiệu suất SNR-IMP có liên quan chặt chẽ đến động lực tương quan tương đối: Nếu tương quan giảm nhanh hơn cho IMP so với SNR, người ta cũng quan sát thấy tác động tích cực của cắt tỉa SNR đối với hiệu suất. Ngược lại, chúng tôi không làm như vậy. Điều này chỉ ra rằng cắt tỉa dựa trên SNR có thể tính toán cho các thay đổi không đẳng hướng trong độ cong cảnh quan fitness do thưa thớt hóa gây ra. Các chiều có độ sắc nét cao (σ nhỏ) sẽ có SNR lớn hơn, làm cho chúng ít bị cắt tỉa hơn. Công trình tương lai sẽ phải khám phá các nền tảng cơ học của hiện tượng này.

**6. Thảo luận**

**Tóm tắt.** Chúng tôi thiết lập sự tồn tại của các khởi tạo thưa thớt có thể huấn luyện được trong tối ưu hóa tiến hóa. Do đó, khả năng huấn luyện thưa thớt không đòi hỏi một dòng gradient có mặt nạ cụ thể. Kích thước chính xác của hiệu ứng vé phụ thuộc vào ES, kiến trúc và tác vụ. Các khởi tạo thưa thớt kết quả có thể chuyển giao giữa các mô hình huấn luyện và sang các tác vụ liên quan. Các vé trong ES không nhất thiết phải huấn luyện lại về cùng một lưu vực mất mát nhưng vẫn có thể huấn luyện được trên các mức độ thưa thớt.

**Cân nhắc Đạo đức.** Hooker và cộng sự cho thấy rằng nén có thể khuếch đại thiên kiến và giảm công bằng trong cài đặt huấn luyện dựa trên GD. Khi chúng tôi mở rộng ES, công trình tương lai sẽ phải đánh giá liệu những vấn đề này có chuyển giao sang nén mô hình ES hay không và cách giảm thiểu chúng.

**Hạn chế.** Công trình này bị hạn chế bởi tính chất thực nghiệm và khả năng mở rộng của ES. Hơn nữa, nghiên cứu của chúng tôi tập trung vào các kích thước mạng trung bình. Điều này một phần do ES gặp khó khăn trong việc hiểu siêu tham số và việc áp dụng các công cụ được thiết kế riêng cho tối ưu hóa dựa trên GD. Cuối cùng, phân tích của chúng tôi dựa trên quy trình cắt tỉa lặp tốn kém về mặt tính toán, đòi hỏi nhiều lần chạy huấn luyện tuần tự.

**Công trình Tương lai.** Huấn luyện thưa thớt động với ES cung cấp một hướng cho công trình tương lai và có thể cho phép các giao thức đồng thời phát triển và cắt tỉa mạng. Hơn nữa, một sự hiểu biết đầy đủ về khả năng huấn luyện thưa thớt đòi hỏi một xử lý lý thuyết về tác động của độ thưa thớt đối với cảnh quan fitness.
