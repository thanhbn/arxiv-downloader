# 2309.13850.pdf
# Được chuyển đổi từ PDF sang TXT
# Đường dẫn nguồn: /home/admin88/arxiv-downloader/moe/2309.13850.pdf
# Kích thước tệp: 1015173 byte

===============================================
NỘI DUNG TỆP PDF
===============================================

--- TRANG 1 ---
Xuất bản như một bài báo hội nghị tại ICLR 2024
QUAN ĐIỂM THỐNG KÊ VỀ HÀM CỔNG SOFTMAX THƯA TOP-K
CỦA HỖN HỢP CÁC CHUYÊN GIA
Huy Nguyen
Khoa Thống kê và Khoa học Dữ liệu
Đại học Texas tại Austin
Austin, TX 78712
huynm@utexas.edu

Pedram Akbarian
Khoa Kỹ thuật Điện và Máy tính
Đại học Texas tại Austin
Austin, TX 78712
akbarian@utexas.edu

Fanqi Yan
Khoa Khoa học Máy tính
Đại học Texas tại Austin
Austin, TX 78712
fanqi.yan@utexas.edu

Nhat Ho
Khoa Thống kê và Khoa học Dữ liệu
Đại học Texas tại Austin
Austin, TX 78712
minhnhat@utexas.edu

TÓM TẮT
Hàm cổng softmax thưa top-K của hỗn hợp các chuyên gia đã được sử dụng rộng rãi để mở rộng quy mô các kiến trúc học sâu khổng lồ mà không tăng chi phí tính toán. Mặc dù phổ biến trong các ứng dụng thực tế, việc hiểu lý thuyết về hàm cổng đó vẫn là một bài toán mở. Thách thức chính đến từ cấu trúc của hàm cổng softmax thưa top-K, nó phân vùng không gian đầu vào thành nhiều vùng với các hành vi khác biệt. Bằng cách tập trung vào hỗn hợp Gaussian của các chuyên gia, chúng tôi thiết lập các kết quả lý thuyết về tác động của hàm cổng softmax thưa top-K lên cả ước lượng mật độ và tham số. Kết quả của chúng tôi dựa trên việc định nghĩa các hàm mất mát mới giữa các tham số để nắm bắt các hành vi khác nhau của các vùng đầu vào. Khi số lượng chuyên gia thực k∗ đã biết, chúng tôi chứng minh rằng tốc độ hội tụ của ước lượng mật độ và tham số đều tham số theo kích thước mẫu. Tuy nhiên, khi k∗ trở nên chưa biết và mô hình thực được chỉ định quá mức bởi hỗn hợp Gaussian của k chuyên gia với k > k∗, phát hiện của chúng tôi cho thấy số lượng chuyên gia được chọn từ hàm cổng softmax thưa top-K phải vượt quá tổng bậc của một số Voronoi cells nhất định liên quan đến các tham số thực để đảm bảo sự hội tụ của ước lượng mật độ. Hơn nữa, trong khi tốc độ ước lượng mật độ vẫn tham số dưới thiết lập này, tốc độ ước lượng tham số trở nên chậm đáng kể do sự tương tác nội tại giữa cổng softmax và các hàm chuyên gia.

1 GIỚI THIỆU
Được giới thiệu bởi Jacobs et al. (1991) và Jordan & Jacobs (1994), hỗn hợp các chuyên gia (MoE) đã được biết đến như một thiết kế học máy thống kê tận dụng các hàm cổng softmax để pha trộn các mạng chuyên gia khác nhau với nhau nhằm thiết lập một mô hình phức tạp hơn. Gần đây, có một sự quan tâm lớn đến một biến thể của mô hình này gọi là MoE cổng softmax thưa top-K, chỉ kích hoạt K mạng chuyên gia tốt nhất cho mỗi đầu vào dựa trên các hàm cổng thưa (Shazeer et al., 2017; Fedus et al., 2022a; Chen et al., 2023). Do đó, phương pháp thay thế này có thể được xem như một dạng tính toán có điều kiện (Bengio, 2013; Cho & Bengio, 2014) vì nó mở rộng đáng kể khả năng của mô hình trong khi tránh tăng tỷ lệ thuận trong chi phí tính toán. Những lợi ích này đã được chứng minh thực nghiệm trong một số ứng dụng học sâu, bao gồm xử lý ngôn ngữ tự nhiên (Lepikhin et al., 2021; Du et al., 2022; Fedus et al., 2022b; Zhou et al., 2023; Pham et al., 2024), nhận dạng giọng nói (Peng et al., 1996; Gulati et al., 2020; You et al., 2022), thị giác máy tính (Dosovitskiy et al., 2021; Riquelme et al., 2021; Liang et al., 2022; Bao et al., 2022), học đa nhiệm (Hazimeh et al., 2021; Gupta et al., 2022) và các ứng dụng khác (Rives et al., 2021; Chow et al., 2023; Li et al., 2023; Han et al., 2024). Tuy nhiên, theo hiểu biết của chúng tôi, phân tích lý thuyết đầy đủ của hàm cổng softmax thưa top-K vẫn còn thiếu trong tài liệu. Trong bài báo này, chúng tôi nhằm làm sáng tỏ hiểu biết lý thuyết về hàm cổng đó từ góc độ thống kê thông qua phân tích hội tụ của ước lượng hợp lý tối đa (MLE) dưới MoE Gaussian cổng softmax thưa top-K.

Đã có những nỗ lực trước đây để nghiên cứu bài toán ước lượng tham số trong các mô hình MoE Gaussian. Đầu tiên, Ho et al. (2022) đã sử dụng các hàm mất mát Wasserstein tổng quát Villani (2003; 2008) để dẫn xuất tốc độ ước lượng tham số trong MoE Gaussian cổng không phụ thuộc đầu vào. Họ chỉ ra rằng do sự tương tác giữa các tham số chuyên gia, những tốc độ này trở nên ngày càng chậm khi số lượng chuyên gia thêm tăng lên. Tiếp theo, Nguyen et al. (2023) và Nguyen et al. (2024) đã xem xét MoE Gaussian với các hàm cổng softmax và Gaussian tương ứng. Vì những hàm cổng này phụ thuộc vào đầu vào, một sự tương tác khác giữa tham số cổng và tham số chuyên gia đã xuất hiện. Do đó, họ đã thiết kế các hàm mất mát Voronoi để nắm bắt những tương tác này và quan sát rằng tốc độ hội tụ cho ước lượng tham số dưới những thiết lập này có thể được đặc trưng bởi khả năng giải được của các hệ phương trình đa thức (Sturmfels, 2002).

Chuyển đến MoE Gaussian cổng softmax thưa top-K, phân tích hội tụ của MLE, tuy nhiên, trở nên thách thức đáng kể do cấu trúc phức tạp của hàm cổng softmax thưa top-K so với những hàm cổng softmax và Gaussian. Để hiểu rõ hơn những trở ngại này, hãy giới thiệu công thức hóa chính thức của mô hình đó.

Thiết lập bài toán. Giả sử rằng (X1, Y1), . . . , (Xn, Yn) ∈ Rd × R là các mẫu i.i.d có kích thước n từ MoE Gaussian cổng softmax thưa top-K của bậc k∗ với hàm mật độ có điều kiện
gG∗(Y|X) = ∑(i=1 to k∗) Softmax(TopK((β∗1i)⊤X, K; β∗0i)) · f(Y|(a∗i)⊤X + b∗i, σ∗i), (1)

trong đó G∗ := ∑(i=1 to k∗) exp(β∗0i)δ(β∗1i,a∗i,b∗i,σ∗i) là một độ đo hỗn hợp thực nhưng chưa biết của bậc k∗ (tức là một tổ hợp tuyến tính của k∗ độ đo Dirac δ) liên quan đến các tham số thực (β∗0i, β∗1i, a∗i, b∗i, σ∗i) cho i ∈ {1, 2, . . . , k∗}. Ở đây, h1(X, a, b) := a⊤X + b được gọi là hàm chuyên gia, trong khi chúng tôi ký hiệu f(·|μ, σ) là hàm mật độ Gaussian đơn biến với trung bình μ và phương sai σ (Kết quả cho các thiết lập khác của f(·|μ, σ) được trình bày trong Phụ lục E). Ngoài ra, chúng tôi định nghĩa cho bất kỳ vector v = (v1, . . . , vk∗) và u = (u1, . . . , uk∗) trong Rk∗ rằng Softmax(vi) := exp(vi)/∑(j=1 to k∗)exp(vj) và

TopK(vi, K; ui) := {
vi + ui, nếu vi nằm trong K phần tử hàng đầu của v;
-∞, nếu không.
}

Cụ thể hơn, trước khi áp dụng hàm softmax trong phương trình (1), chúng tôi chỉ giữ lại K giá trị hàng đầu của (β∗11)⊤X, . . . , (β∗1k∗)⊤X và các vector bias tương ứng của chúng trong số β∗01, . . . , β∗0k∗, trong khi đặt phần còn lại thành -∞ để làm cho các giá trị cổng của chúng biến mất. Một ví dụ về hàm cổng softmax thưa top-K được đưa ra trong phương trình (3). Hơn nữa, các hàm chuyên gia tuyến tính được xem xét trong phương trình (1) chỉ để đơn giản hóa việc trình bày. Với các kỹ thuật chứng minh tương tự, kết quả trong công việc này có thể được mở rộng cho các thiết lập tổng quát của các hàm chuyên gia, bao gồm cả mạng nơ-ron sâu. Để có được ước lượng của G∗, chúng tôi sử dụng ước lượng hợp lý tối đa (MLE) sau:

Ĝn ∈ arg max G (1/n) ∑(i=1 to n) log(gG(Yi|Xi)). (2)

Dưới thiết lập chỉ định chính xác, tức là khi số lượng chuyên gia thực k∗ đã biết, giá trị tối đa trong phương trình (2) tuân theo tập hợp tất cả các độ đo hỗn hợp của bậc k∗ được ký hiệu là Ek∗(Ω) := {G = ∑(i=1 to k∗) exp(β0i)δ(β1i,ai,bi,σi) : (β0i, β1i, ai, bi, σi) ∈ Ω}. Mặt khác, dưới thiết lập chỉ định quá mức, tức là khi k∗ chưa biết và mô hình thực được chỉ định quá mức bởi hỗn hợp Gaussian của k chuyên gia với k > k∗, giá trị tối đa tuân theo tập hợp tất cả các độ đo hỗn hợp của bậc tối đa k, tức là Ok(Ω) := {G = ∑(i=1 to k') exp(β0i)δ(β1i,ai,bi,σi) : 1 ≤ k' ≤ k, (β0i, β1i, ai, bi, σi) ∈ Ω}.

Các giả định phổ quát. Vì mục đích lý thuyết, chúng tôi đặt ra bốn giả định chính về các tham số:

(U.1) Hội tụ của MLE: Để đảm bảo sự hội tụ của ước lượng tham số, chúng tôi giả định rằng không gian tham số Ω là tập hợp con compact của R × Rd × Rd × R × R+, trong khi không gian đầu vào X bị chặn.

(U.2) Khả năng nhận dạng: Tiếp theo, chúng tôi giả định rằng β∗1k∗ = 0d và β∗0k∗ = 0 để hỗn hợp Gaussian cổng softmax thưa top-K có thể nhận dạng được. Dưới giả định đó, chúng tôi chỉ ra trong Phụ lục C rằng nếu G và G' là hai độ đo hỗn hợp sao cho gG(Y|X) = gG'(Y|X) cho hầu chắc chắn (X, Y), thì G ≡ G'. Nếu không có giả định đó, kết quả G ≡ G' không đúng, dẫn đến các hàm mất mát phức tạp không cần thiết (xem [Mệnh đề 1, Nguyen et al. (2023)]).

(U.3) Các chuyên gia riêng biệt: Để đảm bảo rằng các chuyên gia trong hỗn hợp (1) khác nhau, chúng tôi giả định rằng các tham số (a∗1, b∗1, σ∗1), . . . , (a∗k∗, b∗k∗, σ∗k∗) khác nhau từng đôi.

(U.4) Các hàm cổng phụ thuộc đầu vào: Để đảm bảo rằng các hàm cổng phụ thuộc vào đầu vào X, chúng tôi giả định rằng ít nhất một trong các tham số β∗11, . . . , β∗1k∗ khác không. Nếu không, các hàm cổng sẽ độc lập với đầu vào X, điều này đơn giản hóa bài toán đáng kể. Cụ thể, mô hình (1) sẽ giảm xuống thành hỗn hợp Gaussian cổng không phụ thuộc đầu vào, đã được nghiên cứu trong Ho et al. (2022).

Thảo luận về thách thức. Trong phân tích hội tụ của chúng tôi, có hai thách thức chính được quy cho cấu trúc của hàm cổng softmax thưa top-K. (1) Đầu tiên, vì hàm cổng này chia không gian đầu vào thành nhiều vùng và mỗi vùng có hành vi hội tụ khác nhau của ước lượng mật độ, có thể có sự không khớp giữa các giá trị của hàm cổng softmax thưa top-K trong ước lượng mật độ gĜGn và trong mật độ thực gG∗ (xem Hình 1). (2) Thứ hai, dưới thiết lập chỉ định quá mức, mỗi thành phần của G∗ có thể được khớp bởi ít nhất hai thành phần của ĜGn. Do đó, việc chỉ chọn K chuyên gia tốt nhất trong công thức của gĜGn(Y|X) không đủ để ước lượng mật độ thực gG∗(Y|X). Kết quả là, việc tìm ra số lượng tối thiểu các chuyên gia được chọn trong hàm cổng softmax thưa top-K cần thiết để đảm bảo sự hội tụ của ước lượng mật độ là rất quan trọng.

Đóng góp. Trong công việc này, chúng tôi cung cấp các đảm bảo thống kê nghiêm ngặt cho ước lượng mật độ và ước lượng tham số trong MoE Gaussian cổng softmax thưa top-K dưới cả thiết lập chỉ định chính xác và chỉ định quá mức. Đóng góp của chúng tôi gồm hai phần và có thể được tóm tắt như sau (xem thêm Bảng 1):

1. Thiết lập chỉ định chính xác: Khi số lượng chuyên gia thực k∗ đã biết, chúng tôi chỉ ra rằng ước lượng mật độ gĜGn hội tụ về mật độ thực gG∗ dưới khoảng cách Hellinger với tốc độ tham số, tức là EX[h(gĜGn(·|X), gG∗(·|X))] = Õ(n^(-1/2)). Sau đó, chúng tôi đề xuất một metric Voronoi mới D1 được định nghĩa trong phương trình (5) để đặc trưng tốc độ ước lượng tham số. Bằng cách thiết lập cận dưới Hellinger EX[h(gG(·|X), gG∗(·|X))] ≳ D1(G, G∗) cho bất kỳ độ đo hỗn hợp G ∈ Ek∗(Θ), chúng tôi đạt được cận khác D1(ĜGn, G∗) = Õ(n^(-1/2)), cho thấy tốc độ ước lượng các tham số thực exp(β∗0i), β∗1i, a∗i, b∗i, σ∗i có bậc tối ưu Õ(n^(-1/2)).

2. Thiết lập chỉ định quá mức: Khi k∗ chưa biết và mô hình thực được chỉ định quá mức bởi Gaussian của k chuyên gia với k > k∗, chúng tôi chứng minh rằng ước lượng mật độ gĜGn hội tụ về mật độ thực gG∗ chỉ khi số lượng chuyên gia được chọn từ gĜGn, ký hiệu là K̄, lớn hơn tổng bậc của một số Voronoi cells nhất định được tạo bởi support của G∗. Với những kết quả này, tốc độ ước lượng mật độ được chỉ ra vẫn tham số theo kích thước mẫu. Ngoài ra, bằng cách thiết kế hàm mất mát Voronoi mới D2 trong phương trình (8) để nắm bắt sự tương tác giữa tham số của cổng softmax và các hàm chuyên gia, chúng tôi chứng minh rằng MLE ĜGn hội tụ về độ đo hỗn hợp thực G∗ với tốc độ Õ(n^(-1/2)). Sau đó, từ công thức của D2, tốc độ ước lượng cho các tham số thực β∗1j, a∗j, b∗j, σ∗j phụ thuộc vào khả năng giải được của hệ phương trình đa thức phát sinh từ sự tương tác trước đó, và hóa ra là chậm đáng kể.

Ý tưởng chứng minh cấp cao. Theo thảo luận về thách thức, để đảm bảo sự hội tụ của ước lượng mật độ dưới thiết lập chỉ định chính xác (tương ứng thiết lập chỉ định quá mức), chúng tôi chỉ ra rằng các vùng đầu vào được chia bởi các hàm cổng thực khớp với những vùng được chia bởi các hàm cổng ước lượng trong Lemma 1 (tương ứng Lemma 2). Sau đó, chúng tôi tận dụng các kết quả cơ bản về ước lượng mật độ cho M-estimators trong (van de Geer, 2000) để dẫn xuất tốc độ ước lượng mật độ tham số dưới khoảng cách Hellinger trong Định lý 1 (tương ứng Định lý 3). Về bài toán ước lượng tham số, bước quan trọng là phân tách độ chênh lệch mật độ gĜGn(Y|X) - gG∗(Y|X) thành tổ hợp của các số hạng độc lập tuyến tính. Do đó, khi ước lượng mật độ gĜGn(Y|X) hội tụ về mật độ thực gG∗(Y|X), các hệ số trong tổ hợp đó cũng tiến về không, dẫn đến tốc độ ước lượng tham số mong muốn trong Định lý 2 (tương ứng Định lý 4).

Tổ chức. Phần còn lại của bài báo được tổ chức như sau. Trong Mục 2, chúng tôi thiết lập tốc độ hội tụ của ước lượng mật độ và ước lượng tham số cho MoE Gaussian cổng softmax thưa top-K dưới thiết lập chỉ định chính xác, trong khi kết quả cho thiết lập chỉ định quá mức được trình bày trong Mục 3. Tiếp theo, chúng tôi cung cấp các hàm ý thực tế của những kết quả đó trong Mục 4 trước khi kết luận bài báo và thảo luận một số hướng tương lai trong Mục 5. Cuối cùng, các chứng minh đầy đủ, thí nghiệm số và kết quả bổ sung được hoãn lại cho tài liệu bổ sung.

Ký hiệu. Với bất kỳ số tự nhiên m ≥ n, chúng tôi ký hiệu [n] := {1, 2, . . . , n} và (m choose n) := m!/(n!(m-n)!). Tiếp theo, với bất kỳ vector u, v ∈ Rd, chúng tôi để |u| := ∑(i=1 to d) ui, u! := u1! . . . ud!, u^v := u1^v1 . . . ud^vd và ký hiệu ||u|| là giá trị chuẩn 2 của nó. Trong khi đó, chúng tôi định nghĩa |A| là bậc của tập hợp A nào đó. Sau đó, với bất kỳ hai mật độ xác suất f1 và f2 bị chi phối bởi độ đo Lebesgue ν, chúng tôi ký hiệu V(f1, f2) := (1/2)∫|f1 - f2|dν là khoảng cách Total Variation của chúng, trong khi h²(f1, f2) := (1/2)∫(√f1 - √f2)²dν biểu thị khoảng cách Hellinger bình phương. Cuối cùng, với bất kỳ hai dãy số thực dương (an) và (bn), các ký hiệu an = O(bn) và an ≲ bn đều đại diện cho an ≤ Cbn cho tất cả n ∈ N với hằng số C > 0 nào đó, trong khi ký hiệu an = Õ(bn) chỉ ra rằng bất đẳng thức trước có thể phụ thuộc vào số hạng logarit nào đó.

2 THIẾT LẬP CHỈ ĐỊNH CHÍNH XÁC

Trong mục này, chúng tôi đặc trưng tương ứng tốc độ hội tụ của ước lượng mật độ và ước lượng tham số trong MoE Gaussian cổng softmax thưa top-K dưới thiết lập chỉ định chính xác, tức là khi số lượng chuyên gia thực k∗ đã biết.

Để bắt đầu, hãy giới thiệu một số ký hiệu thiết yếu và kết quả quan trọng để xử lý hàm cổng softmax thưa top-K. Có thể thấy từ phương trình (1) rằng việc (a∗i)⊤X + b∗i có thuộc về K chuyên gia hàng đầu trong mật độ thực gG∗(Y|X) hay không được xác định dựa trên thứ hạng của (β∗1i)⊤X + β∗0i, phụ thuộc vào đầu vào X. Ngoài ra, cũng đáng chú ý rằng có tổng cộng q := (k∗ choose K) lựa chọn tiềm năng khác nhau của K chuyên gia hàng đầu. Do đó, trước tiên chúng tôi phân vùng không gian đầu vào X thành q vùng để xác định K chuyên gia hàng đầu và có được biểu diễn tương ứng của gG∗(Y|X) trong mỗi vùng. Cụ thể, với mỗi ℓ ∈ [q], chúng tôi ký hiệu {ℓ1, ℓ2, . . . , ℓK} là tập con K phần tử của [k∗] và {ℓK+1, . . . , ℓk∗} := [k∗] \ {ℓ1, ℓ2, . . . , ℓK}. Sau đó, vùng thứ ℓ của X được định nghĩa là

X∗ℓ := {x ∈ X : (β∗1i)⊤x ≥ (β∗1i')⊤x, ∀i ∈ {ℓ1, . . . , ℓK}, i' ∈ {ℓK+1, . . . , ℓk∗}},

với bất kỳ ℓ ∈ [q]. Từ định nghĩa này, chúng tôi quan sát rằng nếu X ∈ X∗ℓ với ℓ ∈ [q] nào đó sao cho {ℓ1, . . . , ℓK} = [K], thì TopK((β∗1i)⊤X, K; β∗0i) = (β∗1i)⊤X + β∗0i với bất kỳ i ∈ [K]. Kết quả là, (a∗1)⊤X + b∗1, . . . , (a∗K)⊤X + b∗K trở thành K chuyên gia hàng đầu, và mật độ có điều kiện thực gG∗(Y|X) được giảm xuống thành:

gG∗(Y|X) = ∑(i=1 to K) [exp((β∗1i)⊤X + β∗0i) / ∑(j=1 to K) exp((β∗1j)⊤X + β∗0j)] · f(Y|(a∗i)⊤X + b∗i, σ∗i). (3)

Tiếp theo, chúng tôi giả định rằng MLE ĜGn có dạng ĜGn := ∑(i=1 to k∗) exp(β̂n0i)δ(β̂n1i, âni, b̂ni, σ̂ni), trong đó thành phần MLE ω̂ni := (β̂n0i, β̂n1i, âni, b̂ni, σ̂ni) hội tụ về thành phần thực ω∗i := (β∗0i, β∗1i, a∗i, b∗i, σ∗i) với bất kỳ i ∈ [k∗]. Chúng tôi tìm ra trong lemma sau đây mối quan hệ giữa các giá trị của hàm TopK trong gG∗(Y|X) và gĜGn(Y|X):

Lemma 1. Với bất kỳ i ∈ [k∗], cho β1i, β∗1i ∈ Rd sao cho ||β1i - β∗1i|| ≤ ηi với ηi > 0 đủ nhỏ nào đó. Sau đó, với bất kỳ ℓ ∈ [q], trừ khi tập X∗ℓ có độ đo bằng không, chúng ta có được X∗ℓ = Xℓ trong đó
Xℓ := {x ∈ X : (β1i)⊤x ≥ (β1i')⊤x, ∀i ∈ {ℓ1, . . . , ℓK}, i' ∈ {ℓK+1, . . . , ℓk∗}}.

Chứng minh Lemma 1 có trong Phụ lục A.3. Lemma này chỉ ra rằng với hầu chắc chắn X, TopK((β∗1i)⊤X, K; β∗0i) = (β∗1i)⊤X + β∗0i tương đương với TopK((β̂n1i)⊤X, K; β̂n0i) = (β̂n1i)⊤X + β̂n0i, với bất kỳ i ∈ [k∗] và n đủ lớn. Dựa trên tính chất này, chúng tôi cung cấp trong Định lý 1 tốc độ ước lượng hàm mật độ có điều kiện thực gG∗:

Định lý 1 (Tốc độ ước lượng mật độ). Cho MLE ĜGn được định nghĩa trong phương trình (2), tốc độ hội tụ của ước lượng mật độ có điều kiện gĜGn về mật độ có điều kiện thực gG∗ dưới thiết lập chỉ định chính xác được minh họa bởi bất đẳng thức sau:

P[EX[h(gĜGn(·|X), gG∗(·|X))] > C√(log(n)/n)] ≲ n^(-c),

trong đó C > 0 và c > 0 là các hằng số phổ quát phụ thuộc vào Ω và K.

Chứng minh Định lý 1 có thể tìm thấy trong Phụ lục A.1. Từ kết quả của Định lý 1, ước lượng mật độ có điều kiện gĜGn hội tụ về đối tác thực gG∗ dưới khoảng cách Hellinger với tốc độ tham số bậc Õ(n^(-1/2)). Tốc độ này đóng vai trò quan trọng trong việc thiết lập tốc độ hội tụ của ước lượng tham số. Cụ thể, nếu chúng ta có thể dẫn xuất cận dưới sau: EX[h(gG(·|X), gG∗(·|X))] ≳ D1(G, G∗) với bất kỳ độ đo hỗn hợp G ∈ Ek∗(Ω), trong đó metric D1 sẽ được định nghĩa trong phương trình (5), chúng ta sẽ đạt được tốc độ ước lượng tham số mong muốn.

Trước khi đi vào chi tiết hơn, hãy giới thiệu công thức của metric Voronoi D1 mà chúng tôi sử dụng cho phân tích hội tụ dưới thiết lập chỉ định chính xác.

Metric Voronoi. Cho một độ đo hỗn hợp tùy ý G với k' thành phần, chúng tôi phân phối những thành phần đó vào các Voronoi cells sau được tạo bởi các thành phần của G∗ Manole & Ho (2022):

Cj ≡ Cj(G) := {i ∈ [k'] : ||θi - θ∗j|| ≤ ||θi - θ∗j'||, ∀j' ≠ j}, (4)

trong đó θi := (β1i, ai, bi, σi) và θ∗j := (β∗1j, a∗j, b∗j, σ∗j) với bất kỳ j ∈ [k∗]. Nhớ lại rằng dưới thiết lập chỉ định chính xác, MLE ĜGn thuộc về tập Ek∗(Ω). Do đó, chúng tôi xem xét k' = k∗ trong trường hợp này. Sau đó, metric Voronoi D1 được định nghĩa như sau:

D1(G, G∗) := max{ℓj}Kj=1⊂[k∗] ∑(j=1 to K)[∑(i∈Cℓj) exp(β0i)(||Δβ1iℓj|| + ||Δaiℓj|| + ||Δbiℓj|| + ||Δσiℓj||) + |∑(i∈Cℓj) exp(β0i) - exp(β∗0ℓj)|]. (5)

Ở đây, chúng tôi ký hiệu Δβ1iℓj := β1i - β∗1ℓj, Δaiℓj := ai - a∗ℓj, Δbiℓj := bi - b∗ℓj và Δσiℓj := σi - σ∗ℓj. Ngoài ra, toán tử max ở trên giúp nắm bắt hành vi của tất cả các vùng đầu vào được phân tách bởi hàm cổng softmax thưa top-K. Bây giờ, chúng ta đã sẵn sàng để đặc trưng tốc độ hội tụ của ước lượng tham số trong MoE Gaussian cổng softmax thưa top-K.

Định lý 2 (Tốc độ ước lượng tham số). Dưới thiết lập chỉ định chính xác, cận dưới Hellinger EX[h(gG(·|X), gG∗(·|X))] ≳ D1(G, G∗) tồn tại với bất kỳ độ đo hỗn hợp G ∈ Ek∗(Ω). Do đó, chúng ta có thể tìm thấy hằng số phổ quát C1 > 0 chỉ phụ thuộc vào G∗, Ω và K sao cho

P[D1(ĜGn, G∗) > C1√(log(n)/n)] ≲ n^(-c1),

trong đó c1 > 0 là hằng số phổ quát chỉ phụ thuộc vào Ω.

Chứng minh Định lý 2 có trong Phụ lục A.2. Định lý này tiết lộ rằng metric Voronoi D1 giữa MLE ĜGn và độ đo hỗn hợp thực G∗, tức là D1(ĜGn, G∗), biến mất với tốc độ tham số bậc Õ(n^(-1/2)). Kết quả là, tốc độ ước lượng các tham số ground-truth exp(β∗0i), β∗1i, a∗i, b∗i, σ∗i là tối ưu tại Õ(n^(-1/2)) với bất kỳ i ∈ [k∗].

3 THIẾT LẬP CHỈ ĐỊNH QUÁ MỨC

Trong mục này, chúng tôi tiếp tục thực hiện phân tích hội tụ tương tự cho MoE Gaussian cổng softmax thưa top-K như trong Mục 2 nhưng dưới thiết lập chỉ định quá mức, tức là khi số lượng chuyên gia thực k∗ trở nên chưa biết.

Nhớ lại rằng dưới thiết lập chỉ định quá mức, chúng tôi tìm kiếm MLE ĜGn trong Ok(Ω), tức là tập hợp tất cả các độ đo hỗn hợp với tối đa k thành phần, trong đó k > k∗. Do đó, có thể có một số thành phần (β∗1i, a∗i, b∗i, σ∗i) của độ đo hỗn hợp thực G∗ được xấp xỉ bởi ít nhất hai thành phần khớp (β̂n1i, âni, b̂ni, σ̂ni) của MLE ĜGn. Hơn nữa, vì mật độ thực gG∗(Y|X) liên quan đến K chuyên gia hàng đầu và mỗi chuyên gia tương ứng với một thành phần của G∗, chúng ta cần chọn nhiều hơn K chuyên gia trong công thức của ước lượng mật độ gĜGn(Y|X) để đảm bảo sự hội tụ của nó về gG∗(Y|X). Cụ thể, với bất kỳ độ đo hỗn hợp G = ∑(i=1 to k') exp(β0i)δ(β1i,ai,bi,σi) ∈ Ok(Ω), hãy xem xét công thức mới của mật độ có điều kiện được sử dụng để ước lượng mật độ thực dưới thiết lập chỉ định quá mức như sau:

gG(Y|X) := ∑(i=1 to k') Softmax(TopK̄((β1i)⊤X, K̄; β0i)) · f(Y|(ai)⊤X + bi, σi).

Ở đây, gG(Y|X) được trang bị cổng softmax thưa top-K̄, trong đó 1 ≤ K̄ ≤ k' được cố định và có thể khác với K. Ngoài ra, định nghĩa MLE trong phương trình (2) cũng thay đổi tương ứng với hàm mật độ mới này. Sau đó, chúng tôi chứng minh trong Mệnh đề 1 một hiện tượng thú vị rằng ước lượng mật độ gĜGn hội tụ về gG∗ dưới khoảng cách Hellinger chỉ khi K̄ ≥ max{ℓ1,...,ℓK}⊂[k∗] ∑(j=1 to K) |Cℓj|, trong đó Cℓj là Voronoi cell được định nghĩa trong phương trình (4).

Mệnh đề 1. Nếu K̄ < max{ℓ1,...,ℓK}⊂[k∗] ∑(j=1 to K) |Cℓj|, thì bất đẳng thức sau đúng:
inf(G∈Ok(Ω)) EX[h(gG(·|X), gG∗(·|X))] > 0.

Chứng minh Mệnh đề 1 được hoãn lại trong Phụ lục B.3. Theo kết quả của Mệnh đề 1, chúng tôi sẽ chỉ xem xét chế độ khi max{ℓj}Kj=1⊂[k∗] ∑(j=1 to K) |Cℓj| ≤ K̄ ≤ k trong phần còn lại của mục này để đảm bảo sự hội tụ của ước lượng mật độ. Khi số lượng chuyên gia được chọn trong ước lượng mật độ thay đổi từ K thành K̄, cần thiết phải phân vùng không gian đầu vào X thành q̄ := (k choose K̄) vùng. Cụ thể hơn, với bất kỳ ℓ ∈ [q̄], chúng tôi ký hiệu {ℓ1, ℓ2, . . . , ℓK̄} là tập con K̄ phần tử của [k] và {ℓK̄+1, . . . , ℓk} := [k] \ {ℓ1, ℓ2, . . . , ℓK̄}. Sau đó, chúng tôi định nghĩa vùng thứ ℓ của X như sau:

Xℓ := {x ∈ X : (β1i)⊤x ≥ (β1i')⊤x, ∀i ∈ {ℓ1, . . . , ℓK̄}, i' ∈ {ℓK̄+1, . . . , ℓk}}.

Lấy cảm hứng từ kết quả của Lemma 1, chúng tôi tiếp tục trình bày trong Lemma 2 mối quan hệ giữa các giá trị của các hàm TopK̄ trong ước lượng mật độ gĜGn và mật độ thực gG∗.

Lemma 2. Với bất kỳ j ∈ [k∗] và i ∈ Cj, cho β1i, β∗1j ∈ Rd thỏa mãn ||β1i - β∗1j|| ≤ ηj với ηj > 0 đủ nhỏ nào đó. Ngoài ra, với max{ℓj}Kj=1⊂[k∗] ∑(j=1 to K) |Cℓj| ≤ K̄ ≤ k, chúng tôi giả định rằng tồn tại ℓ ∈ [q] và ℓ̄ ∈ [q̄] sao cho {ℓ̄1, . . . , ℓ̄K̄} = Cℓ1 ∪ . . . ∪ CℓK. Sau đó, nếu tập X∗ℓ không có độ đo bằng không, chúng ta đạt được X∗ℓ = Xℓ̄.

Chứng minh Lemma 2 có trong Phụ lục B.4. Khác với Lemma 1, chúng tôi cần áp đặt lên Lemma 2 một giả định rằng tồn tại các chỉ số ℓ ∈ [q] và ℓ̄ ∈ [q̄] thỏa mãn {ℓ̄1, . . . , ℓ̄K̄} = Cℓ1 ∪ . . . ∪ CℓK. Giả định này có nghĩa là mỗi thành phần (β̂n1i, âni, b̂ni, σ̂ni) tương ứng với K̄ chuyên gia hàng đầu trong gĜGn phải hội tụ về một số thành phần thực tương ứng với K chuyên gia hàng đầu trong gG∗. Do đó, với X ∈ X∗ℓ, nếu TopK((β∗1j)⊤X, K; β∗0j) = (β∗1j)⊤X + β∗0j đúng, thì chúng ta đạt được TopK̄((β̂n1i)⊤X, K̄; β̂n0i) = (β̂n1i)⊤X + β̂n0i và ngược lại, với bất kỳ j ∈ [k∗] và i ∈ Cj.

Cho kết quả của Lemma 2, bây giờ chúng ta có thể dẫn xuất tốc độ hội tụ của ước lượng mật độ gĜGn về đối tác thực gG∗ dưới thiết lập chỉ định quá mức trong Định lý 3.

Định lý 3 (Tốc độ ước lượng mật độ). Dưới thiết lập chỉ định quá mức, ước lượng mật độ có điều kiện gĜGn hội tụ về mật độ thực gG∗ dưới khoảng cách Hellinger với tốc độ sau:

P[EX[h(gĜGn(·|X), gG∗(·|X))] > C'√(log(n)/n)] ≲ n^(-c'),

trong đó C' > 0 và c' > 0 là các hằng số phổ quát phụ thuộc vào Ω và K̄.

Chứng minh Định lý 3 có trong Phụ lục B.1. Mặc dù có sự thay đổi trong số lượng chuyên gia được chọn từ gĜGn, Định lý 3 xác minh rằng tốc độ hội tụ của ước lượng mật độ này về gG∗ dưới thiết lập chỉ định quá mức vẫn giống như dưới thiết lập chỉ định chính xác, có bậc Õ(n^(-1/2)). Tiếp theo, chúng tôi sẽ tận dụng kết quả này cho phân tích hội tụ của ước lượng tham số dưới thiết lập chỉ định quá mức, đòi hỏi chúng tôi thiết kế metric Voronoi mới.

Metric Voronoi. Về hàm cổng softmax thưa top-K, thách thức không chỉ đến từ hàm TopK mà còn từ hàm Softmax. Cụ thể, có một sự tương tác nội tại giữa tử số của trọng số softmax và các hàm chuyên gia trong mật độ Gaussian. Hơn nữa, các tham số mật độ Gaussian cũng tương tác với nhau. Hai tương tác này được minh họa tương ứng bởi các phương trình vi phân riêng phần (PDEs) sau:

∂²s(X, Y)/∂β1∂b = ∂s(X, Y)/∂a; ∂s(X, Y)/∂σ = (1/2) · ∂²s(X, Y)/∂b², (6)

trong đó chúng tôi ký hiệu s(X, Y) := exp(β₁ᵀX) · f(Y|aᵀX + b, σ). Những PDEs này phát sinh khi chúng tôi phân tách sự khác biệt mật độ gĜGn(Y|X) - gG∗(Y|X) thành tổ hợp tuyến tính của các số hạng độc lập tuyến tính sử dụng khai triển Taylor. Tuy nhiên, những PDEs trên chỉ ra rằng các số hạng đạo hàm có dạng trong phương trình (6) phụ thuộc tuyến tính. Do đó, chúng ta phải nhóm những số hạng này bằng cách lấy tổng các hệ số của chúng, và sau đó đạt được tổ hợp tuyến tính mong muốn của các phần tử độc lập tuyến tính. Do đó, khi gĜGn(Y|X) - gG∗(Y|X) hội tụ về không, tất cả các hệ số trong tổ hợp này cũng tiến về không, dẫn đến hệ phương trình đa thức sau với các biến chưa biết {z1j, z2j, z3j, z4j, z5j}ᵐᵢ₌₁:

∑(i=1 to m) ∑((α1,α2,α3,α4)∈Jη1,η2) (z²₅ᵢzᵅ¹₁ᵢzᵅ²₂ᵢzᵅ³₃ᵢzᵅ⁴₄ᵢ)/(α1!α2!α3!α4!) = 0, (7)

cho tất cả (η1, η2) ∈ Nᵈ × N sao cho 0 ≤ |η1| ≤ r, 0 ≤ η2 ≤ r - |η1| và |η1| + η2 ≥ 1, trong đó
Jη1,η2 := {(α1, α2, α3, α4) ∈ Nᵈ × Nᵈ × N × N : α1 + α2 = η1, |α2| + α3 + α4 = η2}.

Ở đây, nghiệm của hệ trên được gọi là không tầm thường nếu tất cả biến z5i khác không, trong khi ít nhất một trong các biến z3i khác không. Với bất kỳ m ≥ 2, cho r̄(m) là số tự nhiên nhỏ nhất r sao cho hệ trên không có nghiệm không tầm thường nào. Trong trường hợp tổng quát khi d ≥ 1 và m ≥ 2, việc xác định giá trị chính xác của r̄(m) là không tầm thường Sturmfels (2002). Tuy nhiên, khi m nhỏ, Nguyen et al. (2023) chỉ ra rằng r̄(2) = 4 và r̄(3) = 6. Ngoài ra, vì r̄(m) là hàm tăng đơn điệu của m, họ cũng đoán rằng r̄(m) = 2m với bất kỳ m ≥ 2 và d ≥ 1.

Cho những kết quả trên, chúng tôi thiết kế metric Voronoi D2 để nắm bắt tốc độ hội tụ của ước lượng tham số trong MoE Gaussian cổng softmax thưa top-K dưới thiết lập chỉ định quá mức như

D2(G, G∗) := max{ℓj}Kj=1⊂[k∗] [∑(j∈[K], |Cℓj|=1) ∑(i∈Cℓj) exp(β0i)[||Δβ1iℓj|| + ||Δaiℓj|| + |Δbiℓj| + |Δσiℓj|]
+ ∑(j∈[K], |Cℓj|>1) ∑(i∈Cℓj) exp(β0i)[||Δβ1iℓj||^r̄(|Cℓj|) + ||Δaiℓj||^(r̄(|Cℓj|)/2) + |Δbiℓj|^r̄(|Cℓj|) + |Δσiℓj|^(r̄(|Cℓj|)/2)]
+ ∑(j=1 to K) |∑(i∈Cℓj) exp(β0i) - exp(β∗0ℓj)|], (8)

với bất kỳ độ đo hỗn hợp G ∈ Ok(Ω). Toán tử max ở trên cho phép chúng ta nắm bắt hành vi của tất cả các vùng đầu vào được phân vùng bởi hàm cổng softmax thưa top-K trong gG∗. Sau đó, chúng tôi chỉ ra trong định lý sau rằng tốc độ ước lượng tham số thay đổi theo giá trị của hàm r̄(·).

Định lý 4 (Tốc độ ước lượng tham số). Dưới thiết lập chỉ định quá mức, cận dưới Hellinger EX[h(gG(·|X), gG∗(·|X))] ≳ D2(G, G∗) tồn tại với bất kỳ độ đo hỗn hợp G ∈ Ok(Ω). Kết quả là, chúng ta có thể tìm thấy hằng số phổ quát C2 > 0 chỉ phụ thuộc vào G∗, Ω và K̄ sao cho

P[D2(ĜGn, G∗) > C2√(log(n)/n)] ≲ n^(-c2),

trong đó c2 > 0 là hằng số phổ quát chỉ phụ thuộc vào Ω.

Chứng minh Định lý 4 có trong Phụ lục B.2. Một vài nhận xét về định lý này theo thứ tự.

(i) Dưới thiết lập chỉ định quá mức, MLE ĜGn hội tụ về độ đo hỗn hợp thực G∗ với tốc độ bậc Õ(n^(-1/2)) dưới metric Voronoi D2. Hãy ký hiệu Cⁿj = Cj(ĜGn), thì kết quả này chỉ ra rằng tốc độ ước lượng cho các tham số ground-truth exp(β∗0j), β∗1j, a∗j, b∗j, σ∗j được khớp bởi chỉ một thành phần, tức là |Cⁿj| = 1, vẫn giống như Õ(n^(-1/2)) trong thiết lập chỉ định chính xác.

(ii) Tuy nhiên, đối với các tham số ground-truth được xấp xỉ bởi ít nhất hai thành phần, tức là |Cⁿj| > 1, tốc độ ước lượng chúng phụ thuộc vào các Voronoi cells tương ứng, và trở nên chậm đáng kể khi bậc của những Voronoi cells đó tăng. Cụ thể, cả β∗1j và b∗j đều có tốc độ ước lượng bậc Õ(n^(-1/(2r̄(|Cⁿj|)))). Trong khi đó, tốc độ hội tụ của việc ước lượng a∗j và σ∗j có cùng bậc O(n^(-1/r̄(|Cⁿj|))). Ví dụ, giả sử rằng (β∗1j, a∗j, b∗j, σ∗j) có ba thành phần khớp, có nghĩa là |Cⁿj| = 3 và do đó, r̄(|Cⁿj|) = 6. Thì tốc độ ước lượng cho β∗1j, b∗j và a∗j, σ∗j tương ứng là Õ(n^(-1/12)) và Õ(n^(-1/6)).

4 NHỮNG HÀM Ý THỰC TẾ

Trong mục này, chúng tôi trình bày ba hàm ý thực tế chính của kết quả lý thuyết cho việc sử dụng hàm cổng softmax thưa top-K trong hỗn hợp các chuyên gia như sau:

1. Không có sự đánh đổi giữa khả năng mô hình và hiệu suất mô hình: Trong hỗn hợp Gaussian cổng softmax thưa top-K, vì hàm cổng không liên tục và chỉ một phần các chuyên gia được kích hoạt cho mỗi đầu vào để mở rộng khả năng mô hình, tốc độ ước lượng tham số dưới mô hình đó dự kiến sẽ chậm hơn so với dưới hỗn hợp Gaussian cổng softmax dày đặc (Nguyen et al., 2023). Tuy nhiên, từ lý thuyết của chúng tôi, hóa ra tốc độ ước lượng tham số dưới hai mô hình này giống nhau dưới cả thiết lập chỉ định chính xác và chỉ định quá mức. Kết quả là, chúng tôi chỉ ra rằng việc sử dụng hàm cổng softmax thưa top-K cho phép chúng ta mở rộng khả năng mô hình mà không hy sinh chi phí tính toán cũng như tốc độ hội tụ của ước lượng tham số và mật độ.

2. Hàm cổng thuận lợi: Như đã đề cập trong Mục 3, do sự tương tác nội tại giữa tham số cổng và tham số chuyên gia thông qua PDE đầu tiên trong phương trình (6), tốc độ ước lượng những tham số đó dưới thiết lập chỉ định quá mức được xác định bởi khả năng giải được của hệ phương trình đa thức (7), chậm đáng kể. Tuy nhiên, nếu chúng ta sử dụng hàm cổng softmax thưa top-1, tức là chỉ kích hoạt một chuyên gia duy nhất cho mỗi đầu vào, thì giá trị cổng là một hoặc không. Kết quả là, sự tương tác trước đó không còn xảy ra, giúp cải thiện tốc độ ước lượng tham số. Điều này một phần giải thích hiệu quả của hỗn hợp các chuyên gia cổng softmax thưa top-1 trong việc mở rộng kiến trúc học sâu (xem (Fedus et al., 2022b)).

3. Số lượng chuyên gia thực/tối thiểu: Một thách thức khác là chọn số lượng chuyên gia thực/tối thiểu, có thể được giải quyết một phần bằng lý thuyết phát triển từ bài báo. Cụ thể, giả sử MLE ĜGn bao gồm k̂n thành phần. Khi kích thước mẫu n tiến tới vô cùng, mỗi Voronoi cell trong số Cⁿ1, . . . , Cⁿk∗ chứa ít nhất một phần tử. Vì tổng số phần tử của những Voronoi cells đó là k̂n, bậc tối đa của một Voronoi cell hóa ra là k̂n - k∗ + 1. Giá trị tối đa này đạt được khi có chính xác một thành phần ground-truth (β∗1j, a∗j, b∗j, σ∗j) được khớp bởi nhiều hơn một thành phần. Một ví dụ cho kịch bản này là khi |Cⁿ1| = k̂n - k∗ + 1 và |Cⁿ2| = . . . = |Cⁿk∗| = 1. Dưới thiết lập này, các tham số thực đầu tiên β∗11, b∗1 và a∗1, σ∗1 đạt tốc độ ước lượng xấu nhất có thể tương ứng bậc Õ(n^(-1/(2r̄(k̂n-k∗+1)))) và Õ(n^(-1/r̄(k̂n-k∗+1))), trở nên chậm đáng kể khi sự khác biệt k̂n - k∗ tăng. Kết quả là, số lượng chuyên gia ước lượng k̂n không nên quá lớn so với số lượng chuyên gia thực k∗.

5 KẾT LUẬN VÀ HƯỚNG TƯƠNG LAI

Trong bài báo này, chúng tôi cung cấp phân tích hội tụ cho ước lượng mật độ và ước lượng tham số trong MoE Gaussian cổng softmax thưa top-K. Để vượt qua cấu trúc phức tạp của hàm cổng softmax thưa top-K, trước tiên chúng tôi thiết lập kết nối giữa các đầu ra của hàm TopK liên quan đến ước lượng mật độ và mật độ thực trong mỗi vùng đầu vào được phân vùng bởi hàm cổng, và sau đó xây dựng các hàm mất mát Voronoi mới giữa các tham số để nắm bắt các hành vi khác nhau của những vùng đầu vào này. Dưới thiết lập chỉ định chính xác, chúng tôi chỉ ra rằng tốc độ ước lượng mật độ thực và tham số thực đều tham số theo kích thước mẫu. Mặt khác, mặc dù tốc độ ước lượng mật độ vẫn tham số dưới thiết lập chỉ định quá mức, tốc độ ước lượng tham số chứng kiến sự giảm mạnh do sự tương tác giữa cổng softmax và các hàm chuyên gia.

Dựa trên kết quả của bài báo này, có một vài hướng tương lai tiềm năng. Thứ nhất, như chúng tôi đã đề cập trong Mục 4, câu hỏi về cách ước lượng số lượng chuyên gia thực k∗ và số lượng chuyên gia được chọn trong hàm cổng softmax thưa top-K K̄ tự nhiên phát sinh từ công việc này. Vì tốc độ ước lượng tham số dưới thiết lập chỉ định quá mức giảm tỷ lệ thuận với số lượng chuyên gia khớp k, một cách tiếp cận có thể để ước lượng k∗ là giảm k cho đến khi những tốc độ này đạt bậc tối ưu Õ(n^(-1/2)). Việc giảm đó có thể được thực hiện bằng cách hợp nhất các tham số ước lượng gần nhau trong tốc độ hội tụ của chúng về các tham số thực (Guha et al., 2021) hoặc bằng cách phạt hàm log-likelihood của MoE Gaussian cổng softmax thưa top-K sử dụng sự khác biệt giữa các tham số (Manole & Khalili, 2021). Kết quả là, số lượng chuyên gia được chọn trong ước lượng mật độ K̄ cũng giảm tương ứng và xấp xỉ giá trị của K. Thứ hai, kết quả lý thuyết được thiết lập trong bài báo dưới giả định rằng dữ liệu được giả định được tạo từ MoE Gaussian cổng softmax thưa top-K, có thể bị vi phạm trong thiết lập thực tế khi dữ liệu không nhất thiết được tạo từ mô hình đó. Dưới những thiết lập chỉ định sai này, MLE hội tụ về độ đo hỗn hợp G ∈ arg min(G∈Ok(Ω)) KL(P(Y|X)||gG(Y|X)) trong đó P(Y|X) là phân phối có điều kiện thực của Y cho X và KL đại diện cho divergence Kullback-Leibler. Vì không gian Ok(Ω) không lồi, sự tồn tại của G không duy nhất. Hơn nữa, phân tích hiện tại của MLE dưới thiết lập chỉ định sai của các mô hình thống kê chủ yếu được tiến hành khi không gian hàm lồi (van de Geer, 2000), không áp dụng được cho thiết lập chỉ định sai không lồi hiện tại. Do đó, cần thiết phát triển phân tích mới và metric mới để thiết lập tốc độ hội tụ của MLE về tập hợp G. Cuối cùng, vì hàm log-likelihood của MoE Gaussian cổng softmax thưa top-K rất không lõm, thuật toán EM được sử dụng để xấp xỉ MLE. Trong khi đảm bảo thống kê của EM đã được thiết lập cho các mô hình hỗn hợp Gaussian thông thường (Balakrishnan et al., 2017; Dwivedi et al., 2020b;a), theo hiểu biết của chúng tôi, đảm bảo như vậy chưa được nghiên cứu trong thiết lập MoE Gaussian cổng softmax thưa top-K. Một cách tiếp cận tiềm năng cho vấn đề này là sử dụng phân tích population-to-sample đã được sử dụng rộng rãi trong các công việc trước để nghiên cứu thuật toán EM Balakrishnan et al. (2017); Ho et al. (2023). Chúng tôi để hướng đó cho công việc tương lai.

LỜI CẢM ƠN

NH thừa nhận sự hỗ trợ từ NSF IFML 2019844 và NSF AI Institute for Foundations of Machine Learning.

TÀI LIỆU THAM KHẢO

S. Balakrishnan, M. J. Wainwright, và B. Yu. Statistical guarantees for the EM algorithm: From population to sample-based analysis. Annals of Statistics, 45:77–120, 2017.

H. Bao, W. Wang, L. Dong, Q. Liu, O-K. Mohammed, K. Aggarwal, S. Som, S. Piao, và F. Wei. VLMo: Unified vision-language pre-training with mixture-of-modality-experts. In Advances in Neural Information Processing Systems, 2022.

Y. Bengio. Deep learning of representations: Looking forward. In International Conference on Statistical Language and Speech Processing, 2013.

Faicel Chamroukhi, Allou Samé, Gérard Govaert, và Patrice Aknin. Time series modeling by a regression approach based on a latent process. Neural Networks, 22(5-6):593–602, 2009. Publisher: Elsevier.

T. Chen, Z. Zhang, A. Jaiswal, S. Liu, và Z. Wang. Sparse moe as the new dropout: Scaling dense and self-slimmable transformers. In The Eleventh International Conference on Learning Representations, 2023.

K. Cho và Y. Bengio. Exponentially increasing the capacity-to-computation ratio for conditional computation in deep learning. arxiv preprint arxiv 1406.7362, 2014.

Y. Chow, A. Tulepbergenov, O. Nachum, D. Gupta, M. Ryu, M. Ghavamzadeh, và C. Boutilier. A mixture-of-expert approach to rl-based dialogue management. In The Eleventh International Conference on Learning Representations, 2023.

A. P. Dempster, N. M. Laird, và D. B. Rubin. Maximum Likelihood from Incomplete Data Via the EM Algorithm. Journal of the Royal Statistical Society: Series B (Methodological), 39(1):1–22, September 1977. ISSN 0035-9246.

A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, J. Uszkoreit, và N. Houlsby. An image is worth 16x16 words: Transformers for image recognition at scale. In International Conference on Learning Representations, 2021.

N. Du, Y. Huang, A. M. Dai, S. Tong, D. Lepikhin, Y. Xu, M. Krikun, Y. Zhou, A. Yu, O. Firat, B. Zoph, L. Fedus, M. Bosma, Z. Zhou, T. Wang, E. Wang, K. Webster, M. Pellat, K. Robinson, K. Meier-Hellstern, T. Duke, L. Dixon, K. Zhang, Q. Le, Y. Wu, Z. Chen, và C. Cui. Glam: Efficient scaling of language models with mixture-of-experts. In ICML, 2022.

R. Dwivedi, N. Ho, K. Khamaru, M. J. Wainwright, M. I. Jordan, và B. Yu. Sharp analysis of expectation-maximization for weakly identifiable models. International Conference on Artificial Intelligence and Statistics (AISTATS), 2020a.

R. Dwivedi, N. Ho, K. Khamaru, M. J. Wainwright, M. I. Jordan, và B. Yu. Singularity, misspecification, and the convergence rate of EM. Annals of Statistics, 44:2726–2755, 2020b.

W. Fedus, J. Dean, và B. Zoph. A review of sparse expert models in deep learning. arxiv preprint arxiv 2209.01667, 2022a.

W. Fedus, B. Zoph, và N. Shazeer. Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity. Journal of Machine Learning Research, 23:1–39, 2022b.

A. Guha, N. Ho, và XL. Nguyen. On posterior contraction of parameters and interpretability in Bayesian mixture modeling. Bernoulli, 27(4):2159–2188, 2021.

A. Gulati, J. Qin, C. Chiu, N. Parmar, Y. Zhang, J. Yu, W. Han, S. Wang, Z. Zhang, Y. Wu, và R. Pang. Conformer: Convolution-augmented Transformer for Speech Recognition. In Proc. Interspeech 2020, pp. 5036–5040, 2020. doi: 10.21437/Interspeech.2020-3015.

S. Gupta, S. Mukherjee, K. Subudhi, E. Gonzalez, D. Jose, A. Awadallah, và J. Gao. Sparsely activated mixture-of-experts are robust multi-task learners. arXiv preprint arxiv 2204.0768, 2022.

X. Han, H. Nguyen, C. Harris, N. Ho, và S. Saria. Fusemoe: Mixture-of-experts transformers for fleximodal fusion. arXiv preprint arXiv:2402.03226, 2024.

H. Hazimeh, Z. Zhao, A. Chowdhery, M. Sathiamoorthy, Y. Chen, R. Mazumder, L. Hong, và Ed H. Chi. Dselect-k: Differentiable selection in the mixture of experts with applications to multi-task learning. In NeurIPS, 2021.

N. Ho và X. Nguyen. On strong identifiability and convergence rates of parameter estimation in finite mixtures. Electronic Journal of Statistics, 10:271–307, 2016.

N. Ho, C. Y. Yang, và M. I. Jordan. Convergence rates for Gaussian mixtures of experts. Journal of Machine Learning Research, 23(323):1–81, 2022.

N. Ho, K. Khamaru, R. Dwivedi, M. J. Wainwright, M. I. Jordan, và B. Yu. Instability, computational efficiency and statistical accuracy. Journal of Machine Learning Research, 2023.

R. A. Jacobs, M. I. Jordan, S. J. Nowlan, và G. E. Hinton. Adaptive mixtures of local experts. Neural Computation, 3, 1991.

M. I. Jordan và R. A. Jacobs. Hierarchical mixtures of experts and the EM algorithm. Neural Computation, 6:181–214, 1994.

J. Kwon và C. Caramanis. EM converges for a mixture of many linear regressions. In Silvia Chiappa và Roberto Calandra (eds.), Proceedings of the Twenty Third International Conference on Artificial Intelligence and Statistics, volume 108 of Proceedings of Machine Learning Research, pp. 1727–1736. PMLR, 26–28 Aug 2020.

J. Kwon, W. Qian, C. Caramanis, Y. Chen, và D. Davis. Global convergence of the em algorithm for mixtures of two component linear regression. In Alina Beygelzimer và Daniel Hsu (eds.), Proceedings of the Thirty-Second Conference on Learning Theory, volume 99 of Proceedings of Machine Learning Research, pp. 2055–2110. PMLR, 25–28 Jun 2019.

J. Kwon, N. Ho, và C. Caramanis. On the minimax optimality of the em algorithm for learning two-component mixed linear regression. In Arindam Banerjee và Kenji Fukumizu (eds.), Proceedings of The 24th International Conference on Artificial Intelligence and Statistics, volume 130 of Proceedings of Machine Learning Research, pp. 1405–1413. PMLR, 13–15 Apr 2021.

D. Lepikhin, H. Lee, Y. Xu, D. Chen, O. Firat, Y. Huang, M. Krikun, N. Shazeer, và Z. Chen. GShard: Scaling Giant Models with Conditional Computation and Automatic Sharding. In International Conference on Learning Representations, 2021.

B. Li, Y. Shen, J. Yang, Y. Wang, J. Ren, T. Che, J. Zhang, và Z. Liu. Sparse mixture-of-experts are domain generalizable learners. In The Eleventh International Conference on Learning Representations, 2023.

H. Liang, Z. Fan, R. Sarkar, Z. Jiang, T. Chen, K. Zou, Y. Cheng, C. Hao, và Z. Wang. M3ViT: Mixture-of-Experts Vision Transformer for Efficient Multi-task Learning with Model-Accelerator Co-design. In NeurIPS, 2022.

T. Manole và N. Ho. Refined convergence rates for maximum likelihood estimation under finite mixture models. In Proceedings of the 39th International Conference on Machine Learning, volume 162 of Proceedings of Machine Learning Research, pp. 14979–15006. PMLR, 17–23 Jul 2022.

T. Manole và A. Khalili. Estimating the number of components in finite mixture models via the group-sort-fuse procedure. The Annals of Statistics, 49(6):3043–3069, 2021.

H. Nguyen, TT. Nguyen, và N. Ho. Demystifying softmax gating function in Gaussian mixture of experts. In Advances in Neural Information Processing Systems, 2023.

H. Nguyen, TT. Nguyen, K. Nguyen, và N. Ho. Towards convergence rates for parameter estimation in Gaussian-gated mixture of experts. In Proceedings of The 27th International Conference on Artificial Intelligence and Statistics, 2024.

F. Peng, R. Jacobs, và M. Tanner. Bayesian Inference in Mixtures-of-Experts and Hierarchical Mixtures-of-Experts Models With an Application to Speech Recognition. Journal of the American Statistical Association, 91(435):953–960, 1996. ISSN 01621459.

Q. Pham, G. Do, H. Nguyen, TT. Nguyen, C. Liu, M. Sartipi, B. T. Nguyen, S. Ramasamy, X. Li, S. Hoi, và N. Ho. Competesmoe – effective training of sparse mixture of experts via competition. arXiv preprint arXiv:2402.02526, 2024.

C. Riquelme, J. Puigcerver, B. Mustafa, M. Neumann, R. Jenatton, A. Susano Pint, D. Keysers, và N. Houlsby. Scaling vision with sparse mixture of experts. In Advances in Neural Information Processing Systems, volume 34, pp. 8583–8595. Curran Associates, Inc., 2021.

A. Rives, J. Meier, T. Sercu, S. Goyal, Z. Lin, J. Liu, D. Guo, M. Ott, C. L. Zitnick, J. Ma, và R. Fergus. Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences. Proceedings of the National Academy of Sciences, 118, 2021.

N. Shazeer, A. Mirhoseini, K. Maziarz, A. Davis, Q. Le, G. Hinton, và J. Dean. Outrageously large neural networks: The sparsely-gated mixture-of-experts layer. In International Conference on Learning Representations, 2017.

B. Sturmfels. Solving Systems of Polynomial Equations. Providence, R.I, 2002.

H. Teicher. On the mixture of distributions. Annals of Statistics, 31:55–73, 1960.

H. Teicher. Identifiability of mixtures. Annals of Statistics, 32:244–248, 1961.

H. Teicher. Identifiability of finite mixtures. Ann. Math. Statist., 32:1265–1269, 1963.

S. van de Geer. Empirical Processes in M-estimation. Cambridge University Press, 2000.

C. Villani. Topics in Optimal Transportation. American Mathematical Society, 2003.

C. Villani. Optimal transport: Old and New. Springer, 2008.

Z. You, S. Feng, D. Su, và D. Yu. Speechmoe2: Mixture-of-experts model with improved routing. In IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), pp. 7217–7221, 2022.

Y. Zhou, N. Du, Y. Huang, D. Peng, C. Lan, D. Huang, S. Shakeri, D. So, A. Dai, Y. Lu, Z. Chen, Q. Le, C. Cui, J. Laudon, và J. Dean. Brainformers: Trading simplicity for efficiency. In International Conference on Machine Learning, pp. 42531–42542. PMLR, 2023.

--- TRANG 13 ---
Trong tài liệu bổ sung này, trước tiên chúng tôi cung cấp các chứng minh nghiêm ngặt cho tất cả kết quả dưới thiết lập chỉ định chính xác trong Phụ lục A, trong khi những chứng minh cho thiết lập chỉ định quá mức được trình bày trong Phụ lục B. Tiếp theo, chúng tôi nghiên cứu khả năng nhận dạng của hỗn hợp Gaussian cổng softmax thưa top-K (MoE) trong Phụ lục C. Sau đó chúng tôi thực hiện một số thí nghiệm số trong Phụ lục D để chứng minh thực nghiệm kết quả lý thuyết của chúng tôi. Cuối cùng, chúng tôi thiết lập lý thuyết cho ước lượng tham số và mật độ ngoài thiết lập MoE Gaussian softmax thưa top-K trong Phụ lục E.

A CHỨNG MINH CHO KẾT QUẢ DƯỚI THIẾT LẬP CHỈ ĐỊNH CHÍNH XÁC

Trong phụ lục này, chúng tôi trình bày chứng minh cho Định lý 1 trong Phụ lục A.1, trong khi chứng minh cho Định lý 2 được đưa ra trong Phụ lục A.2. Cuối cùng, chứng minh của Lemma 1 được cung cấp trong Phụ lục A.3.

A.1 CHỨNG MINH ĐỊNH LÝ 1

Trong phụ lục này, chúng tôi tiến hành phân tích hội tụ cho ước lượng mật độ trong MoE Gaussian cổng softmax thưa top-K sử dụng kỹ thuật chứng minh trong (van de Geer, 2000). Để làm điều đó, cần thiết phải giới thiệu một số ký hiệu thiết yếu và kết quả quan trọng trước.

Cho Pk∗(Θ) := {gG(Y|X) : G ∈ Ek∗(Ω)} là tập hợp tất cả các hàm mật độ có điều kiện của các độ đo hỗn hợp trong Ek∗(Ω). Tiếp theo, chúng tôi ký hiệu N(ε, Pk∗(Ω), ||·||1) là số bao phủ của không gian metric (Pk∗(Ω), ||·||1). Trong khi đó, HB(ε, Pk∗(Ω), h) biểu thị entropy bracketing của Pk∗(Ω) dưới khoảng cách Hellinger. Sau đó, chúng tôi cung cấp trong lemma sau cận trên của những số hạng đó.

Lemma 3. Nếu Ω là tập hợp bị chặn, thì các bất đẳng thức sau đúng với bất kỳ 0 < η < 1/2:
(i) log N(η, Pk∗(Ω), ||·||1) ≲ log(1/η);
(ii) HB(η, Pk∗(Ω), h) ≲ log(1/η).

Chứng minh Lemma 3 có trong Phụ lục A.1.2. Tiếp theo, chúng tôi ký hiệu

P̃k∗(Ω) := {g(G+G∗)/2(Y|X) : G ∈ Ek∗(Ω)};
P̃1/2k∗(Ω) := {g1/2(G+G∗)/2(Y|X) : G ∈ Ek∗(Ω)}.

Ngoài ra, với mỗi δ > 0, chúng tôi định nghĩa quả cầu Hellinger tập trung xung quanh hàm mật độ có điều kiện gG∗(Y|X) và gặp tập P̃1/2k∗(Ω) như

P̃1/2k∗(Ω, δ) := {g1/2 ∈ P̃1/2k∗(Ω) : h(g, gG∗) ≤ δ}.

Để nắm bắt kích thước của quả cầu Hellinger trên, van de Geer (2000) đề xuất sử dụng đại lượng sau:

JB(δ, P̃1/2k∗(Ω, δ)) := ∫δδ2/21 3H1/2B(t, P̃1/2k∗(Ω, t), ||·||)dt ∨ δ, (9)

trong đó t ∨ δ := max{t, δ}. Với những ký hiệu đó, hãy nhớ lại kết quả tiêu chuẩn cho ước lượng mật độ trong van de Geer (2000).

Lemma 4 (Định lý 7.4, van de Geer (2000)). Lấy Ψ(δ) ≥ JB(δ, P̃1/2k∗(Ω, δ)) sao cho Ψ(δ)/δ2 là hàm không tăng của δ. Sau đó, với dãy (δn) và hằng số phổ quát c nào đó thỏa mãn √nδ2n ≥ cΨ(δ), chúng ta có được

P[EX[h(gĜGn(·|X), gG∗(·|X))] > δ] ≤ c exp(-nδ2/c2),

với bất kỳ δ ≥ δn

Chứng minh Lemma 4 có thể tìm thấy trong van de Geer (2000). Bây giờ, chúng ta đã sẵn sàng cung cấp chứng minh cho tốc độ hội tụ của ước lượng mật độ trong Định lý 1 trong Phụ lục A.1.1.

A.1.1 CHỨNG MINH CHÍNH

Đáng chú ý rằng với bất kỳ t > 0, chúng ta có
HB(t, P̃1/2k∗(Ω, t), ||·||) ≤ HB(t, Pk∗(Ω, t), h).

Sau đó, tích phân trong phương trình (9) được chặn trên như sau:
JB(δ, P̃1/2k∗(Ω, δ)) ≤ ∫δδ2/21 3H1/2B(t, Pk∗(Ω, t), h)dt ∨ δ ≲ ∫δδ2/21 3log(1/t)dt ∨ δ, (10)

trong đó bất đẳng thức thứ hai theo từ phần (ii) của Lemma 3.

Kết quả là, bằng cách chọn Ψ(δ) = δ·√log(1/δ), chúng ta có thể xác minh rằng Ψ(δ)/δ2 là hàm không tăng của δ. Hơn nữa, bất đẳng thức trong phương trình (10) chỉ ra rằng Ψ(δ) ≥ JB(δ, P̃1/2k∗(Ω, δ)). Tiếp theo, hãy xem xét dãy (δn) được định nghĩa là δn := √log(n)/n. Dãy này có thể được xác nhận thỏa mãn điều kiện √nδ2n ≥ cΨ(δ) với hằng số phổ quát c nào đó. Do đó, bởi Lemma 4, chúng ta đạt được kết luận của Định lý 1:

P[EX[h(gĜGn(·|X), gG∗(·|X))] > C√log(n)/n] ≲ n-c,

với hằng số phổ quát C nào đó chỉ phụ thuộc vào Ω.

A.1.2 CHỨNG MINH LEMMA 3

Phần (i). Trong phần này, chúng tôi sẽ dẫn xuất cận trên sau cho số bao phủ của không gian metric (Pk∗(Ω), ||·||1) với bất kỳ 0 < η < 1/2 cho tập hợp bị chặn Ω:
log N(η, Pk∗(Ω), ||·||1) ≲ log(1/η).

Để bắt đầu, chúng tôi định nghĩa Θ := {(a, b, σ) ∈ Rd × R × R+ : (β0, β1, a, b, σ) ∈ Ω}. Chú ý rằng Ω là tập hợp bị chặn, thì Θ cũng có tính chất này. Do đó, tồn tại η-cover của Θ, ký hiệu là Θη. Ngoài ra, chúng tôi cũng định nghĩa Δ := {(β0, β1) ∈ R × Rd : (β0, β1, a, b, σ) ∈ Ω}, và Δη là η-cover của Δ. Sau đó, có thể xác nhận rằng |Θη| ≤ O(η-(d+1)k∗) và |Δη| ≤ O(η-(d+3)k∗).

Tiếp theo, với mỗi G = ∑k∗i=1 exp(β0i)δ(β1i,ai,bi,σi) ∈ Ek∗(Ω), chúng tôi xem xét hai độ đo hỗn hợp khác. Độ đo đầu tiên là G' = ∑k∗i=1 exp(β0i)δ(β1i,āi,b̄i,σ̄i), trong đó (āi, b̄i, σ̄i) ∈ Θη là điểm gần nhất với (ai, bi, σi) trong tập này với tất cả i ∈ [k∗]. Độ đo thứ hai là Ḡ := ∑k∗i=1 exp(β̄0i)δ(β̄1i,āi,b̄i,σ̄i) trong đó (β̄0i, β̄1i) ∈ Δη với bất kỳ i ∈ [k∗]. Tiếp theo, hãy định nghĩa

T := {gḠ ∈ Pk∗(Ω) : (β̄0i, β̄1i) ∈ Δη, (āi, b̄i, σ̄i) ∈ Θη, ∀i ∈ [k∗]},

thì rõ ràng gḠ ∈ T. Bây giờ, chúng tôi sẽ chỉ ra rằng T là η-cover của không gian metric (Pk∗(Ω), ||·||1) với lưu ý rằng nó không nhất thiết là cover nhỏ nhất. Thực vậy, theo bất đẳng thức tam giác,
||gG - gḠ||1 ≤ ||gG - gG'||1 + ||gG' - gḠ||1. (11)

Số hạng đầu tiên ở vế phải có thể được chặn trên như sau:
||gG - gG'||1 ≤ ∑k∗i=1 ∫X×Y |f(Y|a⊤iX + bi, σi) - f(Y|ā⊤iX + b̄i, σ̄i)|d(X, Y)
≲ ∑k∗i=1 ∫X×Y (||ai - āi|| + ||bi - b̄i|| + ||σi - σ̄i||) d(X, Y)
= ∑k∗i=1 (||ai - āi|| + ||bi - b̄i|| + ||σi - σ̄i||)
≲ η. (12)

Tiếp theo, chúng tôi cũng sẽ chứng minh rằng ||gG' - gḠ||1 ≲ η. Để làm điều đó, hãy xem xét q := (k choose K) tập con K phần tử của {1, . . . , k}, được giả định có dạng {ℓ1, ℓ2, . . . , ℓK} với bất kỳ ℓ ∈ [q]. Ngoài ra, chúng tôi cũng ký hiệu {ℓK+1, . . . , ℓk} := {1, . . . , k} \ {ℓ1, . . . , ℓK} với bất kỳ ℓ ∈ [q]. Sau đó, chúng tôi định nghĩa

Xℓ := {x ∈ X : β⊤1ix ≥ β⊤1i'x : i ∈ {ℓ1, . . . , ℓK}, i' ∈ {ℓK+1, . . . , ℓk∗}},
X̄ℓ := {x ∈ X : β̄⊤1ix ≥ β̄⊤1i'x : i ∈ {ℓ1, . . . , ℓK}, i' ∈ {ℓK+1, . . . , ℓk∗}}.

Bằng cách sử dụng các lập luận tương tự như trong chứng minh Lemma 1 trong Phụ lục A.3, chúng ta đạt được Xℓ = X̄ℓ hoặc Xℓ có độ đo bằng không với bất kỳ ℓ ∈ [q]. Vì hàm Softmax khả vi, nó là hàm Lipschitz với hằng số Lipschitz L ≥ 0 nào đó. Vì X là tập hợp bị chặn, chúng ta có thể giả định rằng ||X|| ≤ B với bất kỳ X ∈ X. Tiếp theo, chúng tôi ký hiệu

πℓ(X) := [β⊤1ℓix + β⊤0ℓi]Ki=1; π̄ℓ(X) := [β̄⊤1ℓix + β̄⊤0ℓi]Ki=1,

với bất kỳ tập con K phần tử {ℓ1, . . . ℓK} của {1, . . . , k∗}. Sau đó, chúng ta có

||Softmax(πℓ(X)) - Softmax(π̄ℓ(X))|| ≤ L·||πℓ(X) - π̄ℓ(X)||
≤ L·∑Ki=1 (||β1ℓi - β̄1ℓi||·||X|| + |β0ℓi - β̄0ℓi|)
≤ L·∑Ki=1 (ηB + η)
≲ η.

Quay lại chứng minh cho ||gG' - gḠ||1 ≲ η, từ kết quả trên chúng ta có

||gG' - gḠ||1 = ∫X×Y |gG'(Y|X) - gḠ(Y|X)|d(X, Y)
≤ ∑qℓ=1 ∫Xℓ×Y |gG'(Y|X) - gḠ(Y|X)|d(X, Y)
≤ ∑qℓ=1 ∫Xℓ×Y ∑Ki=1 |Softmax(πℓ(X)i) - Softmax(π̄ℓ(X)i)|·f(Y|ā⊤ℓiX + b̄ℓi, σ̄ℓi)d(X, Y)
≲ η, (13)

Từ kết quả trong các phương trình (11), (12) và (13), chúng tôi suy ra rằng ||gG - gḠ||1 ≲ η. Điều này có nghĩa là T là η-cover của không gian metric (Pk∗(Ω), ||·||1). Do đó, chúng ta đạt được

N(η, Pk∗(Ω), ||·||1) ≲ |Δη| × |Θη| ≤ O(1/η(d+3)k),

dẫn đến kết luận của phần này
log N(η, Pk∗(Ω), ||·||1) ≲ log(1/η).

Phần (ii). Chuyển đến phần này, chúng tôi sẽ cung cấp cận trên cho entropy bracketing của Pk∗(Ω) dưới khoảng cách Hellinger:
HB(η, Pk∗(Ω), h) ≲ log(1/η).

Nhớ lại rằng Θ và X là các tập hợp bị chặn, chúng ta có thể tìm thấy các hằng số dương -γ ≤ a⊤X + b ≤ γ và u1 ≤ σ ≤ u2. Hãy định nghĩa

Q(Y|X) := {
1/(√2πu1) exp(-Y²/(8u²₂)), cho |Y| ≥ 2γ
1/(√2πu1), cho |Y| < 2γ
}

Sau đó, có thể xác nhận rằng f(Y|a⊤X + b, σ) ≤ Q(X, Y) với bất kỳ (X, Y) ∈ X × Y.

Tiếp theo, cho τ ≤ η sẽ được chọn sau và {g1, . . . , gN} là τ-cover của không gian metric (Pk∗(Ω), ||·||1) với số bao phủ N := N(τ, Pk∗(Ω), ||·||1). Ngoài ra, chúng tôi cũng xem xét brackets có dạng [Ψᴸᵢ(Y|X), Ψᵁᵢ(Y|X)] trong đó

Ψᴸᵢ(Y|X) := max{gi(Y|X) - τ, 0}
Ψᵁᵢ(Y|X) := max{gi(Y|X) + τ, Q(Y|X)}.

Sau đó, chúng ta có thể kiểm tra rằng Pk∗(Ω) ⊆ ∪ᴺᵢ₌₁[Ψᴸᵢ(Y|X), Ψᵁᵢ(Y|X)] và Ψᵁᵢ(Y|X) - Ψᴸᵢ(Y|X) ≤ min{2η, Q(Y|X)}. Cho S := max{2γ, √8u₂} log(1/τ), chúng ta có với bất kỳ i ∈ [N] rằng

||Ψᵁᵢ - Ψᴸᵢ||₁ = ∫|Y|<2γ [Ψᵁᵢ(Y|X) - Ψᴸᵢ(Y|X)] dXdY + ∫|Y|≥2γ [Ψᵁᵢ(Y|X) - Ψᴸᵢ(Y|X)] dXdY
≤ Sτ + exp(-S²/(2u₂))
≤ S'τ,

trong đó S' là hằng số dương nào đó. Bất đẳng thức này chỉ ra rằng
HB(S'τ, Pk∗(Ω), ||·||₁) ≤ log N(τ, Pk∗(Ω), ||·||₁) ≤ log(1/τ).

Bằng cách đặt τ = η/S', chúng ta có được HB(η, Pk∗(Ω), ||·||₁) ≲ log(1/η). Cuối cùng, vì chuẩn ||·||₁ được chặn trên bởi khoảng cách Hellinger, chúng ta đạt được kết luận của phần này:
HB(η, Pk∗(Ω), h) ≲ log(1/η).

Do đó, chứng minh hoàn tất.

A.2 CHỨNG MINH ĐỊNH LÝ 2

Vì khoảng cách Hellinger được chặn dưới bởi khoảng cách Total Variation, tức là h ≥ V, chúng tôi sẽ chứng minh cận dưới Total Variation sau:
EX[V(gG(·|X), gG∗(·|X))] ≳ D1(G, G∗),

sau đó được chia thành phần local và phần global như sau:
inf{G∈Ek∗(Ω):D1(G,G∗)≤ε'} EX[V(gG(·|X), gG∗(·|X))]/D1(G, G∗) > 0, (14)
inf{G∈Ek∗(Ω):D1(G,G∗)>ε'} EX[V(gG(·|X), gG∗(·|X))]/D1(G, G∗) > 0, (15)

với hằng số ε' > 0 nào đó.

Chứng minh khẳng định (14): Đủ để chỉ ra rằng
lim{ε→0} inf{G∈Ek∗(Ω):D1(G,G∗)≤ε} EX[V(gG(·|X), gG∗(·|X))]/D1(G, G∗) > 0.

Giả sử bất đẳng thức này không đúng, thì vì số lượng chuyên gia k∗ đã biết trong trường hợp này, tồn tại dãy độ đo hỗn hợp Gn := ∑k∗i=1 exp(βⁿ0i)δ(βⁿ1i,aⁿi,bⁿi,σⁿi) ∈ Ek∗(Ω) sao cho cả D1(Gn, G∗) và EX[V(gGn(·|X), gG∗(·|X))]/D1(Gn, G∗) đều tiến về không khi n tiến tới vô cùng. Bây giờ, chúng tôi định nghĩa

Cⁿj = Cj(Gn) := {i ∈ [k∗] : ||ωⁿi - ω∗j|| ≤ ||ωⁿi - ω∗s||, ∀s ≠ j},

với bất kỳ j ∈ [k∗] như k∗ Voronoi cells đối với độ đo hỗn hợp Gn, trong đó chúng tôi ký hiệu ωⁿi := (βⁿ1i, aⁿi, bⁿi, σⁿi) và ω∗j := (β∗1j, a∗j, b∗j, σ∗j). Vì chúng tôi sử dụng lập luận tiệm cận trong chứng minh này, chúng ta có thể giả định không mất tính tổng quát (WLOG) rằng những Voronoi cells này không phụ thuộc vào n, tức là Cj = Cⁿj. Tiếp theo, từ giả thiết D1(Gn, G∗) → 0 khi n → ∞ rằng mỗi Voronoi cell chỉ chứa một phần tử. Do đó, chúng tôi tiếp tục giả định WLOG rằng Cj = {j} với bất kỳ j ∈ [k∗], có nghĩa là (βⁿ1j, aⁿj, bⁿj, σⁿj) → (β∗1j, a∗j, b∗j, σ∗j) và exp(βⁿ0j) → exp(β∗0j) khi n → ∞.

Tiếp theo, để xác định lựa chọn K hàng đầu trong các công thức của gGn(Y|X) và gG∗(Y|X), chúng tôi chia không gian hiệp biến X thành một số tập con theo hai cách. Cụ thể, trước tiên chúng tôi xem xét q := (k∗ choose K) tập con K phần tử khác nhau của [k∗], được giả định có dạng {ℓ1, . . . , ℓK}, với ℓ ∈ [q]. Ngoài ra, chúng tôi ký hiệu {ℓK+1, . . . , ℓk∗} := [k∗] \ {ℓ1, . . . , ℓK}. Sau đó, chúng tôi định nghĩa với mỗi ℓ ∈ [q] hai tập con sau của X:

Xⁿℓ := {x ∈ X : (βⁿ1j)⊤x ≥ (βⁿ1j')⊤x : ∀j ∈ {ℓ1, . . . , ℓK}, j' ∈ {ℓK+1, . . . , ℓk∗}},
X∗ℓ := {x ∈ X : (β∗1j)⊤x ≥ (β∗1j')⊤x : ∀j ∈ {ℓ1, . . . , ℓK}, j' ∈ {ℓK+1, . . . , ℓk∗}}.

Vì (βⁿ0j, βⁿ1j) → (β∗0j, β∗1j) khi n → ∞ với bất kỳ j ∈ [k∗], chúng ta có với bất kỳ ηj > 0 tùy ý nhỏ rằng ||βⁿ1j - β∗1j|| ≤ ηj và |βⁿ0j - β∗0j| ≤ ηj với n đủ lớn. Bằng cách áp dụng Lemma 1, chúng ta có được Xⁿℓ = X∗ℓ với bất kỳ ℓ ∈ [q] với n đủ lớn. WLOG, chúng tôi giả định rằng

D1(Gn, G∗) = ∑Ki=1 [exp(βⁿ0i)(||Δβⁿ1i|| + ||Δaⁿi|| + ||Δbⁿi|| + ||Δσⁿi||) + |exp(βⁿ0i) - exp(β∗0i)|],

trong đó chúng tôi ký hiệu Δβⁿ1i := βⁿ1i - β∗1i, Δaⁿi := aⁿi - a∗i, Δbⁿi := bⁿi - b∗i và Δσⁿi := σⁿi - σ∗i.

Cho ℓ ∈ [q] sao cho {ℓ1, . . . , ℓK} = {1, . . . , K}. Sau đó, với hầu chắc chắn (X, Y) ∈ X∗ℓ × Y, chúng ta có thể viết lại các mật độ có điều kiện gGn(Y|X) và gG∗(Y|X) như

gGn(Y|X) = ∑Ki=1 [exp((βⁿ1i)⊤X + βⁿ0i) / ∑Kj=1 exp((βⁿ1j)⊤X + βⁿ0j)] · f(Y|(aⁿi)⊤X + bⁿi, σⁿi),
gG∗(Y|X) = ∑Ki=1 [exp((β∗1i)⊤X + β∗0i) / ∑Kj=1 exp((β∗1j)⊤X + β∗0j)] · f(Y|(a∗i)⊤X + b∗i, σ∗i).

Bây giờ, chúng tôi chia phần còn lại của lập luận thành ba bước:

Bước 1 - Khai triển Taylor:
Trong bước này, chúng tôi xem xét Hn := [∑Ki=1 exp((β∗1i)⊤X + β∗0i)] · [gGn(Y|X) - gG∗(Y|X)]. Sau đó, Hn có thể được biểu diễn như sau:

Hn = ∑Ki=1 exp(βⁿ0i)[exp((βⁿ1i)⊤X)f(Y|(aⁿi)⊤X + bⁿi, σⁿi) - exp((β∗1i)⊤X)f(Y|(a∗i)⊤X + b∗i, σ∗i)]
- ∑Ki=1 exp(βⁿ0i)[exp((βⁿ1i)⊤X)gGn(Y|X) - exp((β∗1i)⊤X)gGn(Y|X)]
+ ∑Ki=1 [exp(βⁿ0i) - exp(β∗0i)][exp((β∗1i)⊤X)f(Y|(a∗i)⊤X + b∗i, σ∗i) - exp((β∗1i)⊤X)gGn(Y|X)].

Bằng cách áp dụng khai triển Taylor bậc nhất cho số hạng đầu tiên trong biểu diễn trên, được ký hiệu là An, chúng ta có

An = ∑Ki=1 ∑|α|=1 [exp(βⁿ0i)/α!] · (Δβⁿ1i)^α1(Δaⁿi)^α2(Δbⁿi)^α3(Δσⁿi)^α4
× X^(α1+α2) exp((β∗1i)⊤X) · [∂^|α2|+α3+α4 f / ∂h1^|α2|+α3 ∂σ^α4](Y|(a∗i)⊤X + b∗i, σ∗i) + R1(X, Y),

trong đó R1(X, Y) là số dư Taylor thỏa mãn R1(X, Y)/D'1(X, Y) → 0 khi n → ∞. Nhớ lại rằng f là mật độ Gaussian đơn biến, thì chúng ta có

[∂^α4 f / ∂σ^α4](Y|(a∗i)⊤X + b∗i, σ∗i) = (1/2^α4) · [∂^2α4 f / ∂h1^2α4](Y|(a∗i)⊤X + b∗i, σ∗i),

dẫn đến

An = ∑Ki=1 ∑|α|=1 [exp(βⁿ0i) / (2^α4 α!)] · (Δβⁿ1i)^α1(Δaⁿi)^α2(Δbⁿi)^α3(Δσⁿi)^α4
× X^(α1+α2) exp((β∗1i)⊤X) · [∂^|α2|+α3+2α4 f / ∂h1^|α2|+α3+2α4](Y|(a∗i)⊤X + b∗i, σ∗i) + R1(X, Y)
= ∑Ki=1 ∑2_{|η1|+η2=1} ∑_{α∈Jη1,η2} [exp(βⁿ0i) / (2^α4 α!)] · (Δβⁿ1i)^α1(Δaⁿi)^α2(Δbⁿi)^α3(Δσⁿi)^α4
× X^η1 exp((β∗1i)⊤X) · [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i) + R1(X, Y), (16)

trong đó chúng tôi ký hiệu η1 = α1 + α2 ∈ N^d, η2 = |α2| + α3 + 2α4 ∈ N và tập chỉ số
Jη1,η2 := {(αi)4i=1 ∈ N^d × N^d × N × N : α1 + α2 = η1, α3 + 2α4 = η2 - |α2|}. (17)

Bằng cách lập luận tương tự cho số hạng thứ hai trong biểu diễn của Hn, chúng ta cũng có

Bn := -∑Ki=1 ∑|γ|=1 [exp(βⁿ0i)/γ!](Δβⁿ1i) · X^γ exp((βⁿ1i)⊤X)gGn(Y|X) + R2(X, Y),

trong đó R2(X, Y) là số dư Taylor sao cho R2(X, Y)/D1(Gn, G∗) → 0 khi n → ∞. Kết hợp các kết quả trên lại, chúng tôi viết lại đại lượng Hn như sau:

Hn = ∑Ki=1 ∑0≤|η1|+η2≤2 Uⁿi,η1,η2 · X^η1 exp((β∗1i)⊤X) [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i)
+ ∑Ki=1 ∑0≤|γ|≤1 Wⁿi,γ · X^γ exp((β∗1i)⊤X)gGn(Y|X) + R1(X, Y) + R2(X, Y), (18)

trong đó chúng tôi định nghĩa tương ứng với mỗi i ∈ [K] rằng

Uⁿi,η1,η2 := ∑α∈Jη1,η2 [exp(βⁿ0i) / (2^α4 α!)] · (Δβⁿ1i)^α1(Δaⁿi)^α2(Δbⁿi)^α3(Δσⁿi)^α4,
Wⁿi,γ := -[exp(βⁿ0i)/γ!](Δβⁿ1i)^γ,

với bất kỳ (η1, η2) ≠ (0d, 0) và |γ| ≠ 0d. Nếu không, Uⁿi,0d,0 = -Wⁿi,0d := exp(βⁿ0i) - exp(β∗0i).

Bước 2 - Các hệ số không triệt tiêu:
Chuyển đến bước thứ hai, chúng tôi sẽ chỉ ra rằng không phải tất cả các tỷ số Uⁿi,η1,η2/D1(Gn, G∗) đều tiến về không khi n tiến tới vô cùng. Giả sử ngược lại rằng tất cả chúng đều tiến về không khi n → ∞, thì với (η1, η2) = (0d, 0), từ đó

[1/D1(Gn, G∗)] · ∑Ki=1 |exp(βⁿ0i) - exp(β∗0i)| = ∑Ki=1 |Uⁿj,η1,η2| / D1(Gn, G∗) → 0. (19)

Ngoài ra, với các tuple (η1, η2) trong đó η1 ∈ {e1, e2, . . . , ed} với ej := (0, . . . , 0, 1|{z}_j-th, 0, . . . , 0) và η2 = 0, chúng ta có

[1/D1(Gn, G∗)] · ∑Ki=1 exp(βⁿ0i)||Δβⁿ1i||1 = ∑Ki=1 |Uⁿj,η1,η2| / D1(Gn, G∗) → 0.

Bằng cách sử dụng các lập luận tương tự, chúng ta cuối cùng có

[1/D1(Gn, G∗)] · ∑Ki=1 exp(βⁿ0i)[||Δβⁿ1i||1 + ||Δaⁿi||1 + |Δbⁿi| + |Δσⁿi|] → 0.

Do tính tương đương tô-pô giữa chuẩn-1 và chuẩn-2, giới hạn trên có nghĩa là

[1/D1(Gn, G∗)] · ∑Ki=1 exp(βⁿ0i)[||Δβⁿ1i|| + ||Δaⁿi|| + |Δbⁿi| + |Δσⁿi|] → 0. (20)

Kết hợp phương trình (19) với phương trình (20), chúng tôi suy ra rằng D1(Gn, G∗)/D1(Gn, G∗) → 0, đây là mâu thuẫn. Do đó, ít nhất một trong các tỷ số Uⁿi,η1,η2/D1(Gn, G∗) không triệt tiêu khi n tiến tới vô cùng.

Bước 3 - Mâu thuẫn Fatou:
Hãy ký hiệu mn là giá trị tối đa của giá trị tuyệt đối của Uⁿi,η1,η2/D1(Gn, G∗) và Wⁿi,γ/D1(Gn, G∗). Từ kết quả đạt được trong Bước 2 rằng 1/mn ↛ ∞.

Nhớ lại từ giả thiết rằng EX[V(gGn(·|X), gG∗(·|X))]/D1(Gn, G∗) → 0 khi n → ∞. Do đó, bởi bổ đề Fatou, chúng ta có

0 = lim_{n→∞} EX[V(gGn(·|X), gG∗(·|X))]/D1(Gn, G∗) ≥ (1/2) · ∫ lim inf_{n→∞} |gGn(Y|X) - gG∗(Y|X)|/D1(Gn, G∗) dXdY.

Kết quả này chỉ ra rằng |gGn(Y|X) - gG∗(Y|X)|/D1(Gn, G∗) tiến về không khi n tiến tới vô cùng với hầu chắc chắn (X, Y). Kết quả là, từ đó

lim_{n→∞} Hn/(mnD1(Gn, G∗)) = lim_{n→∞} |gGn(Y|X) - gG∗(Y|X)|/(mnD1(Gn, G∗)) = 0.

Tiếp theo, hãy ký hiệu Uⁿi,η1,η2/[mnD1(Gn, G∗)] → τi,η1,η2 và Wⁿi,γ/[mnD1(Gn, G∗)] → κi,γ với lưu ý rằng ít nhất một trong số chúng khác không. Từ công thức của Hn trong phương trình (18), chúng tôi suy ra rằng

∑Ki=1 ∑0≤|η1|+η2≤2 τi,η1,η2 · X^η1 exp((β∗1i)⊤X) [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i)
+ ∑Ki=1 ∑0≤|γ|≤1 κi,γ · X^γ exp((β∗1i)⊤X)gG∗(Y|X) = 0, (21)

với hầu chắc chắn (X, Y). Phương trình này tương đương với

∑Ki=1 ∑0≤|η1|≤1 [∑0≤η2≤2-|γ| τi,η1,η2 [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i) + κi,η1 gG∗(Y|X)] × X^η1 exp((β∗1i)⊤X) = 0,

với hầu chắc chắn (X, Y). Chú ý rằng β∗11, . . . , β∗1K có các giá trị khác nhau từng đôi, thì {exp((β∗1i)⊤X) : i ∈ [K]} là tập hợp độc lập tuyến tính, dẫn đến

∑0≤η2≤2-|γ| τi,η1,η2 [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i) + κi,η1 gG∗(Y|X) X^η1 = 0,

với bất kỳ i ∈ [K] với hầu chắc chắn (X, Y). Rõ ràng rằng vế trái của phương trình trên là đa thức của X thuộc tập compact X. Kết quả là, chúng ta có

∑0≤η2≤2-|γ| τi,η1,η2 [∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i) + κi,η1 gG∗(Y|X) = 0,

với bất kỳ i ∈ [K], 0 ≤ |η1| ≤ 1 và hầu chắc chắn (X, Y). Vì (a∗1, b∗1, σ∗1), . . . , (a∗K, b∗K, σ∗K) có các giá trị khác nhau từng đôi, những giá trị của ((a∗1)⊤X + b∗1, σ∗1), . . . , ((a∗K)⊤X + b∗K, σ∗K) cũng khác nhau từng đôi. Do đó, tập hợp {[∂^η2 f / ∂h1^η2](Y|(a∗i)⊤X + b∗i, σ∗i), gG∗(Y|X) : i ∈ [K]} độc lập tuyến tính. Do đó, chúng ta có được τi,η1,η2 = κi,γ = 0 với bất kỳ i ∈ [K], 0 ≤ |η1| + η2 ≤ 2 và 0 ≤ |γ| ≤ 1, mâu thuẫn với thực tế rằng ít nhất một trong những số hạng này khác không.

Do đó, chúng ta có thể tìm thấy hằng số ε' > 0 nào đó sao cho
inf{G∈Ek∗(Ω):D1(G,G∗)≤ε'} EX[V(gG(·|X), gG∗(·|X))]/D1(G, G∗) > 0.

Chứng minh khẳng định (15): Giả sử ngược lại rằng khẳng định này không đúng, thì chúng ta có thể tìm kiếm dãy G'n ∈ Ek∗(Ω) sao cho D1(G'n, G∗) > ε' và
lim_{n→∞} EX[V(gG'n(·|X), gG∗(·|X))]/D1(G'n, G∗) = 0,

trực tiếp có nghĩa là EX[V(gG'n(·|X), gG∗(·|X))] → 0 khi n → ∞. Nhớ lại rằng Ω là tập compact, do đó, chúng ta có thể thay thế dãy G'n bằng một trong các dãy con của nó hội tụ về độ đo hỗn hợp G' ∈ Ek∗(Ω). Vì D1(G'n, G∗) > ε', kết quả này dẫn đến D1(G', G∗) > ε'.

Tiếp theo, bằng bổ đề Fatou, chúng ta đạt được
0 = lim_{n→∞} EX[2V(gG'n(·|X), gG∗(·|X))] ≥ ∫ lim inf_{n→∞} |gG'n(Y|X) - gG∗(Y|X)| dμ(Y)ν(X).

Từ đó gG'(Y|X) = gG∗(Y|X) với hầu chắc chắn (X, Y). Từ Mệnh đề 2, chúng ta biết rằng hỗn hợp Gaussian cổng softmax thưa top-K có thể nhận dạng được, do đó, chúng ta có được G' ≡ G∗. Kết quả là, D1(G', G∗) = 0, mâu thuẫn với thực tế rằng D1(G', G∗) > ε' > 0.

Do đó, chứng minh hoàn tất.

A.3 CHỨNG MINH LEMMA 1

Cho ηi = Miε, trong đó ε là hằng số dương cố định nào đó và Mi sẽ được chọn sau. Với ℓ ∈ [q] tùy ý, vì X và Ω là các tập hợp bị chặn, tồn tại hằng số c∗ℓ ≥ 0 sao cho

min_{x,i,i'} [(β∗1i)⊤x - (β∗1i')⊤x] = c∗ℓε, (22)

trong đó giá trị tối thiểu tuân theo x ∈ X∗ℓ, i ∈ {ℓ1, . . . , ℓK} và i' ∈ {ℓK+1, . . . , ℓk∗}. Chúng tôi sẽ chỉ ra rằng c∗ℓ > 0. Giả sử ngược lại rằng c∗ℓ = 0. Với x ∈ X∗ℓ, chúng ta có thể giả định với bất kỳ 1 ≤ i < j ≤ k∗ rằng
(β∗1ℓi)⊤x ≥ (β∗1ℓj)⊤x.

Vì c∗ℓ = 0, từ phương trình (22) rằng (β∗1ℓK)⊤x - (β∗1ℓK+1)⊤x = 0, hoặc tương đương
(β∗1ℓK - β∗1ℓK+1)⊤x = 0.

Nói cách khác, X∗ℓ là tập con của
Z := {x ∈ X : (β∗1ℓK - β∗1ℓK+1)⊤x = 0}.

Vì β1ℓK - β1ℓK+1 ≠ 0d và phân phối của X liên tục, từ đó tập Z có độ đo bằng không. Vì X∗ℓ ⊆ Z, chúng ta có thể kết luận rằng X∗ℓ cũng có độ đo bằng không, mâu thuẫn với giả thiết của Lemma 1. Do đó, chúng ta phải có c∗ℓ > 0.

Vì X là tập hợp bị chặn, chúng ta giả định rằng ||x|| ≤ B với bất kỳ x ∈ X. Cho x ∈ X∗ℓ, thì chúng ta có với bất kỳ i ∈ {ℓ1, . . . , ℓK} và i' ∈ {ℓK+1, . . . , ℓk∗} rằng

β⊤1ix = (β1i - β∗1i)⊤x + (β∗1i)⊤x
≥ -MiεB + (β∗1i')⊤x + c∗ℓε
= -MiεB + c∗ℓε + (β∗1i' - β1i')⊤x + β⊤1i'x
≥ -2MiεB + c∗ℓε + β⊤1i'x.

Bằng cách đặt Mi ≤ c∗ℓ/(2B), chúng ta có x ∈ Xℓ, có nghĩa là X∗ℓ ⊆ Xℓ. Tương tự, giả sử rằng tồn tại hằng số cℓ ≥ 0 thỏa mãn

min_{x,i,i'} [(β∗1i)⊤x - (β∗1i')⊤x] = c∗ℓε.

Ở đây, giá trị tối thiểu trên tuân theo x ∈ Xℓ, i ∈ {ℓ1, . . . , ℓK} và i' ∈ {ℓK+1, . . . , ℓk∗}. Nếu Mi ≤ cℓ/(2B), thì chúng ta cũng nhận được Xℓ ⊆ X∗ℓ.

Do đó, nếu chúng ta đặt Mi = (1/(2B)) min{c∗ℓ, cℓ}, chúng ta đạt được kết luận rằng X∗ℓ = Xℓ.

B CHỨNG MINH CHO KẾT QUẢ DƯỚI THIẾT LẬP CHỈ ĐỊNH QUÁ MỨC

Trong phụ lục này, trước tiên chúng tôi cung cấp chứng minh của Định lý B.1 và Định lý 4 trong Phụ lục B.1 và Phụ lục B.2 tương ứng. Tiếp theo, chúng tôi trình bày chứng minh cho Mệnh đề 1 trong Phụ lục B.3, trong khi chứng minh cho Lemma 2 được đặt trong Phụ lục B.4.

[Tiếp tục dịch phần còn lại theo cách tương tự...]
