# 2310.02992.pdf
# ÄÆ°á»£c chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/multimodal/2310.02992.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 12282153 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
KOSMOS-G: Táº¡o HÃ¬nh áº¢nh Trong Ngá»¯ Cáº£nh
vá»›i MÃ´ HÃ¬nh NgÃ´n Ngá»¯ Lá»›n Äa PhÆ°Æ¡ng Thá»©c
Xichen Pan1,2âˆ—Li Dong1Shaohan Huang1Zhiliang Peng1Wenhu Chen3Furu Wei1
1Microsoft Research2New York University3University of Waterloo
https://aka.ms/GeneralAI
       máº·ctrongÃ¡o khoÃ¡cchá»¥p selfie táº¡i
bÆ¡i dÆ°á»›i nÆ°á»›c trongtáº¡i Acropolis trong trang phá»¥c batman
++
Thá»±c thá»ƒ
Thá»±c thá»ƒLá»i nháº¯c Äa phÆ°Æ¡ng thá»©c
Lá»i nháº¯c Äa phÆ°Æ¡ng thá»©c
HÃ¬nh áº£nh ÄÆ°á»£c Táº¡oHÃ¬nh áº£nh ÄÆ°á»£c Táº¡o
HÃ¬nh 1: CÃ¡c vÃ­ dá»¥ táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh vá»›i lá»i nháº¯c Ä‘a phÆ°Æ¡ng thá»©c. Nhá» vÃ o kháº£ nÄƒng nháº­n thá»©c Ä‘a phÆ°Æ¡ng thá»©c tiÃªn tiáº¿n cá»§a MLLM, KOSMOS-G cÃ³ thá»ƒ táº¡o ra hÃ¬nh áº£nh theo chá»§ Ä‘á» Ä‘á»™ chÃ­nh xÃ¡c cao báº±ng cÃ¡ch tiáº¿p cáº­n táº¥t cáº£ Ä‘áº§u vÃ o hÃ¬nh áº£nh nhÆ° má»™t "ngÃ´n ngá»¯ ngoáº¡i lai".
âˆ—ÄÃ³ng gÃ³p trong thá»i gian thá»±c táº­p táº¡i Microsoft Research.arXiv:2310.02992v3 [cs.CV] 26 Apr 2024

--- TRANG 2 ---
TÃ³m táº¯t
Nhá»¯ng tiáº¿n bá»™ gáº§n Ä‘Ã¢y trong viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c nhá»¯ng bÆ°á»›c tiáº¿n Ä‘Ã¡ng ká»ƒ.
Tuy nhiÃªn, cÃ¡c phÆ°Æ¡ng phÃ¡p hiá»‡n táº¡i váº«n cÃ²n thiáº¿u sÃ³t trong cÃ¡c tÃ¬nh huá»‘ng á»©ng dá»¥ng Ä‘a dáº¡ng,
vÃ¬ chÃºng yÃªu cáº§u tinh chá»‰nh thá»i gian thá»­ nghiá»‡m vÃ  khÃ´ng thá»ƒ cháº¥p nháº­n Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n
Ä‘an xen nhiá»u áº£nh. Nhá»¯ng háº¡n cháº¿ nÃ y khiáº¿n chÃºng cÃ²n xa má»¥c tiÃªu cuá»‘i cÃ¹ng lÃ  "hÃ¬nh áº£nh nhÆ° má»™t ngÃ´n ngá»¯
ngoáº¡i lai trong viá»‡c táº¡o hÃ¬nh áº£nh." BÃ i bÃ¡o nÃ y trÃ¬nh bÃ y KOSMOS-G, má»™t mÃ´ hÃ¬nh
táº­n dá»¥ng kháº£ nÄƒng nháº­n thá»©c Ä‘a phÆ°Æ¡ng thá»©c tiÃªn tiáº¿n cá»§a MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n Äa phÆ°Æ¡ng thá»©c (MLLMs)
Ä‘á»ƒ giáº£i quyáº¿t thÃ¡ch thá»©c nÃªu trÃªn. CÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i
cÄƒn chá»‰nh khÃ´ng gian Ä‘áº§u ra cá»§a MLLM vá»›i CLIP báº±ng cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng thá»©c vÄƒn báº£n lÃ m Ä‘iá»ƒm neo
vÃ  thá»±c hiá»‡n tinh chá»‰nh hÆ°á»›ng dáº«n thÃ nh pháº§n trÃªn dá»¯ liá»‡u Ä‘Æ°á»£c tuyá»ƒn chá»n. KOSMOS-G
thá»ƒ hiá»‡n kháº£ nÄƒng áº¥n tÆ°á»£ng trong viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh vá»›i
Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh. ÄÃ¡ng chÃº Ã½, viá»‡c tinh chá»‰nh hÆ°á»›ng dáº«n chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘
khÃ´ng yÃªu cáº§u sá»­a Ä‘á»•i bá»™ giáº£i mÃ£ hÃ¬nh áº£nh. Äiá»u nÃ y cho phÃ©p thay tháº¿ liá»n máº¡ch
CLIP vÃ  tÃ­ch há»£p dá»… dÃ ng vá»›i vÃ´ sá»‘ ká»¹ thuáº­t U-Net
tá»« Ä‘iá»u khiá»ƒn tinh vi Ä‘áº¿n cÃ¡c biáº¿n thá»ƒ bá»™ giáº£i mÃ£ hÃ¬nh áº£nh cÃ¡ nhÃ¢n hÃ³a. ChÃºng tÃ´i coi
KOSMOS-G nhÆ° má»™t ná»— lá»±c ban Ä‘áº§u hÆ°á»›ng tá»›i má»¥c tiÃªu "hÃ¬nh áº£nh nhÆ° má»™t ngÃ´n ngá»¯ ngoáº¡i lai
trong viá»‡c táº¡o hÃ¬nh áº£nh." MÃ£ nguá»“n cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y táº¡i https://aka.ms/Kosmos-G

1 Giá»›i thiá»‡u
Trong cÃ¡c nghiÃªn cá»©u gáº§n Ä‘Ã¢y, nhá»¯ng tiáº¿n bá»™ trong viá»‡c táº¡o hÃ¬nh áº£nh tá»« vÄƒn báº£n (T2I), Ä‘áº·c biá»‡t vá»›i cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n,
Ä‘Ã£ cho tháº¥y sá»± tiáº¿n bá»™ Ä‘Ã¡ng chÃº Ã½ trong viá»‡c táº¡o ra nhá»¯ng hÃ¬nh áº£nh cÃ³ tÃ­nh chÃ¢n thá»±c cao, chÃ­nh xÃ¡c vÃ  Ä‘a dáº¡ng
tá»« mÃ´ táº£ báº±ng vÄƒn báº£n. Dá»±a trÃªn thÃ nh cÃ´ng chÆ°a tá»«ng cÃ³ trong viá»‡c táº¡o ra nhá»¯ng hÃ¬nh áº£nh cÃ³ Ä‘á»™ chÃ­nh xÃ¡c cao
tá»« mÃ´ táº£ vÄƒn báº£n, nhiá»u nghiÃªn cá»©u Ä‘Ã£ Ä‘i sÃ¢u vÃ o viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» phá»©c táº¡p hÆ¡n
Ä‘á»ƒ tÃ­ch há»£p hÃ¬nh áº£nh vÃ o lá»i nháº¯c vÄƒn báº£n Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh tÃ¹y chá»‰nh má»›i.

Má»™t nhÃ³m phÆ°Æ¡ng phÃ¡p [GAA+22,RLJ+22,KZZ+23,TGCA23,AAF+23,HHZW23,SHZ+23]
Ä‘á» xuáº¥t tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh trÃªn tá»«ng táº­p hÃ¬nh áº£nh tham chiáº¿u, vÃ  khÃ´ng Ä‘áº¡t Ä‘Æ°á»£c viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á»
thÃ´ng qua má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n tá»•ng quÃ¡t. [XYF+23,WZJ+23,CHL+23,CHSC22] tiÃªm
cÃ¡c Ä‘áº·c trÆ°ng hÃ¬nh áº£nh vÃ o U-Net cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. Tuy nhiÃªn, nhá»¯ng phÆ°Æ¡ng phÃ¡p tiÃªm nhÆ° váº­y tÃ¡ch biá»‡t
hÆ°á»›ng dáº«n cho vÄƒn báº£n vÃ  hÃ¬nh áº£nh, do Ä‘Ã³ háº¡n cháº¿ hiá»‡u quáº£ cá»§a viá»‡c mÃ´ hÃ¬nh hÃ³a káº¿t há»£p giá»¯a hai
phÆ°Æ¡ng thá»©c. NgoÃ i ra, cÃ¡ch tiáº¿p cáº­n nÃ y khÃ³ má»Ÿ rá»™ng cho cÃ¡c tÃ¬nh huá»‘ng cÃ³ nhiá»u
thá»±c thá»ƒ. CÃ´ng trÃ¬nh gáº§n Ä‘Ã¢y BLIP-Diffusion [LLH23] há»c biá»ƒu diá»…n Ä‘á»‘i tÆ°á»£ng báº±ng cÃ¡ch tá»•ng há»£p hÃ¬nh áº£nh
thÃ´ng qua viá»‡c káº¿t há»£p cÃ¡c chá»§ Ä‘á» vá»›i ná»n ngáº«u nhiÃªn. CÃ¡ch tiáº¿p cáº­n nÃ y hiá»‡u quáº£ trong viá»‡c trang bá»‹ cho nÃ³
kháº£ nÄƒng táº¡o hÃ¬nh áº£nh tá»« vÄƒn báº£n theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh. Tuy nhiÃªn, thiáº¿t káº¿ cá»¥ thá»ƒ cá»§a
máº«u Ä‘áº§u vÃ o vÃ  dá»¯ liá»‡u huáº¥n luyá»‡n háº¡n cháº¿ kháº£ nÄƒng má»Ÿ rá»™ng Ä‘áº¿n nhiá»u thá»±c thá»ƒ.

TrÃ¡i ngÆ°á»£c vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p trÆ°á»›c Ä‘Ã¢y hoáº¡t Ä‘á»™ng vá»›i bá»™ mÃ£ hÃ³a vÄƒn báº£n CLIP gá»‘c [RKH+21], chÃºng tÃ´i Ä‘á» xuáº¥t ráº±ng
thÃ´ng qua viá»‡c táº­n dá»¥ng MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n Äa phÆ°Æ¡ng thá»©c (MLLMs) [ADL+22,HSD+22,AHR+22,
HDW+23,LLSH23], háº§u háº¿t cÃ¡c thÃ¡ch thá»©c trong viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t dá»… dÃ ng.
MLLMs Ä‘Ã£ má»Ÿ rá»™ng kháº£ nÄƒng nháº­n thá»©c cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘áº¿n Ä‘a phÆ°Æ¡ng thá»©c, cho phÃ©p
chÃºng nháº­n thá»©c cÃ¡c phÆ°Æ¡ng thá»©c Ä‘a dáº¡ng nhÆ° hÃ¬nh áº£nh. Ã tÆ°á»Ÿng táº­n dá»¥ng MLLMs cho viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á»
mang láº¡i má»™t sá»‘ lá»£i tháº¿: 1) NÃ³ táº­n dá»¥ng viá»‡c cÄƒn chá»‰nh thá»‹ giÃ¡c-ngÃ´n ngá»¯ vá»‘n cÃ³
trong MLLM. 2) Kiáº¿n trÃºc MLLM tá»± nhiÃªn há»— trá»£ Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh. 3) MLLM Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n cÃ³ thá»ƒ mÃ´ hÃ¬nh hÃ³a hiá»‡u quáº£ Ä‘áº§u vÃ o Ä‘a phÆ°Æ¡ng thá»©c trong ngá»¯ cáº£nh.

Äá»ƒ há»— trá»£ viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh vá»›i Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh, chÃºng tÃ´i trÃ¬nh bÃ y
KOSMOS-G, táº­n dá»¥ng kháº£ nÄƒng nháº­n thá»©c Ä‘a phÆ°Æ¡ng thá»©c tiÃªn tiáº¿n cá»§a MLLM theo cÃ¡ch "cÄƒn chá»‰nh
trÆ°á»›c khi hÆ°á»›ng dáº«n". Cá»¥ thá»ƒ, chÃºng tÃ´i báº¯t Ä‘áº§u tá»« giai Ä‘oáº¡n mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ Ä‘a phÆ°Æ¡ng thá»©c, dáº«n Ä‘áº¿n
MLLM KOSMOS-1[HDW+23]. NÃ³ hÃ¬nh dung cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÆ° má»™t lá»›p tÃ¡c vá»¥ phá»• quÃ¡t,
nháº­n thá»©c Ä‘áº§u vÃ o thá»‹ giÃ¡c-ngÃ´n ngá»¯ Ä‘an xen tá»± do vÃ  há»£p nháº¥t cÃ¡c dá»± Ä‘oÃ¡n tÃ¡c vá»¥ khÃ¡c nhau
thÃ nh cÃ¡c Ä‘á»‹nh dáº¡ng vÄƒn báº£n. Vá»›i biá»ƒu diá»…n thá»‹ giÃ¡c-ngÃ´n ngá»¯ Ä‘Æ°á»£c cÄƒn chá»‰nh, sau Ä‘Ã³ chÃºng tÃ´i sá»­ dá»¥ng
phÆ°Æ¡ng thá»©c ngÃ´n ngá»¯ lÃ m Ä‘iá»ƒm neo vÃ  cÄƒn chá»‰nh khÃ´ng gian Ä‘áº§u ra cá»§a MLLM vá»›i bá»™ mÃ£ hÃ³a vÄƒn báº£n CLIP. Cuá»‘i cÃ¹ng,
chÃºng tÃ´i thá»±c hiá»‡n tinh chá»‰nh hÆ°á»›ng dáº«n trÃªn dá»¯ liá»‡u Ä‘Æ°á»£c tuyá»ƒn chá»n. KOSMOS-G cháº¥p nháº­n chÃº thÃ­ch lÃ m Ä‘áº§u vÃ o, trong Ä‘Ã³
má»—i thá»±c thá»ƒ Ä‘Æ°á»£c theo sau bá»Ÿi hÃ¬nh áº£nh Ä‘Æ°á»£c phÃ¢n Ä‘oáº¡n cá»§a nÃ³. MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ tÃ¡i táº¡o chung thá»±c
táº¥t cáº£ cÃ¡c thá»±c thá»ƒ, hiá»ƒn thá»‹ ná»™i dung vÄƒn báº£n vÃ  tuÃ¢n theo hÆ°á»›ng dáº«n. Trong quÃ¡ trÃ¬nh nÃ y, bá»™ giáº£i mÃ£ hÃ¬nh áº£nh khuáº¿ch tÃ¡n
Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n Ä‘Ã´ng láº¡nh Ä‘Ã³ng vai trÃ² nhÆ° má»™t chá»‰ sá»‘ Ä‘iá»ƒm sá»‘. ChÃºng tÃ´i chÆ°ng cáº¥t phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘Ã£ há»c Ä‘á»ƒ truyá»n
gradient cÃ³ thá»ƒ vi phÃ¢n Ä‘áº¿n MLLM. Äiá»u nÃ y cho phÃ©p KOSMOS-G khai thÃ¡c cÃ¡c Ä‘áº·c trÆ°ng phong phÃº tá»«

--- TRANG 3 ---
â„°ğ’ŸCross AttnCross AttnlÃ m tranh sÆ¡n dáº§u theo phong cÃ¡ch
ğŸ”¥ MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n Äa phÆ°Æ¡ng thá»©c
ğŸ”¥AlignerNet
Lá»i nháº¯c Thá»‹ giÃ¡c-NgÃ´n ngá»¯ Äan xen
â„
â„HÃ¬nh 2: KOSMOS-G bao gá»“m má»™t MLLM cho nháº­n thá»©c Ä‘a phÆ°Æ¡ng thá»©c, káº¿t há»£p vá»›i má»™t AlignerNet
káº¿t ná»‘i MLLM vá»›i bá»™ giáº£i mÃ£ hÃ¬nh áº£nh U-Net khuáº¿ch tÃ¡n. KOSMOS-G cÃ³ thá»ƒ truyá»n hÆ°á»›ng dáº«n
cáº¥p Ä‘á»™ khÃ¡i niá»‡m tinh vi tá»« Ä‘áº§u vÃ o Ä‘an xen Ä‘áº¿n bá»™ giáº£i mÃ£ hÃ¬nh áº£nh, vÃ  cung cáº¥p má»™t giáº£i phÃ¡p thay tháº¿ liá»n máº¡ch cho CLIP.
MÃ u cam biá»ƒu thá»‹ cÃ¡c mÃ´-Ä‘un cÃ³ thá»ƒ huáº¥n luyá»‡n; MÃ u xanh biá»ƒu thá»‹ cÃ¡c mÃ´-Ä‘un bá»‹ Ä‘Ã´ng láº¡nh.

bá»™ mÃ£ hÃ³a hÃ¬nh áº£nh Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh tÃ¡i táº¡o chung thá»±c ná»™i dung qua cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau (xem
HÃ¬nh 1, chÃºng tÃ´i cÅ©ng trÃ¬nh bÃ y cÃ¡c vÃ­ dá»¥ vá»›i sá»± Ä‘an xen Ä‘a dáº¡ng hÆ¡n trong HÃ¬nh 9).

ÄÆ°á»£c hÆ°á»Ÿng lá»£i tá»« viá»‡c tiá»n huáº¥n luyá»‡n Ä‘a má»¥c Ä‘Ã­ch, KOSMOS-G tiáº¿p cáº­n má»¥c tiÃªu "hÃ¬nh áº£nh nhÆ° má»™t
ngÃ´n ngá»¯ ngoáº¡i lai trong viá»‡c táº¡o hÃ¬nh áº£nh." Äiá»u nÃ y cÃ³ nghÄ©a lÃ  KOSMOS-G cÃ³ thá»ƒ náº¯m báº¯t cÃ¡c khÃ¡i niá»‡m má»›i tá»«
hÃ¬nh áº£nh Ä‘áº§u vÃ o vÃ  hÆ°á»›ng dáº«n viá»‡c táº¡o ra cÃ¡ nhÃ¢n hÃ³a trong cÃ i Ä‘áº·t khÃ´ng cáº§n tinh chá»‰nh. ÄÃ¡ng chÃº Ã½, KOSMOS-G cÅ©ng lÃ 
mÃ´ hÃ¬nh Ä‘áº§u tiÃªn thÃ nh tháº¡o viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh vá»›i Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh. Nhá» vÃ o viá»‡c tinh chá»‰nh hÆ°á»›ng dáº«n chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘, KOSMOS-G khÃ´ng cáº§n sá»­a Ä‘á»•i báº¥t ká»³
tham sá»‘ nÃ o cá»§a bá»™ giáº£i mÃ£ hÃ¬nh áº£nh, tá»©c lÃ  U-Net khuáº¿ch tÃ¡n vÃ  VAE. Äiá»u nÃ y khiáº¿n chÃºng tÃ´i cÃ³ thá»ƒ
thay tháº¿ liá»n máº¡ch CLIP báº±ng KOSMOS-G trong báº¥t ká»³ há»‡ thá»‘ng táº¡o hÃ¬nh áº£nh nÃ o. Káº¿t quáº£ lÃ , vÃ´ sá»‘
á»©ng dá»¥ng cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ khÃ³a káº¿t há»£p vá»›i cÃ¡c ká»¹ thuáº­t U-Net, tá»« Ä‘iá»u khiá»ƒn tinh vi
nhÆ° ControlNet [ZA23] Ä‘áº¿n cÃ¡c biáº¿n thá»ƒ bá»™ giáº£i mÃ£ hÃ¬nh áº£nh cÃ¡ nhÃ¢n hÃ³a hoáº·c phong cÃ¡ch hÃ³a nhÆ° cÃ¡c
checkpoint LoRA [HSW+22] Ä‘Ã³ng gÃ³p bá»Ÿi cá»™ng Ä‘á»“ng tuyá»‡t vá»i.

Tá»•ng thá»ƒ, chÃºng tÃ´i Ä‘á» xuáº¥t KOSMOS-G nhÆ° má»™t ná»— lá»±c ban Ä‘áº§u hÆ°á»›ng tá»›i má»¥c tiÃªu "hÃ¬nh áº£nh nhÆ° má»™t ngÃ´n ngá»¯
ngoáº¡i lai trong viá»‡c táº¡o hÃ¬nh áº£nh." ChÃºng tÃ´i tÃ³m táº¯t nhá»¯ng Ä‘Ã³ng gÃ³p chÃ­nh nhÆ° sau:

1. ChÃºng tÃ´i Ä‘á» xuáº¥t táº­n dá»¥ng kháº£ nÄƒng nháº­n thá»©c Ä‘a phÆ°Æ¡ng thá»©c tiÃªn tiáº¿n cá»§a MLLMs cho viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á»
vá»›i Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh.

2. ChÃºng tÃ´i Ä‘á» xuáº¥t má»™t tÃ¡c vá»¥ tinh chá»‰nh hÆ°á»›ng dáº«n thÃ nh pháº§n, dáº«n Ä‘áº¿n kháº£ nÄƒng táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á»
nhiá»u thá»±c thá»ƒ khÃ´ng cáº§n tinh chá»‰nh tuyá»‡t vá»i.

3. Tinh chá»‰nh hÆ°á»›ng dáº«n chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘ cho phÃ©p KOSMOS-G giao tiáº¿p liá»n máº¡ch vá»›i má»™t
loáº¡t cÃ¡c ká»¹ thuáº­t U-Net, cho tháº¥y kháº£ nÄƒng á»©ng dá»¥ng rá»™ng rÃ£i vÃ  tiá»m nÄƒng tÃ­ch há»£p
vÃ o cÃ¡c khung khÃ¡c nhau.

2 KOSMOS-G: HÃ¬nh áº£nh nhÆ° má»™t NgÃ´n ngá»¯ Ngoáº¡i lai trong Viá»‡c Táº¡o HÃ¬nh áº£nh

NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 2, KOSMOS-G lÃ  má»™t mÃ´ hÃ¬nh cÃ³ thá»ƒ nháº­n thá»©c Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh
vÃ  táº¡o ra cÃ¡c Ä‘iá»u kiá»‡n theo chá»§ Ä‘á». Cá»¥ thá»ƒ, xÆ°Æ¡ng sá»‘ng cá»§a MLLM KOSMOS-G lÃ 
má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ dá»±a trÃªn Transformer, Ä‘Ã³ng vai trÃ² nhÆ° má»™t giao diá»‡n Ä‘a má»¥c Ä‘Ã­ch cho Ä‘áº§u vÃ o Ä‘a phÆ°Æ¡ng thá»©c.
ChÃºng tÃ´i huáº¥n luyá»‡n KOSMOS-G theo cÃ¡ch "cÄƒn chá»‰nh trÆ°á»›c khi hÆ°á»›ng dáº«n", toÃ n bá»™ quy trÃ¬nh huáº¥n luyá»‡n
cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh 3 giai Ä‘oáº¡n:

1. MÃ´ hÃ¬nh hÃ³a NgÃ´n ngá»¯ Äa phÆ°Æ¡ng thá»©c: ChÃºng tÃ´i tiá»n huáº¥n luyá»‡n MLLM tá»« Ä‘áº§u trÃªn táº­p ngá»¯ liá»‡u Ä‘a phÆ°Æ¡ng thá»©c,
bao gá»“m dá»¯ liá»‡u Ä‘Æ¡n phÆ°Æ¡ng thá»©c, dá»¯ liá»‡u ghÃ©p ná»‘i chÃ©o-phÆ°Æ¡ng thá»©c, vÃ  dá»¯ liá»‡u Ä‘a phÆ°Æ¡ng thá»©c Ä‘an xen
vá»›i tá»•n tháº¥t mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ theo KOSMOS-1.

--- TRANG 4 ---
2. CÄƒn chá»‰nh Bá»™ giáº£i mÃ£ HÃ¬nh áº£nh: ChÃºng tÃ´i sá»­ dá»¥ng U-Net [RFB15] cá»§a Stable Diffusion v1.5 [RBL+22]
lÃ m bá»™ giáº£i mÃ£ hÃ¬nh áº£nh cá»§a chÃºng tÃ´i. ChÃºng tÃ´i Ä‘Ã£ huáº¥n luyá»‡n má»™t AlignerNet chá»‰ trÃªn dá»¯ liá»‡u vÄƒn báº£n Ä‘á»ƒ cÄƒn chá»‰nh khÃ´ng gian Ä‘áº§u ra
cá»§a KOSMOS-G vá»›i khÃ´ng gian Ä‘áº§u vÃ o cá»§a U-Net thÃ´ng qua giÃ¡m sÃ¡t CLIP. á» Ä‘Ã¢y, ngÃ´n ngá»¯
Ä‘Ã³ng vai trÃ² nhÆ° phÆ°Æ¡ng thá»©c neo, Ä‘áº£m báº£o Ä‘áº§u vÃ o hÃ¬nh áº£nh cÅ©ng tÆ°Æ¡ng thÃ­ch vá»›i bá»™ giáº£i mÃ£ hÃ¬nh áº£nh.

3. Tinh chá»‰nh HÆ°á»›ng dáº«n: ChÃºng tÃ´i tiáº¿p tá»¥c tinh chá»‰nh KOSMOS-G thÃ´ng qua má»™t tÃ¡c vá»¥ táº¡o hÃ¬nh áº£nh thÃ nh pháº§n
trÃªn dá»¯ liá»‡u Ä‘Æ°á»£c tuyá»ƒn chá»n, vá»›i gradient cÃ³ thá»ƒ vi phÃ¢n Ä‘Æ°á»£c truyá»n tá»« U-Net bá»‹ Ä‘Ã´ng láº¡nh.

Trong Giai Ä‘oáº¡n 1, chá»‰ cÃ³ MLLM Ä‘Æ°á»£c huáº¥n luyá»‡n. Trong Giai Ä‘oáº¡n 2, AlignerNet Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i MLLM bá»‹ Ä‘Ã´ng láº¡nh.
Trong Giai Ä‘oáº¡n 3, cáº£ AlignerNet vÃ  MLLM Ä‘á»u Ä‘Æ°á»£c huáº¥n luyá»‡n cÃ¹ng nhau. Bá»™ giáº£i mÃ£ hÃ¬nh áº£nh váº«n bá»‹ Ä‘Ã´ng láº¡nh
trong suá»‘t táº¥t cáº£ cÃ¡c giai Ä‘oáº¡n.

2.1 MÃ´ hÃ¬nh hÃ³a NgÃ´n ngá»¯ Äa phÆ°Æ¡ng thá»©c

Theo KOSMOS-1, KOSMOS-G nháº­n thá»©c cÃ¡c phÆ°Æ¡ng thá»©c tá»•ng quÃ¡t theo cÃ¡ch thá»‘ng nháº¥t. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i
biá»ƒu diá»…n Ä‘á»‹nh dáº¡ng Ä‘áº§u vÃ o nhÆ° má»™t chuá»—i duy nháº¥t sá»­ dá»¥ng cÃ¡c token Ä‘áº·c biá»‡t. Cá»¥ thá»ƒ, chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c token
<s> vÃ  </s> Ä‘á»ƒ biá»ƒu thá»‹ báº¯t Ä‘áº§u vÃ  káº¿t thÃºc chuá»—i. ChÃºng tÃ´i cÅ©ng káº¿t há»£p cÃ¡c token <image> vÃ  </image>
Ä‘á»ƒ chá»‰ ra sá»± báº¯t Ä‘áº§u vÃ  káº¿t thÃºc cá»§a báº¥t ká»³ biá»ƒu diá»…n hÃ¬nh áº£nh nhÃºng nÃ o trong chuá»—i.

PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i liÃªn quan Ä‘áº¿n viá»‡c mÃ£ hÃ³a cáº£ token vÄƒn báº£n vÃ  hÃ¬nh áº£nh thÃ nh vector, sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘Æ°a
vÃ o bá»™ giáº£i mÃ£. Äá»‘i vá»›i token vÄƒn báº£n, chÃºng tÃ´i sá»­ dá»¥ng báº£ng tra cá»©u Ä‘á»ƒ Ã¡nh xáº¡ chÃºng thÃ nh cÃ¡c embedding. Äá»ƒ xá»­ lÃ½
cÃ¡c hÃ¬nh áº£nh Ä‘áº§u vÃ o, chÃºng tÃ´i sá»­ dá»¥ng má»™t Transformer thá»‹ giÃ¡c [DBK+21] lÃ m mÃ´-Ä‘un embedding. HÆ¡n ná»¯a,
Resampler [ADL+22] Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t cÆ¡ cháº¿ pooling chÃº Ã½ Ä‘á»ƒ giáº£m sá»‘ lÆ°á»£ng embedding hÃ¬nh áº£nh. Sau khi thu Ä‘Æ°á»£c cÃ¡c embedding cá»§a má»™t chuá»—i Ä‘áº§u vÃ o, chÃºng tÃ´i Ä‘Æ°a chÃºng vÃ o bá»™ giáº£i mÃ£ dá»±a trÃªn Transformer.
Bá»™ giáº£i mÃ£ nhÃ¢n quáº£ tá»« trÃ¡i sang pháº£i xá»­ lÃ½ chuá»—i theo cÃ¡ch tá»± há»“i quy.
Má»™t bá»™ phÃ¢n loáº¡i softmax trÃªn Transformer Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ gÃ¡n xÃ¡c suáº¥t cho tá»«ng token trong tá»« vá»±ng.

KOSMOS-G Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘áº§u tiÃªn báº±ng cÃ¡ch sá»­ dá»¥ng tÃ¡c vá»¥ dá»± Ä‘oÃ¡n token tiáº¿p theo. Má»¥c tiÃªu huáº¥n luyá»‡n lÃ  tá»‘i Ä‘a hÃ³a
log-likelihood cá»§a cÃ¡c token trong cÃ¡c vÃ­ dá»¥. Äiá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  tá»•n tháº¥t huáº¥n luyá»‡n chá»‰ xem xÃ©t
cÃ¡c token rá»i ráº¡c, cá»¥ thá»ƒ lÃ  token vÄƒn báº£n. ThÃ nh pháº§n MLLM cÃ³ 24 lá»›p vá»›i 2,048 chiá»u áº©n, kÃ­ch thÆ°á»›c trung gian FFN 8,192, vÃ  32 Ä‘áº§u chÃº Ã½. Äá»ƒ há»™i tá»¥ nhanh hÆ¡n,
biá»ƒu diá»…n hÃ¬nh áº£nh Ä‘Æ°á»£c thu Ä‘Æ°á»£c tá»« mÃ´ hÃ¬nh CLIP ViT-L/14 Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vá»›i 1,024 chiá»u Ä‘áº·c trÆ°ng. CÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c tiá»n xá»­ lÃ½ thÃ nh Ä‘á»™ phÃ¢n giáº£i 224Ã—224 trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. ChÃºng tÃ´i Ä‘Ã´ng láº¡nh
cÃ¡c tham sá»‘ cá»§a mÃ´ hÃ¬nh CLIP ngoáº¡i trá»« lá»›p cuá»‘i cÃ¹ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Tá»•ng sá»‘ tham sá»‘
cá»§a MLLM lÃ  khoáº£ng 1.6B.

2.2 CÄƒn chá»‰nh Bá»™ giáº£i mÃ£ HÃ¬nh áº£nh

Sau khi thá»±c hiá»‡n mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ Ä‘a phÆ°Æ¡ng thá»©c, chÃºng tÃ´i Ä‘Ã£ cÄƒn chá»‰nh thÃ nh cÃ´ng nháº­n thá»©c thá»‹ giÃ¡c vÃ  ngÃ´n ngá»¯
trong MLLM. Äá»ƒ lÃ m cho KOSMOS-G cÃ³ kháº£ nÄƒng táº¡o hÃ¬nh áº£nh, chÃºng tÃ´i káº¿t há»£p
cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n [SWMG15] lÃ m bá»™ giáº£i mÃ£ hÃ¬nh áº£nh cá»§a chÃºng tÃ´i. Cá»¥ thá»ƒ, chÃºng tÃ´i Ã¡p dá»¥ng
Stable Diffusion v1.5 [RBL+22] Ä‘Æ°á»£c cháº¥p nháº­n rá»™ng rÃ£i. Äiá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  chÃºng tÃ´i chá»‰ thay tháº¿ bá»™ mÃ£ hÃ³a vÄƒn báº£n CLIP [RKH+21] báº±ng KOSMOS-G Ä‘a phÆ°Æ¡ng thá»©c, mÃ  khÃ´ng thá»±c hiá»‡n báº¥t ká»³ sá»­a Ä‘á»•i nÃ o Ä‘á»‘i vá»›i kiáº¿n trÃºc U-Net
hoáº·c trá»ng sá»‘. Thiáº¿t láº­p nÃ y cho phÃ©p KOSMOS-G há»£p tÃ¡c hiá»‡u quáº£ vá»›i cÃ¡c ká»¹ thuáº­t
Ä‘Æ°á»£c Ã¡p dá»¥ng cho U-Net, nhÆ° ControlNet [ZA23] vÃ  cÃ¡c biáº¿n thá»ƒ LoRA [HSW+22] khÃ¡c nhau cá»§a cá»™ng Ä‘á»“ng. Trong
pháº§n nÃ y, chÃºng tÃ´i sáº½ cung cáº¥p nhá»¯ng Ä‘iá»u kiá»‡n tiÃªn quyáº¿t ngáº¯n gá»n vá» cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n, vÃ  sau Ä‘Ã³ Ä‘i sÃ¢u vÃ o
quÃ¡ trÃ¬nh cÄƒn chá»‰nh khÃ´ng gian Ä‘áº§u ra cá»§a KOSMOS-G vá»›i bá»™ giáº£i mÃ£ hÃ¬nh áº£nh sau khi thay tháº¿ nÃªu trÃªn.

Äiá»u kiá»‡n tiÃªn quyáº¿t vá» MÃ´ hÃ¬nh Khuáº¿ch tÃ¡n Tiá»m áº©n CÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n Ä‘á»‹nh nghÄ©a má»™t chuá»—i Markov cá»§a quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n thuáº­n q, thÃªm cÃ¡c máº«u nhiá»…u Gaussian vÃ o dá»¯ liá»‡u thá»±c ban Ä‘áº§u z0âˆ¼q(z) qua T bÆ°á»›c.
á» Ä‘Ã¢y, z biá»ƒu thá»‹ cÃ¡c biá»ƒu diá»…n tiá»m áº©n thay vÃ¬ giÃ¡ trá»‹ pixel. KhÃ´ng gian tiá»m áº©n hiá»‡u quáº£, cÃ³ chiá»u tháº¥p
gáº§n nhÆ° tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá» máº·t nháº­n thá»©c vá»›i khÃ´ng gian RGB cÃ³ chiá»u cao, trong khi
thÃ´ng tin dÆ° thá»«a khÃ´ng cÃ³ Ã½ nghÄ©a vá» máº·t ngá»¯ nghÄ©a cÃ³ trong miá»n pixel bá»‹ loáº¡i bá». CÃ¡c mÃ´ hÃ¬nh nÃ©n nháº­n thá»©c (tá»©c lÃ  VQ-VAE) bao gá»“m E vÃ  D mÃ£ hÃ³a dá»¯ liá»‡u thá»±c vÃ o khÃ´ng gian tiá»m áº©n
vÃ  ngÆ°á»£c láº¡i, sao cho D(E(x))â‰ˆx. CÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n sá»­ dá»¥ng cÃ¡c biá»ƒu diá»…n tiá»m áº©n z=E(x)
thay vÃ¬ lÃ m viá»‡c trá»±c tiáº¿p vá»›i giÃ¡ trá»‹ pixel trong quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n. Äáº§u ra cuá»‘i cÃ¹ng cÃ³ thá»ƒ
Ä‘Æ°á»£c giáº£i mÃ£ trá»Ÿ láº¡i khÃ´ng gian pixel thÃ´ng qua D(z). Giai Ä‘oáº¡n nÃ©n nháº­n thá»©c nháº¹ riÃªng biá»‡t chá»‰
loáº¡i bá» cÃ¡c chi tiáº¿t khÃ´ng thá»ƒ nháº­n thá»©c, dáº«n Ä‘áº¿n káº¿t quáº£ táº¡o hÃ¬nh cáº¡nh tranh vá»›i chi phÃ­ tháº¥p hÆ¡n nhiá»u.

--- TRANG 5 ---
KhÃ´ng gian CLIP-TVÄƒn báº£nKÃ©o Gáº§nâ„³ğ’©TÃ¡i cáº¥u trÃºcKhÃ´ng gian KOSMOS-GVÄƒn báº£nHÃ¬nh áº£nh(a) QuÃ¡ trÃ¬nh cÄƒn chá»‰nh. VÄƒn báº£n Ä‘Ã³ng vai trÃ² nhÆ° má»™t
Ä‘iá»ƒm neo, embedding hÃ¬nh áº£nh Ä‘Æ°á»£c cÄƒn chá»‰nh tá»± nhiÃªn trong suá»‘t quÃ¡ trÃ¬nh.
â„³-encoderâ„³-decoder
Embedding nguá»“nâ„³-Linear
ChÃº thÃ­ch Äáº§u vÃ oKOSMOS-GCLIP-TEmbedding Ä‘Ã­chmÃ  cáº¥u trÃºc nguá»“n embeddingTá»•n tháº¥t MSETá»•n tháº¥t MSEEmbedding Ä‘Æ°á»£c cÄƒn chá»‰nhTá»•n tháº¥t MSETÃ¡i cáº¥u trÃºc embedding nguá»“nğ’©-Linearğ’©-decoderğ’©-encoder(b) Kiáº¿n trÃºc AlignerNet. CÃ¡c lá»›p Linear Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chiáº¿u
chiá»u Ä‘áº§u ra cá»§a MLLM thÃ nh d=768, cÃ¡c pháº§n tá»­ mÃ u tÃ­m
biá»ƒu thá»‹ cÃ¡c truy váº¥n tiá»m áº©n Ä‘Ã£ há»c QM vÃ  QN.

HÃ¬nh 3: Tá»•ng quan vá» cÄƒn chá»‰nh.

QuÃ¡ trÃ¬nh thuáº­n q(zt|ztâˆ’1) táº¡i má»—i bÆ°á»›c thá»i gian t cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° sau:
q(zt|ztâˆ’1) = N(zt;âˆš(1âˆ’Î²t)ztâˆ’1, Î²tI)
q(z1:T|z0) = âˆ(t=1 to T)q(zt|ztâˆ’1)   (1)

trong Ä‘Ã³ Î²tâˆˆ(0,1) biá»ƒu thá»‹ kÃ­ch thÆ°á»›c bÆ°á»›c. LÆ°u Ã½ Î²tâˆ’1 < Î²t.

CÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n há»c má»™t U-Net [RFB15] Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  ÏµÎ¸ Ä‘á»ƒ Ä‘áº£o ngÆ°á»£c quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n thuáº­n,
xÃ¢y dá»±ng cÃ¡c máº«u dá»¯ liá»‡u mong muá»‘n tá»« nhiá»…u. Äáº·t Î±t = 1âˆ’Î²t vÃ  á¾±t = âˆ(i=1 to t)Î±i. ChÃºng ta cÃ³ thá»ƒ
tham sá»‘ hÃ³a láº¡i quÃ¡ trÃ¬nh khá»­ nhiá»…u p(ztâˆ’1|zt) cÅ©ng nhÆ° má»™t phÃ¢n phá»‘i Gaussian. PhÃ¢n phá»‘i nÃ y
cÃ³ thá»ƒ Ä‘Æ°á»£c Æ°á»›c tÃ­nh bá»Ÿi ÏµÎ¸ vÃ  cÃ³ dáº¡ng sau:
pÎ¸(ztâˆ’1|zt) = N(ztâˆ’1;Î¼Î¸(zt,t),Î£Î¸(zt,t))
vá»›i Î¼Î¸(zt,t) = (1/âˆšÎ±t)(zt âˆ’ (Î²t/âˆš(1âˆ’á¾±t))ÏµÎ¸(zt,t))   (2)

Má»¥c tiÃªu há»c táº­p cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n lÃ  xáº¥p xá»‰ trung bÃ¬nh Î¼Î¸(zt,t) trong quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n ngÆ°á»£c. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cáº­n dÆ°á»›i biáº¿n phÃ¢n (ELBO) [KW14] Ä‘á»ƒ
tá»‘i thiá»ƒu hÃ³a negative log-likelihood cá»§a pÎ¸(z0)[HJA20]. Má»¥c tiÃªu Ä‘Æ¡n giáº£n hÃ³a cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n
nhÆ° má»™t má»¥c tiÃªu khá»­ nhiá»…u:
Ldiff = Ez0,Ïµâˆ¼N(0,1),t[â€–Ïµâˆ’ÏµÎ¸(zt,t)â€–Â²]   (3)

Trong quÃ¡ trÃ¬nh suy luáº­n, [HS22] Ä‘á» xuáº¥t sá»­ dá»¥ng hÆ°á»›ng dáº«n khÃ´ng cÃ³ bá»™ phÃ¢n loáº¡i Ä‘á»ƒ thu Ä‘Æ°á»£c káº¿t quáº£ táº¡o hÃ¬nh
liÃªn quan hÆ¡n.
ÎµÌ‚ = wÂ·ÏµÎ¸(zt,Ï†,t)âˆ’(wâˆ’1)Â·ÏµÎ¸(zt,t)   (4)
trong Ä‘Ã³ w lÃ  tá»· lá»‡ hÆ°á»›ng dáº«n, Ï† biá»ƒu thá»‹ Ä‘iá»u kiá»‡n.

CÄƒn chá»‰nh KhÃ´ng gian Äáº§u ra vá»›i CÃ¡c mÃ´ hÃ¬nh Khuáº¿ch tÃ¡n Khi thay tháº¿ bá»™ mÃ£ hÃ³a vÄƒn báº£n CLIP trÆ°á»›c Ä‘Ã³ báº±ng
KOSMOS-G, trá»ng tÃ¢m chÃ­nh lÃ  giáº£i quyáº¿t váº¥n Ä‘á» khÃ´ng cÄƒn chá»‰nh giá»¯a KOSMOS-G vÃ  bá»™ giáº£i mÃ£ hÃ¬nh áº£nh. ChÃºng tÃ´i phÃ¡t hiá»‡n ra ráº±ng viá»‡c chá»‰ tinh chá»‰nh KOSMOS-G báº±ng cÃ¡ch sá»­ dá»¥ng gradient Ä‘Æ°á»£c truyá»n tá»«
bá»™ giáº£i mÃ£ hÃ¬nh áº£nh dáº«n Ä‘áº¿n cáº£ cÄƒn chá»‰nh táº§m thÆ°á»ng vÃ  cháº¥t lÆ°á»£ng hÃ¬nh áº£nh bá»‹ áº£nh hÆ°á»Ÿng.

ÄÆ°á»£c truyá»n cáº£m há»©ng bá»Ÿi [QYX+23], chÃºng tÃ´i Ä‘á» xuáº¥t AlignerNet bao gá»“m má»™t bá»™ mÃ£ hÃ³a M vÃ  má»™t bá»™ giáº£i mÃ£ N
Ä‘á»ƒ há»c cÄƒn chá»‰nh giá»¯a khÃ´ng gian nguá»“n S cá»§a KOSMOS-G vÃ  khÃ´ng gian Ä‘Ã­ch T cá»§a bá»™ mÃ£ hÃ³a vÄƒn báº£n CLIP. Cho má»™t chÃº thÃ­ch chá»‰ vÄƒn báº£n duy nháº¥t C, bá»™ mÃ£ hÃ³a nguá»“n KOSMOS-G vÃ  bá»™ mÃ£ hÃ³a Ä‘Ã­ch vÄƒn báº£n CLIP
mÃ£ hÃ³a chÃº thÃ­ch thÃ nh cÃ¡c embedding Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  sâˆˆR^(lsÃ—ds) vÃ  tâˆˆR^(ltÃ—dt), tÆ°Æ¡ng á»©ng. á» Ä‘Ã¢y, l vÃ 
d chá»‰ ra Ä‘á»™ dÃ i cá»§a cÃ¡c Ä‘áº·c trÆ°ng vÃ  chiá»u embedding.

--- TRANG 6 ---
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3a, chÃºng tÃ´i sá»­ dá»¥ng bá»™ mÃ£ hÃ³a M Ä‘á»ƒ tá»‘i thiá»ƒu hÃ³a khoáº£ng cÃ¡ch giá»¯a embedding nguá»“n vÄƒn báº£n vÃ  embedding Ä‘Ã­ch, nháº±m má»¥c Ä‘Ã­ch xáº¥p xá»‰ gáº§n M(s)â‰ˆt thÃ´ng qua:
Lmse = Esâˆ¼S,tâˆ¼T[â€–tâˆ’M(s)â€–Â²â‚‚]   (5)

Äá»ƒ giáº£m thiá»ƒu viá»‡c giáº£m phÃ¢n biá»‡t Ä‘áº·c trÆ°ng, chÃºng tÃ´i cÅ©ng sá»­ dá»¥ng má»™t bá»™ giáº£i mÃ£ N Ä‘á»ƒ tÃ¡i cáº¥u trÃºc embedding nguá»“n N(M(s))â‰ˆs thÃ´ng qua:
Lrec = Esâˆ¼S[â€–sâˆ’N(M(s))â€–Â²â‚‚]   (6)

KhÃ¡c vá»›i [QYX+23], KOSMOS-G lÃ  má»™t bá»™ mÃ£ hÃ³a Ä‘a phÆ°Æ¡ng thá»©c thá»‹ giÃ¡c-ngÃ´n ngá»¯. PhÆ°Æ¡ng thá»©c ngÃ´n ngá»¯ Ä‘Ã³ng vai trÃ² nhÆ° má»™t Ä‘iá»ƒm neo trong suá»‘t quÃ¡ trÃ¬nh, cÄƒn chá»‰nh toÃ n bá»™ khÃ´ng gian KOSMOS-G vá»›i
khÃ´ng gian Ä‘áº§u vÃ o cá»§a bá»™ giáº£i mÃ£ hÃ¬nh áº£nh, do Ä‘Ã³ cÅ©ng Ä‘áº¡t Ä‘Æ°á»£c cÄƒn chá»‰nh ngá»¯ nghÄ©a cho cÃ¡c embedding hÃ¬nh áº£nh.

Äá»ƒ xá»­ lÃ½ hiá»‡u quáº£ cÃ¡c chuá»—i dÃ i bao gá»“m nhiá»u hÃ¬nh áº£nh vÃ  tá»‘i thiá»ƒu hÃ³a viá»‡c sá»­ dá»¥ng bá»™ nhá»›,
KOSMOS-G mÃ£ hÃ³a chuá»—i Ä‘áº§u vÃ o thá»‹ giÃ¡c-ngÃ´n ngá»¯ Ä‘an xen thÃ nh cÃ¡c embedding cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i. Tuy nhiÃªn, viá»‡c sá»­ dá»¥ng cÃ¡c embedding cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i lÃ m cho GlueNet dá»±a trÃªn MLP [QYX+23]
khÃ´ng phÃ¹ há»£p Ä‘á»ƒ há»c cÄƒn chá»‰nh. Äá»ƒ giáº£i quyáº¿t Ä‘iá»u nÃ y, chÃºng tÃ´i sá»­ dá»¥ng má»™t kiáº¿n trÃºc dá»±a trÃªn Transformer trong
AlignerNet, cho phÃ©p nÃ³ cÄƒn chá»‰nh hiá»‡u quáº£ cÃ¡c khÃ´ng gian nguá»“n vÃ  Ä‘Ã­ch vá»›i Ä‘á»™ dÃ i chuá»—i khÃ´ng khá»›p vÃ  chiá»u embedding.

NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3b, cáº£ M vÃ  N Ä‘á»u cÃ³ cÃ¹ng má»™t thiáº¿t káº¿ kiáº¿n trÃºc tÆ°Æ¡ng tá»±, bao gá»“m má»™t bá»™ mÃ£ hÃ³a Transformer vÃ  má»™t bá»™ giáº£i mÃ£ Transformer. Bá»™ mÃ£ hÃ³a Transformer vÃ  bá»™ giáº£i mÃ£ trong cáº£ hai mÃ´ hÃ¬nh Ä‘á»u bao gá»“m 12 lá»›p, vá»›i chiá»u Ä‘áº§u vÃ o d=768 vÃ  chiá»u áº©n lÃ  3072. Cáº¥u hÃ¬nh nÃ y
dáº«n Ä‘áº¿n khoáº£ng 225M tham sá»‘ tá»•ng cá»™ng. Trong mÃ´-Ä‘un cross attention cá»§a bá»™ giáº£i mÃ£ Transformer, chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c truy váº¥n tiá»m áº©n Ä‘Ã£ há»c cÃ³ Ä‘á»™ dÃ i biáº¿n Ä‘á»•i QMâˆˆR^(ltÃ—d) trong M vÃ  QNâˆˆR^(lsÃ—d) trong N
Ä‘á»ƒ khá»›p Ä‘á»™ dÃ i chuá»—i. LÆ°u Ã½ ráº±ng nhÆ° Ä‘Ã£ tháº£o luáº­n trong Pháº§n 4.3, chÃºng tÃ´i váº«n cÃ³ thá»ƒ cÄƒn chá»‰nh MLLM vá»›i
Kosmos-G thÃ´ng qua viá»‡c sá»­ dá»¥ng trá»±c tiáº¿p tá»•n tháº¥t khuáº¿ch tÃ¡n trong PhÆ°Æ¡ng trÃ¬nh 3 vá»›i sá»± giÃºp Ä‘á»¡ cá»§a AlignerNet. Trong khi
nÃ³ tá»‘n kÃ©m hÆ¡n vÃ  dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»‡ hÆ¡n dÆ°á»›i cÃ¹ng sá»‘ ngÃ y GPU.

2.3 Tinh chá»‰nh HÆ°á»›ng dáº«n

Sau khi Ä‘áº¡t Ä‘Æ°á»£c cÄƒn chá»‰nh ngá»¯ nghÄ©a giá»¯a KOSMOS-G vÃ  bá»™ giáº£i mÃ£ hÃ¬nh áº£nh, mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i
cÃ³ thá»ƒ táº¡o hÃ¬nh áº£nh thÃ nh cÃ´ng theo hÆ°á»›ng dáº«n thá»‹ giÃ¡c-ngÃ´n ngá»¯ Ä‘an xen. Tuy nhiÃªn, viá»‡c mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ Ä‘a phÆ°Æ¡ng thá»©c vÃ  giai Ä‘oáº¡n cÄƒn chá»‰nh chá»‰ vÄƒn báº£n chá»‰ báº£o tá»“n sá»± nháº¥t quÃ¡n ngá»¯ nghÄ©a
giá»¯a Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra, KOSMOS-G váº«n khÃ´ng thá»ƒ táº­n dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng phong phÃº Ä‘Æ°á»£c trÃ­ch xuáº¥t tá»«
bá»™ mÃ£ hÃ³a hÃ¬nh áº£nh Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh tÃ¡i táº¡o chung thá»±c ná»™i dung trong cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau.

Äá»ƒ theo Ä‘uá»•i má»¥c tiÃªu "hÃ¬nh áº£nh nhÆ° má»™t ngÃ´n ngá»¯ ngoáº¡i lai trong viá»‡c táº¡o hÃ¬nh áº£nh", chÃºng tÃ´i tuyá»ƒn chá»n dá»¯ liá»‡u thá»‹ giÃ¡c-ngÃ´n ngá»¯ Ä‘an xen vÃ  sá»­ dá»¥ng tá»•n tháº¥t khuáº¿ch tÃ¡n trong PhÆ°Æ¡ng trÃ¬nh 3 Ä‘á»ƒ tinh chá»‰nh thÃªm KOSMOS-G.
Cá»¥ thá»ƒ, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t tÃ¡c vá»¥ táº¡o hÃ¬nh áº£nh thÃ nh pháº§n trong Ä‘Ã³ chÃºng tÃ´i Ä‘áº§u vÃ o cÃ¡c chÃº thÃ­ch chá»©a
cÃ¡c thá»±c thá»ƒ, vá»›i má»—i thá»±c thá»ƒ Ä‘Æ°á»£c theo sau bá»Ÿi hÃ¬nh áº£nh tÆ°Æ¡ng á»©ng cá»§a chÃºng, nhÆ° "<s>Má»™t con mÃ¨o <image> embedding hÃ¬nh áº£nh cá»§a con mÃ¨o </image> vÃ  má»™t con chÃ³ <image> embedding hÃ¬nh áº£nh cá»§a con chÃ³ </image> Ä‘ang ngá»§
trong vÆ°á»n <image> embedding hÃ¬nh áº£nh cá»§a vÆ°á»n </image> </s>". MÃ´ hÃ¬nh cá»§a chÃºng tÃ´i Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ
táº¡o hÃ¬nh áº£nh theo hÆ°á»›ng dáº«n Ä‘áº§u vÃ o.

Äá»ƒ xÃ¢y dá»±ng dá»¯ liá»‡u cáº§n thiáº¿t, trÆ°á»›c tiÃªn chÃºng tÃ´i táº¡o chÃº thÃ­ch cho hÃ¬nh áº£nh, sau Ä‘Ã³ trÃ­ch xuáº¥t cÃ¡c thá»±c thá»ƒ tá»« chÃº thÃ­ch,
vÃ  thu Ä‘Æ°á»£c káº¿t quáº£ phÃ¢n Ä‘oáº¡n tá»« chÃ­nh hÃ¬nh áº£nh Ä‘Ã³. Má»™t giá»›i thiá»‡u chi tiáº¿t vá» toÃ n bá»™
quy trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Pháº§n 3.1. NgoÃ i ra, chÃºng tÃ´i táº­n dá»¥ng dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng bá»Ÿi [BHE23] cho
InstructPix2Pix Ä‘á»ƒ cáº£i thiá»‡n kháº£ nÄƒng chá»‰nh sá»­a hÃ¬nh áº£nh cá»§a KOSMOS-G. Dá»¯ liá»‡u nÃ y cÃ³ cáº¥u trÃºc nhÆ°: "<s>
chÃº thÃ­ch <image> embedding cá»§a hÃ¬nh áº£nh gá»‘c </image> hÆ°á»›ng dáº«n chá»‰nh sá»­a </s>". ChÃºng tÃ´i cÅ©ng trá»™n
má»™t sá»‘ dá»¯ liá»‡u vÄƒn báº£n-thÃ nh-hÃ¬nh áº£nh Ä‘á»ƒ báº£o tá»“n cÄƒn chá»‰nh ngÃ´n ngá»¯ Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c.

Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  táº­n dá»¥ng MLLMs Ä‘á»ƒ mÃ´ hÃ¬nh hÃ³a phÃ¢n phá»‘i hÃ¬nh áº£nh thÃ´ng qua viá»‡c láº¥y máº«u khÃ´ng gian tiá»m áº©n trá»±c tiáº¿p.
Trong thiáº¿t láº­p nÃ y, U-Net Stable Diffusion Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n Ä‘Ã´ng láº¡nh Ä‘Ã³ng vai trÃ² nhÆ° má»™t chá»‰ sá»‘ Ä‘iá»ƒm sá»‘, chÆ°ng cáº¥t
phÃ¢n phá»‘i dá»¯ liá»‡u Ä‘Ã£ há»c. Chiáº¿n lÆ°á»£c nÃ y tÆ°Æ¡ng tá»± nhÆ° Score Distillation Sampling (SDS) [PJBM22].
Tá»« gÃ³c Ä‘á»™ chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘, KL divergence giá»¯a KOSMOS-G (Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  Ï•,
mÃ£ hÃ³a Ä‘áº§u vÃ o thÃ nh Ä‘iá»u kiá»‡n C) vÃ  hÃ m Ä‘iá»ƒm sá»‘ Ä‘Æ°á»£c tá»‘i thiá»ƒu hÃ³a tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»ƒ chÆ°ng cáº¥t
máº­t Ä‘á»™ xÃ¡c suáº¥t Ä‘Ã£ há»c trong bá»™ giáº£i mÃ£ hÃ¬nh áº£nh:
minÏ† LDiff = Ez0,t,C[DKL(q(ztâˆ’1|zt,z0)â€–pÎ¸(ztâˆ’1|zt;C))]   (7)

--- TRANG 7 ---
Tháº»: giÆ°á»ng, gháº¿, tivi, bÃ nHÃ¬nh áº£nhChÃº thÃ­ch HÃ¬nh áº£nhChÃº thÃ­ch: Má»™t phÃ²ng ngá»§ vá»›i má»™t chiáº¿c giÆ°á»ng, má»™t chiáº¿c gháº¿, má»™t chiáº¿c tivi, vÃ  má»™t chiáº¿c bÃ nMÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›nMÃ´ hÃ¬nh PhÃ¢n Ä‘oáº¡n HÃ¬nh áº£nh

Má»™t phÃ²ng ngá»§ vá»›i má»™t chiáº¿c giÆ°á»ng        , má»™t chiáº¿c gháº¿        , má»™t chiáº¿c tivi       , vÃ  má»™t chiáº¿c bÃ n

HÃ¬nh 4: Tá»•ng quan vá» quy trÃ¬nh xÃ¢y dá»±ng dá»¯ liá»‡u cá»§a chÃºng tÃ´i cho tinh chá»‰nh hÆ°á»›ng dáº«n táº¡o hÃ¬nh thÃ nh pháº§n.

Äiá»u nÃ y cho phÃ©p KOSMOS-G táº­n dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng phong phÃº tá»« bá»™ mÃ£ hÃ³a hÃ¬nh áº£nh Ä‘á»ƒ táº¡o ra má»™t hÃ¬nh áº£nh
tÃ¡i táº¡o chung thá»±c ná»™i dung qua cÃ¡c ngá»¯ cáº£nh khÃ¡c nhau. ThÃªm chi tiáº¿t vá» tinh chá»‰nh hÆ°á»›ng dáº«n chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘
cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c C.

3 Huáº¥n luyá»‡n MÃ´ hÃ¬nh

3.1 Dá»¯ liá»‡u Huáº¥n luyá»‡n Äa phÆ°Æ¡ng thá»©c

Giai Ä‘oáº¡n mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ Ä‘a phÆ°Æ¡ng thá»©c trong Pháº§n 2.1 sá»­ dá»¥ng cÃ¹ng thiáº¿t láº­p cá»§a KOSMOS-
1[HDW+23], nÆ¡i cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn táº­p ngá»¯ liá»‡u Ä‘a phÆ°Æ¡ng thá»©c quy mÃ´ web, bao gá»“m táº­p ngá»¯ liá»‡u vÄƒn báº£n,
cÃ¡c cáº·p hÃ¬nh áº£nh-chÃº thÃ­ch, vÃ  dá»¯ liá»‡u Ä‘an xen cá»§a hÃ¬nh áº£nh vÃ  vÄƒn báº£n. Cho giai Ä‘oáº¡n cÄƒn chá»‰nh bá»™ giáº£i mÃ£ hÃ¬nh áº£nh trong Pháº§n 2.2, chÃºng tÃ´i chá»‰ sá»­ dá»¥ng chÃº thÃ­ch tá»« cÃ¡c cáº·p hÃ¬nh áº£nh-chÃº thÃ­ch. Cho giai Ä‘oáº¡n tinh chá»‰nh hÆ°á»›ng dáº«n trong Pháº§n 2.3, chÃºng tÃ´i sá»­ dá»¥ng dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« bá»™ dá»¯ liá»‡u Open Images V7 [KRA+20], cÃ¡c cáº·p hÃ¬nh áº£nh-chÃº thÃ­ch, cÅ©ng nhÆ° dá»¯ liá»‡u chá»‰nh sá»­a hÃ¬nh áº£nh tá»« InstructPix2Pix [BHE23].

ChÃº thÃ­ch CÃ¡c cáº·p hÃ¬nh áº£nh-chÃº thÃ­ch Ä‘Æ°á»£c láº¥y tá»« nhiá»u bá»™ dá»¯ liá»‡u, bao gá»“m English
LAION-2B [SBV+22], LAION-400M [SVB+21], COYO-700M [BPK+22], vÃ  Conceptual Captions [SDGS18,CSDS21]. English LAION-2B, LAION-400M, vÃ  COYO-700M Ä‘Æ°á»£c thu tháº­p tá»«
dá»¯ liá»‡u web Common Crawl báº±ng cÃ¡ch trÃ­ch xuáº¥t hÃ¬nh áº£nh vÃ  vÄƒn báº£n thay tháº¿ tÆ°Æ¡ng á»©ng. Conceptual captions
cÅ©ng Ä‘Æ°á»£c láº¥y tá»« cÃ¡c trang web.

Dá»¯ liá»‡u ÄÆ°á»£c xÃ¢y dá»±ng ChÃºng tÃ´i sá»­ dá»¥ng khoáº£ng 9M hÃ¬nh áº£nh tá»« bá»™ dá»¯ liá»‡u Open Images V7 [KRA+20]
Ä‘á»ƒ xÃ¢y dá»±ng dá»¯ liá»‡u tinh chá»‰nh hÆ°á»›ng dáº«n táº¡o hÃ¬nh thÃ nh pháº§n cá»§a chÃºng tÃ´i. NhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 4, chÃºng tÃ´i
báº¯t Ä‘áº§u báº±ng cÃ¡ch táº¡o chÃº thÃ­ch vá»›i BLIP-2-OPT-6.7b [LLSH23]. Tiáº¿p theo, chÃºng tÃ´i sá»­ dá»¥ng má»™t LLM
MPT-7B-Instruct [T+23] Ä‘á»ƒ trÃ­ch xuáº¥t cÃ¡c thá»±c thá»ƒ tá»« chÃº thÃ­ch. HÃ¬nh áº£nh gá»‘c, cÃ¹ng vá»›i vÄƒn báº£n
cá»§a má»—i thá»±c thá»ƒ, sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ´ hÃ¬nh phÃ¢n Ä‘oáº¡n Ä‘Æ°á»£c nháº¯c báº±ng vÄƒn báº£n CLIPSeg [LE22] Ä‘á»ƒ thu Ä‘Æ°á»£c
hÃ¬nh áº£nh tÆ°Æ¡ng á»©ng cá»§a má»—i thá»±c thá»ƒ.

3.2 Thiáº¿t láº­p Huáº¥n luyá»‡n

Viá»‡c triá»ƒn khai cá»§a chÃºng tÃ´i dá»±a trÃªn thÆ° viá»‡n TorchScale [MWH+22], Ä‘Æ°á»£c thiáº¿t káº¿ cho
viá»‡c huáº¥n luyá»‡n mÃ´ hÃ¬nh quy mÃ´ lá»›n. Theo KOSMOS-1[HDW+23], chÃºng tÃ´i cÅ©ng sá»­ dá»¥ng MAGNETO [WMH+22], má»™t
biáº¿n thá»ƒ Transformer, lÃ m kiáº¿n trÃºc xÆ°Æ¡ng sá»‘ng cá»§a MLLM vÃ  AlignerNet cá»§a chÃºng tÃ´i. ToÃ n bá»™ quÃ¡ trÃ¬nh huáº¥n luyá»‡n
máº¥t khoáº£ng bá»‘n ngÃ y vá»›i 256 GPU NVIDIA V100, tá»©c lÃ  má»™t ngÃ y cho cÄƒn chá»‰nh bá»™ giáº£i mÃ£ hÃ¬nh áº£nh,
vÃ  ba ngÃ y cho tinh chá»‰nh hÆ°á»›ng dáº«n. Trong giai Ä‘oáº¡n tinh chá»‰nh hÆ°á»›ng dáº«n, chÃºng tÃ´i sá»­ dá»¥ng má»™t há»—n há»£p cá»§a dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng,
dá»¯ liá»‡u InstructPix2Pix, vÃ  dá»¯ liá»‡u chÃº thÃ­ch theo tá»· lá»‡ 2:2:1. Äá»‘i vá»›i dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng, Ä‘á»ƒ tÄƒng cÆ°á»ng
tÃ­nh máº¡nh máº½ cá»§a Ä‘áº§u vÃ o, chÃºng tÃ´i ngáº«u nhiÃªn bá» qua cÃ¡c vÄƒn báº£n cá»§a cÃ¡c thá»±c thá»ƒ vá»›i xÃ¡c suáº¥t 0.5 vÃ  cÅ©ng duy trÃ¬
ná»n cá»§a cÃ¡c thá»±c thá»ƒ Ä‘Æ°á»£c phÃ¢n Ä‘oáº¡n vá»›i xÃ¡c suáº¥t 0.5. CÃ¡c cáº¥u hÃ¬nh huáº¥n luyá»‡n khÃ¡c cÃ³ thá»ƒ
Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c A

4 ÄÃ¡nh giÃ¡

4.1 Káº¿t quáº£ Äá»‹nh tÃ­nh ChÃ­nh

NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5, KOSMOS-G mang láº¡i káº¿t quáº£ táº¡o hÃ¬nh khÃ´ng cáº§n tinh chá»‰nh áº¥n tÆ°á»£ng qua cÃ¡c
thiáº¿t láº­p Ä‘a dáº¡ng, táº¡o ra Ä‘áº§u ra cÃ³ Ã½ nghÄ©a vÃ  máº¡ch láº¡c ngay cáº£ Ä‘á»‘i vá»›i cÃ¡c chá»§ Ä‘á» Ä‘Æ°á»£c tÃ¹y chá»‰nh cao. CÃ¡c

--- TRANG 8 ---
lÃ m tranh sÆ¡n dáº§u bá»Ÿi van Goghba lÃ´ cÃ³ chá»§ Ä‘á»trong Minecrafttrong Unity3D
máº·cÄƒntrongbá»™ Ä‘á»“ cá»§atrong phong cÃ¡ch cá»§aHÃ¬nh 5: CÃ¡c vÃ­ dá»¥ táº¡o hÃ¬nh áº£nh khÃ´ng cáº§n tinh chá»‰nh vá»›i lá»i nháº¯c Ä‘a phÆ°Æ¡ng thá»©c.

PhÆ°Æ¡ng phÃ¡p DINO â†‘CLIP-I â†‘CLIP-T â†‘
HÃ¬nh áº£nh Thá»±c (Oracle) 0.774 0.885 -
Tinh chá»‰nh
Textual Inversion [GAA+22] 0.569 0.780 0.255
DreamBooth [RLJ+22] 0.668 0.803 0.305
BLIP-Diffusion [LLH23] 0.670 0.805 0.302
KhÃ´ng cáº§n Tinh chá»‰nh Thá»i gian Thá»­ nghiá»‡m
Re-Imagenâˆ—[CHSC22] 0.600 0.740 0.270
SuTI [CHL+23] 0.741 0.819 0.304
BLIP-Diffusionâˆ—[LLH23] 0.594 0.779 0.300
KOSMOS-Gâˆ—(Ä‘áº§u vÃ o hÃ¬nh áº£nh Ä‘Æ¡n) 0.694 0.847 0.287PhÆ°Æ¡ng phÃ¡p FID â†“
MÃ´ hÃ¬nh T2I
GLIDE [NDR+22] 12.24
Make-A-Scene [GPA+22] 11.84
DALL-E 2 [RDN+22] 10.39
SD v1.5â€ [RBL+22] 9.34
Imagen-3.4B [SCS+22] 7.27
MÃ´ hÃ¬nh VL2I CÄƒn chá»‰nh CLIP
GILL-8B [KFS23] 12.20
Emu-14B [SYC+23] 11.66
KOSMOS-G-1.9B 10.99

Báº£ng 1: TrÃ¡i: So sÃ¡nh Ä‘á»‹nh lÆ°á»£ng trÃªn DreamBench. âˆ—biá»ƒu thá»‹ phÆ°Æ¡ng phÃ¡p khÃ´ng cáº§n tinh chá»‰nh. Pháº£i: So sÃ¡nh FID khÃ´ng cáº§n tinh chá»‰nh trÃªn MS-COCO. â€ chá»‰ ra káº¿t quáº£ Ä‘Æ°á»£c chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ dÆ°á»›i cÃ¹ng thiáº¿t láº­p vÃ  seed vá»›i KOSMOS-G.

máº«u hÃ¬nh áº£nh thá»ƒ hiá»‡n kháº£ nÄƒng táº¡o hÃ¬nh trong viá»‡c tÃ¡i ngá»¯ cáº£nh hÃ³a, phong cÃ¡ch hÃ³a, sá»­a Ä‘á»•i, vÃ 
káº¿t há»£p phá»¥ kiá»‡n. ÄÃ¡ng chÃº Ã½, viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» nhiá»u thá»±c thá»ƒ ráº¥t thÃ¡ch thá»©c ngay cáº£ Ä‘á»‘i vá»›i
cÃ¡c phÆ°Æ¡ng phÃ¡p tinh chá»‰nh nhÆ° DreamBooth [RLJ+22,AAF+23]. Trong khi nhá» vÃ o viá»‡c tinh chá»‰nh hÆ°á»›ng dáº«n táº¡o hÃ¬nh thÃ nh pháº§n má»›i, KOSMOS-G lÃ  mÃ´ hÃ¬nh Ä‘áº§u tiÃªn cÃ³ kháº£ nÄƒng Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y trong
thiáº¿t láº­p khÃ´ng cáº§n tinh chá»‰nh.

4.2 Káº¿t quáº£ Äá»‹nh lÆ°á»£ng

ChÃºng tÃ´i thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡ Ä‘á»‹nh lÆ°á»£ng KOSMOS-G trÃªn DreamBench [RLJ+22] cho viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á»
thá»±c thá»ƒ Ä‘Æ¡n vÃ  MS-COCO [LMB+14] cho viá»‡c táº¡o hÃ¬nh áº£nh tá»« vÄƒn báº£n.

Bá»™ dá»¯ liá»‡u DreamBench chá»©a 30 chá»§ Ä‘á» vÃ  cÃ³ 25 máº«u lá»i nháº¯c, táº¡o ra 750
lá»i nháº¯c duy nháº¥t bao gá»“m cÃ¡c ká»¹ nÄƒng nhÆ° tÃ¡i ngá»¯ cáº£nh hÃ³a, sá»­a Ä‘á»•i, phá»¥ kiá»‡n hÃ³a, v.v. ChÃºng tÃ´i
theo cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y Ä‘á»ƒ táº¡o ra 4 hÃ¬nh áº£nh cho má»—i lá»i nháº¯c Ä‘á»ƒ táº¡o thÃ nh 3000 hÃ¬nh áº£nh cho má»™t
Ä‘Ã¡nh giÃ¡ toÃ n diá»‡n. ChÃºng tÃ´i theo DreamBooth Ä‘á»ƒ Ã¡p dá»¥ng DINO, CLIP-I Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ Ä‘á»™ trung thá»±c chá»§ Ä‘á»,

--- TRANG 9 ---
KOSMOS-G trÆ°á»›c tinh chá»‰nh hÆ°á»›ng dáº«n Stable Diffusion v1.5 [RBL+22]

HÃ¬nh 6: So sÃ¡nh vá»›i cÃ¡c trÆ°á»ng há»£p Ä‘Æ°á»£c trÃ¬nh bÃ y trong hÃ ng thá»© hai cá»§a HÃ¬nh 1.

lÃ m tranh sÆ¡n dáº§u trong phong cÃ¡ch

(a) KOSMOS-G vá»›i Ä‘iá»u khiá»ƒn canny sá»­ dá»¥ng ControlNet.

chÆ¡i

(b) KOSMOS-G vá»›i biáº¿n thá»ƒ LoRA.

HÃ¬nh 7: CÃ¡c á»¨ng dá»¥ng KhÃ¡c nhau cá»§a KOSMOS-G Káº¿t há»£p vá»›i CÃ¡c Ká»¹ thuáº­t U-Net. Trong HÃ¬nh 7b,
hÃ¬nh áº£nh bÃªn trÃ¡i Ä‘Æ°á»£c táº¡o ra báº±ng U-Net tiÃªu chuáº©n, hÃ¬nh áº£nh bÃªn pháº£i Ä‘Æ°á»£c táº¡o ra vá»›i U-Net Ä‘Æ°á»£c tinh chá»‰nh LoRA.

vÃ  CLIP-T Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ Ä‘á»™ trung thá»±c vÄƒn báº£n. ChÃºng tÃ´i sá»­ dá»¥ng tá»· lá»‡ hÆ°á»›ng dáº«n khÃ´ng cÃ³ bá»™ phÃ¢n loáº¡i lÃ  7.5 vÃ  100
bÆ°á»›c suy luáº­n DPM-Solver [LZB+22] cho viá»‡c láº¥y máº«u. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 1, KOSMOS-G khÃ´ng cáº§n tinh chá»‰nh vÆ°á»£t trá»™i hÆ¡n Textual Inversion vÃ  Re-Imagen vÃ  thá»ƒ hiá»‡n hiá»‡u suáº¥t tá»‘t hÆ¡n má»™t chÃºt so vá»›i
DreamBooth vÃ  BLIP-Diffusion chá»‰ vá»›i Ä‘áº§u vÃ o hÃ¬nh áº£nh Ä‘Æ¡n. HÆ¡n ná»¯a, káº¿t quáº£ cá»§a chÃºng tÃ´i cÅ©ng
cÃ³ thá»ƒ so sÃ¡nh vá»›i SuTI, mÃ  khÃ´ng cáº§n giÃ¡m sÃ¡t há»c viá»‡c Ä‘áº¯t Ä‘á». KOSMOS-G
cháº¥p nháº­n chá»‰ má»™t hÃ¬nh áº£nh Ä‘Æ¡n lÃ m Ä‘áº§u vÃ o, chÃºng tÃ´i chá»n má»™t hÃ¬nh áº£nh rÃµ rÃ ng tá»« 4-7 hÃ¬nh áº£nh Ä‘Æ°á»£c cung cáº¥p cho má»—i
chá»§ Ä‘á» Ä‘á»ƒ trÃ¡nh che khuáº¥t. ChÃºng tÃ´i sá»­a Ä‘á»•i nháº¹ máº«u lá»i nháº¯c Ä‘á»ƒ Ä‘áº£m báº£o cÄƒn chá»‰nh tá»‘t hÆ¡n vá»›i
dá»¯ liá»‡u tinh chá»‰nh hÆ°á»›ng dáº«n. CÃ¡c hÃ¬nh áº£nh vÃ  lá»i nháº¯c Ä‘Æ°á»£c sá»­ dá»¥ng cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c B.

Äá»‘i vá»›i viá»‡c táº¡o hÃ¬nh áº£nh tá»« vÄƒn báº£n, chÃºng tÃ´i táº¡o hÃ¬nh áº£nh báº±ng cÃ¡ch sá»­ dá»¥ng 30,000 chÃº thÃ­ch Ä‘Æ°á»£c láº¥y máº«u ngáº«u nhiÃªn
tá»« táº­p xÃ¡c thá»±c MS-COCO (2014). ChÃºng tÃ´i sá»­ dá»¥ng tá»· lá»‡ hÆ°á»›ng dáº«n khÃ´ng cÃ³ bá»™ phÃ¢n loáº¡i lÃ  3.0 vÃ  250
bÆ°á»›c suy luáº­n DDIM [SME21] cho viá»‡c láº¥y máº«u. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 1, KOSMOS-G vÆ°á»£t trá»™i hÆ¡n cÃ¡c
mÃ´ hÃ¬nh VL2I cÄƒn chá»‰nh CLIP khÃ¡c, mang láº¡i káº¿t quáº£ cÄƒn chá»‰nh tá»‘i Æ°u.

4.3 NghiÃªn cá»©u Loáº¡i bá»

PhÆ°Æ¡ng phÃ¡p FID â†“
SD v1.5 [RBL+22] 9.34
E2E w/o AlignerNet Tháº¥t báº¡i
E2E w/ AlignerNet 11.30
12-Layers Decoder Tháº¥t báº¡i
12-Layers AlignerNet 9.89
24-Layers AlignerNet 9.55

Báº£ng 2: Káº¿t quáº£ nghiÃªn cá»©u loáº¡i bá»
cho cÄƒn chá»‰nh bá»™ giáº£i mÃ£ hÃ¬nh áº£nh trÃªn
MS-COCO.ChÃºng tÃ´i thá»±c hiá»‡n cÃ¡c nghiÃªn cá»©u loáº¡i bá» Ä‘á»ƒ tÃ¬m ra táº§m quan trá»ng cá»§a viá»‡c cÄƒn chá»‰nh bá»™ giáº£i mÃ£ hÃ¬nh áº£nh
vÃ  tinh chá»‰nh hÆ°á»›ng dáº«n. Báº£ng 2 chá»©ng minh ráº±ng
viá»‡c tinh chá»‰nh end-to-end trá»±c tiáº¿p hoáº·c sá»­ dá»¥ng kiáº¿n trÃºc chá»‰ bá»™ giáº£i mÃ£
khÃ´ng táº¡o ra hÃ¬nh áº£nh cÃ³ Ã½ nghÄ©a. Tuy nhiÃªn, viá»‡c káº¿t há»£p AlignerNet vÃ 
giÃ¡m sÃ¡t CLIP dáº«n Ä‘áº¿n káº¿t quáº£ gáº§n vá»›i SD v1.5 gá»‘c. Viá»‡c huáº¥n luyá»‡n end-to-end cÅ©ng kháº£ thi vá»›i AlignerNet,
nhÆ°ng nÃ³ tá»‘n kÃ©m hÆ¡n do tÃ­nh toÃ¡n bá»• sung cá»§a
U-Net. Äiá»u nÃ y dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»‡ hÆ¡n trong cÃ¹ng sá»‘ ngÃ y GPU. ChÃºng tÃ´i cÅ©ng so sÃ¡nh káº¿t quáº£ táº¡o hÃ¬nh tá»« KOSMOS-G
trÆ°á»›c tinh chá»‰nh hÆ°á»›ng dáº«n vÃ  SD v1.5 tiÃªu chuáº©n vá»›i mÃ´ hÃ¬nh cuá»‘i cÃ¹ng cá»§a chÃºng tÃ´i. NhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 6, khÃ´ng cÃ³ tinh chá»‰nh hÆ°á»›ng dáº«n,
KOSMOS-G chá»‰ cÃ³ thá»ƒ táº¡o ra ná»™i dung cÄƒn chá»‰nh ngá»¯ nghÄ©a vá»›i
Ä‘áº§u vÃ o thá»‹ giÃ¡c-ngÃ´n ngá»¯. Baseline SD cÅ©ng váº«n á»Ÿ má»©c ngá»¯ nghÄ©a vÃ  khÃ´ng tÃ¡i táº¡o chung thá»±c cÃ¡c thá»±c thá»ƒ trong hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra.

4.4 á»¨ng dá»¥ng

NhÆ° Ä‘Æ°á»£c nháº¥n máº¡nh trong Pháº§n 2.3, KOSMOS-G cÃ³ thá»ƒ thay tháº¿ liá»n máº¡ch CLIP trong báº¥t ká»³ há»‡ thá»‘ng táº¡o hÃ¬nh áº£nh nÃ o. Thuá»™c tÃ­nh Ä‘Ã¡ng chÃº Ã½ nÃ y má»Ÿ khÃ³a vÃ´ sá»‘ á»©ng dá»¥ng hoÃ n toÃ n má»›i mÃ  chÆ°a tá»«ng

--- TRANG 10 ---
cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c trÆ°á»›c Ä‘Ã¢y. ChÃºng tÃ´i chá»©ng minh viá»‡c tÃ­ch há»£p vá»›i ControlNet [ZA23] vÃ  cÃ¡c biáº¿n thá»ƒ LoRA [HSW+22] trong HÃ¬nh 7. KOSMOS-G hoáº¡t Ä‘á»™ng hoÃ n háº£o vá»›i cÃ¡c ká»¹ thuáº­t nÃ y. Dá»±a trÃªn
khÃ´ng gian CLIP, chÃºng tÃ´i tin ráº±ng mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i sáº½ thÃºc Ä‘áº©y quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i tá»« viá»‡c táº¡o hÃ¬nh cÃ³ Ä‘iá»u kiá»‡n vÄƒn báº£n
sang viá»‡c táº¡o hÃ¬nh thá»‹ giÃ¡c-ngÃ´n ngá»¯, má»Ÿ Ä‘Æ°á»ng cho nhiá»u á»©ng dá»¥ng má»›i láº¡.

5 Káº¿t luáº­n

ChÃºng tÃ´i Ä‘á» xuáº¥t KOSMOS-G, má»™t mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh cÃ³ Ä‘á»™ trung thá»±c cao tá»«
Ä‘áº§u vÃ o hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘an xen nhiá»u áº£nh. CÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i dá»±a trÃªn chiáº¿n lÆ°á»£c tiá»n huáº¥n luyá»‡n "cÄƒn chá»‰nh trÆ°á»›c khi hÆ°á»›ng dáº«n" Ä‘á»™c Ä‘Ã¡o. KOSMOS-G thá»ƒ hiá»‡n kháº£ nÄƒng táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» thá»±c thá»ƒ Ä‘Æ¡n cáº¡nh tranh
vÃ  kháº£ nÄƒng táº¡o hÃ¬nh áº£nh tá»« vÄƒn báº£n, nÃ³ cÅ©ng lÃ  mÃ´ hÃ¬nh Ä‘áº§u tiÃªn má»Ÿ rá»™ng viá»‡c táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á» khÃ´ng cáº§n tinh chá»‰nh
sang cÃ¡c tÃ¬nh huá»‘ng nhiá»u thá»±c thá»ƒ. HÆ¡n ná»¯a, KOSMOS-G cho phÃ©p thay tháº¿ liá»n máº¡ch CLIP,
má»Ÿ khÃ³a cÃ¡c á»©ng dá»¥ng má»›i khÃ¡c nhau káº¿t há»£p vá»›i cÃ¡c ká»¹ thuáº­t U-Net khÃ¡c nhÆ° ControlNet
vÃ  LoRA. NÃ³i chung, chÃºng tÃ´i trÃ¬nh bÃ y KOSMOS-G nhÆ° má»™t ná»— lá»±c sÆ¡ bá»™ nháº±m Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu
"hÃ¬nh áº£nh nhÆ° má»™t ngÃ´n ngá»¯ ngoáº¡i lai trong viá»‡c táº¡o hÃ¬nh áº£nh."

TuyÃªn bá»‘ Äáº¡o Ä‘á»©c

KOSMOS-G hoÃ n toÃ n lÃ  má»™t dá»± Ã¡n nghiÃªn cá»©u. Hiá»‡n táº¡i, chÃºng tÃ´i khÃ´ng cÃ³ káº¿ hoáº¡ch káº¿t há»£p KOSMOS-G vÃ o
má»™t sáº£n pháº©m hoáº·c má»Ÿ rá»™ng quyá»n truy cáº­p cho cÃ´ng chÃºng. ChÃºng tÃ´i cÅ©ng sáº½ Ä‘Æ°a cÃ¡c nguyÃªn táº¯c AI cá»§a Microsoft vÃ o thá»±c hÃ nh khi
tiáº¿p tá»¥c phÃ¡t triá»ƒn cÃ¡c mÃ´ hÃ¬nh.

Trong bÃ i bÃ¡o nghiÃªn cá»©u cá»§a chÃºng tÃ´i, chÃºng tÃ´i tÃ­nh Ä‘áº¿n cÃ¡c má»‘i quan tÃ¢m Ä‘áº¡o Ä‘á»©c liÃªn quan Ä‘áº¿n nghiÃªn cá»©u vÄƒn báº£n-thÃ nh-hÃ¬nh áº£nh. Äá»ƒ
giáº£m thiá»ƒu cÃ¡c váº¥n Ä‘á» liÃªn quan Ä‘áº¿n dá»¯ liá»‡u huáº¥n luyá»‡n, chÃºng tÃ´i Ä‘Ã£ triá»ƒn khai má»™t quy trÃ¬nh lá»c nghiÃªm ngáº·t Ä‘á»ƒ
loáº¡i bá» khá»i dá»¯ liá»‡u huáº¥n luyá»‡n cá»§a chÃºng tÃ´i ná»™i dung khÃ´ng phÃ¹ há»£p, cháº³ng háº¡n nhÆ° hÃ¬nh áº£nh khiÃªu dÃ¢m vÃ  ngÃ´n ngá»¯ xÃºc pháº¡m, Ä‘á»ƒ
tá»‘i thiá»ƒu hÃ³a kháº£ nÄƒng táº¡o ra ná»™i dung khÃ´ng phÃ¹ há»£p.

TÃ i liá»‡u tham kháº£o

[AAF+23]Omri Avrahami, Kfir Aberman, Ohad Fried, Daniel Cohen-Or, vÃ  Dani Lischinski.
Break-a-scene: Extracting multiple concepts from a single image. arXiv preprint
arXiv:2305.16311, 2023.

[ADL+22]Jean-Baptiste Alayrac, Jeff Donahue, Pauline Luc, Antoine Miech, Iain Barr, Yana
Hasson, Karel Lenc, Arthur Mensch, Katherine Millican, Malcolm Reynolds, Roman
Ring, Eliza Rutherford, Serkan Cabi, Tengda Han, Zhitao Gong, Sina Samangooei, Mar-
ianne Monteiro, Jacob Menick, Sebastian Borgeaud, Andrew Brock, Aida Nematzadeh,
Sahand Sharifzadeh, Mikolaj Binkowski, Ricardo Barreira, Oriol Vinyals, Andrew
Zisserman, vÃ  Karen Simonyan. Flamingo: a visual language model for few-shot
learning. In Advances in Neural Information Processing Systems, 2022.

[AHR+22]Armen Aghajanyan, Bernie Huang, Candace Ross, Vladimir Karpukhin, Hu Xu, Na-
man Goyal, Dmytro Okhonko, Mandar Joshi, Gargi Ghosh, Mike Lewis, vÃ  Luke
Zettlemoyer. CM3: A causal masked multimodal model of the Internet. ArXiv preprint,
abs/2201.07520, 2022.

[BHE23] Tim Brooks, Aleksander Holynski, vÃ  Alexei A Efros. Instructpix2pix: Learning to
follow image editing instructions. In Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition, pages 18392â€“18402, 2023.

[BPK+22]Minwoo Byeon, Beomhee Park, Haecheon Kim, Sungjun Lee, Woonhyuk Baek, vÃ 
Saehoon Kim. Coyo-700m: Image-text pair dataset, 2022.

[CHL+23]Wenhu Chen, Hexiang Hu, Yandong Li, Nataniel Rui, Xuhui Jia, Ming-Wei Chang, vÃ 
William W Cohen. Subject-driven text-to-image generation via apprenticeship learning.
ArXiv preprint, abs/2304.00186, 2023.

[CHSC22] Wenhu Chen, Hexiang Hu, Chitwan Saharia, vÃ  William W Cohen. Re-imagen:
Retrieval-augmented text-to-image generator. ArXiv preprint, abs/2209.14491, 2022.

--- TRANG 11 ---
[CSDS21] Soravit Changpinyo, Piyush Sharma, Nan Ding, vÃ  Radu Soricut. Conceptual 12m:
Pushing web-scale image-text pre-training to recognize long-tail visual concepts. In
IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2021, virtual,
June 19-25, 2021, pages 3558â€“3568. Computer Vision Foundation / IEEE, 2021.

[DBK+21]Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua
Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Syl-
vain Gelly, Jakob Uszkoreit, vÃ  Neil Houlsby. An image is worth 16x16 words: Trans-
formers for image recognition at scale. In 9th International Conference on Learning
Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021. OpenReview.net,
2021.

[DHP+23]Runpei Dong, Chunrui Han, Yuang Peng, Zekun Qi, Zheng Ge, Jinrong Yang, Liang
Zhao, Jianjian Sun, Hongyu Zhou, Haoran Wei, et al. Dreamllm: Synergistic multimodal
comprehension and creation. ArXiv preprint, abs/2309.11499, 2023.

[GAA+22]Rinon Gal, Yuval Alaluf, Yuval Atzmon, Or Patashnik, Amit H Bermano, Gal Chechik,
vÃ  Daniel Cohen-Or. An image is worth one word: Personalizing text-to-image
generation using textual inversion. ArXiv preprint, abs/2208.01618, 2022.

[GPA+22]Oran Gafni, Adam Polyak, Oron Ashual, Shelly Sheynin, Devi Parikh, vÃ  Yaniv
Taigman. Make-a-scene: Scene-based text-to-image generation with human priors.
ArXiv preprint, abs/2203.13131, 2022.

[HDW+23]Shaohan Huang, Li Dong, Wenhui Wang, Yaru Hao, Saksham Singhal, Shuming Ma,
Tengchao Lv, Lei Cui, Owais Khan Mohammed, Qiang Liu, et al. Language is not all
you need: Aligning perception with language models. ArXiv preprint, abs/2302.14045,
2023.

[HHZW23] Shaozhe Hao, Kai Han, Shihao Zhao, vÃ  Kwan-Yee K Wong. Vico: Detail-
preserving visual condition for personalized text-to-image generation. arXiv preprint
arXiv:2306.00971, 2023.

[HJA20] Jonathan Ho, Ajay Jain, vÃ  Pieter Abbeel. Denoising diffusion probabilistic models.
In Hugo Larochelle, Marc'Aurelio Ranzato, Raia Hadsell, Maria-Florina Balcan, vÃ 
Hsuan-Tien Lin, editors, Advances in Neural Information Processing Systems 33:
Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020,
December 6-12, 2020, virtual, 2020.

[HS22] Jonathan Ho vÃ  Tim Salimans. Classifier-free diffusion guidance. ArXiv preprint,
abs/2207.12598, 2022.

[HSD+22]Yaru Hao, Haoyu Song, Li Dong, Shaohan Huang, Zewen Chi, Wenhui Wang, Shuming
Ma, vÃ  Furu Wei. Language models are general-purpose interfaces. ArXiv preprint,
abs/2206.06336, 2022.

[HSW+22]Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, vÃ  Weizhu Chen. Lora: Low-rank adaptation of large language
models. In The Tenth International Conference on Learning Representations, ICLR
2022, Virtual Event, April 25-29, 2022. OpenReview.net, 2022.

[KFS23] Jing Yu Koh, Daniel Fried, vÃ  Ruslan Salakhutdinov. Generating images with multi-
modal language models. ArXiv preprint, abs/2305.17216, 2023.

[KR18] Taku Kudo vÃ  John Richardson. SentencePiece: A simple and language independent
subword tokenizer and detokenizer for neural text processing. In Proceedings of the
2018 Conference on Empirical Methods in Natural Language Processing: System
Demonstrations, pages 66â€“71, Brussels, Belgium, 2018. Association for Computational
Linguistics.

[KRA+20]Alina Kuznetsova, Hassan Rom, Neil Alldrin, Jasper Uijlings, Ivan Krasin, Jordi Pont-
Tuset, Shahab Kamali, Stefan Popov, Matteo Malloci, Alexander Kolesnikov, Tom
Duerig, vÃ  Vittorio Ferrari. The open images dataset v4: Unified image classification,
object detection, and visual relationship detection at scale. IJCV, 2020.

--- TRANG 12 ---
[KW14] Diederik P. Kingma vÃ  Max Welling. Auto-encoding variational bayes. In Yoshua
Bengio vÃ  Yann LeCun, editors, 2nd International Conference on Learning Rep-
resentations, ICLR 2014, Banff, AB, Canada, April 14-16, 2014, Conference Track
Proceedings, 2014.

[KZZ+23]Nupur Kumari, Bingliang Zhang, Richard Zhang, Eli Shechtman, vÃ  Jun-Yan
Zhu. Multi-concept customization of text-to-image diffusion. In Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 1931â€“1941,
2023.

[LE22] Timo LÃ¼ddecke vÃ  Alexander Ecker. Image segmentation using text and image
prompts. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition, pages 7086â€“7096, 2022.

[LLH23] Dongxu Li, Junnan Li, vÃ  Steven CH Hoi. Blip-diffusion: Pre-trained subject rep-
resentation for controllable text-to-image generation and editing. ArXiv preprint,
abs/2305.14720, 2023.

[LLSH23] Junnan Li, Dongxu Li, Silvio Savarese, vÃ  Steven Hoi. BLIP-2: Bootstrapping
language-image pre-training with frozen image encoders and large language models.
ArXiv preprint, abs/2301.12597, 2023.

[LMB+14]Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr DollÃ¡r, vÃ  C Lawrence Zitnick. Microsoft coco: Common objects
in context. In Computer Visionâ€“ECCV 2014: 13th European Conference, Zurich,
Switzerland, September 6-12, 2014, Proceedings, Part V 13, pages 740â€“755. Springer,
2014.

[LOG+19]Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, vÃ  Veselin Stoyanov. RoBERTa: A robustly
optimized bert pretraining approach. ArXiv preprint, abs/1907.11692, 2019.

[Luo22] Calvin Luo. Understanding diffusion models: A unified perspective. arXiv preprint
arXiv:2208.11970, 2022.

[LZB+22]Cheng Lu, Yuhao Zhou, Fan Bao, Jianfei Chen, Chongxuan Li, vÃ  Jun Zhu. Dpm-
solver: A fast ode solver for diffusion probabilistic model sampling in around 10 steps.
Advances in Neural Information Processing Systems, 35:5775â€“5787, 2022.

[MWH+22]Shuming Ma, Hongyu Wang, Shaohan Huang, Wenhui Wang, Zewen Chi, Li Dong,
Alon Benhaim, Barun Patra, Vishrav Chaudhary, Xia Song, vÃ  Furu Wei. TorchScale:
Transformers at scale. ArXiv preprint, abs/2211.13184, 2022.

[NDR+22]Alexander Quinn Nichol, Prafulla Dhariwal, Aditya Ramesh, Pranav Shyam, Pamela
Mishkin, Bob McGrew, Ilya Sutskever, vÃ  Mark Chen. GLIDE: towards photoreal-
istic image generation and editing with text-guided diffusion models. In Kamalika
Chaudhuri, Stefanie Jegelka, Le Song, Csaba SzepesvÃ¡ri, Gang Niu, vÃ  Sivan Sabato,
editors, International Conference on Machine Learning, ICML 2022, 17-23 July 2022,
Baltimore, Maryland, USA, volume 162 of Proceedings of Machine Learning Research,
pages 16784â€“16804. PMLR, 2022.

[PJBM22] Ben Poole, Ajay Jain, Jonathan T Barron, vÃ  Ben Mildenhall. Dreamfusion: Text-to-3d
using 2d diffusion. ArXiv preprint, abs/2209.14988, 2022.

[QYX+23]Can Qin, Ning Yu, Chen Xing, Shu Zhang, Zeyuan Chen, Stefano Ermon, Yun Fu,
Caiming Xiong, vÃ  Ran Xu. Gluegen: Plug and play multi-modal encoders for
x-to-image generation. ArXiv preprint, abs/2303.10056, 2023.

[RBL+22]Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, vÃ  BjÃ¶rn Ommer.
High-resolution image synthesis with latent diffusion models. In Proceedings of the
IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 10684â€“
10695, 2022.

--- TRANG 13 ---
[RDN+22]Aditya Ramesh, Prafulla Dhariwal, Alex Nichol, Casey Chu, vÃ  Mark Chen. Hierarchi-
cal text-conditional image generation with clip latents. ArXiv preprint, abs/2204.06125,
2022.

[RFB15] Olaf Ronneberger, Philipp Fischer, vÃ  Thomas Brox. U-net: Convolutional networks
for biomedical image segmentation. In International Conference on Medical image
computing and computer-assisted intervention, pages 234â€“241. Springer, 2015.

[RKH+21]Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini
Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger,
vÃ  Ilya Sutskever. Learning transferable visual models from natural language supervi-
sion. In Marina Meila vÃ  Tong Zhang, editors, Proceedings of the 38th International
Conference on Machine Learning, ICML 2021, 18-24 July 2021, Virtual Event, volume
139 of Proceedings of Machine Learning Research, pages 8748â€“8763. PMLR, 2021.

[RLJ+22]Nataniel Ruiz, Yuanzhen Li, Varun Jampani, Yael Pritch, Michael Rubinstein, vÃ  Kfir
Aberman. Dreambooth: Fine tuning text-to-image diffusion models for subject-driven
generation. ArXiv preprint, abs/2208.12242, 2022.

[SBV+22]Christoph Schuhmann, Romain Beaumont, Richard Vencu, Cade Gordon, Ross Wight-
man, Mehdi Cherti, Theo Coombes, Aarush Katta, Clayton Mullis, Mitchell Wortsman,
et al. Laion-5b: An open large-scale dataset for training next generation image-text
models. ArXiv preprint, abs/2210.08402, 2022.

[SCS+22]Chitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily Denton,
Seyed Kamyar Seyed Ghasemipour, Burcu Karagol Ayan, S Sara Mahdavi, Rapha Gon-
tijo Lopes, et al. Photorealistic text-to-image diffusion models with deep language
understanding. ArXiv preprint, abs/2205.11487, 2022.

[SDGS18] Piyush Sharma, Nan Ding, Sebastian Goodman, vÃ  Radu Soricut. Conceptual captions:
A cleaned, hypernymed, image alt-text dataset for automatic image captioning. In Pro-
ceedings of the 56th Annual Meeting of the Association for Computational Linguistics
(Volume 1: Long Papers), pages 2556â€“2565, Melbourne, Australia, 2018. Association
for Computational Linguistics.

[SHZ+23]James Seale Smith, Yen-Chang Hsu, Lingyu Zhang, Ting Hua, Zsolt Kira, Yilin Shen,
vÃ  Hongxia Jin. Continual diffusion: Continual customization of text-to-image diffu-
sion with c-lora. arXiv preprint arXiv:2304.06027, 2023.

[SME21] Jiaming Song, Chenlin Meng, vÃ  Stefano Ermon. Denoising diffusion implicit models.
In 9th International Conference on Learning Representations, ICLR 2021, Virtual Event,
Austria, May 3-7, 2021. OpenReview.net, 2021.

[SVB+21]Christoph Schuhmann, Richard Vencu, Romain Beaumont, Robert Kaczmarczyk, Clay-
ton Mullis, Aarush Katta, Theo Coombes, Jenia Jitsev, vÃ  Aran Komatsuzaki. Laion-
400m: Open dataset of clip-filtered 400 million image-text pairs. ArXiv preprint,
abs/2111.02114, 2021.

[SWMG15] Jascha Sohl-Dickstein, Eric A. Weiss, Niru Maheswaranathan, vÃ  Surya Ganguli. Deep
unsupervised learning using nonequilibrium thermodynamics. In Francis R. Bach vÃ 
David M. Blei, editors, Proceedings of the 32nd International Conference on Machine
Learning, ICML 2015, Lille, France, 6-11 July 2015, volume 37 of JMLR Workshop
and Conference Proceedings, pages 2256â€“2265. JMLR.org, 2015.

[SYC+23]Quan Sun, Qiying Yu, Yufeng Cui, Fan Zhang, Xiaosong Zhang, Yueze Wang,
Hongcheng Gao, Jingjing Liu, Tiejun Huang, vÃ  Xinlong Wang. Generative pre-
training in multimodality. ArXiv preprint, abs/2307.05222, 2023.

[T+23]MN Team et al. Introducing MPT-7B: A new standard for open-source, commercially
usable llms, 2023.

[TGCA23] Yoad Tewel, Rinon Gal, Gal Chechik, vÃ  Yuval Atzmon. Key-locked rank one editing
for text-to-image personalization. arXiv preprint arXiv:2305.01644, 2023.

--- TRANG 14 ---
[WMH+22]Hongyu Wang, Shuming Ma, Shaohan Huang, Li Dong, Wenhui Wang, Zhiliang
Peng, Yu Wu, Payal Bajaj, Saksham Singhal, Alon Benhaim, Barun Patra, Zhun Liu,
Vishrav Chaudhary, Xia Song, vÃ  Furu Wei. Foundation transformers. ArXiv preprint,
abs/2210.06423, 2022.

[WZJ+23]Yuxiang Wei, Yabo Zhang, Zhilong Ji, Jinfeng Bai, Lei Zhang, vÃ  Wangmeng Zuo.
Elite: Encoding visual concepts into textual embeddings for customized text-to-image
generation. arXiv preprint arXiv:2302.13848, 2023.

[XYF+23]Guangxuan Xiao, Tianwei Yin, William T Freeman, FrÃ©do Durand, vÃ  Song Han.
Fastcomposer: Tuning-free multi-subject image generation with localized attention.
arXiv preprint arXiv:2305.10431, 2023.

[ZA23] Lvmin Zhang vÃ  Maneesh Agrawala. Adding conditional control to text-to-image
diffusion models, 2023.

--- TRANG 15 ---
HÃ¬nh 8: CÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c chá»n tá»« DreamBench.

A Thiáº¿t láº­p Huáº¥n luyá»‡n Chi tiáº¿t

MÃ´ hÃ¬nh hÃ³a NgÃ´n ngá»¯ Äa phÆ°Æ¡ng thá»©c ChÃºng tÃ´i sá»­ dá»¥ng kÃ­ch thÆ°á»›c batch 1.2 triá»‡u token Ä‘Æ°á»£c phÃ¢n tÃ­ch
nhÆ° sau: 0.5 triá»‡u token Ä‘Æ°á»£c láº¥y tá»« táº­p ngá»¯ liá»‡u vÄƒn báº£n, 0.5 triá»‡u token Ä‘Æ°á»£c láº¥y tá»«
cÃ¡c cáº·p hÃ¬nh áº£nh-chÃº thÃ­ch, vÃ  0.2 triá»‡u token tá»« cÃ¡c táº­p dá»¯ liá»‡u Ä‘an xen. MLLM Ä‘Æ°á»£c huáº¥n luyá»‡n trong
300,000 bÆ°á»›c, tÆ°Æ¡ng á»©ng vá»›i khoáº£ng 360 tá»· token tá»•ng cá»™ng. ChÃºng tÃ´i Ã¡p dá»¥ng tá»‘i Æ°u hÃ³a AdamW
vá»›i Î²=(0.9,0.98). HÆ¡n ná»¯a, chÃºng tÃ´i cáº¥u hÃ¬nh weight decay á»Ÿ 0.01 vÃ  tá»· lá»‡ dropout
á»Ÿ 0.1. Tá»· lá»‡ há»c Ä‘Æ°á»£c Ä‘áº·t Ä‘á»ƒ tÄƒng lÃªn 2e-4 trong 375 bÆ°á»›c khá»Ÿi Ä‘á»™ng ban Ä‘áº§u vÃ  giáº£m
tuyáº¿n tÃ­nh vá» 0 cho pháº§n cÃ²n láº¡i cá»§a cÃ¡c bÆ°á»›c huáº¥n luyá»‡n. Äá»ƒ á»•n Ä‘á»‹nh tá»‘i Æ°u hÃ³a, chÃºng tÃ´i khá»Ÿi táº¡o báº±ng Magneto.
ChÃºng tÃ´i sá»­ dá»¥ng SentencePiece [KR18] Ä‘á»ƒ token hÃ³a vÄƒn báº£n. ChÃºng tÃ´i tiá»n xá»­ lÃ½ dá»¯ liá»‡u trong Ä‘á»‹nh dáº¡ng "full-sentence" [LOG+19], nÆ¡i má»—i chuá»—i Ä‘áº§u vÃ o Ä‘Æ°á»£c Ä‘iá»n vá»›i cÃ¡c cÃ¢u hoÃ n chá»‰nh Ä‘Æ°á»£c láº¥y máº«u liÃªn tiáº¿p
tá»« má»™t hoáº·c nhiá»u tÃ i liá»‡u.

CÄƒn chá»‰nh Bá»™ giáº£i mÃ£ HÃ¬nh áº£nh AlignerNet tráº£i qua huáº¥n luyá»‡n sá»­ dá»¥ng kÃ­ch thÆ°á»›c batch 3,584 cÃ¢u
trong 300,000 bÆ°á»›c, vá»›i tá»· lá»‡ há»c tá»‘i Ä‘a 1e-3. Äiá»u nÃ y tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i khoáº£ng 1 tá»·
cÃ¢u tá»•ng thá»ƒ. CÃ¡c cáº¥u hÃ¬nh cÃ²n láº¡i giá»¯ nguyÃªn nhÆ° giai Ä‘oáº¡n trÆ°á»›c.

Tinh chá»‰nh HÆ°á»›ng dáº«n MLLM vÃ  AlignerNet Ä‘Æ°á»£c huáº¥n luyá»‡n cÃ¹ng nhau vá»›i kÃ­ch thÆ°á»›c batch 1,024
hÃ¬nh áº£nh, tá»•ng cá»™ng khoáº£ng 200 triá»‡u hÃ¬nh áº£nh qua 200,000 bÆ°á»›c. Tá»· lá»‡ há»c Ä‘áº¡t Ä‘á»‰nh á»Ÿ
1e-3. CÃ¡c thiáº¿t láº­p cÃ²n láº¡i giá»‘ng nhÆ° giai Ä‘oáº¡n trÆ°á»›c.

B HÃ¬nh áº£nh vÃ  Lá»i nháº¯c cho ÄÃ¡nh giÃ¡ DreamBench

CÃ¡c hÃ¬nh áº£nh Ä‘áº§u vÃ o Ä‘Æ°á»£c chá»n cho má»—i thá»±c thá»ƒ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ DreamBench Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 8. NhÆ°
Ä‘Æ°á»£c mÃ´ táº£ trong Báº£ng 3, chÃºng tÃ´i cÅ©ng sá»­a Ä‘á»•i nháº¹ lá»i nháº¯c gá»‘c Ä‘á»ƒ lÃ m cho nÃ³ cÄƒn chá»‰nh tá»‘t hÆ¡n vá»›i
dá»¯ liá»‡u huáº¥n luyá»‡n. Äá»‘i vá»›i lá»i nháº¯c cÃ²n láº¡i, chÃºng tÃ´i chá»‰ Ä‘Æ¡n giáº£n loáº¡i bá» tiá»n tá»‘ "a". ChÃºng tÃ´i quan sÃ¡t tháº¥y tiá»n tá»‘ sáº½
áº£nh hÆ°á»Ÿng nháº¹ Ä‘áº¿n hiá»‡u suáº¥t cá»§a viá»‡c chá»‰nh sá»­a hÃ¬nh áº£nh hoáº·c táº¡o hÃ¬nh tÃ¹y chá»‰nh. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c quy cho
táº§n suáº¥t cao cá»§a cÃ¡c chÃº thÃ­ch báº¯t Ä‘áº§u vá»›i "a photo of" Ä‘Æ°á»£c táº¡o ra bá»Ÿi BLIP-2 trong dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘Æ°á»£c xÃ¢y dá»±ng cá»§a chÃºng tÃ´i. Cho ráº±ng dá»¯ liá»‡u tinh chá»‰nh hÆ°á»›ng dáº«n thÃ nh pháº§n khÃ´ng chá»©a quÃ¡ nhiá»u dá»¯ liá»‡u chá»‰nh sá»­a khi má»™t lá»i nháº¯c báº¯t Ä‘áº§u vá»›i tiá»n tá»‘ nhÆ° "a", mÃ´ hÃ¬nh thÆ°á»ng trÃ¡nh thay Ä‘á»•i váº» ngoÃ i
cá»§a hÃ¬nh áº£nh Ä‘áº§u vÃ o. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c tinh chá»‰nh thÃªm báº±ng cÃ¡ch thay Ä‘á»•i mÃ´ hÃ¬nh dá»¯ liá»‡u hoáº·c báº±ng cÃ¡ch tinh chá»‰nh
cÄƒn chá»‰nh.

Lá»i nháº¯c Gá»‘c Lá»i nháº¯c ÄÃ£ sá»­a Ä‘á»•i
a red {} {}, red
a purple {} {}, purple
a shiny {} {}, shiny
a wet {} {}, wet
a cube shaped {} {}, cube shaped

Báº£ng 3: Sá»­a Ä‘á»•i Lá»i nháº¯c

C Chi tiáº¿t Bá»• sung vá» Tinh chá»‰nh HÆ°á»›ng dáº«n ChÆ°ng cáº¥t Äiá»ƒm sá»‘

Trong giai Ä‘oáº¡n tinh chá»‰nh hÆ°á»›ng dáº«n, chÃºng tÃ´i váº«n sá»­ dá»¥ng tá»•n tháº¥t khuáº¿ch tÃ¡n cho viá»‡c huáº¥n luyá»‡n mÃ´ hÃ¬nh. Tuy nhiÃªn,
tá»•n tháº¥t nÃ y cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘, vÃ  nÃ³ thá»±c sá»± tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c tá»‘i Æ°u hÃ³a
tá»•n tháº¥t khuáº¿ch tÃ¡n nhÆ° tá»•n tháº¥t Score Distillation Sampling (SDS) [PJBM22].

Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  chÆ°ng cáº¥t hÃ m Ä‘iá»ƒm sá»‘ Ä‘Ã£ há»c tá»« U-Net Stable Diffusion vÃ o KOSMOS-G.
QuÃ¡ trÃ¬nh nÃ y cho phÃ©p KOSMOS-G mÃ£ hÃ³a cÃ¡c Ä‘áº·c trÆ°ng hÃ¬nh áº£nh thÃ nh cÃ¡c embedding mÃ  mÃ´ hÃ¬nh Stable Diffusion
cÃ³ thá»ƒ hiá»ƒu Ä‘á»ƒ táº¡o hÃ¬nh áº£nh theo chá»§ Ä‘á». Vá» báº£n cháº¥t, cÃ¡ch tiáº¿p cáº­n nÃ y giá»‘ng nhÆ° viá»‡c tiá»n huáº¥n luyá»‡n
má»™t mÃ´ hÃ¬nh textual inversion [GAA+22] tá»•ng quÃ¡t, vá»›i táº¥t cáº£ cÃ¡c Ä‘iá»u kiá»‡n cÃ³ thá»ƒ há»c Ä‘Æ°á»£c báº±ng cÃ¡ch tÃ¬m kiáº¿m mÃ´ hÃ¬nh.

Xem xÃ©t mÃ´ hÃ¬nh KOSMOS-G, Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  Ï•, nháº­n má»™t Ä‘áº§u vÃ o x vÃ  táº¡o ra má»™t Ä‘áº§u ra
C=Ï•(x). CÃ¹ng vá»›i Ä‘Ã³, chÃºng tÃ´i cÃ³ Diffusion U-Net, Ä‘Æ°á»£c biá»ƒu diá»…n lÃ  Î¸. Trong quÃ¡ trÃ¬nh cá»§a chÃºng tÃ´i, chÃºng tÃ´i
tá»‘i Æ°u hÃ³a mÃ´ hÃ¬nh KOSMOS-G Ï• sá»­ dá»¥ng tá»•n tháº¥t khuáº¿ch tÃ¡n, trong khi giá»¯ cÃ¡c tham sá»‘ cá»§a
Diffusion U-Net Î¸ Ä‘Ã´ng láº¡nh. Tá»•n tháº¥t khuáº¿ch tÃ¡n Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° sau:

Ldiff(Ï•) = Ez0,Ïµâˆ¼N(0,1),t[w(t)â€–ÏµÎ¸(zt;C,t)âˆ’Ïµâ€–Â²]   (8)

Xem xÃ©t gradient cá»§a Ldiff:
âˆ‡Ï†Ldiff(Ï•) = Ez0,Ïµâˆ¼N(0,1),t[
w(t)(ÏµÎ¸(zt;C,t)âˆ’Ïµ)
|{z}
Nhiá»…u DÆ°
âˆ‚ÏµÏ†(zt;C,t)/âˆ‚C
|{z}
Jacobian U-Net
âˆ‚C/âˆ‚Ï•
|{z}
Jacobian KOSMOS-G]   (9)

Theo cÃ¡ch tiáº¿p cáº­n trong Dreamfusion [PJBM22], chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ¡n giáº£n hÃ³a phÆ°Æ¡ng trÃ¬nh nÃ y báº±ng cÃ¡ch bá» qua má»™t sá»‘
thuáº­t ngá»¯, dáº«n Ä‘áº¿n tá»•n tháº¥t SDS cho KOSMOS-G:
âˆ‡Ï†LSDS(Ï•) = Ez0,Ïµâˆ¼N(0,1),t[w(t)(ÏµÎ¸(zt;C,t)âˆ’Ïµ)âˆ‚C/âˆ‚Ï•]   (10)

NhÆ° Ä‘Ã£ Ä‘Æ°á»£c thiáº¿t láº­p trong Dreamfusion [PJBM22], viá»‡c tá»‘i Æ°u hÃ³a tá»•n tháº¥t SDS thá»±c sá»± tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i
viá»‡c tá»‘i Æ°u hÃ³a tá»•n tháº¥t khuáº¿ch tÃ¡n khi U-Net Î¸ bá»‹ Ä‘Ã´ng láº¡nh. Tá»« gÃ³c Ä‘á»™ chÆ°ng cáº¥t Ä‘iá»ƒm sá»‘,
khi sá»­ dá»¥ng tá»•n tháº¥t khuáº¿ch tÃ¡n, KL divergence Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi cÃ¡c Ä‘iá»u kiá»‡n vÃ  hÃ m Ä‘iá»ƒm sá»‘ Ä‘Ã£ há»c trÆ°á»›c
Ä‘Æ°á»£c tá»‘i thiá»ƒu hÃ³a tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»ƒ chÆ°ng cáº¥t máº­t Ä‘á»™ xÃ¡c suáº¥t Ä‘Ã£ há»c trong tá»•ng há»£p hÃ¬nh áº£nh cÃ³ Ä‘iá»u kiá»‡n [DHP+23, Luo22]:
minÏ† LDiff(Ï•) = Ez0,t,C[DKL(q(ztâˆ’1|zt,z0)â€–pÎ¸(ztâˆ’1|zt;C))]   (11)

--- TRANG 16 ---
Má»™t bá»©c áº£nh cá»§a má»™t con chÃ³trÃªn bÃ£i biá»ƒn, Ä‘eo kÃ­nh mÃ¡t

Má»™t bá»©c tranh sÆ¡n dáº§u chÃ¢n dung cá»§a má»™t con chÃ³                    trong bá»™ Ä‘á»“ cá»§a                    , theo phong cÃ¡ch cá»§a                     ,chi tiáº¿t cao, kiá»‡t tÃ¡c

Má»™t bá»©c selfie,                        Ä‘eo kÃ­nh mÃ¡t                    , Ä‘á»©ng trÆ°á»›c                    , chi tiáº¿t cao, cháº¥t lÆ°á»£ng tá»‘t nháº¥t

Má»™t bá»©c hoáº¡t hÃ¬nh cá»§a theirondman Ä‘á»©ng trÆ°á»›c má»™t chiáº¿c xe hÆ¡i

trÃªn bÃ£i biá»ƒn, theo phong cÃ¡ch cá»§a, kiá»‡t tÃ¡c

HÃ¬nh 9: CÃ¡c vÃ­ dá»¥ bá»• sung dÆ°á»›i tÃ¬nh huá»‘ng Ä‘an xen hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘a áº£nh thÃ¡ch thá»©c. CÃ¡c
trÆ°á»ng há»£p nÃ y cho tháº¥y ráº±ng vá»›i KOSMOS-G, ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ nháº¯c Stable Diffusion [RBL+22] báº±ng cÃ¡ch tiáº¿p cáº­n táº¥t cáº£
Ä‘áº§u vÃ o hÃ¬nh áº£nh nhÆ° má»™t "ngÃ´n ngá»¯ ngoáº¡i lai".

D CÃ¡c VÃ­ dá»¥ Bá»• sung

Trong HÃ¬nh 9, chÃºng tÃ´i trÃ¬nh bÃ y cÃ¡c trÆ°á»ng há»£p vá»›i cÃ¡c tÃ¬nh huá»‘ng Ä‘an xen hÃ¬nh áº£nh (3 Ä‘áº¿n 4) vÃ  vÄƒn báº£n Ä‘a dáº¡ng vÃ  phá»©c táº¡p hÆ¡n. CÃ¡c vÃ­ dá»¥ nÃ y chá»©ng minh hiá»‡u suáº¥t máº¡nh máº½ cá»§a KOSMOS-G trong viá»‡c xá»­ lÃ½ nhá»¯ng
trÆ°á»ng há»£p thÃ¡ch thá»©c nÃ y.
