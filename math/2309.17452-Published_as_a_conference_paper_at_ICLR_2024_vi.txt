# 2309.17452.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/math/2309.17452.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 1127603 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
TORA: Má»˜T TÃC Tá»¬ Láº¬P LUáº¬N TÃCH Há»¢P CÃ”NG Cá»¤
CHO VIá»†C GIáº¢I QUYáº¾T BÃ€I TOÃN TOÃN Há»ŒC
Zhibin Gou1,2âˆ—, Zhihong Shao1,2âˆ—, Yeyun Gong2â€ , Yelong Shen3
Yujiu Yang1â€ , Minlie Huang1â€ , Nan Duan2, Weizhu Chen3
1Äáº¡i há»c Thanh Hoa 2Microsoft Research 3Microsoft Azure AI
{gzb22,szh19}@mails.tsinghua.edu.cn
{yegong,yeshe,nanduan,wzchen}@microsoft.com
TÃ“M Táº®T
CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c tiáº¿n bá»™ Ä‘Ã¡ng ká»ƒ trong nhiá»u tÃ¡c vá»¥ ngÃ´n ngá»¯ khÃ¡c nhau,
nhÆ°ng chÃºng váº«n gáº·p khÃ³ khÄƒn vá»›i toÃ¡n há»c phá»©c táº¡p. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t TORA,
má»™t loáº¡t cÃ¡c TÃ¡c tá»­ Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n toÃ¡n há»c
thÃ¡ch thá»©c báº±ng cÃ¡ch tÃ­ch há»£p liá»n máº¡ch láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vá»›i viá»‡c sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥
bÃªn ngoÃ i (vÃ­ dá»¥: thÆ° viá»‡n tÃ­nh toÃ¡n vÃ  bá»™ giáº£i quyáº¿t kÃ½ hiá»‡u), tá»« Ä‘Ã³ káº¿t há»£p kháº£ nÄƒng phÃ¢n tÃ­ch
cá»§a ngÃ´n ngá»¯ vÃ  hiá»‡u quáº£ tÃ­nh toÃ¡n cá»§a cÃ´ng cá»¥. Äá»ƒ huáº¥n luyá»‡n TORA, chÃºng tÃ´i tuyá»ƒn chá»n cÃ¡c
quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c trÃªn cÃ¡c táº­p dá»¯ liá»‡u toÃ¡n há»c, Ã¡p dá»¥ng há»c táº­p mÃ´ phá»ng trÃªn
cÃ¡c chÃº thÃ­ch, vÃ  Ä‘á» xuáº¥t Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra Ä‘á»ƒ tinh chá»‰nh thÃªm hÃ nh vi láº­p luáº­n cá»§a mÃ´
hÃ¬nh. Káº¿t quáº£ lÃ , cÃ¡c mÃ´ hÃ¬nh TORA vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ trÃªn 10 táº­p
dá»¯ liá»‡u láº­p luáº­n toÃ¡n há»c á»Ÿ táº¥t cáº£ cÃ¡c quy mÃ´ vá»›i cáº£i thiá»‡n tuyá»‡t Ä‘á»‘i 13%-19% trung bÃ¬nh. ÄÃ¡ng
chÃº Ã½, TORA-7B Ä‘áº¡t 44,6% trÃªn táº­p dá»¯ liá»‡u cáº¥p Ä‘á»™ thi Ä‘áº¥u MATH, vÆ°á»£t qua mÃ´ hÃ¬nh nguá»“n má»Ÿ
tá»‘t nháº¥t WizardMath-70B 22% tuyá»‡t Ä‘á»‘i. TORA-CODE-34B cÅ©ng lÃ  mÃ´ hÃ¬nh nguá»“n má»Ÿ Ä‘áº§u tiÃªn
Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c vÆ°á»£t quÃ¡ 50% trÃªn MATH, vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i káº¿t quáº£ CoT cá»§a GPT-4,
vÃ  cáº¡nh tranh vá»›i GPT-4 giáº£i quyáº¿t bÃ i toÃ¡n báº±ng chÆ°Æ¡ng trÃ¬nh. NgoÃ i ra, chÃºng tÃ´i thá»±c hiá»‡n phÃ¢n
tÃ­ch toÃ n diá»‡n vá» lá»£i Ã­ch vÃ  thÃ¡ch thá»©c cÃ²n láº¡i cá»§a tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ cho láº­p luáº­n toÃ¡n há»c, cung cáº¥p
nhá»¯ng hiá»ƒu biáº¿t cÃ³ giÃ¡ trá»‹ cho nghiÃªn cá»©u tÆ°Æ¡ng lai1.
7B 13B 70B0102030405060Äá»™ chÃ­nh xÃ¡c (%)
4.16.314.4
7.29.214.9
10.714.022.744.648.149.7MATH
7B 13B 70B020406080100Äá»™ chÃ­nh xÃ¡c (%)
13.324.357.8
41.351.155.2 54.963.981.6
72.675.884.3GSM8kGPT-4-Code
GPT-4ChatGPT-Code
ChatGPTBase
SFTWizardMath
ToRA
HÃ¬nh 1: So sÃ¡nh TORA vá»›i cÃ¡c baseline trÃªn cÃ¡c mÃ´ hÃ¬nh cÆ¡ sá»Ÿ LLaMA-2 tá»« 7B Ä‘áº¿n 70B. CÃ¡c mÃ´ hÃ¬nh TORA
thá»ƒ hiá»‡n nhá»¯ng cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n nháº¥t trÆ°á»›c Ä‘Ã³ á»Ÿ táº¥t cáº£ cÃ¡c quy mÃ´.
Äáº·c biá»‡t, TORA-70B vÆ°á»£t trá»™i rÃµ rá»‡t so vá»›i káº¿t quáº£ CoT cá»§a GPT-4 trÃªn MATH vÃ  Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£
tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i GPT-4 giáº£i quyáº¿t bÃ i toÃ¡n báº±ng code.
âˆ—ÄÃ³ng gÃ³p báº±ng nhau. Xem pháº§n ÄÃ³ng gÃ³p Ä‘á»ƒ biáº¿t chi tiáº¿t. CÃ´ng viá»‡c Ä‘Æ°á»£c thá»±c hiá»‡n trong thá»i gian thá»±c táº­p táº¡i Microsoft.
â€ TÃ¡c giáº£ liÃªn há»‡.
1Code vÃ  mÃ´ hÃ¬nh cÃ³ sáºµn táº¡i https://github.com/microsoft/ToRA .
1arXiv:2309.17452v4 [cs.CL] 21 Feb 2024

--- TRANG 2 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
BÃ i toÃ¡n: Giáº£ sá»­ tá»•ng bÃ¬nh phÆ°Æ¡ng cá»§a hai sá»‘ phá»©c ğ‘¥ vÃ  ğ‘¦ lÃ  7 vÃ  tá»•ng láº­p phÆ°Æ¡ng cá»§a chÃºng lÃ  10. Liá»‡t kÃª táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cÃ³ thá»ƒ cá»§a ğ‘¥+ğ‘¦, cÃ¡ch nhau bá»Ÿi dáº¥u pháº©y. HÃ£y sá»­ dá»¥ng `Sympy` Ä‘á»ƒ tÃ­nh toÃ¡n vÃ  in táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cÃ³ thá»ƒ cá»§a ğ‘¥+ğ‘¦,
Loáº¡i bá» trÃ¹ng láº·p, cÃ¡c giÃ¡ trá»‹ cÃ³ thá»ƒ cá»§a ğ‘¥+ğ‘¦ lÃ  \boxed{-5,1,4}. ChÃºng ta cÃ³ ğ‘¥!+ğ‘¦!=7 vÃ  ğ‘¥"+ğ‘¦"=10. ChÃºng ta cÃ³ thá»ƒ phÃ¢n tÃ­ch ğ‘¥"+ğ‘¦" Ä‘á»ƒ Ä‘Æ°á»£c ğ‘¥+ğ‘¦(ğ‘¥!âˆ’ğ‘¥ğ‘¦+ğ‘¦!). Do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ viáº¿t 10=ğ‘¥+ğ‘¦7. Suy ra ğ‘¥+ğ‘¦ pháº£i chia háº¿t cho 10. CÃ¡c kháº£ nÄƒng duy nháº¥t lÃ  ğ‘¥+ğ‘¦ lÃ  1,2,5 hoáº·c 10. âœ˜âœ“ğ‘Ÿ!ğ‘"ğ‘Ÿ"ğ‘œ" (a) Dá»±a trÃªn láº­p luáº­n (b) Dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh (c) Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ (Äá»‹nh dáº¡ng Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi ToRA) import math def solution(): x = symbols('x'), y = symbols('y') x**2 + y**2 = 7 x**3 + y**3 = 10 x = (-1 + math.sqrt(17)) / 2 y = (-1 -math.sqrt(17)) / 2 # Láº¥y táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ cÃ³ thá»ƒ cá»§a x+y result = [x + y, -x -y] from sympy import symbols, Eq, solve, simplify def possible_values(): x, y = symbols('x y') eq1 = Eq(x**2 + y**2, 7) eq2 = Eq(x**3 + y**3, 10) solutions = solve((eq1,eq2), (x, y)) sums = [simplify(sol[0] + sol[1]) for sol in solutions] return sums print(possible_values()) >>> [-5, -5, 1, 1, 4, 4] >>> SyntaxError: cannot assign to expression. âœ˜ Láº­p luáº­n Äáº§u ra Láº­p luáº­n ChÆ°Æ¡ng trÃ¬nh

HÃ¬nh 2: VÃ­ dá»¥ vá» ba Ä‘á»‹nh dáº¡ng láº­p luáº­n cho láº­p luáº­n toÃ¡n há»c: (a) PhÆ°Æ¡ng phÃ¡p dá»±a trÃªn láº­p luáº­n (vÃ­ dá»¥: gá»£i Ã½ CoT) táº¡o ra cÃ¡c láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn tá»«ng bÆ°á»›c, (b) PhÆ°Æ¡ng phÃ¡p dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh (vÃ­ dá»¥: gá»£i Ã½ PAL) giáº£i quyáº¿t cÃ¡c tÃ¡c vá»¥ vá»›i tá»•ng há»£p chÆ°Æ¡ng trÃ¬nh, vÃ  (c) Ä‘á»‹nh dáº¡ng Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i xen káº½ cÃ¡c láº­p luáº­n vá»›i viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh. Äá»ƒ ngáº¯n gá»n, chÃºng tÃ´i trÃ¬nh bÃ y má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n vá» tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ má»™t vÃ²ng, trong Ä‘Ã³ mÃ´ hÃ¬nh táº¡o ra láº­p luáº­n r1 Ä‘á»ƒ phÃ¢n tÃ­ch, viáº¿t chÆ°Æ¡ng trÃ¬nh a1 Ä‘á»ƒ gá»i má»™t bá»™ giáº£i bÃªn ngoÃ i, thu Ä‘Æ°á»£c Ä‘áº§u ra thá»±c thi o1, vÃ  sau Ä‘Ã³ táº¡o ra láº­p luáº­n r2 Ä‘á»ƒ hoÃ n thiá»‡n cÃ¢u tráº£ lá»i.

1 GIá»šI THIá»†U
CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLMs), nhÆ° GPT-4 (OpenAI, 2023) vÃ  PaLM-2 (Anil et al., 2023), Ä‘Ã£ chá»©ng minh tiáº¿n bá»™ Ä‘Ã¡ng ká»ƒ trong má»™t loáº¡t cÃ¡c tÃ¡c vá»¥ ngÃ´n ngá»¯, Ä‘áº·c biá»‡t lÃ  trong thÃ¡ch thá»©c lÃ¢u dÃ i vá» láº­p luáº­n toÃ¡n há»c (Feigenbaum et al., 1963; Hosseini et al., 2014). Tuy nhiÃªn, cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ, nhÆ° LLaMA-2 (Touvron et al., 2023a;b) vÃ  Falcon (Penedo et al., 2023), váº«n gáº·p khÃ³ khÄƒn vá»›i cÃ¡c tÃ¡c vá»¥ láº­p luáº­n toÃ¡n há»c nÃ¢ng cao.

CÃ¡c cÃ´ng trÃ¬nh hiá»‡n táº¡i cáº£i thiá»‡n hiá»‡u suáº¥t toÃ¡n há»c cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ báº±ng cÃ¡ch sá»­ dá»¥ng láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn tá»«ng bÆ°á»›c (Wei et al., 2022) nhÆ° minh há»a trong HÃ¬nh 2 (a), hoáº·c báº±ng cÃ¡ch tá»•ng há»£p vÃ  thá»±c thi cÃ¡c chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ thu Ä‘Æ°á»£c cÃ¢u tráº£ lá»i (Gao et al., 2022; Chen et al., 2022), nhÆ° mÃ´ táº£ trong HÃ¬nh 2 (b). Cáº£ hai phÆ°Æ¡ng phÃ¡p Ä‘á»u thá»ƒ hiá»‡n nhá»¯ng Æ°u Ä‘iá»ƒm bá»• sung. NgÃ´n ngá»¯ tá»± nhiÃªn phÃ¹ há»£p cho phÃ¢n tÃ­ch ngá»¯ nghÄ©a, láº­p káº¿ hoáº¡ch, vÃ  láº­p luáº­n trá»«u tÆ°á»£ng (vÃ­ dá»¥: láº­p luáº­n thÃ´ng thÆ°á»ng), nhÆ°ng gáº·p khÃ³ khÄƒn vá»›i tÃ­nh toÃ¡n chÃ­nh xÃ¡c, thao tÃ¡c kÃ½ hiá»‡u, vÃ  xá»­ lÃ½ thuáº­t toÃ¡n. NgÆ°á»£c láº¡i, chÆ°Æ¡ng trÃ¬nh xuáº¥t sáº¯c trong cÃ¡c thao tÃ¡c nghiÃªm ngáº·t, vÃ  cÃ³ thá»ƒ á»§y thÃ¡c cÃ¡c tÃ­nh toÃ¡n phá»©c táº¡p cho cÃ¡c cÃ´ng cá»¥ chuyÃªn biá»‡t nhÆ° bá»™ giáº£i phÆ°Æ¡ng trÃ¬nh.

Äá»ƒ táº­n dá»¥ng lá»£i Ã­ch cá»§a cáº£ láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vÃ  sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh, chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ nhÆ° LLaMA-2 Ä‘á»ƒ láº­p luáº­n theo cÃ¡ch mÃ  láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn Ä‘Æ°á»£c xen káº½ vá»›i viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh má»™t cÃ¡ch hiá»‡p Ä‘á»“ng (nhÆ° mÃ´ táº£ trong HÃ¬nh 2 (c)), tá»« Ä‘Ã³ giáº£m Ä‘Ã¡ng ká»ƒ khoáº£ng cÃ¡ch vá»›i cÃ¡c mÃ´ hÃ¬nh nguá»“n Ä‘Ã³ng nhÆ° GPT-4 trong láº­p luáº­n toÃ¡n há»c. Cá»¥ thá»ƒ, chÃºng tÃ´i trÆ°á»›c tiÃªn thiáº¿t káº¿ Ä‘á»‹nh dáº¡ng xen káº½ cá»§a láº­p luáº­n, tuyá»ƒn chá»n cÃ¡c quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c tÆ°Æ¡ng á»©ng cho cÃ¡c bÃ i toÃ¡n toÃ¡n há»c tá»« táº­p dá»¯ liá»‡u phá»• biáº¿n GSM8k (Cobbe et al., 2021) vÃ  MATH (Hendrycks et al., 2021), vÃ  sau Ä‘Ã³ Ã¡p dá»¥ng há»c táº­p mÃ´ phá»ng trÃªn cÃ¡c chÃº thÃ­ch cháº¥t lÆ°á»£ng cao, dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»‘t hÆ¡n so vá»›i báº¥t ká»³ mÃ´ hÃ¬nh nguá»“n má»Ÿ hiá»‡n táº¡i nÃ o. HÆ¡n ná»¯a, vÃ¬ dá»¯ liá»‡u Ä‘Æ°á»£c tuyá»ƒn chá»n cÃ²n xa má»›i cáº¡n kiá»‡t táº¥t cáº£ cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ cho má»™t bÃ i toÃ¡n, viá»‡c chá»‰ dá»±a vÃ o há»c táº­p mÃ´ phá»ng háº¡n cháº¿ khÃ´ng gian Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh, cáº£n trá»Ÿ tÃ­nh linh hoáº¡t trong viá»‡c khÃ¡m phÃ¡ cÃ¡c quá»¹ Ä‘áº¡o há»£p lÃ½ trong quÃ¡ trÃ¬nh kiá»ƒm tra. Äá»ƒ cáº£i thiá»‡n tÃ­nh Ä‘a dáº¡ng cá»§a cÃ¡c bÆ°á»›c láº­p luáº­n há»£p lÃ½ vÃ  giáº£m thiá»ƒu hÃ nh vi sá»­ dá»¥ng cÃ´ng cá»¥ khÃ´ng phÃ¹ há»£p, chÃºng tÃ´i Ã¡p dá»¥ng Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra, bá»• sung huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh trÃªn cáº£ cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ tá»± láº¥y máº«u vÃ  cÃ¡c quá»¹ Ä‘áº¡o khÃ´ng há»£p lá»‡ Ä‘Ã£ Ä‘Æ°á»£c sá»­a chá»¯a bá»Ÿi má»™t mÃ´ hÃ¬nh giÃ¡o viÃªn (vÃ­ dá»¥: mÃ´ hÃ¬nh 34B cÃ³ thá»ƒ lÃ m giÃ¡o viÃªn

--- TRANG 3 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Láº­p luáº­n Äáº§u ra
â‘¡Äá»‹nh hÃ¬nh KhÃ´ng gian Äáº§u ra
Láº¥y máº«u Äáº§u ra Sá»­a chá»¯a GiÃ¡o viÃªn
Quá»¹ Ä‘áº¡o Há»£p lá»‡
LLM ToRA-Corpus Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ Quá»¹ Ä‘áº¡o Há»£p lá»‡ M
Láº­p luáº­n Äáº§u ra Tinh chá»‰nh M
BÃ i toÃ¡n BÃ i toÃ¡n
Láº­p luáº­n Äáº§u ra M' Tinh chá»‰nh ToRA
âœ“âœ˜âœ˜âœ“âœ“âœ“
â€¦â‘ Há»c táº­p MÃ´ phá»ng

HÃ¬nh 3: Huáº¥n luyá»‡n TORA bao gá»“m hai bÆ°á»›c. â‘ Há»c táº­p MÃ´ phá»ng: Gá»£i Ã½ cho cÃ¡c LLM nhÆ° GPT-4 Ä‘á»ƒ táº¡o ra cÃ¡c quá»¹ Ä‘áº¡o Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ (TORA-CORPUS) vÃ  sá»­ dá»¥ng bá»™ dá»¯ liá»‡u nÃ y Ä‘á»ƒ tinh chá»‰nh má»™t mÃ´ hÃ¬nh M; â‘¡Äá»‹nh hÃ¬nh KhÃ´ng gian Äáº§u ra: Láº¥y máº«u cÃ¡c quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ Ä‘a dáº¡ng vá»›i M, giá»¯ láº¡i nhá»¯ng quá»¹ Ä‘áº¡o há»£p lá»‡, sá»­a chá»¯a nhá»¯ng quá»¹ Ä‘áº¡o khÃ´ng há»£p lá»‡ báº±ng má»™t mÃ´ hÃ¬nh giÃ¡o viÃªn Mâ€², vÃ  huáº¥n luyá»‡n láº¡i M trÃªn táº­p há»£p cá»§a cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ Ä‘Æ°á»£c láº¥y máº«u, cÃ¡c quá»¹ Ä‘áº¡o Ä‘Ã£ sá»­a chá»¯a, vÃ  TORA-CORPUS ban Ä‘áº§u Ä‘á»ƒ thu Ä‘Æ°á»£c TORA.

cho má»™t mÃ´ hÃ¬nh 7B). Äá»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ láº­p luáº­n, cho phÃ©p cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c vÆ°á»£t quÃ¡ 50% trÃªn táº­p dá»¯ liá»‡u MATH cáº¥p Ä‘á»™ thi Ä‘áº¥u láº§n Ä‘áº§u tiÃªn.

ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ bá»™ TÃ¡c tá»­ Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ (TORA) káº¿t quáº£ tá»« 7B Ä‘áº¿n 70B trÃªn 10 táº­p dá»¯ liá»‡u láº­p luáº­n toÃ¡n há»c Ä‘a dáº¡ng. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 1, loáº¡t TORA vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ á»Ÿ táº¥t cáº£ cÃ¡c quy mÃ´. ÄÃ¡ng chÃº Ã½, trÃªn táº­p dá»¯ liá»‡u MATH cáº¥p Ä‘á»™ thi Ä‘áº¥u, TORA-7B vÆ°á»£t trá»™i so vá»›i WizardMath-70B SoTA trÆ°á»›c Ä‘Ã³ (Luo et al., 2023) 22% tuyá»‡t Ä‘á»‘i. TORA-CODE-34B Ä‘Ã¡nh báº¡i káº¿t quáº£ CoT cá»§a GPT-4 (Bubeck et al., 2023) 8,3% tuyá»‡t Ä‘á»‘i (50,8% so vá»›i 42,5%), vÃ  cáº¡nh tranh vá»›i GPT-4 giáº£i quyáº¿t bÃ i toÃ¡n báº±ng code (GPT-4-Code, 51,8%). NgoÃ i ra, chÃºng tÃ´i phÃ¢n tÃ­ch nhá»¯ng lá»£i Ã­ch vÃ  thÃ¡ch thá»©c cÃ²n láº¡i cá»§a tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ cho láº­p luáº­n toÃ¡n há»c, cung cáº¥p nhá»¯ng hiá»ƒu biáº¿t cÃ³ giÃ¡ trá»‹ cho cÃ´ng viá»‡c tÆ°Æ¡ng lai.

2 TORA: TÃC Tá»¬ TÃCH Há»¢P CÃ”NG Cá»¤ CHO Láº¬P LUáº¬N TOÃN Há»ŒC

2.1 Tá»”NG QUAN
Loáº¡t TORA giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n toÃ¡n há»c thÃ¡ch thá»©c báº±ng cÃ¡ch táº­n dá»¥ng cáº£ láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vÃ  sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 2 (c), vá»›i má»™t bÃ i toÃ¡n toÃ¡n há»c q, TORA láº­p luáº­n báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn, táº¡o ra r1. Khi Ä‘áº¡t Ä‘áº¿n má»™t Ä‘iá»ƒm mÃ  viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh phÃ¹ há»£p hÆ¡n cho tÃ¡c vá»¥ tiáº¿p theo, vÃ­ dá»¥: giáº£i phÆ°Æ¡ng trÃ¬nh, TORA táº¡o ra má»™t chÆ°Æ¡ng trÃ¬nh a1 Ä‘á»ƒ sá»­ dá»¥ng cÃ´ng cá»¥ theo hÆ°á»›ng dáº«n ngÃ´n ngá»¯ tá»± nhiÃªn r1. Äáº§u ra thá»±c thi o1 sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o TORA Ä‘á»ƒ xá»­ lÃ½ tiáº¿p theo bao gá»“m Ä‘iá»u chá»‰nh sá»­ dá»¥ng cÃ´ng cá»¥, giáº£i quyáº¿t cÃ¡c tÃ¡c vá»¥ con, hoáº·c hoÃ n thiá»‡n cÃ¢u tráº£ lá»i. ChÃºng tÃ´i láº·p láº¡i quÃ¡ trÃ¬nh cho Ä‘áº¿n khi mÃ´ hÃ¬nh Ä‘áº·t cÃ¢u tráº£ lá»i cá»§a nÃ³ trong "\boxed{}". Quá»¹ Ä‘áº¡o káº¿t quáº£ Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  Ï„=r1a1o1...rnâˆ’1anâˆ’1onâˆ’1rn, trong Ä‘Ã³ rn chá»©a cÃ¢u tráº£ lá»i.

HÃ¬nh 3 trÃ¬nh bÃ y quy trÃ¬nh huáº¥n luyá»‡n cá»§a TORA. ChÃºng tÃ´i trÆ°á»›c tiÃªn thu tháº­p cÃ¡c quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c trÃªn cÃ¡c táº­p dá»¯ liá»‡u toÃ¡n há»c phá»• biáº¿n. Sau Ä‘Ã³ chÃºng tÃ´i Ã¡p dá»¥ng há»c táº­p mÃ´ phá»ng trÃªn cÃ¡c chÃº thÃ­ch káº¿t quáº£, cÅ©ng nhÆ° Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra Ä‘á»ƒ tinh chá»‰nh thÃªm hÃ nh vi láº­p luáº­n cá»§a mÃ´ hÃ¬nh.

2.2 THU THáº¬P CÃC QUá»¸ Äáº O Sá»¬ Dá»¤NG CÃ”NG Cá»¤ TÆ¯Æ NG TÃC
CÃ¡c táº­p dá»¯ liá»‡u láº­p luáº­n toÃ¡n há»c hiá»‡n táº¡i chá»§ yáº¿u chá»©a cÃ¡c chÃº thÃ­ch báº±ng ngÃ´n ngá»¯ tá»± nhiÃªn hoáº·c code, Ä‘áº·t ra thÃ¡ch thá»©c trong viá»‡c huáº¥n luyá»‡n cÃ¡c tÃ¡c tá»­ tÃ­ch há»£p cÃ´ng cá»¥ do thiáº¿u cÃ¡c chÃº thÃ­ch sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i sá»­ dá»¥ng GPT-4 Ä‘á»ƒ tá»•ng há»£p cÃ¡c quá»¹ Ä‘áº¡o cháº¥t lÆ°á»£ng cao trÃªn táº­p huáº¥n luyá»‡n GSM8k vÃ  MATH. ChÃºng tÃ´i chá»n GSM8k vÃ  MATH vÃ¬ chÃºng thá»ƒ hiá»‡n cÃ¡c máº«u láº­p luáº­n Ä‘a dáº¡ng, bao trÃ¹m nhiá»u lÄ©nh vá»±c vÃ  má»©c Ä‘á»™ khÃ³ khÃ¡c nhau.

--- TRANG 4 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Thuáº­t toÃ¡n 1 Suy luáº­n cá»§a Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥
YÃªu cáº§u: bÃ i toÃ¡n q, mÃ´ hÃ¬nh G, gá»£i Ã½ p, cÃ´ng cá»¥ bÃªn ngoÃ i E, Ä‘iá»u kiá»‡n dá»«ng Stop(Â·), sá»‘ vÃ²ng láº·p tá»‘i Ä‘a n
1:Ï„0â†"" â–·Khá»Ÿi táº¡o Quá»¹ Ä‘áº¡o
2:for iâ†1 to n do
3: riâˆ¼PG(Â·|pâŠ•qâŠ•Ï„iâˆ’1) â–·Táº¡o Láº­p luáº­n (Eq. 1)
4: if Stop(ri) then â–·TiÃªu chÃ­ Dá»«ng
5: return Ï„iâˆ’1âŠ•ri
6: end if
7: aiâˆ¼PG(Â·|pâŠ•qâŠ•Ï„iâˆ’1âŠ•ri) â–·Táº¡o ChÆ°Æ¡ng trÃ¬nh (Eq. 2)
8: oiâ† E(ai) â–·Thá»±c thi CÃ´ng cá»¥
9: Ï„iâ†Ï„iâˆ’1âŠ•riâŠ•aiâŠ•oi â–·Cáº­p nháº­t Quá»¹ Ä‘áº¡o (Eq. 3)
10:end for
11:return Ï„n

Tuyá»ƒn chá»n Gá»£i Ã½ ChÃºng tÃ´i soáº¡n tháº£o cÃ¡c hÆ°á»›ng dáº«n cÃ¹ng vá»›i cÃ¡c vÃ­ dá»¥ few-shot Ä‘a dáº¡ng, sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng xen káº½ nhÆ° mÃ´ táº£ trong HÃ¬nh 2 (c). CÃ¡c vÃ­ dá»¥ nÃ y thá»ƒ hiá»‡n cÃ¡c quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c, káº¿t há»£p tÃªn biáº¿n mÃ´ táº£ vÃ  Ä‘áº§u ra chÆ°Æ¡ng trÃ¬nh káº¿t há»£p. Vui lÃ²ng tham kháº£o Phá»¥ lá»¥c E cho cÃ¡c gá»£i Ã½ Ä‘Æ°á»£c táº­p há»£p.

Quy trÃ¬nh Suy luáº­n ChÃºng tÃ´i theo Thuáº­t toÃ¡n 1 vÃ  cung cáº¥p GPT-4 (G) vá»›i gá»£i Ã½ p Ä‘Æ°á»£c soáº¡n tháº£o Ä‘á»ƒ táº¡o ra má»™t quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ Ï„ cho má»—i cÃ¢u há»i q tá»« táº­p huáº¥n luyá»‡n. Quá»¹ Ä‘áº¡o Ä‘Æ°á»£c khá»Ÿi táº¡o nhÆ° má»™t chuá»—i rá»—ng Ï„0, Ä‘á»‘i vá»›i má»—i vÃ²ng tÆ°Æ¡ng tÃ¡c i, chÃºng tÃ´i trÆ°á»›c tiÃªn táº¡o ra má»™t láº­p luáº­n:
riâˆ¼PG(Â·|pâŠ•qâŠ•Ï„iâˆ’1) (1)
trong Ä‘Ã³ âŠ• cÃ³ nghÄ©a lÃ  ná»‘i chuá»—i. Náº¿u ri bao gá»“m má»™t cÃ¢u tráº£ lá»i trong "\boxed{}" (tá»©c lÃ  Ä‘iá»u kiá»‡n dá»«ng Stop(ri)), chÃºng tÃ´i ngá»«ng táº¡o ra, ngÆ°á»£c láº¡i mÃ´ hÃ¬nh tiáº¿p tá»¥c viáº¿t má»™t chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng cÃ´ng cá»¥:
aiâˆ¼PG(Â·|pâŠ•qâŠ•Ï„iâˆ’1âŠ•ri) (2)
Theo Gou et al. (2023), náº¿u mÃ´ hÃ¬nh kÃ­ch hoáº¡t cÃ¡c tá»« dá»«ng thá»±c thi code nhÆ° " '''output ", chÃºng tÃ´i cung cáº¥p cho nÃ³ thÃ´ng Ä‘iá»‡p thá»±c thi tÆ°Æ¡ng á»©ng vÃ  Ä‘áº§u ra oi báº±ng cÃ¡ch gá»i cÃ´ng cá»¥ vá»›i oiâ† E(ai), táº¡o Ä‘iá»u kiá»‡n thuáº­n lá»£i cho viá»‡c táº¡o ra cÃ¡c bÆ°á»›c tiáº¿p theo. Sau Ä‘Ã³, chÃºng tÃ´i cáº­p nháº­t quá»¹ Ä‘áº¡o báº±ng cÃ¡ch ná»‘i nÃ³ vá»›i láº­p luáº­n ri má»›i Ä‘Æ°á»£c táº¡o ra, chÆ°Æ¡ng trÃ¬nh ai, vÃ  Ä‘áº§u ra oi:
Ï„iâ†Ï„iâˆ’1âŠ•riâŠ•aiâŠ•oi (3)
ChÃºng tÃ´i láº·p láº¡i quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c trÃªn cho Ä‘áº¿n khi chÃºng tÃ´i Ä‘áº¡t Ä‘áº¿n sá»‘ vÃ²ng tá»‘i Ä‘a n.

Láº¥y máº«u Quá»¹ Ä‘áº¡o ChÃºng tÃ´i Ä‘áº·t n= 3 vÃ  thá»±c hiá»‡n suy luáº­n báº±ng GPT-4 vá»›i giáº£i mÃ£ tham lam, giá»¯ láº¡i cÃ¡c quá»¹ Ä‘áº¡o mang láº¡i cÃ¢u tráº£ lá»i Ä‘Ãºng. Äá»‘i vá»›i nhá»¯ng cÃ¢u há»i mÃ  GPT-4 tháº¥t báº¡i vá»›i giáº£i mÃ£ tham lam, chÃºng tÃ´i Ã¡p dá»¥ng láº¥y máº«u nucleus vá»›i kÃ­ch thÆ°á»›c máº«u 10 vÃ  giá»¯ láº¡i tá»‘i Ä‘a 4 quá»¹ Ä‘áº¡o há»£p lá»‡ má»—i cÃ¢u há»i. Cuá»‘i cÃ¹ng, chÃºng tÃ´i thÃ nh cÃ´ng chÃº thÃ­ch quá»¹ Ä‘áº¡o cho 98,2% cÃ¢u há»i GSM8k vÃ  83,1% cÃ¢u há»i MATH. Sau khi lá»c bá» cÃ¡c quá»¹ Ä‘áº¡o khÃ´ng há»£p lá»‡ vá»›i lá»—i sá»­ dá»¥ng cÃ´ng cá»¥ hoáº·c cÃ¢u tráº£ lá»i sai, chÃºng tÃ´i thu Ä‘Æ°á»£c 16k chÃº thÃ­ch táº¡o thÃ nh táº­p dá»¯ liá»‡u TORA-CORPUS. Báº£ng 1 so sÃ¡nh TORA-CORPUS vá»›i cÃ¡c táº­p dá»¯ liá»‡u láº­p luáº­n toÃ¡n há»c Ä‘Æ°á»£c Ä‘á» xuáº¥t gáº§n Ä‘Ã¢y, trong khi Báº£ng 6 trong Phá»¥ lá»¥c hiá»ƒn thá»‹ chi tiáº¿t Ä‘á»™ chÃ­nh xÃ¡c chÃº thÃ­ch MATH.

2.3 HUáº¤N LUYá»†N
Há»c táº­p MÃ´ phá»ng ChÃºng tÃ´i Ã¡p dá»¥ng há»c táº­p mÃ´ phá»ng trÃªn TORA-CORPUS báº±ng cÃ¡ch tá»‘i thiá»ƒu hÃ³a máº¥t mÃ¡t log-likelihood Ã¢m trÃªn quá»¹ Ä‘áº¡o Ï„ cÃ³ Ä‘iá»u kiá»‡n trÃªn bÃ i toÃ¡n q:
M= arg min
MX
q,Ï„nâˆ’1X
i=1âˆ’logPM(ri+1ai+1|q, r1...oi) (4)
trong Ä‘Ã³ M lÃ  mÃ´ hÃ¬nh káº¿t quáº£. Sau há»c táº­p mÃ´ phá»ng, chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ¡n giáº£n Ã¡p dá»¥ng cÃ¹ng quy trÃ¬nh trong Thuáº­t toÃ¡n 1 báº±ng cÃ¡ch Ä‘áº·t gá»£i Ã½ thÃ nh rá»—ng p="" Ä‘á»ƒ suy luáº­n. Há»c táº­p mÃ´ phá»ng dáº«n Ä‘áº¿n hiá»‡u suáº¥t láº­p luáº­n toÃ¡n há»c tiÃªn tiáº¿n nháº¥t máº·c dÃ¹ quy mÃ´ nhá» cá»§a TORA-CORPUS.

--- TRANG 5 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Báº£ng 1: So sÃ¡nh vá»›i cÃ¡c táº­p dá»¯ liá»‡u láº­p luáº­n toÃ¡n há»c, TORA-CORPUS káº¿t há»£p duy nháº¥t cÃ¡c láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vá»›i viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh. LÆ°u Ã½ ráº±ng TORA-CORPUS chá»‰ sá»­ dá»¥ng cÃ¡c cÃ¢u há»i tá»« táº­p huáº¥n luyá»‡n gá»‘c cá»§a MATH vÃ  GSM8k.
PhÆ°Æ¡ng phÃ¡p #ChÃº thÃ­ch CÃ´ng cá»¥ Xen káº½ LLM Sá»­ dá»¥ng Nguá»“n
RFT (Yuan et al., 2023) >100k âœ— âœ— LLaMA-2 GSM8k
Open-Platypus Lee et al. (2023) 25k âœ— âœ— GPT-4 11 táº­p dá»¯ liá»‡u vá»›i MATH
WizardMath (Luo et al., 2023) >96k âœ— âœ— ChatGPT MATH & GSM8k
Lila (Mishra et al., 2022) 134k âœ“(PoT) âœ— - 20 táº­p dá»¯ liá»‡u vá»›i MATH & GSM8k
MathInstruct (Yue et al., 2023) 260k âœ“(PoT) âœ— GPT-4 14 táº­p dá»¯ liá»‡u vá»›i MATH & GSM8k
TORA-CORPUS (cá»§a chÃºng tÃ´i) 16k âœ“ âœ“ GPT-4 MATH & GSM8k

Äá»‹nh hÃ¬nh KhÃ´ng gian Äáº§u ra Äá»‘i vá»›i má»—i cÃ¢u há»i, TORA-CORPUS chá»§ yáº¿u chá»‰ thá»ƒ hiá»‡n má»™t quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c há»£p lá»‡, Ä‘iá»u nÃ y cÃ³ thá»ƒ háº¡n cháº¿ khÃ´ng gian Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh, khiáº¿n nÃ³ khÃ´ng linh hoáº¡t trong viá»‡c khÃ¡m phÃ¡ cÃ¡c quá»¹ Ä‘áº¡o há»£p lÃ½ trong quÃ¡ trÃ¬nh kiá»ƒm tra. Do Ä‘Ã³ chÃºng tÃ´i Ä‘á» xuáº¥t Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra nháº±m khuyáº¿n khÃ­ch tÃ­nh Ä‘a dáº¡ng cá»§a cÃ¡c bÆ°á»›c láº­p luáº­n há»£p lÃ½ vÃ  giáº£m hÃ nh vi sá»­ dá»¥ng cÃ´ng cá»¥ khÃ´ng phÃ¹ há»£p.

Äá»ƒ khÃ¡m phÃ¡ cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ Ä‘a dáº¡ng, chÃºng tÃ´i Ã¡p dá»¥ng láº¥y máº«u nucleus cho cÃ¡c mÃ´ hÃ¬nh há»c táº­p mÃ´ phá»ng M Ä‘á»ƒ láº¥y máº«u 64 quá»¹ Ä‘áº¡o má»—i cÃ¢u há»i huáº¥n luyá»‡n q, theo quy trÃ¬nh suy luáº­n trong Pháº§n 2.2. ChÃºng tÃ´i giá»¯ láº¡i cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ vá»›i cÃ¢u tráº£ lá»i Ä‘Ãºng vÃ  khÃ´ng cÃ³ lá»—i sá»­ dá»¥ng cÃ´ng cá»¥. VÃ¬ nhiá»u máº«u lÃ  trÃ¹ng láº·p, Ä‘á»ƒ cáº£i thiá»‡n thÃªm tÃ­nh Ä‘a dáº¡ng vÃ  trong ná»— lá»±c sá»­a chá»¯a hÃ nh vi khÃ´ng phÃ¹ há»£p cá»§a mÃ´ hÃ¬nh, chÃºng tÃ´i tÃ¬m cÃ¡ch táº­n dá»¥ng cáº£ cÃ¡c quá»¹ Ä‘áº¡o khÃ´ng há»£p lá»‡. ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng cÃ¡c quá»¹ Ä‘áº¡o vá»›i cÃ¢u tráº£ lá»i sai chá»§ yáº¿u khÃ´ng chÃ­nh xÃ¡c á»Ÿ giá»¯a chá»«ng (Li et al., 2023), vÃ  pháº§n láº­p luáº­n trÆ°á»›c Ä‘Ã³ váº«n há»£p lÃ½; nÃ³i cÃ¡ch khÃ¡c, chÃºng tÃ´i cÃ³ thá»ƒ thu Ä‘Æ°á»£c cÃ¡c quá»¹ Ä‘áº¡o há»£p lá»‡ báº±ng cÃ¡ch sá»­a chá»¯a cÃ¡c pháº§n tiáº¿p theo. Cá»¥ thá»ƒ, má»™t quá»¹ Ä‘áº¡o sai eÏ„, khi Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng vÄƒn báº£n, cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° má»™t chuá»—i cÃ¡c dÃ²ng Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng dáº¥u xuá»‘ng dÃ²ng, tá»©c lÃ  eÏ„=l1...lm, trong Ä‘Ã³ m lÃ  tá»•ng sá»‘ dÃ²ng trong eÏ„. ChÃºng tÃ´i liá»‡t kÃª cÃ¡c pháº§n trÆ°á»›c cÃ³ thá»ƒ cá»§a cÃ¡c quá»¹ Ä‘áº¡o sai, tá»©c lÃ  eÏ„[:j] =l1...lj, vÃ  táº­n dá»¥ng má»™t mÃ´ hÃ¬nh giÃ¡o viÃªn Mâ€² Ä‘á»ƒ hoÃ n thÃ nh cÃ¡c bÆ°á»›c tiáº¿p theo vá»›i giáº£i mÃ£ tham lam: Ï„â†PMâ€²(Â·|qâŠ•eÏ„[:j]) trong Ä‘Ã³ chÃºng tÃ´i láº¡m dá»¥ng kÃ½ hiá»‡u PMâ€²(Â·) Ä‘á»ƒ biá»ƒu thá»‹ quÃ¡ trÃ¬nh sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c theo Pháº§n 2.2. Cuá»‘i cÃ¹ng, cÃ¡c quá»¹ Ä‘áº¡o Ä‘Ã£ sá»­a chá»¯a cÅ©ng nhÆ° cÃ¡c máº«u quá»¹ Ä‘áº¡o há»£p lá»‡ sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh, tá»« Ä‘Ã³ Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra.

Trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i, chÃºng tÃ´i luÃ´n sá»­ dá»¥ng CodeLLaMA-34B Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn TORA-CORPUS lÃ m mÃ´ hÃ¬nh giÃ¡o viÃªn, vÃ  Ã¡p dá»¥ng láº¥y máº«u vá»›i loáº¡t CodeLLaMA (tá»« 7B Ä‘áº¿n 34B, vá»›i há»c táº­p mÃ´ phá»ng). ChÃºng tÃ´i thu Ä‘Æ°á»£c tá»•ng cá»™ng 233k máº«u quá»¹ Ä‘áº¡o há»£p lá»‡ riÃªng biá»‡t vÃ  69k máº«u Ä‘Ã£ sá»­a chá»¯a. Tá»« táº­p dá»¯ liá»‡u káº¿t há»£p nÃ y, chÃºng tÃ´i chá»n ngáº«u nhiÃªn tá»‘i Ä‘a 4 quá»¹ Ä‘áº¡o má»—i bÃ i toÃ¡n GSM8k vÃ  MATH, há»£p nháº¥t chÃºng vá»›i TORA-CORPUS, vÃ  sau Ä‘Ã³ huáº¥n luyá»‡n táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh TORA trÃªn 69k chÃº thÃ­ch káº¿t quáº£.

3 THÃ NGHIá»†M

3.1 CHI TIáº¾T TRIá»‚N KHAI
ChÃºng tÃ´i tinh chá»‰nh loáº¡t LLaMA-2 (Touvron et al., 2023b) vÃ  CodeLLaMA (RoziÃ¨re et al., 2023) (tá»« 7B Ä‘áº¿n 70B) sá»­ dá»¥ng TORA-CORPUS vá»›i Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra, táº¡o ra loáº¡t TORA vÃ  TORA-CODE tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i sá»­ dá»¥ng tá»· lá»‡ há»c 2e-5 theo máº·c Ä‘á»‹nh trá»« viá»‡c chÃºng tÃ´i sá»­ dá»¥ng 1e-5 cho cÃ¡c mÃ´ hÃ¬nh 34B vÃ  70B. ChÃºng tÃ´i Ä‘áº·t kÃ­ch thÆ°á»›c batch toÃ n cá»¥c lÃ  128 vÃ  sá»­ dá»¥ng bá»™ láº­p lá»‹ch tuyáº¿n tÃ­nh vá»›i giai Ä‘oáº¡n khá»Ÿi Ä‘á»™ng 3% trong 3 epoch. ChÃºng tÃ´i huáº¥n luyá»‡n táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh vá»›i DeepSpeed ZeRO Stage3 (Rajbhandari et al., 2021) vÃ  Flash-Attention 2 (Dao, 2023). ChÃºng tÃ´i sá»­ dá»¥ng giáº£i mÃ£ tham lam cho táº¥t cáº£ káº¿t quáº£, vá»›i Ä‘á»™ dÃ i chuá»—i tá»‘i Ä‘a Ä‘Æ°á»£c Ä‘áº·t thÃ nh 2,048 vÃ  sá»‘ láº§n thá»±c thi cÃ´ng cá»¥ tá»‘i Ä‘a Ä‘Æ°á»£c Ä‘áº·t thÃ nh 3.

3.2 THIáº¾T Láº¬P ÄÃNH GIÃ
Táº­p dá»¯ liá»‡u ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh trÃªn GSM8k (Cobbe et al., 2021) vÃ  MATH (Hendrycks et al., 2021), cÃ¹ng vá»›i 8 táº­p dá»¯ liá»‡u ngoÃ i phÃ¢n phá»‘i, cá»¥ thá»ƒ lÃ  GSM-Hard (Gao et al., 2022), SVAMP (Patel et al., 2021), ASDIV (Miao et al., 2020), TabMWP (Lu et al., 2023), SingleEQ, SingleOP, AddSub, vÃ  MultiArith (Koncel-Kedziorski et al., 2016), nhÆ° minh há»a trong Báº£ng 5 trong Phá»¥ lá»¥c. 10 táº­p dá»¯ liá»‡u Ä‘a dáº¡ng táº­p há»£p bao gá»“m cÃ¡c bÃ i toÃ¡n toÃ¡n há»c tá»« sá»‘ há»c cÆ¡ báº£n Ä‘áº¿n cáº¥p Ä‘á»™ thi Ä‘áº¥u, bao trÃ¹m chÆ°Æ¡ng trÃ¬nh trung há»c vÃ  phá»• thÃ´ng vÃ  cÃ¡c lÄ©nh vá»±c toÃ¡n há»c khÃ¡c nhau. CÃ¡c Ä‘á»‹nh dáº¡ng bÃ i toÃ¡n bao gá»“m cÃ¡c cÃ¢u há»i dá»±a trÃªn báº£ng, dáº¡ng tá»± do, vÃ  tráº¯c nghiá»‡m, Ä‘áº£m báº£o Ä‘Ã¡nh giÃ¡ toÃ n diá»‡n kháº£ nÄƒng láº­p luáº­n toÃ¡n há»c cá»§a mÃ´ hÃ¬nh.

--- TRANG 6 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Báº£ng 2: Káº¿t quáº£ trÃªn 10 tÃ¡c vá»¥ láº­p luáº­n toÃ¡n há»c. Káº¿t quáº£ MAWPS Ä‘Æ°á»£c tÃ­nh trung bÃ¬nh trÃªn bá»‘n tÃ¡c vá»¥: Singleeq, Singleop, Addsub, vÃ  MultArith. CÃ¡c mÃ´ hÃ¬nh Vanilla Ä‘Æ°á»£c kiá»ƒm tra vá»›i CoT. Káº¿t quáº£ tá»‘t nháº¥t trong má»—i pháº§n Ä‘Æ°á»£c tÃ´ mÃ u xanh, káº¿t quáº£ tá»‘t thá»© hai Ä‘Æ°á»£c gáº¡ch dÆ°á»›i, trong khi káº¿t quáº£ cá»§a mÃ´ hÃ¬nh tá»‘t nháº¥t cá»§a chÃºng tÃ´i Ä‘Æ°á»£c in Ä‘áº­m.âˆ—ZS: Suy luáº­n khÃ´ng cáº§n máº«u mÃ  khÃ´ng cÃ³ minh chá»©ng.
MÃ´ hÃ¬nh KÃ­ch thÆ°á»›c CÃ´ng cá»¥ ZSâˆ—GSM8k MATH GSM-Hard SVAMP TabMWP ASDiv MAWPS AVG
ÄÆ°á»£c sá»­ dá»¥ng cho huáº¥n luyá»‡n? âœ“ âœ“ âœ— âœ— âœ— âœ— âœ—
CÃ¡c MÃ´ hÃ¬nh Äá»™c quyá»n
GPT-4 - âœ— âœ— 92.0 42.5 64.7 93.1 67.1 91.3 97.6 78.3
GPT-4 (PAL) - âœ“ âœ— 94.2 51.8 77.6 94.8 95.9 92.6 97.7 86.4
ChatGPT - âœ— âœ— 80.8 35.5 55.9 83.0 69.1 87.3 94.6 72.3
ChatGPT (PAL) - âœ“ âœ— 78.6 38.7 67.6 77.8 79.9 81.0 89.4 73.3
Claude-2 - âœ— âœ— 85.2 32.5 - - - - - -
PaLM-2 540B âœ— âœ— 80.7 34.3 - - - - - -
CÃ¡c MÃ´ hÃ¬nh Nguá»“n Má»Ÿ
LLaMA-2 7B âœ— âœ— 13.3 4.1 7.8 38.0 31.1 50.7 60.9 29.4
LLaMA-2 SFT 7B âœ— âœ“ 41.3 7.2 16.1 31.9 27.8 47.4 60.0 33.1
LLaMA-2 RFT 7B âœ— âœ“ 51.2 - - - - - - -
Platypus-2 7B âœ— âœ— 14.4 5.4 8.6 36.7 26.5 47.9 58.4 28.3
WizardMath 7B âœ— âœ“ 54.9 10.7 20.6 57.3 38.1 59.1 73.7 44.9
CodeLLaMA (PAL) 7B âœ“ âœ— 34.0 16.6 33.6 59.0 47.3 61.4 79.6 47.4
Toolformerâ€  7B âœ“ âœ“ - - - 29.4 - 40.4 44.0 -
TORA 7B âœ“ âœ“ 68.8 40.1 54.6 68.2 42.4 73.9 88.8 62.4
TORA-CODE 7B âœ“ âœ“ 72.6 44.6 56.0 70.4 51.6 78.7 91.3 66.5 (+19)
LLaMA-2 13B âœ— âœ— 24.3 6.3 13.6 43.1 39.5 56.3 70.4 36.2
LLaMA-2 SFT 13B âœ— âœ“ 51.1 9.2 22.3 46.3 35.8 58.6 75.0 42.6
LLaMA-2 RFT 13B âœ— âœ“ 55.3 - - - - - - -
Platypus-2 13B âœ— âœ— 23.7 7.1 14.3 50.7 45.3 55.1 69.6 38.0
WizardMath 13B âœ— âœ“ 63.9 14.0 28.4 64.3 46.7 65.8 79.7 51.8
CodeLLaMA (PAL) 13B âœ“ âœ— 39.9 19.9 39.0 62.4 59.5 65.3 86.0 53.1
TORA 13B âœ“ âœ“ 72.7 43.0 57.3 72.9 47.2 77.2 91.3 65.9
TORA-CODE 13B âœ“ âœ“ 75.8 48.1 60.5 75.7 65.4 81.4 92.5 71.3 (+18)
LLaMA-1 RFT 34B âœ— âœ“ 57.9 - - - - - - -
CodeLLaMA (PAL) 34B âœ“ âœ— 53.3 23.9 49.4 71.0 63.1 72.4 91.5 60.7
TORA-CODE 34B âœ“ âœ“ 80.7 50.8 63.7 80.5 70.5 84.2 93.3 74.8 (+14)
LLaMA-2 70B âœ— âœ— 57.8 14.4 36.0 73.6 57.5 76.0 92.4 58.2
LLaMA-2 SFT 70B âœ— âœ“ 69.3 14.9 39.0 64.0 53.0 71.3 84.8 56.6
LLaMA-2 RFT 70B âœ— âœ“ 64.8 - - - - - - -
Platypus-2 70B âœ— âœ— 45.9 15.0 24.6 74.3 47.3 72.7 91.1 53.0
WizardMath 70B âœ— âœ“ 81.6 22.7 50.3 80.0 49.8 76.2 86.2 63.8
LLaMA-2 (PAL) 70B âœ“ âœ— 55.2 18.3 50.0 74.6 59.5 71.9 92.8 60.3
TORA 70B âœ“ âœ“ 84.3 49.7 67.2 82.7 74.0 86.8 93.8 76.9 (+13)

CÃ¡c chá»‰ sá»‘ ChÃºng tÃ´i bÃ¡o cÃ¡o Ä‘á»™ chÃ­nh xÃ¡c cá»§a cÃ¡c cÃ¢u tráº£ lá»i dá»± Ä‘oÃ¡n. Theo Lightman et al. (2023), chÃºng tÃ´i lÃ m trÃ²n cÃ¡c giÃ¡ trá»‹ sá»‘ vÃ  sá»­ dá»¥ng sympyÂ² Ä‘á»ƒ phÃ¢n tÃ­ch biá»ƒu thá»©c. VÃ¬ cÃ¡c táº­p dá»¯ liá»‡u SingleEQ, SingleOP, AddSub, vÃ  MultiArith táº­p trung vÃ o cÃ¡c khÃ­a cáº¡nh khÃ¡c nhau cá»§a sá»‘ há»c cÆ¡ báº£n, chÃºng tÃ´i bÃ¡o cÃ¡o káº¿t quáº£ trung bÃ¬nh cá»§a chÃºng dÆ°á»›i thuáº­t ngá»¯ táº­p thá»ƒ MAWPS (Koncel-Kedziorski et al., 2016) cho táº¥t cáº£ cÃ¡c phÆ°Æ¡ng phÃ¡p.

3.3 BASELINE
CÃ¡c MÃ´ hÃ¬nh Äá»™c quyá»n ChÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ tá»« má»™t loáº¡t cÃ¡c LLM SoTA, nhÆ° GPT-4 cá»§a OpenAI, ChatGPT (gpt-3.5-turbo), PaLM-2 cá»§a Google, vÃ  Claude-2 cá»§a Anthropic. Theo máº·c Ä‘á»‹nh, chÃºng tÃ´i bÃ¡o cÃ¡o káº¿t quáº£ gá»£i Ã½ CoT, vÃ  bao gá»“m káº¿t quáº£ gá»£i Ã½ PAL (Gao et al., 2022) cho cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c chá»n.

CÃ¡c MÃ´ hÃ¬nh Nguá»“n Má»Ÿ CÃ¡c mÃ´ hÃ¬nh cÆ¡ sá»Ÿ bao gá»“m LLaMA-2 vÃ  CodeLLaMA vá»›i gá»£i Ã½ CoT vÃ  PAL. Tinh chá»‰nh CÃ³ giÃ¡m sÃ¡t (SFT) sá»­ dá»¥ng cÃ¡c láº­p luáº­n CoT tá»« táº­p dá»¯ liá»‡u GSM8k vÃ  MATH gá»‘c (15k máº«u) Ä‘á»ƒ tinh chá»‰nh. Tinh chá»‰nh Láº¥y máº«u Tá»« chá»‘i (RFT) táº­n dá»¥ng nhiá»u mÃ´ hÃ¬nh Ä‘á»ƒ táº¡o ra cÃ¡c Ä‘Æ°á»ng lá»‘i láº­p luáº­n Ä‘a dáº¡ng Ä‘á»ƒ tinh chá»‰nh (Yuan et al., 2023). WizardMath tÄƒng cÆ°á»ng dá»¯ liá»‡u báº±ng ChatGPT, vÃ  thá»±c hiá»‡n SFT vÃ  RLHF. Platypus-2, mÃ´ hÃ¬nh hÃ ng Ä‘áº§u trÃªn LLM LeaderboardÂ³, Ä‘Æ°á»£c tinh chá»‰nh vá»›i cÃ¡c táº­p dá»¯ liá»‡u láº­p luáº­n Open-Platypus (Lee et al., 2023). ChÃºng tÃ´i cÅ©ng so sÃ¡nh TORA vá»›i Toolformer (Schick et al., 2023) lÃ  má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ sá»­ dá»¥ng mÃ¡y tÃ­nh.

Â²https://www.sympy.org
Â³https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard

--- TRANG 7 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Báº£ng 3: Káº¿t quáº£ trÃªn cÃ¡c chá»§ Ä‘á» con cá»§a MATH.
MÃ´ hÃ¬nh KÃ­ch thÆ°á»›c CÃ´ng cá»¥ Äáº¡i sá»‘ Trung cáº¥p Precalculus HÃ¬nh há»c LÃ½ thuyáº¿t Sá»‘ Äáº¿m & XÃ¡c suáº¥t Prealgebra Äáº¡i sá»‘ Tá»•ng thá»ƒ
CÃ¡c MÃ´ hÃ¬nh Äá»™c quyá»n
ChatGPT (PAL) - âœ“ 18.5 19.2 23.2 48.5 43.0 62.7 45.4 38.7
GPT-4 (PAL) - âœ“ 32.8 29.3 38.0 58.7 61.0 73.9 59.1 51.8
CÃ¡c MÃ´ hÃ¬nh Nguá»“n Má»Ÿ
WizardMath 7B âœ— 6.2 6.0 6.5 7.6 9.5 18.1 16.3 11.2
TORA-CODE 7B âœ“ 35.1 (+28.9) 31.0 (+25.0) 24.0 (+17.5) 50.7 (+43.1) 30.6 (+21.1) 55.0 (+36.9) 61.7 (+45.4) 44.6 (+33.4)
w/o Shaping 7B âœ“ 29.7 (-5.4) 25.1 (-5.9) 17.7 (-6.3) 46.9 (-3.8) 32.3 (+1.7) 51.9 (-3.1) 55.7 (-6.0) 40.2 (-4.4)
w/o Rationale 7B âœ“ 25.5 (-9.6) 14.7 (-16.3) 15.4 (-8.6) 45.9 (-4.8) 29.7 (-0.9) 51.0 (-4.0) 52.4 (-9.3) 36.8 (-7.8)
WizardMath 13B âœ— 6.4 6.6 11.5 9.6 11.0 28.5 21.1 15.0
TORA-CODE 13B âœ“ 35.7 (+29.3) 31.1 (+24.5) 25.7 (+14.2) 55.6 (+46.0) 39.5 (+28.5) 58.7 (+30.2) 66.7 (+45.6) 48.1 (+33.1)
w/o Shaping 13B âœ“ 32.8 (-2.9) 26.0 (-5.1) 24.0 (-1.7) 52.6 (-3.0) 38.4 (-1.1) 55.6 (-3.1) 61.2 (-5.5) 44.6 (-3.5)
w/o Rationale 13B âœ“ 27.1 (-8.6) 15.8 (-15.3) 16.3 (-9.4) 50.4 (-5.2) 36.9 (-2.6) 55.3 (-3.4) 56.5 (-10.2) 40.2 (-7.9)
TORA-CODE 34B âœ“ 38.9 34.6 27.3 57.8 41.4 63.7 67.7 50.8
w/o Shaping 34B âœ“ 34.0 (-4.9) 29.9 (-4.7) 24.6 (-2.7) 55.6 (-2.2) 41.6 (+0.2) 63.8 (+0.1) 61.4 (-6.3) 47.4 (-3.4)
w/o Rationale 34B âœ“ 28.3 (-10.6) 15.8 (-18.8) 18.0 (-9.3) 52.4 (-5.4) 40.7 (-0.7) 58.6 (-5.1) 57.5 (-10.2) 41.9 (-8.9)
WizardMath 70B âœ— 9.1 13.4 16.9 16.5 19.2 42.7 35.0 24.1
TORA 70B âœ“ 37.1 (+28) 30.4 (+17) 30.1 (+13.2) 54.6 (+38.1) 40.3 (+21.1) 64.9 (+22.2) 66.6 (+31.6) 49.7 (+25.6)
w/o Shaping 70B âœ“ 33.8 (-3.3) 28.9 (-1.5) 27.1 (-3) 53.0 (-1.6) 38.0 (-2.3) 62.2 (-2.7) 64.2 (-2.4) 47.3 (-2.4)
w/o Rationale 70B âœ“ 26.7 (-10.4) 14.7 (-15.7) 20.3 (-9.8) 48.9 (-5.7) 39.2 (-1.1) 59.8 (-5.1) 57.6 (-9) 41.5 (-8.2)

3.4 Káº¾T QUáº¢ CHÃNH
Báº£ng 2 trÃ¬nh bÃ y káº¿t quáº£ cá»§a TORA trÃªn 10 táº­p dá»¯ liá»‡u toÃ¡n há»c, nÃªu báº­t nhá»¯ng quan sÃ¡t ná»•i báº­t sau: (1) Sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng xen káº½ vÃ  Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra, TORA vÆ°á»£t trá»™i má»™t cÃ¡ch nháº¥t quÃ¡n so vá»›i cÃ¡c mÃ´ hÃ¬nh nguá»“n má»Ÿ tiÃªn tiáº¿n nháº¥t trÆ°á»›c Ä‘Ã³ á»Ÿ táº¥t cáº£ cÃ¡c quy mÃ´, Ä‘áº¡t Ä‘Æ°á»£c cáº£i thiá»‡n tuyá»‡t Ä‘á»‘i 13% Ä‘áº¿n 19% trÃªn 10 tÃ¡c vá»¥. (2) TORA-70B vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i ChatGPT vá»›i cáº£ gá»£i Ã½ CoT vÃ  PAL trÃªn GSM8k (84,3% so vá»›i 80,4%) vÃ  MATH (49,7% so vá»›i 38,7%), trong khi TORA-CODE-34B cáº¡nh tranh vá»›i GPT-4 giáº£i quyáº¿t táº­p dá»¯ liá»‡u MATH cáº¥p Ä‘á»™ thi Ä‘áº¥u báº±ng code (50,8% so vá»›i 51,8%). (3) Äá»™ chÃ­nh xÃ¡c cá»§a TORA-CODE cao hÆ¡n khoáº£ng 5% so vá»›i TORA cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c, chá»©ng minh ráº±ng viá»‡c huáº¥n luyá»‡n tiáº¿p tá»¥c trÃªn dá»¯ liá»‡u code cÃ³ lá»£i Ä‘Ã¡ng ká»ƒ cho viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh. (4) Trong khi tinh chá»‰nh dá»±a trÃªn láº­p luáº­n áº£nh hÆ°á»Ÿng tiÃªu cá»±c Ä‘áº¿n kháº£ nÄƒng tá»•ng quÃ¡t hÃ³a ngoÃ i phÃ¢n phá»‘i, TORA thá»ƒ hiá»‡n kháº£ nÄƒng tá»•ng quÃ¡t hÃ³a vÆ°á»£t trá»™i. VÃ­ dá»¥, WizardMath-70B kÃ©m hiá»‡u suáº¥t hÆ¡n mÃ´ hÃ¬nh cÆ¡ sá»Ÿ trÃªn TabMWP (49,8% so vá»›i 57,5%), trong khi TORA-70B tá»•ng quÃ¡t hÃ³a hiá»‡u quáº£ cho tÃ¡c vá»¥ láº­p luáº­n báº£ng nÃ y (74,0%). (5) TORA Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ suy luáº­n khÃ´ng cáº§n máº«u nhanh, trung bÃ¬nh 1,02 vÃ²ng tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ má»—i bÃ i toÃ¡n, trong khi giáº£i quyáº¿t hiá»‡u quáº£ cÃ¡c bÃ i toÃ¡n yÃªu cáº§u sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c.

3.5 NGHIÃŠN Cá»¨U LOáº I Bá»
LLaMA-2-7B LLaMA-2-13B LLaMA-2-70B GPT-40102030405060Äá»™ chÃ­nh xÃ¡c (%)
7.29.214.942.5
27.831.339.251.8
33.637.547.361.6Chá»‰ láº­p luáº­n Chá»‰ chÆ°Æ¡ng trÃ¬nh Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥

HÃ¬nh 4: So sÃ¡nh ba Ä‘á»‹nh dáº¡ng: (1) Chá»‰ láº­p luáº­n: láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn tá»«ng bÆ°á»›c nhÆ° CoT; (2) Chá»‰ chÆ°Æ¡ng trÃ¬nh: giáº£i quyáº¿t bÃ i toÃ¡n báº±ng chÆ°Æ¡ng trÃ¬nh nhÆ° PAL; (3) Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi TORA: xen káº½ láº­p luáº­n vÃ  thá»±c thi chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ GPT-4 vá»›i gá»£i Ã½ few-shot. ChÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh LLaMA-2 Ä‘á»ƒ láº­p luáº­n theo ba loáº¡i Ä‘á»‹nh dáº¡ng tÆ°Æ¡ng á»©ng. Äá»ƒ so sÃ¡nh cÃ´ng báº±ng, chÃºng tÃ´i khÃ´ng Ã¡p dá»¥ng Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra cho táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh LLaMA-2.

--- TRANG 8 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
3.5.1 SO SÃNH CÃC Äá»ŠNH Dáº NG
Äá»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cá»§a Ä‘á»‹nh dáº¡ng láº­p luáº­n Ä‘Æ°á»£c Ã¡p dá»¥ng bá»Ÿi TORA xen káº½ láº­p luáº­n vá»›i chÆ°Æ¡ng trÃ¬nh, chÃºng tÃ´i so sÃ¡nh nÃ³ vá»›i cÃ¡c Ä‘á»‹nh dáº¡ng Chá»‰ láº­p luáº­n vÃ  Chá»‰ chÆ°Æ¡ng trÃ¬nh báº±ng GPT-4 vÃ  LLaMA-2 Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i cÃ¹ng kÃ­ch thÆ°á»›c dá»¯ liá»‡u tá»« MATH. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 4, phÆ°Æ¡ng phÃ¡p TORA vÆ°á»£t trá»™i má»™t cÃ¡ch nháº¥t quÃ¡n so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p Chá»‰ láº­p luáº­n vÃ  Chá»‰ chÆ°Æ¡ng trÃ¬nh. ÄÃ¡ng chÃº Ã½, sá»­ dá»¥ng LLaMA-2, phÆ°Æ¡ng phÃ¡p TORA Ä‘áº¡t Ä‘Æ°á»£c cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ 29,0% vÃ  6,7% so vá»›i Chá»‰ láº­p luáº­n vÃ  Chá»‰ chÆ°Æ¡ng trÃ¬nh tÆ°Æ¡ng á»©ng. Vá»›i GPT-4 nguá»“n Ä‘Ã³ng, cÃ¡c cáº£i thiá»‡n lÃ  19,1% vÃ  9,8% tÆ°Æ¡ng á»©ng. Äiá»u nÃ y nháº¥n máº¡nh tÃ­nh hiá»‡u quáº£ cá»§a viá»‡c tÃ­ch há»£p láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vá»›i chÆ°Æ¡ng trÃ¬nh.

3.5.2 TÃC Äá»˜NG Cá»¦A Äá»ŠNH HÃŒNH KHÃ”NG GIAN Äáº¦U RA
7B 13B65707580Äá»™ chÃ­nh xÃ¡c (%)68.173.5
71.174.9
72.675.8GSM8k
7B 13B35404550Äá»™ chÃ­nh xÃ¡c (%)40.244.6 44.646.7
44.648.1MATHToRASampling
Correction
ToRACorrection
ToRA

HÃ¬nh 5: Loáº¡i bá» cÃ¡c chiáº¿n lÆ°á»£c Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra sá»­ dá»¥ng CodeLLaMA: (1) TORAâˆ’Samplingâˆ’Correction Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn TORA-CORPUS mÃ  khÃ´ng cÃ³ Ä‘á»‹nh hÃ¬nh. (2) TORAâˆ’Correction chá»‰ sá»­ dá»¥ng chiáº¿n lÆ°á»£c láº¥y máº«u Ä‘á»ƒ Ä‘á»‹nh hÃ¬nh, Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i tá»‘i Ä‘a 4 máº«u quá»¹ Ä‘áº¡o há»£p lá»‡ bá»• sung má»—i bÃ i toÃ¡n. (3) TORA sá»­ dá»¥ng cáº£ láº¥y máº«u vÃ  sá»­a chá»¯a, cÅ©ng Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i tá»‘i Ä‘a 4 quá»¹ Ä‘áº¡o bá»• sung má»—i bÃ i toÃ¡n.

ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ tÃ­nh hiá»‡u quáº£ cá»§a cÃ¡c chiáº¿n lÆ°á»£c Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra Ä‘Æ°á»£c trÃ¬nh bÃ y trong Pháº§n 2.3, cá»¥ thá»ƒ lÃ  láº¥y máº«u vÃ  sá»­a chá»¯a. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 5 vÃ  Báº£ng 3: (1) Äá»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra mang láº¡i cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ trung bÃ¬nh 3,4% vÃ  4,0% tuyá»‡t Ä‘á»‘i cho GSM8k vÃ  MATH tÆ°Æ¡ng á»©ng, vá»›i lá»£i Ã­ch lá»›n hÆ¡n cho cÃ¡c mÃ´ hÃ¬nh nhá» hÆ¡n; (2) Ãp dá»¥ng chiáº¿n lÆ°á»£c láº¥y máº«u dáº«n Ä‘áº¿n cáº£i thiá»‡n tuyá»‡t Ä‘á»‘i 2,7% trung bÃ¬nh, trong khi viá»‡c káº¿t há»£p thÃªm sá»­a chá»¯a mang láº¡i sá»± thÃºc Ä‘áº©y Ä‘Ã¡ng ká»ƒ hÆ¡n lÃªn Ä‘áº¿n 4,5%, mÃ  khÃ´ng sá»­ dá»¥ng thÃªm dá»¯ liá»‡u huáº¥n luyá»‡n; (3) Äá»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra cÃ³ lá»£i ngay cáº£ cho mÃ´ hÃ¬nh lá»›n nháº¥t TORA-70B, vá»›i cáº£i thiá»‡n Ä‘Ã¡ng chÃº Ã½ tá»« 47,3% lÃªn 49,7% trÃªn MATH. Nhá»¯ng phÃ¡t hiá»‡n nÃ y lÃ m ná»•i báº­t tÃ­nh hiá»‡u quáº£ cá»§a cÃ¡c chiáº¿n lÆ°á»£c Ä‘á»‹nh hÃ¬nh cá»§a chÃºng tÃ´i trÃªn cÃ¡c kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh vÃ  táº­p dá»¯ liá»‡u khÃ¡c nhau.

3.6 PHÃ‚N TÃCH
ChÃºng tÃ´i Ä‘iá»u tra nhá»¯ng lá»£i Ã­ch, máº«u chi tiáº¿t, vÃ  thÃ¡ch thá»©c cÃ²n láº¡i cá»§a tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ cho láº­p luáº­n toÃ¡n há»c trÃªn táº­p dá»¯ liá»‡u MATH thÃ¡ch thá»©c. PhÃ¢n tÃ­ch hiá»‡u suáº¥t trÃªn táº¥t cáº£ cÃ¡c chá»§ Ä‘á» con cá»§a MATH Ä‘Æ°á»£c bÃ¡o cÃ¡o trong Báº£ng 3.

Lá»£i Ã­ch tá»« TÃ­ch há»£p CÃ´ng cá»¥ cho cÃ¡c Chá»§ Ä‘á» Con cá»§a MATH NhÆ° thá»ƒ hiá»‡n trong Báº£ng 3, TORA vÆ°á»£t trá»™i so vá»›i WizardMath khoáº£ng 45% trong Äáº¡i sá»‘ vÃ  LÃ½ thuyáº¿t Sá»‘, Ä‘iá»u nÃ y Ä‘Æ°á»£c quy cho viá»‡c kÃ­ch thÃ­ch vÃ  Ä‘á»‹nh hÃ¬nh hÃ nh vi sá»­ dá»¥ng cÃ´ng cá»¥. CÃ¡c bÃ i toÃ¡n tá»« hai chá»§ Ä‘á» con thÆ°á»ng cáº§n tÃ­nh toÃ¡n phá»©c táº¡p vÃ  thao tÃ¡c dá»¯ liá»‡u. Äáº¡i sá»‘ chá»§ yáº¿u táº­p trung vÃ o viá»‡c giáº£i phÆ°Æ¡ng trÃ¬nh vÃ  cÃ¡c bÃ i toÃ¡n á»©ng dá»¥ng, trong khi nhiá»u bÃ i toÃ¡n LÃ½ thuyáº¿t Sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p brute-force thÃ´ng qua code.

Máº«u Sá»­ dá»¥ng ThÆ° viá»‡n cho Giáº£i quyáº¿t BÃ i toÃ¡n HÃ¬nh 6 trÃ¬nh bÃ y cÃ¡c thÆ° viá»‡n Ä‘Æ°á»£c sá»­ dá»¥ng thÆ°á»ng xuyÃªn nháº¥t cho cÃ¡c chá»§ Ä‘á» con khÃ¡c nhau vÃ  Ä‘á»™ chÃ­nh xÃ¡c tÆ°Æ¡ng á»©ng cá»§a cÃ¡c giáº£i phÃ¡p cá»§a chÃºng. HÃ nh vi sá»­ dá»¥ng cÃ´ng cá»¥ trÃªn cÃ¡c lÄ©nh vá»±c toÃ¡n há»c khÃ¡c nhau thá»ƒ hiá»‡n cÃ¡c máº«u riÃªng biá»‡t. sympy vÃ  cÃ¡c bá»™ giáº£i ná»™i bá»™ cá»§a nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng chá»§ yáº¿u cho cÃ¡c chá»§ Ä‘á» liÃªn quan Ä‘áº¿n Ä‘áº¡i sá»‘. Precalculus thá»ƒ hiá»‡n cÃ¡c thao tÃ¡c ma tráº­n rá»™ng rÃ£i thÃ´ng qua matrices, dáº«n Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c cao. LÃ½ thuyáº¿t Sá»‘ phá»¥ thuá»™c vÃ o cÃ¡c thuáº­t toÃ¡n nhÆ° gcd vÃ  lcm. HÃ¬nh há»c chá»§ yáº¿u sá»­ dá»¥ng thÆ° viá»‡n rational cho cÃ¡c tÃ­nh toÃ¡n dá»±a trÃªn phÃ¢n sá»‘, trong khi viá»‡c Ã¡p dá»¥ng cÃ¡c cÃ´ng cá»¥ khÃ¡c bá»‹ háº¡n cháº¿, biá»ƒu hiá»‡n tiá»m nÄƒng cáº£i thiá»‡n.

TÃ¡c Ä‘á»™ng Chi tiáº¿t cá»§a Láº­p luáº­n trÃªn CÃ¡c Chá»§ Ä‘á» KhÃ¡c nhau Báº£ng 3 cho tháº¥y ráº±ng viá»‡c sá»­ dá»¥ng Ä‘á»‹nh dáº¡ng xen káº½, trÃ¡i ngÆ°á»£c vá»›i viá»‡c chá»‰ viáº¿t chÆ°Æ¡ng trÃ¬nh, dáº«n Ä‘áº¿n cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ trÃªn táº¥t cáº£ cÃ¡c chá»§ Ä‘á» con, Ä‘áº·c biá»‡t lÃ  trong Precalculus, Äáº¡i sá»‘, vÃ  HÃ¬nh há»c, nÆ¡i cÃ¡c tÄƒng trÆ°á»Ÿng Ä‘Ã¡ng chÃº Ã½ dao Ä‘á»™ng tá»« 8,6% Ä‘áº¿n 18,8%.

--- TRANG 9 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Int. Alg. PreCalc Geometry Num. Th. C&P PreAlg Algebra Overall 020406080100 Táº§n suáº¥t (%) Táº§n suáº¥t Sá»­ dá»¥ng ThÆ° viá»‡n cho Má»—i Chá»§ Ä‘á»
sympy
solvers
rational
calculus
matrices
binomial
algorithm
Int. Alg. PreCalc Geometry Num. Th. C&P PreAlg Algebra Overall 020406080100 Äá»™ chÃ­nh xÃ¡c (%) Äá»™ chÃ­nh xÃ¡c Sá»­ dá»¥ng ThÆ° viá»‡n cho Má»—i Chá»§ Ä‘á»
sympy
solvers
rational
calculus
matrices
binomial
algorithm

HÃ¬nh 6: Táº§n suáº¥t sá»­ dá»¥ng thÆ° viá»‡n vÃ  Ä‘á»™ chÃ­nh xÃ¡c trÃªn má»—i chá»§ Ä‘á» con cá»§a MATH.

Phá»¥ lá»¥c F.1 cung cáº¥p cÃ¡c vÃ­ dá»¥ Ä‘áº¡i diá»‡n chá»©ng minh cÃ¡ch láº­p luáº­n há»— trá»£ trong láº­p káº¿ hoáº¡ch, tá»± sá»­a chá»¯a nhiá»u vÃ²ng, vÃ  hoÃ n thiá»‡n cÃ¢u tráº£ lá»i.

Báº£ng 4: CÃ¡c cháº¿ Ä‘á»™ tháº¥t báº¡i cá»§a TORA trÃªn MATH, vÃ  tá»· lá»‡ pháº§n trÄƒm tÆ°Æ¡ng á»©ng cá»§a chÃºng trong cÃ¡c máº«u ngáº«u nhiÃªn Ä‘Æ°á»£c phÃ¢n tÃ­ch bá»Ÿi con ngÆ°á»i. ChÃºng tÃ´i bao gá»“m cÃ¡c vÃ­ dá»¥ cá»¥ thá»ƒ cá»§a má»—i cháº¿ Ä‘á»™ tháº¥t báº¡i trong Phá»¥ lá»¥c F.
Loáº¡i Lá»—i Äá»‹nh nghÄ©a % VÃ­ dá»¥
Lá»—i Láº­p luáº­n Sai láº§m do cÃ¡c bÆ°á»›c láº­p luáº­n khÃ´ng chÃ­nh xÃ¡c hoáº·c thiáº¿u Ä‘iá»u kiá»‡n. 38% VÃ­ dá»¥ 5
áº¢o giÃ¡c Bá»‹a Ä‘áº·t sá»‘ hoáº·c cÃ¢u tráº£ lá»i. 5% VÃ­ dá»¥ 6
Hiá»ƒu SÆ¡ Ä‘á»“ Hiá»ƒu sai sÆ¡ Ä‘á»“ Ä‘áº§u vÃ o. 21% VÃ­ dá»¥ 7
Sá»­ dá»¥ng CÃ´ng cá»¥ KhÃ´ng phÃ¹ há»£p Sá»­ dá»¥ng khÃ´ng chÃ­nh xÃ¡c cÃ¡c cÃ´ng cá»¥ bÃªn ngoÃ i, Ä‘áº·c biá»‡t khi bÃ i toÃ¡n khÃ´ng thá»ƒ giáº£i quyáº¿t trá»±c tiáº¿p báº±ng thÆ° viá»‡n. 10% VÃ­ dá»¥ 8
Lá»—i CÃº phÃ¡p Lá»—i cÃº phÃ¡p liÃªn tá»¥c máº·c dÃ¹ nhiá»u láº§n thá»­ sá»­a chá»¯a. 9% VÃ­ dá»¥ 9
Lá»—i Runtime Lá»—i trong quÃ¡ trÃ¬nh thá»±c thi chÆ°Æ¡ng trÃ¬nh, khÃ´ng Ä‘Æ°á»£c giáº£i quyáº¿t báº±ng cÃ¡ch thá»­ láº¡i. 9% VÃ­ dá»¥ 10
Lá»—i Chá»‰ láº­p luáº­n KhÃ´ng thá»ƒ Ä‘Æ°á»£c chÃ­nh thá»©c hÃ³a thÃ nh má»™t chÆ°Æ¡ng trÃ¬nh vÃ  láº­p luáº­n lÃ  khÃ´ng chÃ­nh xÃ¡c. 3% VÃ­ dá»¥ 11
Ã‚m tÃ­nh Giáº£ CÃ¢u tráº£ lá»i Ä‘Ãºng khÃ´ng khá»›p hoÃ n toÃ n vá»›i sá»± tháº­t cÆ¡ báº£n. 5% VÃ­ dá»¥ 12

Nhá»¯ng ThÃ¡ch thá»©c CÃ²n láº¡i trong Láº­p luáº­n ToÃ¡n há»c cho TORA Äá»ƒ hiá»ƒu rÃµ hÆ¡n cÃ¡c cháº¿ Ä‘á»™ tháº¥t báº¡i vÃ  thÃ¡ch thá»©c cÃ²n láº¡i, chÃºng tÃ´i chÃº thÃ­ch thá»§ cÃ´ng 100 quá»¹ Ä‘áº¡o Ä‘Æ°á»£c chá»n ngáº«u nhiÃªn tá»« táº­p kiá»ƒm tra MATH, xÃ¡c Ä‘á»‹nh vÃ  phÃ¢n loáº¡i cÃ¡c cháº¿ Ä‘á»™ tháº¥t báº¡i cá»§a chÃºng. Káº¿t quáº£ Ä‘Æ°á»£c thá»ƒ hiá»‡n trong Báº£ng 4: Chá»§ yáº¿u, cÃ¡c bÆ°á»›c láº­p luáº­n khÃ´ng chÃ­nh xÃ¡c táº¡o thÃ nh nguá»“n lá»—i chÃ­nh cho ToRA trÃªn cÃ¡c tÃ¡c vá»¥ láº­p luáº­n toÃ¡n phá»©c táº¡p (38%), vá»›i má»™t sá»‘ váº¥n Ä‘á» áº£o giÃ¡c cÅ©ng rÃµ rÃ ng trong quÃ¡ trÃ¬nh diá»…n giáº£i bÃ i toÃ¡n vÃ  hoÃ n thiá»‡n cÃ¢u tráº£ lá»i (5%). Thá»© hai, viá»‡c hiá»ƒu sai cÃ¡c sÆ¡ Ä‘á»“ Ä‘áº§u vÃ o Ä‘Ã³ng gÃ³p Ä‘Ã¡ng ká»ƒ vÃ o tá»· lá»‡ lá»—i (21%). Äiá»u nÃ y Ä‘áº·c biá»‡t Ä‘Ã¡ng chÃº Ã½ trong HÃ¬nh há»c, Precalculus, vÃ  Äáº¡i sá»‘ Trung cáº¥p. CÃ¡c sÆ¡ Ä‘á»“ trong táº­p dá»¯ liá»‡u MATH thÆ°á»ng Ä‘Æ°á»£c mÃ´ táº£ chi tiáº¿t báº±ng vÄƒn báº£n sá»­ dá»¥ng ngÃ´n ngá»¯ Asymptote (Hendrycks et al., 2021), do Ä‘Ã³ khiáº¿n TORA khÃ³ hiá»ƒu cÃ¡c sÆ¡ Ä‘á»“ chá»‰ tá»« cÃ¡c mÃ´ táº£ vÄƒn báº£n. Thá»© ba, cÃ¡c váº¥n Ä‘á» vá»›i viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ bao gá»“m Sá»­ dá»¥ng CÃ´ng cá»¥ KhÃ´ng phÃ¹ há»£p (10%), Lá»—i CÃº phÃ¡p (9%), vÃ  Lá»—i Runtime (9%). Nhá»¯ng váº¥n Ä‘á» nÃ y thÆ°á»ng xuyÃªn phÃ¡t sinh khi TORA khÃ´ng thá»ƒ sá»­ dá»¥ng cÃ´ng cá»¥ chÃ­nh xÃ¡c sau vÃ i láº§n sá»­a chá»¯a hoáº·c thá»­ nghiá»‡m. CÃ³ nhá»¯ng Ä‘áº§u vÃ o nháº¥t Ä‘á»‹nh khÃ´ng Ä‘Æ°á»£c chÃ­nh thá»©c hÃ³a tá»‘t nhÆ° cÃ¡c chÆ°Æ¡ng trÃ¬nh (3%), yÃªu cáº§u láº­p luáº­n trá»«u tÆ°á»£ng hÆ¡n lÃ  tÃ­nh toÃ¡n. Cuá»‘i cÃ¹ng, chÃºng tÃ´i cÅ©ng phÃ¡t hiá»‡n ráº±ng cÃ³ nhá»¯ng Ã¢m tÃ­nh giáº£ khi sá»­ dá»¥ng cÃ¡c chá»‰ bÃ¡o tá»± Ä‘á»™ng, tá»©c lÃ  cÃ¡c dá»± Ä‘oÃ¡n Ä‘Ãºng bá»‹ Ä‘Ã¡nh giÃ¡ sai lÃ  sai, nhÆ°ng tá»· lá»‡ tÆ°Æ¡ng Ä‘á»‘i nhá» (5%).

4 Káº¾T LUáº¬N
BÃ i bÃ¡o nÃ y trÃ¬nh bÃ y TORA, má»™t loáº¡t cÃ¡c TÃ¡c tá»­ Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ má»›i káº¿t há»£p hiá»‡p Ä‘á»“ng láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn vá»›i viá»‡c sá»­ dá»¥ng cÃ´ng cá»¥ dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n toÃ¡n há»c. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i chá»©ng minh tiá»m nÄƒng cá»§a viá»‡c tÃ­ch há»£p cÃ¡c cÃ´ng cá»¥ bÃªn ngoÃ i trong quÃ¡ trÃ¬nh láº­p luáº­n, cho phÃ©p cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ giáº£i quyáº¿t hiá»‡u quáº£ cÃ¡c tÃ¡c vá»¥ Ä‘á»‹nh lÆ°á»£ng phá»©c táº¡p. TORA Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tiÃªn tiáº¿n trÃªn 10 tÃ¡c vá»¥ láº­p luáº­n toÃ¡n há»c Ä‘a dáº¡ng, vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn láº­p luáº­n vÃ  dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh hiá»‡n cÃ³. HÆ¡n ná»¯a, phÃ¢n tÃ­ch há»‡ thá»‘ng cá»§a chÃºng tÃ´i vá» lá»£i Ã­ch vÃ  thÃ¡ch thá»©c cÃ²n láº¡i cá»§a tÆ°Æ¡ng tÃ¡c cÃ´ng cá»¥ cung cáº¥p nhá»¯ng hiá»ƒu biáº¿t cÃ³ giÃ¡ trá»‹ cho nghiÃªn cá»©u tÆ°Æ¡ng lai, Ä‘Ã³ng gÃ³p vÃ o viá»‡c phÃ¡t triá»ƒn cÃ¡c tÃ¡c tá»­ láº­p luáº­n nÃ¢ng cao vÃ  Ä‘a nÄƒng hÆ¡n.

--- TRANG 10 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
ÄÃ“NG GÃ“P Cá»¦A TÃC GIáº¢
Zhibin Gou Ä‘á» xuáº¥t Ä‘á»‹nh dáº¡ng sá»­ dá»¥ng cÃ´ng cá»¥ xen káº½ cá»§a TORA vÃ  tuyá»ƒn chá»n táº­p dá»¯ liá»‡u TORA-CORPUS, triá»ƒn khai quy trÃ¬nh huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡, thá»±c hiá»‡n thÃ­ nghiá»‡m vÃ  phÃ¢n tÃ­ch trÃªn táº¥t cáº£ cÃ¡c táº­p dá»¯ liá»‡u, triá»ƒn khai cÃ¡c baseline, vÃ  lÃ  ngÆ°á»i Ä‘Ã³ng gÃ³p chÃ­nh cho viá»‡c viáº¿t bÃ i bÃ¡o. Zhihong Shao Ä‘á» xuáº¥t dá»± Ã¡n, thá»±c hiá»‡n cÃ¡c thÃ­ nghiá»‡m sÆ¡ bá»™, Ä‘á» xuáº¥t vÃ  triá»ƒn khai cÃ¡c quy trÃ¬nh huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡, Ä‘á» xuáº¥t vÃ  huáº¥n luyá»‡n táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh TORA vá»›i Ä‘á»‹nh hÃ¬nh khÃ´ng gian Ä‘áº§u ra cÅ©ng nhÆ° cÃ¡c biáº¿n thá»ƒ TORA trong nghiÃªn cá»©u loáº¡i bá», thiáº¿t káº¿ vÃ  giÃ¡m sÃ¡t phÃ¢n tÃ­ch thá»±c nghiá»‡m, vÃ  Ä‘Ã³ng gÃ³p vÃ o nhiá»u pháº§n cá»§a viá»‡c viáº¿t bÃ i bÃ¡o. Yeyun Gong, Yelong Shen, Yujiu Yang, Minlie Huang, Nan Duan, vÃ  Weizhu Chen cung cáº¥p hÆ°á»›ng dáº«n nghiÃªn cá»©u, giÃ¡m sÃ¡t phá»‘i há»£p dá»± Ã¡n, vÃ  tÆ° váº¥n vÃ  Ä‘Ã³ng gÃ³p vÃ o nhiá»u pháº§n cá»§a viá»‡c viáº¿t.

Lá»œI Cáº¢M Æ N
Zhibin Gou vÃ  Yujiu Yang Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Quá»¹ Khoa há»c Tá»± nhiÃªn Quá»‘c gia Trung Quá»‘c (Sá»‘ tÃ i trá»£ U1903213) vÃ  ChÆ°Æ¡ng trÃ¬nh Khoa há»c vÃ  CÃ´ng nghá»‡ ThÃ¢m Quyáº¿n (JSGG20220831110203007). Zhihong Shao vÃ  Minlie Huang Ä‘Æ°á»£c há»— trá»£ bá»Ÿi cÃ¡c dá»± Ã¡n NSFC (Dá»± Ã¡n chá»§ chá»‘t sá»‘ 61936010), vÃ  cÅ©ng Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Quá»¹ Khoa há»c Quá»‘c gia dÃ nh cho CÃ¡c NhÃ  khoa há»c tráº» Xuáº¥t sáº¯c (sá»‘ 62125604).

--- TRANG 11 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
TÃ€I LIá»†U THAM KHáº¢O
[Danh sÃ¡ch cÃ¡c tÃ i liá»‡u tham kháº£o Ä‘Æ°á»£c giá»¯ nguyÃªn vÃ¬ chÃºng lÃ  tÃªn riÃªng vÃ  thuáº­t ngá»¯ ká»¹ thuáº­t]

--- TRANG 12 ---
[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o]

--- TRANG 13 ---
[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o]

--- TRANG 14 ---
[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o]

--- TRANG 15 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Má»¤C Lá»¤C
A CÃ´ng trÃ¬nh LiÃªn quan 15
B Táº­p dá»¯ liá»‡u ÄÃ¡nh giÃ¡ 15
C ThÃ­ nghiá»‡m vÃ  PhÃ¢n tÃ­ch Bá»• sung 17
C.1 Äá»™ chÃ­nh xÃ¡c cá»§a CÃ¡c MÃ´ hÃ¬nh Nguá»“n ÄÃ³ng trÃªn MATH . . . . . . . . . . . . . . . . . . . . 17
C.2 TÃ¡c Ä‘á»™ng cá»§a # Quá»¹ Ä‘áº¡o Há»£p lá»‡ cho Äá»‹nh hÃ¬nh KhÃ´ng gian Äáº§u ra . . . . . . . . . . . . . . . 17
C.3 TÃ¡c Ä‘á»™ng cá»§a Äá»‹nh hÃ¬nh KhÃ´ng gian Äáº§u ra liÃªn quan Ä‘áº¿n Äá»™ khÃ³ CÃ¢u há»i . . . . . . . . . . . 17
D ThÃ´ng tin Chi tiáº¿t cá»§a TORA-CORPUS 18
E Gá»£i Ã½ 20
F VÃ­ dá»¥ 22
F.1 TrÆ°á»ng há»£p ThÃ nh cÃ´ng . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
F.2 TrÆ°á»ng há»£p Tháº¥t báº¡i . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

A CÃ”NG TRÃŒNH LIÃŠN QUAN
Láº­p luáº­n ToÃ¡n há»c NghiÃªn cá»©u gáº§n Ä‘Ã¢y Ä‘Ã£ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ kháº£ nÄƒng láº­p luáº­n trong LLM vá»›i láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn tá»«ng bÆ°á»›c (Polu & Sutskever, 2020; Wei et al., 2022; Zhou et al., 2023b; Zhu et al., 2023; Huang et al., 2022; Liang et al., 2023). Tuy nhiÃªn, láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn gáº·p khÃ³ khÄƒn vá»›i cÃ¡c tÃ­nh toÃ¡n phá»©c táº¡p vÃ  thao tÃ¡c kÃ½ hiá»‡u. Äá»ƒ vÆ°á»£t qua nhá»¯ng háº¡n cháº¿ nÃ y, nghiÃªn cá»©u gáº§n Ä‘Ã¢y Ä‘Ã£ khai thÃ¡c cÃ¡c cÃ´ng cá»¥ nhÆ° mÃ¡y tÃ­nh (Cobbe et al., 2021; Shao et al., 2022), trÃ¬nh thÃ´ng dá»‹ch code (Mishra et al., 2022), vÃ  bá»™ giáº£i kÃ½ hiá»‡u (Zhang et al., 2023). CÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn chÆ°Æ¡ng trÃ¬nh (Gao et al., 2022; Chen et al., 2022; Shao et al., 2023a) biáº¿n Ä‘á»•i cÃ¡c tÃ¡c vá»¥ láº­p luáº­n thÃ nh cÃ¡c tÃ¡c vá»¥ tá»•ng há»£p chÆ°Æ¡ng trÃ¬nh, do Ä‘Ã³ cung cáº¥p nhá»¯ng Æ°u Ä‘iá»ƒm bá»• sung so vá»›i láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn, nhÆ°ng chÃºng gáº·p thÃ¡ch thá»©c trong láº­p luáº­n tinh táº¿, láº­p káº¿ hoáº¡ch, vÃ  xá»­ lÃ½ lá»—i (Gou et al., 2023), nÆ¡i láº­p luáº­n ngÃ´n ngá»¯ tá»± nhiÃªn phÃ¹ há»£p hÆ¡n.

CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ TÄƒng cÆ°á»ng CÃ´ng cá»¥ Viá»‡c tÄƒng cÆ°á»ng LLM vá»›i cÃ¡c cÃ´ng cá»¥ cÃ³ thá»ƒ giáº£m thiá»ƒu Ä‘Ã¡ng ká»ƒ nhá»¯ng háº¡n cháº¿ cá»§a LLM vÃ  cáº£i thiá»‡n hiá»‡u suáº¥t láº­p luáº­n vÃ  táº¡o sinh (Parisi et al., 2022; Mialon et al., 2023; Yao et al., 2023). CÃ´ng trÃ¬nh gáº§n Ä‘Ã¢y chá»©ng minh lá»£i Ã­ch cá»§a viá»‡c tÃ­ch há»£p cÃ¡c trÃ¬nh truy xuáº¥t (Borgeaud et al., 2022; Shao et al., 2023b), cÃ´ng cá»¥ tÃ¬m kiáº¿m (Nakano et al., 2021), vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘a cÃ´ng cá»¥ (Schick et al., 2023; Paranjape et al., 2023; Gou et al., 2023) Ä‘á»ƒ cáº£i thiá»‡n viá»‡c táº¡o sinh.

ChÆ°ng cáº¥t Kiáº¿n thá»©c ChÆ°ng cáº¥t kiáº¿n thá»©c (KD) chuyá»ƒn giao kiáº¿n thá»©c tá»« cÃ¡c mÃ´ hÃ¬nh giÃ¡o viÃªn sang cÃ¡c mÃ´ hÃ¬nh há»c sinh (Bucilu Ë‡a et al., 2006; Hinton et al., 2015). Viá»‡c sá»­ dá»¥ng cÃ¡c quá»¹ Ä‘áº¡o Ä‘Æ°á»£c táº¡o ra bá»Ÿi LLM Ä‘á»ƒ tinh chá»‰nh lÃ  má»™t hÃ¬nh thá»©c cá»§a KD (Fu et al., 2023; Taori et al., 2023; Peng et al., 2023; Ho et al., 2023). TORA Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i cho tháº¥y ráº±ng viá»‡c há»c cÃ¡c quá»¹ Ä‘áº¡o sá»­ dá»¥ng cÃ´ng cá»¥ tÆ°Æ¡ng tÃ¡c lÃ  má»™t hÆ°á»›ng Ä‘áº§y há»©a háº¹n Ä‘á»ƒ Ä‘iá»u chá»‰nh cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ cho cÃ¡c tÃ¡c vá»¥ láº­p luáº­n.

B Táº¬P Dá»® LIá»†U ÄÃNH GIÃ
ChÃºng tÃ´i trÃ¬nh bÃ y thá»‘ng kÃª vÃ  vÃ­ dá»¥ cá»§a mÆ°á»i táº­p dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡ trong Báº£ng 5.

--- TRANG 16 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
Báº£ng 5: Thá»‘ng kÃª vÃ  vÃ­ dá»¥ cá»§a 10 táº­p dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡. Trong báº£ng káº¿t quáº£ chÃ­nh, chÃºng tÃ´i trÃ¬nh bÃ y Ä‘á»™ chÃ­nh xÃ¡c trung bÃ¬nh cá»§a SingleEq, SingleOp, AddSub, vÃ  MultiArith dÆ°á»›i tÃªn gá»i táº­p thá»ƒ MAWPS.
[Báº£ng chá»©a cÃ¡c táº­p dá»¯ liá»‡u vá»›i thÃ´ng tin chi tiáº¿t vÃ  vÃ­ dá»¥ Ä‘Æ°á»£c giá»¯ nguyÃªn vÃ¬ chÃºng lÃ  tÃªn riÃªng vÃ  dá»¯ liá»‡u ká»¹ thuáº­t]

--- TRANG 17 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
[Tiáº¿p tá»¥c ná»™i dung vá» táº­p dá»¯ liá»‡u vÃ  phÃ¢n tÃ­ch bá»• sung]

--- TRANG 18 ---
[Tiáº¿p tá»¥c ná»™i dung vá» thÃ´ng tin chi tiáº¿t TORA-CORPUS]

--- TRANG 19 ---
[Tiáº¿p tá»¥c ná»™i dung vá» thÃ´ng tin chi tiáº¿t TORA-CORPUS]

--- TRANG 20 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
E Gá»¢I Ã
ChÃºng tÃ´i trÃ¬nh bÃ y cÃ¡c hÆ°á»›ng dáº«n vÃ  gá»£i Ã½ few-shot vÃ­ dá»¥ cá»§a Láº­p luáº­n TÃ­ch há»£p CÃ´ng cá»¥ Ä‘á»ƒ truy váº¥n GPT-4.

[Ná»™i dung gá»£i Ã½ Ä‘Æ°á»£c giá»¯ nguyÃªn vÃ¬ Ä‘Ã¢y lÃ  code vÃ  hÆ°á»›ng dáº«n ká»¹ thuáº­t]

--- TRANG 21 ---
[Tiáº¿p tá»¥c ná»™i dung gá»£i Ã½]

--- TRANG 22 ---
Xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2024
F VÃ Dá»¤
F.1 TRÆ¯á»œNG Há»¢P THÃ€NH CÃ”NG
[CÃ¡c vÃ­ dá»¥ code vÃ  toÃ¡n há»c Ä‘Æ°á»£c giá»¯ nguyÃªn vÃ¬ chÃºng lÃ  ná»™i dung ká»¹ thuáº­t]

--- TRANG 23 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ thÃ nh cÃ´ng]

--- TRANG 24 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ thÃ nh cÃ´ng]

F.2 TRÆ¯á»œNG Há»¢P THáº¤T Báº I
[CÃ¡c vÃ­ dá»¥ tháº¥t báº¡i Ä‘Æ°á»£c giá»¯ nguyÃªn vÃ¬ chÃºng lÃ  ná»™i dung ká»¹ thuáº­t]

--- TRANG 25 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 26 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 27 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 28 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 29 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 30 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 31 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 32 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 33 ---
[Tiáº¿p tá»¥c cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]

--- TRANG 34 ---
[Káº¿t thÃºc cÃ¡c vÃ­ dá»¥ tháº¥t báº¡i]
