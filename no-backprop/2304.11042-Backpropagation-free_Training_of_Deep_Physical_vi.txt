# Huấn luyện không cần lan truyền ngược cho Mạng nơ-ron Vật lý Sâu

Ali Momeni,1Babak Rahmani,2Matthieu Malléjac,1Philipp del Hougne,3
Romain Fleury1∗

1Phòng thí nghiệm Kỹ thuật Sóng, Khoa Kỹ thuật Điện, EPFL, CH-1015 Lausanne, Thụy Sĩ,
2hiện tại tại Microsoft Research, 198 Cambridge Science Park, CB4 0AB Cambridge, Vương quốc Anh,
3Univ Rennes, CNRS, IETR - UMR 6164, F-35000, Rennes, Pháp.
∗romain.fleury@epfl.ch

Những năm gần đây đã chứng kiến thành công vượt bậc của deep learning trong nhiều lĩnh vực khác nhau như thị giác và xử lý ngôn ngữ tự nhiên. Thành công này phần lớn nhờ vào quy mô khổng lồ của các mô hình deep learning được kỳ vọng sẽ tăng không ngừng. Sự tăng trưởng của các mô hình deep learning đi kèm với các vấn đề liên quan đến mức tiêu thụ năng lượng đáng kể của chúng, cả trong quá trình huấn luyện và suy luận, cũng như khả năng mở rộng của chúng. Mặc dù một số công trình dựa trên các hệ thống vật lý phi thông thường, chẳng hạn như các framework dựa trên sóng, đã giải quyết vấn đề hiệu quả năng lượng trong giai đoạn suy luận, việc huấn luyện hiệu quả các mô hình deep learning vẫn còn khó nắm bắt. Cho đến nay, việc huấn luyện các mô hình deep learning kỹ thuật số chủ yếu dựa vào lan truyền ngược, không phù hợp cho việc triển khai vật lý vì nó đòi hỏi kiến thức hoàn hảo về tính toán được thực hiện trong cái gọi là lượt truyền tiến của mạng nơ-ron. Ở đây, chúng tôi giải quyết vấn đề này bằng cách đề xuất một kiến trúc mạng nơ-ron sâu đơn giản được tăng cường bởi một thuật toán học tập hợp lý về mặt sinh học, được gọi là "huấn luyện tiến-tiến không cần mô hình". Con đường mới này cho phép huấn luyện trực tiếp các mạng nơ-ron vật lý sâu bao gồm các lớp của các hệ thống phi tuyến vật lý tùy ý, mà không cần kiến thức chi tiết về tính chất của các lớp vật lý phi tuyến. Chúng tôi chỉ ra rằng phương pháp của chúng tôi vượt trội hơn các phương pháp huấn luyện nhận thức phần cứng tiên tiến bằng cách cải thiện tốc độ huấn luyện, giảm tính toán kỹ thuật số và giảm tiêu thụ năng lượng trong các hệ thống vật lý, đặc biệt là quang học. Chúng tôi chứng minh tính mạnh mẽ và khả năng thích ứng của phương pháp được đề xuất, ngay cả trong các hệ thống bị nhiễu loạn ngoài động hoặc không thể dự đoán được nơi mà tất cả các sơ đồ nhận thức phần cứng khác đều thất bại. Để thể hiện tính phổ quát của cách tiếp cận, chúng tôi huấn luyện các mạng nơ-ron vật lý dựa trên sóng đa dạng khác nhau về hiện tượng sóng cơ bản và loại phi tuyến tính mà chúng sử dụng, để thực hiện các tác vụ phân loại nguyên âm và hình ảnh một cách thực nghiệm. Công trình này mở đường cho các mục tiêu đầy tham vọng của việc huấn luyện lai các mạng nơ-ron vật lý khổng lồ, có thể mang lại tốc độ cao và tiêu thụ năng lượng thấp hơn không chỉ cho suy luận mà cả trong giai đoạn huấn luyện.

## Giới thiệu

Deep learning đã nổi lên như một công nghệ đột phá với thành công vượt bậc trong nhiều lĩnh vực khác nhau như thị giác, xử lý ngôn ngữ tự nhiên (NLP) và nhận dạng giọng nói. Mặc dù các thuật toán này cố gắng bắt chước hoạt động của não người, chúng về cơ bản được thực thi ở cấp độ phần mềm sử dụng phần cứng máy tính von Neumann truyền thống. Tuy nhiên, các mạng nơ-ron nhân tạo (ANN) dựa trên máy tính kỹ thuật số hiện đang gặp phải những thách thức về tiêu thụ năng lượng và tốc độ xử lý. Một ví dụ về việc sử dụng năng lượng đáng kể trong việc huấn luyện các mô hình ngôn ngữ có thể được thấy trong trường hợp GPT-3, có 175 tỷ tham số và đòi hỏi 1,3 GWh điện trong quá trình huấn luyện. Kết quả là, các nhà nghiên cứu ngày càng khám phá việc triển khai ANN trên các nền tảng vật lý thay thế, bao gồm nhưng không giới hạn ở quang học, spintronics, thiết bị nanoelectronic và phần cứng photonic, cũng như các hệ thống âm thanh. Hiện tại, hai phương pháp chính được sử dụng chủ yếu. Phương pháp đầu tiên đòi hỏi việc thiết kế phần cứng thực hiện các phép biến đổi toán học đã được huấn luyện thông qua sự đồng hình toán học nghiêm ngặt từng thao tác, chủ yếu nhằm vào giai đoạn suy luận của deep learning. Danh mục thứ hai, được biết đến với tên gọi Mạng nơ-ron Vật lý sâu (PNN), liên quan đến việc huấn luyện các phép biến đổi vật lý của phần cứng trực tiếp để thực hiện các tính toán mong muốn. PNN mang lại tiềm năng tạo ra phần cứng mạng nơ-ron có khả năng mở rộng hơn, tiết kiệm năng lượng hơn và nhanh hơn bằng cách tận dụng các phép biến đổi vật lý và bỏ qua sự phân chia phần mềm-phần cứng thông thường.

Tương tự như deep learning kỹ thuật số, việc tăng độ sâu của các mạng vật lý (PNN sâu) có tiềm năng lớn để tăng cường hiệu suất vì nó dẫn đến sự mở rộng theo cấp số nhân trong khả năng biểu đạt của mạng. Cho đến nay, việc huấn luyện PNN chủ yếu dựa vào một phương pháp gọi là lan truyền ngược (BP), đã rất thành công trong việc huấn luyện các ANN kỹ thuật số. Tuy nhiên, có một số lý do tại sao BP không phải là lựa chọn phù hợp cho PNN, một trong số đó là sự phức tạp và thiếu khả năng mở rộng trong việc triển khai vật lý các thao tác BP trong phần cứng. Ví dụ, trong, các tác giả sử dụng phương pháp biến phụ trợ để triển khai thực nghiệm BP trong các mạng nơ-ron photonic được giới hạn ở PNN không tổn hao và có tính thuận nghịch. Ngoài ra, phương pháp của họ đòi hỏi ba vòng truyền ánh sáng, từ trái sang phải hoặc từ phải sang trái, trong toàn bộ PNN, điều này vẫn không thể đạt được trong phần lớn các thiết lập PNN. Hầu hết các đề xuất cho PNN thực hiện tính toán BP trên máy tính bên ngoài sử dụng bản sao kỹ thuật số của hệ thống vật lý, thường được gọi là huấn luyện in-silico. Điều này thường đi kèm với chi phí về tốc độ và tăng tiêu thụ năng lượng trong quá trình huấn luyện. Ngoài ra, mô hình có thể không đại diện chính xác cho hệ thống vật lý thực tế, có thể dẫn đến khoảng cách mô phỏng-thực tế tiềm ẩn và dự đoán thời gian suy luận không trung thực. Công trình gần đây đã đạt được một số tiến bộ trong việc giải quyết những vấn đề này. Phương pháp huấn luyện nhận thức vật lý dựa trên BP (PA-BP) là framework huấn luyện tiên tiến hiện tại giúp tránh được một số vấn đề của các phương pháp in-silico. Tuy nhiên, gót chân Achilles của PA-BP là nó vẫn đòi hỏi một mô hình kỹ thuật số có thể phân biệt cho lượt truyền ngược. Điều này áp đặt một số giới hạn về các trường hợp sử dụng của PA-BP, chẳng hạn như tốc độ huấn luyện chậm và tiêu thụ năng lượng cao do lượt truyền ngược kỹ thuật số và nhu cầu về bộ nhớ bổ sung để chứa mô hình ngược của PNN trên máy tính kỹ thuật số. Hơn nữa, như sẽ trở nên rõ ràng sau này, trong trường hợp hệ thống vật lý trải qua các nhiễu loạn mạnh, việc tái sử dụng các PNN được huấn luyện bằng PA-BP, hoặc thậm chí các phiên bản được tinh chỉnh của chúng có thể khá khó khăn và trong một số trường hợp vô ích, đòi hỏi huấn luyện mô hình từ đầu.

Một nhược điểm đáng kể khác của BP là sự phụ thuộc vào việc có kiến thức hoàn chỉnh về đồ thị tính toán được thực hiện trong lượt truyền tiến để tính toán chính xác các đạo hàm. Khi một hộp đen được chèn vào lượt truyền tiến, BP trở nên không thể thực hiện. Do đó, các nhà nghiên cứu đang tìm kiếm các phương pháp huấn luyện thay thế cho PNN. Ví dụ, một cách tiếp cận đã được khám phá gần đây để huấn luyện các mạng vật lý là phương pháp Căn chỉnh Phản hồi Trực tiếp tăng cường (DFA), nhằm tránh nhu cầu về một mô hình kỹ thuật số có thể phân biệt. Tuy nhiên, phương pháp này chỉ tương thích với một số mạng vật lý nhất định nơi các lớp phi tuyến và tuyến tính có thể được tách biệt. Hơn nữa, việc xác định dạng phi tuyến tính cho PNN thông qua các thủ tục tối ưu hóa vẫn là một thách thức đang diễn ra.

Ở đây, chúng tôi đề xuất một kiến trúc PNN đơn giản và tương thích với vật lý được tăng cường bởi một thuật toán học tập hợp lý về mặt sinh học, gọi là huấn luyện tiến-tiến không cần mô hình (MF-FF). Phương pháp được đề xuất cho phép huấn luyện trực tiếp các PNN tùy ý cục bộ mà không cần biết các lớp vật lý phi tuyến và huấn luyện mô hình song sinh kỹ thuật số. Theo hiểu biết tốt nhất của chúng tôi, đây là công trình đầu tiên chứng minh huấn luyện PNN không cần BP giúp tránh được tất cả các thách thức liên quan đến việc thực hiện phần cứng của BP. Trong phương pháp học tập đối lập không cần BP này, lượt truyền ngược tiêu chuẩn, thường được thực hiện bởi máy tính kỹ thuật số, được thay thế bằng một lượt truyền tiến duy nhất qua hệ thống vật lý. Sự thay thế này có thể cải thiện đáng kể tốc độ huấn luyện so với framework huấn luyện nhận thức phần cứng khác, giảm tính toán kỹ thuật số và sử dụng bộ nhớ, và giảm tiêu thụ năng lượng trong giai đoạn huấn luyện của PNN dựa trên sóng. Trong công trình này, chúng tôi so sánh framework học tập của chúng tôi với các sơ đồ huấn luyện nhận thức vật lý tiên tiến được đề xuất trong tài liệu, tức là các phương pháp in-silico và lan truyền ngược. Chúng tôi chỉ ra tính mạnh mẽ và khả năng thích ứng của phương pháp được đề xuất so với các sơ đồ tương tự, ngay cả trong các hệ thống bị nhiễu loạn ngoài không thể dự đoán. Để thể hiện tính phổ quát của cách tiếp cận, chúng tôi thực hiện phân loại nguyên âm và hình ảnh thực nghiệm bằng cách sử dụng ba hệ thống dựa trên sóng khác nhau về hiện tượng sóng cơ bản và loại phi tuyến tính liên quan. Ví dụ đầu tiên của chúng tôi bao gồm một khoang âm thanh hỗn loạn được triển khai với các bộ tán xạ phi tuyến. Ví dụ thứ hai là một khoang vi sóng hỗn loạn có hàm truyền được tham số hóa lớn bởi một metasurface có thể lập trình với phi tuyến tính cấu trúc. Ví dụ thứ ba của chúng tôi là một sợi quang đa modal với phi tuyến tính đọc. Cách tiếp cận của chúng tôi tạo ra các bộ phân loại thứ bậc có độ chính xác cao sử dụng các phép biến đổi vật lý riêng biệt của mỗi hệ thống và cung cấp con đường để tăng cường đáng kể hiệu quả năng lượng và tốc độ của deep learning không chỉ trong quá trình suy luận mà cả trong giai đoạn huấn luyện.

## Huấn luyện tiến-tiến không cần mô hình

Hình 1a cho thấy một PNN sâu đơn giản và tương thích với vật lý bao gồm N bộ biến đổi dữ liệu vật lý phi tuyến được tăng cường bởi các phép nhân tuyến tính có thể huấn luyện. Mỗi bộ biến đổi dữ liệu vật lý phi tuyến thực hiện ánh xạ phi tuyến giữa không gian đầu vào và đầu ra "một cách dễ dàng", tiếp theo là việc sử dụng phép nhân tuyến tính có thể huấn luyện được tăng cường để phân loại các lớp riêng biệt thông qua thuật toán huấn luyện cục bộ và đối lập. Định hướng của các hoạt động nơ-ron, đầu ra của mỗi lớp, được truyền đến lớp tiếp theo. Lớp tiếp theo sau đó thực hiện cùng một quá trình theo cấp bậc trên đầu ra của lớp trước. Kiến trúc này có một số điểm tương đồng với các hệ thống Máy tính Hồ chứa sâu (deep-RC) thông thường. Tuy nhiên, ở đây tất cả các phép nhân tuyến tính được tăng cường đều được huấn luyện, trái ngược với deep-RC truyền thống nơi chỉ lớp cuối cùng được huấn luyện. Nếu các phép biến đổi vật lý phi tuyến có một số dạng bộ nhớ, mạng có thể được phân loại như một deep-RC có thể huấn luyện. Trong số các cách tiếp cận học tập đối lập khác nhau, thuật toán tiến-tiến, lấy cảm hứng từ máy Boltzmann, gần đây đã được Geoffrey Hinton đề xuất và đã trải qua cải tiến thêm thông qua một số đề xuất trong khoa học máy tính. Ở đây, chúng tôi triển khai phiên bản không cần mô hình của thuật toán tiến-tiến, cho kiến trúc dựa trên PNN nói trên.

Mỗi hệ thống vật lý phi tuyến thực hiện một phép biến đổi phi tuyến trên dữ liệu đầu vào, có thể được biểu diễn như h(l)=f(l)N(W(l)px(l)), trong đó x(l), W(l)p và f(l)N tương ứng với các đầu vào vật lý (ví dụ: cường độ quang, điện áp điện, rung động), các kết nối vật lý (ví dụ: kết nối quang, điện hoặc cơ học) trong hệ thống vật lý, và phi tuyến tính vật lý (ví dụ: hiệu ứng phi tuyến quang, từ hoặc cơ học) trong lớp l, tương ứng. Thực vậy, W(l)p và f(l)N biểu thị thao tác trộn và kernel phi tuyến của hệ thống vật lý thứ l. Sau đó, đầu ra của lớp l có thể được biểu diễn như phép nhân của h(l) với ma trận trọng số có thể huấn luyện được tăng cường W(l)t, y(l)=W(l)th(l). Các phép nhân ma trận có thể huấn luyện như vậy có thể được thực hiện thông qua các hệ thống kỹ thuật số hoặc vật lý, ví dụ sử dụng Giao thoa kế Mach-Zehnder (MZI) photonic tích hợp, Bộ điều chế Ánh sáng Không gian (SLM) trong quang học. Mục tiêu ở đây là huấn luyện W(l)t cục bộ. Thay vì một lượt truyền tiến và ngược, ở đây chúng tôi sử dụng hai lượt truyền tiến vật lý: một lượt truyền tiến dương và một lượt truyền tiến âm qua các hệ thống vật lý, mỗi lượt chạy trên các đầu vào vật lý khác nhau. Lượt truyền vật lý dương, y(l)pos=W(l)tf(l)N(W(l)px(l)pos), sử dụng các đầu vào dương bao gồm tập dữ liệu đầu vào và nhãn chính xác, trong khi lượt truyền vật lý âm, y(l)neg=W(l)tf(l)N(W(l)px(l)neg), sử dụng các đầu vào âm bao gồm tập dữ liệu đầu vào và nhãn không chính xác (xem Hình 1a). Trong mỗi lớp, chúng tôi tính toán cái gọi là hàm "goodness", được định nghĩa là tổng của các hoạt động bình phương cho các lượt truyền vật lý dương và âm. Ví dụ, trong các hệ thống vật lý như quang học, các hoạt động bình phương tương ứng với cường độ quang trên camera CCD. Cuối cùng, cho mỗi lớp l, W(l)t được huấn luyện bằng cách tối thiểu hóa hàm mất mát sau đây:

L(l)=log(1+exp(–θ∑j y(l)pos,j² – ∑j y(l)neg,j²))

trong đó θ là một hệ số tỷ lệ. Trong giai đoạn suy luận, chúng tôi nhập một nhãn cụ thể vào PNN và tích lũy các giá trị goodness cho tất cả các lớp. Quá trình này được lặp lại cho mỗi nhãn riêng biệt. Nhãn có giá trị goodness tích lũy cao nhất sau đó được chọn làm đầu ra (xem phần bổ sung S2 để biết thêm chi tiết). Phương pháp được đề xuất cũng có khả năng tích hợp các hệ thống hoặc thành phần vật lý không khả vi giữa các lớp.

## Các PNN đa dạng cho phân loại nguyên âm và hình ảnh

Trong Hình 1, chúng tôi trình bày ba bộ phân loại PNN sâu cho tác vụ phân loại nguyên âm và chữ số viết tay Mnist (Cơ sở dữ liệu Tiêu chuẩn và Công nghệ Quốc gia Sửa đổi), dựa trên ba hệ thống vật lý riêng biệt. Mặc dù đã có những đề xuất khám phá máy tính tương tự dựa trên sóng cho các phép toán tuyến tính như nhân và tích chập, điều quan trọng cần lưu ý là PNN đòi hỏi phi tuyến tính để xử lý hiệu quả một loạt rộng các tác vụ học tập. Những tác vụ này bao gồm hồi quy và phân loại, đòi hỏi các phép toán phi tuyến để có hiệu suất chính xác. Chúng tôi xem xét ba hệ thống vật lý dựa trên sóng, mỗi hệ thống có nguồn gốc độc đáo của phi tuyến tính vật lý và hiện tượng sóng cơ bản, làm nổi bật tính đa dạng của các mạng vật lý có thể được sử dụng. Chúng tôi tận dụng việc tán xạ nhiều lần được tạo ra bởi môi trường rối loạn trong các hệ thống vật lý này (khoang hỗn loạn và sợi đa modal) để tận dụng quá trình trộn. Ngoài việc cung cấp việc trộn tuyến tính cần thiết, nó cũng giúp tăng cường phi tuyến tính tổng thể.

### Khoang Hỗn loạn Âm thanh với Bộ tán xạ Phi tuyến

Trong âm thanh học, một khoang đa modal chứa không khí bao gồm nhiều meta-tán xạ phi tuyến được đặt ngẫu nhiên trên thành trên của khoang và nhiều bộ tán xạ cứng bên trong khoang được sử dụng (vật liệu và phương pháp, phần bổ sung S3). Các meta-tán xạ phi tuyến được thiết kế dựa trên chiến lược điều khiển chủ động. Ở đây, dữ liệu dương và âm được mã hóa vào biên độ của mỗi thành phần tần số tạo thành các dạng sóng kích thích, sau đó được tiêm vào hệ thống phi tuyến thông qua các loa được đặt ở phía bên phải của khoang. Đầu ra của hệ thống vật lý được đo bằng các micro bên dưới các meta-tán xạ. Chúng tôi điều tra hiệu suất phân loại nguyên âm của âm thanh-PNN hai lớp (xem Hình 2a).

Để so sánh kết quả của MF-FF với BP lý tưởng và huấn luyện in-silico, chúng tôi mô hình hóa chính xác lượt truyền tiến của âm thanh-PPN bằng một mạng nơ-ron kỹ thuật số (xem phần bổ sung S3). Khi âm thanh-PNN được huấn luyện bằng MF-FF, nó thực hiện tác vụ phân loại với độ chính xác train và test tương ứng là 97,62% và 94,23% (xem Hình 2d-f). Hình 2c cho thấy so sánh kết quả phân loại thu được cho MF-FF, BP lý tưởng và huấn luyện in-silico. Một biểu diễn trực quan sơ đồ của các phương pháp nói trên được cung cấp phía trên Hình 2c. So sánh hoàn chỉnh giữa các phương pháp huấn luyện dựa trên phần cứng khác nhau được cung cấp trong phần bổ sung S2.

Như được chứng minh bởi Hình 2c, huấn luyện in-silico hoạt động kém, chỉ đạt độ chính xác phân loại nguyên âm tối đa ~60%. Khi có khoảng cách giữa thực tế và mô phỏng của một hệ thống vật lý (gọi là khoảng cách thực tế-mô phỏng), độ chính xác của suy luận sẽ giảm. Ngược lại, MF-FF thành công trong việc huấn luyện chính xác âm thanh-PNN, hoạt động tương tự như thuật toán BP lý tưởng được sử dụng làm baseline. Lợi thế chính của MF-FF xuất phát từ việc thực hiện cả hai lượt truyền tiến thông qua phần cứng vật lý, thay vì mô phỏng.

### Khoang Hỗn loạn Vi sóng được Tham số hóa Lớn với Phi tuyến tính Cấu trúc

Trong chế độ vi sóng, chúng tôi tận dụng "phi tuyến tính cấu trúc" sao cho chúng tôi có thể triển khai các phép toán toán học phi tuyến ở mức công suất thấp với một hệ thống tán xạ tuyến tính. Điểm khởi đầu của chúng tôi là một vây kim loại có hình dạng không đều về điện với sự chồng chéo modal mạnh. Nó được kết nối thông qua hai bộ chuyển đổi coax-to-waveguide với hai kênh tán xạ tiệm cận, và hàm truyền giữa hai kênh này có thể được đo bằng thiết bị tiêu chuẩn như bộ phân tích mạng vector. Sau đó chúng tôi tham số hóa lớn khoang này bằng cách che một trong các thành của nó bằng một metasurface có thể lập trình. Đối với mỗi meta-atom và mỗi phân cực, chúng tôi có thể cấu hình riêng lẻ các điều kiện biên cục bộ của khoang với độ chính xác 1-bit (hai trạng thái có thể). Thiết lập của chúng tôi được hiển thị trong Hình 3(b) và rất tương tự với một thiết lập đã được sử dụng gần đây để triển khai với độ trung thực cao và khả năng lập trình lại tại chỗ các hàm truyền tuyến tính mong muốn để phân biệt tín hiệu và định tuyến. Tuy nhiên, trong công trình hiện tại, chúng tôi tìm kiếm một ánh xạ phi tuyến. Do đó, chúng tôi định nghĩa cấu hình metasurface là đầu vào và hàm truyền là đầu ra của phép toán toán học của chúng tôi. Thực vậy, mối quan hệ này nói chung là phi tuyến do sự kết nối lẫn nhau giữa các meta-atom gây ra bởi sự gần gũi của chúng và quan trọng hơn là sự phản hồi. Trong khi công trình trước đó trong Ref. đã tìm cách hạn chế sự phản hồi để triển khai một phép biến đổi tuyến tính với cấu hình metasurface là đầu vào và hàm truyền là đầu ra, ở đây chúng tôi cố ý tìm cách tối đa hóa sự phản hồi để tăng cường phi tuyến tính (được giải thích thêm trong phần bổ sung S4). Ngẫu nhiên, loại phi tuyến tính cấu trúc do phản hồi này gây ra gần đây cũng đã được chuyển đổi sang lĩnh vực quang học.

Chúng tôi nhóm ngẫu nhiên 152 bậc tự do của metasurface có thể lập trình thành 40 macro-pixel vì phép toán toán học của chúng tôi đòi hỏi 40 đầu vào. Chúng tôi định nghĩa đầu ra của phép toán toán học là cường độ hàm truyền tại hai mươi tần số không tương quan trong băng thông hoạt động của metasurface có thể lập trình (400 MHz xung quanh 5,2 GHz). Lưu ý rằng, ngoài phi tuyến tính cấu trúc, chúng tôi do đó thêm phi tuyến tính đọc bằng cách làm việc với cường độ hàm truyền. Để đánh giá linh hoạt cách tiếp cận được đề xuất, dựa trên 50000 cặp cấu hình metasurface ngẫu nhiên và hàm truyền tương ứng được đo thực nghiệm, chúng tôi học một mô hình tiến thay thế kỹ thuật số của ánh xạ cường độ hàm truyền từ cấu hình (xem phần bổ sung S4). Sau đó, chúng tôi xây dựng vi sóng-PNN ba lớp được hiển thị trong Hình 3a và huấn luyện nó theo MF-FF. Việc huấn luyện hội tụ sau khoảng 20 epoch và độ chính xác phân loại đạt được trên dữ liệu test chưa thấy đạt khoảng 96% (xem Hình 3c-e).

### Sợi Quang Đa modal với Phi tuyến tính Đọc

Trong phần quang học, chúng tôi sử dụng một hệ thống quang học bao gồm một SLM, một môi trường tán xạ gồm một sợi đa modal có chỉ số bước (MMF) và một camera CMOS (xem Hình 1d, vật liệu và phương pháp). Trong thiết lập này, các tập dữ liệu dương và âm được mã hóa vào SLM, và sau khi đi qua MMF, cường độ quang thu được được đo trên camera. Hệ thống quang vật lý thực hiện một phép biến đổi không gian-thời gian phức tạp. Phép biến đổi này liên quan đến việc truyền các xung laser được điều chế không gian qua một MMF. Việc truyền một xung cực ngắn bên trong MMF là một quá trình rất phức tạp liên quan đến các tương tác không gian và thời gian của sóng điện từ được kết nối với hàng trăm chế độ truyền khác nhau. Mặc dù phép biến đổi này là tuyến tính trong miền phức, quá trình trở nên phi tuyến do dữ liệu được mã hóa vào pha (SLM) và việc đo lường cường độ bình phương tiếp theo trên camera. Ở đây, chúng tôi sử dụng quang học-PNN hai lớp để thực hiện các tác vụ phân loại trên hai tập dữ liệu khác nhau: Nguyên âm và Mnist (xem Hình 4 và phần bổ sung S5 để biết thêm chi tiết). Quang học-PNN đạt được hiệu suất phân loại ấn tượng trên cả hai tập dữ liệu nguyên âm và Mnist. Chúng tôi đạt được độ chính xác 98,93% và 96,73% trên tập dữ liệu nguyên âm huấn luyện và test, tương ứng. Chỉ sử dụng quang học-PNN hai lớp, mô hình đạt được độ chính xác 99,56% và 97,21% trên tập dữ liệu Mnist huấn luyện và test (xem kết quả tương ứng trong Hình 4c-h). Những kết quả này chứng minh khả năng chuyển đổi từ một bộ xử lý kỹ thuật số đắt tiền sang một bộ xử lý vật lý-kỹ thuật số lai nhanh, tiết kiệm năng lượng, thể hiện tiềm năng tối ưu hóa cả hiệu suất và hiệu quả năng lượng trong các ứng dụng machine learning.

Sau khi đăng phiên bản đầu tiên của công trình này trên arXiv, chúng tôi nhận thức được rằng một ý tưởng và thí nghiệm liên quan được thể hiện cho quang học đang được theo đuổi bởi một nhóm khác, xem preprint tại.

## Học tập Thích ứng Thời gian Thực

Bây giờ chúng tôi muốn chỉ ra tính mạnh mẽ vượt trội của MF-FF trong bối cảnh học tập thời gian thực và thích ứng, nơi bộ biến đổi dữ liệu vật lý có thể trải qua các thay đổi do động lực học chậm của hệ thống vật lý trong thời gian chạy hoặc các nhiễu loạn cứng bên ngoài. Hãy xem xét một quang học-PNN sâu với sáu lớp, như được mô tả trong Hình S6a, đã được huấn luyện trên tập dữ liệu nguyên âm và hiện đang trong giai đoạn suy luận. Hàm biến đổi của mỗi hệ thống vật lý là f0(θ), trong đó θ là đầu vào vật lý. Chúng tôi làm nhiễu loạn các hệ thống vật lý tại một thời điểm cụ thể (các ví dụ về những nhiễu loạn như vậy bao gồm thay đổi trong trạng thái MMF hoặc vị trí của thấu kính hoặc mặt nạ, v.v.), dẫn đến sự thay đổi trong hàm biến đổi của mỗi hệ thống vật lý từ f0(θ) thành fp(θ) (xem Hình S6b). Chúng tôi đơn giản làm nhiễu loạn ma trận truyền của thiết lập quang học bằng cách thêm nhiễu Gauss với trung bình μ và độ lệch chuẩn σ để mô phỏng tình huống này. Như chúng tôi quan sát trong Hình S6d, độ chính xác test giảm như mong đợi sau khi áp dụng nhiễu loạn. Câu hỏi bây giờ là liệu phương pháp huấn luyện có thể khôi phục độ chính xác bằng cách huấn luyện lại quang học-PNN sau một số epoch hay không. Chúng tôi so sánh kết quả của chúng tôi với phương pháp PA-BP sử dụng mô hình kỹ thuật số cho lượt truyền ngược và hệ thống vật lý cho lượt truyền tiến. Như được hiển thị trong Hình S6c, PA-BP gặp khó khăn trong việc khôi phục độ chính xác với cường độ nhiễu loạn tăng. Ví dụ, độ chính xác test dao động xung quanh 55% cho một nhiễu loạn nhỏ (các chấm đỏ trong Hình S6c) và trở nên tệ hơn với các nhiễu loạn mạnh hơn. Ngược lại, MF-FF được đề xuất có thể dễ dàng khôi phục độ chính xác sau một vài epoch, bất kể cường độ của nhiễu loạn được áp dụng. (xem Hình S6d).

Khả năng thích ứng nổi bật này nhờ vào thực tế rằng MF-FF thực hiện cả hai lượt truyền tiến thông qua phần cứng vật lý, thay vì các mô hình kỹ thuật số. Ngược lại, phương pháp PA-BP sử dụng một mô hình kỹ thuật số trở nên hoàn toàn không chính xác sau nhiễu loạn cứng, đòi hỏi huấn luyện lại với một tập dữ liệu mới và lãng phí năng lượng. Nghiên cứu này làm nổi bật tính mạnh mẽ và khả năng thích ứng của mô hình được đề xuất, ngay cả trong các môi trường động hoặc không thể dự đoán.

## Thảo luận

Do sự tăng trưởng chưa từng có về quy mô của ANN, bao gồm các mô hình như GPT 4 với khoảng hàng trăm tỷ tham số, chi phí của cả giai đoạn huấn luyện và suy luận của các mạng này đã tăng theo cấp số nhân. Việc huấn luyện các ANN khổng lồ như vậy đặc biệt cực kỳ đắt đỏ và tốn thời gian, với thời gian huấn luyện kéo dài đến vài tháng. Phần cứng chuyên dụng như PNN có tiềm năng giảm drastically những chi phí này. Một vài phương pháp đã được đề xuất để huấn luyện PNN, nhưng tất cả đều gặp phải các vấn đề như sự không khớp giữa mô hình tiến và hệ thống vật lý hoặc các vấn đề về tính mạnh mẽ. Điều này là do các phương pháp này thực hiện toàn bộ lượt truyền ngược thông qua máy tính kỹ thuật số trong quá trình huấn luyện, liên quan đến một mô hình kỹ thuật số trong PA-BP hoặc mô phỏng số trong huấn luyện in-silico, có thể cản trở hiệu quả của chúng trong giai đoạn huấn luyện. MF-FF cho phép các lượt truyền tiến thông qua các hệ thống vật lý, dẫn đến sự tăng tốc đáng kể không chỉ trong quá trình suy luận mà cả trong giai đoạn huấn luyện. Ngoài ra, một lợi thế nổi bật của huấn luyện MF-FF là tính mạnh mẽ đối với nhiễu loạn bên ngoài. Chúng tôi quan sát thấy rằng huấn luyện MF-FF không chỉ vượt trội so với huấn luyện in-silico mà còn so với phương pháp PA-BP tiên tiến hiện tại. Khoảng cách hiệu suất giữa phương pháp của chúng tôi và PA-BP tiếp tục mở rộng khi độ sâu của NN tăng. Điều này là do trong huấn luyện PA-BP, sự không khớp giữa gradient của các hệ thống không bị nhiễu loạn và bị nhiễu loạn tích lũy theo độ sâu của ANN. Do đó, một mạng càng có nhiều lớp thì càng nhạy cảm với nhiễu loạn bên ngoài. Điều này trái ngược với framework được huấn luyện MF-FF trong đó mỗi lớp của mạng được huấn luyện riêng biệt mà không sử dụng mô hình hoặc phụ thuộc trực tiếp vào các lớp khác như yêu cầu cho BP.

Tài liệu tham khảo gần đây đã tiết lộ hiệu quả đặc biệt của các mô hình transformer quang học trong giai đoạn "suy luận" (đạt được lợi thế hiệu quả năng lượng >8.000× so với các bộ xử lý điện tử-kỹ thuật số tiên tiến). Phương pháp huấn luyện được đề xuất trong bài báo này đại diện cho một ứng cử viên khả thi để "huấn luyện" các mô hình transformer quang học như vậy, cho phép tiềm năng đạt được các lợi thế về hiệu quả năng lượng và tốc độ. Chúng tôi nghiên cứu thêm tiềm năng của PNN về mặt giảm tiêu thụ năng lượng và cải thiện tốc độ máy tính so với các sơ đồ huấn luyện/suy luận kỹ thuật số của ANN trong Phần S6 của tài liệu bổ sung.

Chúng tôi kết luận rằng mặc dù PNN có tiềm năng cải thiện tốc độ và tiêu thụ năng lượng của các mạng nơ-ron sâu ở mức độ lớn, một số thách thức vẫn cần được giải quyết trước khi PNN có thể thay thế các đối tác kỹ thuật số của chúng. Ví dụ, vẫn chưa rõ cách một số phép toán toán học được sử dụng rộng rãi, chẳng hạn như các đơn vị chuẩn hóa, bao gồm chuẩn hóa lớp/batch, có thể được triển khai trong phần cứng. Thứ hai, làm thế nào các hệ thống vật lý có thể được mở rộng một cách gọn gàng đến hàng tỷ tham số. Do đó, chúng ta có thể mong đợi, ít nhất là trong ngắn hạn, rằng PNN sẽ cho phép các kết hợp lai hiệu quả của huấn luyện/suy luận trong phần cứng thay vì thay thế hoàn toàn các đơn vị xử lý kỹ thuật số.

## Lời cảm ơn

A.M. và R.F. thừa nhận tài trợ từ Quỹ Khoa học Quốc gia Thụy Sĩ theo chương trình Eccellenza số 181232. P.d.H. và R.F. thừa nhận tài trợ từ chương trình ANR-SNF PRCI (dự án "MetaLearn"; ANR-22-CE93-0010-01). B.R. thừa nhận rằng tất cả các tài liệu liên quan đến thí nghiệm quang học được trình bày trong bản thảo này đã được lấy từ tài liệu đã xuất bản trước đó có sẵn công khai và được thu thập trong thời gian làm việc tại Phòng thí nghiệm Thiết bị Photonic Ứng dụng tại EPFL. Công trình này không có kết nối nào với nhà tuyển dụng hiện tại của anh ấy dưới bất kỳ hình thức nào. A.M. và M.M. cảm ơn Tiến sĩ X. Guo vì những thảo luận hữu ích.

## Đóng góp

A.M. đã hình thành ý tưởng, thiết kế động cơ tính toán và thực hiện cả mô phỏng lý thuyết và số cũng như một phần của thí nghiệm âm thanh. B.R. đã cung cấp dữ liệu quang học và giải thích các kết quả machine learning. M.M. đã thực hiện thí nghiệm âm thanh. P.d.H. đã thực hiện thí nghiệm vi sóng. R.F. đã giám sát dự án. Tất cả tác giả đều đóng góp vào việc giải thích kết quả và viết bản thảo.
