# 2405.20271.pdf
# Được chuyển đổi từ PDF sang TXT
# Đường dẫn nguồn: /home/admin88/arxiv-downloader/peft/2405.20271.pdf
# Kích thước tệp: 6695549 byte

===============================================
NỘI DUNG TỆP PDF
===============================================

--- TRANG 1 ---
ETHER : Tinh chỉnh hiệu quả các mô hình quy mô lớn bằng phản xạ siêu phẳng
Massimo Bini1 2Karsten Roth3 2Zeynep Akata2 4 5Anna Khoreva6

Tóm tắt
Tinh chỉnh tham số hiệu quả (PEFT) đã trở nên phổ biến để điều chỉnh các mô hình nền tảng cho phù hợp với yêu cầu nhiệm vụ hạ lưu trong khi vẫn duy trì khả năng tổng quát hóa của chúng. Tuy nhiên, số lượng tham số và tính toán được thêm vào để thích ứng thành công và tìm kiếm siêu tham số có thể tăng nhanh chóng, đặc biệt khi triển khai ở quy mô lớn để phục vụ nhiều yêu cầu cá nhân. Để đảm bảo thích ứng hiệu quả, tiết kiệm tham số và mạnh mẽ với siêu tham số, chúng tôi đề xuất họ biến đổi ETHER, thực hiện tinh chỉnh hiệu quả thông qua phản xạ siêu phẳng. Theo thiết kế, các biến đổi ETHER yêu cầu số lượng tham số tối thiểu, ít có khả năng làm suy giảm hiệu suất mô hình và thể hiện tính mạnh mẽ đối với lựa chọn siêu tham số và tốc độ học. Cụ thể, chúng tôi giới thiệu ETHER và phiên bản nới lỏng ETHER+, khớp hoặc vượt trội hơn các phương pháp PEFT hiện có với số tham số ít hơn đáng kể (∼10-100 lần thấp hơn LoRA hoặc OFT) trên nhiều nhiệm vụ tổng hợp hình ảnh và xử lý ngôn ngữ tự nhiên mà không cần tinh chỉnh siêu tham số tốn kém. Cuối cùng, chúng tôi điều tra sự nhấn mạnh gần đây về duy trì năng lượng siêu cầu để thích ứng và đặt ra câu hỏi về tính hữu dụng thực tế của nó. Mã nguồn có sẵn tại https://github.com/mwbini/ether .

1. Giới thiệu
Gần đây, các mô hình nền tảng quy mô lớn (Bommasani et al., 2021) đã chứng minh khả năng đa mục đích ấn tượng trên cả các nhiệm vụ sinh tạo và phân biệt (Rombach et al., 2022; Touvron et al., 2023a; OpenAI, 2023; Kirillov et al., 2023), cho thấy tính linh hoạt rộng rãi và hiệu suất mạnh mẽ khi được thích ứng thêm cho các nhiệm vụ khác nhau, chuyên biệt hơn như tuân theo hướng dẫn hoặc tổng hợp hình ảnh có kiểm soát (Zhang & Agrawala, 2023; Ruiz et al., 2022; Taori et al., 2023; Chiang et al., 2023).

Mặc dù ấn tượng, những khả năng này đi kèm với số lượng tham số tăng lên hàng tỷ (OpenAI, 2023; Podell et al., 2023a; Touvron et al., 2023b). Để cho phép thích ứng mô hình có thể chi trả và có thể mở rộng phục vụ cơ sở khách hàng lớn và đa dạng, nhiều kỹ thuật khác nhau đã được giới thiệu trong tài liệu. Chúng bao gồm từ tinh chỉnh đầy đủ (Zhao et al., 2024; Zhang et al., 2023a; Stojanovski et al., 2022) đến chỉ một vài lớp của mô hình được huấn luyện trước (Kornblith et al., 2019), nối thêm các mô-đun học tập bổ sung (Houlsby et al., 2019; Pfeiffer et al., 2020; Mou et al., 2023), và gần đây hơn là các adapter trên trọng số mạng với các biến đổi có thể học nhẹ (Qiu et al., 2023; Hu et al., 2022; Kopiczko et al., 2023; Valipour et al., 2023). Những phương pháp sau đã chứng minh đặc biệt hiệu quả, không đưa vào độ trễ suy luận, ít tham số thích ứng hơn và hiệu suất mạnh mẽ.

Về mặt khái niệm, các phương pháp này tinh chỉnh trên các tập dữ liệu nhỏ hơn để thích ứng với yêu cầu nhiệm vụ và dữ liệu hạ lưu, mà không (1) ảnh hưởng quá nhiều đến việc huấn luyện trước tốn kém và (2) gây ra sự trôi dạt khái niệm và ngữ nghĩa bằng cách ghi đè thảm khốc các trọng số được huấn luyện trước (Kirkpatrick et al., 2017; Lee et al., 2019; Lu et al., 2020; Mehta et al., 2022; Ruiz et al., 2023; Ke et al., 2023; Roth et al., 2024; Garg et al., 2024; Ibrahim et al., 2024). Việc đi trên ranh giới cho một sự cân bằng phù hợp giữa thích ứng và duy trì khả năng của mô hình nền tảng do đó tự thể hiện như một nhiệm vụ khó giải quyết, thường yêu cầu tinh chỉnh siêu tham số tốn kém như tốc độ học. Vấn đề này được thừa nhận rõ ràng trong Li et al. (2018); Chen et al. (2023a); Gouk et al. (2021) nhằm bảo tồn khoảng cách trọng số Euclidean giữa các mô hình được huấn luyện trước và tinh chỉnh, và ngầm hiểu với các cách tiếp cận lựa chọn cả tốc độ học thấp hơn (với chi phí nhiều lần lặp tinh chỉnh hơn) và bao gồm các tham số tinh chỉnh thông qua phép cộng (Qiu et al., 2023).

Cụ thể, Qiu et al. (2023) gợi ý rằng một thước đo khoảng cách Euclidean có thể không nắm bắt đầy đủ việc bảo tồn khả năng của mạng, thay vào đó đề xuất Năng lượng Siêu cầu (HE) như một thước đo thay thế. Mục tiêu kết quả sử dụng các biến đổi trực giao (OFT) cho các thay đổi trọng số nhân để kiểm soát HE. Tuy nhiên, ngay cả OFT cũng yêu cầu các lựa chọn siêu tham số cụ thể và hạn chế như tốc độ học nhỏ và khởi tạo từ ma trận đơn vị để đảm bảo bảo tồn kiến thức đầy đủ. Ngoài ra, trong khi mạnh mẽ và ổn định hơn cho tinh chỉnh trong các cài đặt sinh tạo có thể kiểm soát so với LoRA (Qiu et al., 2023), OFT đi kèm với chi phí tính toán cao do phép nhân ma trận và số lượng lớn tham số tinh chỉnh.

Trong công trình này, chúng tôi đề xuất Tinh chỉnh hiệu quả thông qua Phản xạ Siêu phẳng (ETHER) - một họ mới các biến đổi trọng số, hiệu quả về số lượng tham số trong khi bảo tồn khả năng mô hình và mạnh mẽ trong hội tụ và lựa chọn tốc độ học. Theo mặc định, các biến đổi ETHER đóng khung quá trình tinh chỉnh như một tìm kiếm các siêu phẳng phù hợp, dọc theo đó các vector trọng số có thể được phản xạ dựa trên biến đổi Householder trực giao (Householder, 1958). Điều này giữ khoảng cách đến phần tử trung tính biến đổi - ma trận đơn vị - không đổi theo cấu trúc và cải thiện tính ổn định huấn luyện trong khi giảm cơ hội làm suy giảm hiệu suất mô hình. Ngoài ra, được xây dựng từ các vector đơn, các biến đổi Householder cho phép phép nhân ma trận song song khối hiệu quả với sự đánh đổi hiệu suất tối thiểu.

Tuy nhiên, các tình huống có thể phát sinh khi hạn chế khoảng cách cứng của ETHER có thể chứng minh không tối ưu (như đối với sinh tạo hình ảnh theo chủ đề, nơi ngữ nghĩa cụ thể chủ đề tinh vi cần được giữ lại). Do đó, chúng tôi bổ sung họ ETHER với ETHER+ - một sự nới lỏng trên phương pháp ETHER mặc định. Chính xác hơn, ETHER+ bắt nguồn từ biến đổi Householder, nhưng phá vỡ các ràng buộc trực giao và khoảng cách không đổi, giới thiệu nhiều siêu phẳng có thể tương tác với một vector trọng số. Kết quả là, ETHER+ cho phép thích ứng có kiểm soát và tinh vi hơn, trong khi vẫn có khoảng cách bị chặn đến phần tử trung tính biến đổi, và duy trì lợi ích ETHER của hiệu quả tham số cao, tính ổn định huấn luyện và tính mạnh mẽ siêu tham số.

Thật vậy, trên các nhiệm vụ sinh tạo hình ảnh theo chủ đề, tổng hợp hình ảnh có kiểm soát, hiểu ngôn ngữ tự nhiên và tinh chỉnh hướng dẫn, chúng tôi thấy rằng ETHER và đặc biệt là ETHER+ khớp và vượt trội hơn các phương pháp hiện có chỉ sử dụng một vài tham số tinh chỉnh bổ sung (ví dụ 100× ít hơn OFT khi tinh chỉnh Stable Diffusion cho tổng hợp hình ảnh có kiểm soát) - tất cả trong khi thể hiện tính mạnh mẽ tốc độ học mạnh hơn so với các phương pháp khác và do đó yêu cầu tinh chỉnh siêu tham số tối thiểu để đạt được hiệu suất mạnh mẽ (xem Mục 4). Cuối cùng, chúng tôi cũng sử dụng các phát hiện điểm chuẩn thực nghiệm của chúng tôi để điều tra thêm và đặt câu hỏi về sự nhấn mạnh gần đây vào tính trực giao biến đổi và duy trì năng lượng siêu cầu (HE) (ví dụ Qiu et al. (2023)), cho thấy cách ETHER+ không trực giao có thể đạt được hiệu suất mạnh mẽ trong khi hiển thị HE tăng.

2. Công trình liên quan
Tinh chỉnh tham số hiệu quả (PEFT). PEFT của các mô hình được huấn luyện trước đã thấy các chiến lược khác nhau phát triển trong những năm qua - bắt đầu từ các giao thức tinh chỉnh và nối các mô-đun có thể học (Houlsby et al., 2019; Lester et al., 2021; Li & Liang, 2021; Pfeiffer et al., 2020; Guo et al., 2021) đến gần đây hơn là tái tham số hóa trọng số mạng với các biến đổi hiệu quả (Qiu et al., 2023; Hu et al., 2022; Kopiczko et al., 2023; Valipour et al., 2023; Zhang et al., 2023c). Những phương pháp sau đã cho thấy sự đánh đổi thuyết phục giữa chất lượng thích ứng, tham số bổ sung và độ trễ suy luận. LoRA (Hu et al., 2022) biến đổi trọng số mạng bằng cách thêm kết quả của một tích ma trận thấp hạng có thể học. Trên cơ sở LoRA, nhiều biến thể đã được đề xuất, s.a. QLora (Dettmers et al., 2023) với trọng số lượng tử hóa, AdaLoRA (Zhang et al., 2023c) với điều chỉnh hạng động, và VeRA (Kopiczko et al., 2023) với các phép chiếu ngẫu nhiên đông lạnh thấp hạng và các vector có thể huấn luyện để giảm số lượng tham số. OFT (Qiu et al., 2023) thay vào đó học nhân ma trận với các ràng buộc trực giao để duy trì năng lượng siêu cầu. Trong công trình của chúng tôi, chúng tôi sử dụng cùng một mô hình nhưng giới thiệu phản xạ siêu phẳng để có hiệu quả tham số tốt hơn và tính mạnh mẽ tốc độ học.

Kiểm soát các mô hình sinh tạo khuếch tán. Các mô hình sinh tạo dựa trên khuếch tán cho thấy sinh tạo tổng hợp mạnh mẽ (Rombach et al., 2022; Mukhopadhyay et al., 2023; Podell et al., 2023b; Karthik et al., 2023; Saharia et al., 2022). Trong số này, Gal et al. (2022); Ruiz et al. (2023) đã phổ biến sinh tạo cá nhân hóa - dạy các mô hình tạo ra các biến thể của các mẫu do người dùng cung cấp. Dựa trên DreamBooth (Ruiz et al., 2023), các công trình khác (Liu et al., 2023b; Richardson et al., 2023; Zhang et al., 2023e) đã theo sau. ControlNet (Zhang et al., 2023b) cho thấy khả năng kiểm soát mô hình thông qua các tín hiệu bên ngoài s.a. bản đồ ngữ nghĩa và độ sâu hoặc các điểm mốc khuôn mặt thông qua các lớp bổ sung với chi phí độ trễ suy luận cao hơn. Qiu et al. (2023) cho thấy khả năng kiểm soát thông qua tinh chỉnh trực tiếp với các biến đổi nhân ma trận có thể học. Công trình của chúng tôi đề xuất một cách tiếp cận thay thế, mạnh mẽ hơn và hiệu quả tham số hơn thông qua phản xạ siêu phẳng.

Tinh chỉnh hướng dẫn các mô hình ngôn ngữ. Các mô hình ngôn ngữ lớn (LLM) đã cho thấy khả năng tổng quát hóa ấn tượng trên một loạt rộng các nhiệm vụ (Zhao et al., 2023; Zhang et al., 2023d; OpenAI, 2023; Touvron et al., 2023a). Tuy nhiên, mục tiêu huấn luyện mặc định thường không khớp chính xác với yêu cầu và ý định nhiệm vụ hạ lưu. Để giải quyết sự không khớp này, Tinh chỉnh Hướng dẫn (Wang et al., 2023; Zhang et al., 2023d; Longpre et al.; Taori et al., 2023) tinh chỉnh LLM sử dụng các cặp (Hướng dẫn, Đầu ra) bổ sung để căn chỉnh rõ ràng mô hình với sở thích con người. Điều này tăng cường khả năng và khả năng kiểm soát trong khi tránh việc huấn luyện lại tốn kém (Köpf et al., 2023). Gần đây, các phương pháp dựa trên LoRA (Hu et al., 2022) đã được đề xuất để đạt được hiệu quả kiểm soát này (Dettmers et al., 2023; Xu et al., 2023; Chen et al., 2023b; Valipour et al., 2023; Kopiczko et al., 2023). Công trình này đề xuất một thay thế mạnh mẽ với hiệu quả tham số thêm và tính mạnh mẽ tốc độ học cao.

--- TRANG 2 ---

3. Phương pháp
Chúng tôi trước tiên thảo luận về PEFT dựa trên adapter trong §3.1, trước khi mô tả và động cơ sử dụng phản xạ siêu phẳng trong ETHER (§3.2). Để khuyến khích tính linh hoạt trong kiểm soát và thích ứng có thể huấn luyện, chúng tôi đề xuất một sự nới lỏng đơn giản nhưng hiệu quả ETHER+ trong §3.3. Cuối cùng, §3.4 mô tả ETHER chéo khối để cải thiện hiệu quả tính toán.

3.1. Kiến thức cơ bản
Tinh chỉnh tham số hiệu quả với Adapter. Hình thức được triển khai phổ biến nhất của PEFT với adapter là Thích ứng Thấp hạng (LoRA, Hu et al. (2022)). LoRA tham số hóa một thay đổi của trọng số được huấn luyện trước W như
(W+BA)⊺x+b
trong đó BA là tích ma trận của hai ma trận thấp hạng, tức là cho W∈Rd×f, A∈Rd×r và B∈Rr×f. Khi hạng r << min(d, f), điều này có thể giảm đáng kể các tham số tinh chỉnh cần thiết so với tinh chỉnh đầy đủ. Ngoài ra, BA có thể được hấp thụ vào W trong quá trình suy luận để tránh độ trễ bổ sung.

Tinh chỉnh trực giao (OFT). Tuy nhiên, tinh chỉnh với LoRA có thể gây ra những thay đổi trọng số đáng kể, có khả năng thảm khốc. Để đảm bảo bảo tồn tốt hơn các trọng số mô hình được huấn luyện trước, Qiu et al. (2023) đề xuất Tinh chỉnh Trực giao (OFT). Dựa trên giả thuyết rằng Năng lượng Siêu cầu (HE) cần được giữ không thay đổi để bảo tồn khả năng mô hình gốc, OFT đề xuất việc sử dụng các biến đổi trực giao nhân trên trọng số mô hình. Bằng cách duy trì các góc trọng số theo cặp, HE có thể không bị ảnh hưởng. Tuy nhiên, để hoạt động trong thực tế, Qiu et al. (2023) yêu cầu việc xây dựng ma trận trực giao Q thông qua tham số hóa Cayley Q= (I+S)(I−S)−1, trong đó S là xuyên đối xứng. Lưu ý rằng bằng cách sử dụng tham số hóa này, họ giới hạn phạm vi của các ma trận trực giao có thể đến những ma trận có định thức 1, bỏ lỡ các ma trận trực giao có định thức bằng −1. Như chúng tôi cho thấy, điều này có liên quan, vì nó loại trừ phản xạ, điều này thúc đẩy ETHER. Để làm cho OFT hiệu quả tham số hơn, ma trận trực giao Q∈Rd×d được xây dựng theo cách chéo khối, được tạo thành từ n khối nhỏ hơn Qb có kích thước d/n×d/n. Biến đổi OFT cuối cùng trên lượt truyền tiến có thể được mô tả như
(QBW)⊺x+b với QB chéo khối. Các tham số có thể huấn luyện là n ma trận Qb∈Rd/n×d/n tạo thành QB - cụ thể hơn là các ma trận Rb xây dựng các ma trận xuyên đối xứng Sb=1/2(Rb−(Rb)⊺) cho Qb. Để tinh chỉnh, Rb được khởi tạo là không, sao cho QB|0=I và do đó QB|0W=W ở đầu tinh chỉnh.

3.2. ETHER: Tinh chỉnh với Phản xạ Siêu phẳng
Về cơ bản, ETHER (Tinh chỉnh hiệu quả thông qua Phản xạ Siêu phẳng) thiết lập các biến đổi trọng số như phản xạ siêu phẳng. Các phản xạ này có thể được thu được thông qua ma trận biến đổi Householder H∈Rd×d với
H=I−2uu⊺                    (1)
với u∈Rd là vector pháp tuyến đơn vị siêu phẳng và tích ngoài tương ứng uu⊺. Phản xạ có thể được hiểu trực quan dễ dàng khi áp dụng cho vector trọng số w∈Rd:
Hw= (I−2uu⊺)w=w−2u(u⊺w).

Biến đổi H hiệu quả trừ hai lần thành phần của w được chiếu trên u, do đó phản xạ nó đối với siêu phẳng được định nghĩa bởi u (xem Hình 1). Theo cấu trúc, phản xạ siêu phẳng rất phù hợp cho tinh chỉnh hiệu quả của các mô hình được huấn luyện trước, vì chúng giữ khoảng cách đến phần tử trung tính biến đổi - ma trận đơn vị - không đổi, điều này giảm thiểu rủi ro phân kỳ từ mô hình được huấn luyện trước và suy giảm hiệu suất mô hình (xem Hình 4). Điều này có thể được dễ dàng chứng minh bằng cách tính toán chuẩn Frobenius của sự khác biệt giữa ma trận Householder H và ma trận đơn vị I:
∥H−I∥F=∥I−2uu⊺−I∥F= 2· ∥uu⊺∥F= 2    (2)

Phương trình trên tận dụng thực tế rằng đối với bất kỳ ma trận M nào
∥M∥F=√Tr(MM⊺)
và rằng với M=uu⊺ và u có độ dài đơn vị u₁²+u₂²+...+u_d²= 1, người ta có thể viết đơn giản (với (uu⊺)⊺=uu⊺)
∥uu⊺∥F=√∑ᵢ₌₁ᵈu²ᵢ= 1.

Vì quá trình tinh chỉnh đơn giản bao gồm việc tìm các hướng tối ưu của các siêu phẳng phản xạ với độ lệch bị chặn từ phần tử trung tính biến đổi, nó cho phép (i) một số lượng rất thấp các tham số bổ sung tương ứng với các vector đơn vị u, và (ii) việc sử dụng tốc độ học cao, vì rủi ro phân kỳ được giảm thiểu. Điều này cho phép tính mạnh mẽ tốc độ học chung và khuyến khích hội tụ nhanh theo mặc định, vì tốc độ học cao có thể được chọn một cách nhất quán; giảm tài nguyên tính toán cần thiết để đạt được hiệu suất tốt (ví dụ Hình 6).

Thú vị là, vì biến đổi này là trực giao (HH⊺=I), nó thuộc về phạm vi các biến đổi trực giao được thúc đẩy trong OFT (Qiu et al., 2023) từ góc độ kiểm soát Năng lượng Siêu cầu để bảo tồn tốt hơn việc huấn luyện trước mô hình. Tuy nhiên, OFT tận dụng tham số hóa Cayley của các ma trận trực giao, chỉ tạo ra các ma trận định thức 1. Theo cấu trúc, điều này loại trừ các ma trận Householder khỏi OFT, có định thức −1! Tuy nhiên, như đã lưu ý ở trên, chính trong cài đặt cụ thể này và thông qua việc sử dụng các biến đổi Householder mà hiệu quả tham số cao, duy trì huấn luyện trước mạnh mẽ và tính mạnh mẽ tốc độ học phát sinh.

Trên hết, chúng tôi điều tra thêm tầm quan trọng của việc duy trì Năng lượng Siêu cầu bằng cách tiến hành một nghiên cứu kiểm soát so sánh OFT với biến thể không trực giao của nó (Naive)¹. Các thí nghiệm của chúng tôi không cho thấy sự khác biệt đáng kể về kiểm soát và tính ổn định huấn luyện, cho thấy rằng các tính chất như vậy bắt nguồn từ cách tiếp cận tinh chỉnh nhân hơn là việc duy trì HE cơ bản, trái ngược với những hiểu biết trong Qiu et al. (2023) (xem Mục 5.3). Những phát hiện này một phần thúc đẩy việc khám phá một biến thể nới lỏng của phản xạ Householder trong phần tiếp theo 3.3, chứng minh rằng việc nới lỏng ràng buộc trực giao không chỉ duy trì hiệu suất tốt mà thậm chí có thể dẫn đến kết quả được tăng cường.

¹Naive sử dụng ma trận biến đổi chéo khối không ràng buộc NB được tạo thành từ n khối và được khởi tạo như ma trận đơn vị, tức là có cùng số tham số có thể huấn luyện và khởi tạo như ma trận biến đổi QB của OFT.

3.3. Nới lỏng tính trực giao trong ETHER
Trong khi tinh chỉnh thông qua phản xạ siêu phẳng có một số chất lượng hứa hẹn như được nêu bật ở trên, không có bữa trưa miễn phí. Cụ thể, các tình huống có thể phát sinh khi sức mạnh của biến đổi và độ lệch vốn có từ đồng nhất có thể quá lớn theo mặc định, chẳng hạn như đối với các nhiệm vụ tinh vi hơn như sinh tạo theo chủ đề (Ruiz et al., 2023). Để cho phép các biến đổi tinh vi hơn trong khi duy trì các tính chất có lợi của ETHER - hiệu quả tham số và tính mạnh mẽ tốc độ học thông qua độ lệch bị chặn từ phần tử trung tính biến đổi - chúng tôi đề xuất sự nới lỏng ETHER+
H+=I−uu⊺+vv⊺
với các vector đơn vị u, v∈Rd. Đây là một biến thể đơn giản của biến đổi Householder hiện cho phép tương tác giữa hai siêu phẳng riêng biệt (xem Hình 1). Điều này giúp kiểm soát sức mạnh biến đổi vì uu⊺ và vv⊺ có thể làm yếu hoặc thậm chí triệt tiêu lẫn nhau để trả về biến đổi đồng nhất trong giới hạn khi u=v. Ngoài ra, khoảng cách biến đổi vẫn bị chặn, vì biến thể nới lỏng H+ luôn có ∥H+−I∥F≤2, tức là
max∥H+−I∥F≤max∥H−I∥F.

Điều này theo ngay từ bất đẳng thức tam giác của chuẩn, tức là ∥vv⊺−uu⊺∥F≤ ∥vv⊺∥F+∥uu⊺∥F= 2. Do sức mạnh yếu hơn của biến đổi mới này, chúng tôi áp dụng nó cả bên trái (H+) và bên phải (H̃+) của ma trận trọng số W, sao cho lượt truyền tiến trở thành
(H+WH̃+⊺)⊺x+b.

Do đó, ETHER+ hiệu quả tận dụng một chuỗi các tương tác siêu phẳng không còn phải giữ lại độ dài để cho phép điều chỉnh trọng số tinh vi hơn trong khi vẫn giảm thiểu rủi ro phân kỳ từ mô hình được huấn luyện trước (như cũng được hiển thị ví dụ trong Hình 3, 4, 5 và 6).

3.4. ETHER hiệu quả thông qua song song khối
Trong tinh chỉnh nhân như OFT hoặc ETHER, tải tính toán thêm được đưa vào thông qua các phép nhân ma trận bổ sung. Để giảm thiểu vấn đề này, chúng tôi giới thiệu một công thức chéo khối của ETHER tương tự như OFT chéo khối được mô tả trong §3.1. Để làm điều này, chúng tôi chia nhỏ biến đổi Householder H (phương trình 1) thành biến thể chéo khối tương ứng HB:

diag(H₁···Hₙ) =I−2[û₁û₁⊺ ... ûₙûₙ⊺]

với mỗi siêu phẳng khối thứ i được tham số hóa bởi ûᵢ∈Rd/n. Tất nhiên, người ta có thể làm tương tự cho H+. Trong cả hai trường hợp, công thức chéo khối như vậy giảm chi phí tính toán H. Quan trọng hơn, mỗi khối thứ i hiện chỉ ảnh hưởng đến hàng khối thứ i tương ứng trong ma trận trọng số W. Điều này có nghĩa là chúng ta có thể chia W thành n khối con Wᵢ∈Rd/n×f, mỗi khối được thay đổi duy nhất bởi đối tác Hᵢ tương ứng. Kết quả là, biến đổi trọng số đầy đủ hiện có thể được tách thành các hoạt động cụ thể khối nhỏ hơn, giảm tổng số tính toán. Hơn nữa, các hoạt động này hiện có thể được song song hóa khối đầy đủ, tăng đáng kể tốc độ huấn luyện! Về mặt tính toán, đối với mỗi phép nhân ma trận đầy đủ giữa H và W có kích thước d×d và d×f tương ứng, d(df) phép nhân và (d−1)df phép cộng là cần thiết, chiếm O(d²f) hoạt động. Với sơ đồ song song khối của chúng tôi, chúng tôi giảm những điều này thành n phép nhân cụ thể khối d/n(d/nf) và phép cộng (d−1)/n(d/nf), dẫn đến O(d²f/n) hoạt động (xem Bảng 1).

Hơn nữa, với mỗi khối được xây dựng từ một vector đơn có chiều d/n, việc xây dựng biến đổi ETHER đảm bảo rằng tổng số tham số có thể huấn luyện vẫn không đổi cho bất kỳ số n khối nào. Điều này trái ngược với OFT chéo khối, nơi việc sử dụng số lượng khối cao hơn được giới thiệu để giảm thiểu số lượng tham số trong khi đưa vào những giảm đáng chú ý trong hiệu suất thích ứng! Thay vào đó, đối với ETHER chéo khối, chúng tôi thấy hiệu suất nhất quán qua việc tăng số lượng khối (xem Phụ lục D), cho phép dấu chân tính toán được cải thiện với giảm hiệu suất không đáng kể.

--- TRANG 3 ---

[Tôi sẽ tiếp tục dịch phần còn lại của tài liệu...]

Bảng 1. Hiệu quả tính toán tốt hơn thông qua tính chéo khối trên Phi1.5-1.3B và Llama-2-7B, với các chiều nội bộ lần lượt là 2048 và 4096. Khi số khối n tăng, hiệu quả tính toán cũng tăng, được định lượng bằng việc giảm TFLOPs cần thiết cho một lượt truyền ngược đơn (sử dụng mẫu có độ dài chuỗi dài nhất). Chiều nội bộ của mô hình càng lớn thì mức tăng hiệu quả càng lớn.

4. Tính chất thú vị của ETHER
Phần này điều tra và làm nổi bật tính chất khoảng cách bị chặn và không suy giảm của ETHER/ETHER+ một cách chi tiết hơn trong khi cung cấp hiểu biết về tính mạnh mẽ tốc độ học thuận lợi và việc sử dụng đáng tin cậy tốc độ học cao để hội tụ nhanh. Để đầy đủ, chúng tôi cũng báo cáo ở đây các so sánh với phương pháp Naive không ràng buộc, để thể hiện tốt hơn tác động của tính trực giao như được đề xuất bởi Qiu et al. (2023), và cách phương pháp của chúng tôi cung cấp tính mạnh mẽ mạnh hơn nhiều. Cuối cùng, chúng tôi bao gồm một cuộc thảo luận về hiệu quả tham số. Đối với tất cả các thí nghiệm trong phần này, vui lòng xem §5.1 để biết chi tiết triển khai có liên quan.

Bản chất không suy giảm. Bởi vì cả ETHER và ETHER+ đều bị chặn trên trong nhiễu có thể có của chúng trên các ma trận trọng số được huấn luyện trước (như được đo bằng khoảng cách đến phần tử trung tính biến đổi, ma trận đơn vị), tinh chỉnh với cả hai phương pháp sẽ đảm bảo kết quả phù hợp cho hầu hết các lựa chọn siêu tham số. Điều này được trực quan hóa dễ dàng trong Hình 3 bằng cách xem các mẫu sinh tạo sau khi nhiễu Stable Diffusion với các biến đổi được lấy mẫu ngẫu nhiên cho mỗi cách tiếp cận - OFT, ETHER và ETHER+ - tương ứng. Trong khi ETHER sử dụng biến đổi khoảng cách cố định (xem Phương trình 2) đưa vào một thay đổi đáng chú ý (nhưng vẫn giữ lại ngữ nghĩa), ETHER+ có thể có được cả kiểm soát hình ảnh tinh vi và những thay đổi ngữ nghĩa mạnh hơn. Ngược lại, các phương pháp không bị chặn như OFT làm suy giảm thảm khốc khả năng sinh tạo của mô hình khi cường độ nhiễu tăng.

Điều này dẫn đến một cài đặt sinh tạo được kiểm soát nhiều hơn cho tinh chỉnh ETHER và ETHER+. Điều này cũng được mô tả định lượng trong Hình 4, cho thấy khoảng cách giữa biến đổi đã học và trọng số đã biến đổi (tại hội tụ) đến ma trận đơn vị và trọng số được huấn luyện trước, tương ứng, như một hàm của tốc độ học. Có thể thấy, các giá trị tốc độ học lớn hơn cho tinh chỉnh OFT và Naive (OFT không có ràng buộc trực giao) dẫn đến khoảng cách cao hơn hàng độ lớn so với ETHER và ETHER+, dẫn đến suy giảm thảm khốc và sụp đổ mô hình (xem Hình 8 trong Phụ lục).

Tính mạnh mẽ tốc độ học và siêu tham số. Thực tế, bản chất không suy giảm của ETHER và ETHER+ thể hiện trong tính mạnh mẽ tốc độ học trong quá trình tinh chỉnh. Vì rủi ro phân kỳ và sụp đổ được giảm thiểu, tính ổn định huấn luyện trở nên ít phụ thuộc hơn nhiều vào lựa chọn tốc độ học. Điều này được thấy khi đánh giá hiệu suất (ví dụ mIoU cho tổng hợp hình ảnh có thể kiểm soát trong Hình 5) và hội tụ mô hình (Hình 6) so với tốc độ học. Đối với các phương pháp không phải ETHER, Hình 5 cho thấy giảm hiệu suất đáng kể cho tốc độ học cao, trong khi Hình 6 tiết lộ tốc độ hội tụ nhanh cho ETHER+ với tốc độ học bao phủ nhiều độ lớn, tổng quát hơn nhiều so với ví dụ OFT.

Điều này có nghĩa là không chỉ hiệu suất tốt có thể được đảm bảo cho hầu hết các lựa chọn tốc độ học, mà hội tụ nhanh cũng vậy, với kết quả cạnh tranh ngay sau epoch đầu tiên. Vì ETHER cũng chỉ giới thiệu một siêu tham số duy nhất, số lượng khối chéo, ảnh hưởng tối thiểu đến hiệu suất (xem §3.4), các phương pháp ETHER trở nên rất hấp dẫn cho việc sử dụng thực tế, vì nhu cầu tìm kiếm lưới và huấn luyện tốc độ học thấp thận trọng cho hiệu suất tốt (xem §1) được giảm.

Hiệu quả tham số. Cuối cùng, chúng tôi cung cấp một khám phá chi tiết hơn về hiệu quả tham số của các phương pháp dựa trên ETHER. Gọi L là số lượng lớp được tinh chỉnh, d và f là các chiều trọng số tương ứng cho W∈Rd×f. Sau đó độ phức tạp tham số cho OFT có thể được viết là O(Ld²/n) (Qiu et al., 2023) với n số khối chéo². Tương tự, đối với LoRA chúng ta có O(Lr(d+f)), trong khi đối với ETHER và ETHER+ chúng ta chỉ có O(Ld) và O(L(d+f)) tương ứng. Đối với cả LoRA và OFT, điều này bỏ qua ít nhất là nhân hạng r, hoặc một tỷ lệ có thể bậc hai. Như đã được thúc đẩy trong Mục 3, điều này dẫn đến tinh chỉnh cực kỳ hiệu quả trong khi đạt được hiệu suất tương đương hoặc mạnh hơn. Ví dụ, khi tinh chỉnh Stable Diffusion như được thực hiện ở trên, ETHER và ETHER+ sử dụng ít hơn 120 lần và 30 lần tham số so với OFT tương ứng.

²Qiu et al. (2023) lưu ý một khả năng O(Ld) nếu n=αd. Tuy nhiên, trong thực tế, việc tỷ lệ n cùng với d một cách đồng đều làm giảm không tương xứng các tham số thích ứng cho các ma trận trọng số lớn. Vì OFT khá phụ thuộc vào số lượng tham số, chúng tôi bỏ qua ước tính này.

5. Thí nghiệm điểm chuẩn
Chúng tôi trước tiên điều tra thích ứng mô hình sinh tạo trong Mục 5.1, tập trung vào tổng hợp hình ảnh theo chủ đề (§5.1.1) và tổng hợp hình ảnh có thể kiểm soát (§5.1.2) theo các công trình gần đây (Qiu et al., 2023; Liu et al., 2023a). Mục 5.2 sau đó tương ứng điều tra thích ứng mô hình ngôn ngữ, xem xét cả hiểu ngôn ngữ tự nhiên (§5.2.1) và tinh chỉnh hướng dẫn (§5.2.2). Cuối cùng, chúng tôi nghiên cứu tầm quan trọng của tính trực giao và năng lượng siêu cầu đối với hiệu suất tinh chỉnh trong Mục 5.3.

5.1. ETHER cho thích ứng mô hình sinh tạo hình ảnh
Đối với các thí nghiệm của chúng tôi trên các mô hình sinh tạo dựa trên khuếch tán, chúng tôi áp dụng các phương pháp tinh chỉnh trên Stable Diffusion-v1.5 được huấn luyện trước (Rombach et al., 2022), theo cài đặt từ OFT (Qiu et al., 2023). Các thí nghiệm của chúng tôi theo thực hành tốt nhất và lựa chọn siêu tham số cho mỗi phương pháp. Để biết chi tiết triển khai, vui lòng tham khảo Phụ lục C.

5.1.1. SINH TẠO THEO CHỦ ĐỀ
Chúng tôi trước tiên triển khai ETHER và ETHER+ trên sinh tạo theo chủ đề theo Ruiz et al. (2023); Qiu et al. (2023); tinh chỉnh mô hình sinh tạo cho mỗi trong số 30 chủ đề và 25 lời nhắc. Đối với mỗi kết hợp, chúng tôi tạo ra bốn hình ảnh, và đo chất lượng hình ảnh thông qua bộ mã hóa hình ảnh DINO (Caron et al., 2021) và CLIP (Radford et al., 2021), độ trung thực văn bản-lời nhắc thông qua bộ mã hóa văn bản CLIP, và đa dạng hình ảnh sử dụng LPIPS (Zhang et al., 2018).

Kết quả định lượng. Kết quả được hiển thị trong Bảng 2. Trên sinh tạo theo chủ đề, chúng tôi thấy hiệu suất cạnh tranh cho cả chất lượng hình ảnh, độ trung thực văn bản-lời nhắc và đa dạng hình ảnh, đặc biệt là đối với ETHER+ (ví dụ điểm DINO và CLIP-I là 0.666 so với 0.652 và 0.8 so với 0.794 cho OFT, tương ứng). Quan trọng nhất, chúng tôi đạt được hiệu suất này trong khi chỉ sử dụng một phần nhỏ tham số tinh chỉnh; với ETHER+ chỉ giới thiệu 0.4M so với 11.6M của OFT. Như đã giả thuyết trong Mục 3, đối với tinh chỉnh tinh vi, sức mạnh biến đổi của ETHER dường như quá cao để giữ lại các khái niệm ngữ nghĩa chính trong sinh tạo theo chủ đề, không đạt được chất lượng hình ảnh đối với các phương pháp khác (ví dụ cũng được mô tả định tính trong Hình 3), mặc dù đạt được đa dạng hình ảnh mạnh và độ trung thực văn bản-lời nhắc.

5.1.2. SINH TẠO HÌNH ẢNH CÓ THỂ KIỂM SOÁT
Phần này áp dụng ETHER cho khả năng kiểm soát Stable Diffusion theo Qiu et al. (2023) cho nhiệm vụ Bản đồ ngữ nghĩa thành Hình ảnh (S2I) trên ADE20K (Zhou et al., 2018). Chúng tôi sử dụng bộ mã hóa có thể huấn luyện từ ControlNet (Zhang et al., 2023b) cho tín hiệu kiểm soát và thực hiện tinh chỉnh chỉ trên trọng số Stable Diffusion. Chúng tôi báo cáo một đường cơ sở chỉ với bộ mã hóa tín hiệu kiểm soát để làm nổi bật mức tăng tương đối thông qua tinh chỉnh. Đánh giá được thực hiện trên 2000 hình ảnh được tạo từ tập xác thực sử dụng mean Intersection-over-Union (mIoU) và độ chính xác của bản đồ ngữ nghĩa trên hình ảnh được tạo bằng UperNet-101 (Xiao et al., 2018) được huấn luyện trước trên ADE20K. Cuối cùng, chúng tôi đo độ tương tự giữa hình ảnh được tạo và gốc thông qua FID (Heusel et al., 2018). Đối với OFT, chúng tôi cũng thử nghiệm tái khớp độ lớn (Qiu et al., 2023) cho một epoch bổ sung.

Kết quả định lượng. Kết quả được mô tả trong Bảng 3, và rõ ràng chứng minh kiểm soát cạnh tranh với cả ETHER và ETHER+. Không giống như sinh tạo hình ảnh theo chủ đề, chúng tôi thấy rằng ETHER hoạt động ở cùng mức với tinh chỉnh nhân OFT trong khi sử dụng hơn 100× ít tham số hơn (ví dụ 24.6 so với 24.5 mIoU của OFT với 0.1M so với 13.2M tham số). Việc giới thiệu tái khớp độ lớn vào OFT chỉ mang lại lợi ích hạn chế trong khi thêm 0.2M tham số. Tương tự như Bảng 2 cho sinh tạo hình ảnh theo chủ đề, chúng tôi thấy rằng đối với tổng hợp hình ảnh có thể kiểm soát, sự nới lỏng ETHER+ cung cấp lợi ích hiệu suất bổ sung (ví dụ 27.3 so với 24.5 mIoU và 68.1 so với 62.8 Acc so với OFT). Tính đến tính mạnh mẽ hơn (Hình 5) và hội tụ nhanh hơn (Hình 6), điều này thể hiện ETHER+ như một thay thế tinh chỉnh hấp dẫn về mặt thực tế.

[Tiếp tục với phần còn lại...]
