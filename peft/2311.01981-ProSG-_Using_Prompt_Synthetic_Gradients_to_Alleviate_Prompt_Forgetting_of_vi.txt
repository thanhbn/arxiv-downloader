# 2311.01981.pdf
# ÄÆ°á»£c chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/peft/2311.01981.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 697473 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
ProSG: Sá»­ dá»¥ng Gradient Tá»•ng há»£p Prompt Ä‘á»ƒ Giáº£m thiá»ƒu QuÃªn Prompt cá»§a 
CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Giá»‘ng RNN
Haotian Luo*Kunming Wu*Cheng Daiâ€ 
Sixian Ding Xinhao Chen
Äáº¡i há»c Tá»© XuyÃªn
haotianluo2002@gmail.com
TÃ³m táº¯t
CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ giá»‘ng RNN Ä‘ang nháº­n Ä‘Æ°á»£c sá»± quan tÃ¢m trá»Ÿ láº¡i
tá»« cÃ¡c nhÃ  nghiÃªn cá»©u NLP trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y vÃ  má»™t sá»‘ mÃ´ hÃ¬nh Ä‘Ã£
Ä‘áº¡t Ä‘Æ°á»£c tiáº¿n bá»™ Ä‘Ã¡ng ká»ƒ, cho tháº¥y hiá»‡u suáº¥t cÃ³ thá»ƒ so sÃ¡nh vá»›i cÃ¡c transformer truyá»n thá»‘ng. Tuy nhiÃªn, do báº£n cháº¥t tuáº§n hoÃ n cá»§a RNN, loáº¡i mÃ´ hÃ¬nh ngÃ´n ngá»¯ nÃ y chá»‰ cÃ³ thá»ƒ lÆ°u trá»¯ thÃ´ng tin trong má»™t táº­p há»£p cÃ¡c vector tráº¡ng thÃ¡i cÃ³ Ä‘á»™ dÃ i cá»‘ Ä‘á»‹nh.
Há»‡ quáº£ lÃ , chÃºng váº«n gáº·p pháº£i tÃ¬nh tráº¡ng hay quÃªn máº·c dÃ¹ Ä‘Ã£ cÃ³ nhiá»u cáº£i tiáº¿n vÃ  tá»‘i Æ°u hÃ³a, khi Ä‘Æ°á»£c Ä‘Æ°a ra cÃ¡c hÆ°á»›ng dáº«n hoáº·c prompt phá»©c táº¡p. VÃ¬ viá»‡c táº¡o sinh cÃ³ prompt lÃ  chá»©c nÄƒng chÃ­nh vÃ  Ä‘Æ°á»£c quan tÃ¢m nháº¥t cá»§a cÃ¡c LM, viá»‡c giáº£i quyáº¿t váº¥n Ä‘á» quÃªn trong quÃ¡ trÃ¬nh táº¡o sinh khÃ´ng nghi ngá» gÃ¬ lÃ  cÃ³ táº§m quan trá»ng cá»±c ká»³ lá»›n. Trong bÃ i bÃ¡o nÃ y, táº­p trung vÃ o viá»‡c giáº£m thiá»ƒu viá»‡c quÃªn prompt trong quÃ¡ trÃ¬nh táº¡o sinh, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t kiáº¿n trÃºc Ä‘á»ƒ dáº¡y mÃ´ hÃ¬nh ghi nhá»› prompt trong quÃ¡ trÃ¬nh táº¡o sinh báº±ng gradient tá»•ng há»£p. Äá»ƒ buá»™c mÃ´ hÃ¬nh ghi nhá»› prompt, chÃºng tÃ´i suy ra cÃ¡c tráº¡ng thÃ¡i mÃ£ hÃ³a prompt, sau Ä‘Ã³ chuyá»ƒn Ä‘á»•i nÃ³ thÃ nh viá»‡c sá»­a Ä‘á»•i tham sá»‘ mÃ´ hÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng phÃ©p xáº¥p xá»‰ gradient thá»© háº¡ng tháº¥p, tá»« Ä‘Ã³ mÃ£ hÃ³a cá»©ng prompt vÃ o cÃ¡c tham sá»‘ mÃ´ hÃ¬nh táº¡m thá»i. ChÃºng tÃ´i xÃ¢y dá»±ng má»™t bá»™ dá»¯ liá»‡u cho cÃ¡c thÃ­ nghiá»‡m, vÃ  káº¿t quáº£ Ä‘Ã£ chá»©ng minh tÃ­nh hiá»‡u quáº£ cá»§a phÆ°Æ¡ng phÃ¡p chÃºng tÃ´i trong viá»‡c giáº£i quyáº¿t váº¥n Ä‘á» hay quÃªn trong quÃ¡ trÃ¬nh táº¡o sinh cÃ³ prompt. ChÃºng tÃ´i sáº½ cÃ´ng bá»‘ toÃ n bá»™ mÃ£ nguá»“n khi Ä‘Æ°á»£c cháº¥p nháº­n.

Giá»›i thiá»‡u
Transformer (Vaswani et al. 2023) Ä‘Ã£ lÃ¢u thá»‘ng trá»‹ lÄ©nh vá»±c NLP trÃªn nhiá»u miá»n khÃ¡c nhau do hiá»‡u suáº¥t xuáº¥t sáº¯c vÃ  tÃ­nh song song trong huáº¥n luyá»‡n, nhÆ°ng Ä‘á»™ phá»©c táº¡p O(N) cho má»—i bÆ°á»›c táº¡o sinh vÃ  chi phÃ­ bá»™ nhá»› lÆ°u trá»¯ cÃ¡c cáº·p key-value lá»‹ch sá»­ lÃ m cho transformer kÃ©m hiá»‡u quáº£ hÆ¡n khi chuá»—i Ä‘áº§u ra ngÃ y cÃ ng dÃ i. Do Ä‘Ã³, cÃ¡c nhÃ  nghiÃªn cá»©u Ä‘Ã£ ná»— lá»±c ráº¥t nhiá»u Ä‘á»ƒ khÃ¡m phÃ¡ cáº¥u trÃºc hiá»‡u quáº£ hÆ¡n, vÃ­ dá»¥ nhÆ° transformer khÃ´ng cÃ³ attention (AFT) (Zhai et al. 2021). Gáº§n Ä‘Ã¢y, cÃ¡c nhÃ  nghiÃªn cá»©u Ä‘Ã£ thÃ nh cÃ´ng trong viá»‡c phÃ¡t triá»ƒn cÃ¡c mÃ´ hÃ¬nh máº¡nh máº½ cÃ³ cáº£ kháº£ nÄƒng huáº¥n luyá»‡n song song vÃ  suy luáº­n Ä‘á»‡ quy, vÃ­ dá»¥ nhÆ° RWKV (Peng et al. 2023) vÃ  RetNet (Sun et al. 2023).

CÃ¡c mÃ´ hÃ¬nh nhÆ° RWKV vÃ  RetNet káº¿t há»£p Æ°u Ä‘iá»ƒm cá»§a cáº£ transformer vÃ  RNN, Ä‘áº£m báº£o ráº±ng Ä‘á»™ phá»©c táº¡p huáº¥n luyá»‡n khÃ´ng thay Ä‘á»•i trong khi Ä‘áº¡t Ä‘Æ°á»£c má»™t quÃ¡ trÃ¬nh suy luáº­n vá»›i Ä‘á»™ phá»©c táº¡p O(N). ThÃ´ng qua cÃ¡c thÃ­ nghiá»‡m rá»™ng rÃ£i, loáº¡i mÃ´ hÃ¬nh nÃ y má»™t cÃ¡ch Ä‘Ã¡ng ngáº¡c nhiÃªn cho tháº¥y hiá»‡u suáº¥t cÃ³ thá»ƒ so sÃ¡nh vá»›i cÃ¡c transformer truyá»n thá»‘ng.

Tuy nhiÃªn, cÅ©ng chÃ­nh vÃ¬ báº£n cháº¥t tuáº§n hoÃ n cá»§a cÃ¡c mÃ´ hÃ¬nh nhÆ° váº­y, cÃ³ nghÄ©a lÃ  nÃ©n thÃ´ng tin lá»‹ch sá»­ thÃ nh má»™t táº­p há»£p cÃ¡c vector áº©n tráº¡ng thÃ¡i cÃ³ Ä‘á»™ dÃ i cá»‘ Ä‘á»‹nh, khiáº¿n mÃ´ hÃ¬nh khÃ´ng thá»ƒ giá»¯ láº¡i toÃ n bá»™ thÃ´ng tin lá»‹ch sá»­. Do Ä‘Ã³, nÃ³ cháº¯c cháº¯n sáº½ dáº«n Ä‘áº¿n má»™t loáº¡t cÃ¡c váº¥n Ä‘á» quÃªn. Láº¥y viá»‡c táº¡o sinh cÃ³ prompt lÃ m vÃ­ dá»¥, vá»›i prompt: "Viáº¿t má»™t cÃ¢u chuyá»‡n vá» Tom", káº¿t quáº£ cÃ³ thá»ƒ Ä‘Ã¡p á»©ng ká»³ vá»ng cá»§a chÃºng ta. NhÆ°ng khi prompt khÃ´ng pháº£i lÃ  má»™t hÆ°á»›ng dáº«n Ä‘Æ¡n giáº£n mÃ  bao gá»“m hai bÆ°á»›c thao tÃ¡c, viá»‡c quÃªn cÃ³ thá»ƒ xáº£y ra. VÃ­ dá»¥, vá»›i prompt: "Viáº¿t má»™t cÃ¢u chuyá»‡n vá» Tom, cÃ¢u chuyá»‡n nÃ y nÃªn cÃ³ káº¿t thÃºc bi tháº£m" sau khi mÃ´ hÃ¬nh táº¡o sinh ná»™i dung tÆ°Æ¡ng Ä‘á»‘i dÃ i, nÃ³ cÃ³ thá»ƒ quÃªn pháº§n sau cá»§a prompt Ä‘Ã£ cho, vÃ  khÃ´ng viáº¿t káº¿t thÃºc bi tháº£m nhÆ° mong Ä‘á»£i. ChÃºng tÃ´i gá»i Ä‘Ã¢y lÃ  "quÃªn prompt". ChÃºng tÃ´i sá»­ dá»¥ng thuáº­t ngá»¯ nÃ y Ä‘á»ƒ Ä‘á»‹nh nghÄ©a hiá»‡n tÆ°á»£ng mÃ  má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯, khi Ä‘Æ°á»£c Ä‘Æ°a ra má»™t prompt cá»¥ thá»ƒ Ä‘á»ƒ táº¡o sinh, hoáº·c quÃªn cÃ¡c chi tiáº¿t cá»¥ thá»ƒ cá»§a prompt hoáº·c khÃ´ng táº¡o sinh theo cÃ¡c yÃªu cáº§u Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi prompt. Báº£ng 1 cho tháº¥y thÃªm cÃ¡c trÆ°á»ng há»£p quÃªn prompt.

VÃ¬ viá»‡c cho phÃ©p mÃ´ hÃ¬nh tuÃ¢n theo prompt Ä‘Æ°á»£c coi lÃ  má»¥c tiÃªu tá»‘i quan trá»ng cá»§a chá»©c nÄƒng quan trá»ng nháº¥t cá»§a má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ (Liu et al. 2021), viá»‡c giáº£i quyáº¿t váº¥n Ä‘á» quÃªn prompt trong quÃ¡ trÃ¬nh táº¡o sinh cá»§a mÃ´ hÃ¬nh ngÃ´n ngá»¯ cháº¯c cháº¯n lÃ  báº¯t buá»™c vÃ  cáº§n Ä‘Æ°á»£c giáº£i quyáº¿t.

Äá»ƒ thuáº­n tiá»‡n cho viá»‡c mÃ´ táº£ vÃ  cÃ´ng thá»©c hÃ³a váº¥n Ä‘á», chÃºng tÃ´i Ä‘Ã£ Ä‘á»‹nh nghÄ©a thuáº­t ngá»¯ "prompt Ä‘a giai Ä‘oáº¡n" Ä‘á»ƒ chá»‰ má»™t prompt bao gá»“m nhiá»u hÆ¡n má»™t tiá»ƒu prompt hoáº·c quÃ¡ trÃ¬nh (cÃ¡c vÃ­ dá»¥ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 1). Viá»‡c quÃªn xáº£y ra do Ä‘á»™ dÃ i cá»§a vector tráº¡ng thÃ¡i mÃ´ hÃ¬nh lÃ  cá»‘ Ä‘á»‹nh. Trong quÃ¡ trÃ¬nh nháº­p vÄƒn báº£n vÃ o mÃ´ hÃ¬nh, cÃ³ nhá»¯ng tÃ¬nh huá»‘ng mÃ  mÃ´ hÃ¬nh khÃ´ng thá»ƒ xÃ¡c Ä‘á»‹nh liá»‡u cÃ³ nÃªn giá»¯ láº¡i thÃ´ng tin thu Ä‘Æ°á»£c táº¡i thá»i Ä‘iá»ƒm hiá»‡n táº¡i hay khÃ´ng. Khi nhiá»u vÄƒn báº£n Ä‘Æ°á»£c nháº­p vÃ o, thÃ´ng tin quan trá»ng cÅ©ng cÃ³ nguy cÆ¡ bá»‹ quÃªn. Váº¥n Ä‘á» nÃ y Ä‘áº·c biá»‡t cÃ³ háº¡i Ä‘á»‘i vá»›i cÃ¡c tÃ¡c vá»¥ táº¡o sinh cÃ³ prompt, lÃ  chá»©c nÄƒng chÃ­nh cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c lá»›n.

Trong bÃ i bÃ¡o nÃ y, nháº±m giáº£m thiá»ƒu viá»‡c quÃªn prompt trong quÃ¡ trÃ¬nh táº¡o sinh, chÃºng tÃ´i khai thÃ¡c má»™t cáº¥u trÃºc gá»i lÃ  ProSG (Prompt Synthetic Gradient), mÃ£ hÃ³a thÃ´ng tin prompt vÃ o mÃ´ hÃ¬nh táº¡m thá»i trong má»™t láº§n cháº¡y táº¡o sinh Ä‘á»ƒ tÄƒng cháº¥t lÆ°á»£ng táº¡o sinh. Äáº§u tiÃªn, Ä‘á»ƒ mÃ´ hÃ¬nh hÃ³a

--- TRANG 2 ---
Máº«u Prompt HÃ nh vi Äáº§u ra
A Viáº¿t má»™t cÃ¢u chuyá»‡n vá» há»c sinh Noah,
vÃ  viáº¿t má»™t báº£n tÃ³m táº¯t cho cÃ¢u chuyá»‡n
á»Ÿ cuá»‘i.QuÃªn tÃ³m táº¯t cÃ¢u chuyá»‡n á»Ÿ 
cuá»‘i Ä‘áº§u ra.Noah lÃ  má»™t há»c sinh thÃ´ng minh luÃ´n
mÆ¡ Æ°á»›c ... Cuá»‘i cÃ¹ng, anh áº¥y
hiá»‡n Ä‘ang lÃ m bÃ¡c sÄ© táº¡i má»™t bá»‡nh viá»‡n
nÆ¡i anh áº¥y cáº£m tháº¥y hÃ i lÃ²ng vá»›i nhá»¯ng gÃ¬
anh áº¥y lÃ m má»—i ngÃ y.
B Liá»‡t kÃª 10 tÃªn nhÃ¢n váº­t, vÃ  viáº¿t
má»™t cÃ¢u chuyá»‡n sá»­ dá»¥ng nhá»¯ng tÃªn nÃ y.Liá»‡t kÃª chÃ­nh xÃ¡c 10 tÃªn nhÆ°ng quÃªn 
viáº¿t cÃ¢u chuyá»‡n.1. Sophia - Má»™t phá»¥ ná»¯ tá»‘t bá»¥ng.
2. Jack - Má»™t ngÆ°á»i Ä‘Ã n Ã´ng quyáº¿n rÅ© thÃ­ch
khÃ¡m phÃ¡. ... 10. Max -
Má»™t ngÆ°á»i Ä‘Ã n Ã´ng Ä‘Ã¡ng tin cáº­y luÃ´n
á»Ÿ bÃªn báº¡n bÃ¨ vÃ  gia Ä‘Ã¬nh.
C Cho má»™t dÃ£y sá»‘: 1, 0,
1, 0, 0, 6, 2, 0, 0, 7, 2, 6, 0, 1, 2, 9.
BÃ¢y giá» hÃ£y Ä‘á»c láº¡i nÃ³.QuÃªn cÃ¡c sá»‘ Ä‘Ã£ cho. DÃ£y sá»‘ lÃ : 0, 1, 0, 1, 2, 0, 0,
1, 2, 6, 7, 2, 9
Báº£ng 1: VÃ­ dá»¥ vá» quÃªn prompt

Tráº¡ng thÃ¡i LLM LLM
promptÄ‘áº§u ra
Gradient
Tá»•ng há»£p
HÃ¬nh 1: Tá»•ng quan Kiáº¿n trÃºc.

váº¥n Ä‘á» tá»‘t hÆ¡n, chÃºng tÃ´i xÃ¢y dá»±ng má»™t bá»™ dá»¯ liá»‡u, chá»©a 21k prompt Ä‘a giai Ä‘oáº¡n vÃ  cÃ¡c cÃ¢u tráº£ lá»i tÆ°Æ¡ng á»©ng theo mÃ´ hÃ¬nh chung cá»§a tinh chá»‰nh hÆ°á»›ng dáº«n. Thá»© hai, má»™t mÃ´-Ä‘un thÃ­ch á»©ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh toÃ¡n gradient cá»§a prompt vÃ  Ã¡p dá»¥ng thay Ä‘á»•i trong viá»‡c táº¡o sinh tiáº¿p theo. MÃ´-Ä‘un thÃ­ch á»©ng nÃ y lÃ  má»™t táº­p há»£p cÃ¡c máº¡ng nÆ¡-ron sá»­ dá»¥ng ká»¹ thuáº­t thÃ­ch á»©ng thá»© háº¡ng tháº¥p (Hu et al. 2021) nháº­n tráº¡ng thÃ¡i mÃ£ hÃ³a prompt lÃ m Ä‘áº§u vÃ o vÃ  táº¡o ra gradient tá»•ng há»£p (Jaderberg et al. 2017) lÃ m Ä‘áº§u ra. Kiáº¿n trÃºc thÃ´ Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 1.

ChÃºng tÃ´i tiáº¿n hÃ nh cÃ¡c thÃ­ nghiá»‡m rá»™ng rÃ£i vÃ  Ä‘áº§y Ä‘á»§ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh hiá»‡u quáº£ cá»§a cáº¥u trÃºc vÃ  bá»™ dá»¯ liá»‡u má»›i cá»§a chÃºng tÃ´i. Káº¿t quáº£ thÃ­ nghiá»‡m cho tháº¥y phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i dáº«n Ä‘áº¿n hiá»‡u suáº¥t táº¡o sinh xuáº¥t sáº¯c vá» cáº£ cÃ¡c chá»‰ sá»‘ tá»± Ä‘á»™ng vÃ  Ä‘Ã¡nh giÃ¡ cá»§a con ngÆ°á»i. TÃ³m láº¡i, cÃ¡c Ä‘Ã³ng gÃ³p cá»§a chÃºng tÃ´i nhÆ° sau:

(1) ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡n tÆ°á»£ng quÃªn prompt vÃ  xÃ¢y dá»±ng bá»™ dá»¯ liá»‡u hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n (MuSI);
(2) ChÃºng tÃ´i Ä‘á» xuáº¥t má»™t khung lÃ m viá»‡c táº¡o Ä‘iá»u kiá»‡n cho sá»± há»£p tÃ¡c tá»‘t hÆ¡n vá»›i cÃ¡c bá»™ dá»¯ liá»‡u báº±ng cÃ¡ch mÃ£ hÃ³a prompt táº¡m thá»i vÃ o cÃ¡c tham sá»‘ mÃ´ hÃ¬nh, do Ä‘Ã³ giáº£m thiá»ƒu Ä‘Ã¡ng ká»ƒ váº¥n Ä‘á» quÃªn prompt.

CÃ´ng trÃ¬nh liÃªn quan
MÃ´ hÃ¬nh ngÃ´n ngá»¯ giá»‘ng RNN
Sau nhá»¯ng ná»— lá»±c cá»§a cÃ¡c nhÃ  nghiÃªn cá»©u, hiá»‡n táº¡i cÃ³ hai mÃ´ hÃ¬nh giá»‘ng RNN tÆ°Æ¡ng Ä‘á»‘i thÃ nh cÃ´ng, Ä‘Ã³ lÃ  RWKV (Peng et al. 2023) vÃ  RetNet (Sun et al. 2023). Loáº¡i mÃ´ hÃ¬nh nÃ y káº¿t há»£p Æ°u Ä‘iá»ƒm cá»§a cáº£ transformer vÃ  RNN, Ä‘áº£m báº£o ráº±ng tÃ­nh song song huáº¥n luyá»‡n khÃ´ng thay Ä‘á»•i trong khi Ä‘áº¡t Ä‘Æ°á»£c quÃ¡ trÃ¬nh suy luáº­n vá»›i Ä‘á»™ phá»©c táº¡p tuyáº¿n tÃ­nh. Máº·c dÃ¹ hai mÃ´ hÃ¬nh nÃ y cÃ³ hiá»‡u suáº¥t tá»‘t, lÃ  RNN, chÃºng váº«n tÆ°Æ¡ng Ä‘á»‘i bá»‹ háº¡n cháº¿ bá»Ÿi dung lÆ°á»£ng bá»™ nhá»› cá»‘ Ä‘á»‹nh, lÃ  há»‡ quáº£ trá»±c tiáº¿p cá»§a cÃ¡c vector tráº¡ng thÃ¡i cá»‘ Ä‘á»‹nh. NhÆ°á»£c Ä‘iá»ƒm nÃ y dáº«n Ä‘áº¿n hiá»‡u á»©ng quÃªn Ä‘Ã¡ng chÃº Ã½, Ä‘áº·c biá»‡t khi Ä‘Æ°a ra hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n cho mÃ´ hÃ¬nh Ä‘á»ƒ táº¡o sinh. MÃ´ hÃ¬nh quÃªn thÃ´ng tin vá» prompt Ä‘Ã£ cho khi quÃ¡ trÃ¬nh táº¡o sinh tiáº¿n triá»ƒn, hoáº·c tháº­m chÃ­ trÆ°á»›c khi viá»‡c táº¡o sinh báº¯t Ä‘áº§u. Máº·c dÃ¹ hai mÃ´ hÃ¬nh Ä‘á»u tuyÃªn bá»‘ cÃ³ hiá»‡u suáº¥t tá»‘t, cÃ¡c nhÃ  nghiÃªn cá»©u cá»§a RWKV Ä‘Ã£ phÃ¡t hÃ nh mÃ£ nguá»“n trong thá»i gian tÆ°Æ¡ng Ä‘á»‘i dÃ i. VÃ¬ váº­y chÃºng tÃ´i chá»n RWKV Ä‘á»ƒ tiáº¿n hÃ nh háº§u háº¿t cÃ´ng viá»‡c nghiÃªn cá»©u cá»§a mÃ¬nh.

ICL lÃ  Tinh chá»‰nh Ngáº§m Ä‘á»‹nh
ICL (há»c trong ngá»¯ cáº£nh) (Dong et al. 2023) lÃ  má»™t kháº£ nÄƒng ná»•i lÃªn cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n cho phÃ©p chÃºng thÃ­ch á»©ng vá»›i nhiá»u tÃ¡c vá»¥ khÃ¡c nhau khi Ä‘Æ°á»£c Ä‘Æ°a ra má»™t táº­p há»£p cÃ¡c vÃ­ dá»¥ minh há»a. TÃ­nh cháº¥t nÃ y Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh trong cÃ¡c LLM nhÆ° GPT-3 (Brown et al. 2020). (Dai et al. 2023) cung cáº¥p má»™t cÃ¡i nhÃ¬n má»›i vá» viá»‡c giáº£i thÃ­ch ICL nhÆ° má»™t quÃ¡ trÃ¬nh meta-tá»‘i Æ°u hÃ³a, xem xÃ©t LM nhÆ° má»™t meta-optimizer táº¡o ra meta-gradient theo cÃ¡c vÃ­ dá»¥ minh há»a thÃ´ng qua tÃ­nh toÃ¡n tiáº¿n. Sau Ä‘Ã³ gradient sáº½ Ä‘Æ°á»£c Ã¡p dá»¥ng cho LM gá»‘c thÃ´ng qua attention Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh ICL.

ÄÆ°á»£c truyá»n cáº£m há»©ng tá»« quan Ä‘iá»ƒm nÃ y, chÃºng tÃ´i náº£y ra Ã½ tÆ°á»Ÿng xem xÃ©t viá»‡c táº¡o sinh cÃ³ hÆ°á»›ng dáº«n nhÆ° má»™t quÃ¡ trÃ¬nh tinh chá»‰nh ngáº§m Ä‘á»‹nh, cÃ³ nghÄ©a lÃ  mÃ´ hÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c xem lÃ  Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a bá»Ÿi gradient tá»« prompt. VÃ¬ váº­y chÃºng tÃ´i cÃ³ thá»ƒ tá»•ng há»£p

--- TRANG 3 ---
MÃ´ táº£ cÃ¡c loáº¡i 
prompt khÃ¡c nhauGPT-3.5
â€¦ 
â€¦â€¦ 
â€¦GPT-3.5â€¦ 
â€¦
CÃ¢u tráº£ lá»i cho má»—i promptHÃ£y cho tÃ´i
prompt thá»a mÃ£n Ä‘iá»u kiá»‡n nÃ y: 
[bao gá»“m hai hÆ°á»›ng dáº«n phá»¥],
DÆ°á»›i Ä‘Ã¢y lÃ 
má»™t sá»‘ vÃ­ dá»¥:
(1) viáº¿t má»™t cÃ¢u chuyá»‡n mÃ ...
(2) viáº¿t má»™t bÃ i thÆ¡ mÃ ...
VÃ­ dá»¥ Giai Ä‘oáº¡n 1: Táº¡o promptCÃ¡c loáº¡i prompt khÃ¡c nhauThÃ¡m tá»­ Johnson Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i 
báº£n nÄƒng nháº¡y bÃ©n vÃ  quyáº¿t tÃ¢m 
khÃ´ng lay chuyá»ƒn. â€¦Viáº¿t má»™t cÃ¢u chuyá»‡n ngáº¯n vá» má»™t thÃ¡m tá»­ 
giáº£i quyáº¿t má»™t vá»¥ Ã¡n bÃ­ áº©n.
Giai Ä‘oáº¡n 2: Táº¡o cÃ¢u tráº£ lá»i
HÃ¬nh 2: XÃ¢y dá»±ng Bá»™ dá»¯ liá»‡u.

gradient do prompt mang láº¡i Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu giáº£m thiá»ƒu viá»‡c quÃªn.

Gradient Tá»•ng há»£p
Gradient Tá»•ng há»£p (Jaderberg et al. 2017) lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ¡ch rá»i cÃ¡c mÃ´-Ä‘un nÆ¡-ron, nháº±m tÄƒng tá»‘c quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Trong viá»‡c huáº¥n luyá»‡n máº¡ng nÆ¡-ron truyá»n thá»‘ng, thÃ´ng tin gradient cáº§n Ä‘Æ°á»£c truyá»n tá»« lá»›p Ä‘áº§u ra Ä‘áº¿n lá»›p Ä‘áº§u vÃ o thÃ´ng qua lan truyá»n ngÆ°á»£c (Rumelhart, Hinton, vÃ  Williams 1986). Tuy nhiÃªn, gradient tá»•ng há»£p xáº¥p xá»‰ thÃ´ng tin gradient thá»±c báº±ng cÃ¡ch giá»›i thiá»‡u má»™t mÃ´ hÃ¬nh bá»• sung. ThÃ´ng thÆ°á»ng, mÃ´ hÃ¬nh gradient tá»•ng há»£p nháº­n Ä‘áº§u ra cá»§a cÃ¡c lá»›p trung gian cá»§a máº¡ng nÆ¡-ron lÃ m Ä‘áº§u vÃ o vÃ  táº¡o ra má»™t gradient xáº¥p xá»‰, sau Ä‘Ã³ Ä‘Æ°á»£c truyá»n Ä‘áº¿n lá»›p trÆ°á»›c cá»§a máº¡ng. Trong khung lÃ m viá»‡c cá»§a chÃºng tÃ´i, chÃºng tÃ´i sá»­ dá»¥ng ká»¹ thuáº­t nÃ y Ä‘á»ƒ xáº¥p xá»‰ gradient Ä‘Æ°á»£c táº¡o ra bá»Ÿi prompt.

ThÃ­ch á»©ng Thá»© háº¡ng Tháº¥p
LoRA (Hu et al. 2021) lÃ  má»™t ká»¹ thuáº­t Ä‘á»ƒ giáº£m Ä‘á»™ phá»©c táº¡p tÃ­nh toÃ¡n vÃ  yÃªu cáº§u bá»™ nhá»› khi tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh. LoRA Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh mang láº¡i káº¿t quáº£ xuáº¥t sáº¯c trong nhiá»u tÃ¡c vá»¥ tinh chá»‰nh khÃ¡c nhau trong lÄ©nh vá»±c NLP.

ChÃºng tÃ´i Ä‘Æ°a ra giáº£ Ä‘á»‹nh ráº±ng cÃ¡c tham sá»‘ cá»§a mÃ´ hÃ¬nh chá»‰ cáº§n nhá»¯ng sá»­a Ä‘á»•i nhá» Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»©c Ä‘á»™ ghi nhá»› thÃ´ng tin prompt nháº¥t Ä‘á»‹nh cÃ³ kháº£ nÄƒng nÃ¢ng cao viá»‡c táº¡o sinh. VÃ¬ váº­y chÃºng tÃ´i sá»­ dá»¥ng thÃ­ch á»©ng thá»© háº¡ng tháº¥p khi tÃ­nh toÃ¡n gradient tá»•ng há»£p prompt Ä‘á»ƒ giáº£m chi phÃ­ bá»™ nhá»› cá»§a khung lÃ m viá»‡c.

PhÆ°Æ¡ng phÃ¡p
Bá»™ dá»¯ liá»‡u
HÆ°á»›ng dáº«n ThÃ´ng thÆ°á»ng vs. HÆ°á»›ng dáº«n Äa giai Ä‘oáº¡n Háº§u háº¿t hÆ°á»›ng dáº«n thÃ´ng thÆ°á»ng chá»‰ bao gá»“m má»™t thao tÃ¡c/bÆ°á»›c, vÃ­ dá»¥, "Viáº¿t má»™t cÃ¢u chuyá»‡n vá» Tom". Bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi Alpaca lÃ  bá»™ dá»¯ liá»‡u Ä‘iá»ƒn hÃ¬nh chá»©a chá»§ yáº¿u cÃ¡c hÆ°á»›ng dáº«n Ä‘Æ¡n giáº£n. Trong khi hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n bao gá»“m nhiá»u hÆ¡n má»™t thao tÃ¡c/bÆ°á»›c, vÃ­ dá»¥, "Viáº¿t má»™t cÃ¢u chuyá»‡n vá» Tom, vÃ  cÅ©ng táº¡o má»™t báº£n tÃ³m táº¯t á»Ÿ cuá»‘i". Äá»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ truyá»n thá»‘ng sá»­ dá»¥ng kiáº¿n trÃºc transformer, hai loáº¡i hÆ°á»›ng dáº«n cÃ³ sá»± khÃ¡c biá»‡t nháº¹, vÃ¬ transformer cÃ³ thá»ƒ báº£o toÃ n thÃ´ng tin hoÃ n chá»‰nh vá» hÆ°á»›ng dáº«n báº±ng cÃ¡ch lÆ°u trá»¯ cÃ¡c cáº·p K-V. Tuy nhiÃªn, nÃ³ hoÃ n toÃ n khÃ¡c Ä‘á»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh giá»‘ng RNN vÃ¬ báº£n cháº¥t tuáº§n hoÃ n dáº«n Ä‘áº¿n viá»‡c máº¥t thÃ´ng tin khÃ´ng thá»ƒ trÃ¡nh khá»i trong quÃ¡ trÃ¬nh táº¡o sinh, Ä‘iá»u nÃ y vÃ´ hiá»‡u hÃ³a kháº£ nÄƒng "nhÃ¬n láº¡i" hÆ°á»›ng dáº«n cá»§a cÃ¡c mÃ´ hÃ¬nh giá»‘ng RNN nhÆ° transformer. Há»‡ quáº£ lÃ , hiá»‡n tÆ°á»£ng quÃªn cá»§a mÃ´ hÃ¬nh giá»‘ng RNN Ä‘áº·c biá»‡t rÃµ rÃ ng khi xá»­ lÃ½ cÃ¡c hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n.

Bá»™ dá»¯ liá»‡u HÆ°á»›ng dáº«n Äa giai Ä‘oáº¡n (MuSI) Äá»ƒ xá»­ lÃ½ quÃ¡ trÃ¬nh quÃªn tá»‘t hÆ¡n, chÃºng tÃ´i táº­n dá»¥ng ChatGPT Ä‘á»ƒ thu tháº­p má»™t bá»™ dá»¯ liá»‡u cÃ³ tÃªn lÃ  Bá»™ dá»¯ liá»‡u HÆ°á»›ng dáº«n Äa giai Ä‘oáº¡n (MuSI), chá»©a má»™t sá»‘ hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n vÃ  cÃ¡c cÃ¢u tráº£ lá»i tÆ°Æ¡ng á»©ng, vÃ  sau Ä‘Ã³ chÃºng tÃ´i loáº¡i bá» thá»§ cÃ´ng dá»¯ liá»‡u khÃ´ng tuÃ¢n thá»§. Cuá»‘i cÃ¹ng, chÃºng tÃ´i thu tháº­p 22k cáº·p hÆ°á»›ng dáº«n-cÃ¢u tráº£ lá»i. Cáº§n nháº¥n máº¡nh ráº±ng cÃ¡c prompt Ä‘Æ°á»£c chá»n cho bá»™ dá»¯ liá»‡u cá»§a chÃºng tÃ´i chá»©a ráº¥t Ã­t kiáº¿n thá»©c chuyÃªn mÃ´n cá»¥ thá»ƒ, cho phÃ©p so sÃ¡nh cÃ´ng báº±ng hÆ¡n vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n khÃ¡c trong cÃ¡c lÄ©nh vá»±c cÃ´ng cá»™ng sau khi tinh chá»‰nh.

--- TRANG 4 ---
12n-1n
ğ‘¥012n-1n
ğ‘¥1...
...
...
... 12n-1n
ğ‘¥ğ‘›ğ‘¦0
1(+ğ›¥ğ‘Š1)2(+ğ›¥ğ‘Š2)(n-1)(+ğ›¥ğ‘Šğ‘›âˆ’1)n(+ğ›¥ğ‘Šğ‘›)
ğ‘¦01(+ğ›¥ğ‘Š1)2(+ğ›¥ğ‘Š2)(n-1)(+ğ›¥ğ‘Šğ‘›âˆ’1)n(+ğ›¥ğ‘Šğ‘›)
ğ‘¦1ğ‘¦2 ğ‘¦1
...
...
...
...Tá»•ng há»£p
Gradient
... ... ... ... ... ... ...iLá»›p RNN thá»© i
trÆ°á»›c khi tá»•ng há»£p gradientLá»›p Tuyáº¿n tÃ­nh Äáº§u ra
iLá»›p RNN thá»© i
sau khi tá»•ng há»£p gradient
Tráº¡ng thÃ¡i áº©n
ğ‘¥ğ‘–
ğ‘¦ğ‘–Token prompt
Token Ä‘áº§u ra
ğ›¥ğ‘Šğ‘– Gradient prompt
HÃ¬nh 3: Kiáº¿n trÃºc mÃ´ hÃ¬nh.

ToÃ n bá»™ quÃ¡ trÃ¬nh xÃ¢y dá»±ng MuSI Ä‘Æ°á»£c minh há»a trong HÃ¬nh 2.

Tá»•ng quan Kiáº¿n trÃºc cá»§a chÃºng tÃ´i bao gá»“m hai pháº§n, má»™t trong sá»‘ Ä‘Ã³ lÃ  LM giá»‘ng RNN ná»n táº£ng, Ä‘Æ°á»£c Ä‘áº·t lÃ  RWKV vÃ¬ nÃ³ Ä‘Ã£ phÃ¡t hÃ nh nhiá»u tÃ i nguyÃªn nháº¥t. Pháº§n khÃ¡c lÃ  mÃ´-Ä‘un tá»•ng há»£p gradient prompt G. Äá»‘i vá»›i má»—i láº§n táº¡o sinh, chÃºng tÃ´i trÆ°á»›c tiÃªn Ä‘Æ°a chuá»—i prompt X, chá»©a n token {x1,x2, ...,xn} vÃ o RNN LM, sau Ä‘Ã³ vector tráº¡ng thÃ¡i áº©n Hn chá»©a thÃ´ng tin prompt sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o gradient tá»•ng há»£p. TÃ³m gá»n, cÃ¡c tráº¡ng thÃ¡i áº©n sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi mÃ´-Ä‘un tá»•ng há»£p gradient lÃ m Ä‘áº§u vÃ o, vÃ  Ä‘áº§u ra lÃ  gradient xáº¥p xá»‰ thá»© háº¡ng tháº¥p âˆ†W, Ä‘Æ°á»£c mong Ä‘á»£i lÃ  truyá»n Ä‘áº¡t thÃ´ng tin prompt má»™t cÃ¡ch nháº¥t quÃ¡n trong quÃ¡ trÃ¬nh táº¡o sinh báº±ng cÃ¡ch thÃªm vÃ o tham sá»‘ gá»‘c W nhÆ° má»™t sá»‘ gia. Do Ä‘Ã³ trong viá»‡c táº¡o sinh tiáº¿p theo, má»—i láº§n chuyá»ƒn tiáº¿p sáº£n xuáº¥t token Ä‘áº§u ra thá»© k yk sáº½ Ä‘Æ°á»£c tÄƒng cÆ°á»ng vá»›i sá»‘ gia tham sá»‘ âˆ†W. ToÃ n bá»™ quÃ¡ trÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ° sau:

{H0,H1...,Hn}=RNN (x1,x2, ...,xn) (1)
âˆ†W =G(Hn),yk=RNN (+âˆ†W )(ykâˆ’1) (2)

RWKV RWKV lÃ  má»™t mÃ´ hÃ¬nh giá»‘ng RNN chá»§ yáº¿u bao gá»“m má»™t chá»“ng cÃ¡c khá»‘i dÆ°, má»—i khá»‘i Ä‘Æ°á»£c táº¡o thÃ nh bá»Ÿi má»™t khá»‘i phá»¥ trá»™n thá»i gian vÃ  má»™t khá»‘i phá»¥ trá»™n kÃªnh vá»›i cáº¥u trÃºc tuáº§n hoÃ n. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i thÃªm mÃ´-Ä‘un tá»•ng há»£p gradient vÃ o khá»‘i trá»™n thá»i gian. Khá»‘i trá»™n thá»i gian cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ°:

rt=WrÂ·(Âµrxt+ (1âˆ’Âµr)xtâˆ’1) (3)
kt=WkÂ·(Âµkxt+ (1âˆ’Âµk)xtâˆ’1) (4)
vt=WvÂ·(Âµvxt+ (1âˆ’Âµv)xtâˆ’1) (5)
wkv t=Ptâˆ’1
i=1eâˆ’(tâˆ’1âˆ’i)w+kivi+eu+ktvtPtâˆ’1
i=1eâˆ’(tâˆ’1âˆ’i)w+ki+eu+kt(6)
ot=WoÂ·(Ïƒ(rt)âŠ™wkv t) (7)

QuÃ¡ trÃ¬nh táº¡o sinh sáº½ Ä‘Æ°á»£c sá»­a Ä‘á»•i bá»Ÿi gradient tá»•ng há»£p cá»§a chÃºng tÃ´i sau khi tÃ­nh toÃ¡n gradient prompt. Do Ä‘Ã³ tÃ­nh toÃ¡n time-mix sáº½ lÃ :

rt= (Wr+ âˆ†Wr)Â·(Âµrxt+ (1âˆ’Âµr)xtâˆ’1) (8)
kt= (Wk+ âˆ†Wk)Â·(Âµkxt+ (1âˆ’Âµk)xtâˆ’1)(9)
vt= (Wv+ âˆ†Wv)Â·(Âµvxt+ (1âˆ’Âµv)xtâˆ’1)(10)
wkv t=Ptâˆ’1
i=1eâˆ’(tâˆ’1âˆ’i)w+kivi+eu+ktvtPtâˆ’1
i=1eâˆ’(tâˆ’1âˆ’i)w+ki+eu+kt(11)
ot= (Wo+ âˆ†Wo)Â·(Ïƒ(rt)âŠ™wkv t) (12)

TÃ­nh toÃ¡n cá»§a cÃ¡c pháº§n khÃ¡c trong mÃ´ hÃ¬nh RWKV váº«n khÃ´ng thay Ä‘á»•i.

NhÃºng Tráº¡ng thÃ¡i Do cÃ¡c khÃ´ng gian Ä‘áº·c trÆ°ng riÃªng biá»‡t cá»§a cÃ¡c ma tráº­n cho cÃ¡c tráº¡ng thÃ¡i key, value, receptance, vÃ  output, chÃºng tÃ´i sá»­ dá»¥ng cÃ¹ng má»™t mÃ´-Ä‘un tá»•ng há»£p gradient Ä‘á»ƒ xáº¥p xá»‰ gradient cá»§a bá»‘n tham sá»‘ trong cÃ¹ng má»™t lá»›p. CÃ¡ch tiáº¿p cáº­n nÃ y giÃºp giáº£m sá»‘ lÆ°á»£ng tham sá»‘ vÃ  cho phÃ©p tÃ­nh toÃ¡n song song. PhÆ°Æ¡ng phÃ¡p nÃ y tÄƒng tá»‘c tÃ­nh toÃ¡n, nhÆ°ng nÃ³ cÅ©ng cÃ³ má»™t khuyáº¿t Ä‘iá»ƒm chÃ­ máº¡ng: cÃ¡c tham sá»‘ khÃ¡c nhau nÃªn nháº­n Ä‘Æ°á»£c cÃ¡c cáº­p nháº­t khÃ¡c nhau khi tÃ­nh toÃ¡n gradient tá»•ng há»£p prompt. Äá»ƒ kháº¯c phá»¥c váº¥n Ä‘á» nÃ y, chÃºng tÃ´i giá»›i thiá»‡u nhÃºng tráº¡ng thÃ¡i.

NhÃºng tráº¡ng thÃ¡i lÃ  má»™t táº­p há»£p cÃ¡c vector nhÃºng Ä‘Ã£ há»c cho má»—i tráº¡ng thÃ¡i khÃ¡c nhau Ä‘Æ°á»£c lÆ°u trá»¯ trong má»—i lá»›p, sáº½ Ä‘Æ°á»£c thÃªm vÃ o Ä‘áº§u vÃ o xâ–¡ trÆ°á»›c khi Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ´-Ä‘un cá»‘t lÃµi (chá»“ng biáº¿n Ä‘á»•i S) cá»§a mÃ´-Ä‘un tá»•ng há»£p gradient G.

NhÃºng tráº¡ng thÃ¡i cho phÃ©p sá»­ dá»¥ng cÃ¹ng má»™t mÃ´-Ä‘un Ä‘á»ƒ xá»­ lÃ½ Ä‘áº§u vÃ o trong bá»‘n cháº¿ Ä‘á»™ khÃ¡c nhau, cho phÃ©p má»™t mÃ´-Ä‘un duy nháº¥t cung cáº¥p gradient tá»•ng há»£p vá»›i cÃ¡c tÃ­nh cháº¥t riÃªng biá»‡t cho bá»‘n loáº¡i tráº¡ng thÃ¡i.

Chá»“ng Biáº¿n Ä‘á»•i Chá»“ng biáº¿n Ä‘á»•i S lÃ  má»™t táº­p há»£p cÃ¡c khá»‘i giá»‘ng há»‡t nhau, lÃ  má»™t mÃ´ hÃ¬nh tuáº§n tá»± chá»©a cÃ¡c lá»›p tuyáº¿n tÃ­nh, hÃ m kÃ­ch hoáº¡t, vÃ  layer norm. Cá»¥ thá»ƒ, má»™t khá»‘i biáº¿n Ä‘á»•i bao gá»“m má»™t lá»›p tuyáº¿n tÃ­nh, má»™t hÃ m kÃ­ch hoáº¡t ReLU, má»™t lá»›p tuyáº¿n tÃ­nh khÃ¡c, vÃ  má»™t layer norm. ChÃºng tÃ´i cÅ©ng thÃªm má»™t káº¿t ná»‘i dÆ° giá»¯a Ä‘áº§u ra vÃ  Ä‘áº§u vÃ o. Äá»‘i vá»›i má»™t khá»‘i Ä‘Æ¡n. Chá»“ng biáº¿n Ä‘á»•i lÃ  mÃ´-Ä‘un cá»‘t lÃµi Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tá»•ng há»£p gradient.

Ma tráº­n Thá»© háº¡ng tháº¥p Äáº§u ra HÃ¬nh dáº¡ng cá»§a vector tráº¡ng thÃ¡i lÃ  1Ã—E, vÃ  hÃ¬nh dáº¡ng cá»§a ma tráº­n tráº¡ng thÃ¡i lÃ  EÃ—E. Cáº§n lÆ°u Ã½ ráº±ng chÃºng tÃ´i má»Ÿ rá»™ng tráº¡ng thÃ¡i thÃ nh má»™t vector cÃ³ hÃ¬nh dáº¡ng 1Ã—nE, trong Ä‘Ã³ n Ä‘Æ°á»£c chá»n tá»« 1, 2 hoáº·c 3. Vector tráº¡ng thÃ¡i khÃ´ng thay Ä‘á»•i sau khi Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi chá»“ng biáº¿n Ä‘á»•i vÃ  sau Ä‘Ã³ sáº½ Ä‘Æ°á»£c Ä‘á»‹nh hÃ¬nh láº¡i thÃ nh nÃ—E. Dá»±a trÃªn giáº£ Ä‘á»‹nh ráº±ng viá»‡c ghi nhá»› prompt cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c á»Ÿ má»©c Ä‘á»™ nháº¥t Ä‘á»‹nh bá»Ÿi cÃ¡c thay Ä‘á»•i báº­c tháº¥p trong khÃ´ng gian tham sá»‘ mÃ´ hÃ¬nh, chÃºng tÃ´i sá»­ dá»¥ng ká»¹ thuáº­t thÃ­ch á»©ng thá»© háº¡ng tháº¥p. Äá»ƒ biáº¿n Ä‘á»•i hÃ¬nh dáº¡ng Ä‘áº§u ra thÃ nh EÃ—E, chÃºng tÃ´i thiáº¿t káº¿ má»™t ma tráº­n thá»© háº¡ng tháº¥p Ä‘áº§u ra Ä‘Ã£ há»c B cÃ³ hÃ¬nh dáº¡ng EÃ—n, sáº½ nhÃ¢n vá»›i Ä‘áº§u ra cá»§a chá»“ng biáº¿n Ä‘á»•i S.

MÃ´-Ä‘un Tá»•ng há»£p Gradient MÃ´-Ä‘un tá»•ng há»£p gradient cá»§a chÃºng tÃ´i bao gá»“m má»™t chá»“ng biáº¿n Ä‘á»•i S, má»™t táº­p há»£p nhÃºng tráº¡ng thÃ¡i e, vÃ  má»™t táº­p há»£p ma tráº­n thá»© háº¡ng tháº¥p Ä‘áº§u ra B. MÃ´-Ä‘un nÃ y Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 4. VÃ¬ thiáº¿t káº¿ chi tiáº¿t cá»§a tráº¡ng thÃ¡i áº©n khÃ¡c nhau theo kiáº¿n trÃºc mÃ´ hÃ¬nh, cÃ´ng thá»©c cá»§a chÃºng tÃ´i Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh vá»›i RWKV Ä‘á»ƒ hiá»ƒn thá»‹ chi tiáº¿t mÃ´-Ä‘un rÃµ rÃ ng hÆ¡n. Tráº¡ng thÃ¡i cá»§a má»—i lá»›p sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o MÃ´-Ä‘un Tá»•ng há»£p Gradient G vÃ  tÃ­nh toÃ¡n gradient. Má»—i lá»›p thá»±c hiá»‡n cÃ¹ng má»™t thao tÃ¡c, Ä‘á»ƒ cÃ´ng thá»©c hÃ³a toÃ n bá»™ quÃ¡ trÃ¬nh má»™t cÃ¡ch chi tiáº¿t, chÃºng tÃ´i chá»n lá»›p thá»© i lÃ m vÃ­ dá»¥. Trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i, chÃºng tÃ´i chá»n Ä‘áº§u vÃ o x cá»§a má»—i lá»›p, mÃ£ hÃ³a prompt Ä‘á»ƒ thÃªm vá»›i 4 nhÃºng tráº¡ng thÃ¡i khÃ¡c nhau:

xk=x+ek (13)
xv=x+ev (14)
xr=x+er (15)
xo=x+eo (16)
(17)

trong Ä‘Ã³ k, v, r, o láº§n lÆ°á»£t Ä‘áº¡i diá»‡n cho key, value, receptance vÃ  output. VÃ  sau Ä‘Ã³ má»—i xâ–¡ sáº½ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi chá»“ng biáº¿n Ä‘á»•i vÃ  táº¡o ra Aâ–¡:

Aâ–¡=S(xâ–¡) (18)
(19)

Sau Ä‘Ã³, ma tráº­n thá»© háº¡ng tháº¥p Aâ–¡ sáº½ nhÃ¢n vá»›i Bâ–¡ tÆ°Æ¡ng á»©ng vÃ  táº¡o ra âˆ†Wâ–¡.

âˆ†Wâ–¡=Bâ–¡Ã—Aâ–¡ (20)
(21)

Chiáº¿n lÆ°á»£c Huáº¥n luyá»‡n
Huáº¥n luyá»‡n Song song Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, mÃ´-Ä‘un tá»•ng há»£p gradient yÃªu cáº§u truy cáº­p vÃ o cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a prompt X Ä‘Ã£ mÃ£ hÃ³a, cá»¥ thá»ƒ lÃ  vector tráº¡ng thÃ¡i cuá»‘i cÃ¹ng. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i ban Ä‘áº§u Ä‘á»‡m má»™t sá»‘ prompt {X1,X2, ...,Xk}, cÃ³ Ä‘á»™ dÃ i {l1,l2, ...,lk} vÃ  nháº­p má»™t batch vÃ o mÃ´ hÃ¬nh, do Ä‘Ã³ thu Ä‘Æ°á»£c chuá»—i vector tráº¡ng thÃ¡i {H1,H2, ...,Hk},HiâˆˆRLÃ—E, trong Ä‘Ã³ L lÃ  Ä‘á»™ dÃ i Ä‘á»‡m vÃ  E lÃ  chiá»u kÃªnh. Tuy nhiÃªn, do Ä‘á»™ dÃ i prompt khÃ¡c nhau vÃ  viá»‡c Ä‘Æ°a vÃ o cÃ¡c token Ä‘á»‡m, thÃ´ng tin trong vector á»Ÿ cuá»‘i prompt cÃ³ thá»ƒ bá»‹ máº¥t. Thá»© cáº§n thiáº¿t thá»±c táº¿ lÃ  {Hl1
1,Hl2
2, ...,Hlk
k},Hj
iâˆˆRE thay vÃ¬ {HL
1,HL
2, ...,HL
k}. Do Ä‘Ã³, trong quÃ¡ trÃ¬nh xá»­ lÃ½, Ä‘iá»u quan trá»ng lÃ  pháº£i truyá»n Ä‘á»™ dÃ i gá»‘c cá»§a prompt. Äiá»u nÃ y cho phÃ©p chÃºng tÃ´i sá»­ dá»¥ng vector táº¡i vá»‹ trÃ­ tÆ°Æ¡ng á»©ng vá»›i Ä‘á»™ dÃ i gá»‘c cá»§a prompt nhÆ° vector tráº¡ng thÃ¡i cáº§n thiáº¿t vÃ  cÅ©ng Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n giá»¯a huáº¥n luyá»‡n vÃ  suy luáº­n.

Huáº¥n luyá»‡n Hai giai Ä‘oáº¡n ChÃºng tÃ´i sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p huáº¥n luyá»‡n hai giai Ä‘oáº¡n, trong Ä‘Ã³ giai Ä‘oáº¡n Ä‘áº§u tiÃªn bao gá»“m viá»‡c tinh chá»‰nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ ná»n táº£ng, vá»›i má»™t loss huáº¥n luyá»‡n, vÃ  giai Ä‘oáº¡n thá»© hai táº­p trung vÃ o viá»‡c huáº¥n luyá»‡n mÃ´-Ä‘un tá»•ng há»£p gradient Ä‘á»ƒ tÄƒng cÆ°á»ng hÆ¡n ná»¯a kháº£ nÄƒng ghi nhá»› cá»§a nÃ³. ChÃ­nh thá»©c, Ä‘áº·t bá»™ dá»¯ liá»‡u lÃ  D vá»›i kÃ­ch thÆ°á»›c N. giai Ä‘oáº¡n Ä‘áº§u tiÃªn nháº±m tá»‘i Ä‘a hÃ³a log-likelihood (kÃ½ hiá»‡u bá»Ÿi JRNN) cá»§a má»¥c tiÃªu trÃªn táº¥t cáº£ cÃ¡c máº«u huáº¥n luyá»‡n cá»§a D, tá»©c lÃ ,

JRNN=NX
nTnX
tlogPÎ¸1(xn,t|xn,<t) (22)

trong Ä‘Ã³ xn,t Ä‘áº¡i diá»‡n cho tá»« thá»© t cá»§a máº«u thá»© n. Tn biá»ƒu thá»‹ Ä‘á»™ dÃ i tá»« cá»§a máº«u yn. Î¸1 lÃ  tham sá»‘ cá»§a mÃ´ hÃ¬nh. Giai Ä‘oáº¡n thá»© hai cÅ©ng nháº±m tá»‘i Ä‘a hÃ³a log-likelihood cá»§a táº¥t cáº£ cÃ¡c máº«u huáº¥n luyá»‡n, nhÆ°ng tham sá»‘ cá»§a mÃ´ hÃ¬nh ná»n táº£ng Î¸1 Ä‘Æ°á»£c Ä‘Ã³ng bÄƒng, cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ° sau:

JS=NX
nTnX
tlogPÎ¸1,Î¸2(xn,t|xn,<t) (23)

Trong cÃ´ng thá»©c nÃ y, JS biá»ƒu thá»‹ log-likelihood cá»§a giai Ä‘oáº¡n thá»© hai, tá»‘i Æ°u hÃ³a mÃ´-Ä‘un tá»•ng há»£p gradient, cÃ³ tham sá»‘ Î¸2

--- TRANG 5 ---
HÃ¬nh 4: MÃ´-Ä‘un tá»•ng há»£p gradient.

ThÃ­ nghiá»‡m
Bá»™ dá»¯ liá»‡u
Do thiáº¿u má»™t bá»™ dá»¯ liá»‡u phÃ¹ há»£p cÃ³ thá»ƒ Ä‘Ã¡p á»©ng hiá»‡u quáº£ cÃ¡c yÃªu cáº§u cá»§a hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n hiá»‡n táº¡i, táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i Ä‘á»u Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn bá»™ dá»¯ liá»‡u MuSI.

PhÆ°Æ¡ng phÃ¡p/MÃ´ hÃ¬nh Cáº¡nh tranh
ChÃºng tÃ´i sáº½ so sÃ¡nh mÃ´ hÃ¬nh vá»›i cÃ¡c mÃ´ hÃ¬nh cÃ³ kÃ­ch thÆ°á»›c tÆ°Æ¡ng tá»±, vÃ  cÅ©ng cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c cÃ´ng nháº­n rá»™ng rÃ£i vá»›i nhiá»u tham sá»‘ hÆ¡n cÃ³ kháº£ nÄƒng táº¡o ra Ä‘áº§u ra thá»a mÃ£n. ChÃºng tÃ´i mÃ´ táº£ má»™t sá»‘ mÃ´ hÃ¬nh Ä‘Æ°á»£c chá»n nhÆ° sau:

GPT-2, Vicuna, ChatGLM GPT-2 (Radford et al. 2019), Vicuna (Chiang et al. 2023), ChatGML (Zeng et al. 2022) Ä‘á»u lÃ  cÃ¡c transformer decoder-only Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c. ChÃºng cÃ³ kháº£ nÄƒng hiá»ƒu ngá»¯ cáº£nh cá»§a vÄƒn báº£n Ä‘áº§u vÃ o vÃ  táº¡o ra vÄƒn báº£n Ä‘áº§u ra máº¡ch láº¡c vÃ  logic. LÃ  transformer, chÃºng giá»¯ láº¡i toÃ n bá»™ chuá»—i token lá»‹ch sá»­. Do Ä‘Ã³, chÃºng tÃ´i coi ba mÃ´ hÃ¬nh nÃ y lÃ  chuáº©n má»±c.

RWKV Äá»‘i vá»›i RWKV, chÃºng tÃ´i thiáº¿t káº¿ ba thÃ­ nghiá»‡m: (1) PhiÃªn báº£n tinh chá»‰nh gá»‘c cá»§a RWKV-4-World; (2) Tinh chá»‰nh MuSI; (3) Tinh chá»‰nh MuSI cá»™ng vá»›i kiáº¿n trÃºc ProSG. Thiáº¿t láº­p thÃ­ nghiá»‡m nÃ y cho phÃ©p chÃºng tÃ´i phÃ¢n tÃ­ch liá»‡u MuSI vÃ  ProSG cÃ³ Ä‘Ã³ng vai trÃ² trong viá»‡c giáº£m thiá»ƒu quÃªn prompt hay khÃ´ng.

Chá»‰ sá»‘ ÄÃ¡nh giÃ¡
ChÃºng tÃ´i Ã¡p dá»¥ng ba chá»‰ sá»‘ phÃ¢n tÃ­ch: Perplexity, Äá»™ chÃ­nh xÃ¡c, vÃ  ÄÃ¡nh giÃ¡ cá»§a Con ngÆ°á»i.

Perplexity Perplexity, hay PPL, lÃ  má»™t thÆ°á»›c Ä‘o Ä‘á»‹nh lÆ°á»£ng chá»‰ ra má»©c Ä‘á»™ tá»‘t cá»§a má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ trong viá»‡c dá»± Ä‘oÃ¡n má»™t táº­p há»£p tá»« cho trÆ°á»›c dá»±a trÃªn dá»¯ liá»‡u huáº¥n luyá»‡n cá»§a nÃ³. CÃ¡c giÃ¡ trá»‹ perplexity tháº¥p hÆ¡n gá»£i Ã½ ráº±ng mÃ´ hÃ¬nh tá»‘t hÆ¡n trong viá»‡c Ä‘Æ°a ra cÃ¡c dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c.

Perplexity cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lÃ  sá»‘ mÅ© cá»§a cross-entropy vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chá»‰ ra kháº£ nÄƒng dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh. Giáº£ sá»­ chÃºng ta cÃ³ má»™t táº­p dá»¯ liá»‡u kiá»ƒm tra Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  D, bao gá»“m N máº«u, má»—i máº«u Ä‘Æ°á»£c biá»ƒu diá»…n lÃ  xi, trong Ä‘Ã³ xi lÃ  má»™t chuá»—i vÄƒn báº£n Ä‘Ã£ Ä‘Æ°á»£c tokenize. MÃ´ hÃ¬nh dá»± Ä‘oÃ¡n phÃ¢n phá»‘i xÃ¡c suáº¥t pi(y) cho token tiáº¿p theo Ä‘á»‘i vá»›i má»—i chuá»—i xi, trong Ä‘Ã³ y Ä‘áº¡i diá»‡n cho token tiáº¿p theo. Äá»‘i vá»›i má»—i máº«u xi, cÃ´ng thá»©c Ä‘á»ƒ tÃ­nh cross-entropy lÃ :

H(xi) =âˆ’1
MMX
j=1logpi(yj)

á» Ä‘Ã¢y, M lÃ  sá»‘ token trong máº«u xi, yj lÃ  token thá»© j trong máº«u, vÃ  pi(yj) lÃ  xÃ¡c suáº¥t dá»± Ä‘oÃ¡n cá»§a token thá»© j bá»Ÿi mÃ´ hÃ¬nh. Sau Ä‘Ã³, tá»•ng há»£p cross-entropy cho táº¥t cáº£ cÃ¡c máº«u Ä‘á»ƒ thu Ä‘Æ°á»£c cross-entropy cho toÃ n bá»™ bá»™ dá»¯ liá»‡u:

H(D) =NX
i=1H(xi)

Cuá»‘i cÃ¹ng, perplexity (PPL) cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh toÃ¡n báº±ng cÃ¡ch sá»­ dá»¥ng cross-entropy:

PPL (D) =eH(D)

Äá»™ chÃ­nh xÃ¡c ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a Ä‘á»™ chÃ­nh xÃ¡c lÃ  liá»‡u ná»™i dung Ä‘Æ°á»£c táº¡o ra cÃ³ tuÃ¢n theo prompt Ä‘Ã£ cho hay khÃ´ng. Náº¿u má»™t Ä‘áº§u ra tráº£ lá»i táº¥t cáº£ cÃ¡c cÃ¢u há»i hoáº·c xem xÃ©t táº¥t cáº£ cÃ¡c hÆ°á»›ng dáº«n phá»¥ trong prompt Ä‘Ã£ cho, Ä‘áº§u ra nÃ y sáº½ nháº­n Ä‘Æ°á»£c má»™t Ä‘iá»ƒm; ngÆ°á»£c láº¡i, nÃ³ sáº½ nháº­n Ä‘Æ°á»£c sá»‘ khÃ´ng.

PhÆ°Æ¡ng phÃ¡p Ä‘Ã¡nh giÃ¡ nÃ y cÃ³ hai Æ°u Ä‘iá»ƒm sau:(1) cho phÃ©p chÃºng tÃ´i táº­p trung vÃ o viá»‡c phÃ¢n tÃ­ch liá»‡u viá»‡c táº¡o sinh cá»§a mÃ´ hÃ¬nh cÃ³ tuÃ¢n theo prompt hay khÃ´ng, tá»« Ä‘Ã³ xÃ¡c Ä‘á»‹nh má»©c Ä‘á»™ quÃªn trong quÃ¡ trÃ¬nh táº¡o sinh. (2) báº±ng cÃ¡ch khÃ´ng táº­p trung vÃ o viá»‡c há»c phong cÃ¡ch ngÃ´n ngá»¯ cá»§a bá»™ dá»¯ liá»‡u cá»§a mÃ´ hÃ¬nh trong quÃ¡ trÃ¬nh tinh chá»‰nh, chÃºng tÃ´i cÃ³ thá»ƒ so sÃ¡nh nÃ³ vá»›i cÃ¡c mÃ´ hÃ¬nh khÃ¡c chÆ°a Ä‘Æ°á»£c tinh chá»‰nh bá»Ÿi MuSI.

Tuy nhiÃªn, viá»‡c phÃ¢n tÃ­ch thá»§ cÃ´ng má»™t khá»‘i lÆ°á»£ng lá»›n Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh Ä‘á»ƒ kiá»ƒm tra tÃ­nh tuÃ¢n thá»§ khÃ¡ thÃ¡ch thá»©c vÃ  tá»‘n thá»i gian. Do Ä‘Ã³, chÃºng tÃ´i táº­n dá»¥ng ChatGPT vá»›i cÃ¡c prompt phÃ¹ há»£p Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu phÃ¢n tÃ­ch tá»± Ä‘á»™ng thÃ´. ThÃ´ng qua xÃ¡c nháº­n cá»§a chÃºng tÃ´i, cÃ¡ch tiáº¿p cáº­n nÃ y Ä‘Ã£ chá»©ng minh Ä‘á»™ chÃ­nh xÃ¡c tÆ°Æ¡ng Ä‘á»‘i Ä‘Ã¡ng tin cáº­y nhÆ° má»™t Ä‘Ã¡nh giÃ¡ tá»± Ä‘á»™ng thÃ´.

ÄÃ¡nh giÃ¡ cá»§a Con ngÆ°á»i VÃ¬ chÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng ChatGPT khÃ´ng Ä‘Æ°a ra Ä‘Æ°á»£c cÃ¡c phÃ¡n Ä‘oÃ¡n chÃ­nh xÃ¡c vá» má»™t sá»‘ cÃ¢u há»i nháº¥t Ä‘á»‹nh, cháº³ng háº¡n nhÆ° nhá»¯ng cÃ¢u há»i liÃªn quan Ä‘áº¿n tÃ­nh toÃ¡n toÃ¡n há»c, vÃ  cÅ©ng vÃ¬ má»¥c Ä‘Ã­ch Ä‘áº¡t Ä‘Æ°á»£c phÃ¢n tÃ­ch toÃ n diá»‡n vÃ  chi tiáº¿t hÆ¡n cho ba biáº¿n thá»ƒ RWKV, chÃºng tÃ´i Ä‘Ã£ tiáº¿n hÃ nh Ä‘Ã¡nh giÃ¡ thá»§ cÃ´ng. ChÃºng tÃ´i Ä‘Ã£ yÃªu cáº§u nÄƒm ngÆ°á»i chÃº thÃ­ch phÃ¢n tÃ­ch vÃ  so sÃ¡nh

--- TRANG 6 ---
MÃ´ hÃ¬nh Perplexity Äá»™ chÃ­nh xÃ¡c ÄÃ¡nh giÃ¡ cá»§a Con ngÆ°á»i
TrÃ´i cháº£y ChÃ­nh xÃ¡c Cháº¥t lÆ°á»£ng
Vicuna-7B â€“ 0.760 â€“ â€“ â€“
ChatGLM-6B â€“ 0.938 â€“ â€“ â€“
GPT-2-0.4B (MuSI) â€“ 0.893 â€“ â€“ â€“
RWKV-4-0.4B 5.480 0.534 4.03 3.42 3.45
RWKV-4-0.4B (MuSI) 3.583 0.698 4.10 3.57 3.58
RWKV-4-0.4B (MuSI, ProSG) 3.161 0.761 4.22 3.87 3.78
Báº£ng 2: Káº¿t quáº£ thÃ­ nghiá»‡m. PPL cá»§a ba mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘áº§u tiÃªn khÃ´ng Ä‘Æ°á»£c tÃ­nh toÃ¡n. Bá»Ÿi vÃ¬ chÃºng cÃ³ cÃ¡ch tokenize khÃ¡c nhau, káº¿t quáº£ khÃ´ng thá»ƒ so sÃ¡nh Ä‘Æ°á»£c.

cháº¥t lÆ°á»£ng, Ä‘á»™ trÃ´i cháº£y, vÃ  Ä‘á»™ chÃ­nh xÃ¡c cá»§a káº¿t quáº£ Ä‘Æ°á»£c táº¡o ra má»™t cÃ¡ch mÃ¹ quÃ¡ng. Pháº¡m vi Ä‘iá»ƒm sá»‘ tá»« 0 Ä‘áº¿n 5 Ä‘Æ°á»£c thiáº¿t láº­p cho cáº£ ba chá»‰ sá»‘.

Ba chá»‰ sá»‘ nÃ y cÃ³ Ä‘á»‹nh nghÄ©a sau:
1) TrÃ´i cháº£y: Ä‘á»ƒ Ä‘o lÆ°á»ng Ä‘á»™ trÃ´i cháº£y cá»§a cÃ¡c cÃ¢u Ä‘Æ°á»£c táº¡o ra vÃ  xÃ¡c Ä‘á»‹nh báº¥t ká»³ trÆ°á»ng há»£p nÃ o cá»§a viá»‡c táº¡o sinh láº·p láº¡i.
2) ChÃ­nh xÃ¡c: giá»‘ng nhÆ° Ä‘Ã£ Ä‘á» cáº­p trong pháº§n phá»¥ trÆ°á»›c.
3) Cháº¥t lÆ°á»£ng: Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ liá»‡u cÃ¡c cÃ¢u tráº£ lá»i Ä‘Æ°á»£c cung cáº¥p cÃ³ máº¡ch láº¡c logic, chi tiáº¿t phÃ¹ há»£p, vÃ  phÃ¹ há»£p vá»›i sá»Ÿ thÃ­ch cá»§a con ngÆ°á»i hay khÃ´ng.

Káº¿t quáº£
Káº¿t quáº£ ÄÃ¡nh giÃ¡ Tá»± Ä‘á»™ng Báº£ng 2 trÃ¬nh bÃ y hiá»‡u suáº¥t cá»§a táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh. Tá»« báº£ng, chÃºng ta cÃ³ thá»ƒ quan sÃ¡t tháº¥y ráº±ng RWKV, sau khi tinh chá»‰nh vá»›i bá»™ dá»¯ liá»‡u MuSI, Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»ƒm sá»‘ Ä‘á»™ chÃ­nh xÃ¡c cao hÆ¡n. Äiá»u nÃ y cho tháº¥y ráº±ng bá»™ dá»¯ liá»‡u cá»§a chÃºng tÃ´i thá»±c sá»± Ä‘Ã£ giáº£m thiá»ƒu viá»‡c quÃªn prompt cá»§a mÃ´ hÃ¬nh. HÆ¡n ná»¯a, viá»‡c sá»­ dá»¥ng kiáº¿n trÃºc ProSG Ä‘Ã£ nÃ¢ng cao kháº£ nÄƒng ghi nhá»› cá»§a mÃ´ hÃ¬nh, cÃ³ thá»ƒ Ä‘Æ°á»£c suy ra tá»« sá»± cáº£i thiá»‡n trong cÃ¡c chá»‰ sá»‘. CÃ¡c phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i lÃ m cho hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh gáº§n hÆ¡n nhiá»u vá»›i ba transformer, cÃ³ kháº£ nÄƒng ghi nhá»› hoÃ n chá»‰nh. Äiá»u nÃ y hoÃ n toÃ n phÃ¹ há»£p vá»›i ká»³ vá»ng cá»§a chÃºng tÃ´i.

Káº¿t quáº£ ÄÃ¡nh giÃ¡ cá»§a Con ngÆ°á»i Káº¿t quáº£ Ä‘Ã¡nh giÃ¡ cá»§a con ngÆ°á»i Ä‘Æ°á»£c bÃ¡o cÃ¡o á»Ÿ pháº§n bÃªn pháº£i cá»§a Báº£ng 2. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng, cáº£ bá»™ dá»¯ liá»‡u vÃ  kiáº¿n trÃºc cá»§a chÃºng tÃ´i Ä‘á»u Ä‘Ã³ng gÃ³p vÃ o viá»‡c cáº£i thiá»‡n hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh. Káº¿t quáº£ phÃ¹ há»£p vá»›i chá»‰ sá»‘ tá»± Ä‘á»™ng.

NghiÃªn cá»©u TrÆ°á»ng há»£p Äá»ƒ cÃ³ Ä‘Æ°á»£c bÃ i trÃ¬nh bÃ y trá»±c quan vá» káº¿t quáº£ Ä‘Æ°á»£c táº¡o ra, chÃºng tÃ´i chá»n má»™t vÃ i prompt vÃ  ghi láº¡i Ä‘áº§u ra cá»§a má»™t sá»‘ mÃ´ hÃ¬nh khÃ¡c nhau, Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 3. Do háº¡n cháº¿ vá» khÃ´ng gian, chÃºng tÃ´i chá»‰ hiá»ƒn thá»‹ 1 máº«u vÃ  hiá»ƒn thá»‹ cÃ¡c pháº§n chÃ­nh cá»§a káº¿t quáº£, bá» qua nhiá»u chi tiáº¿t Ã­t quan trá»ng hÆ¡n. Káº¿t quáº£ Ä‘áº§y Ä‘á»§ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong tÃ i liá»‡u bá»• sung. ChÃºng ta cÃ³ thá»ƒ quan sÃ¡t tháº¥y má»™t sá»± cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ trong Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh sau khi káº¿t há»£p kiáº¿n trÃºc ProSG, Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u á»©ng mong muá»‘n cá»§a viá»‡c ghi nhá»› prompt. Äiá»u nÃ y má»™t láº§n ná»¯a chá»©ng minh tÃ­nh hiá»‡u quáº£ cá»§a khung lÃ m viá»‡c cá»§a chÃºng tÃ´i.

Káº¿t luáº­n
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i phÃ¢n tÃ­ch cá»¥ thá»ƒ váº¥n Ä‘á» quÃªn prompt trong quÃ¡ trÃ¬nh táº¡o sinh. ChÃºng tÃ´i xÃ¢y dá»±ng má»™t bá»™ dá»¯ liá»‡u hÆ°á»›ng dáº«n Ä‘a giai Ä‘oáº¡n (MuSI) vÃ  Ä‘á» xuáº¥t má»™t kiáº¿n trÃºc dá»±a trÃªn tá»•ng há»£p gradient (ProSG) Ä‘á»ƒ giáº£m thiá»ƒu viá»‡c quÃªn prompt. CÃ¡c thÃ­ nghiá»‡m rá»™ng rÃ£i chá»©ng minh ráº±ng cÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i thÃ nh cÃ´ng trong viá»‡c nÃ¢ng cao kháº£ nÄƒng ghi nhá»› prompt cá»§a mÃ´ hÃ¬nh, cho phÃ©p cÃ¡c tÃ¡c vá»¥ táº¡o sinh tá»‘t hÆ¡n dÆ°á»›i sá»± kiá»ƒm soÃ¡t cá»§a prompt.

Háº¡n cháº¿
Máº·c dÃ¹ phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ Ä‘áº§y há»©a háº¹n, do háº¡n cháº¿ vá» tÃ i nguyÃªn, chÃºng tÃ´i khÃ´ng thá»ƒ tiáº¿n hÃ nh cÃ¡c thÃ­ nghiá»‡m liÃªn quan trÃªn cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n hÆ¡n nhÆ° 13B hoáº·c 33B. NghiÃªn cá»©u trong tÆ°Æ¡ng lai nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»ƒ khÃ¡m phÃ¡ viá»‡c quÃªn prompt vÃ  giáº£i phÃ¡p tÆ°Æ¡ng á»©ng cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n.

TÃ i liá»‡u tham kháº£o
[CÃ¡c tÃ i liá»‡u tham kháº£o Ä‘Æ°á»£c dá»‹ch tá»« tiáº¿ng Anh sang tiáº¿ng Viá»‡t]

--- TRANG 7 ---
HÆ°á»›ng dáº«n
Ba loáº¡i thÃ³i quen táº­p thá»ƒ dá»¥c phá»• biáº¿n lÃ  gÃ¬? HÃ£y mÃ´ táº£ ngáº¯n gá»n tá»«ng loáº¡i vÃ  Ä‘á» xuáº¥t má»™t loáº¡i cho ngÆ°á»i muá»‘n cáº£i thiá»‡n thá»ƒ lá»±c tim máº¡ch.

RWKV-4-0.4B (MuSI, ProSG)
Ba loáº¡i thÃ³i quen táº­p thá»ƒ dá»¥c phá»• biáº¿n lÃ :
1. Táº­p thá»ƒ dá»¥c tim máº¡ch: Loáº¡i nÃ y ...
2. Táº­p sá»©c máº¡nh: Loáº¡i nÃ y ...
3. Yoga: Yoga lÃ  má»™t ...
Äá»‘i vá»›i ngÆ°á»i muá»‘n cáº£i thiá»‡n thá»ƒ lá»±c tim máº¡ch, tÃ´i sáº½ Ä‘á» xuáº¥t sá»± káº¿t há»£p cá»§a cÃ¡c bÃ i táº­p aerobic vÃ  cÃ¡c bÃ i táº­p táº­p sá»©c máº¡nh Ä‘á»ƒ cáº£i thiá»‡n thá»ƒ lá»±c tim máº¡ch vÃ  sá»©c khá»e tá»•ng thá»ƒ.

RWKV-4-0.4B (MuSI)
Ba loáº¡i thÃ³i quen táº­p thá»ƒ dá»¥c phá»• biáº¿n lÃ  cardio, táº­p sá»©c máº¡nh, vÃ  cÃ¡c bÃ i táº­p linh hoáº¡t.
1. Táº­p thá»ƒ dá»¥c Tim máº¡ch: Äiá»u nÃ y bao gá»“m ...
2. Táº­p Sá»©c máº¡nh: Äiá»u nÃ y bao gá»“m ...
3. Táº­p Linh hoáº¡t: Äiá»u nÃ y bao gá»“m ...

RWKV-4-0.4B
1. Äi bá»™: Äi bá»™ lÃ  má»™t bÃ i táº­p Ã­t tÃ¡c Ä‘á»™ng ...
2. Äáº¡p xe: Äáº¡p xe lÃ  má»™t bÃ i táº­p Ã­t tÃ¡c Ä‘á»™ng ...
3. BÆ¡i lá»™i: BÆ¡i lá»™i lÃ  má»™t bÃ i táº­p Ã­t tÃ¡c Ä‘á»™ng ...

Báº£ng 3: NghiÃªn cá»©u trÆ°á»ng há»£p

--- TRANG 8 ---
A.; Sutskever, I.; vÃ  Amodei, D. 2020. CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ lÃ  NgÆ°á»i Há»c VÃ i Máº«u. arXiv:2005.14165.

Chiang, W.-L.; Li, Z.; Lin, Z.; Sheng, Y.; Wu, Z.; Zhang, H.; Zheng, L.; Zhuang, S.; Zhuang, Y.; Gonzalez, J. E.; Stoica, I.; vÃ  Xing, E. P. 2023. Vicuna: Má»™t Chatbot MÃ£ nguá»“n Má»Ÿ GÃ¢y áº¤n tÆ°á»£ng vá»›i GPT-4 vá»›i 90%* Cháº¥t lÆ°á»£ng ChatGPT.

Dai, D.; Sun, Y.; Dong, L.; Hao, Y.; Ma, S.; Sui, Z.; vÃ  Wei, F. 2023. Táº¡i sao GPT CÃ³ thá»ƒ Há»c Trong Ngá»¯ cáº£nh? CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Thá»±c hiá»‡n Ngáº§m Ä‘á»‹nh Gradient Descent nhÆ° Meta-Optimizer. arXiv:2212.10559.

Dong, Q.; Li, L.; Dai, D.; Zheng, C.; Wu, Z.; Chang, B.; Sun, X.; Xu, J.; Li, L.; vÃ  Sui, Z. 2023. Má»™t Kháº£o sÃ¡t vá» Há»c Trong Ngá»¯ cáº£nh. arXiv:2301.00234.

Hu, E. J.; Shen, Y.; Wallis, P.; Allen-Zhu, Z.; Li, Y.; Wang, S.; Wang, L.; vÃ  Chen, W. 2021. LoRA: ThÃ­ch á»©ng Thá»© háº¡ng Tháº¥p cá»§a CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n. arXiv:2106.09685.

Jaderberg, M.; Czarnecki, W. M.; Osindero, S.; Vinyals, O.; Graves, A.; Silver, D.; vÃ  Kavukcuoglu, K. 2017. Giao diá»‡n NÆ¡-ron TÃ¡ch rá»i sá»­ dá»¥ng Gradient Tá»•ng há»£p. Trong Precup, D.; vÃ  Teh, Y. W., biÃªn táº­p, Ká»· yáº¿u Há»™i nghá»‹ Quá»‘c táº¿ láº§n thá»© 34 vá» Há»c MÃ¡y, táº­p 70 cá»§a Ká»· yáº¿u NghiÃªn cá»©u Há»c MÃ¡y, 1627â€“1635. PMLR.

Liu, P.; Yuan, W.; Fu, J.; Jiang, Z.; Hayashi, H.; vÃ  Neubig, G. 2021. Tiá»n-huáº¥n luyá»‡n, Prompt, vÃ  Dá»± Ä‘oÃ¡n: Má»™t Kháº£o sÃ¡t Há»‡ thá»‘ng vá» CÃ¡c PhÆ°Æ¡ng phÃ¡p Prompting trong Xá»­ lÃ½ NgÃ´n ngá»¯ Tá»± nhiÃªn. arXiv:2107.13586.

Peng, B.; Alcaide, E.; Anthony, Q.; Albalak, A.; Arcadinho, S.; Cao, H.; Cheng, X.; Chung, M.; Grella, M.; GV, K. K.; He, X.; Hou, H.; Kazienko, P.; Kocon, J.; Kong, J.; Koptyra, B.; Lau, H.; Mantri, K. S. I.; Mom, F.; Saito, A.; Tang, X.; Wang, B.; Wind, J. S.; Wozniak, S.; Zhang, R.; Zhang, Z.; Zhao, Q.; Zhou, P.; Zhu, J.; vÃ  Zhu, R.-J. 2023. RWKV: TÃ¡i phÃ¡t minh RNN cho Ká»· nguyÃªn Transformer. arXiv:2305.13048.

Radford, A.; Wu, J.; Child, R.; Luan, D.; Amodei, D.; vÃ  Sutskever, I. 2019. CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ lÃ  NgÆ°á»i Há»c Äa nhiá»‡m KhÃ´ng giÃ¡m sÃ¡t.

Rumelhart, D. E.; Hinton, G. E.; vÃ  Williams, R. J. 1986. Há»c biá»ƒu diá»…n báº±ng cÃ¡ch lan truyá»n ngÆ°á»£c lá»—i. nature, 323(6088): 533â€“536.

Sun, Y.; Dong, L.; Huang, S.; Ma, S.; Xia, Y.; Xue, J.; Wang, J.; vÃ  Wei, F. 2023. Máº¡ng Giá»¯ láº¡i: Má»™t NgÆ°á»i Káº¿ nhiá»‡m cá»§a Transformer cho CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n. arXiv:2307.08621.

Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.; Kaiser, L.; vÃ  Polosukhin, I. 2023. Attention LÃ  Táº¥t cáº£ Nhá»¯ng gÃ¬ Báº¡n Cáº§n. arXiv:1706.03762.

Zeng, A.; Liu, X.; Du, Z.; Wang, Z.; Lai, H.; Ding, M.; Yang, Z.; Xu, Y.; Zheng, W.; Xia, X.; et al. 2022. Glm-130b: Má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c song ngá»¯ má»Ÿ. arXiv preprint arXiv:2210.02414.

Zhai, S.; Talbott, W.; Srivastava, N.; Huang, C.; Goh, H.; Zhang, R.; vÃ  Susskind, J. 2021. Má»™t Transformer KhÃ´ng cÃ³ Attention. arXiv:2105.14103.
