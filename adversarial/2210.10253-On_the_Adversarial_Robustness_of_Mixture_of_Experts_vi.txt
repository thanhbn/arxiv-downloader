# Vá» TÃ­nh Bá»n Vá»¯ng Äá»‘i KhÃ¡ng cá»§a Há»—n Há»£p ChuyÃªn Gia

Joan Puigcerver
Google Research

Rodolphe Jenatton
Google Research

Carlos Riquelme
Google Research

Pranjal Awasthi
Google Research

Srinadh Bhojanapalli
Google Research

## TÃ³m táº¯t

TÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng lÃ  má»™t tÃ­nh cháº¥t mong muá»‘n quan trá»ng cá»§a máº¡ng nÆ¡-ron. ÄÃ£ Ä‘Æ°á»£c chá»©ng minh thá»±c nghiá»‡m ráº±ng nÃ³ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi kÃ­ch thÆ°á»›c cá»§a chÃºng, vá»›i cÃ¡c máº¡ng lá»›n hÆ¡n thÆ°á»ng bá»n vá»¯ng hÆ¡n. Gáº§n Ä‘Ã¢y, Bubeck vÃ  Sellke [3] Ä‘Ã£ chá»©ng minh má»™t cáº­n dÆ°á»›i vá» háº±ng sá»‘ Lipschitz cá»§a cÃ¡c hÃ m khá»›p vá»›i dá»¯ liá»‡u huáº¥n luyá»‡n theo sá»‘ lÆ°á»£ng tham sá»‘ cá»§a chÃºng. Äiá»u nÃ y Ä‘áº·t ra má»™t cÃ¢u há»i má»Ÿ thÃº vá»‹, liá»‡u cÃ¡c hÃ m cÃ³ nhiá»u tham sá»‘ hÆ¡n, nhÆ°ng khÃ´ng nháº¥t thiáº¿t cÃ³ chi phÃ­ tÃ­nh toÃ¡n cao hÆ¡n, cÃ³ thá»ƒ cÃ³ tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n khÃ´ng? ChÃºng tÃ´i nghiÃªn cá»©u cÃ¢u há»i nÃ y cho cÃ¡c mÃ´ hÃ¬nh Há»—n há»£p ChuyÃªn gia thÆ°a thá»›t (MoE), cho phÃ©p má»Ÿ rá»™ng kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh vá»›i chi phÃ­ tÃ­nh toÃ¡n gáº§n nhÆ° khÃ´ng Ä‘á»•i. ChÃºng tÃ´i chá»©ng minh lÃ½ thuyáº¿t ráº±ng trong má»™t sá»‘ Ä‘iá»u kiá»‡n nháº¥t Ä‘á»‹nh vá» Ä‘á»‹nh tuyáº¿n vÃ  cáº¥u trÃºc dá»¯ liá»‡u, MoE cÃ³ thá»ƒ cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c Ä‘á»‘i tÃ¡c dÃ y Ä‘áº·c cá»§a chÃºng. TÃ­nh bá»n vá»¯ng cá»§a MoE cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng khi cÃ¡c chuyÃªn gia cÃ³ trá»ng sá»‘ cao nháº¥t cho má»™t Ä‘áº§u vÃ o thá»±c hiá»‡n cÃ¡c hÃ m Ä‘á»§ khÃ¡c biá»‡t. Tiáº¿p theo, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ thá»±c nghiá»‡m tÃ­nh bá»n vá»¯ng cá»§a MoE trÃªn ImageNet báº±ng cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng vÃ  cho tháº¥y chÃºng thá»±c sá»± bá»n vá»¯ng hÆ¡n cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c cÃ³ cÃ¹ng chi phÃ­ tÃ­nh toÃ¡n. ChÃºng tÃ´i Ä‘Æ°a ra cÃ¡c quan sÃ¡t quan trá»ng cho tháº¥y tÃ­nh bá»n vá»¯ng cá»§a MoE Ä‘á»‘i vá»›i viá»‡c lá»±a chá»n chuyÃªn gia, lÃ m ná»•i báº­t sá»± dÆ° thá»«a cá»§a cÃ¡c chuyÃªn gia trong cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trong thá»±c táº¿.

## 1 Giá»›i thiá»‡u

TÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng Ä‘á» cáº­p Ä‘áº¿n tÃ­nh bá»n vá»¯ng dá»± Ä‘oÃ¡n cá»§a má»™t mÃ´ hÃ¬nh há»c mÃ¡y Ä‘á»‘i vá»›i nhá»¯ng thay Ä‘á»•i Ä‘á»‘i khÃ¡ng nhÆ°ng cÃ³ giá»›i háº¡n Ä‘á»‘i vá»›i Ä‘áº§u vÃ o. CÃ¡c máº¡ng nÆ¡-ron Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i cÃ¡c má»¥c tiÃªu phÃ¢n loáº¡i tiÃªu chuáº©n Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh lÃ  cÃ³ tÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng kÃ©m [25], má»™t tÃ­nh cháº¥t Ä‘Æ°á»£c cho lÃ  do sá»± tham sá»‘ hÃ³a quÃ¡ má»©c cá»§a chÃºng. NgÆ°á»£c láº¡i, trong thá»±c táº¿, cÃ¡c mÃ´ hÃ¬nh lá»›n hÆ¡n, cÃ³ nhiá»u tham sá»‘ hÆ¡n vÃ  chi phÃ­ tÃ­nh toÃ¡n cao hÆ¡n, Ä‘Ã£ cho tháº¥y tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n [20, 26, 1, 12].

Trong má»™t cÃ´ng trÃ¬nh gáº§n Ä‘Ã¢y, Bubeck vÃ  Sellke [3] Ä‘Ã£ nghiÃªn cá»©u hiá»‡n tÆ°á»£ng nÃ y tá»« gÃ³c Ä‘á»™ lÃ½ thuyáº¿t, báº±ng cÃ¡ch phÃ¢n tÃ­ch má»‘i quan há»‡ giá»¯a kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh vÃ  háº±ng sá»‘ Lipschitz cá»§a nÃ³ - thÆ°á»›c Ä‘o Ä‘á»™ nháº¡y cáº£m cá»§a má»™t hÃ m Ä‘á»‘i vá»›i nhá»¯ng thay Ä‘á»•i trong Ä‘áº§u vÃ o. Äáº·c biá»‡t, cÃ¡c tÃ¡c giáº£ Ä‘Ã£ chá»©ng minh ráº±ng báº¥t ká»³ hÃ m nÃ o vá»›i P tham sá»‘, ghi nhá»› N Ä‘iá»ƒm dá»¯ liá»‡u Ä‘áº§u vÃ o trong D chiá»u, cÃ³ háº±ng sá»‘ Lipschitz Ã­t nháº¥t lÃ  O(âˆš(ND/P)). Äiá»u nÃ y cho tháº¥y ráº±ng, trÃªn má»™t táº­p dá»¯ liá»‡u nháº¥t Ä‘á»‹nh, cÃ¡c mÃ´ hÃ¬nh lá»›n hÆ¡n cÃ³ thá»ƒ cÃ³ tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n (háº±ng sá»‘ Lipschitz nhá» hÆ¡n). LÆ°u Ã½ ráº±ng vÃ¬ Ä‘Ã¢y chá»‰ lÃ  cáº­n dÆ°á»›i, nÃ³ khÃ´ng Ä‘áº£m báº£o ráº±ng cÃ¡c mÃ´ hÃ¬nh lá»›n hÆ¡n thá»±c sá»± sáº½ cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n. ThÃº vá»‹ lÃ  káº¿t quáº£ nÃ y khÃ´ng phá»¥ thuá»™c vÃ o cÃ¡c tÃ­nh cháº¥t khÃ¡c cá»§a hÃ m, cháº³ng háº¡n nhÆ° chi phÃ­ tÃ­nh toÃ¡n hoáº·c kiáº¿n trÃºc cá»¥ thá»ƒ cá»§a nÃ³.

Vá»›i káº¿t quáº£ trÃªn, viá»‡c tá»± há»i lÃ  tá»± nhiÃªn: liá»‡u cÃ³ thá»ƒ tÄƒng kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh mÃ  khÃ´ng tÄƒng chi phÃ­ tÃ­nh toÃ¡n vÃ  cÃ³ Ä‘Æ°á»£c tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n khÃ´ng? Má»™t lá»›p mÃ´ hÃ¬nh ngÃ y cÃ ng phá»• biáº¿n nhÆ° váº­y lÃ  Há»—n há»£p ChuyÃªn gia (MoE) [23]. CÃ¡c mÃ´ hÃ¬nh MoE cÃ³ nhiá»u mÃ´ hÃ¬nh con chuyÃªn gia vÃ  má»™t hÃ m Ä‘á»‹nh tuyáº¿n chá»n cho má»—i Ä‘áº§u vÃ o má»™t táº­p con nhá» cÃ¡c chuyÃªn gia vÃ  chá»‰ Ä‘á»‹nh tuyáº¿n Ä‘áº§u vÃ o Ä‘áº¿n há». CÃ¡c máº¡ng nÆ¡-ron vá»›i cÃ¡c lá»›p MoE, nhÆ° Switch Transformer [10] trong NLP vÃ  V-MoE [22] trong Thá»‹ giÃ¡c MÃ¡y tÃ­nh, Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t vÆ°á»£t trá»™i so vá»›i cÃ¡c Ä‘á»‘i tÃ¡c dÃ y Ä‘áº·c cá»§a chÃºng, báº±ng cÃ¡ch cho phÃ©p má»Ÿ rá»™ng kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh mÃ  khÃ´ng tÄƒng chi phÃ­ tÃ­nh toÃ¡n. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i nghiÃªn cá»©u cÃ¢u há»i sau: cÃ¡c mÃ´ hÃ¬nh MoE cÃ³ bá»n vá»¯ng Ä‘á»‘i khÃ¡ng hÆ¡n cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c khÃ´ng?

NÃ³i chung, cÃ¡c mÃ´ hÃ¬nh MoE thÆ°a thá»›t khÃ´ng liÃªn tá»¥c, vÃ  do Ä‘Ã³ tháº­m chÃ­ khÃ´ng mÆ°á»£t. Nhá»¯ng thay Ä‘á»•i nhá» Ä‘á»‘i vá»›i Ä‘áº§u vÃ o cÃ³ thá»ƒ khiáº¿n bá»™ Ä‘á»‹nh tuyáº¿n chá»n má»™t chuyÃªn gia khÃ¡c cho má»™t vÃ­ dá»¥ nháº¥t Ä‘á»‹nh. Tháº­t khÃ´ng may, trong má»™t sá»‘ trÆ°á»ng há»£p, nhá»¯ng chuyÃªn gia nÃ y cÃ³ thá»ƒ ráº¥t khÃ¡c nhau, dáº«n Ä‘áº¿n nhá»¯ng thay Ä‘á»•i lá»›n Ä‘á»‘i vá»›i Ä‘áº§u ra. Má»™t yáº¿u tá»‘ khÃ¡c áº£nh hÆ°á»Ÿng Ä‘áº¿n tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh MoE lÃ  hÃ¬nh há»c cá»§a dá»¯ liá»‡u Ä‘áº§u vÃ o vÃ  Ä‘á»‹nh tuyáº¿n cá»§a nÃ³ - cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c chia giá»¯a cÃ¡c chuyÃªn gia. Äiá»u nÃ y quyáº¿t Ä‘á»‹nh dá»¯ liá»‡u nÃ o má»™t chuyÃªn gia Ä‘Æ°á»£c huáº¥n luyá»‡n vÃ  do Ä‘Ã³ tÃ­nh bá»n vá»¯ng cá»§a há». Cuá»‘i cÃ¹ng, Ä‘Ã£ quan sÃ¡t tháº¥y ráº±ng - trá»« khi má»™t sá»‘ tá»•n tháº¥t phá»¥ trá»£ cÅ©ng Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»ƒ khuyáº¿n khÃ­ch sá»± cÃ¢n báº±ng - sá»‘ lÆ°á»£ng chuyÃªn gia Ä‘Æ°á»£c sá»­ dá»¥ng cÃ³ xu hÆ°á»›ng sá»¥p Ä‘á»• thÃ nh ráº¥t Ã­t, vÃ  nhá»¯ng cÃ¡i cÃ²n láº¡i chá»‰ bá»‹ bá» qua [22, 10]. Vá»›i nhá»¯ng váº¥n Ä‘á» á»•n Ä‘á»‹nh nÃ y, khÃ´ng rÃµ rÃ ng liá»‡u MoE, máº·c dÃ¹ cÃ³ nhiá»u tham sá»‘ hÆ¡n, cÃ³ bá»n vá»¯ng hÆ¡n cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c hay khÃ´ng.

Äá»ƒ nghiÃªn cá»©u lÃ½ thuyáº¿t tÃ¡c Ä‘á»™ng cá»§a cáº£ hai yáº¿u tá»‘ nÃ y, (1) á»•n Ä‘á»‹nh bá»™ Ä‘á»‹nh tuyáº¿n vÃ  (2) Ä‘á»‹nh tuyáº¿n dá»¯ liá»‡u, Ä‘á»‘i vá»›i tÃ­nh bá»n vá»¯ng, chÃºng tÃ´i xem xÃ©t cÃ¡c mÃ´ hÃ¬nh MoE mÆ°á»£t, nÆ¡i má»—i Ä‘áº§u ra chuyÃªn gia Ä‘Æ°á»£c cÃ¢n báº±ng theo xÃ¡c suáº¥t Ä‘á»‹nh tuyáº¿n cá»§a há». Äáº·c biá»‡t, cÃ¡c mÃ´ hÃ¬nh MoE nÆ¡i táº¥t cáº£ cÃ¡c chuyÃªn gia Ä‘á»u Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»“ng thá»i cho má»i Ä‘áº§u vÃ o. ChÃºng tÃ´i phÃ¢n tÃ­ch cÃ¡c mÃ´ hÃ¬nh vá»›i Ä‘á»‹nh tuyáº¿n cá»‘ Ä‘á»‹nh chá»©ng minh ráº±ng MoE vá»›i cÃ¡c chuyÃªn gia tuyáº¿n tÃ­nh cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n náº¿u dá»¯ liá»‡u Ä‘Æ°á»£c tÃ¡ch biá»‡t tá»‘t vÃ  Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n phÃ¹ há»£p. Trong trÆ°á»ng há»£p cá»±c Ä‘oan, MoE vá»›i E chuyÃªn gia cÃ³ thá»ƒ cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n má»™t há»‡ sá»‘ 1/âˆšE so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c tÆ°Æ¡ng Ä‘Æ°Æ¡ng. ChÃºng tÃ´i cÅ©ng Ä‘áº·c trÆ°ng cho áº£nh hÆ°á»Ÿng cá»§a sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c chuyÃªn gia vá» máº·t tÃ­nh bá»n vá»¯ng, cho tháº¥y ráº±ng MoE cÃ³ thá»ƒ cÃ³ háº±ng sá»‘ Lipschitz cao khi hai chuyÃªn gia ráº¥t khÃ¡c nhau Ä‘á»‘i vá»›i cÃ¡c Ä‘áº§u vÃ o cÃ¢n báº±ng cÃ¡c chuyÃªn gia má»™t cÃ¡ch tÆ°Æ¡ng tá»± vÃ  cao. ChÃºng tÃ´i chá»‰ ra ráº±ng cáº£ hai yáº¿u tá»‘ nÃ y, Ä‘á»‹nh tuyáº¿n dá»¯ liá»‡u vÃ  sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c chuyÃªn gia liÃªn quan, Ä‘áº·c trÆ°ng cho háº±ng sá»‘ Lipschitz cá»§a cÃ¡c mÃ´ hÃ¬nh MoE.

Tiáº¿p theo, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ tÃ­nh bá»n vá»¯ng thá»±c nghiá»‡m báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng [20]. ChÃºng tÃ´i chá»©ng minh thá»±c nghiá»‡m ráº±ng trÃªn táº­p dá»¯ liá»‡u ImageNet [6], MoE bá»n vá»¯ng hÆ¡n cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c cÃ³ cÃ¹ng chi phÃ­ tÃ­nh toÃ¡n. ThÃº vá»‹ lÃ  chÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng dáº«n Ä‘áº¿n nhá»¯ng thay Ä‘á»•i Ä‘á»‹nh tuyáº¿n Ä‘Ã¡ng ká»ƒ cá»§a cÃ¡c Ä‘áº§u vÃ o, nhÆ°ng khÃ´ng dáº«n Ä‘áº¿n tÃ­nh bá»n vá»¯ng tháº¥p hÆ¡n cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c. Äiá»u nÃ y cho tháº¥y ráº±ng trong thá»±c táº¿, MoE bá»n vá»¯ng vá»›i viá»‡c lá»±a chá»n chuyÃªn gia á»Ÿ má»™t má»©c Ä‘á»™ nÃ o Ä‘Ã³. Tiáº¿p theo, chÃºng tÃ´i thá»±c hiá»‡n huáº¥n luyá»‡n Ä‘á»‘i khÃ¡ng tiÃªu chuáº©n cho cáº£ mÃ´ hÃ¬nh dÃ y Ä‘áº·c vÃ  MoE vÃ  má»™t láº§n ná»¯a quan sÃ¡t tháº¥y ráº±ng MoE bá»n vá»¯ng hÆ¡n chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng.

CÃ¡c Ä‘Ã³ng gÃ³p chÃ­nh cá»§a cÃ´ng trÃ¬nh hiá»‡n táº¡i nhÆ° sau:

1. ChÃºng tÃ´i Ä‘á» xuáº¥t má»™t khung lÃ½ thuyáº¿t Ä‘Æ¡n giáº£n Ä‘á»ƒ hiá»ƒu tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh Há»—n há»£p ChuyÃªn gia (MoE). ChÃºng tÃ´i cung cáº¥p cÃ¡c Ä‘iá»u kiá»‡n Ä‘á»§ tá»•ng quÃ¡t vÃ  khÃ´ng táº§m thÆ°á»ng mÃ  theo Ä‘Ã³ MoE cÃ³ thá»ƒ chá»©ng minh Ä‘Æ°á»£c bá»n vá»¯ng hÆ¡n so vá»›i cÃ¡c Ä‘á»‘i tÃ¡c dÃ y Ä‘áº·c cá»§a chÃºng cho thiáº¿t láº­p chuyÃªn gia tuyáº¿n tÃ­nh.

2. ChÃºng tÃ´i thá»±c hiá»‡n cÃ¡c thÃ­ nghiá»‡m rá»™ng rÃ£i Ä‘á»ƒ chá»©ng minh ráº±ng trong thá»±c táº¿ MoE thá»±c sá»± cÃ³ tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c Ä‘á»‘i vá»›i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng bá»‹ giá»›i háº¡n chuáº©n. ChÃºng tÃ´i cÅ©ng khÃ¡m phÃ¡ ra cÃ¡c tÃ­nh cháº¥t háº¥p dáº«n cá»§a cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng Ä‘á»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh MoE vÃ  cho tháº¥y ráº±ng ngay cáº£ Ä‘á»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh MoE bá»n vá»¯ng, cÃ¡c cuá»™c táº¥n cÃ´ng ráº¥t thÆ°á»ng xuyÃªn thay Ä‘á»•i Ä‘á»‹nh tuyáº¿n cá»§a cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u, do Ä‘Ã³ chá»‰ ra má»©c Ä‘á»™ dÆ° thá»«a cao trong cÃ¡c mÃ´ hÃ¬nh nhÆ° váº­y.

## 2 Kiáº¿n thá»©c cÆ¡ báº£n

### 2.1 Há»—n há»£p ChuyÃªn gia

Há»—n há»£p ChuyÃªn gia káº¿t há»£p Ä‘áº§u ra cá»§a cÃ¡c (tiá»ƒu) mÃ´ hÃ¬nh, tá»©c lÃ  cÃ¡c chuyÃªn gia, thÃ´ng qua tá»•ng cÃ³ trá»ng sá»‘ cá»§a Ä‘áº§u ra cá»§a chÃºng [14, 15, 28, 9]. Há»—n há»£p ChuyÃªn gia ThÆ°a thá»›t Ä‘iá»u kiá»‡n trá»ng sá»‘ cá»§a tá»•ng trong cÃ¡c Ä‘áº§u vÃ o vÃ  chá»‰ kÃ­ch hoáº¡t K (trong sá»‘ E) chuyÃªn gia, trong Ä‘Ã³ K thÆ°á»ng lÃ  má»™t sá»‘ nguyÃªn ráº¥t nhá» so vá»›i E (nhÆ° K = 1 hoáº·c K = 2) [23, 10]. HÃ¬nh thá»©c tÃ­nh toÃ¡n cÃ³ Ä‘iá»u kiá»‡n nÃ y cho phÃ©p dá»… dÃ ng tÄƒng sá»‘ lÆ°á»£ng tham sá»‘ trong mÃ´ hÃ¬nh (gáº§n nhÆ°) Ä‘á»™c láº­p vá»›i chi phÃ­ tÃ­nh toÃ¡n cá»§a nÃ³ [21]. PhÆ°Æ¡ng phÃ¡p nÃ y gáº§n Ä‘Ã¢y Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»ƒ tÄƒng Ä‘Ã¡ng ká»ƒ kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh vÃ  cháº¥t lÆ°á»£ng cá»§a cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c sá»­ dá»¥ng trong Xá»­ lÃ½ NgÃ´n ngá»¯ Tá»± nhiÃªn [23, 18, 19, 10, 8] vÃ  cÃ¡c á»©ng dá»¥ng Thá»‹ giÃ¡c MÃ¡y tÃ­nh [22, 27].

Cá»¥ thá»ƒ hÆ¡n, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a cÃ¡c phiÃªn báº£n thÆ°a thá»›t vÃ  mÆ°á»£t (hoáº·c dÃ y Ä‘áº·c) cá»§a há»—n há»£p chuyÃªn gia dÆ°á»›i Ä‘Ã¢y. Trong khi cÃ¡c cÃ´ng trÃ¬nh thá»±c nghiá»‡m trÆ°á»›c Ä‘Ã¢y Ä‘Ã´i khi Ä‘Ã£ chá»n nhiá»u hÆ¡n má»™t chuyÃªn gia cho má»—i Ä‘áº§u vÃ o (K > 1), Ä‘á»ƒ Ä‘Æ¡n giáº£n chÃºng tÃ´i giá»›i háº¡n báº£n thÃ¢n trong trÆ°á»ng há»£p chá»‰ má»™t chuyÃªn gia Ä‘Æ°á»£c chá»n cho má»—i Ä‘áº§u vÃ o (K = 1). Gáº§n Ä‘Ã¢y, cÃ¡c mÃ´ hÃ¬nh thá»±c táº¿ cÅ©ng cÃ³ xu hÆ°á»›ng theo thiáº¿t láº­p nÃ y Ä‘á»ƒ khá»›p vá»›i FLOP cá»§a cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c [10].

**MoE ThÆ°a thá»›t.** Trong cÃ¡c mÃ´ hÃ¬nh nÃ y, chá»‰ má»™t chuyÃªn gia Ä‘Æ°á»£c chá»n cho má»™t vÃ­ dá»¥ x nháº¥t Ä‘á»‹nh dá»±a trÃªn xÃ¡c suáº¥t Ä‘á»‹nh tuyáº¿n p_i(x) cá»§a nÃ³. CÃ¡c mÃ´ hÃ¬nh nÃ y khÃ´ng pháº£i lÃ  hÃ m liÃªn tá»¥c cá»§a Ä‘áº§u vÃ o. Má»™t thay Ä‘á»•i nhá» trong Ä‘áº§u vÃ o cÃ³ thá»ƒ dáº«n Ä‘áº¿n nhá»¯ng thay Ä‘á»•i lá»›n trong Ä‘áº§u ra, do nhá»¯ng thay Ä‘á»•i trong cÃ¡c chuyÃªn gia Ä‘Æ°á»£c chá»n. Má»™t lá»›p MoE thÆ°a thá»›t Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ :

f(x) = âˆ‘_{i=1}^E ğŸ™{p_i(x) â‰¥ p_j(x), âˆ€j â‰  i} f_i(x)     (1)

á» Ä‘Ã¢y f_i(x) lÃ  cÃ¡c hÃ m chuyÃªn gia riÃªng láº». ğŸ™ lÃ  hÃ m chá»‰ thá»‹ cÃ³ giÃ¡ trá»‹ 1 náº¿u Ä‘iá»u kiá»‡n Ä‘Æ°á»£c thá»a mÃ£n vÃ  0 náº¿u ngÆ°á»£c láº¡i. LÆ°u Ã½ ráº±ng Ä‘á»ƒ phÃ¡ vá»¡ sá»± rÃ ng buá»™c trong Ä‘á»‹nh nghÄ©a trÃªn, trong trÆ°á»ng há»£p nhiá»u chuyÃªn gia cÃ³ cÃ¹ng xÃ¡c suáº¥t tá»‘i Ä‘a, chÃºng tÃ´i chá»‰ Ä‘Æ¡n giáº£n lÃ  láº¥y máº«u Ä‘á»“ng Ä‘á»u má»™t trong cÃ¡c chuyÃªn gia cÃ³ xÃ¡c suáº¥t tá»‘i Ä‘a. Trong thá»±c táº¿, cÃ¡c mÃ´ hÃ¬nh MoE cÃ³ thá»ƒ cÃ³ nhiá»u lá»›p thÆ°a thá»›t káº¿t há»£p vá»›i cÃ¡c lá»›p dÃ y Ä‘áº·c. HÆ¡n ná»¯a, nhiá»…u ngáº«u nhiÃªn Ä‘Ã´i khi Ä‘Æ°á»£c thÃªm vÃ o p_i [23, 22].

ChÃºng tÃ´i Ä‘á» cáº­p Ä‘áº¿n MoE chá»‰ vá»›i 1 chuyÃªn gia lÃ  cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c. Trong cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c, lÃ  tiÃªu chuáº©n trong tÃ i liá»‡u máº¡ng nÆ¡-ron, cÃ¹ng má»™t hÃ m Ä‘Æ°á»£c Ã¡p dá»¥ng cho táº¥t cáº£ cÃ¡c vÃ­ dá»¥ Ä‘áº§u vÃ o. Trong MoE thÆ°a thá»›t Ä‘Æ°á»£c giá»›i thiá»‡u á»Ÿ trÃªn, cÃ¡c pháº§n khÃ¡c nhau cá»§a máº¡ng/chuyÃªn gia Ä‘Æ°á»£c Ã¡p dá»¥ng cho má»—i vÃ­ dá»¥ Ä‘áº§u vÃ o tÃ¹y thuá»™c vÃ o chuyÃªn gia nÃ o Ä‘Æ°á»£c chá»n. TÃ­nh linh hoáº¡t nÃ y cho phÃ©p chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c MoE thÆ°a thá»›t lá»›n hÆ¡n, cÃ³ cÃ¹ng chi phÃ­ tÃ­nh toÃ¡n vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c, vÃ¬ chá»‰ má»™t pháº§n cá»§a MoE Ä‘Æ°á»£c kÃ­ch hoáº¡t/chá»n cho má»—i Ä‘áº§u vÃ o, vá»›i Ä‘á»™ chÃ­nh xÃ¡c tá»‘t hÆ¡n so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c [10, 22].

**MoE MÆ°á»£t.** Äá»ƒ phÃ¢n tÃ­ch lÃ½ thuyáº¿t vá» tÃ­nh bá»n vá»¯ng, chÃºng tÃ´i xem xÃ©t má»™t mÃ´ hÃ¬nh há»—n há»£p chuyÃªn gia mÆ°á»£t, vÃ¬ chÃºng lÃ  cÃ¡c hÃ m liÃªn tá»¥c. Trong trÆ°á»ng há»£p nÃ y, Ä‘áº§u ra cá»§a má»—i chuyÃªn gia f_i Ä‘Æ°á»£c cÃ¢n báº±ng theo xÃ¡c suáº¥t Ä‘á»‹nh tuyáº¿n cá»§a nÃ³:

f(x) = âˆ‘_{i=1}^E p_i(x)f_i(x)     (2)

XÃ¡c suáº¥t Ä‘á»‹nh tuyáº¿n p_i(x) thÆ°á»ng Ä‘Æ°á»£c tÃ­nh bá»Ÿi má»™t lá»›p Ä‘á»‹nh tuyáº¿n, vÃ­ dá»¥: p_i(x) = (Ïƒ(Sx))_i, trong Ä‘Ã³ Ïƒ lÃ  softmax vÃ  S âˆˆ â„^{EÃ—D} lÃ  má»™t biáº¿n cÃ³ thá»ƒ huáº¥n luyá»‡n. CÃ¡c lá»›p Ä‘á»‹nh tuyáº¿n tuyáº¿n tÃ­nh nhÆ° váº­y lÃ  lá»±a chá»n phá»• biáº¿n cho cÃ¡c mÃ´ hÃ¬nh MoE trong thá»±c táº¿ [10].

Máº·c dÃ¹ cÃ¡c mÃ´ hÃ¬nh nÃ y gáº§n Ä‘Ã¢y Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘i tÃ¢n cho cÃ¡c nhiá»‡m vá»¥ trong NLP [10] vÃ  thá»‹ giÃ¡c [22], nhÆ°ng khÃ´ng cÃ³ nhiá»u cÃ´ng trÃ¬nh phÃ¢n tÃ­ch tÃ­nh bá»n vá»¯ng cá»§a chÃºng. Gáº§n Ä‘Ã¢y, Allingham vÃ  cá»™ng sá»± [2] Ä‘Ã£ nghiÃªn cá»©u thá»±c nghiá»‡m tÃ­nh bá»n vá»¯ng cá»§a MoE Ä‘á»‘i vá»›i nhiá»…u loáº¡n tá»± nhiÃªn trong dá»¯ liá»‡u (vÃ­ dá»¥: Ä‘Ã¡nh giÃ¡ trÃªn cÃ¡c phiÃªn báº£n bá»‹ há»ng khÃ¡c nhau cá»§a CIFAR10 [17] vÃ  ImageNet [6]), vÃ  cho tháº¥y MoE bá»n vá»¯ng hÆ¡n Ä‘á»‘i vá»›i nhá»¯ng nhiá»…u loáº¡n tá»± nhiÃªn nÃ y so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c tÆ°Æ¡ng á»©ng. Theo hiá»ƒu biáº¿t tá»‘t nháº¥t cá»§a chÃºng tÃ´i, cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i lÃ  cÃ´ng trÃ¬nh Ä‘áº§u tiÃªn phÃ¢n tÃ­ch lÃ½ thuyáº¿t tÃ­nh bá»n vá»¯ng cá»§a MoE vÃ  khÃ¡m phÃ¡ thá»±c nghiá»‡m nÃ³ trong bá»‘i cáº£nh nhiá»…u loáº¡n Ä‘á»‘i khÃ¡ng.

**Tá»•n tháº¥t cÃ¢n báº±ng táº£i** Äá»ƒ ngÄƒn MoE khá»i sá»¥p Ä‘á»• vÃ  luÃ´n chá»n cÃ¹ng má»™t chuyÃªn gia cho táº¥t cáº£ Ä‘áº§u vÃ o, thÃ´ng thÆ°á»ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n sáº½ thÃªm má»™t tá»•n tháº¥t cÃ¢n báº±ng táº£i, khuyáº¿n khÃ­ch tá»· lá»‡ báº±ng nhau cá»§a cÃ¡c Ä‘áº§u vÃ o Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau. ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a vÃ  trÃ¬nh bÃ y cÃ¡c tá»•n tháº¥t nÃ y chi tiáº¿t trong phá»¥ lá»¥c E.

### 2.2 TÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng

TÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng mÃ´ hÃ¬nh hÃ³a tÃ­nh nháº¡y cáº£m cá»§a má»™t hÃ m Ä‘á»‘i vá»›i nhiá»…u loáº¡n Ä‘á»‘i khÃ¡ng Ä‘á»‘i vá»›i Ä‘áº§u vÃ o cá»§a nÃ³ [25, 20]. Cá»¥ thá»ƒ hÆ¡n, cho má»™t hÃ m f, hÃ m tá»•n tháº¥t â„“ vÃ  má»™t Ä‘áº§u vÃ o x âˆˆ â„^D, chÃºng ta cÃ³ thá»ƒ viáº¿t tá»•n tháº¥t Ä‘á»‘i khÃ¡ng phÃ¡t sinh táº¡i x vá»›i nhÃ£n y nhÆ° sau:

max_{z: ||z|| â‰¤ Îµ} â„“(f(x + z), y)     (3)

á» Ä‘Ã¢y Îµ lÃ  bÃ¡n kÃ­nh táº¥n cÃ´ng trÃªn má»—i Ä‘áº§u vÃ o. Äá»‘i vá»›i rÃ ng buá»™c chuáº©n (||z||), cÃ¡c lá»±a chá»n phá»• biáº¿n trong thá»±c táº¿ lÃ  cÃ¡c chuáº©n â„“_âˆ vÃ  â„“_2 [20, 4]. Äá»™ chÃ­nh xÃ¡c Ä‘á»‘i khÃ¡ng lÃ  Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh trÃªn dá»¯ liá»‡u vá»›i nhiá»…u loáº¡n thá»a mÃ£n phÆ°Æ¡ng trÃ¬nh trÃªn, tá»©c lÃ  khi hÃ m tá»•n tháº¥t â„“ lÃ  tá»•n tháº¥t phÃ¢n loáº¡i 0/1.

VÃ¬ tá»‘i Æ°u hÃ³a phÆ°Æ¡ng trÃ¬nh 3 cho máº¡ng nÆ¡-ron vá» máº·t tÃ­nh toÃ¡n lÃ  khÃ³ khÄƒn, cÃ¡c phÆ°Æ¡ng phÃ¡p phá»• biáº¿n Ä‘á»ƒ tÃ¬m cÃ¡c vÃ­ dá»¥ Ä‘á»‘i khÃ¡ng sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p tÃ¬m kiáº¿m cá»¥c bá»™ nhÆ° gradient ascent. PhÆ°Æ¡ng phÃ¡p Gradient Signed nhanh (FGSM) cÃ³ láº½ lÃ  Ä‘Æ¡n giáº£n nháº¥t, chá»‰ vá»›i má»™t bÆ°á»›c cáº­p nháº­t gradient [11]. Äá»‘i vá»›i nhiá»…u loáº¡n bá»‹ giá»›i háº¡n â„“_âˆ, cáº­p nháº­t FGSM nhÆ° sau:

x + z = x + Îµ Â· sgn(âˆ‡_x â„“(f(x), y))     (4)

sgn(Â·) lÃ  hÃ m dáº¥u. PhÆ°Æ¡ng phÃ¡p Projected Gradient Descent (PGD) lÃ  má»™t cuá»™c táº¥n cÃ´ng máº¡nh hÆ¡n thá»±c hiá»‡n nhiá»u (Ï„) bÆ°á»›c gradient ascent Ä‘á»ƒ tÃ¬m nhiá»…u loáº¡n [20]. Quy táº¯c cáº­p nháº­t cho nhiá»…u loáº¡n bá»‹ giá»›i háº¡n â„“_âˆ nhÆ° sau, báº¯t Ä‘áº§u vá»›i x_0 = x:

x_{t+1} = Î _C(x_t + Î± Â· sgn(âˆ‡_x â„“(f(x), y))), âˆ€t âˆˆ [0, Ï„]     (5)

Î± Ä‘Æ°á»£c chá»n lÃ  Îµ/Ï„. á» Ä‘Ã¢y C lÃ  táº­p rÃ ng buá»™c {z : ||z||_âˆ â‰¤ Îµ} vÃ  Î  lÃ  toÃ¡n tá»­ chiáº¿u.

CÃ¡c cÃ´ng trÃ¬nh hiá»‡n cÃ³ Ä‘Ã£ thiáº¿t láº­p ráº±ng máº¡ng nÆ¡-ron nháº¡y cáº£m vá»›i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng dáº«n Ä‘áº¿n sá»± sá»¥t giáº£m Ä‘Ã¡ng ká»ƒ trong Ä‘á»™ chÃ­nh xÃ¡c cá»§a chÃºng [25]. ThÃº vá»‹ lÃ  viá»‡c tÄƒng kÃ­ch thÆ°á»›c cá»§a máº¡ng nÆ¡-ron, do Ä‘Ã³ tÄƒng kháº£ nÄƒng cá»§a chÃºng, dáº«n Ä‘áº¿n cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c Ä‘á»‘i khÃ¡ng, cho tháº¥y ráº±ng cÃ¡c máº¡ng nÆ¡-ron lá»›n hÆ¡n bá»n vá»¯ng hÆ¡n [20, 26, 1, 12]. Trong má»™t cÃ´ng trÃ¬nh gáº§n Ä‘Ã¢y, Bubeck vÃ  Sellke [3] Ä‘Ã£ nghiÃªn cá»©u hiá»‡n tÆ°á»£ng nÃ y vá» máº·t lÃ½ thuyáº¿t. Há» Ä‘Ã£ chá»©ng minh má»™t cáº­n dÆ°á»›i vá» háº±ng sá»‘ Lipschitz cá»§a báº¥t ká»³ hÃ m nÃ o khá»›p vá»›i dá»¯ liá»‡u huáº¥n luyá»‡n mÃ  tá»· lá»‡ nghá»‹ch vá»›i 1/âˆšP vá»›i sá»‘ lÆ°á»£ng tham sá»‘ hÃ m P. Tuy nhiÃªn, khÃ´ng rÃµ liá»‡u cÃ¡c hÃ m cÃ³ nhiá»u tham sá»‘ hÆ¡n, nhÆ°ng khÃ´ng nháº¥t thiáº¿t cÃ³ chi phÃ­ tÃ­nh toÃ¡n cao hÆ¡n (vÃ­ dá»¥: MoE), cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n hay khÃ´ng. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i phÃ¢n tÃ­ch tÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng cá»§a MoE, cáº£ vá» máº·t lÃ½ thuyáº¿t vÃ  thá»±c nghiá»‡m.

**KÃ½ hiá»‡u.** ChÃºng tÃ´i sá»­ dá»¥ng cÃ¡c chá»¯ cÃ¡i in Ä‘áº­m nhá», vÃ­ dá»¥: x, Ä‘á»ƒ biá»ƒu thá»‹ vectÆ¡ vÃ  cÃ¡c chá»¯ cÃ¡i in Ä‘áº­m viáº¿t hoa Ä‘á»ƒ biá»ƒu thá»‹ ma tráº­n, vÃ­ dá»¥: W. VÃ´ hÆ°á»›ng Ä‘Æ°á»£c biá»ƒu thá»‹ báº±ng cÃ¡c chá»¯ cÃ¡i thÆ°á»ng. [N] biá»ƒu thá»‹ táº­p sá»‘ nguyÃªn tá»« 1 Ä‘áº¿n N. ||Â·|| biá»ƒu thá»‹ chuáº©n â„“_2 trá»« khi Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh khÃ¡c.

## 3 PhÃ¢n tÃ­ch tÃ­nh bá»n vá»¯ng

Trong pháº§n nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y cÃ¡c káº¿t quáº£ chÃ­nh cá»§a chÃºng tÃ´i vá» tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh há»—n há»£p chuyÃªn gia. TrÆ°á»›c tiÃªn, chÃºng tÃ´i trÃ¬nh bÃ y má»™t cáº­n vá» háº±ng sá»‘ Lipschitz cá»§a MoE cho cÃ¡c hÃ m chuyÃªn gia f_i tá»•ng quÃ¡t. Máº·c dÃ¹ Ä‘Ã¢y lÃ  cáº­n trÃªn cho cÃ¡c hÃ m tá»•ng quÃ¡t, nÃ³ váº«n lÃ m ná»•i báº­t hai thÃ nh pháº§n chÃ­nh áº£nh hÆ°á»Ÿng Ä‘áº¿n tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh MoE.

### 3.1 á»”n Ä‘á»‹nh bá»™ Ä‘á»‹nh tuyáº¿n

Trong pháº§n nÃ y, chÃºng tÃ´i tÃ­nh háº±ng sá»‘ Lipschitz cá»§a MoE mÆ°á»£t vá»›i Ä‘á»‹nh tuyáº¿n cÃ³ thá»ƒ há»c. Cho:

f(x) = âˆ‘_{i=1}^E p_i(x)f_i(x) trong Ä‘Ã³ p_i(x) = exp(âŸ¨s_i, xâŸ©) / âˆ‘_{j=1}^E exp(âŸ¨s_j, xâŸ©)     (6)

vÃ  {s_i}_{iâˆˆ[E]}, vá»›i má»—i s_i âˆˆ â„^D, lÃ  cÃ¡c biáº¿n cÃ³ thá»ƒ há»c quyáº¿t Ä‘á»‹nh Ä‘á»‹nh tuyáº¿n cá»§a má»™t vÃ­ dá»¥ Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau. Sau Ä‘Ã³ chÃºng tÃ´i chá»©ng minh cáº­n trÃªn sau vá» háº±ng sá»‘ Lipschitz cá»§a cÃ¡c mÃ´ hÃ¬nh MoE vá»›i Ä‘á»‹nh tuyáº¿n cÃ³ thá»ƒ há»c.

**Bá»• Ä‘á» 1.** Cho {f_i}_{iâˆˆ[E]} lÃ  cÃ¡c hÃ m mÆ°á»£t vá»›i háº±ng sá»‘ Lipschitz {L_{f_i}}_{iâˆˆ[E]} vÃ  cho L_f lÃ  háº±ng sá»‘ Lipschitz cá»§a f. Cho sÌ„(x) = âˆ‘_j p_j(x)s_j. Khi Ä‘Ã³ f(x) trong phÆ°Æ¡ng trÃ¬nh 6 thá»a mÃ£n:

||âˆ‡_x f(x)|| â‰¤ âˆ‘_{i=1}^E p_i(x)L_{f_i} + ||âˆ‘_{i=1}^E p_i(x)f_i(x)(s_i - sÌ„(x))||

vÃ  do Ä‘Ã³

L_f â‰¤ max_{iâˆˆ[E]} {L_{f_i}} + sup_x ||âˆ‘_{i=1}^E p_i(x)f_i(x)(s_i - sÌ„(x))||     (7)

Bá»• Ä‘á» trÃªn giá»›i háº¡n háº±ng sá»‘ Lipschitz cá»§a cÃ¡c mÃ´ hÃ¬nh MoE vá»›i hai sá»‘ háº¡ng phá»¥ thuá»™c vÃ o (1) Ä‘á»‹nh tuyáº¿n dá»¯ liá»‡u vÃ  (2) á»•n Ä‘á»‹nh bá»™ Ä‘á»‹nh tuyáº¿n. Sá»‘ háº¡ng Ä‘áº§u tiÃªn á»Ÿ trÃªn lÃ  tá»« háº±ng sá»‘ Lipschitz riÃªng láº» cá»§a cÃ¡c chuyÃªn gia. Äiá»u nÃ y phá»¥ thuá»™c vÃ o cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n vÃ¹ng hoáº·c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau, mÃ  chÃºng tÃ´i sáº½ tháº£o luáº­n chi tiáº¿t hÆ¡n trong pháº§n tiáº¿p theo. Sá»‘ háº¡ng thá»© hai phÃ¡t sinh tá»« bá»™ Ä‘á»‹nh tuyáº¿n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh xÃ¡c suáº¥t cho cÃ¡c chuyÃªn gia khÃ¡c nhau. NgÆ°á»i ta cÃ³ thá»ƒ tá»± há»i liá»‡u chÃºng ta cÃ³ thá»ƒ lÃ m cho sá»‘ háº¡ng nÃ y lá»›n tÃ¹y Ã½ báº±ng cÃ¡ch tÄƒng chuáº©n cá»§a x hay khÃ´ng. Äiá»u nÃ y khÃ´ng pháº£i nhÆ° váº­y vÃ¬ viá»‡c tÄƒng chuáº©n cá»§a x thÆ°á»ng dáº«n Ä‘áº¿n sá»± sá»¥p Ä‘á»• cá»§a xÃ¡c suáº¥t Ä‘á»‹nh tuyáº¿n thÃ nh má»™t chuyÃªn gia duy nháº¥t. Äiá»u nÃ y lÃ m cho p_i(x)(s_i - sÌ„(x)) báº±ng khÃ´ng cho táº¥t cáº£ cÃ¡c chuyÃªn gia i âˆˆ [E].

Äá»ƒ nghiÃªn cá»©u Ä‘iá»u trÃªn má»™t cÃ¡ch cá»¥ thá»ƒ hÆ¡n, chÃºng tÃ´i xem xÃ©t trÆ°á»ng há»£p E = 2 chuyÃªn gia. Trong thiáº¿t láº­p nÃ y, sá»‘ háº¡ng thá»© hai á»Ÿ trÃªn giáº£m thÃ nh ||p_1(x)f_1(x)(s_1 - sÌ„(x)) + (1 - p_1(x))f_2(x)(s_2 - sÌ„(x))||. BÃ¢y giá», trong trÆ°á»ng há»£p cá»±c Ä‘oan, khi p_1(x) lÃ  0 hoáº·c 1, sá»‘ háº¡ng trÃªn sá»¥p Ä‘á»• thÃ nh 0 vÃ¬ p_i(x)f_i(x)(s_i - sÌ„(x)) báº±ng 0 trong trÆ°á»ng há»£p Ä‘Ã³. Äiá»u nÃ y cÅ©ng Ä‘Æ°á»£c mong Ä‘á»£i vÃ¬ Ä‘á»‘i vá»›i cÃ¡c vÃ­ dá»¥ Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n má»™t chuyÃªn gia vá»›i xÃ¡c suáº¥t cao, yáº¿u tá»‘ chi phá»‘i chÃ­nh lÃ  háº±ng sá»‘ Lipschitz chuyÃªn gia riÃªng láº», vÃ¬ nhá»¯ng nhiá»…u loáº¡n nhá» khÃ´ng gÃ¢y ra nhiá»u thay Ä‘á»•i Ä‘á»‘i vá»›i xÃ¡c suáº¥t.

Má»™t thiáº¿t láº­p thÃº vá»‹ hÆ¡n lÃ  khi p_1(x) lÃ  1/2. Trong thiáº¿t láº­p nÃ y, nhá»¯ng nhiá»…u loáº¡n nhá» Ä‘á»‘i vá»›i Ä‘áº§u vÃ o cÃ³ thá»ƒ khiáº¿n mÃ´ hÃ¬nh thay Ä‘á»•i Ä‘Ã¡ng ká»ƒ trá»ng sá»‘ giá»¯a cÃ¡c chuyÃªn gia, vÃ  sá»‘ háº¡ng trÃªn giáº£m thÃ nh ||1/4(f_1(x) - f_2(x))(s_1 - s_2)||. Do Ä‘Ã³, cÃ¡c mÃ´ hÃ¬nh MoE cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi háº±ng sá»‘ Lipschitz lá»›n náº¿u hai chuyÃªn gia ráº¥t khÃ¡c nhau Ä‘á»‘i vá»›i cÃ¡c Ä‘iá»ƒm trÃªn ranh giá»›i, tá»©c lÃ  náº¿u |f_1(x) - f_2(x)| â‰« 0. Thay tháº¿, náº¿u f_1(x) â‰ˆ f_2(x) Ä‘á»‘i vá»›i cÃ¡c Ä‘iá»ƒm trÃªn ranh giá»›i (tá»©c lÃ  p_1(x) â‰ˆ 1/2) thÃ¬ sá»‘ háº¡ng nÃ y nhá».

ChÃºng tÃ´i sáº½ tháº¥y sau nÃ y trong cÃ¡c thÃ­ nghiá»‡m ráº±ng MoE Ä‘Æ°á»£c huáº¥n luyá»‡n trong thá»±c táº¿ thÆ°á»ng cÃ³ á»•n Ä‘á»‹nh bá»™ Ä‘á»‹nh tuyáº¿n tá»‘t vÃ  nhá»¯ng thay Ä‘á»•i Ä‘á»‘i vá»›i Ä‘á»‹nh tuyáº¿n khÃ´ng dáº«n Ä‘áº¿n sá»± suy giáº£m nhiá»u vá» Ä‘á»™ chÃ­nh xÃ¡c cuá»‘i cÃ¹ng.

### 3.2 Äá»‹nh tuyáº¿n dá»¯ liá»‡u

Trong pháº§n nÃ y, chÃºng tÃ´i sáº½ nghiÃªn cá»©u tÃ¡c Ä‘á»™ng cá»§a Ä‘á»‹nh tuyáº¿n dá»¯ liá»‡u Ä‘á»‘i vá»›i háº±ng sá»‘ Lipschitz cá»§a cÃ¡c chuyÃªn gia riÃªng láº» - sá»‘ háº¡ng Ä‘áº§u tiÃªn á»Ÿ váº¿ pháº£i cá»§a phÆ°Æ¡ng trÃ¬nh 7 (bá»• Ä‘á» 1). Äáº·c biá»‡t, chÃºng tÃ´i sáº½ cá»‘ gáº¯ng giáº£i quyáº¿t viá»‡c max_{iâˆˆ[E]} {L_{f_i}} cÃ³ thá»ƒ lá»›n nhÆ° tháº¿ nÃ o so vá»›i háº±ng sá»‘ Lipschitz cá»§a má»™t mÃ´ hÃ¬nh dÃ y Ä‘áº·c Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn cÃ¹ng dá»¯ liá»‡u. HÆ°á»›ng tá»›i má»¥c Ä‘Ã­ch nÃ y, chÃºng tÃ´i sáº½ phÃ¢n tÃ­ch lÃ½ thuyáº¿t tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh MoE vá»›i Ä‘á»‹nh tuyáº¿n cá»‘ Ä‘á»‹nh Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c vÃ  cÃ¡c chuyÃªn gia tuyáº¿n tÃ­nh, dÆ°á»›i Ã¡nh sÃ¡ng cá»§a cáº¥u trÃºc dá»¯ liá»‡u.

#### 3.2.1 Thiáº¿t láº­p

ChÃºng tÃ´i xem xÃ©t thiáº¿t láº­p Ä‘á»‹nh tuyáº¿n cá»‘ Ä‘á»‹nh, trong Ä‘Ã³ chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng Ä‘á»‹nh tuyáº¿n cá»§a cÃ¡c vÃ­ dá»¥ riÃªng láº» Ä‘áº¿n cÃ¡c chuyÃªn gia Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c vÃ  cá»‘ Ä‘á»‹nh. HÆ¡n ná»¯a, chÃºng tÃ´i xem xÃ©t cÃ¡c mÃ´ hÃ¬nh tuyáº¿n tÃ­nh lÃ m chuyÃªn gia.

Cá»¥ thá»ƒ hÆ¡n, chÃºng tÃ´i xem xÃ©t N Ä‘iá»ƒm Ä‘áº§u vÃ o cÃ³ chiá»u D Ä‘Æ°á»£c xáº¿p chá»“ng trong ma tráº­n X âˆˆ â„^{NÃ—D}, cÃ¹ng vá»›i vectÆ¡ má»¥c tiÃªu tÆ°Æ¡ng á»©ng y âˆˆ â„^N. Trong trÆ°á»ng há»£p dÃ y Ä‘áº·c (tá»©c lÃ  khÃ´ng cÃ³ chuyÃªn gia), chÃºng tÃ´i muá»‘n tÃ¬m má»™t mÃ´ hÃ¬nh tuyáº¿n tÃ­nh w âˆˆ â„^D Ä‘á»ƒ giáº£m thiá»ƒu:

min_{wâˆˆâ„^D} ||Xw - y||^2     (8)

Nghiá»‡m bÃ¬nh phÆ°Æ¡ng tá»‘i thiá»ƒu [13] cho bÃ i toÃ¡n nÃ y giáº£m thiá»ƒu tá»•n tháº¥t MSE lÃ  w* = (X^T X)^{-1} X^T y. á» Ä‘Ã¢y ^{-1} biá»ƒu thá»‹ nghá»‹ch Ä‘áº£o giáº£. Máº·t khÃ¡c, Ä‘á»‘i vá»›i há»—n há»£p chuyÃªn gia, cho táº­p dá»¯ liá»‡u Ä‘Æ°á»£c chia thÃ nh E táº­p con S_1, ..., S_E, vá»›i X_i, y_i biá»ƒu thá»‹ dá»¯ liá»‡u trong táº­p S_i. BÃ¢y giá» cho dá»¯ liá»‡u tá»« táº­p S_i Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n chuyÃªn gia i. DÆ°á»›i Ä‘Ã¢y chÃºng tÃ´i viáº¿t má»¥c tiÃªu cho má»—i chuyÃªn gia:

min_{w_iâˆˆâ„^D} ||X_i w_i - y_i||^2 cho i âˆˆ [E]     (9)

TÆ°Æ¡ng tá»±, cho w_i* = (X_i^T X_i)^{-1} X_i^T y_i lÃ  nghiá»‡m tá»‘i Æ°u cho chuyÃªn gia i giáº£m thiá»ƒu MSE.

#### 3.2.2 PhÃ¢n tÃ­ch

TrÆ°á»›c khi giá»›i thiá»‡u phÃ¢n tÃ­ch cá»§a chÃºng tÃ´i liÃªn quan Ä‘áº¿n háº±ng sá»‘ Lipschitz cá»§a cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c vÃ  MoE, trÆ°á»›c tiÃªn chÃºng tÃ´i trÃ¬nh bÃ y hai vÃ­ dá»¥ Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n vá» cÃ¡ch Ä‘á»‹nh tuyáº¿n áº£nh hÆ°á»Ÿng Ä‘áº¿n háº±ng sá»‘ Lipschitz. Äáº·c biá»‡t, chÃºng tÃ´i xem xÃ©t má»™t thiáº¿t láº­p Ä‘Æ¡n giáº£n vá»›i E = 2 chuyÃªn gia. Cho X^T = [X_1^T; X_2^T] lÃ  dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n hai chuyÃªn gia. Nhá»› láº¡i ráº±ng háº±ng sá»‘ Lipschitz cá»§a hÃ m f(X) = Xw lÃ  ||w||.

**TrÆ°á»ng há»£p X_1 âŠ¥ X_2.** Trong thiáº¿t láº­p nÃ y, chÃºng ta cÃ³:

||w*|| = ||(X^T X)^{-1} X^T y|| = ||(X_1^T X_1)^{-1} X_1^T y_1 + (X_2^T X_2)^{-1} X_2^T y_2|| = ||w_1* + w_2*|| â‰¤ max(||w_1*||, ||w_2*||)

Äáº³ng thá»©c thá»© hai theo cÃ¡c bÆ°á»›c sau - 1) X^T X = X_1^T X_1 + X_2^T X_2, 2) (X_1^T X_1 + X_2^T X_2)^{-1} y = (X_1^T X_1)^{-1} y + (X_2^T X_2)^{-1} y, vÃ  3) (X_1^T X_1)^{-1} X_2^T = 0; trong Ä‘Ã³ cÃ¡c bÆ°á»›c 2 vÃ  3 tuÃ¢n theo tÃ­nh trá»±c giao cá»§a X_1 vÃ  X_2 (xem [16]). Do Ä‘Ã³, cÃ¡c chuyÃªn gia cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n khi dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau náº±m trong cÃ¡c khÃ´ng gian con trá»±c giao.

**TrÆ°á»ng há»£p X_1 = X_2 vÃ  y_1 = y_2.** Trong trÆ°á»ng há»£p nÃ y, chÃºng ta tháº¥y ráº±ng:

||w*|| = ||(X^T X)^{-1} X^T y|| = ||(X_1^T X_1 + X_2^T X_2)^{-1} X^T y||
= ||(X_1^T X_1 + X_2^T X_2)^{-1} (X_1^T y_1 + X_1^T y_1)|| = 0 â‰¤ min(||w_1*||, ||w_2*||)

Do Ä‘Ã³, cÃ¡c chuyÃªn gia cÃ³ háº±ng sá»‘ Lipschitz tá»‡ hÆ¡n khi dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau Ä‘Æ°á»£c cÄƒn chá»‰nh.

Hai vÃ­ dá»¥ Ä‘Æ¡n giáº£n nÃ y minh há»a trong nhá»¯ng Ä‘iá»u kiá»‡n nÃ o cÃ¡c chuyÃªn gia cÃ³ lá»£i tháº¿ so vá»›i má»™t mÃ´ hÃ¬nh dÃ y Ä‘áº·c duy nháº¥t vÃ  khi nÃ o thÃ¬ khÃ´ng.

BÃ¢y giá» chÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ chÃ­nh cá»§a chÃºng tÃ´i. Äá»ƒ náº¯m báº¯t má»‘i quan há»‡ nÃ y giá»¯a hÃ¬nh há»c dá»¯ liá»‡u vÃ  Ä‘á»‹nh tuyáº¿n, chÃºng tÃ´i giá»›i thiá»‡u cÃ¡c Ä‘áº¡i lÆ°á»£ng sau. Cho {U_i}_{iâˆˆ[E]} lÃ  cÃ¡c ma tráº­n chiáº¿u lÃªn cÃ¡c khÃ´ng gian con trá»±c giao trong â„^D. Má»™t cÃ¡ch Ä‘á»ƒ xÃ¢y dá»±ng chÃºng lÃ  báº±ng cÃ¡ch láº¥y cÃ¡c vectÆ¡ riÃªng cá»§a X^T X trÆ°á»›c vÃ  gÃ¡n chÃºng cho táº­p i vá»›i chiáº¿u lá»›n nháº¥t. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng U_i trá»±c giao vá»›i U_j vá»›i j â‰  i, vÃ  chÃºng cÃ³ sá»± cÄƒn chá»‰nh lá»›n nháº¥t vá»›i khÃ´ng gian con Ä‘Æ°á»£c bao bá»Ÿi X_i.

TrÆ°á»›c tiÃªn, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a má»™t Ä‘áº¡i lÆ°á»£ng Ä‘á»ƒ náº¯m báº¯t má»©c Ä‘á»™ U_i náº¯m báº¯t khoáº£ng cá»§a táº­p con dá»¯ liá»‡u X_i.

**Äá»‹nh nghÄ©a 1 (Khoáº£ng cÃ¡ch trong khÃ´ng gian con: Îµ_1).** Îµ_1 â‰¥ 0, ||U_i U_i^T (X^T X)^{-1} X^T y - (X_i^T X_i)^{-1} X_i^T y_i||_2 â‰¤ Îµ_1, âˆ€i âˆˆ [E].

á» Ä‘Ã¢y ||Â·||_2 cho má»™t ma tráº­n biá»ƒu thá»‹ chuáº©n phá»•. Îµ_1 nhá» khi, âˆ€i, U_i náº¯m báº¯t X_i hoÃ n háº£o.

Tiáº¿p theo, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a khoáº£ng cÃ¡ch chiáº¿u giá»¯a dá»¯ liá»‡u tá»« hai táº­p con khÃ¡c nhau.

**Äá»‹nh nghÄ©a 2 (Khoáº£ng cÃ¡ch giá»¯a cÃ¡c khÃ´ng gian con: Îµ_2).** Îµ_2 â‰¥ 0 sao cho Ä‘á»‘i vá»›i báº¥t ká»³ z nÃ o trong khoáº£ng cá»§a X_j^T, chÃºng ta cÃ³ ||(X_i^T X_i)^{-1} X_i^T y_i - z||_2 â‰¤ Îµ_2 ||z||, âˆ€i â‰  j.

á» Ä‘Ã¢y Îµ_2 nhá» náº¿u dá»¯ liá»‡u trong cÃ¡c táº­p con khÃ¡c nhau X_i náº±m trong cÃ¡c khÃ´ng gian con trá»±c giao.

**Äá»‹nh lÃ½ 1.** Cho w* lÃ  nghiá»‡m cá»±c tiá»ƒu cá»§a phÆ°Æ¡ng trÃ¬nh 8 vÃ  {w_i*}_{iâˆˆ[E]} lÃ  nghiá»‡m cá»±c tiá»ƒu cá»§a phÆ°Æ¡ng trÃ¬nh 9. Khi Ä‘Ã³:

||w*||^2 â‰¥ âˆ‘_{i=1}^E ([||w_i*|| - Îµ_1 ||X^T y||_2 - Îµ_2 âˆ‘_{jâ‰ i} ||X_j^T y_j||]_+)^2

trong Ä‘Ã³ [Â·]_+ biá»ƒu thá»‹ chiáº¿u lÃªn cÃ¡c sá»‘ khÃ´ng Ã¢m.

Káº¿t quáº£ trÃªn Ä‘Æ°a ra cáº­n dÆ°á»›i cho háº±ng sá»‘ Lipschitz cá»§a mÃ´ hÃ¬nh dÃ y Ä‘áº·c ||w*|| theo háº±ng sá»‘ Lipschitz cá»§a cÃ¡c chuyÃªn gia ||w_i*|| trong mÃ´ hÃ¬nh MoE. ChÃºng tÃ´i trÃ¬nh bÃ y chá»©ng minh cá»§a Ä‘á»‹nh lÃ½ nÃ y trong phá»¥ lá»¥c A.

Trong trÆ°á»ng há»£p Îµ_1 = Îµ_2 = 0, chÃºng ta cÃ³ Ä‘Æ°á»£c cáº­n ||w*|| â‰¥ âˆš(âˆ‘_{i=1}^E ||w_i*||^2). Giáº£ Ä‘á»‹nh má»™t thiáº¿t láº­p cÃ¢n báº±ng trong Ä‘Ã³ táº¥t cáº£ cÃ¡c chuyÃªn gia cÃ³ cÃ¹ng tham sá»‘ chuáº©n, chÃºng ta cÃ³ Ä‘Æ°á»£c tá»· lá»‡ ||w*|| â‰¥ O(âˆšE) max_{iâˆˆ[E]} {||w_i*||}. Do Ä‘Ã³, trong thiáº¿t láº­p nÃ y, cÃ¡c chuyÃªn gia cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n má»™t há»‡ sá»‘ 1/âˆšE so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c. Äiá»u nÃ y xáº£y ra khi dá»¯ liá»‡u náº±m trong E khÃ´ng gian con trá»±c giao vÃ  dá»¯ liá»‡u tá»« má»—i khÃ´ng gian con Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¹ng má»™t chuyÃªn gia. Äiá»u nÃ y cho tháº¥y ráº±ng cÃ¡c mÃ´ hÃ¬nh MoE cÃ³ thá»ƒ cÃ³ háº±ng sá»‘ Lipschitz nhá» hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c Ä‘á»‘i tÃ¡c dÃ y Ä‘áº·c cá»§a chÃºng, trong khi cÃ³ cÃ¹ng chi phÃ­ tÃ­nh toÃ¡n. Äá»‘i vá»›i MoE trong thá»±c táº¿, dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¡c chuyÃªn gia khÃ¡c nhau thá»±c sá»± hiá»ƒn thá»‹ má»™t sá»‘ phÃ¢n cá»¥m cá»§a cÃ¡c Ä‘áº·c trÆ°ng (xem HÃ¬nh 7 trong Riquelme vÃ  cá»™ng sá»± [22]).

Khi dá»¯ liá»‡u trong cÃ¡c phÃ¢n vÃ¹ng khÃ¡c nhau X_i trá»Ÿ nÃªn cÄƒn chá»‰nh hÆ¡n, Îµ_1 vÃ  Îµ_2 tÄƒng lÃªn vÃ  giáº£m khoáº£ng cÃ¡ch giá»¯a háº±ng sá»‘ Lipschitz cá»§a mÃ´ hÃ¬nh dÃ y Ä‘áº·c vÃ  MoE. Äiá»u nÃ y lÃ m giáº£m khoáº£ng cÃ¡ch trong háº±ng sá»‘ Lipschitz cá»§a mÃ´ hÃ¬nh dÃ y Ä‘áº·c vÃ  cÃ¡c chuyÃªn gia. Trong trÆ°á»ng há»£p cá»±c Ä‘oan, náº¿u táº¥t cáº£ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘á»u giá»‘ng nhau, thÃ¬ Îµ_1 vÃ  Îµ_2 lá»›n, loáº¡i bá» sá»± khÃ¡c biá»‡t nÃ y. Trong phá»¥ lá»¥c D, chÃºng tÃ´i Ä‘Æ°a ra má»™t káº¿t quáº£ bá»• sung liÃªn quan Ä‘áº¿n háº±ng sá»‘ Lipschitz cá»§a cÃ¡c chuyÃªn gia vá»›i mÃ´ hÃ¬nh dÃ y Ä‘áº·c khi cáº£ Îµ_1 vÃ  Îµ_2 cÃ³ thá»ƒ lá»›n.

**Káº¿t ná»‘i vá»›i Bubeck vÃ  Sellke [3].** Bubeck vÃ  Sellke [3] Ä‘Ã£ chá»©ng minh má»™t cáº­n dÆ°á»›i phá»• quÃ¡t vá» háº±ng sá»‘ Lipschitz cá»§a má»™t hÃ m cáº§n thiáº¿t Ä‘á»ƒ Î´-ghi nhá»› N máº«u huáº¥n luyá»‡n trong D chiá»u:

L_f â‰¥ Î©Ìƒ(âˆš(ND/P))

Äá»‘i vá»›i mÃ´ hÃ¬nh tuyáº¿n tÃ­nh Ä‘Æ°á»£c xem xÃ©t á»Ÿ trÃªn, Ä‘iá»u nÃ y giáº£m thÃ nh Î©Ìƒ(âˆšN) vÃ¬ sá»‘ lÆ°á»£ng tham sá»‘ lÃ  D. VÃ¬ MoE cÃ³ E láº§n nhiá»u tham sá»‘ hÆ¡n, chÃºng cÃ³ cáº­n dÆ°á»›i Î©Ìƒ(âˆš(N/E)), tá»©c lÃ  cáº­n dÆ°á»›i vá» háº±ng sá»‘ Lipschitz cá»§a MoE nhá» hÆ¡n má»™t há»‡ sá»‘ âˆš(1/E). Káº¿t quáº£ cá»§a chÃºng tÃ´i cho tháº¥y ráº±ng cáº­n dÆ°á»›i nÃ y thá»±c sá»± cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c, vÃ  do Ä‘Ã³ cháº·t cháº½, khi dá»¯ liá»‡u náº±m trong E khÃ´ng gian con trá»±c giao vÃ  dá»¯ liá»‡u tá»« má»—i khÃ´ng gian con Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n cÃ¹ng má»™t chuyÃªn gia.

## 4 ThÃ­ nghiá»‡m

### 4.1 Thiáº¿t láº­p

ChÃºng tÃ´i so sÃ¡nh tÃ­nh bá»n vá»¯ng cá»§a cÃ¡c mÃ´ hÃ¬nh Vision Transformer (ViT) [7] vÃ  Vision MoE (V-MoE) [22] chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng. Äáº·c biá»‡t, chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh ViT-B/32 vÃ  V-MoE-B/32 trong táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m. CÃ¡c mÃ´ hÃ¬nh nÃ y cÃ³ cÃ¹ng kiáº¿n trÃºc cÆ¡ báº£n nhÆ°ng mÃ´ hÃ¬nh sau thay tháº¿ má»™t trong hai lá»›p feedforward báº±ng Há»—n há»£p ChuyÃªn gia thÆ°a thá»›t, chá»n K = 2 trong sá»‘ E = 32 chuyÃªn gia feedforward Ä‘Æ°á»£c Ã¡p dá»¥ng trÃªn má»—i token. NgÆ°á»i ta cÃ³ thá»ƒ láº­p luáº­n ráº±ng bá»™ Ä‘á»‹nh tuyáº¿n trong mÃ´ hÃ¬nh V-MoE giá»›i thiá»‡u má»™t chi phÃ­ phá»¥ cáº§n Ä‘Æ°á»£c tÃ­nh Ä‘áº¿n. Do Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ huáº¥n luyá»‡n má»™t phiÃªn báº£n lá»›n hÆ¡n cá»§a ViT-B/32 dÃ y Ä‘áº·c (mÃ  chÃºng tÃ´i Ä‘áº·t tÃªn lÃ  ViT-B++/32) Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t dá»± Ä‘oÃ¡n gáº§n nhÆ° giá»‘ng mÃ´ hÃ¬nh V-MoE, nhÆ°ng cÃ³ chi phÃ­ cao hÆ¡n. Chi phÃ­ Ä‘Ã¡nh giÃ¡ má»™t hÃ¬nh áº£nh trÃªn cÃ¡c mÃ´ hÃ¬nh ViT dÃ y Ä‘áº·c lÃ  8.9 vÃ  17.9 GFLOP vÃ  chi phÃ­ thá»i gian cháº¡y tÆ°Æ¡ng á»©ng; vÃ  12.4 GFLOP trÃªn mÃ´ hÃ¬nh V-MoE. Phá»¥ lá»¥c B chá»©a cÃ¡c chi tiáº¿t thÃ­ nghiá»‡m bá»• sung.

ChÃºng tÃ´i tiá»n huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh cá»§a mÃ¬nh trÃªn táº­p dá»¯ liá»‡u riÃªng tÆ° JFT-300M [24] trong 7 epoch (517 859 bÆ°á»›c vá»›i kÃ­ch thÆ°á»›c batch 4 096 hÃ¬nh áº£nh), sá»­ dá»¥ng Ä‘á»™ phÃ¢n giáº£i hÃ¬nh áº£nh 224Ã—224 pixel vÃ  tÄƒng cÆ°á»ng dá»¯ liá»‡u tiÃªu chuáº©n (crop inception vÃ  láº­t ngang). VÃ¬ JFT-300M lÃ  táº­p dá»¯ liá»‡u Ä‘a nhÃ£n, chÃºng tÃ´i giáº£m thiá»ƒu tá»•n tháº¥t sigmoid cross-entropy. V-MoE cÅ©ng thÃªm cÃ¡c tá»•n tháº¥t phá»¥ trá»£ Ä‘á»ƒ khuyáº¿n khÃ­ch táº£i cÃ¢n báº±ng cho táº¥t cáº£ cÃ¡c chuyÃªn gia; chÃºng tÃ´i Ä‘Ã£ sá»­ dá»¥ng cÃ¹ng cÃ´ng thá»©c nhÆ° trong [22]. Trong cáº£ hai trÆ°á»ng há»£p, chÃºng tÃ´i sá»­ dá»¥ng Adam (Î²_1 = 0.9, Î²_2 = 0.999), vá»›i tá»· lá»‡ há»c Ä‘á»‰nh 8Ã—10^{-4}, Ä‘áº¡t Ä‘Æ°á»£c sau khi lÃ m áº¥m tuyáº¿n tÃ­nh 10^4 bÆ°á»›c vÃ  sau Ä‘Ã³ giáº£m tuyáº¿n tÃ­nh xuá»‘ng giÃ¡ trá»‹ cuá»‘i cÃ¹ng 10^{-5}. Weight decay 0.1 Ä‘Æ°á»£c sá»­ dá»¥ng trÃªn táº¥t cáº£ cÃ¡c tham sá»‘. ÄÃ¢y lÃ  cÃ¹ng giao thá»©c tiá»n huáº¥n luyá»‡n nhÆ° Ä‘Æ°á»£c sá»­ dá»¥ng trong [7, 22].

Sau khi tiá»n huáº¥n luyá»‡n, cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh trÃªn ImageNet [6], á»Ÿ Ä‘á»™ phÃ¢n giáº£i 384Ã—384 pixel vÃ  cÃ¹ng tÄƒng cÆ°á»ng dá»¯ liá»‡u nhÆ° trÆ°á»›c, tá»•ng cá»™ng 10^4 bÆ°á»›c, sá»­ dá»¥ng kÃ­ch thÆ°á»›c batch 4 096 hÃ¬nh áº£nh. SGD vá»›i Momentum (Î¼ = 0.9) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tinh chá»‰nh, vá»›i tá»· lá»‡ há»c Ä‘á»‰nh 0.03, Ä‘áº¡t Ä‘Æ°á»£c sau khi lÃ m áº¥m tuyáº¿n tÃ­nh 500 bÆ°á»›c, vÃ  theo sau báº±ng cosine decay Ä‘áº¿n giÃ¡ trá»‹ cuá»‘i cÃ¹ng 10^{-5}. Chuáº©n cá»§a vectÆ¡ gradient Ä‘Æ°á»£c lÃ m pháº³ng Ä‘Æ°á»£c cáº¯t Ä‘áº¿n giÃ¡ trá»‹ tá»‘i Ä‘a 10. VÃ¬ hÃ¬nh áº£nh ImageNet cÃ³ má»™t nhÃ£n duy nháº¥t, chÃºng tÃ´i giáº£m thiá»ƒu tá»•n tháº¥t softmax cross-entropy trong quÃ¡ trÃ¬nh tinh chá»‰nh. CÃ¹ng giao thá»©c tinh chá»‰nh Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng trong [7, 22].

ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ tÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng cá»§a cáº£ mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vÃ  tinh chá»‰nh, báº±ng cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng PGD [20]. ChÃºng tÃ´i tá»‘i Ä‘a hÃ³a tá»•n tháº¥t tÆ°Æ¡ng á»©ng (sigmoid hoáº·c softmax cross-entropy), thay Ä‘á»•i rÃ ng buá»™c chuáº©n â„“_âˆ trÃªn hÃ¬nh áº£nh Ä‘áº§u vÃ o, tá»•ng cá»™ng Ï„ = 40 bÆ°á»›c.

### 4.2 TÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng cá»§a V-MoE

Trong quÃ¡ trÃ¬nh tiá»n huáº¥n luyá»‡n, mÃ´ hÃ¬nh ViT-B/32 Ä‘áº¡t precision at 1 lÃ  39.3%, vÃ  V-MoE-B/32 Ä‘áº¡t precision-at-1 lÃ  43.5% (ngÆ°á»£c láº¡i, false discovery rate at 1 lÃ  60.7% vÃ  56.5% tÆ°Æ¡ng á»©ng). Sau khi tinh chá»‰nh, lá»—i phÃ¢n loáº¡i Ä‘áº¡t Ä‘Æ°á»£c bá»Ÿi má»—i mÃ´ hÃ¬nh trÃªn ImageNet lÃ  19.3% vÃ  17.8% tÆ°Æ¡ng á»©ng.

HÃ¬nh 1 hiá»ƒn thá»‹ trong cÃ¡c Ä‘Æ°á»ng liá»n false discovery rate (trÃ¡i) vÃ  classification error rate (pháº£i) nhÆ° má»™t hÃ m cá»§a rÃ ng buá»™c â„“_âˆ. Máº·c dÃ¹ thá»±c táº¿ lÃ  mÃ´ hÃ¬nh V-MoE chá»©a má»™t bá»™ Ä‘á»‹nh tuyáº¿n thá»±c hiá»‡n cÃ¡c lá»±a chá»n riÃªng biá»‡t giá»¯a cÃ¡c chuyÃªn gia cÃ³ Ä‘iá»u kiá»‡n trÃªn Ä‘áº§u vÃ o, cÃ³ thá»ƒ dáº«n Ä‘áº¿n Ä‘iá»ƒm yáº¿u nghiÃªm trá»ng chá»‘ng láº¡i káº» táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng, chÃºng ta cÃ³ thá»ƒ quan sÃ¡t tháº¥y ráº±ng nÃ³ theo cÃ¹ng xu hÆ°á»›ng vá»›i mÃ´ hÃ¬nh ViT dÃ y Ä‘áº·c cÆ¡ báº£n. NÃ³ cÃ³ thá»ƒ duy trÃ¬ lá»—i tháº¥p hÆ¡n trong má»™t pháº¡m vi rá»™ng cÃ¡c giÃ¡ trá»‹ â„“_âˆ. Má»™t phiÃªn báº£n lá»›n hÆ¡n cá»§a mÃ´ hÃ¬nh dÃ y Ä‘áº·c khá»›p vá»›i cháº¥t lÆ°á»£ng cá»§a V-MoE cÃ³ chi phÃ­ cao hÆ¡n nhiá»u.

NgoÃ i ra, chÃºng tÃ´i cÅ©ng tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh ViT cÆ¡ báº£n vÃ  V-MoE trÃªn ImageNet báº±ng huáº¥n luyá»‡n Ä‘á»‘i khÃ¡ng PGD. ChÃºng tÃ´i sá»­ dá»¥ng cÃ¹ng cÃ´ng thá»©c nhÆ° trÃªn nhÆ°ng chÃºng tÃ´i thá»±c hiá»‡n cuá»™c táº¥n cÃ´ng PGD 10 bÆ°á»›c trÃªn hÃ¬nh áº£nh Ä‘áº§u vÃ o, vá»›i â„“_âˆ = 8/255 cá»‘ Ä‘á»‹nh, trÆ°á»›c khi tÃ­nh gradient cá»§a cÃ¡c tham sá»‘ mÃ´ hÃ¬nh vÃ  cáº­p nháº­t chÃºng. Lá»—i phÃ¢n loáº¡i trÃªn táº­p dá»¯ liá»‡u ImageNet gá»‘c Ä‘áº¡t Ä‘Æ°á»£c bá»Ÿi má»—i mÃ´ hÃ¬nh sau khi tinh chá»‰nh Ä‘á»‘i khÃ¡ng lÃ  51.7% vÃ  49.8%, cho cáº£ hai mÃ´ hÃ¬nh tÆ°Æ¡ng á»©ng. HÃ¬nh 1 (pháº£i) hiá»ƒn thá»‹ trong cÃ¡c Ä‘Æ°á»ng Ä‘á»©t nÃ©t lá»—i phÃ¢n loáº¡i khi cÃ¡c mÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ chá»‘ng láº¡i káº» táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng sá»­ dá»¥ng cÃ¡c rÃ ng buá»™c â„“_âˆ khÃ¡c nhau. Khi â„“_âˆ tÄƒng, lá»£i Ã­ch cá»§a tinh chá»‰nh Ä‘á»‘i khÃ¡ng Ä‘á»ƒ báº£o tá»“n Ä‘á»™ chÃ­nh xÃ¡c Ä‘Æ°á»£c hiá»ƒn thá»‹ trong cáº£ hai trÆ°á»ng há»£p. Má»™t láº§n ná»¯a, cáº£ hai mÃ´ hÃ¬nh bÃ¡o cÃ¡o xu hÆ°á»›ng tÆ°Æ¡ng tá»±, vÃ  mÃ´ hÃ¬nh V-MoE cho tháº¥y tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n cho má»™t pháº¡m vi rá»™ng cÃ¡c giÃ¡ trá»‹ â„“_âˆ.

### 4.3 TÃ¡c Ä‘á»™ng cá»§a cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng lÃªn cÃ¡c chuyÃªn gia Ä‘Æ°á»£c chá»n

NhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong pháº§n 3.1, trong vÃ¹ng gáº§n ranh giá»›i quyáº¿t Ä‘á»‹nh cá»§a bá»™ Ä‘á»‹nh tuyáº¿n, náº¿u hai chuyÃªn gia cÃ³ Ä‘áº§u ra ráº¥t khÃ¡c nhau, háº±ng sá»‘ Lipschitz cá»§a mÃ´ hÃ¬nh MoE cÃ³ thá»ƒ cao hÆ¡n nhiá»u so vá»›i mÃ´ hÃ¬nh dÃ y Ä‘áº·c tÆ°Æ¡ng tá»±. Náº¿u chá»‰ sá»‘ cá»§a cÃ¡c chuyÃªn gia Ä‘Æ°á»£c chá»n thay Ä‘á»•i Ä‘Ã¡ng ká»ƒ, nhÆ°ng mÃ´ hÃ¬nh váº«n cho tháº¥y Ä‘á»™ chÃ­nh xÃ¡c khÃ¡ cao dÆ°á»›i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng (so vá»›i mÃ´ hÃ¬nh dÃ y Ä‘áº·c), Ä‘iá»u nÃ y sáº½ cho tháº¥y ráº±ng Ä‘áº§u ra cá»§a hai táº­p chuyÃªn gia Ä‘Æ°á»£c chá»n khÃ´ng khÃ¡c nhau nhiá»u.

HÃ¬nh 2 hiá»ƒn thá»‹ tá»· lá»‡ thay Ä‘á»•i trong bá»™ Ä‘á»‹nh tuyáº¿n nhÆ° má»™t hÃ m cá»§a â„“_âˆ Ä‘Æ°á»£c sá»­ dá»¥ng trong cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng, trÃªn cÃ¡c lá»›p khÃ¡c nhau cá»§a mÃ´ hÃ¬nh V-MoE-B/32 cÃ³ lá»›p MoE. Äá»‘i vá»›i má»—i token Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi mÃ´ hÃ¬nh, chÃºng tÃ´i tÃ­nh intersection-over-union (IoU) cá»§a táº­p chuyÃªn gia Ä‘Æ°á»£c chá»n trÆ°á»›c vÃ  sau cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng. ChÃºng tÃ´i tÃ­nh trung bÃ¬nh IoU trÃªn táº¥t cáº£ cÃ¡c token Ä‘Æ°á»£c xá»­ lÃ½ vÃ  Ä‘á»‹nh nghÄ©a tá»· lá»‡ thay Ä‘á»•i Ä‘á»‹nh tuyáº¿n lÃ  pháº§n bÃ¹ cá»§a IoU trung bÃ¬nh.

Trong cÃ¡c Ä‘Æ°á»ng Ä‘á»©t nÃ©t, chÃºng tÃ´i bÃ¡o cÃ¡o tá»· lá»‡ thay Ä‘á»•i cá»§a mÃ´ hÃ¬nh V-MoE Ä‘Æ°á»£c tinh chá»‰nh báº±ng huáº¥n luyá»‡n Ä‘á»‘i khÃ¡ng PGD. KhÃ´ng chá»‰ mÃ´ hÃ¬nh cÃ³ Ä‘á»™ chÃ­nh xÃ¡c tá»‘t hÆ¡n chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng khi â„“_âˆ tÄƒng, nhÆ° Ä‘Æ°á»£c bÃ¡o cÃ¡o trong hÃ¬nh 1, mÃ  tá»· lá»‡ thay Ä‘á»•i Ä‘á»‹nh tuyáº¿n cÅ©ng thÆ°á»ng tháº¥p hÆ¡n trÃªn táº¥t cáº£ cÃ¡c lá»›p.

Máº·c dÃ¹ thá»±c táº¿ lÃ  má»™t pháº§n Ä‘Ã¡ng ká»ƒ cÃ¡c lá»±a chá»n thay Ä‘á»•i trÃªn má»—i lá»›p khi â„“_âˆ tÄƒng, hÃ¬nh 1 cho tháº¥y ráº±ng mÃ´ hÃ¬nh V-MoE váº«n giá»¯ Ä‘Æ°á»£c lá»£i tháº¿ chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng so vá»›i mÃ´ hÃ¬nh ViT. Äiá»u nÃ y cho tháº¥y ráº±ng trong cÃ¡c vÃ¹ng gáº§n ranh giá»›i quyáº¿t Ä‘á»‹nh cá»§a bá»™ Ä‘á»‹nh tuyáº¿n, hai chuyÃªn gia tÆ°Æ¡ng á»©ng cÃ³ Ä‘áº§u ra tÆ°Æ¡ng tá»±, do Ä‘Ã³ ngÄƒn cháº·n mÃ´ hÃ¬nh V-MoE Ä‘áº§y Ä‘á»§ khá»i viá»‡c kÃ©m bá»n vá»¯ng hÆ¡n trong thá»±c táº¿. NgÆ°á»£c láº¡i, thá»±c táº¿ lÃ  mÃ´ hÃ¬nh V-MoE cÃ³ cháº¥t lÆ°á»£ng cÆ¡ báº£n tá»‘t hÆ¡n mÃ´ hÃ¬nh ViT Ä‘á»‘i tÃ¡c, cho tháº¥y ráº±ng cÃ¡c chuyÃªn gia khÃ´ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng Ä‘á»‘i vá»›i cÃ¡c vÃ¹ng xa ranh giá»›i quyáº¿t Ä‘á»‹nh, náº¿u khÃ´ng nÃ³ sáº½ giáº£m thÃ nh mÃ´ hÃ¬nh dÃ y Ä‘áº·c.

### 4.4 Táº¥n cÃ´ng cÃ¡c tá»•n tháº¥t phá»¥ trá»£ cá»§a bá»™ Ä‘á»‹nh tuyáº¿n

CÃ¡c mÃ´ hÃ¬nh MoE thÆ°a thá»›t thÆ°á»ng sá»­ dá»¥ng cÃ¡c tá»•n tháº¥t phá»¥ trá»£ Ä‘á»ƒ cÃ¢n báº±ng táº£i giá»¯a táº¥t cáº£ cÃ¡c chuyÃªn gia. Äáº·c biá»‡t, trong viá»‡c thá»±c hiá»‡n V-MoE, náº¿u táº£i cá»§a cÃ¡c chuyÃªn gia khÃ´ng cÃ¢n báº±ng cao, cÃ¡c chuyÃªn gia nháº­n Ä‘Æ°á»£c nhiá»u token hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i trung bÃ¬nh cÃ³ thá»ƒ bá» qua táº¥t cáº£ cÃ¡c token vÆ°á»£t quÃ¡ kháº£ nÄƒng cá»§a chuyÃªn gia, cÃ³ thá»ƒ dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»‡ hÆ¡n Ä‘Ã¡ng ká»ƒ. CÃ¢u há»i lÃ  liá»‡u káº» táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng cÃ³ thá»ƒ khai thÃ¡c tÃ­nh cháº¥t nÃ y trong thá»±c táº¿ hay khÃ´ng. HÃ¬nh 3 (trÃ¡i) hiá»ƒn thá»‹ false discovery rate trÃªn JFT-300M, cho mÃ´ hÃ¬nh V-MoE khi cÃ¡c tá»•n tháº¥t phá»¥ trá»£ cá»§a bá»™ Ä‘á»‹nh tuyáº¿n Ä‘Æ°á»£c tá»‘i Ä‘a hÃ³a trong cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng, cÃ¹ng vá»›i tá»•n tháº¥t cross-entropy tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i sá»­ dá»¥ng cÃ¹ng trá»ng sá»‘ cho cÃ¡c tá»•n tháº¥t phá»¥ trá»£ nhÆ° trá»ng sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh. HÃ¬nh cho tháº¥y ráº±ng táº¥n cÃ´ng tá»•n tháº¥t phá»¥ trá»£ khÃ´ng mang láº¡i lá»£i tháº¿ Ä‘Ã¡ng ká»ƒ nÃ o cho káº» táº¥n cÃ´ng. Káº¿t quáº£ tÆ°Æ¡ng tá»± vá» lá»—i phÃ¢n loáº¡i trÃªn ImageNet (khÃ´ng hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y vÃ¬ lá»£i Ã­ch cá»§a khÃ´ng gian).

### 4.5 TÄƒng kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh báº±ng cÃ¡ch tÄƒng tá»•ng sá»‘ chuyÃªn gia

Trong pháº§n 1, chÃºng tÃ´i Ä‘Ã£ há»i liá»‡u, cho ráº±ng cáº­n dÆ°á»›i vá» háº±ng sá»‘ Lipschitz Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi Bubeck vÃ  Sellke [3] lÃ  báº¥t kháº£ tri Ä‘á»‘i vá»›i chi phÃ­ tÃ­nh toÃ¡n cá»§a hÃ m, chÃºng ta cÃ³ thá»ƒ lÃ m cho mÃ´ hÃ¬nh bá»n vá»¯ng hÆ¡n báº±ng cÃ¡ch tÄƒng kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh mÃ  khÃ´ng tÄƒng tá»•ng chi phÃ­ khÃ´ng? á» Ä‘Ã¢y chÃºng tÃ´i Ä‘o lÆ°á»ng viá»‡c tÄƒng tá»•ng sá»‘ chuyÃªn gia trong mÃ´ hÃ¬nh V-MoE giÃºp Ã­ch nhÆ° tháº¿ nÃ o chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng. LÆ°u Ã½ ráº±ng viá»‡c tÄƒng tá»•ng sá»‘ chuyÃªn gia E khÃ´ng lÃ m cho mÃ´ hÃ¬nh V-MoE Ä‘áº¯t hÆ¡n. HÃ¬nh 3 (giá»¯a vÃ  pháº£i) hiá»ƒn thá»‹ false discovery rate trÃªn JFT-300M vÃ  lá»—i phÃ¢n loáº¡i trÃªn ImageNet cho sá»‘ lÆ°á»£ng chuyÃªn gia tÄƒng dáº§n. Táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh V-MoE chá»n K = 2 chuyÃªn gia cho má»—i token.

Má»™t máº·t, viá»‡c tÄƒng tá»•ng sá»‘ chuyÃªn gia cáº£i thiá»‡n tÃ­nh bá»n vá»¯ng trÃªn JFT-300M lÃªn Ä‘áº¿n E = 16 chuyÃªn gia. CÃ¡c Ä‘Æ°á»ng cong cho E = 16 vÃ  E = 32 ráº¥t chá»“ng chÃ©o, do Ä‘Ã³ báº¥t ká»³ sá»± khÃ¡c biá»‡t nÃ o ráº¥t cÃ³ thá»ƒ do nhiá»…u trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n vÃ  tinh chá»‰nh. Máº·t khÃ¡c, khi cÃ¡c V-MoE Ä‘Æ°á»£c tinh chá»‰nh trÃªn ImageNet, táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh vá»›i hÆ¡n hai chuyÃªn gia Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c gáº§n nhÆ° giá»‘ng nhau dÆ°á»›i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng.

Äiá»u nÃ y cho tháº¥y ráº±ng, máº·c dÃ¹ cÃ¡c káº¿t quáº£ Ä‘Æ°á»£c trÃ¬nh bÃ y trong pháº§n 3 cho tháº¥y tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n cá»§a MoE Ä‘Ã²i há»i má»™t sá»‘ giáº£ Ä‘á»‹nh, cÃ¡c káº¿t luáº­n cÃ³ giÃ¡ trá»‹ á»Ÿ má»™t má»©c Ä‘á»™ nÃ o Ä‘Ã³ trong cÃ¡c tÃ¬nh huá»‘ng thá»±c táº¿. Viá»‡c tÄƒng sá»‘ lÆ°á»£ng tham sá»‘ báº±ng cÃ¡ch tÄƒng sá»‘ lÆ°á»£ng chuyÃªn gia lÃ  má»™t cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ cáº£i thiá»‡n tÃ­nh bá»n vá»¯ng cá»§a mÃ´ hÃ¬nh.

### 4.6 TÃ­nh bá»n vá»¯ng chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng AutoPGD

ChÃºng tÃ´i Ä‘Ã£ tiáº¿n hÃ nh cÃ¡c thÃ­ nghiá»‡m bá»• sung sá»­ dá»¥ng cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng tinh vi hÆ¡n, AutoPGD [5], chá»n kÃ­ch thÆ°á»›c bÆ°á»›c Ä‘á»ƒ sá»­ dá»¥ng trong má»—i cáº­p nháº­t cá»§a cuá»™c táº¥n cÃ´ng. ChÃºng tÃ´i cÅ©ng tÄƒng sá»‘ lÆ°á»£ng bÆ°á»›c Ä‘Æ°á»£c thá»±c hiá»‡n trong cuá»™c táº¥n cÃ´ng, sá»­ dá»¥ng Ï„ = 100 bÆ°á»›c. HÃ¬nh 4a hiá»ƒn thá»‹ káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c bá»Ÿi hai mÃ´ hÃ¬nh dÃ y Ä‘áº·c (ViT-B/32 vÃ  ViT-B++/32) vÃ  má»™t mÃ´ hÃ¬nh thÆ°a thá»›t (V-MoE-B/32). Máº·c dÃ¹ AutoPGD hiá»‡u quáº£ hÆ¡n má»™t chÃºt nhÆ° má»™t cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng chá»‘ng láº¡i táº¥t cáº£ cÃ¡c phÆ°Æ¡ng phÃ¡p (vÃ­ dá»¥: vá»›i â„“_âˆ = 10^{-3} false discovery rate trÃªn JFT-300M cá»§a ViT-B/32 lÃ  0.744 sá»­ dá»¥ng PGD vÃ  0.757 sá»­ dá»¥ng AutoPGD), xu hÆ°á»›ng cá»§a táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh giá»‘ng há»‡t nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong hÃ¬nh 1.

HÃ¬nh 4b hiá»ƒn thá»‹ tá»· lá»‡ thay Ä‘á»•i Ä‘á»‹nh tuyáº¿n trong cÃ¡c lá»›p MoE khÃ¡c nhau trong mÃ´ hÃ¬nh V-MoE-B/32. HÃ¬nh nÃ y tÆ°Æ¡ng tá»± nhÆ° hÃ¬nh 2 hiá»ƒn thá»‹ káº¿t quáº£ cho cuá»™c táº¥n cÃ´ng PGD tiÃªu chuáº©n. So vá»›i nÃ³, AutoPGD cÃ³ thá»ƒ thay Ä‘á»•i pháº§n lá»›n hÆ¡n cÃ¡c chuyÃªn gia Ä‘Æ°á»£c chá»n. VÃ­ dá»¥: pháº§n thay Ä‘á»•i tá»‘i Ä‘a trong Lá»›p 1 sá»­ dá»¥ng PGD gáº§n 0.2, trong khi AutoPGD tÄƒng nÃ³ lÃªn khoáº£ng 0.5.

AutoPGD Ä‘Æ°a ra cÃ¹ng káº¿t luáº­n nhÆ° cÃ¡c cuá»™c táº¥n cÃ´ng PGD: cÃ¡c mÃ´ hÃ¬nh sá»­ dá»¥ng cÃ¡c lá»›p MoE thÆ°a thá»›t cung cáº¥p tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n chá»‘ng láº¡i cÃ¡c cuá»™c táº¥n cÃ´ng Ä‘á»‘i khÃ¡ng (má»—i GFLOP) so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c, máº·c dÃ¹ thá»±c táº¿ lÃ  báº£n thÃ¢n bá»™ Ä‘á»‹nh tuyáº¿n cÃ³ thá»ƒ khÃ¡ nháº¡y cáº£m vá»›i cÃ¡c cuá»™c táº¥n cÃ´ng nÃ y.

## 5 Káº¿t luáº­n

Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i Ä‘Ã£ phÃ¢n tÃ­ch tÃ­nh bá»n vá»¯ng Ä‘á»‘i khÃ¡ng cá»§a MoE cho tháº¥y lá»£i tháº¿ cá»§a chÃºng so vá»›i cÃ¡c mÃ´ hÃ¬nh dÃ y Ä‘áº·c, vá»›i nhiá»u chuyÃªn gia hÆ¡n dáº«n Ä‘áº¿n tÃ­nh bá»n vá»¯ng tá»‘t hÆ¡n, cáº£ vá» máº·t lÃ½ thuyáº¿t vÃ  thá»±c nghiá»‡m. ChÃºng tÃ´i Ä‘Ã£ chá»‰ ra cÃ¡ch cÃ¡c tÃ­nh cháº¥t cá»§a dá»¯ liá»‡u vÃ  Ä‘á»‹nh tuyáº¿n cá»§a nÃ³ Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c há»c cÃ¡c MoE bá»n vá»¯ng.

Máº·c dÃ¹ cÃ³ má»™t sá»‘ báº±ng chá»©ng ráº±ng Ä‘á»‹nh tuyáº¿n Ä‘Æ°á»£c há»c bá»Ÿi MoE trong thá»±c táº¿ hiá»ƒn thá»‹ má»™t sá»‘ phÃ¢n cá»¥m cá»§a cÃ¡c Ä‘áº·c trÆ°ng trong má»™t sá»‘ lá»›p cá»§a mÃ´ hÃ¬nh (xem HÃ¬nh 7 trong Riquelme vÃ  cá»™ng sá»± [22]), hiá»‡n táº¡i nÃ³ khÃ´ng Ä‘Æ°á»£c khuyáº¿n khÃ­ch rÃµ rÃ ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Do Ä‘Ã³, viá»‡c phÃ¡t triá»ƒn cÃ¡c chiáº¿n lÆ°á»£c Ä‘á»‹nh tuyáº¿n thÃ´ng minh hÆ¡n cÃ³ tÃ­nh Ä‘áº¿n hÃ¬nh há»c dá»¯ liá»‡u cÃ³ thá»ƒ lÃ  má»™t hÆ°á»›ng nghiÃªn cá»©u thÃº vá»‹ trong tÆ°Æ¡ng lai. Hiá»‡n táº¡i phÃ¢n tÃ­ch cá»§a chÃºng tÃ´i bá»‹ giá»›i háº¡n á»Ÿ cÃ¡c mÃ´ hÃ¬nh tuyáº¿n tÃ­nh, má»Ÿ rá»™ng Ä‘iá»u nÃ y cho cÃ¡c mÃ´ hÃ¬nh tá»•ng quÃ¡t vÃ  suy ra sá»± phá»¥ thuá»™c cá»§a Ä‘á»‹nh tuyáº¿n tá»‘i Æ°u vÃ o chÃºng lÃ  má»™t hÆ°á»›ng nghiÃªn cá»©u há»©a háº¹n khÃ¡c.

ChÃºng tÃ´i cÅ©ng Ä‘Ã£ chá»‰ ra ráº±ng, Ä‘á»‘i vá»›i cÃ¡c Ä‘áº§u vÃ o cÃ¢n báº±ng hai chuyÃªn gia má»™t cÃ¡ch tÆ°Æ¡ng tá»±, náº¿u hai giÃ¡ trá»‹ chuyÃªn gia ráº¥t khÃ¡c nhau, thÃ¬ MoE cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi háº±ng sá»‘ Lipschitz cao hÆ¡n. Tuy nhiÃªn, Ä‘á»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trong thá»±c táº¿, chÃºng tÃ´i tháº¥y dá»± Ä‘oÃ¡n cá»§a chÃºng tÆ°Æ¡ng Ä‘á»‘i á»•n Ä‘á»‹nh, máº·c dÃ¹ cÃ³ nhá»¯ng thay Ä‘á»•i Ä‘Ã¡ng ká»ƒ trong viá»‡c lá»±a chá»n chuyÃªn gia, lÃ m ná»•i báº­t sá»± dÆ° thá»«a tiá»m nÄƒng cá»§a cÃ¡c chuyÃªn gia Ä‘Ã£ há»c. Tuy nhiÃªn, quÃ¡ nhiá»u dÆ° thá»«a, vá»›i táº¥t cáº£ cÃ¡c chuyÃªn gia há»c cÃ¡c hÃ m tÆ°Æ¡ng tá»± lÃ  lÃ£ng phÃ­ kháº£ nÄƒng vÃ  cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t mÃ´ hÃ¬nh. Do Ä‘Ã³, Ä‘Ã¢y lÃ  má»™t váº¥n Ä‘á» nghiÃªn cá»©u thÃº vá»‹ Ä‘á»ƒ cÃ¢n báº±ng tÃ­nh bá»n vá»¯ng vÃ  Ä‘á»™ chÃ­nh xÃ¡c cá»§a MoE báº±ng cÃ¡ch kiá»ƒm soÃ¡t sá»± dÆ° thá»«a cá»§a cÃ¡c chuyÃªn gia.

**Lá»i cáº£m Æ¡n vÃ  Tiáº¿t lá»™ TÃ i trá»£**

Táº¥t cáº£ cÃ¡c tÃ¡c giáº£ muá»‘n cáº£m Æ¡n Sven Gowal Ä‘Ã£ chia sáº» codebase táº¥n cÃ´ng AutoPGD cá»§a há». ChÃºng tÃ´i cÅ©ng cáº£m Æ¡n Neil Houlsby, Basil Mustafa vÃ  AndrÃ© Susano Pinto Ä‘Ã£ cung cáº¥p pháº£n há»“i sÃ¢u sáº¯c trong khi lÃ m viá»‡c trÃªn dá»± Ã¡n nÃ y.
