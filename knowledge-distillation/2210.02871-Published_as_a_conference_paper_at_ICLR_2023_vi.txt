# 2210.02871.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/knowledge-distillation/2210.02871.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 865030 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================


--- TRANG 1 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023
Tá»° CHÆ¯NG Cáº¤T CHO
TIá»€N HUáº¤N LUYá»†N THÃŠM Cá»¦A TRANSFORMERS
Seanie Lee1â€ Minki Kang1,2Juho Lee1,2Sung Ju Hwang1Kenji Kawaguchi3âˆ—
KAIST1, AITRICS2, National University of Singapore3
{lsnfamily02, zzxc1133, juholee, sjhwang82 }@kaist.ac.kr
kenji@comp.nus.edu.sg
TÃ“M Táº®T
Viá»‡c Ã¡p dá»¥ng tiá»n huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh transformer lá»›n trÃªn lÆ°á»£ng lá»›n dá»¯ liá»‡u
khÃ´ng nhÃ£n vÃ  tinh chá»‰nh chÃºng trÃªn cÃ¡c táº­p dá»¯ liá»‡u cÃ³ nhÃ£n cho cÃ¡c tÃ¡c vá»¥ downstream
Ä‘a dáº¡ng Ä‘Ã£ chá»©ng minh sá»± thÃ nh cÃ´ng Ä‘Ã¡ng ká»ƒ trong cÃ¡c tÃ¡c vá»¥ xá»­ lÃ½ thá»‹ giÃ¡c vÃ  ngÃ´n
ngá»¯ tá»± nhiÃªn khÃ¡c nhau. Tuy nhiÃªn, phÆ°Æ¡ng phÃ¡p tinh chá»‰nh trá»±c tiáº¿p cÃ³ thá»ƒ dáº«n Ä‘áº¿n
hiá»‡u suáº¥t khÃ´ng tá»‘i Æ°u náº¿u tá»“n táº¡i sá»± khÃ¡c biá»‡t Ä‘Ã¡ng ká»ƒ giá»¯a miá»n tiá»n huáº¥n luyá»‡n
vÃ  miá»n tinh chá»‰nh. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, má»™t sá»‘ nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y Ä‘Ã£ Ä‘á»
xuáº¥t cÃ¡c chiáº¿n lÆ°á»£c tiá»n huáº¥n luyá»‡n thÃªm Ä‘á»ƒ tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n mÃ´ hÃ¬nh trÃªn
táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu trÆ°á»›c khi tinh chá»‰nh. Tuy nhiÃªn, cÃ¡c chiáº¿n lÆ°á»£c nÃ y
bá»‹ giá»›i háº¡n á»Ÿ cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ vÃ  cÃ³ thá»ƒ dáº«n Ä‘áº¿n overfitting khi Ã¡p dá»¥ng cho
Vision Transformers. Äá»ƒ vÆ°á»£t qua háº¡n cháº¿ nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y má»™t phÆ°Æ¡ng phÃ¡p
má»›i vá» tá»± chÆ°ng cáº¥t nhÆ° má»™t phÆ°Æ¡ng phÃ¡p Ä‘iá»u hÃ²a cho giai Ä‘oáº¡n tiá»n huáº¥n luyá»‡n
thÃªm. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i Ä‘áº§u tiÃªn tiá»n huáº¥n luyá»‡n thÃªm mÃ´ hÃ¬nh tiá»n huáº¥n
luyá»‡n ban Ä‘áº§u trÃªn dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu, vÃ  sau Ä‘Ã³ sá»­ dá»¥ng nÃ³ nhÆ° má»™t giÃ¡o
viÃªn cho tá»± chÆ°ng cáº¥t. Sau Ä‘Ã³ chÃºng tÃ´i láº¥y cÃ¹ng mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n ban Ä‘áº§u
lÃ m há»c sinh, vÃ  buá»™c cÃ¡c biá»ƒu diá»…n áº©n cá»§a nÃ³ pháº£i gáº§n vá»›i nhá»¯ng biá»ƒu diá»…n cá»§a giÃ¡o
viÃªn trong khi tá»‘i Æ°u hÃ³a há»c sinh vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡. CÃ¡c thÃ­
nghiá»‡m cá»§a chÃºng tÃ´i chá»©ng minh sá»± vÆ°á»£t trá»™i cá»§a tá»± chÆ°ng cáº¥t so vá»›i cÃ¡c baseline
liÃªn quan trÃªn cÃ¡c táº­p dá»¯ liá»‡u benchmark khÃ¡c nhau cho cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i hÃ¬nh
áº£nh vÃ  vÄƒn báº£n. HÆ¡n ná»¯a, chÃºng tÃ´i cung cáº¥p má»™t phÃ¢n tÃ­ch lÃ½ thuyáº¿t vá» phÆ°Æ¡ng
phÃ¡p Ä‘á» xuáº¥t sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n hÃ³a Ä‘á»ƒ lÃ m sÃ¡ng tá» cÃ¡ch tá»± chÆ°ng cáº¥t
cho tiá»n huáº¥n luyá»‡n thÃªm cÃ³ thá»ƒ nÃ¢ng cao hiá»‡u suáº¥t cá»§a cÃ¡c tÃ¡c vá»¥ downstream.

1 GIá»šI THIá»†U
CÃ¡c mÃ´ hÃ¬nh transformer tiá»n huáº¥n luyá»‡n (Devlin et al., 2019; Brown et al., 2020; Liu et al., 2019; He et al.,
2022) Ä‘Ã£ hiá»‡u quáº£ trÃªn cÃ¡c tÃ¡c vá»¥ xá»­ lÃ½ thá»‹ giÃ¡c vÃ  ngÃ´n ngá»¯ tá»± nhiÃªn khÃ¡c nhau. CÃ¡c mÃ´ hÃ¬nh tiá»n
huáº¥n luyá»‡n há»c biá»ƒu diá»…n tá»•ng quÃ¡t tá»« má»™t khá»‘i lÆ°á»£ng lá»›n dá»¯ liá»‡u khÃ´ng nhÃ£n Ä‘á»ƒ chÃºng tá»•ng quÃ¡t
hÃ³a tá»‘t cho cÃ¡c tÃ¡c vá»¥ downstream khÃ¡c nhau khi chÃºng Ä‘Æ°á»£c tinh chá»‰nh trÃªn má»—i tÃ¡c vá»¥ vá»›i má»™t táº­p
dá»¯ liá»‡u cÃ³ nhÃ£n.
Tuy nhiÃªn, trong nhiá»u á»©ng dá»¥ng tháº¿ giá»›i thá»±c, nÃ³ Ä‘Ã²i há»i má»™t lÆ°á»£ng ná»— lá»±c Ä‘Ã¡ng ká»ƒ Ä‘á»ƒ thÃ­ch á»©ng
mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i má»™t miá»n tÃ¡c vá»¥ downstream cá»¥ thá»ƒ vÃ¬ tá»“n táº¡i sá»± khÃ¡c biá»‡t phÃ¢n phá»‘i
Ä‘Ã¡ng ká»ƒ giá»¯a dá»¯ liá»‡u cho giai Ä‘oáº¡n tiá»n huáº¥n luyá»‡n vÃ  tinh chá»‰nh. HÆ¡n ná»¯a, viá»‡c thu tháº­p má»™t lÆ°á»£ng
lá»›n dá»¯ liá»‡u cÃ³ nhÃ£n cho cÃ¡c miá»n cá»¥ thá»ƒ nhÆ° váº­y lÃ  khÃ³ khÄƒn, Ä‘iá»u nÃ y lÃ m cho viá»‡c thÃ­ch á»©ng mÃ´
hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i cÃ¡c tÃ¡c vá»¥ downstream trá»Ÿ nÃªn thÃ¡ch thá»©c hÆ¡n.

0 10k 20K 30K 40K 50K 60K
CÃ¡c BÆ°á»›c Tiá»n Huáº¥n Luyá»‡n ThÃªm5052545658Äá»™ ChÃ­nh XÃ¡c Kiá»ƒm Tra
PhÃ¢n Loáº¡i HÃ¬nh áº¢nh trÃªn CUB
Tá»± ChÆ°ng Cáº¥t
Tiá»n Huáº¥n Luyá»‡n ThÃªm
HÃ¬nh 1: Äá»™ chÃ­nh xÃ¡c vá»›i viá»‡c thay Ä‘á»•i
sá»‘ bÆ°á»›c tiá»n huáº¥n luyá»‡n thÃªm.Má»™t sá»‘ cÃ´ng trÃ¬nh Ä‘Ã£ Ä‘á» xuáº¥t Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» thÃ­ch á»©ng
cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i má»™t miá»n cá»¥ thá»ƒ. Má»™t phÆ°Æ¡ng
phÃ¡p phá»• biáº¿n Ä‘á»ƒ thÃ­ch á»©ng mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n lÃ  tiá»n huáº¥n
luyá»‡n thÃªm, nÆ¡i chÃºng ta tiáº¿p tá»¥c cáº­p nháº­t cÃ¡c tham sá»‘ cá»§a mÃ´
hÃ¬nh tiá»n huáº¥n luyá»‡n trÃªn dá»¯ liá»‡u khÃ´ng nhÃ£n Ä‘áº·c thÃ¹ miá»n Ä‘Æ°á»£c
sÆ°u táº§m thÃªm vá»›i tá»± giÃ¡m sÃ¡t (Beltagy et al., 2019; Lee et al., 2020),
trÆ°á»›c khi tinh chá»‰nh nÃ³ trÃªn dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu nhÆ° Ä‘Æ°á»£c
miÃªu táº£ trong HÃ¬nh 2b. Gururangan et al. (2020) cÅ©ng cho tháº¥y
ráº±ng tiá»n huáº¥n luyá»‡n thÃªm chá»‰ vá»›i dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu
váº«n hiá»‡u quáº£ mÃ  khÃ´ng cáº§n dá»¯ liá»‡u bá»• sung nÃ o. Tuy nhiÃªn, háº§u háº¿t cÃ¡c phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n
luyá»‡n thÃªm hiá»‡n cÃ³ Ä‘Ã£ táº­p trung vÃ o cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯, vÃ  chÃºng tÃ´i tháº¥y ráº±ng tiá»n huáº¥n luyá»‡n thÃªm

âˆ—TÃ¡c giáº£ liÃªn há»‡â€ CÃ´ng viá»‡c Ä‘Æ°á»£c thá»±c hiá»‡n khi tÃ¡c giáº£ lÃ  thá»±c táº­p sinh táº¡i NUS.
1arXiv:2210.02871v3  [cs.CV]  9 Jun 2023

--- TRANG 2 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023
Transformerğ‘“!!"!#Bá»™ phÃ¢n loáº¡iâ„"(a) Tinh chá»‰nh
ğ‘¦=0
Táº­p dá»¯ liá»‡u cÃ³ nhÃ£nğ‘¦=1

(c) Tá»± chÆ°ng cáº¥t trong Tiá»n huáº¥n luyá»‡n thÃªm
Transformerğ‘“!âˆ—Bá»™ phÃ¢n loáº¡iâ„"âˆ—(b) Tiá»n huáº¥n luyá»‡n thÃªm
Táº­p dá»¯ liá»‡u
khÃ´ng nhÃ£n

Transformerğ‘“!%Bá»™ phÃ¢n loáº¡iâ„"

Transformerğ‘“!âˆ—Bá»™ phÃ¢n loáº¡iâ„"âˆ—

Táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n

Táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n

Transformerğ‘“!&Bá»™ phÃ¢n loáº¡iâ„"ğ“›ğ‘ªğ‘¬ğ“›ğ‘´ğ‘¨ğ‘¬

ğ“›ğ‘´ğ‘¨ğ‘¬+ ğ“›ğ‘«ğ’Šğ’”ğ’•ğ’Šğ’ğ’

ğ‘¦=0
Táº­p dá»¯ liá»‡u cÃ³ nhÃ£nğ‘¦=1

Transformerğ‘“!âˆ—Bá»™ phÃ¢n loáº¡iâ„"âˆ—ğ“›ğ‘ªğ‘¬

ğ‘¦=0
ğ‘¦=1ğ“›ğ‘ªğ‘¬Táº­p dá»¯ liá»‡u cÃ³ nhÃ£n

Transformerğ‘“!!"!#Bá»™ giáº£i mÃ£ğ‘”#!"!#ğ“›ğ‘´ğ‘¨ğ‘¬GiÃ¡o viÃªnHá»c sinh

Transformerğ‘“!!"!#Bá»™ giáº£i mÃ£ğ‘”#!"!#

Transformerğ‘“!%Bá»™ giáº£i mÃ£ğ‘”#%

HÃ¬nh 2: KhÃ¡i niá»‡m. So sÃ¡nh giá»¯a cÃ¡c phÆ°Æ¡ng phÃ¡p thÃ­ch á»©ng transformers tiá»n huáº¥n luyá»‡n vá»›i miá»n má»¥c tiÃªu. (a)
Tinh chá»‰nh mÃ  khÃ´ng cÃ³ tiá»n huáº¥n luyá»‡n thÃªm nÃ o. (b) Tiá»n huáº¥n luyá»‡n thÃªm vÃ  tinh chá»‰nh. (c) Tá»± chÆ°ng cáº¥t
trong tiá»n huáº¥n luyá»‡n thÃªm vÃ  tinh chá»‰nh.

chiáº¿n lÆ°á»£c khÃ´ng hiá»‡u quáº£ Ä‘á»‘i vá»›i Vision Transformer (ViT) (Dosovitskiy et al., 2021). NhÆ° Ä‘Æ°á»£c
hiá»ƒn thá»‹ trong HÃ¬nh 1, ViT dá»… bá»‹ overfitting vÃ  khÃ´ng tá»•ng quÃ¡t hÃ³a tá»‘t cho cÃ¡c tÃ¡c vá»¥ downstream
nhÆ° khi chÃºng ta tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n nÃ³ trÃªn dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu.

Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p Ä‘iá»u hÃ²a (Chen et al., 2020a; Gouk et al., 2021; Aghajanyan et al., 2021) Ä‘Ã£
Ä‘á» xuáº¥t Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» overfitting cá»§a cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n lá»›n, tuy nhiÃªn, chÃºng khÃ´ng
xem xÃ©t quÃ¡ trÃ¬nh thÃ­ch á»©ng nhÆ° tiá»n huáº¥n luyá»‡n thÃªm. Thay vÃ o Ä‘Ã³, chÃºng buá»™c khoáº£ng cÃ¡ch giá»¯a
trá»ng sá»‘ tinh chá»‰nh cuá»‘i cÃ¹ng vÃ  trá»ng sá»‘ tiá»n huáº¥n luyá»‡n pháº£i nhá» Ä‘á»ƒ thÃºc Ä‘áº©y viá»‡c chuyá»ƒn giao
kiáº¿n thá»©c Ä‘Æ°á»£c thu tháº­p tá»« tiá»n huáº¥n luyá»‡n sang cÃ¡c tÃ¡c vá»¥ downstream Ä‘á»ƒ tá»•ng quÃ¡t hÃ³a tá»‘t hÆ¡n.
Tuy nhiÃªn, nhá»¯ng Ä‘iá»u hÃ²a nÃ y cáº£n trá»Ÿ viá»‡c thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i cÃ¡c tÃ¡c vá»¥
downstream Ä‘áº·c biá»‡t khi cÃ³ sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i Ä‘Ã¡ng ká»ƒ giá»¯a dá»¯ liá»‡u tiá»n huáº¥n luyá»‡n vÃ  dá»¯
liá»‡u má»¥c tiÃªu. Cuá»‘i cÃ¹ng nÃ³ dáº«n Ä‘áº¿n viá»‡c tá»•ng quÃ¡t hÃ³a tá»‡ hÆ¡n so vá»›i chiáº¿n lÆ°á»£c tinh chá»‰nh Ä‘Æ¡n giáº£n.

Äá»ƒ giáº£i quyáº¿t nhá»¯ng háº¡n cháº¿ nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t tá»± chÆ°ng cáº¥t nhÆ° má»™t Ä‘iá»u hÃ²a cho tiá»n huáº¥n
luyá»‡n thÃªm trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ thÃ­ch á»©ng hiá»‡u quáº£ cÃ¡c mÃ´ hÃ¬nh
tiá»n huáº¥n luyá»‡n vá»›i tÃ¡c vá»¥ downstream cá»§a cÃ¡c miá»n khÃ¡c nhau vá»›i má»™t lÆ°á»£ng háº¡n cháº¿ dá»¯ liá»‡u cÃ³
nhÃ£n. Äá»‘i vá»›i tá»± giÃ¡m sÃ¡t, chÃºng tÃ´i táº­p trung vÃ o mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ cho tiá»n huáº¥n luyá»‡n
vÃ¬ nÃ³ khÃ´ng phá»¥ thuá»™c vÃ o báº¥t ká»³ tÄƒng cÆ°á»ng dá»¯ liá»‡u nÃ o, so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p há»c tá»± giÃ¡m sÃ¡t
khÃ¡c (Chen et al., 2020b; He et al., 2020; Grill et al., 2020; Zbontar et al., 2021; Chen & He, 2021; Caron et al., 2021) yÃªu cáº§u tÄƒng cÆ°á»ng dá»¯ liá»‡u Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c cáº·p dÆ°Æ¡ng cho má»¥c tiÃªu há»c tá»± giÃ¡m sÃ¡t nhÆ° há»c tÆ°Æ¡ng pháº£n. Äiá»u nÃ y Ä‘áº·c biá»‡t há»¯u Ã­ch khi khÃ³ Ä‘á»‹nh nghÄ©a cÃ¡c tÄƒng cÆ°á»ng dá»¯ liá»‡u cÃ³ Ã½ nghÄ©a cho má»™t miá»n má»¥c tiÃªu.

Cá»¥ thá»ƒ, chÃºng tÃ´i láº¥y mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i má»™t bá»™ mÃ£ hÃ³a fÎ¸init vÃ  má»™t bá»™ giáº£i mÃ£ gÏ•init Ä‘Æ°á»£c
tiá»n huáº¥n luyá»‡n trÃªn má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u khÃ´ng nhÃ£n tá»« miá»n tá»•ng quÃ¡t, vÃ  tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n
nÃ³ vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ (MAE) (Devlin et al., 2019; He et al., 2022) trÃªn dá»¯ liá»‡u
khÃ´ng nhÃ£n má»¥c tiÃªu Ä‘á»ƒ thu Ä‘Æ°á»£c fÎ¸0 vÃ  gÏ•0. Sau Ä‘Ã³, chÃºng tÃ´i Ä‘áº·t bá»™ mÃ£ hÃ³a fÎ¸0 nhÆ° má»™t giÃ¡o viÃªn
cho tá»± chÆ°ng cáº¥t. Sau Ä‘Ã³ chÃºng tÃ´i láº¥y báº£n sao cá»§a mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n (fÎ¸init, gÏ•init) lÃ m há»c
sinh, vÃ  khá»›p cÃ¡c biá»ƒu diá»…n cá»§a bá»™ mÃ£ hÃ³a há»c sinh vÃ  nhá»¯ng biá»ƒu diá»…n cá»§a bá»™ mÃ£ hÃ³a giÃ¡o viÃªn
trong khi tá»‘i Æ°u hÃ³a há»c sinh vá»›i MAE trÃªn dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu. Cuá»‘i cÃ¹ng, chÃºng tÃ´i tinh
chá»‰nh há»c sinh tá»± chÆ°ng cáº¥t fÎ¸1 trÃªn dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu cho tÃ¡c vá»¥ downstream. ChÃºng tÃ´i
minh há»a tá»•ng quan phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i trong HÃ¬nh 2c.

Äá»ƒ xÃ¡c minh hiá»‡u quáº£ cá»§a phÆ°Æ¡ng phÃ¡p chÃºng tÃ´i, chÃºng tÃ´i thá»±c nghiá»‡m cho tháº¥y ráº±ng nÃ³ cáº£i thiá»‡n
Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a ViT tiá»n huáº¥n luyá»‡n vÃ  mÃ´ hÃ¬nh ngÃ´n ngá»¯ RoBERTA (Liu et al., 2019), vÃ  vÆ°á»£t trá»™i hÆ¡n cÃ¡c baseline liÃªn quan trÃªn cÃ¡c táº­p dá»¯ liá»‡u phÃ¢n loáº¡i hÃ¬nh áº£nh vÃ  vÄƒn báº£n
khÃ¡c nhau. HÆ¡n ná»¯a, chÃºng tÃ´i phÃ¢n tÃ­ch lÃ½ thuyáº¿t phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t vá»›i má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n
hÃ³a Ä‘á»ƒ hiá»ƒu cÃ¡ch tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm cÃ³ thá»ƒ tiá»m nÄƒng giÃºp cáº£i thiá»‡n hiá»‡u suáº¥t
tá»•ng quÃ¡t hÃ³a trÃªn cÃ¡c tÃ¡c vá»¥ má»¥c tiÃªu sau khi tinh chá»‰nh.

ÄÃ³ng gÃ³p cá»§a chÃºng tÃ´i gá»“m ba pháº§n:
â€¢ ChÃºng tÃ´i Ä‘á» xuáº¥t tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c
tiÃªu, nÆ¡i chÃºng ta buá»™c cÃ¡c biá»ƒu diá»…n cá»§a há»c sinh pháº£i gáº§n vá»›i nhá»¯ng biá»ƒu diá»…n cá»§a giÃ¡o
viÃªn tiá»n huáº¥n luyá»‡n thÃªm trong khi huáº¥n luyá»‡n há»c sinh vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡.
â€¢ ChÃºng tÃ´i phÃ¢n tÃ­ch lÃ½ thuyáº¿t phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t vá»›i má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n hÃ³a Ä‘á»ƒ hiá»ƒu
cÃ¡ch tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm cÃ³ thá»ƒ tiá»m nÄƒng dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»•ng quÃ¡t
hÃ³a tá»‘t hÆ¡n cá»§a cÃ¡c tÃ¡c vá»¥ downstream.

2

--- TRANG 3 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

â€¢ ChÃºng tÃ´i xÃ¡c thá»±c rá»™ng rÃ£i phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i trÃªn cÃ¡c táº­p dá»¯ liá»‡u phÃ¢n loáº¡i hÃ¬nh
áº£nh vÃ  vÄƒn báº£n khÃ¡c nhau vá»›i cÃ¡c transformers tiá»n huáº¥n luyá»‡n vÃ  cho tháº¥y ráº±ng phÆ°Æ¡ng
phÃ¡p cá»§a chÃºng tÃ´i vÆ°á»£t trá»™i hÆ¡n cÃ¡c baseline liÃªn quan.

2 CÃ”NG TRÃŒNH LIÃŠN QUAN

Tá»± ChÆ°ng Cáº¥t ChÆ°ng cáº¥t kiáº¿n thá»©c lÃ  chuyá»ƒn giao kiáº¿n thá»©c tá»« giÃ¡o viÃªn sang há»c sinh báº±ng cÃ¡ch
tá»‘i thiá»ƒu hÃ³a má»™t sá»± khÃ¡c biá»‡t giá»¯a Ä‘áº§u ra cá»§a giÃ¡o viÃªn vÃ  há»c sinh (Hinton et al., 2014). Khi viá»‡c
tham sá»‘ hÃ³a cá»§a há»c sinh vÃ  giÃ¡o viÃªn lÃ  giá»‘ng há»‡t nhau, chÃºng ta gá»i Ä‘Ã³ lÃ  tá»± chÆ°ng cáº¥t nhÆ° má»™t
trÆ°á»ng há»£p Ä‘áº·c biá»‡t cá»§a chÆ°ng cáº¥t kiáº¿n thá»©c. Máº·c dÃ¹ khÃ´ng cÃ³ thÃ´ng tin má»›i trong quÃ¡ trÃ¬nh tá»±
chÆ°ng cáº¥t, Furlanello et al. (2018) Ä‘Ã£ cho tháº¥y ráº±ng há»c sinh tá»« tá»± chÆ°ng cáº¥t Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»•ng
quÃ¡t hÃ³a tá»‘t hÆ¡n so vá»›i giÃ¡o viÃªn. Má»™t hiá»‡n tÆ°á»£ng tÆ°Æ¡ng tá»± Ä‘Ã£ Ä‘Æ°á»£c quan sÃ¡t tháº¥y má»™t cÃ¡ch nháº¥t quÃ¡n
trong cÃ¡c cÃ´ng trÃ¬nh khÃ¡c (Yang et al., 2019; Ahn et al., 2019). Má»™t sá»‘ cÃ´ng trÃ¬nh Ä‘á» xuáº¥t tá»± chÆ°ng
cáº¥t mÃ  khÃ´ng cÃ³ máº¡ng giÃ¡o viÃªn tiá»n huáº¥n luyá»‡n (Sun et al., 2019; Zhang et al., 2019; 2022). Há»
thÃªm cÃ¡c bá»™ phÃ¢n loáº¡i phá»¥ trá»£ vÃ o cÃ¡c lá»›p trung gian vÃ  huáº¥n luyá»‡n cÃ¡c bá»™ phÃ¢n loáº¡i Ä‘á»ƒ tá»‘i thiá»ƒu
hÃ³a sá»± khÃ¡c biá»‡t giá»¯a Ä‘áº§u ra cá»§a bá»™ phÃ¢n loáº¡i á»Ÿ lá»›p cuá»‘i cÃ¹ng vÃ  Ä‘áº§u ra cá»§a cÃ¡c bá»™ phÃ¢n loáº¡i phá»¥
trá»£. Mobahi et al. (2020) phÃ¢n tÃ­ch lÃ½ thuyáº¿t cÃ¡ch tá»± chÆ°ng cáº¥t gÃ¢y ra Ä‘iá»u hÃ²a vÃ  giáº£m overfitting
trong khÃ´ng gian Hilbert. Tuy nhiÃªn, táº¥t cáº£ há» Ä‘á»u táº­p trung vÃ o tá»± chÆ°ng cáº¥t cho há»c cÃ³ giÃ¡m sÃ¡t.
Thay vÃ o Ä‘Ã³, chÃºng tÃ´i chá»©ng minh thá»±c nghiá»‡m vÃ  lÃ½ thuyáº¿t ráº±ng tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n
thÃªm vá»›i tá»± giÃ¡m sÃ¡t dáº«n Ä‘áº¿n tá»•ng quÃ¡t hÃ³a tá»‘t hÆ¡n cá»§a cÃ¡c tÃ¡c vá»¥ downstream sau khi tinh chá»‰nh
mÃ´ hÃ¬nh tá»± chÆ°ng cáº¥t vá»›i dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu.

Tiá»n Huáº¥n Luyá»‡n ThÃªm Lee et al. (2020); Beltagy et al. (2019); Sun et al. (2020) Ä‘Ã£ cho tháº¥y sá»±
thÃ nh cÃ´ng cá»§a viá»‡c tiáº¿n hÃ nh tiá»n huáº¥n luyá»‡n mÃ´ hÃ¬nh ngÃ´n ngá»¯ trÃªn má»™t sá»‘ lÆ°á»£ng lá»›n kho ngá»¯ liá»‡u
Ä‘Æ°á»£c thu tháº­p tá»« miá»n má»¥c tiÃªu vÃ  tinh chá»‰nh mÃ´ hÃ¬nh trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu. Tuy nhiÃªn,
viá»‡c tiá»n huáº¥n luyá»‡n thÃªm mÃ´ hÃ¬nh trÃªn má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u vÄƒn báº£n khÃ´ng nhÃ£n tá»‘n nhiá»u tÃ­nh
toÃ¡n vÃ  cÃ³ thá»ƒ khÃ´ng kháº£ thi Ä‘á»ƒ thu tháº­p quy mÃ´ lá»›n nhÆ° váº­y cá»§a dá»¯ liá»‡u khÃ´ng nhÃ£n trÃªn cÃ¡c miá»n
nháº¥t Ä‘á»‹nh. Thay vÃ o Ä‘Ã³, Gururangan et al. (2020) Ä‘Æ°a ra má»™t tiá»n huáº¥n luyá»‡n thÃ­ch á»©ng tÃ¡c vá»¥ nÆ¡i
chÃºng ta chá»‰ sá»­ dá»¥ng dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu cho viá»‡c tiá»n huáº¥n luyá»‡n thÃªm mÃ´ hÃ¬nh ngÃ´n ngá»¯
trÆ°á»›c khi tinh chá»‰nh mÃ´ hÃ¬nh trÃªn dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu. Äá»ƒ cáº£i thiá»‡n hiá»‡u quáº£ cá»§a tiá»n huáº¥n
luyá»‡n thÃªm, Kang et al. (2020); Ye et al. (2021) Ä‘á» xuáº¥t há»c Ä‘á»ƒ táº¡o máº·t náº¡ Ä‘áº§u vÃ o cho mÃ£ hÃ³a tá»±
Ä‘á»™ng cÃ³ máº·t náº¡ vá»›i tá»‘i Æ°u hÃ³a hai cáº¥p, Ä‘iá»u nÃ y Ä‘Ã²i há»i chi phÃ­ tÃ­nh toÃ¡n quÃ¡ cao. Tuy nhiÃªn, táº¥t cáº£
há» chá»‰ táº­p trung duy nháº¥t vÃ o cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ tiá»n huáº¥n luyá»‡n vÃ  chÃºng tÃ´i tháº¥y thá»±c nghiá»‡m
ráº±ng tiá»n huáº¥n luyá»‡n thÃªm Ä‘Æ¡n thuáº§n khÃ´ng hiá»‡u quáº£ Ä‘á»‘i vá»›i Vision Transformers.

Äiá»u HÃ²a cho Tinh Chá»‰nh CÃ³ má»™t sá»‘ cÃ´ng trÃ¬nh Ä‘á» xuáº¥t Ä‘iá»u hÃ²a cho viá»‡c tinh chá»‰nh má»™t mÃ´ hÃ¬nh
tiá»n huáº¥n luyá»‡n. Chen et al. (2020a) Ä‘á» xuáº¥t sá»­a Ä‘á»•i bá»™ tá»‘i Æ°u Adam (Kingma & Ba, 2015), Ä‘Æ°á»£c
gá»i lÃ  RecAdam, buá»™c mÃ´ hÃ¬nh tinh chá»‰nh gáº§n vá»›i mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n ban Ä‘áº§u báº±ng cÃ¡ch tá»‘i
thiá»ƒu hÃ³a khoáº£ng cÃ¡ch L2 giá»¯a trá»ng sá»‘ tinh chá»‰nh vÃ  trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u. TÆ°Æ¡ng tá»±,
Gouk et al. (2021) chiáº¿u trá»ng sá»‘ tinh chá»‰nh cho má»—i láº§n cáº­p nháº­t gradient descent sao cho nÃ³ náº±m
trong hÃ¬nh cáº§u cÃ³ tÃ¢m táº¡i trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u vá»›i khoáº£ng cÃ¡ch Ä‘Æ°á»£c táº¡o ra bá»Ÿi chuáº©n
cá»§a tá»•ng tuyá»‡t Ä‘á»‘i hÃ ng tá»‘i Ä‘a (MARS). Thay vÃ¬ tá»‘i thiá»ƒu hÃ³a khoáº£ng cÃ¡ch má»™t cÃ¡ch rÃµ rÃ ng, Ä‘Æ°á»£c
thÃºc Ä‘áº©y bá»Ÿi lÃ½ thuyáº¿t trust region, Aghajanyan et al. (2021) Ä‘á» xuáº¥t tá»‘i thiá»ƒu hÃ³a phÃ¢n ká»³ KL Ä‘á»‘i
xá»©ng giá»¯a Ä‘áº§u ra mÃ´ hÃ¬nh cá»§a má»™t Ä‘áº§u vÃ o gá»‘c vÃ  Ä‘áº§u ra cá»§a Ä‘áº§u vÃ o bá»‹ nhiá»…u bá»Ÿi tiáº¿ng á»“n Gaussian.
Tuy nhiÃªn, táº¥t cáº£ há» khÃ´ng xem xÃ©t thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i má»™t miá»n má»¥c tiÃªu
cá»¥ thá»ƒ, Ä‘iá»u nÃ y dáº«n Ä‘áº¿n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a tá»‡ hÆ¡n cá»§a cÃ¡c tÃ¡c vá»¥ downstream so vá»›i chiáº¿n
lÆ°á»£c tinh chá»‰nh Ä‘Æ¡n giáº£n.

3 PHÆ¯Æ NG PHÃP

3.1 CÃC KIáº¾N THá»¨C CÆ  Báº¢N

PhÃ¡t Biá»ƒu Váº¥n Äá» ChÃºng ta giáº£ Ä‘á»‹nh ráº±ng chÃºng ta Ä‘Æ°á»£c cho (Î¸init, Ï•init) lÃ  cÃ¡c tham sá»‘ cá»§a máº¡ng
neural gÏ•initâ—¦fÎ¸init Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n trÃªn má»™t khá»‘i lÆ°á»£ng lá»›n dá»¯ liá»‡u khÃ´ng nhÃ£n vá»›i má»¥c tiÃªu
mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡, nÆ¡i fÎ¸init lÃ  má»™t bá»™ mÃ£ hÃ³a trÃ­ch xuáº¥t biá»ƒu diá»…n áº©n cá»§a má»™t Ä‘áº§u vÃ o vÃ 
gÏ•init lÃ  má»™t bá»™ giáº£i mÃ£ tÃ¡i táº¡o má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡. Má»¥c tiÃªu cá»§a chÃºng ta lÃ  tinh chá»‰nh mÃ´ hÃ¬nh
tiá»n huáº¥n luyá»‡n fÎ¸init vá»›i má»™t Ä‘áº§u ra Ä‘áº·c thÃ¹ tÃ¡c vá»¥ Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn hÏ‰ trÃªn táº­p dá»¯ liá»‡u cÃ³
nhÃ£n Dtr={(x(i), y(i))}n i=1 cá»§a má»™t tÃ¡c vá»¥ phÃ¢n loáº¡i downstream sao cho mÃ´ hÃ¬nh tá»•ng quÃ¡t hÃ³a tá»‘t
cho táº­p dá»¯ liá»‡u kiá»ƒm tra chÆ°a tháº¥y Dtest. Má»™t phÆ°Æ¡ng phÃ¡p Ä‘iá»ƒn hÃ¬nh Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y lÃ 
tá»‘i thiá»ƒu hÃ³a rá»§i ro thá»±c nghiá»‡m nhÆ° sau:

minimize
Î¸,Ï‰LCE(Î¸, Ï‰;Dtr)via algorithm Aas
(Î¸âˆ—, Ï‰âˆ—) =A(LCE;Î¸init,Dtr),(1)

3

--- TRANG 4 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Thuáº­t toÃ¡n 1 Tá»± ChÆ°ng Cáº¥t
YÃªu cáº§u: Táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n Du, khá»Ÿi táº¡o Î¸init, Ï•init,
tá»· lá»‡ há»c Î±âˆˆRâ‰¥0, vÃ²ng tá»± chÆ°ng cáº¥t Tâ€²âˆˆ
N+, xÃ¡c suáº¥t táº¡o máº·t náº¡ Î³âˆˆ(0,1) vÃ  kÃ­ch thÆ°á»›c batch B.
1:Î¸0â†Further Pretrain (Du, Î¸init, Ï•init, Î±, Î³, B )
2:for all tâ†1, . . . , Tâ€²do
3: Khá»Ÿi táº¡o Î¸tâ†Î¸init vÃ  Ï•tâ†Ï•init
4: while not converge do
5: Láº¥y máº«u má»™t mini-batch {x(j)}B j=1 tá»« Du
6: for all jâ†1, . . . , B do
7: Láº¥y máº«u má»™t máº·t náº¡ z(j)âˆ¼pÎ³,K(z)
8: Z(j)â†PK k=1z(j) k
9: Láº¥y má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡ Ë†x(j) vá»›i z(j)
10: â„“1 jâ† âˆ’PK k=1z(j) k Z(j)logpÎ¸t,Ï•t(x(j) k|Ë†x(j))
11: â„“2 jâ† ||fÎ¸t(x(j))âˆ’StopGrad (fÎ¸0(x(j)))|| 2 2
12: end for
13: L1â†1 B PB j=1â„“1 j,L2â†1 B PB j=1â„“2 j
14: Î¸tâ†Î¸tâˆ’Î±âˆ‚(L1+L2) âˆ‚Î¸|Î¸=Î¸t
15: Ï•tâ†Ï•tâˆ’Î±âˆ‚L1 âˆ‚Ï•|Ï•=Ï•t
16: end while17: Î¸0â†Î¸t
18:end for19:return Î¸Tâ€²

Thuáº­t toÃ¡n 2 Tiá»n Huáº¥n Luyá»‡n ThÃªm
YÃªu cáº§u: Táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n Du, khá»Ÿi táº¡o
Î¸init, Ï•init, tá»· lá»‡ há»c Î±âˆˆRâ‰¥0, xÃ¡c suáº¥t
táº¡o máº·t náº¡ Î³âˆˆ(0,1), vÃ  kÃ­ch thÆ°á»›c batch B.
1: Khá»Ÿi táº¡o Î¸0â†Î¸init vÃ  Ï•0â†Ï•init
2:while not converge do
3: Láº¥y máº«u má»™t mini-batch {x(j)}B j=1 tá»« Du
4: for all jâ†1, . . . , B do
5: Láº¥y máº«u má»™t máº·t náº¡ z(j)âˆ¼pÎ³,T(z)
6: Z(j)â†PK k=1z(j) k
7: Láº¥y má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡ Ë†x(j) vá»›i z(j)
8: pkâ†pÎ¸0,Ï•0(x(j) k|Ë†x(j))
9: â„“1 jâ† âˆ’PK k=1z(j) k Z(j)logpk
10: end for
11: L â†1 B PB j=1â„“1 j
12: Î¸0â†Î¸0âˆ’Î±âˆ‚L âˆ‚Î¸|Î¸=Î¸0
13: Ï•0â†Ï•0âˆ’Î±âˆ‚L âˆ‚Ï•|Ï•=Ï•0
14:end while
15:return Î¸0
16:
17:

nÆ¡i LCE lÃ  má»™t hÃ m máº¥t mÃ¡t cross-entropy vÃ  A biá»ƒu thá»‹ má»™t thuáº­t toÃ¡n gradient descent ngáº«u nhiÃªn Ä‘á»ƒ tá»‘i thiá»ƒu hÃ³a LCE trÃªn táº­p dá»¯ liá»‡u Dtr vá»›i khá»Ÿi táº¡o Î¸init.

Tiá»n Huáº¥n Luyá»‡n ThÃªm Tuy nhiÃªn, mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n dá»… bá»‹ overfitting khi nÃ³ Ä‘Æ°á»£c tinh chá»‰nh trÃªn má»™t lÆ°á»£ng nhá» dá»¯ liá»‡u cÃ³ nhÃ£n Ä‘áº·c thÃ¹ miá»n. Gururangan et al. (2020) Ä‘Ã£ cho tháº¥y ráº±ng tiá»n huáº¥n luyá»‡n thÃªm, nÆ¡i chÃºng ta tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n mÃ´ hÃ¬nh gÏ•initâ—¦fÎ¸init trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu Du={x(i)}n i=1 vÃ  sau Ä‘Ã³ tinh chá»‰nh nÃ³ trÃªn Dtr, lÃ  hiá»‡u quáº£ Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a khi khÃ´ng cÃ³ Ä‘á»§ dá»¯ liá»‡u cÃ³ nhÃ£n Ä‘áº·c thÃ¹ miá»n. LÆ°u Ã½ ráº±ng Du giá»‘ng há»‡t nhÆ° Dtr ngoáº¡i trá»« viá»‡c chÃºng ta loáº¡i bá» cÃ¡c nhÃ£n y(i). Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i táº­p trung vÃ o mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ (Devlin et al., 2019; He et al., 2022) nhÆ° má»™t hÃ m má»¥c tiÃªu tiá»n huáº¥n luyá»‡n vÃ¬ tÃ­nh tá»•ng quÃ¡t cá»§a nÃ³ so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p tá»± giÃ¡m sÃ¡t khÃ¡c (Chen et al., 2020b; He et al., 2020; Grill et al., 2020; He et al., 2020; Chen & He, 2021; Caron et al., 2021) yÃªu cáº§u tÄƒng cÆ°á»ng dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a rÃµ Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c cáº·p dÆ°Æ¡ng cho há»c tá»± giÃ¡m sÃ¡t.

MÃ£ HÃ³a Tá»± Äá»™ng CÃ³ Máº·t Náº¡ ChÃºng tÃ´i mÃ´ táº£ ngáº¯n gá»n má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ (Liu et al., 2019; He et al., 2022) cho má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÆ° RoBERTA (Liu et al., 2019) vÃ  Vision Transformer (ViT) (Dosovitskiy et al., 2021). Cho x(i)= (x(i) 1, . . . , x(i) K) lÃ  má»™t chuá»—i cÃ¡c patch cho má»™t hÃ¬nh áº£nh hoáº·c token cho má»™t cÃ¢u vá»›i Ä‘á»™ dÃ i K. Sau Ä‘Ã³ chÃºng ta láº¥y máº«u Ä‘á»™c láº­p má»™t máº·t náº¡ nhá»‹ phÃ¢n tá»« phÃ¢n phá»‘i Bernoulli vá»›i xÃ¡c suáº¥t Î³ cho má»—i x(i) k, Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  z(i)= (z(i) 1, . . . , z(i) K). Náº¿u z(i) k= 1, thÃ¬ x(i) k Ä‘Æ°á»£c thay tháº¿ báº±ng má»™t token "mask" Ä‘áº·c biá»‡t. NgÆ°á»£c láº¡i, chÃºng ta sá»­ dá»¥ng cÃ¹ng x(i) k cho má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡. Cho Ë†x(i)= (Ë†x(i) 1, . . . , Ë†x(i) K) lÃ  má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡ vÃ  cho fÎ¸, gÏ• láº§n lÆ°á»£t lÃ  má»™t bá»™ mÃ£ hÃ³a vÃ  bá»™ giáº£i mÃ£. Sau Ä‘Ã³ má»¥c tiÃªu cuá»‘i cÃ¹ng cho mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:

LMAE(Î¸, Ï•;Du) =1 n nX i=1Ez(i)âˆ¼pÎ³,T(z)" âˆ’KX k=1z(i) k Z(i)Â·logpÎ¸,Ï•(x(i) k|Ë†x(i))# , Z(i)=KX k=1z(i) k,(2)

nÆ¡i pÎ³,K(z) biá»ƒu thá»‹ má»™t phÃ¢n phá»‘i Binomial vá»›i cÃ¡c tham sá»‘ Î³ cho xÃ¡c suáº¥t zk= 1 vÃ  K cho sá»‘ láº§n thá»­. LÆ°u Ã½ ráº±ng negative log-likelihood Ä‘Æ°á»£c thá»ƒ hiá»‡n nhÆ° cross-entropy loss cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ hoáº·c mean square error cho Vision Transformers. Xem Phá»¥ lá»¥c C Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.

3.2 Tá»° CHÆ¯NG Cáº¤T CHO TIá»€N HUáº¤N LUYá»†N THÃŠM

Máº·c dÃ¹ chiáº¿n lÆ°á»£c tiá»n huáº¥n luyá»‡n thÃªm Ä‘Ã£ hiá»‡u quáº£ trÃªn miá»n vÄƒn báº£n (Gururangan et al., 2020; Lee et al., 2020; Sun et al., 2020), chÃºng tÃ´i tháº¥y thá»±c nghiá»‡m ráº±ng ViT vá»›i tiá»n huáº¥n luyá»‡n thÃªm overfit dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu vÃ  khÃ´ng tá»•ng quÃ¡t hÃ³a tá»‘t cho cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i hÃ¬nh áº£nh downstream.

4

--- TRANG 5 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t tá»± chÆ°ng cáº¥t nhÆ° má»™t Ä‘iá»u hÃ²a cho tiá»n huáº¥n luyá»‡n thÃªm. Cá»¥ thá»ƒ, cho má»™t mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n gÏ•initâ—¦fÎ¸init, chÃºng tÃ´i Ä‘áº§u tiÃªn tiáº¿p tá»¥c huáº¥n luyá»‡n mÃ´ hÃ¬nh trÃªn dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu Du vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ nhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong phÆ°Æ¡ng trÃ¬nh 2 Ä‘á»ƒ thu Ä‘Æ°á»£c bá»™ mÃ£ hÃ³a fÎ¸0 vÃ  bá»™ giáº£i mÃ£ gÏ•0. ChÃºng tÃ´i loáº¡i bá» bá»™ giáº£i mÃ£ vÃ  coi bá»™ mÃ£ hÃ³a fÎ¸0 nhÆ° má»™t giÃ¡o viÃªn cho tá»± chÆ°ng cáº¥t. Sau Ä‘Ã³ chÃºng tÃ´i láº¥y báº£n sao cá»§a máº¡ng tiá»n huáº¥n luyá»‡n ban Ä‘áº§u gÏ•initâ—¦fÎ¸init lÃ m há»c sinh vÃ  tiá»n huáº¥n luyá»‡n thÃªm há»c sinh vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ nhÆ°ng buá»™c biá»ƒu diá»…n áº©n cá»§a bá»™ mÃ£ hÃ³a cá»§a há»c sinh fÎ¸init pháº£i gáº§n vá»›i biá»ƒu diá»…n cá»§a giÃ¡o viÃªn fÎ¸0 nhÆ° sau:

(Î¸1, Ï•1)âˆˆarg min Î¸,Ï•(LMAE(Î¸, Ï•;Du) +LDistill (Î¸;Î¸0,Du))
LDistill (Î¸;Î¸0,Du) =1 n nX i=1 ||fÎ¸(x(i))âˆ’StopGrad fÎ¸0(x(i))|| 2 2(3)

nÆ¡i Î¸ vÃ  Ï• Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i cÃ¡c tham sá»‘ tiá»n huáº¥n luyá»‡n Î¸init vÃ  Ï•init, tÆ°Æ¡ng á»©ng vÃ  StopGrad biá»ƒu thá»‹ phÃ©p toÃ¡n stop-gradient khÃ´ng lan truyá»n ngÆ°á»£c qua Ä‘áº§u vÃ o. NhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong Thuáº­t toÃ¡n 1, chÃºng ta cÃ³ thá»ƒ láº·p láº¡i quÃ¡ trÃ¬nh nÃ y Ä‘á»ƒ thá»±c hiá»‡n nhiá»u vÃ²ng tá»± chÆ°ng cáº¥t (Tâ€²>1) nÆ¡i há»c sinh cá»§a vÃ²ng trÆ°á»›c trá»Ÿ thÃ nh giÃ¡o viÃªn vÃ  má»™t há»c sinh má»›i Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i cÃ¡c trá»ng sá»‘ tiá»n huáº¥n luyá»‡n Î¸init vÃ  Ï•init cho vÃ²ng tiáº¿p theo. ChÃºng tÃ´i tháº¥y thá»±c nghiá»‡m ráº±ng vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t Ä‘Ã³ng vai trÃ² quan trá»ng nháº¥t trong viá»‡c cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cuá»‘i cÃ¹ng cá»§a cÃ¡c tÃ¡c vá»¥ downstream. HÆ¡n ná»¯a, phÃ¢n tÃ­ch lÃ½ thuyáº¿t cho tháº¥y ráº±ng vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t cÃ³ tÃ¡c Ä‘á»™ng lá»›n nháº¥t Ä‘áº¿n Ä‘iá»u hÃ²a. Do Ä‘Ã³, chÃºng tÃ´i thá»±c hiá»‡n má»™t vÃ²ng tá»± chÆ°ng cáº¥t duy nháº¥t Ä‘á»ƒ cÃ³ hiá»‡u quáº£ tÃ­nh toÃ¡n. Sau tá»± chÆ°ng cáº¥t, chÃºng tÃ´i loáº¡i bá» bá»™ giáº£i mÃ£ gÏ•1 vÃ  tinh chá»‰nh bá»™ mÃ£ hÃ³a cá»§a há»c sinh fÎ¸1 cÃ¹ng vá»›i má»™t Ä‘áº§u ra Ä‘áº·c thÃ¹ tÃ¡c vá»¥ Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn hÏ‰ báº±ng cÃ¡ch tá»‘i thiá»ƒu hÃ³a LCE(Î¸, Ï‰,;Dtr) vá»›i khá»Ÿi táº¡o Î¸1 nhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong phÆ°Æ¡ng trÃ¬nh 1.

4 PHÃ‚N TÃCH LÃ THUYáº¾T

Trong pháº§n nÃ y, chÃºng tÃ´i phÃ¢n tÃ­ch cÃ¡ch tá»± chÆ°ng cáº¥t áº£nh hÆ°á»Ÿng Ä‘áº¿n mÃ´ hÃ¬nh cuá»‘i cÃ¹ng sau khi tinh chá»‰nh vá» máº·t tá»•ng quÃ¡t hÃ³a vÃ  Ä‘iá»u hÃ²a. Pháº§n nÃ y chá»©ng minh má»™t giá»›i háº¡n tá»•ng quÃ¡t hÃ³a trÃªn hÃ m máº¥t mÃ¡t cÃ³ giÃ¡m sÃ¡t cho phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vÃ  cho tháº¥y ráº±ng giá»›i háº¡n tá»•ng quÃ¡t hÃ³a giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t khi sá»‘ lÆ°á»£ng tá»± chÆ°ng cáº¥t tÄƒng lÃªn. HÆ¡n ná»¯a, chÃºng tÃ´i cho tháº¥y ráº±ng tá»± chÆ°ng cáº¥t hoáº¡t Ä‘á»™ng nhÆ° má»™t Ä‘iá»u hÃ²a trÃªn khoáº£ng cÃ¡ch giá»¯a trá»ng sá»‘ ban Ä‘áº§u trÆ°á»›c tiá»n huáº¥n luyá»‡n thÃªm vÃ  trá»ng sá»‘ cuá»‘i cÃ¹ng sau tinh chá»‰nh. Hiá»‡u á»©ng Ä‘iá»u hÃ²a Ä‘Æ°á»£c cho tháº¥y cÃ³ tÃ¡c Ä‘á»™ng lá»›n nháº¥t trong vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t, Ä‘iá»u nÃ y gá»£i Ã½ ráº±ng vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t Ä‘Ã³ng vai trÃ² quan trá»ng hÆ¡n trong hiá»‡u suáº¥t cuá»‘i cÃ¹ng khi so sÃ¡nh vá»›i cÃ¡c vÃ²ng khÃ¡c.

ChÃºng tÃ´i xem xÃ©t Ä‘á»™ng há»c cá»§a vector trá»ng sá»‘ wt,Ï„ theo thá»i gian Ï„ cá»§a tinh chá»‰nh sau t vÃ²ng tá»± chÆ°ng cáº¥t, nÆ¡i w0,0 lÃ  káº¿t quáº£ cá»§a tiá»n huáº¥n luyá»‡n thÃªm, vÃ  wt,0âˆˆminimize w Lt(w) lÃ  káº¿t quáº£ cá»§a tá»± chÆ°ng cáº¥t cá»§a t vÃ²ng vá»›i Lt(w) =1 n Pn i=1âˆ¥f(xi, w)âˆ’f(xi, wtâˆ’1,0)âˆ¥2 2+Î»âˆ¥wâˆ¥2 2 cho má»™t sá»‘ Î» >0. Sau t vÃ²ng tá»± chÆ°ng cáº¥t, chÃºng tÃ´i xem xÃ©t Ä‘á»™ng há»c theo thá»i gian tinh chá»‰nh Ï„ thÃ´ng qua gradient flow (Saxe et al., 2014; Kawaguchi, 2021):dwt,Ï„ dÏ„=âˆ’âˆ‡L (wt,Ï„),vá»›i khá»Ÿi táº¡o wt,0 thu Ä‘Æ°á»£c bá»Ÿi tá»± chÆ°ng cáº¥t nÆ¡i L(w) =1 2Pn i=1â„“(w, xi, yi) vá»›i â„“(w, x, y ) =âˆ¥f(x, w)âˆ’ yâˆ¥2 2 vÃ  yâˆˆRp. á» Ä‘Ã¢y, tá»± chÆ°ng cáº¥t vÃ  tinh chá»‰nh chia sáº» cÃ¹ng má»™t táº­p dá»¯ liá»‡u huáº¥n luyá»‡n s= {(xi, yi)}n i=1. Trong pháº§n nÃ y, Ä‘á»ƒ thu Ä‘Æ°á»£c nhá»¯ng hiá»ƒu biáº¿t lÃ½ thuyáº¿t, chÃºng tÃ´i xem xÃ©t cháº¿ Ä‘á»™ cá»§a d > n vÃ  má»™t mÃ´ hÃ¬nh trá»«u tÆ°á»£ng Ä‘Æ¡n giáº£n, f(x, w) =WÏ†(x)âˆˆRp, vá»›i má»™t sá»‘ Ã¡nh xáº¡ phi tuyáº¿n Ï† vÃ  ma tráº­n trá»ng sá»‘ WâˆˆRpÃ—d nÆ¡i w= vec[ WâŠ¤]âˆˆRdp vÃ  Ï†(x)âˆˆRd. á» Ä‘Ã¢y, vec[WâŠ¤] lÃ  vectorization cá»§a ma tráº­n WâŠ¤. HÃ£y cá»‘ Ä‘á»‹nh Ä‘á»™ dÃ i thá»i gian tinh chá»‰nh T nhÆ° 1< Ï„â‰¤T <âˆ. VÃ¬ d > n , cÃ³ vÃ´ sá»‘ nghiá»‡m cho bÃ i toÃ¡n tá»‘i thiá»ƒu hÃ³a L(w). Do Ä‘Ã³, má»—i Ä‘á»™ dÃ i há»¯u háº¡n T vÃ  viá»‡c over-parameterization d > n ngá»¥ Ã½ ráº±ng khá»Ÿi táº¡o wt,0 táº¡i giai Ä‘oáº¡n tinh chá»‰nh thÃ´ng qua tá»± chÆ°ng cáº¥t Ä‘Ã³ng má»™t vai trÃ² quan trá»ng.

Cho Î´ >0 vÃ  tâˆˆN0. ChÃºng ta sau Ä‘Ã³ Ä‘á»‹nh nghÄ©a Ft={At(s) :sâˆˆ S} ,nÆ¡i S lÃ  má»™t táº­p há»£p cá»§a táº¥t cáº£ cÃ¡c táº­p dá»¯ liá»‡u huáº¥n luyá»‡n cÃ³ kÃ­ch thÆ°á»›c n sao cho vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´, táº­p dá»¯ liá»‡u huáº¥n luyá»‡n s náº±m trong S. Äá»‘i vá»›i má»—i táº­p dá»¯ liá»‡u huáº¥n luyá»‡n sâˆˆ S,At(s) =wt,T lÃ  vector trá»ng sá»‘ cuá»‘i cÃ¹ng cá»§a mÃ´ hÃ¬nh sau t vÃ²ng tá»± chÆ°ng cáº¥t vÃ  T thá»i gian tinh chá»‰nh. HÃ£y Ä‘á»‹nh nghÄ©a ma tráº­n Î¦âˆˆRdÃ—n bá»Ÿi Î¦ij=Ï†(xj)i. ChÃºng ta giáº£ Ä‘á»‹nh ráº±ng Î¦ cÃ³ háº¡ng Ä‘áº§y Ä‘á»§; tá»©c lÃ , rank(Î¦) = n vÃ¬ dâ‰¥n. Äiá»u nÃ y thÆ°á»ng Ä‘Æ°á»£c thá»a mÃ£n bá»Ÿi vÃ¬ náº¿u rank(Î¦) < n, cÃ³ má»™t sá»‘ dÆ° thá»«a trong cÃ¡c hÃ ng cá»§a ma tráº­n Î¦. KÃ½ hiá»‡u bá»Ÿi [IpâŠ—Î¦]âˆˆRdpÃ—np tÃ­ch Kronecker cá»§a ma tráº­n Ä‘Æ¡n vá»‹ IpâˆˆRpÃ—p vÃ  ma tráº­n Î¦. ChÃºng ta viáº¿t phÃ¢n tÃ¡ch giÃ¡ trá»‹ Ä‘Æ¡n cá»§a nÃ³ bá»Ÿi [IpâŠ—Î¦] = UÎ£VâŠ¤ nÆ¡i U= [u1, u2. . . , u dp]âˆˆRdpÃ—dp chá»©a cÃ¡c vector Ä‘Æ¡n vá»‹ trÃ¡i uiâˆˆRdp cho iâˆˆ {1, . . . , dp } vÃ  Î£âˆˆRdpÃ—np lÃ  má»™t ma tráº­n Ä‘Æ°á»ng chÃ©o hÃ¬nh chá»¯ nháº­t vá»›i Î£ii=ÏƒiâˆˆRâ‰¥0 cho iâˆˆ {1, . . . , np } vÃ  Ïƒ1â‰¥Ïƒ2â‰¥ Â·Â·Â· â‰¥ Ïƒnpâ‰¥0. Äá»‹nh nghÄ©a M lÃ  má»™t cáº­n trÃªn trÃªn hÃ m máº¥t mÃ¡t nhÆ° â„“(w, x, y )â‰¤M. Äá»‹nh nghÄ©a R lÃ  má»™t cáº­n trÃªn trÃªn ká»³ vá»ng cá»§a chuáº©n cá»§a cÃ¡c Ä‘áº·c trÆ°ng nhÆ° Exâˆ¥Ï†(x)âˆ¥2â‰¤R. ChÃºng ta giáº£ Ä‘á»‹nh ráº±ng w0,0Ì¸= 0; náº¿u w0,0= 0, thÃ¬ hÃ m má»¥c tiÃªu trong giai Ä‘oáº¡n tá»± chÆ°ng cáº¥t luÃ´n báº±ng khÃ´ng nhÆ° f(xi, w0,0) = 0 cho táº¥t cáº£ i, Ä‘iá»u nÃ y khÃ´ng cÃ³ kháº£ nÄƒng xáº£y ra trong thá»±c táº¿. ChÃºng ta Ä‘á»‹nh nghÄ©a winitâˆˆRdp lÃ  trá»ng sá»‘ trÆ°á»›c tiá»n huáº¥n luyá»‡n thÃªm vÃ  Ä‘á»‹nh nghÄ©a Y= vec[[ y1, . . . , y n]âŠ¤]âˆˆRnp.

Äá»‹nh lÃ½ sau cho tháº¥y ráº±ng giá»›i háº¡n tá»•ng quÃ¡t hÃ³a trÃªn hÃ m máº¥t mÃ¡t cÃ³ giÃ¡m sÃ¡t â„“(wt,T, x, y) cá»§a giai Ä‘oáº¡n tinh chá»‰nh giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t khi chÃºng ta tÄƒng sá»‘ lÆ°á»£ng t cá»§a cÃ¡c vÃ²ng tá»± chÆ°ng cáº¥t trong giai Ä‘oáº¡n tiá»n huáº¥n luyá»‡n thÃªm:

Äá»‹nh lÃ½ 1. Tá»“n táº¡i má»™t háº±ng sá»‘ c(chá»‰ phá»¥ thuá»™c vÃ o M) sao cho vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´, Ä‘iá»u sau Ä‘Ã¢y xáº£y ra:

Ex,y[â„“(wt,T, x, y)]â‰¤1 n nX i=1â„“(wt,T, xi, yi) +Î¶(t)r 4c2R2p n+Mr ln(2/Î´) 2n, (4)

nÆ¡i hÃ m Î¶(t) giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0.

CÃ¡c chá»©ng minh cá»§a táº¥t cáº£ káº¿t quáº£ trong pháº§n nÃ y Ä‘Æ°á»£c trÃ¬nh bÃ y trong Phá»¥ lá»¥c A. HÆ¡n ná»¯a, Ä‘á»‹nh lÃ½ sau cho tháº¥y ráº±ng cáº­n trÃªn cháº·t cháº½ trÃªn khoáº£ng cÃ¡ch giá»¯a trá»ng sá»‘ ban Ä‘áº§u winit vÃ  trá»ng sá»‘ cuá»‘i cÃ¹ng wt,T sau T bÆ°á»›c tinh chá»‰nh (tá»©c lÃ , âˆ¥winitâˆ’wt,Tâˆ¥2) giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t khi sá»‘ lÆ°á»£ng t cá»§a cÃ¡c vÃ²ng tá»± chÆ°ng cáº¥t tÄƒng lÃªn:

Äá»‹nh lÃ½ 2. CÃ³ má»™t hÃ m Ïˆ:N0â†’Râ‰¥0 sao cho (1) âˆ¥winitâˆ’wt,Tâˆ¥2=Ïˆ(t) cho má»™t sá»‘ winitâˆˆRdp, (2)âˆ¥winitâˆ’wt,Tâˆ¥2â‰¤Ïˆ(t) cho táº¥t cáº£ winitâˆˆRdp, (3) hÃ m Ïˆ(t) giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0, (4) hÃ m Ïˆ(t) cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n tÃ¡ch thÃ nh Ïˆ(t) =p G1+Ïˆ1(t) + 1{t= 0}B+G2 vá»›i cÃ¡c háº±ng sá»‘ G1, G2â‰¥0 trong khi Ïˆ1(t) giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 vÃ  B=Pdp i=np+1(uâŠ¤ iw0,0)2â‰¥0.

Äá»‹nh lÃ½ 2 cho tháº¥y ráº±ng tá»± chÆ°ng cáº¥t hoáº¡t Ä‘á»™ng nhÆ° má»™t Ä‘iá»u hÃ²a trÃªn khoáº£ng cÃ¡ch giá»¯a trá»ng sá»‘ ban Ä‘áº§u winit vÃ  trá»ng sá»‘ cuá»‘i cÃ¹ng wt,T. VÃ¬ Ä‘á»™ phá»©c táº¡p Rademacher cá»§a má»™t táº­p há»£p cÃ¡c vector khÃ´ng thay Ä‘á»•i Ä‘á»‘i vá»›i má»™t dá»‹ch chuyá»ƒn bá»Ÿi má»™t vector háº±ng sá»‘, khoáº£ng cÃ¡ch nÃ y Ä‘Ã£ Ä‘Æ°á»£c cho tháº¥y kiá»ƒm soÃ¡t giá»›i háº¡n tá»•ng quÃ¡t hÃ³a trong cÃ¡c bÃ i bÃ¡o trÆ°á»›c Ä‘Ã¢y trong cÃ¡c mÃ´ hÃ¬nh vÃ  cÃ i Ä‘áº·t khÃ¡c nhau, bao gá»“m cáº£ máº¡ng neural sÃ¢u (Bartlett & Mendelson, 2002; Bartlett et al., 2017; Nagarajan & Kolter, 2019). Äiá»u nÃ y gá»£i Ã½ ráº±ng tá»± chÆ°ng cáº¥t giÃºp tá»•ng quÃ¡t hÃ³a thÃ´ng qua má»™t hiá»‡u á»©ng Ä‘iá»u hÃ²a trÃªn khoáº£ng cÃ¡ch. HÆ¡n ná»¯a, vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t Ä‘Æ°á»£c dá»± kiáº¿n cÃ³ tÃ¡c Ä‘á»™ng lá»›n nháº¥t dá»±a trÃªn Äá»‹nh lÃ½ 2 vÃ¬ Äá»‹nh lÃ½ 2 cho tháº¥y ráº±ng chÃºng ta cÃ³ thá»ƒ loáº¡i bá» hoÃ n toÃ n thÃ nh pháº§n khÃ´ng cáº§n thiáº¿t B cá»§a w0,0 trong vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t. ChÃºng tÃ´i Ä‘Ã£ xÃ¡c minh nhá»¯ng dá»± Ä‘oÃ¡n lÃ½ thuyáº¿t nÃ y trong cÃ¡c thÃ­ nghiá»‡m nÆ¡i chÃºng tÃ´i cho tháº¥y má»‘i tÆ°Æ¡ng quan giá»¯a cáº£i thiá»‡n thÃ´ng qua tá»± chÆ°ng cáº¥t vÃ  khoáº£ng cÃ¡ch xuáº¥t hiá»‡n trong giá»›i háº¡n tá»•ng quÃ¡t hÃ³a trong bÃ i bÃ¡o trÆ°á»›c Ä‘Ã¢y (Nagarajan & Kolter, 2019).

5 THÃ NGHIá»†M

Táº­p Dá»¯ Liá»‡u Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i hÃ¬nh áº£nh, chÃºng tÃ´i sá»­ dá»¥ng sÃ¡u táº­p dá»¯ liá»‡u â€” FGVC Aircraft (Aircraft) (Maji et al., 2013), Caltech UCSD Birds 200 (CUB) (Wah et al., 2011), Chest X-ray (Kermany et al., 2018), Describable Textures Dataset (DTD) (Cimpoi et al., 2014), Stanford Dogs (Khosla et al., 2011), vÃ  Oxford 102 Flower (Nilsback & Zisserman, 2008). Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i vÄƒn báº£n, chÃºng tÃ´i sá»­ dá»¥ng bá»‘n táº­p dá»¯ liá»‡u â€” Chemprot (Kringelum et al., 2016), ACL-ARC (Jurgens et al., 2018), SCIERC (Luan et al., 2018), vÃ  Twitter-Emotion (Mohammad et al., 2018). Vui lÃ²ng xem Phá»¥ lá»¥c D Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.

Chi Tiáº¿t Thá»±c Hiá»‡n Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i hÃ¬nh áº£nh, chÃºng tÃ´i sá»­ dá»¥ng Vision Transformer Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n trÃªn táº­p dá»¯ liá»‡u ImageNet khÃ´ng nhÃ£n vá»›i mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ (He et al., 2022) vÃ  tinh chá»‰nh nÃ³ trÃªn tÃ¡c vá»¥ downstream vá»›i bá»™ tá»‘i Æ°u AdamW (Loshchilov & Hutter, 2019) trong 10,000 bÆ°á»›c vá»›i kÃ­ch thÆ°á»›c batch 32. Vá» tiá»n huáº¥n luyá»‡n thÃªm vÃ  tá»± chÆ°ng cáº¥t, chÃºng tÃ´i tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n mÃ´ hÃ¬nh trong 20,000 bÆ°á»›c vá»›i kÃ­ch thÆ°á»›c batch 64. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ Vision Transformers vá»›i Ä‘á»™ chÃ­nh xÃ¡c. Äá»‘i vá»›i phÃ¢n loáº¡i vÄƒn báº£n, theo cÃ i Ä‘áº·t thÃ­ nghiá»‡m tá»« Gururangan et al. (2020), chÃºng tÃ´i sá»­ dá»¥ng RoBERTA (Liu et al., 2019) nhÆ° má»™t máº¡ng backbone vÃ  tinh chá»‰nh nÃ³ trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu

6

--- TRANG 6 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Báº£ng 1: Trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n cá»§a Ä‘á»™ chÃ­nh xÃ¡c vá»›i 5 láº§n cháº¡y cho cÃ¡c táº­p dá»¯ liá»‡u phÃ¢n loáº¡i hÃ¬nh áº£nh.
PhÆ°Æ¡ng phÃ¡p Aircraft CUB Chest X-ray DTD Dogs Flower
Tinh chá»‰nh 72.33Â±1.13 55 .55Â±0.54 77 .15Â±0.52 67 .56Â±0.52 62 .53Â±0.57 88 .78Â±0.65
RecAdam 70.76Â±1.25 55 .22Â±1.29 77 .29Â±1.32 67 .59Â±1.03 61 .65Â±0.92 88 .97Â±0.44
MARS 72.74Â±0.57 55 .35Â±0.73 77 .28Â±1.80 66 .79Â±0.90 62 .24Â±0.96 87 .93Â±1.21
R3F 72.95Â±0.46 55 .91Â±0.79 76 .86Â±0.97 65 .32Â±1.25 62 .15Â±0.48 88 .92Â±0.78
Tiá»n Huáº¥n Luyá»‡n ThÃªm 73.38Â±0.64 55 .72Â±0.46 77 .79Â±2.06 65 .55Â±1.12 62 .34Â±0.39 88 .63Â±0.35
Tá»± ChÆ°ng Cáº¥t 74.37 Â±0.43 58.06 Â±0.90 79.68 Â±1.05 68.51 Â±0.51 63.55 Â±0.39 90.28 Â±0.44

Báº£ng 2: Trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n cá»§a Ä‘iá»ƒm F1 vá»›i 5 láº§n cháº¡y cho cÃ¡c táº­p dá»¯ liá»‡u phÃ¢n loáº¡i vÄƒn báº£n.
PhÆ°Æ¡ng phÃ¡p SCIERC ACL-ARC Chemprot Twitter-Emotion
Tinh chá»‰nh 76.63Â±2.06 64 .09Â±4.13 80 .59Â±1.15 77 .61Â±0.83
RecAdam 79.45Â±1.92 59 .70Â±2.68 82.73Â±0.28 78.26Â±0.88
MARS 74.69Â±1.25 53 .57Â±6.64 80 .18Â±0.92 77 .48Â±1.69
R3F 75.61Â±2.49 60 .13Â±2.55 79 .25Â±2.16 77 .79Â±0.81
Tiá»n Huáº¥n Luyá»‡n ThÃªm 80.32Â±1.25 69 .73Â±2.40 82 .33Â±0.46 78 .71Â±0.40
Tá»± ChÆ°ng Cáº¥t 81.79 Â±0.75 73.17 Â±2.19 82.87 Â±0.35 79.77 Â±0.79

vá»›i bá»™ tá»‘i Æ°u AdamW trong 10 epoch vá»›i kÃ­ch thÆ°á»›c batch 32. Vá» tiá»n huáº¥n luyá»‡n thÃªm vÃ  tá»± chÆ°ng cáº¥t, chÃºng tÃ´i tiá»n huáº¥n luyá»‡n thÃªm RoBERTA trong 100 epoch vá»›i kÃ­ch thÆ°á»›c batch 128. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh vá»›i macro F1 cho táº­p dá»¯ liá»‡u SCIERC, ACL-ARC, vÃ  Twitter-Emotion, vÃ  micro F1 cho táº­p dá»¯ liá»‡u Chemprot.

Baseline ChÃºng tÃ´i so sÃ¡nh phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vá»›i cÃ¡c baseline sau Ä‘Ã¢y nháº¯m má»¥c tiÃªu cho viá»‡c tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n. Táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i cÃ¡c trá»ng sá»‘ tiá»n huáº¥n luyá»‡n Î¸init vÃ  Ï•init.

1.Tinh chá»‰nh : MÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu Dtr mÃ  khÃ´ng cÃ³ tiá»n huáº¥n luyá»‡n thÃªm hoáº·c Ä‘iá»u hÃ²a nÃ o ngoáº¡i trá»« dropout vÃ  weight decay.
2.RecAdam (Chen et al., 2020a) : MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i bá»™ tá»‘i Æ°u RecAdam lÃ  má»™t biáº¿n thá»ƒ cá»§a bá»™ tá»‘i Æ°u Adam (Kingma & Ba, 2015) vÃ  thÃªm vÃ o Ä‘Ã³ pháº¡t khoáº£ng cÃ¡ch L2 giá»¯a trá»ng sá»‘ tinh chá»‰nh vÃ  trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u.
3.MARS (Gouk et al., 2021) : MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ tá»‘i thiá»ƒu hÃ³a hÃ m máº¥t mÃ¡t cross-entropy cÃ¹ng vá»›i Ä‘iá»u hÃ²a chiáº¿u trá»ng sá»‘ tinh chá»‰nh Ä‘á»ƒ náº±m trong má»™t hÃ¬nh cáº§u cÃ³ tÃ¢m táº¡i trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u. Äá»‘i vá»›i má»—i lá»›p, khoáº£ng cÃ¡ch Ä‘Æ°á»£c táº¡o ra bá»Ÿi chuáº©n ma tráº­n Maximum Absolute Row Sum (MARS) (max j P i=1|Wj,iâˆ’Uj,i|) Ä‘Æ°á»£c sá»­ dá»¥ng cho Ä‘iá»u hÃ²a.
4.R3F (Aghajanyan et al., 2021) : MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ tá»‘i thiá»ƒu hÃ³a hÃ m máº¥t mÃ¡t cross-entropy cÅ©ng nhÆ° phÃ¢n ká»³ KL Ä‘á»‘i xá»©ng giá»¯a Ä‘áº§u ra softmax cá»§a Ä‘áº§u vÃ o gá»‘c vÃ  Ä‘áº§u ra cá»§a Ä‘áº§u vÃ o bá»‹ nhiá»…u bá»Ÿi tiáº¿ng á»“n Gaussian.
5.Tiá»n Huáº¥n Luyá»‡n ThÃªm (Gururangan et al., 2020) : Tiá»n huáº¥n luyá»‡n thÃ­ch á»©ng tÃ¡c vá»¥ nÆ¡i chÃºng ta tiá»n huáº¥n luyá»‡n thÃªm mÃ´ hÃ¬nh trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu Du vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ vÃ  tinh chá»‰nh nÃ³ trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu Dtr.
6.Tá»± ChÆ°ng Cáº¥t : ÄÃ¢y lÃ  mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n thÃªm trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu Du vá»›i phÆ°Æ¡ng trÃ¬nh 3 vÃ  tinh chá»‰nh trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu Dtr.

5.1 Káº¾T QUáº¢ CHÃNH

NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 1, tá»± chÆ°ng cáº¥t liÃªn tá»¥c vÆ°á»£t trá»™i hÆ¡n táº¥t cáº£ cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘iá»u hÃ²a vÃ  phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm trÃªn cÃ¡c táº­p dá»¯ liá»‡u hÃ¬nh áº£nh. ÄÃ¡ng chÃº Ã½, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t cá»§a táº­p dá»¯ liá»‡u Chest X-ray bao gá»“m cÃ¡c hÃ¬nh áº£nh thang xÃ¡m cho cháº©n Ä‘oÃ¡n viÃªm phá»•i. NgoÃ i ra, tá»± chÆ°ng cáº¥t hiá»‡u quáº£ giáº£i quyáº¿t táº­p dá»¯ liá»‡u Flower chá»‰ chá»©a 2,040 vÃ­ dá»¥ cÃ³ nhÃ£n. NgÆ°á»£c láº¡i, cÃ¡c baseline khÃ¡c khÃ´ng cho tháº¥y cáº£i thiá»‡n nháº¥t quÃ¡n trÃªn táº¥t cáº£ cÃ¡c táº­p dá»¯ liá»‡u hÃ¬nh áº£nh. VÃ­ dá»¥, tiá»n huáº¥n luyá»‡n thÃªm hiá»‡u quáº£ cho táº­p dá»¯ liá»‡u Aircraft, nhÆ°ng lÃ m giáº£m Ä‘Ã¡ng ká»ƒ Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra trÃªn táº­p dá»¯ liá»‡u DTD. CÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘iá»u hÃ²a nhÆ° RecAdam, MARS, vÃ  R3F háº§u nhÆ° khÃ´ng cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a trÃªn háº§u háº¿t cÃ¡c táº­p dá»¯ liá»‡u hoáº·c kÃ©m hiá»‡u suáº¥t hÆ¡n chiáº¿n lÆ°á»£c tinh chá»‰nh Ä‘Æ¡n giáº£n trÃªn má»™t sá»‘ táº­p dá»¯ liá»‡u nháº¥t Ä‘á»‹nh. Báº±ng chá»©ng thá»±c nghiá»‡m nÃ y há»— trá»£ ráº±ng cÃ¡c Ä‘iá»u hÃ²a buá»™c cÃ¡c mÃ´ hÃ¬nh tinh chá»‰nh gáº§n vá»›i trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u khÃ´ng hiá»‡u quáº£ cho viá»‡c thÃ­ch á»©ng má»™t mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i cÃ¡c táº­p dá»¯ liá»‡u má»¥c tiÃªu cá»§a cÃ¡c miá»n cá»¥ thá»ƒ.

HÆ¡n ná»¯a, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 2, chÃºng tÃ´i cung cáº¥p káº¿t quáº£ thÃ­ nghiá»‡m bá»• sung cho cÃ¡c tÃ¡c vá»¥ phÃ¢n loáº¡i vÄƒn báº£n. Má»™t láº§n ná»¯a, tá»± chÆ°ng cáº¥t vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i táº¥t cáº£ cÃ¡c baseline trÃªn cáº£ bá»‘n táº­p dá»¯ liá»‡u,

7

--- TRANG 7 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

1K 2.5K 5K 10K 20K 30K 40K 50K
# of instances020406080Äá»™ ChÃ­nh XÃ¡c Kiá»ƒm TraTinh chá»‰nh
Tiá»n Huáº¥n Luyá»‡n ThÃªm
Tá»± ChÆ°ng Cáº¥t

HÃ¬nh 3: Äá»™ chÃ­nh xÃ¡c vá»›i viá»‡c thay Ä‘á»•i
sá»‘ lÆ°á»£ng dá»¯ liá»‡u huáº¥n luyá»‡n.Báº£ng 3: Ablation trÃªn CUB vÃ  SCIERC.
MÃ´ hÃ¬nh CUB SCIERC
MÃ´ hÃ¬nh Äáº§y Ä‘á»§ 58.06Â±0.90 81.79 Â±0.75
w/oLMAE 57.60Â±0.81 80 .66Â±0.62
w/oLDistill 55.72Â±0.46 80 .32Â±1.25
Tiá»n Huáº¥n Luyá»‡n ThÃªm Ã—2 53 .41Â±0.75 80 .52Â±0.98
Khá»›p-Dá»± Ä‘oÃ¡n 55.27Â±1.07 81 .09Â±1.07
Khá»›p-Trá»ng sá»‘ ( â„“2) 53.70Â±0.91 80 .54Â±1.21
Khá»›p-Trá»ng sá»‘ (MARS) 54.82Â±0.60 80 .95Â±0.71

0 2 4
VÃ²ng Tá»± ChÆ°ng Cáº¥t ( t)88.589.089.590.090.591.0Äá»™ ChÃ­nh XÃ¡c Kiá»ƒm Tra

HÃ¬nh 4: Äá»™ chÃ­nh xÃ¡c kiá»ƒm tra vá»›i
viá»‡c thay Ä‘á»•i vÃ²ng tá»± chÆ°ng cáº¥t.

ngoáº¡i trá»« RecAdam trong táº­p dá»¯ liá»‡u Chemprot. TrÃ¡i ngÆ°á»£c vá»›i thÃ­ nghiá»‡m trÆ°á»›c Ä‘Ã¢y, phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm cáº£i thiá»‡n Ä‘iá»ƒm F1 kiá»ƒm tra cá»§a phÆ°Æ¡ng phÃ¡p tinh chá»‰nh Ä‘Æ¡n giáº£n, tuy nhiÃªn nÃ³ váº«n kÃ©m hiá»‡u suáº¥t hÆ¡n mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i. Äá»‘i vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘iá»u hÃ²a â€” RecAdam, MARS, vÃ  R3F, chÃºng khÃ´ng Ä‘áº¡t Ä‘Æ°á»£c cáº£i thiá»‡n nháº¥t quÃ¡n trÃªn cáº£ ba táº­p dá»¯ liá»‡u. RecAdam cáº£i thiá»‡n vá»«a pháº£i Ä‘iá»ƒm F1 trÃªn táº­p dá»¯ liá»‡u SCIERC vÃ  Chemprot nhÆ°ng lÃ m giáº£m Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a trÃªn táº­p dá»¯ liá»‡u ACL-ARC. Cáº£ MARS vÃ  R3F Ä‘á»u cho tháº¥y hiá»‡u suáº¥t kÃ©m trÃªn táº­p dá»¯ liá»‡u SCIERC vÃ  ACL-ARC, vÃ  hiá»‡u suáº¥t cá»§a chÃºng hÆ¡i tá»‡ hÆ¡n so vá»›i phÆ°Æ¡ng phÃ¡p Tinh chá»‰nh trÃªn táº­p dá»¯ liá»‡u Chemprot.

Káº¿t Quáº£ cho Dá»¯ Liá»‡u TÃ i NguyÃªn Tháº¥p ChÃºng tÃ´i tiáº¿n hÃ nh thÃªm cÃ¡c thÃ­ nghiá»‡m Ä‘á»ƒ cho tháº¥y cÃ¡ch tá»± chÆ°ng cáº¥t hiá»‡u quáº£ xá»­ lÃ½ tÃ i nguyÃªn tháº¥p cá»§a dá»¯ liá»‡u cÃ³ nhÃ£n. Cho má»™t táº­p dá»¯ liá»‡u CIFAR-100 Ä‘áº§y Ä‘á»§ (Krizhevsky et al., 2009) chá»©a 50,000 cáº·p huáº¥n luyá»‡n cá»§a má»™t hÃ¬nh áº£nh vÃ  nhÃ£n tÆ°Æ¡ng á»©ng, chÃºng tÃ´i váº½ Ä‘á»“ thá»‹ Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra cá»§a má»—i mÃ´ hÃ¬nh báº±ng cÃ¡ch thay Ä‘á»•i sá»‘ lÆ°á»£ng thá»ƒ hiá»‡n huáº¥n luyá»‡n. LÆ°u Ã½ ráº±ng chÃºng tÃ´i cÅ©ng giáº£m sá»‘ lÆ°á»£ng hÃ¬nh áº£nh khÃ´ng nhÃ£n Ä‘Æ°á»£c sá»­ dá»¥ng cho tiá»n huáº¥n luyá»‡n thÃªm hoáº·c tá»± chÆ°ng cáº¥t. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3, tá»± chÆ°ng cáº¥t liÃªn tá»¥c cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a cáº£ phÆ°Æ¡ng phÃ¡p tinh chá»‰nh vÃ  mÃ´ hÃ¬nh Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n thÃªm trÃªn cÃ¡c hÃ¬nh áº£nh tá»« táº­p dá»¯ liá»‡u CIFAR-100. ÄÃ¡ng chÃº Ã½, lá»£i Ã­ch tá»« tá»± chÆ°ng cáº¥t trá»Ÿ nÃªn lá»›n hÆ¡n khi cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i má»™t sá»‘ lÆ°á»£ng cá»±c ká»³ nhá» cÃ¡c thá»ƒ hiá»‡n. VÃ­ dá»¥, tá»± chÆ°ng cáº¥t Ä‘áº¡t Ä‘Æ°á»£c 13% vÃ  6% cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra so vá»›i mÃ´ hÃ¬nh vá»›i tinh chá»‰nh Ä‘Æ¡n giáº£n khi cÃ³ 1,000 vÃ  2,500 vÃ­ dá»¥ cÃ³ nhÃ£n, tÆ°Æ¡ng á»©ng. Nhá»¯ng káº¿t quáº£ thá»±c nghiá»‡m nÃ y xÃ¡c minh ráº±ng tá»± chÆ°ng cáº¥t cÃ³ thá»ƒ thÃ­ch á»©ng hiá»‡u quáº£ mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n vá»›i táº­p dá»¯ liá»‡u má»¥c tiÃªu ngay cáº£ khi cÃ³ lÆ°á»£ng cá»±c ká»³ nhá» dá»¯ liá»‡u cÃ³ nhÃ£n.

NghiÃªn Cá»©u Ablation ChÃºng tÃ´i thá»±c hiá»‡n nghiÃªn cá»©u ablation Ä‘á»ƒ xÃ¡c minh hiá»‡u quáº£ cá»§a tá»«ng thÃ nh pháº§n cá»§a tá»± chÆ°ng cáº¥t. Trong Báº£ng 3, chÃºng tÃ´i cho tháº¥y káº¿t quáº£ thá»±c nghiá»‡m trÃªn cáº£ táº­p dá»¯ liá»‡u CUB vÃ  táº­p dá»¯ liá»‡u SCIERC trong khi loáº¡i bá» hoáº·c thay tháº¿ cÃ¡c thÃ nh pháº§n khÃ¡c nhau cá»§a tá»± chÆ°ng cáº¥t. Äáº§u tiÃªn, chÃºng tÃ´i loáº¡i bá» má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ LMAE vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh chá»‰ vá»›i hÃ m máº¥t mÃ¡t chÆ°ng cáº¥t LDistill trÆ°á»›c khi tinh chá»‰nh. TrÃªn táº­p dá»¯ liá»‡u hÃ¬nh áº£nh CUB, nÃ³ khÃ´ng táº¡o ra sá»± khÃ¡c biá»‡t Ä‘Ã¡ng ká»ƒ, tuy nhiÃªn, loáº¡i bá» má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ lÃ m giáº£m hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a mÃ´ hÃ¬nh ngÃ´n ngá»¯ trÃªn táº­p dá»¯ liá»‡u phÃ¢n loáº¡i vÄƒn báº£n SCIERC. NgoÃ i ra, chÃºng tÃ´i loáº¡i bá» hÃ m máº¥t mÃ¡t chÆ°ng cáº¥t LDistill trong phÆ°Æ¡ng trÃ¬nh 3, Ä‘iá»u nÃ y dáº«n Ä‘áº¿n phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm. HÆ¡n ná»¯a, chÃºng tÃ´i tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n mÃ´ hÃ¬nh gáº¥p Ä‘Ã´i sá»‘ bÆ°á»›c dÃ i hÆ¡n so vá»›i phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm gá»‘c, kÃ½ hiá»‡u lÃ  Tiá»n Huáº¥n Luyá»‡n ThÃªm Ã—2, Ä‘á»ƒ cho tháº¥y ráº±ng Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra cao hÆ¡n cá»§a tá»± chÆ°ng cáº¥t khÃ´ng pháº£i lÃ  há»‡ quáº£ cá»§a tiá»n huáº¥n luyá»‡n dÃ i hÆ¡n. Cáº£ hai mÃ´ hÃ¬nh Ä‘á»u kÃ©m hiá»‡u suáº¥t Ä‘Ã¡ng ká»ƒ so vá»›i tá»± chÆ°ng cáº¥t, Ä‘iá»u nÃ y cho tháº¥y hiá»‡u quáº£ cá»§a hÃ m máº¥t mÃ¡t tá»± chÆ°ng cáº¥t. Cuá»‘i cÃ¹ng, chÃºng tÃ´i thá»±c hiá»‡n thÃ­ nghiá»‡m cho cÃ¡c biáº¿n thá»ƒ cá»§a hÃ m máº¥t mÃ¡t chÆ°ng cáº¥t LDistill trong phÆ°Æ¡ng trÃ¬nh 3. Thay vÃ¬ khá»›p biá»ƒu diá»…n cá»§a giÃ¡o viÃªn vÃ  há»c sinh, chÃºng tÃ´i buá»™c viá»‡c tÃ¡i táº¡o cÃ¡c Ä‘áº§u vÃ o cÃ³ máº·t náº¡ bá»Ÿi giÃ¡o viÃªn vÃ  há»c sinh pháº£i nháº¥t quÃ¡n, tá»©c lÃ , tá»‘i thiá»ƒu hÃ³a Î¸,Ï•âˆ¥gÏ•â—¦fÎ¸(Ë†x)âˆ’gÏ•0â—¦fÎ¸0(Ë†x)âˆ¥2 2 cho ViT hoáº·c tá»‘i thiá»ƒu hÃ³a Î¸,Ï•PT t=1DKL(pÎ¸0,Ï•0(xt|Ë†x)âˆ¥pÎ¸,Ï•(xt|Ë†x)) cho RoBERTA, kÃ½ hiá»‡u lÃ  Khá»›p-Dá»± Ä‘oÃ¡n. HÆ¡n ná»¯a, chÃºng tÃ´i thay tháº¿ hÃ m máº¥t mÃ¡t chÆ°ng cáº¥t báº±ng hÃ m tá»‘i thiá»ƒu hÃ³a khoáº£ng cÃ¡ch L2 hoáº·c MARS giá»¯a cÃ¡c tham sá»‘ cá»§a há»c sinh vÃ  giÃ¡o viÃªn, kÃ½ hiá»‡u lÃ  Khá»›p-Trá»ng sá»‘. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 3, táº¥t cáº£ cÃ¡c biáº¿n thá»ƒ nÃ y khÃ´ng hiá»‡u quáº£ so vá»›i biáº¿n thá»ƒ tá»‘i thiá»ƒu hÃ³a khoáº£ng cÃ¡ch giá»¯a cÃ¡c biá»ƒu diá»…n áº©n cá»§a há»c sinh vÃ  giÃ¡o viÃªn.

Nhiá»u VÃ²ng Tá»± ChÆ°ng Cáº¥t Cuá»‘i cÃ¹ng, chÃºng tÃ´i chá»©ng minh thá»±c nghiá»‡m ráº±ng vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t Ä‘Ã³ng vai trÃ² quan trá»ng nháº¥t trong viá»‡c cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a. Cá»¥ thá»ƒ, chÃºng tÃ´i tinh chá»‰nh má»—i mÃ´ hÃ¬nh sau t vÃ²ng tá»± chÆ°ng cáº¥t vÃ  váº½ Ä‘á»“ thá»‹ Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra trÃªn táº­p dá»¯ liá»‡u Oxford 102 Flower, nÆ¡i 0 vÃ²ng tá»± chÆ°ng cáº¥t (t= 0) biá»ƒu thá»‹ mÃ´ hÃ¬nh vá»›i tiá»n huáº¥n luyá»‡n thÃªm. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 4, vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra cá»§a mÃ´ hÃ¬nh vá»›i tiá»n huáº¥n luyá»‡n thÃªm vÃ  lá»£i Ã­ch tá»« tá»± chÆ°ng cáº¥t trá»Ÿ nÃªn biÃªn sau vÃ²ng Ä‘áº§u tiÃªn. Xem xÃ©t chi phÃ­ tÃ­nh toÃ¡n bá»• sung vÃ  cáº£i thiá»‡n biÃªn cá»§a tá»± chÆ°ng cáº¥t nhiá»u vÃ²ng, chÃºng tÃ´i thá»±c hiá»‡n má»™t vÃ²ng tá»± chÆ°ng cáº¥t duy nháº¥t cho táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m.

8

--- TRANG 8 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Aircraft CUB DTD Dogs X-ray Flower0.00.51.01.52.02.5Khoáº£ng CÃ¡ch Tá»•ng QuÃ¡t HÃ³aTiá»n Huáº¥n Luyá»‡n ThÃªm
Tá»± ChÆ°ng Cáº¥t
(a)

Aircraft CUB DTD Dogs X-ray Flower020406080100120140Khoáº£ng cÃ¡ch L2
Tiá»n Huáº¥n Luyá»‡n ThÃªm
Tá»± ChÆ°ng Cáº¥t (b)

0 1 2 3 4
VÃ²ng Tá»± ChÆ°ng Cáº¥t ( t)100110120130/bardblÎ¸initâˆ’Î¸t,T/bardbl2
 (c)

HÃ¬nh 5: (a) Khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a : Sá»± khÃ¡c biá»‡t giá»¯a hÃ m máº¥t mÃ¡t kiá»ƒm tra cÃ³ giÃ¡m sÃ¡t vÃ  hÃ m máº¥t mÃ¡t huáº¥n luyá»‡n. (b) Hiá»‡u á»©ng cá»§a tá»± chÆ°ng cáº¥t trÃªn khoáº£ng cÃ¡ch: Khoáº£ng cÃ¡ch giá»¯a cÃ¡c trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u vÃ  trá»ng sá»‘ tinh chá»‰nh cuá»‘i cÃ¹ng cá»§a tiá»n huáº¥n luyá»‡n thÃªm vÃ  tá»± chÆ°ng cáº¥t. (c) Hiá»‡u á»©ng cá»§a tá»± chÆ°ng cáº¥t nhiá»u vÃ²ng: Khoáº£ng cÃ¡ch giá»¯a cÃ¡c trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u vÃ  trá»ng sá»‘ tinh chá»‰nh cuá»‘i cÃ¹ng cho má»—i vÃ²ng tá»± chÆ°ng cáº¥t tâˆˆN+.

5.2 PHÃ‚N TÃCH THÃŠM

Trong pháº§n nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y cÃ¡c thÃ­ nghiá»‡m sá»‘ Ä‘á»ƒ phÃ¢n tÃ­ch táº¡i sao tá»± chÆ°ng cáº¥t cÃ³ thá»ƒ tiá»m nÄƒng giÃºp cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a cÃ¡c tÃ¡c vá»¥ downstream so vá»›i tiá»n huáº¥n luyá»‡n thÃªm vÃ  chá»©ng minh thá»±c nghiá»‡m ráº±ng Äá»‹nh lÃ½ 1 vÃ  2 cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ rá»™ng cho cÃ¡c máº¡ng neural sÃ¢u â€” transformers.

(a) Khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a: Trong HÃ¬nh 5a, chÃºng tÃ´i váº½ Ä‘á»“ thá»‹ khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a, lÃ  hÃ m máº¥t mÃ¡t kiá»ƒm tra trá»« hÃ m máº¥t mÃ¡t huáº¥n luyá»‡n trÃªn má»—i táº­p dá»¯ liá»‡u cÃ³ nhÃ£n, cá»§a tá»± chÆ°ng cáº¥t vÃ  phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm. Tá»± chÆ°ng cáº¥t cáº£i thiá»‡n khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a cá»§a phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm trÃªn táº¥t cáº£ cÃ¡c táº­p dá»¯ liá»‡u. NÃ³ nháº¥t quÃ¡n vá»›i Äá»‹nh lÃ½ 1 cho tháº¥y ráº±ng tá»± chÆ°ng cáº¥t vá»›i má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n hÃ³a giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t giá»›i háº¡n tá»•ng quÃ¡t hÃ³a trÃªn hÃ m máº¥t mÃ¡t cÃ³ giÃ¡m sÃ¡t cá»§a giai Ä‘oáº¡n tinh chá»‰nh.

(b) Hiá»‡u á»©ng cá»§a tá»± chÆ°ng cáº¥t trÃªn khoáº£ng cÃ¡ch: Äá»ƒ xÃ¡c thá»±c thá»±c nghiá»‡m Äá»‹nh lÃ½ 2 vá» hiá»‡u á»©ng Ä‘iá»u hÃ²a bá»Ÿi tá»± chÆ°ng cáº¥t trÃªn khoáº£ng cÃ¡ch L2 giá»¯a trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u Î¸init vÃ  trá»ng sá»‘ cuá»‘i cÃ¹ng sau tinh chá»‰nh, chÃºng tÃ´i váº½ Ä‘á»“ thá»‹ khoáº£ng cÃ¡ch thu Ä‘Æ°á»£c tá»« tá»± chÆ°ng cáº¥t vÃ  tiá»n huáº¥n luyá»‡n thÃªm. Cá»¥ thá»ƒ, chÃºng tÃ´i so sÃ¡nh khoáº£ng cÃ¡ch âˆ¥Î¸initâˆ’Î¸1,Tâˆ¥2 vÃ  âˆ¥Î¸initâˆ’Î¸0,Tâˆ¥2, nÆ¡i Î¸t,Ï„ lÃ  tham sá»‘ sau t vÃ²ng tá»± chÆ°ng cáº¥t vÃ  Ï„ bÆ°á»›c gradient descent cho tinh chá»‰nh. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5b, tá»± chÆ°ng cáº¥t liÃªn tá»¥c giáº£m khoáº£ng cÃ¡ch vÃ  khoáº£ng cÃ¡ch giáº£m tÆ°Æ¡ng quan vá»›i khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a tá»‘t hÆ¡n trong HÃ¬nh 5a. Nhá»¯ng káº¿t quáº£ thá»±c nghiá»‡m nÃ y xÃ¡c nháº­n má»‘i liÃªn káº¿t giá»¯a khoáº£ng cÃ¡ch L2 tá»« khá»Ÿi táº¡o vÃ  giá»›i háº¡n tá»•ng quÃ¡t hÃ³a (Nagarajan & Kolter, 2019).

(c) Hiá»‡u á»©ng cá»§a tá»± chÆ°ng cáº¥t nhiá»u vÃ²ng: Cuá»‘i cÃ¹ng, chÃºng tÃ´i xÃ¡c thá»±c thá»±c nghiá»‡m má»™t pháº§n cá»§a Äá»‹nh lÃ½ 2 cho tháº¥y ráº±ng vÃ²ng Ä‘áº§u tiÃªn cá»§a tá»± chÆ°ng cáº¥t Ä‘Ã³ng vai trÃ² quan trá»ng nháº¥t cá»§a Ä‘iá»u hÃ²a trÃªn khoáº£ng cÃ¡ch L2 giá»¯a trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u Î¸init vÃ  trá»ng sá»‘ cuá»‘i cÃ¹ng Î¸t,T kÃ½ hiá»‡u lÃ  tham sá»‘ sau t vÃ²ng tá»± chÆ°ng cáº¥t vÃ  T bÆ°á»›c gradient descent cho tinh chá»‰nh trÃªn táº­p dá»¯ liá»‡u VGG flower 102. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5c, tá»± chÆ°ng cáº¥t giáº£m Ä‘Ã¡ng ká»ƒ khoáº£ng cÃ¡ch á»Ÿ vÃ²ng Ä‘áº§u tiÃªn (t= 1) vÃ  hiá»‡u á»©ng Ä‘iá»u hÃ²a trÃªn khoáº£ng cÃ¡ch giáº£m dáº§n sau Ä‘Ã³, nÆ¡i 0 vÃ²ng tá»± chÆ°ng cáº¥t (t= 0) biá»ƒu thá»‹ mÃ´ hÃ¬nh vá»›i tiá»n huáº¥n luyá»‡n thÃªm nhÆ°ng khÃ´ng cÃ³ tá»± chÆ°ng cáº¥t.

6 Káº¾T LUáº¬N

Äá»ƒ thÃ­ch á»©ng hiá»‡u quáº£ cÃ¡c transformers tiá»n huáº¥n luyá»‡n vá»›i má»™t miá»n má»¥c tiÃªu, chÃºng tÃ´i Ä‘Ã£ Ä‘á» xuáº¥t tá»± chÆ°ng cáº¥t nhÆ° má»™t Ä‘iá»u hÃ²a cho tiá»n huáº¥n luyá»‡n thÃªm. Cá»¥ thá»ƒ, chÃºng tÃ´i Ä‘áº§u tiÃªn láº¥y transformer tiá»n huáº¥n luyá»‡n ban Ä‘áº§u vÃ  tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n nÃ³ vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu vÃ  coi pháº§n bá»™ mÃ£ hÃ³a cá»§a mÃ´ hÃ¬nh nhÆ° má»™t giÃ¡o viÃªn cho tá»± chÆ°ng cáº¥t. Sau Ä‘Ã³ chÃºng tÃ´i láº¥y báº£n sao cá»§a cÃ¹ng mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n ban Ä‘áº§u lÃ m há»c sinh vÃ  buá»™c cÃ¡c biá»ƒu diá»…n cá»§a há»c sinh pháº£i gáº§n vá»›i nhá»¯ng biá»ƒu diá»…n cá»§a giÃ¡o viÃªn trong khi tá»‘i Æ°u hÃ³a há»c sinh vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ trÃªn táº­p dá»¯ liá»‡u khÃ´ng nhÃ£n má»¥c tiÃªu. Cuá»‘i cÃ¹ng, chÃºng tÃ´i tinh chá»‰nh há»c sinh tá»± chÆ°ng cáº¥t trÃªn táº­p dá»¯ liá»‡u cÃ³ nhÃ£n má»¥c tiÃªu. ÄÃ¡nh giÃ¡ thá»±c nghiá»‡m cá»§a chÃºng tÃ´i trÃªn cÃ¡c táº­p dá»¯ liá»‡u benchmark phÃ¢n loáº¡i hÃ¬nh áº£nh vÃ  vÄƒn báº£n khÃ¡c nhau cho tháº¥y ráº±ng tá»± chÆ°ng cáº¥t liÃªn tá»¥c cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a so vá»›i cÃ¡c baseline liÃªn quan. Cuá»‘i cÃ¹ng, chÃºng tÃ´i cung cáº¥p phÃ¢n tÃ­ch lÃ½ thuyáº¿t cá»§a phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t vá»›i má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n hÃ³a Ä‘á»ƒ hiá»ƒu cÃ¡ch tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm cÃ³ thá»ƒ tiá»m nÄƒng giÃºp cáº£i thiá»‡n hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a cÃ¡c tÃ¡c vá»¥ downstream.

9

--- TRANG 9 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

TUYÃŠN Bá» Vá»€ KHáº¢ NÄ‚NG TÃI Táº O

ChÃºng tÃ´i sá»­ dá»¥ng Pytorch (Paszke et al., 2019) vÃ  thÆ° viá»‡n transformers (Wolf et al., 2020) tá»« Huggingface Ä‘á»ƒ thá»±c hiá»‡n táº¥t cáº£ cÃ¡c baseline vÃ  phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i trong cÃ¡c thÃ­ nghiá»‡m. ChÃºng tÃ´i Ä‘Ã£ mÃ´ táº£ phÆ°Æ¡ng phÃ¡p tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm trong Thuáº­t toÃ¡n 1 vÃ  chá»‰ Ä‘á»‹nh táº¥t cáº£ cÃ i Ä‘áº·t thÃ­ nghiá»‡m bao gá»“m cÃ¡c siÃªu tham sá»‘ trong Pháº§n 5 vÃ  Phá»¥ lá»¥c E. Äá»‘i vá»›i phÃ¢n tÃ­ch lÃ½ thuyáº¿t, chÃºng tÃ´i Ä‘Ã£ cung cáº¥p táº¥t cáº£ cÃ¡c chá»©ng minh trong Phá»¥ lá»¥c A.

Lá»œI Cáº¢M Æ N

CÃ´ng trÃ¬nh nÃ y Ä‘Æ°á»£c há»— trá»£ bá»Ÿi tÃ i trá»£ cá»§a Viá»‡n Quy hoáº¡ch vÃ  ÄÃ¡nh giÃ¡ CÃ´ng nghá»‡ ThÃ´ng tin & Truyá»n thÃ´ng (IITP) Ä‘Æ°á»£c tÃ i trá»£ bá»Ÿi chÃ­nh phá»§ HÃ n Quá»‘c (MSIT) (Sá»‘ 2019-0-00075, ChÆ°Æ¡ng trÃ¬nh TrÆ°á»ng Äáº¡i há»c TrÃ­ tuá»‡ NhÃ¢n táº¡o (KAIST)), ChÆ°Æ¡ng trÃ¬nh Trung tÃ¢m NghiÃªn cá»©u Ká»¹ thuáº­t thÃ´ng qua Quá»¹ NghiÃªn cá»©u Quá»‘c gia HÃ n Quá»‘c (NRF) Ä‘Æ°á»£c tÃ i trá»£ bá»Ÿi ChÃ­nh phá»§ HÃ n Quá»‘c MSIT (NRF-2018R1A5A1059921), tÃ i trá»£ cá»§a Viá»‡n Quy hoáº¡ch vÃ  ÄÃ¡nh giÃ¡ CÃ´ng nghá»‡ ThÃ´ng tin & Truyá»n thÃ´ng (IITP) Ä‘Æ°á»£c tÃ i trá»£ bá»Ÿi chÃ­nh phá»§ HÃ n Quá»‘c (MSIT) (Sá»‘ 2021-0-02068, Trung tÃ¢m Äá»•i má»›i TrÃ­ tuá»‡ NhÃ¢n táº¡o), tÃ i trá»£ cá»§a Viá»‡n Quy hoáº¡ch vÃ  ÄÃ¡nh giÃ¡ CÃ´ng nghá»‡ ThÃ´ng tin & Truyá»n thÃ´ng (IITP) Ä‘Æ°á»£c tÃ i trá»£ bá»Ÿi chÃ­nh phá»§ HÃ n Quá»‘c (MSIT) (Sá»‘ 2022-0-00184, PhÃ¡t triá»ƒn vÃ  NghiÃªn cá»©u CÃ´ng nghá»‡ AI Ä‘á»ƒ TuÃ¢n thá»§ má»™t cÃ¡ch KhÃ´ng tá»‘n kÃ©m vá»›i ChÃ­nh sÃ¡ch Äang phÃ¡t triá»ƒn vá» Äáº¡o Ä‘á»©c), tÃ i trá»£ cá»§a Viá»‡n Quy hoáº¡ch vÃ  ÄÃ¡nh giÃ¡ CÃ´ng nghá»‡ ThÃ´ng tin & Truyá»n thÃ´ng (IITP) Ä‘Æ°á»£c tÃ i trá»£ bá»Ÿi chÃ­nh phá»§ HÃ n Quá»‘c (MSIT) (Sá»‘ 2022-0-00713), Trung tÃ¢m AI SiÃªu sÃ¡ng táº¡o KAIST-NAVER, vÃ  Samsung Electronics (IO201214-08145-01). TÃ i liá»‡u nÃ y dá»±a trÃªn cÃ´ng viá»‡c Ä‘Æ°á»£c há»— trá»£ bá»Ÿi chÆ°Æ¡ng trÃ¬nh Google Cloud Research Credits vá»›i giáº£i thÆ°á»Ÿng (6NW8-CF7K-3AG4-1WH1).

TÃ€I LIá»†U THAM KHáº¢O

[Tiáº¿p tá»¥c vá»›i danh sÃ¡ch tÃ i liá»‡u tham kháº£o tá»« nguyÃªn báº£n...]

10

--- TRANG 10 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o...]

11

--- TRANG 11 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o...]

12

--- TRANG 12 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

[Tiáº¿p tá»¥c danh sÃ¡ch tÃ i liá»‡u tham kháº£o...]

13

--- TRANG 13 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

PHá»¤ Lá»¤C

A CHá»¨NG MINH

ChÃºng tÃ´i cÅ©ng Ä‘á»‹nh nghÄ©a vector Ä‘áº§u ra mÃ´ hÃ¬nh ftâˆˆRnÃ—p bá»Ÿi (ft)ij=f(xi, wt)j. VÃ­ dá»¥, f0 lÃ  ma tráº­n nhÃ£n giÃ¡o viÃªn ban Ä‘áº§u. Cho [n] ={1, . . . , n }. KÃ½ hiá»‡u háº¡ng cá»§a [IpâŠ—Î¦] bá»Ÿi r= rank([ IpâŠ—Î¦])â‰¤np. Äá»‹nh nghÄ©a ËœU= [u1, u2. . . , u r]âˆˆRdpÃ—r vÃ  Pr=Iâˆ’ËœUËœUâŠ¤, lÃ  ma tráº­n chiáº¿u lÃªn khÃ´ng gian null cá»§a ËœUâŠ¤. ChÃºng tÃ´i Ä‘áº§u tiÃªn chá»©ng minh bá»• Ä‘á» sau, sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c chá»©ng minh cá»§a Äá»‹nh lÃ½ 1 vÃ  Äá»‹nh lÃ½ 2 sau nÃ y:

Bá»• Ä‘á» 1. Vá»›i báº¥t ká»³ tâˆˆN0, wt,0=Pr i=1Î±i,tËœui+ 1{t= 0}v, nÆ¡i Î±i,t=1 Ïƒi 1 1+(nÎ»/Ïƒ2 i)t âˆˆR, Ëœui= ËœyiuiâˆˆRdp,Ëœyi= (VâŠ¤vec[f0])iâˆˆR, vÃ  v=Prw0,0.

Chá»©ng minh cá»§a Bá»• Ä‘á» 1. Äá»‹nh nghÄ©a wt:=wt,0 cho tâˆˆN+. Äiá»u kiá»‡n cáº§n thiáº¿t trÃªn nghiá»‡m wt táº¡i bÆ°á»›c t lÃ  âˆ‡L(wt) = 0 . Do Ä‘Ã³, báº±ng cÃ¡ch giáº£i âˆ‡L(wt) = 0 cho wt, chÃºng ta cÃ³ wt= ([IpâŠ—Î¦][IpâŠ— Î¦]âŠ¤+nÎ»I)âˆ’1[IpâŠ—Î¦] vec[ ftâˆ’1]. Báº±ng cÃ¡ch sá»­ dá»¥ng phÃ¢n tÃ¡ch giÃ¡ trá»‹ Ä‘Æ¡n [IpâŠ—Î¦] = UÎ£VâŠ¤, vÃ¬ UUâŠ¤=UâŠ¤U=I vÃ  VâŠ¤V=I, chÃºng ta cÃ³

wt= (UÎ£Î£âŠ¤UâŠ¤+nÎ»I)âˆ’1UÎ£VâŠ¤vec[ftâˆ’1] = (U(Î£Î£âŠ¤+nÎ»I)UâŠ¤)âˆ’1UÎ£VâŠ¤vec[ftâˆ’1]
=U(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£VâŠ¤vec[ftâˆ’1].

Do Ä‘Ã³, wt=U(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£VâŠ¤vec[ftâˆ’1]. Sá»­ dá»¥ng Ä‘iá»u nÃ y vÃ  [IpâŠ—Î¦] = UÎ£VâŠ¤,

vec[ft] = vec[Î¦âŠ¤WâŠ¤ tIp] = [IpâŠ—Î¦]âŠ¤wt= [IpâŠ—Î¦]âŠ¤U(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£VâŠ¤vec[ftâˆ’1]
=VÎ£âŠ¤(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£VâŠ¤vec[ftâˆ’1].

Do Ä‘Ã³, vec[ft] =V AVâŠ¤vec[ftâˆ’1] nÆ¡i A= Î£âŠ¤(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£. Láº·p láº¡i quÃ¡ trÃ¬nh nÃ y cho vec[ftâˆ’1], vÃ¬ VâŠ¤V=I,

vec[ft] =V AVâŠ¤V AVâŠ¤Â·Â·Â·V AVâŠ¤vec[f0] =V AtVâŠ¤vec[f0].

Thay phÆ°Æ¡ng trÃ¬nh nÃ y cá»§a vec[ftâˆ’1] =V Atâˆ’1VâŠ¤vec[f0] vÃ o phÆ°Æ¡ng trÃ¬nh cá»§a wt=U(Î£Î£âŠ¤+ nÎ»I)âˆ’1Î£VâŠ¤vec[ftâˆ’1], chÃºng ta cÃ³

wt=U(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£VâŠ¤V Atâˆ’1VâŠ¤vec[f0] =UBAtâˆ’1VâŠ¤vec[f0]

nÆ¡i B= (Î£Î£âŠ¤+nÎ»I)âˆ’1Î£. á» Ä‘Ã¢y, chÃºng ta cÃ³ thá»ƒ viáº¿t láº¡i ma tráº­n BâˆˆRdpÃ—np nhÆ°

B=Â¯B 0(dpâˆ’np)Ã—np

nÆ¡i 0(dpâˆ’np)Ã—np lÃ  ma tráº­n (dpâˆ’np) nhÃ¢n np vá»›i táº¥t cáº£ cÃ¡c pháº§n tá»­ báº±ng khÃ´ng, vÃ  Â¯BâˆˆRnpÃ—np lÃ  má»™t ma tráº­n Ä‘Æ°á»ng chÃ©o Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi

Â¯Bii:=Ïƒi(Ïƒ2 i+nÎ»)âˆ’1.

Sá»­ dá»¥ng B nÃ y trong phÆ°Æ¡ng trÃ¬nh trÃªn cá»§a wt=UBAtâˆ’1VâŠ¤vec[f0],

wt=UÂ¯B 0(dpâˆ’np)Ã—np Atâˆ’1VâŠ¤vec[f0]
= [u1u2Â·Â·Â· udp]Â¯BAtâˆ’1 0(dpâˆ’np)Ã—np VâŠ¤vec[f0]
=Â¯UÂ¯BAtâˆ’1VâŠ¤vec[f0]

nÆ¡i Â¯U= [u1, u2. . . , u np]âˆˆRdpÃ—np. VÃ¬ ma tráº­n A= Î£âŠ¤(Î£Î£âŠ¤+nÎ»I)âˆ’1Î£âˆˆRnpÃ—np lÃ  má»™t ma tráº­n Ä‘Æ°á»ng chÃ©o vá»›i pháº§n tá»­ cá»§a nÃ³ lÃ  Aii=Ïƒ2 i(Ïƒ2 i+nÎ»)âˆ’1,Ä‘iá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Æ¡n giáº£n hÃ³a thÃªm nhÆ°

14

--- TRANG 14 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

wt=Â¯UÂ¯BAtâˆ’1VâŠ¤vec[f0]
=Â¯U
Ïƒ1 1 Ïƒ2 1+nÎ»
...
Ïƒ1 np Ïƒ2np+nÎ»

Ïƒ2 1 Ïƒ2 1+nÎ»
...
Ïƒ2 np Ïƒ2np+nÎ»
tâˆ’1
Ëœy1
Ëœy2
...
Ëœynp

= [u1u2Â·Â·Â· unp]
Ïƒ1(Ïƒ2 1+nÎ»)âˆ’1(Ïƒ2 1(Ïƒ2 1+nÎ»)âˆ’1)tâˆ’1Ëœy1
Ïƒ2(Ïƒ2 2+nÎ»)âˆ’1(Ïƒ2 2(Ïƒ2 2+nÎ»)âˆ’1)tâˆ’1Ëœy2
...
Ïƒnp(Ïƒ2 np+nÎ»)âˆ’1(Ïƒ2 np(Ïƒ2 np+nÎ»)âˆ’1)tâˆ’1Ëœynp

=npX i=1Ïƒi(Ïƒ2 i+nÎ»)âˆ’1(Ïƒ2 i(Ïƒ2 i+nÎ»)âˆ’1)tâˆ’1Ëœyiui
=rX i=1Ïƒi(Ïƒ2 i+nÎ»)âˆ’1(Ïƒ2 i(Ïƒ2 i+nÎ»)âˆ’1)tâˆ’1Ëœyiui

nÆ¡i dÃ²ng cuá»‘i cÃ¹ng theo tá»« thá»±c táº¿ ráº±ng Ïƒi(Ïƒ2 i+nÎ»)âˆ’1(Ïƒ2 i(Ïƒ2 i+nÎ»)âˆ’1)tâˆ’1= 0 cho táº¥t cáº£ i > r . VÃ¬ Ïƒi(Ïƒ2 i+nÎ»)âˆ’1(Ïƒ2 i(Ïƒ2 i+nÎ»)âˆ’1)tâˆ’1=Ïƒ2tâˆ’1 i(Ïƒ2 i+nÎ»)âˆ’t=1 Ïƒi(Ïƒ2 i Ïƒ2 i+nÎ»)t cho iâ‰¤r, Ä‘iá»u nÃ y ngá»¥ Ã½ ráº±ng

wt=rX i=11 ÏƒiÏƒ2 i Ïƒ2 i+nÎ»t Ëœyiui=rX i=11 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyiui

VÃ¬ tâˆˆN+ lÃ  tÃ¹y Ã½, Ä‘iá»u nÃ y xáº£y ra cho báº¥t ká»³ tâˆˆN+. Äiá»u nÃ y chá»©ng minh cÃ¢u Ä‘áº§u tiÃªn cá»§a Ä‘á»‹nh lÃ½ cho báº¥t ká»³ tâˆˆN+. Vá»›i t= 0, vÃ¬

Ëœyi= (VâŠ¤vec[f0])i= (VâŠ¤[IpâŠ—Î¦]âŠ¤w0,0)i= (VâŠ¤VÎ£âŠ¤UâŠ¤w0,0)i= (Î£âŠ¤UâŠ¤w0,0)i=ÏƒiuâŠ¤ iw0,0,

chÃºng ta cÃ³

rX i=11 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyiui= rX i=1uiuâŠ¤ i! w0,0=ËœUËœUâŠ¤w0,0.

Do Ä‘Ã³,

w0,0=ËœUËœUâŠ¤w0,0+ (Iâˆ’ËœUËœUâŠ¤)w0,0=rX i=11 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyiui+ (Iâˆ’ËœUËœUâŠ¤)w0,0.

VÃ¬ (Iâˆ’ËœUËœUâŠ¤)w0,0=Prw0,0, Ä‘iá»u nÃ y hoÃ n thÃ nh cÃ¢u Ä‘áº§u tiÃªn cá»§a Ä‘á»‹nh lÃ½ cho báº¥t ká»³ tâˆˆN0.

A.1 CHá»¨NG MINH Cá»¦A Äá»ŠNH LÃ 1

Chá»©ng minh. Äá»‹nh nghÄ©a Z:= [IpâŠ—Î¦]âŠ¤âˆˆRÂ¯nÃ—Â¯d nÆ¡i Â¯n=np vÃ  Â¯d=dp. Sau Ä‘Ã³,

L(w) =1 2nX i=1âˆ¥f(xi, w)âˆ’yiâˆ¥2 2=1 2âˆ¥Zwâˆ’Yâˆ¥2 2

nÆ¡i Y= vec[[ y1, . . . , y n]âŠ¤]âˆˆRÂ¯n. VÃ¬ âˆ‡L(wt,Ï„) =ZâŠ¤(Zwt,Ï„âˆ’Y),

dwt,Ï„ dÏ„=âˆ’ZâŠ¤(Zwt,Ï„âˆ’Y)

VÃ¬ rank(Î¦) = n vÃ  dâ‰¥n, chÃºng ta cÃ³ rank( Z) = Â¯n bá»Ÿi tÃ­nh cháº¥t cá»§a tÃ­ch Kronecker vá»›i ma tráº­n Ä‘Æ¡n vá»‹. VÃ¬ rank( Z) = Â¯n, tá»“n táº¡i vâˆˆRÂ¯d sao cho Y=Zv. Do Ä‘Ã³,

dwt,Ï„ dÏ„=âˆ’ZâŠ¤(Zwt,Ï„âˆ’Zv)
=âˆ’ZâŠ¤Z(wt,Ï„âˆ’v)
=âˆ’ZâŠ¤Z(wt,Ï„âˆ’v).

VÃ¬ ZâŠ¤=UÎ£VâŠ¤, chÃºng ta cÃ³ ZâŠ¤Z=UÎ£Î£âŠ¤UâŠ¤=PÂ¯n i=1Ïƒ2 iuiuâŠ¤ i. Do Ä‘Ã³,

dwt,Ï„ dÏ„=âˆ’ Â¯nX i=1Ïƒ2 iuiuâŠ¤ i! (wt,Ï„âˆ’v) =âˆ’Â¯nX i=1Ïƒ2 iuiuâŠ¤ i(wt,Ï„âˆ’v).

VÃ¬ cÃ¡c cá»™t cá»§a U táº¡o thÃ nh cÆ¡ sá»Ÿ cá»§a RÂ¯d vÃ  w, vâˆˆRÂ¯d, chÃºng ta cÃ³ thá»ƒ viáº¿t wt,Ï„=PÂ¯d k=1c(t,Ï„) k uk vÃ  v=PÂ¯d k=1qkuk cho má»™t sá»‘ c(t,Ï„) k vÃ  qk. Do Ä‘Ã³,

dwt,Ï„ dÏ„=âˆ’Â¯nX i=1Ïƒ2 iuiuâŠ¤ iÂ¯dX k=1(c(t,Ï„) kâˆ’qk)uk
=âˆ’Â¯nX i=1Â¯dX k=1Ïƒ2 i(c(t,Ï„) kâˆ’qk)uiuâŠ¤ iuk
=âˆ’Â¯nX i=1Ïƒ2 i(c(t,Ï„) iâˆ’qi)ui.

Sá»­ dá»¥ng wt,Ï„=PÂ¯d k=1c(t,Ï„) k uk cho váº¿ pháº£i cÅ©ng váº­y, chÃºng ta cÃ³

d dÏ„Â¯dX i=1c(t,Ï„) iui=âˆ’Â¯nX i=1Ïƒ2 i(c(t,Ï„) iâˆ’qi)ui.

Äiá»u nÃ y ngá»¥ Ã½ ráº±ng cho táº¥t cáº£ iâˆˆ {1, . . . , Â¯n},

d dÏ„c(t,Ï„) i=âˆ’Ïƒ2 i(c(t,Ï„) iâˆ’qi),

vÃ  d dÏ„c(t,Ï„) i= 0 cho táº¥t cáº£ i /âˆˆ {1, . . . , Â¯n}. Äiá»u nÃ y cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c tháº¥y bá»Ÿi thá»±c táº¿ ráº±ng dwt,Ï„ dÏ„=âˆ’ZâŠ¤(Zwt,Ï„âˆ’ Zv) vá»›i ZâŠ¤=UÎ£VâŠ¤ vÃ  do Ä‘Ã³ Ä‘á»™ng há»c chá»‰ thÃªm cÃ¡c thÃ nh pháº§n cá»§a ui cho iâˆˆ {1, . . . , Â¯n}, vÃ  khÃ´ng cho i /âˆˆ {1, . . . , Â¯n}. Do Ä‘Ã³, cho cÃ¡c thÃ nh pháº§n cá»§a ui cho i /âˆˆ {1, . . . , Â¯n}, cÃ¡c giÃ¡ trá»‹ ban Ä‘áº§u Ä‘Æ°á»£c giá»¯ nguyÃªn. NÃ³i cÃ¡ch khÃ¡c, cho i /âˆˆ {1, . . . , Â¯n},

c(t,Ï„) i=c(t,0) i.

Máº·t khÃ¡c, cho iâˆˆ {1, . . . , Â¯n}, vÃ¬ d dÏ„qi= 0,

d dÏ„(c(t,Ï„) iâˆ’qi) =d dÏ„c(t,Ï„) i=âˆ’Ïƒ2 i(c(t,Ï„) iâˆ’qi).

Giáº£i Ä‘iá»u nÃ y cho (c(t,Ï„) iâˆ’qi), chÃºng ta cÃ³ cho iâˆˆ {1, . . . , Â¯n},

c(t,Ï„) iâˆ’qi= (c(t,0) iâˆ’qi)eâˆ’Ïƒ2 iÏ„.

Äiá»u nÃ y ngá»¥ Ã½ ráº±ng

c(t,Ï„) i=qi+ (c(t,0) iâˆ’qi)eâˆ’Ïƒ2 iÏ„=qi(1âˆ’eâˆ’Ïƒ2 iÏ„) +c(t,0) ieâˆ’Ïƒ2 iÏ„.

Káº¿t há»£p nhá»¯ng Ä‘iá»u nÃ y vá»›i wt,T=PÂ¯d k=1c(t,T) k uk,

wt,T=Â¯dX i=1c(t,T) iui=Â¯nX i=1qi(1âˆ’eâˆ’Ïƒ2 iT)ui+Â¯nX i=1c(t,0) ieâˆ’Ïƒ2 iTui+Â¯dX i=Â¯n+1c(t,0) iui. (5)

Do Ä‘Ã³, cho báº¥t ká»³ sâˆˆ S cá»¥ thá»ƒ, vÃ¬ U= [u1, u2. . . , u dp]âˆˆRdpÃ—dp lÃ  má»™t ma tráº­n trá»±c giao,

âˆ¥At(s)âˆ¥2 2=âˆ¥wt,Tâˆ¥2 2â‰¤Â¯nX i=1 qi(1âˆ’eâˆ’Ïƒ2 iT)2 +Â¯nX i=1(c(t,0) i)2eâˆ’2Ïƒ2 iT+Â¯dX i=Â¯n+1(c(t,0) i)2. (6)

nÆ¡i qi, Ïƒi, vÃ  c(t,0) i Ä‘á»u phá»¥ thuá»™c vÃ o s.

15

--- TRANG 15 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Báº±ng cÃ¡ch sá»­ dá»¥ng Bá»• Ä‘á» 4 cá»§a (Pham et al., 2021) vÃ  láº¥y union bound vá»›i P(s /âˆˆ S)â‰¤Î´, vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´, chÃºng ta cÃ³ wt,Tâˆˆ Ft vÃ  Ä‘iá»u sau Ä‘Ã¢y xáº£y ra:

Ex,y[â„“(wt,T, x, y)]â‰¤1 n nX i=1â„“(wt,T, xi, yi) + 2Rn(Ft) +Mr ln(2/Î´) 2n, (7)

nÆ¡i Rn(Ft) =Es,Î¾[supwâˆˆFt1 n Pn i=1Î¾iâˆ¥WÏ†(xi)âˆ’yiâˆ¥2 2],s= ((xi, yi))n i=1,w= vec[ WâŠ¤], vÃ  Î¾1, . . . , Î¾ n lÃ  cÃ¡c biáº¿n ngáº«u nhiÃªn Ä‘á»™c láº­p Ä‘á»“ng nháº¥t láº¥y giÃ¡ trá»‹ trong {âˆ’1,1}. Báº±ng cÃ¡ch sá»­ dá»¥ng Há»‡ quáº£ 4 cá»§a (Maurer, 2016), tá»“n táº¡i má»™t háº±ng sá»‘ c (chá»‰ phá»¥ thuá»™c vÃ o M) sao cho,

Rn(Ft)â‰¤c n Es,Î¾[ sup wâˆˆFtnX i=1pX k=1Î¾ikWkÏ†(xi)]
=c n Es,Î¾[ sup wâˆˆFtpX k=1WknX i=1Î¾ikÏ†(xi)]
=c n Es,Î¾[ sup wâˆˆFtwâŠ¤h]

nÆ¡i Wk lÃ  hÃ ng thá»© k cá»§a W,Î¾ik lÃ  cÃ¡c biáº¿n ngáº«u nhiÃªn Ä‘á»™c láº­p Ä‘á»“ng nháº¥t láº¥y giÃ¡ trá»‹ trong {âˆ’1,1},h= vec[ H]âˆˆRdp, vÃ  HâˆˆRdÃ—p vá»›i Hjk=Pn i=1Î¾ikÏ†(xi)j. Do Ä‘Ã³,

Rn(Ft)â‰¤c n Es,Î¾[ sup wâˆˆFtâˆ¥wâˆ¥2âˆ¥hâˆ¥2] =c(supwâˆˆFtâˆ¥wâˆ¥2) n Es,Î¾[âˆ¥hâˆ¥2]

á» Ä‘Ã¢y,

Es,Î¾[âˆ¥hâˆ¥2] =Es,Î¾vuutdX j=1pX k=1 nX i=1Î¾ikÏ†(xi)j!2
â‰¤vuutdX j=1pX k=1Es,Î¾ nX i=1Î¾ikÏ†(xi)j!2
=vuutdX j=1pX k=1EsnX i=1(Ï†(xi)j)2 (8)
=vuutpX k=1nX i=1EsdX j=1(Ï†(xi)j)2
=vuutpX k=1nX i=1Esâˆ¥Ï†(xi)âˆ¥2 2
â‰¤Râˆšpn

PhÆ°Æ¡ng trÃ¬nh 8 xáº£y ra vÃ¬

Es,Î¾[(Î¾ikÏ•(xi)j)Â·(Î¾lkÏ•(xl)j)] =Es[ 1{i=l}Ï•(xi)jÏ•(xl)j]

cho táº¥t cáº£ i, lâˆˆ[n].

Do Ä‘Ã³,

Rn(Ft)â‰¤cRâˆšp(supwâˆˆFtâˆ¥wâˆ¥2)âˆšn. (9)

Äá»‹nh nghÄ©a

Î¶t(s):=vuutÂ¯nX i=1 qi(1âˆ’eâˆ’Ïƒ2 iT)2+Â¯nX i=1(c(t,0) i)2eâˆ’2Ïƒ2 iT+Â¯dX i=Â¯n+1(c(t,0) i)2.

nÆ¡i qi, Ïƒi, vÃ  c(t,0) i Ä‘á»u phá»¥ thuá»™c vÃ o s. Vá»›i Ä‘iá»u nÃ y, chÃºng ta Ä‘á»‹nh nghÄ©a

Î¶(t):= sup sâˆˆSÎ¶t(s).

16

--- TRANG 16 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Sau Ä‘Ã³, báº±ng cÃ¡ch káº¿t há»£p phÆ°Æ¡ng trÃ¬nh 6, phÆ°Æ¡ng trÃ¬nh 7, vÃ  phÆ°Æ¡ng trÃ¬nh 9, vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´, Ä‘iá»u sau Ä‘Ã¢y xáº£y ra:

Ex,y[â„“(wt,T, x, y)]â‰¤1 n nX i=1â„“(wt,T, xi, yi) +Î¶(t)r 4c2R2p n+Mr ln(2/Î´) 2n.

Cuá»‘i cÃ¹ng, tá»« Bá»• Ä‘á» 1, cho báº¥t ká»³ tâˆˆN0 vÃ  iâˆˆ {1, . . . , Â¯n},

(c(t,0) i)2=  1 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyi!2 .

VÃ¬ 1 1+(nÎ»/Ïƒ2 i)<1(bá»Ÿi vÃ¬ nÎ»/Ïƒ2 i>0), giÃ¡ trá»‹ cá»§a 1 1+(nÎ»/Ïƒ2 i)2t giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t khi t tÄƒng. VÃ¬ 1 Ïƒ2 i>0 vÃ  Ëœy2 iâ‰¥0, Ä‘iá»u nÃ y ngá»¥ Ã½ ráº±ng (c(t,0) i)2 giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 trá»« khi c(t,0) i= 0. HÆ¡n ná»¯a, tá»« Bá»• Ä‘á» 1, chÃºng ta cÃ³

wt,0=Â¯nX i=1Î±i,tËœyiui+ 1{t= 0}(Iâˆ’ËœUËœUâŠ¤)w0,0.

VÃ¬ {u1, . . . , u Â¯d} lÃ  má»™t cÆ¡ sá»Ÿ trá»±c chuáº©n cho RÂ¯d vá»›i tÃ­ch vÃ´ hÆ°á»›ng âŸ¨x, yâŸ©=yâŠ¤x, chÃºng ta cÃ³

w0,0=Â¯dX i=1(uâŠ¤ iw0,0)ui.

VÃ¬ ËœUËœUâŠ¤w0,0=PÂ¯n i=1(uâŠ¤ iw0,0)ui, chÃºng ta cÃ³

(Iâˆ’ËœUËœUâŠ¤)w0,0=Â¯dX i=1(uâŠ¤ iw0,0)uiâˆ’Â¯nX i=1(uâŠ¤ iw0,0)ui=Â¯dX i=Â¯n+1(uâŠ¤ iw0,0)ui,

Ä‘iá»u nÃ y ngá»¥ Ã½ ráº±ng thÃ nh pháº§n ui Ä‘á»ƒ span wt,0 cho iâˆˆ {Â¯n+ 1, . . . , Â¯d} chá»‰ cÃ³ máº·t trong (Iâˆ’ ËœUËœUâŠ¤)w0,0. NÃ³i cÃ¡ch khÃ¡c,

wt,0=Â¯nX i=1Î±i,tËœyiui+Â¯dX i=Â¯n+11{t= 0}(uâŠ¤ iw0,0)ui.

Do Ä‘Ã³, cho báº¥t ká»³ tâˆˆN0 vÃ  iâˆˆ {Â¯n+ 1, . . . , Â¯d}, chÃºng ta cÃ³

(c(t,0) i)2= 1{t= 0}(uâŠ¤ iw0,0)2.

Nhá»¯ng Ä‘iá»u nÃ y ngá»¥ Ã½ ráº±ng Î¶(t) giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 trá»« khi w0,0= 0.

A.2 CHá»¨NG MINH Cá»¦A Äá»ŠNH LÃ 2

Chá»©ng minh. Trong chá»©ng minh nÃ y, chÃºng tÃ´i tiáº¿p tá»¥c sá»­ dá»¥ng cÃ¡c káº¿t quáº£ vÃ  kÃ½ hiá»‡u tá»« chá»©ng minh cá»§a Äá»‹nh lÃ½ 1. Báº±ng cÃ¡ch sá»­ dá»¥ng phÆ°Æ¡ng trÃ¬nh 5 trong chá»©ng minh cá»§a Äá»‹nh lÃ½ 1, chÃºng ta cÃ³

âˆ¥winitâˆ’wt,Tâˆ¥2=âˆ¥winitâˆ’vtâˆ¥2,

nÆ¡i

vt=Â¯nX i=1qi(1âˆ’eâˆ’Ïƒ2 iT)ui+Â¯nX i=1c(t,0) ieâˆ’Ïƒ2 iTui+Â¯dX i=Â¯n+1c(t,0) iui.

Náº¿u winit=âˆ’Î±vt cho má»™t sá»‘ Î± >0, thÃ¬

âˆ¥winitâˆ’vtâˆ¥2=âˆ¥vt+Î±vtâˆ¥2
= (1 + Î±)âˆ¥vtâˆ¥2
=âˆ¥vtâˆ¥2+âˆ¥Î±vtâˆ¥2
=vuutÂ¯nX i=1q2 i(1âˆ’eâˆ’Ïƒ2 iT)2+Â¯nX i=1(c(t,0) i)2eâˆ’2Ïƒ2 iT+Â¯dX i=Â¯n+1(c(t,0) i)2+âˆ¥winitâˆ¥2.

17

--- TRANG 17 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Máº·t khÃ¡c, cho báº¥t ká»³ winitâˆˆRdp,

âˆ¥winitâˆ’vtâˆ¥2â‰¤ âˆ¥vtâˆ¥2+âˆ¥winitâˆ¥2
â‰¤vuutÂ¯nX i=1q2 i(1âˆ’eâˆ’Ïƒ2 iT)2+Â¯nX i=1(c(t,0) i)2eâˆ’2Ïƒ2 iT+Â¯dX i=Â¯n+1(c(t,0) i)2+âˆ¥winitâˆ¥2.

Do Ä‘Ã³, Ä‘áº·t Ïˆ(t) lÃ  hÃ m sau thá»a mÃ£n cÃ¡c Ä‘iá»u kiá»‡n (1) vÃ  (2) trong phÃ¡t biá»ƒu:

Ïˆ(t):=vuutÂ¯nX i=1q2 i(1âˆ’eâˆ’Ïƒ2 iT)2+Â¯nX i=1(c(t,0) i)2eâˆ’2Ïƒ2 iT+Â¯dX i=Â¯n+1(c(t,0) i)2+âˆ¥winitâˆ¥2

Cuá»‘i cÃ¹ng, tá»« Bá»• Ä‘á» 1, cho báº¥t ká»³ tâˆˆN0 vÃ  iâˆˆ {1, . . . , Â¯n},

(c(t,0) i)2=  1 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyi!2 .

Ä‘iá»u nÃ y giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 trá»« khi c(t,0) i= 0 cho táº¥t cáº£ iâˆˆ {1, . . . , Â¯n} nhÆ° Ä‘Æ°á»£c chá»‰ ra trong chá»©ng minh cá»§a Äá»‹nh lÃ½ 1. HÆ¡n ná»¯a, tá»« Bá»• Ä‘á» 1, cho báº¥t ká»³ tâˆˆN0 vÃ  iâˆˆ {Â¯n+ 1, . . . , Â¯d},

(c(t,0) i)2= 1{t= 0}(uâŠ¤ iw0,0)2.

NghÄ©a lÃ ,

Ïˆ(t) =vuutG1+Ïˆ1(t) +Â¯dX i=Â¯n+11{t= 0}(uâŠ¤ iw0,0)2+G2,

nÆ¡i

G1:=Â¯nX i=1q2 i(1âˆ’eâˆ’Ïƒ2 iT)2,

Ïˆ1(t):=Â¯nX i=1  1 Ïƒi1 1 + (nÎ»/Ïƒ2 i)t Ëœyi!2 eâˆ’2Ïƒ2 iT,

vÃ 

G2:=âˆ¥winitâˆ¥2.

VÃ¬ eâˆ’2Ïƒ2 iT>0 lÃ  má»™t háº±ng sá»‘ theo t vÃ  chÃºng ta Ä‘Ã£ chá»‰ ra trÆ°á»›c Ä‘Ã¢y ráº±ng 1 Ïƒi 1 1+(nÎ»/Ïƒ2 i)t Ëœyi2 giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 trá»« khi w0,0= 0. NÃ³ ngá»¥ Ã½ ráº±ng cáº£ Ïˆ1(t) vÃ  Ïˆ(t) Ä‘á»u giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t theo tâˆˆN0 trá»« khi w0,0= 0.

Nháº­n xÃ©t 1. LÆ°u Ã½ ráº±ng Äá»‹nh lÃ½ 2 cÅ©ng cho tháº¥y khoáº£ng cÃ¡ch giá»¯a trá»ng sá»‘ cá»§a giÃ¡o viÃªn wtâˆ’1,T vÃ  trá»ng sá»‘ tiá»n huáº¥n luyá»‡n ban Ä‘áº§u winit cho táº¥t cáº£ tâˆˆN+. VÃ¬ giÃ¡o viÃªn táº¡i vÃ²ng tâ€²âˆˆN+ cá»§a tá»± chÆ°ng cáº¥t tá»«ng lÃ  há»c sinh cá»§a vÃ²ng tâ€²âˆ’1 cá»§a tá»± chÆ°ng cáº¥t vÃ  Äá»‹nh lÃ½ 2 xáº£y ra cho táº¥t cáº£ sá»‘ nguyÃªn khÃ´ng Ã¢m tâˆˆN0, khoáº£ng cÃ¡ch giá»¯a trá»ng sá»‘ ban Ä‘áº§u vÃ  trá»ng sá»‘ giÃ¡o viÃªn âˆ¥winitâˆ’wtâˆ’1,Tâˆ¥2 giáº£m má»™t cÃ¡ch nghiÃªm ngáº·t cho táº¥t cáº£ tâˆˆN+. VÃ­ dá»¥, táº¡i t= 1, chÃºng ta thu Ä‘Æ°á»£c báº¥t Ä‘áº³ng thá»©c sau

âˆ¥winitâˆ’w0,Tâˆ¥2â‰¤Ïˆ(0),

nÆ¡i w0,T lÃ  trá»ng sá»‘ cá»§a giÃ¡o viÃªn ban Ä‘áº§u khÃ´ng cÃ³ tá»± chÆ°ng cáº¥t .

B THÃ NGHIá»†M Bá»” SUNG

Trong pháº§n nÃ y, chÃºng tÃ´i thá»±c hiá»‡n cÃ¡c thÃ­ nghiá»‡m bá»• sung Ä‘á»ƒ phÃ¢n tÃ­ch tá»‘t hÆ¡n phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t, tá»± chÆ°ng cáº¥t cho tiá»n huáº¥n luyá»‡n thÃªm.

18

--- TRANG 18 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

Báº£ng 4: HÃ m máº¥t mÃ¡t huáº¥n luyá»‡n vÃ  kiá»ƒm tra.
PhÆ°Æ¡ng phÃ¡p Chia Aircraft CUB Chest-Xray DTD Dogs Flower
Tiá»n Huáº¥n Luyá»‡n ThÃªmHuáº¥n luyá»‡n (log) âˆ’9.13Â±0.09âˆ’8.58Â±0.05âˆ’8.10Â±1.90âˆ’3.70Â±0.37âˆ’5.41Â±0.13âˆ’9.70Â±0.32
Kiá»ƒm tra 1.44Â±0.03 2 .44Â±0.02 2 .26Â±0.22 2 .49Â±0.08 1 .96Â±0.02 0 .63Â±0.04
Tá»± ChÆ°ng Cáº¥tHuáº¥n luyá»‡n (log) âˆ’9.17Â±0.08âˆ’8.16Â±0.31âˆ’6.08Â±0.50âˆ’4.08Â±0.30âˆ’5.50Â±0.06âˆ’7.98Â±1.28
Kiá»ƒm tra 1.36Â±0.01 2.26 Â±0.04 2.08 Â±0.17 2.15 Â±0.06 1.90 Â±0.01 0.50 Â±0.03

Báº£ng 5: So sÃ¡nh vá»›i há»c tÆ°Æ¡ng pháº£n cÃ³ giÃ¡m sÃ¡t.
MÃ´ hÃ¬nh X-ray Flower
SupCon 75.30Â±1.03 76 .70Â±1.76
Tinh chá»‰nh 77.15Â±0.52 88 .78Â±0.65
Tiá»n Huáº¥n Luyá»‡n ThÃªm 77.79Â±2.06 88 .63Â±0.35
Tá»± ChÆ°ng Cáº¥t 79.68Â±1.05 79.68 Â±0.44Há»c TÆ°Æ¡ng Pháº£n CÃ³ GiÃ¡m SÃ¡t Äá»‘i vá»›i cÃ¡c thÃ­ nghiá»‡m chÃ­nh trong Pháº§n 5, chÃºng tÃ´i sá»­ dá»¥ng cÃ¹ng má»™t hÃ m má»¥c tiÃªu cho tiá»n huáº¥n luyá»‡n vÃ  tiá»n huáº¥n luyá»‡n thÃªm. NgÆ°á»i ta cÃ³ thá»ƒ tá»± há»i Ä‘iá»u gÃ¬ xáº£y ra náº¿u chÃºng ta sá»­ dá»¥ng má»¥c tiÃªu khÃ¡c nhau á»Ÿ giai Ä‘oáº¡n tiá»n huáº¥n luyá»‡n thÃªm. Trong thÃ­ nghiá»‡m nÃ y, chÃºng tÃ´i tiáº¿p tá»¥c tiá»n huáº¥n luyá»‡n bá»™ mÃ£ hÃ³a cá»§a transformer tiá»n huáº¥n luyá»‡n (He et al., 2022) vá»›i hÃ m máº¥t mÃ¡t tÆ°Æ¡ng pháº£n cÃ³ giÃ¡m sÃ¡t (Khosla et al., 2020) trong khi tinh chá»‰nh má»™t bá»™ phÃ¢n loáº¡i tuyáº¿n tÃ­nh Ä‘Æ°á»£c khá»Ÿi táº¡o ngáº«u nhiÃªn vá»›i hÃ m máº¥t mÃ¡t cross-entropy. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 5, há»c tÆ°Æ¡ng pháº£n cÃ³ giÃ¡m sÃ¡t (SupCon) lÃ m giáº£m Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t tá»•ng quÃ¡t hÃ³a cá»§a Vision Transformer trÃªn cáº£ táº­p dá»¯ liá»‡u X-ray vÃ  Flower. Dá»±a trÃªn káº¿t quáº£ thÃ­ nghiá»‡m nÃ y, chÃºng tÃ´i phá»ng Ä‘oÃ¡n ráº±ng transformer Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vá»›i má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ cÃ³ thá»ƒ khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i hÃ m máº¥t mÃ¡t tÆ°Æ¡ng pháº£n vÃ  do Ä‘Ã³ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¹ng má»¥c tiÃªu cho tiá»n huáº¥n luyá»‡n vÃ  tiá»n huáº¥n luyá»‡n thÃªm.

Khoáº£ng CÃ¡ch Tá»•ng QuÃ¡t HÃ³a NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5a, tá»± chÆ°ng cáº¥t giáº£m khoáº£ng cÃ¡ch tá»•ng quÃ¡t hÃ³a so vá»›i phÆ°Æ¡ng phÃ¡p tiá»n huáº¥n luyá»‡n thÃªm. NgoÃ i ra, chÃºng tÃ´i bÃ¡o cÃ¡o riÃªng hÃ m máº¥t mÃ¡t huáº¥n luyá»‡n vÃ  kiá»ƒm tra trong Báº£ng 4. Cáº£ tiá»n huáº¥n luyá»‡n thÃªm vÃ  tá»± chÆ°ng cáº¥t Ä‘á»u Ä‘áº¡t Ä‘Æ°á»£c hÃ m máº¥t mÃ¡t huáº¥n luyá»‡n gáº§n báº±ng khÃ´ng, nhÆ°ng tá»± chÆ°ng cáº¥t Ä‘áº¡t Ä‘Æ°á»£c hÃ m máº¥t mÃ¡t kiá»ƒm tra tháº¥p hÆ¡n nhiá»u so vá»›i tiá»n huáº¥n luyá»‡n thÃªm nhÆ° má»™t há»‡ quáº£ cá»§a Ä‘iá»u hÃ²a Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi tá»± chÆ°ng cáº¥t.

Báº£ng 6: Giáº£m trá»ng sá»‘ cá»§a má»¥c tiÃªu MAE.
Î» CUB
1.0 58.06Â±0.90
0.5 57.76Â±0.17
0.3 58.21Â±0.42
0.1 57.76Â±0.33Giáº£m Trá»ng Sá»‘ cá»§a MÃ£ HÃ³a Tá»± Äá»™ng CÃ³ Máº·t Náº¡ Máº·c dÃ¹ chÃºng tÃ´i cá»‘ Ä‘á»‹nh cáº£ trá»ng sá»‘ cá»§a tá»± chÆ°ng cáº¥t vÃ  má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ báº±ng 1 trong phÆ°Æ¡ng trÃ¬nh 3, chÃºng tÃ´i thay Ä‘á»•i Î»âˆˆ(0,1], trá»ng sá»‘ cá»§a má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ (Î»LMAE(Î¸, Ï•;Du) +LDistill (Î¸;Î¸0,Du)) vÃ  bÃ¡o cÃ¡o Ä‘á»™ chÃ­nh xÃ¡c kiá»ƒm tra cá»§a Vision Transformer vá»›i tá»± chÆ°ng cáº¥t trÃªn táº­p dá»¯ liá»‡u CUB. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 6, phÆ°Æ¡ng phÃ¡p Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i khÃ´ng nháº¡y cáº£m vá»›i giÃ¡ trá»‹ cá»§a Î» vÃ  do Ä‘Ã³ khÃ´ng cÃ³ lá»£i Ã­ch gÃ¬ khi tinh chá»‰nh trá»ng sá»‘ cá»§a má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡.

Thá»i Gian Huáº¥n Luyá»‡n Bá»• Sung Äá»ƒ phÃ¢n tÃ­ch tá»‘t hÆ¡n chi phÃ­ tÃ­nh toÃ¡n bá»• sung cho tiá»n huáº¥n luyá»‡n thÃªm vÃ  tá»± chÆ°ng cáº¥t, chÃºng tÃ´i bÃ¡o cÃ¡o thá»i gian wall clock huáº¥n luyá»‡n cho tinh chá»‰nh, tiá»n huáº¥n luyá»‡n thÃªm, vÃ  tá»± chÆ°ng cáº¥t, tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i huáº¥n luyá»‡n má»™t Vision Transformer (Dosovitskiy et al., 2021) trÃªn táº­p dá»¯ liá»‡u CUB vá»›i GPU 3090 RTX vÃ  CPU Intel(R) Xeon(R) Silver 4210R. Pháº£i máº¥t 32 phÃºt 18 giÃ¢y Ä‘á»ƒ tinh chá»‰nh transformer. ChÃºng ta cáº§n thÃªm 1 giá» 29 phÃºt 33 giÃ¢y cho tiá»n huáº¥n luyá»‡n thÃªm vÃ  5 giá» 13 phÃºt 22 giÃ¢y cho tá»± chÆ°ng cáº¥t.

C MÃƒ HÃ“A Tá»° Äá»˜NG CÃ“ Máº¶T Náº 

Trong pháº§n nÃ y, chÃºng tÃ´i mÃ´ táº£ má»¥c tiÃªu mÃ£ hÃ³a tá»± Ä‘á»™ng cÃ³ máº·t náº¡ tá»« phÆ°Æ¡ng trÃ¬nh 2 chi tiáº¿t hÆ¡n. Cho má»™t chuá»—i x= (x1, . . . , x K) vá»›i Ä‘á»™ dÃ i K, chÃºng ta láº¥y máº«u máº·t náº¡ z= (z1, . . . , z K) tá»« má»™t phÃ¢n phá»‘i Binomial pÎ³,K vá»›i xÃ¡c suáº¥t thÃ nh cÃ´ng Î³âˆˆ(0,1) vÃ  sá»‘ láº§n thá»­ K. Vá»›i má»—i xk, chÃºng ta thay tháº¿ nÃ³ báº±ng token Ä‘áº·c biá»‡t "mask" náº¿u zk= 1. NgÆ°á»£c láº¡i chÃºng ta sá»­ dá»¥ng cÃ¹ng xk cho má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡. Cho Ë†x= (Ë†x1, . . . , Ë†xK) lÃ  má»™t Ä‘áº§u vÃ o cÃ³ máº·t náº¡ vÃ  cho fÎ¸, gÏ• láº§n lÆ°á»£t lÃ  bá»™ mÃ£ hÃ³a vÃ  bá»™ giáº£i mÃ£. ChÃºng ta muá»‘n tÃ­nh toÃ¡n log-likelihood cá»§a Ä‘áº§u vÃ o Ä‘Æ°á»£c tÃ¡i táº¡o PK k=1zklogpÎ¸,Ï•(xk|Ë†x).

Äá»‘i vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯, viá»‡c tÃ¡i táº¡o Ä‘áº§u vÃ o cÃ³ máº·t náº¡ Ë†xk lÃ  dá»± Ä‘oÃ¡n token nÃ o Ä‘Æ°á»£c che dáº¥u trong tá»« vá»±ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c cÃ³ kÃ­ch thÆ°á»›c V, nÆ¡i má»—i token Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° má»™t sá»‘ nguyÃªn tá»« {1, . . . , V }. Do Ä‘Ã³ xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n cá»§a xkâˆˆ {1, . . . , V } cho Ë†x Ä‘Æ°á»£c tham sá»‘ hÃ³a nhÆ° sau:

19

--- TRANG 19 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

pÎ¸,Ï•(xk|Ë†x) =exp(uxk)) PV j=1exp(uj)

nÆ¡i (u1, . . . , u V) =gÏ•(hk)âˆˆRV,"| | h1Â·Â·Â·hK | |# =fÎ¸(Ë†x)âˆˆRhÃ—K.

Äá»‘i vá»›i ViT, chuá»—i x bao gá»“m cÃ¡c patch hÃ¬nh áº£nh vÃ  viá»‡c tÃ¡i táº¡o Ä‘áº§u vÃ o cÃ³ máº·t náº¡ lÃ  dá»± Ä‘oÃ¡n giÃ¡ trá»‹ pixel cho má»—i patch bá»‹ che dáº¥u, Ä‘Ã¢y lÃ  má»™t bÃ i toÃ¡n há»“i quy. Do Ä‘Ã³, chÃºng ta tham sá»‘ hÃ³a xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n cá»§a má»™t patch xk= (xk,1, . . . , x k,m)âˆˆRm cho Ë†x nhÆ° sau:

pÎ¸,Ï•(xk|Ë†x) =mY i=11âˆš 2Ï€Ïƒ2exp âˆ’(xk,iâˆ’Âµk,i)2 2Ïƒ2

nÆ¡i Âµk= (Âµk,1, . . . , Âµ k,m)âˆˆRm,"| | Âµ1Â·Â·Â·ÂµK | |# =fÎ¸(Ë†x)âˆˆRmÃ—K.

VÃ¬ Ïƒ >0 vÃ  Ï€ lÃ  cÃ¡c háº±ng sá»‘ Ä‘á»‘i vá»›i Î¸ vÃ  Ï•,

arg min Î¸,Ï•âˆ’KX k=1logpÎ¸,Ï•(xk|Ë†x) = arg min Î¸,Ï•KX k=1 1 2Ïƒ2mX j=1(xk,jâˆ’Âµk,j)2âˆ’mlog1âˆš 2Ï€Ïƒ2 

= arg min Î¸,Ï•KX k=1 mX j=1(xk,jâˆ’Âµk,j)2 

= arg min Î¸,Ï•KX k=1âˆ¥xkâˆ’Âµkâˆ¥2 2.

D Táº¬P Dá»® LIá»†U

ChÃºng tÃ´i mÃ´ táº£ thá»‘ng kÃª cá»§a táº¥t cáº£ cÃ¡c táº­p dá»¯ liá»‡u phÃ¢n loáº¡i hÃ¬nh áº£nh vÃ  vÄƒn báº£n Ä‘Æ°á»£c sá»­ dá»¥ng cho cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i trong Báº£ng 7 vÃ  8.

Báº£ng 7: Sá»‘ lÆ°á»£ng thá»ƒ hiá»‡n huáº¥n luyá»‡n vÃ  lá»›p cho má»—i táº­p dá»¯ liá»‡u phÃ¢n loáº¡i hÃ¬nh áº£nh.
Aircraft CUB Chest X-ray DTD Dogs Flower
# thá»ƒ hiá»‡n 6,667 5,594 5,216 4,230 12,000 2,040
# lá»›p 100 200 2 47 120 102

Báº£ng 8: Sá»‘ lÆ°á»£ng thá»ƒ hiá»‡n huáº¥n luyá»‡n vÃ  lá»›p cho má»—i táº­p dá»¯ liá»‡u phÃ¢n loáº¡i vÄƒn báº£n.
SCIERC ACL-ARC Chemprot Twitter-Emotion
# thá»ƒ hiá»‡n 3,219 1,688 4,169 4,230
# lá»›p 7 6 13 47

20

--- TRANG 20 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2023

E SIÃŠU THAM Sá»

Trong Báº£ng 9, chÃºng tÃ´i tÃ³m táº¯t táº¥t cáº£ cÃ¡c siÃªu tham sá»‘ cho Vision Transformer vÃ  RoBERTA.

Báº£ng 9: SiÃªu tham sá»‘ cho Vision Transformer vÃ  RoBERTA
SiÃªu tham sá»‘ Vision Transformer RoBERTA
tá»· lá»‡ há»c cho tiá»n huáº¥n luyá»‡n 1.5Â·10âˆ’41Â·10âˆ’4
tá»· lá»‡ há»c cho tinh chá»‰nh 1Â·10âˆ’42Â·10âˆ’5
há»‡ sá»‘ weight decay 1Â·10âˆ’21Â·10âˆ’2
kÃ­ch thÆ°á»›c batch cho tiá»n huáº¥n luyá»‡n 64 128
kÃ­ch thÆ°á»›c batch cho tinh chá»‰nh 32 16
bá»™ láº­p lá»‹ch tá»· lá»‡ há»c linear-decay linear-decay
bÆ°á»›c tinh chá»‰nh 10,000 10 epoch
bÆ°á»›c tiá»n huáº¥n luyá»‡n 20,000 100 epoch
vÃ²ng tá»± chÆ°ng cáº¥t 1 1

21
