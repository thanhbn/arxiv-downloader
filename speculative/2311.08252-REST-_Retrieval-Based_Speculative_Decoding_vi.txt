# 2311.08252.pdf
# ÄÆ°á»£c chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/speculative/2311.08252.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 666306 byte

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
REST: Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t
Zhenyu He1âˆ—, Zexuan Zhong2âˆ—,Tianle Cai2âˆ—, Jason D. Lee2, Di He1â€ 
1PhÃ²ng thÃ­ nghiá»‡m Quá»‘c gia vá» AI Tá»•ng quÃ¡t, TrÆ°á»ng TrÃ­ tuá»‡ NhÃ¢n táº¡o, Äáº¡i há»c Báº¯c Kinh
2Äáº¡i há»c Princeton
hezhenyu@stu.pku.edu.cn ,zzhong@cs.princeton.edu ,
{tianle.cai, jasonlee}@princeton.edu ,dihe@pku.edu.cn
TÃ³m táº¯t
ChÃºng tÃ´i giá»›i thiá»‡u Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t (REST), má»™t thuáº­t toÃ¡n má»›i Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÄƒng tá»‘c quÃ¡ trÃ¬nh sinh vÄƒn báº£n cá»§a mÃ´ hÃ¬nh ngÃ´n ngá»¯. Ã tÆ°á»Ÿng chÃ­nh thÃºc Ä‘áº©y phÃ¡t triá»ƒn REST lÃ  quan sÃ¡t ráº±ng quÃ¡ trÃ¬nh sinh vÄƒn báº£n thÆ°á»ng bao gá»“m cÃ¡c giai Ä‘oáº¡n vÃ  máº«u phá»• biáº¿n nháº¥t Ä‘á»‹nh. KhÃ¡c vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p trÆ°á»›c Ä‘Ã¢y dá»±a vÃ o mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¡p cho giáº£i mÃ£ suy Ä‘oÃ¡n, REST khai thÃ¡c sá»©c máº¡nh cá»§a truy xuáº¥t Ä‘á»ƒ sinh ra cÃ¡c token nhÃ¡p. PhÆ°Æ¡ng phÃ¡p nÃ y rÃºt ra tá»« nguá»“n kiáº¿n thá»©c hiá»‡n cÃ³, truy xuáº¥t vÃ  sá»­ dá»¥ng cÃ¡c token liÃªn quan dá»±a trÃªn ngá»¯ cáº£nh hiá»‡n táº¡i. TÃ­nh cháº¥t cáº¯m-vÃ -cháº¡y cá»§a nÃ³ cho phÃ©p tÃ­ch há»£p liá»n máº¡ch vÃ  tÄƒng tá»‘c báº¥t ká»³ mÃ´ hÃ¬nh ngÃ´n ngá»¯ nÃ o, táº¥t cáº£ mÃ  khÃ´ng cáº§n Ä‘Ã o táº¡o thÃªm. Khi Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ trÃªn cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ 7B vÃ  13B trong thiáº¿t láº­p batch Ä‘Æ¡n, REST Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c Ä‘Ã¡ng ká»ƒ tá»« 1.62Ã— Ä‘áº¿n 2.36Ã— trong sinh mÃ£ hoáº·c vÄƒn báº£n. MÃ£ nguá»“n cá»§a REST cÃ³ sáºµn táº¡i https://github.com/FasterDecoding/REST.

1 Giá»›i thiá»‡u
CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n (LLM) dá»±a trÃªn Transformer Ä‘Ã£ ná»•i lÃªn nhÆ° má»™t mÃ´ hÃ¬nh ná»n táº£ng trong xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn (Vaswani et al., 2017; Devlin et al., 2019; Brown et al., 2020; Zhang et al., 2022; Scao et al., 2022; Chowdhery et al., 2022; Zeng et al., 2022; Touvron et al., 2023). Máº·c dÃ¹ chÃºng Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t áº¥n tÆ°á»£ng trÃªn nhiá»u nhiá»‡m vá»¥ khÃ¡c nhau, chi phÃ­ suy luáº­n lÃ  ráº¥t lá»›n trong cÃ¡c tÃ¬nh huá»‘ng thá»±c táº¿. Trong quÃ¡ trÃ¬nh suy luáº­n, mÃ´ hÃ¬nh tá»± há»“i quy sá»­ dá»¥ng ngá»¯ cáº£nh trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ sinh ra token tiáº¿p theo. Má»—i láº§n láº·p Ä‘Ã²i há»i pháº£i táº£i láº¡i LLM hÃ ng tá»· tham sá»‘ tá»« Bá»™ nhá»› BÄƒng thÃ´ng Cao (HBM) vÃ o bá»™ Ä‘á»‡m trÃªn chip cá»§a cÃ¡c bá»™ tÄƒng tá»‘c hiá»‡n Ä‘áº¡i nhÆ° GPU, lÃ m cho toÃ n bá»™ quÃ¡ trÃ¬nh sinh ra khÃ´ng hiá»‡u quáº£ vÃ  tá»‘n thá»i gian.

*Ba tÃ¡c giáº£ nÃ y Ä‘Ã³ng gÃ³p ngang nhau cho dá»± Ã¡n nÃ y.
â€ LiÃªn há»‡: Di He < dihe@pku.edu.cn >.

Má»™t hÆ°á»›ng gáº§n Ä‘Ã¢y trong viá»‡c tÄƒng tá»‘c sinh LLM lÃ  giáº£m sá»‘ lÆ°á»£ng quÃ¡ trÃ¬nh chuyá»ƒn tiáº¿p vá»›i LLM trong khi Ä‘áº£m báº£o cháº¥t lÆ°á»£ng cá»§a chuá»—i Ä‘áº§u ra Ä‘á»“ng thá»i. Giáº£i mÃ£ suy Ä‘oÃ¡n (Leviathan et al., 2023; Chen et al., 2023; Miao et al., 2023; Spector and Re, 2023) lÃ  má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p Ä‘iá»ƒn hÃ¬nh theo hÆ°á»›ng nÃ y. Theo trá»±c giÃ¡c, cÃ¡c phÆ°Æ¡ng phÃ¡p giáº£i mÃ£ suy Ä‘oÃ¡n táº­n dá»¥ng má»™t LM nhá» Ä‘á»ƒ sinh ra cÃ¡c token vá»›i chi phÃ­ tÃ­nh toÃ¡n Ã­t hÆ¡n. Trong quÃ¡ trÃ¬nh suy luáº­n, phÆ°Æ¡ng phÃ¡p Ä‘áº§u tiÃªn sá»­ dá»¥ng LM nhá» Ä‘á»ƒ táº¡o ra má»™t chuá»—i token nhÃ¡p vÃ  sau Ä‘Ã³ sá»­ dá»¥ng LLM Ä‘á»ƒ xÃ¡c minh. Náº¿u dá»± Ä‘oÃ¡n tá»« cáº£ hai mÃ´ hÃ¬nh nháº¥t quÃ¡n, chÃºng ta cÃ³ thá»ƒ cháº¥p nháº­n báº£n nhÃ¡p vÃ  tráº£ vá» cho ngÆ°á»i dÃ¹ng. á» Ä‘Ã¢y, viá»‡c sinh token thá»±c táº¿ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng LM nhá», vÃ  LM lá»›n chá»‰ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c nháº­n báº£n nhÃ¡p, cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n song song vÃ  chá»‰ yÃªu cáº§u táº£i láº¡i bá»™ nhá»› má»™t láº§n. Do Ä‘Ã³, toÃ n bá»™ khung cá»§a giáº£i mÃ£ suy Ä‘oÃ¡n giáº£m chi phÃ­ suy luáº­n tá»•ng thá»ƒ.

Tuy nhiÃªn, viá»‡c cÃ³ Ä‘Æ°á»£c má»™t mÃ´ hÃ¬nh nhÃ¡p cháº¥t lÆ°á»£ng cao váº«n lÃ  thÃ¡ch thá»©c: NÃ³ pháº£i cÃ¢n báº±ng giá»¯a kÃ­ch thÆ°á»›c nhá» vÃ  sá»©c máº¡nh dá»± Ä‘oÃ¡n máº¡nh máº½ trong khi khá»›p vá»›i tá»« vá»±ng cá»§a mÃ´ hÃ¬nh cÆ¡ sá»Ÿ; ngoÃ i ra, nÃ³ cÅ©ng nÃªn tÃ­ch há»£p tá»‘t vÃ o há»‡ thá»‘ng phÃ¢n tÃ¡n Ä‘á»ƒ phá»¥c vá»¥. Do Ä‘Ã³, má»i ngÆ°á»i thÆ°á»ng cáº§n Ä‘Ã o táº¡o má»™t mÃ´ hÃ¬nh nhÃ¡p cá»¥ thá»ƒ cho mÃ´ hÃ¬nh vÃ  trÆ°á»ng há»£p sá»­ dá»¥ng cá»§a há» (Chen et al., 2023; Miao et al., 2023; Cai et al., 2023).

Trong nghiÃªn cá»©u nÃ y, thay vÃ¬ dá»±a vÃ o má»™t LM nhá» bá»• sung, chÃºng tÃ´i Ä‘iá»u tra viá»‡c sá»­ dá»¥ng má»™t kho dá»¯ liá»‡u trá»±c tiáº¿p Ä‘á»ƒ xÃ¢y dá»±ng chuá»—i token nhÃ¡p trong giáº£i mÃ£ suy Ä‘oÃ¡n. ChÃºng tÃ´i phÃ¡t triá»ƒn má»™t phÆ°Æ¡ng phÃ¡p dá»±a trÃªn truy xuáº¥t, Ä‘Æ°á»£c gá»i lÃ  Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t (REST) (HÃ¬nh 1). So vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p trÆ°á»›c Ä‘Ã¢y, há»‡ thá»‘ng dá»±a trÃªn truy xuáº¥t cá»§a chÃºng tÃ´i thay tháº¿ mÃ´ hÃ¬nh nhÃ¡p tham sá»‘ báº±ng má»™t kho dá»¯ liá»‡u truy xuáº¥t khÃ´ng tham sá»‘, cÃ³ thá»ƒ dá»… dÃ ng chuyá»ƒn Ä‘á»•i sang báº¥t ká»³ LLM nÃ o vÃ  tÄƒng tá»‘c suy luáº­n cá»§a nÃ³.

Äá»ƒ sá»­ dá»¥ng REST, bÆ°á»›c Ä‘áº§u tiÃªn lÃ  xÃ¢y dá»±ng kho dá»¯ liá»‡u. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i táº­n dá»¥ng kho dá»¯ liá»‡u tiá»n Ä‘Ã o táº¡o hoáº·c kho dá»¯ liá»‡u Ä‘iá»u chá»‰nh hÆ°á»›ng dáº«n arXiv:2311.08252v2 [cs.CL] 4 Apr 2024

--- TRANG 2 ---
Ä‘á»ƒ xÃ¢y dá»±ng kho dá»¯ liá»‡u cá»§a chÃºng tÃ´i, phá»¥c vá»¥ nhÆ° nguá»“n cho chuá»—i token nhÃ¡p. Trong má»—i bÆ°á»›c suy luáº­n, Ä‘áº§u tiÃªn chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c token trÆ°á»›c Ä‘Ã³ (token Ä‘Æ°á»£c sinh trÆ°á»›c hoáº·c token gá»£i Ã½) lÃ m truy váº¥n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh khá»›p chÃ­nh xÃ¡c trong kho dá»¯ liá»‡u. CÃ¡c token tiáº¿p theo tá»« nhá»¯ng khá»›p chÃ­nh xÃ¡c nÃ y Ä‘Æ°á»£c coi lÃ  cÃ¡c á»©ng viÃªn sinh. Má»™t Trie Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c á»©ng viÃªn nÃ y. CÃ¡c nÃºt cÃ³ táº§n suáº¥t cao nháº¥t Ä‘Æ°á»£c chá»n lÃ m token nhÃ¡p. Chuá»—i nÃ y sau Ä‘Ã³ tráº£i qua xÃ¡c minh bá»Ÿi LLM thÃ´ng qua má»™t láº§n chuyá»ƒn tiáº¿p duy nháº¥t, Ä‘Æ°á»£c há»— trá»£ bá»Ÿi má»™t máº·t náº¡ chÃº Ã½ Ä‘Æ°á»£c thiáº¿t káº¿ tá»‰ má»‰ Ä‘Æ°á»£c gá»i lÃ  chÃº Ã½ cÃ¢y (Cai et al., 2023; Miao et al., 2023; Spector and Re, 2023). VÃ¬ nhiá»u chuá»—i con trong quÃ¡ trÃ¬nh sinh cÃ³ thá»ƒ xuáº¥t hiá»‡n trong kho dá»¯ liá»‡u, REST cÃ³ thá»ƒ thÆ°á»ng xuyÃªn sinh ra nhiá»u token Ä‘Ãºng má»—i bÆ°á»›c.

ChÃºng tÃ´i tiáº¿n hÃ nh cÃ¡c thÃ­ nghiá»‡m rá»™ng rÃ£i Ä‘á»ƒ kiá»ƒm tra hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t cá»§a REST trong cÃ¡c tÃ¬nh huá»‘ng khÃ¡c nhau. Äá»‘i vá»›i lÄ©nh vá»±c mÃ£, chÃºng tÃ´i sá»­ dá»¥ng má»™t pháº§n mÃ£ tiá»n Ä‘Ã o táº¡o Python (2.7M máº«u) tá»« The Stack (Kocetkov et al., 2022) lÃ m kho dá»¯ liá»‡u vÃ  tÄƒng tá»‘c CodeLlama (RoziÃ¨re et al., 2023) 7B vÃ  13B tÆ°Æ¡ng á»©ng. Káº¿t quáº£ cho tháº¥y trÃªn HumanEval (Chen et al., 2021) REST Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c 2.12Ã— Ä‘áº¿n 2.36Ã—. Äá»‘i vá»›i lÄ©nh vá»±c tá»•ng quÃ¡t, chÃºng tÃ´i xÃ¢y dá»±ng má»™t kho dá»¯ liá»‡u sá»­ dá»¥ng UltraChat (Ding et al., 2023), chá»©a khoáº£ng 774K cuá»™c há»™i thoáº¡i. Káº¿t quáº£ cho tháº¥y trÃªn MT-Bench (Zheng et al., 2023) REST tÄƒng tá»‘c 7B vÃ  13B Vicuna (Chiang et al., 2023) láº§n lÆ°á»£t 1.62Ã— Ä‘áº¿n 1.77Ã—.

2 NghiÃªn cá»©u liÃªn quan
Cáº£i thiá»‡n hiá»‡u quáº£ suy luáº­n LLM Ä‘Ã£ trá»Ÿ thÃ nh má»™t hÆ°á»›ng nghiÃªn cá»©u má»›i ná»•i trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y. NÃ³i chung, cÃ¡c ná»— lá»±c trÆ°á»›c Ä‘Ã¢y cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh hai loáº¡i: tÄƒng tá»‘c khÃ´ng máº¥t mÃ¡t vÃ  tÄƒng tá»‘c cÃ³ máº¥t mÃ¡t. CÃ¡c phÆ°Æ¡ng phÃ¡p tÄƒng tá»‘c cÃ³ máº¥t mÃ¡t nháº±m há»c cÃ¡c mÃ´ hÃ¬nh hiá»‡u quáº£ cÃ³ thá»ƒ thá»±c thi nhanh hÆ¡n vÃ  hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° LLM má»¥c tiÃªu. Nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y bao gá»“m cáº¯t tá»‰a (Wang et al., 2021; Hubara et al., 2021; Ma et al., 2023; Frantar and Alistarh, 2023), lÆ°á»£ng tá»­ hÃ³a (Yao et al., 2022; Park et al., 2022; Dettmers et al., 2022; Frantar et al., 2022; Xiao et al., 2023; Liu et al., 2023) vÃ  chÆ°ng cáº¥t kiáº¿n thá»©c (Sanh et al., 2019). CÃ¡c chiáº¿n lÆ°á»£c tÄƒng tá»‘c khÃ´ng máº¥t mÃ¡t táº­p trung vÃ o viá»‡c tÄƒng tá»‘c trá»±c tiáº¿p LLM má»¥c tiÃªu tá»« cÃ¡c gÃ³c Ä‘á»™ khÃ¡c nhau, cháº³ng háº¡n nhÆ° tá»‘i Æ°u hÃ³a bá»™ nhá»› vÃ  IO (Dao et al., 2022; Dao, 2023; Kwon et al., 2023; Sheng et al., 2023), vÃ  cÃ¡c cÃ¡ch Ä‘á»ƒ giáº£m lá»‡nh gá»i hÃ m cá»§a LLM trong quÃ¡ trÃ¬nh giáº£i mÃ£, vÃ­ dá»¥: giáº£i mÃ£ suy Ä‘oÃ¡n (Stern et al., 2018; Leviathan et al., 2023; Chen et al., 2023; Miao et al., 2023; Spector and Re, 2023; Cai et al., 2023). CÃ´ng trÃ¬nh nÃ y thuá»™c nhÃ¡nh thá»© hai. Giáº£i mÃ£ suy Ä‘oÃ¡n (Leviathan et al., 2023; Chen et al., 2023; Miao et al., 2023; Spector and Re, 2023) táº­n dá»¥ng má»™t mÃ´ hÃ¬nh nhá» hÆ¡n Ä‘á»ƒ sinh ra báº£n nhÃ¡p vÃ  sá»­ dá»¥ng LLM Ä‘á»ƒ xÃ¡c minh cÃ¡c token nhÃ¡p vá»›i má»™t láº§n chuyá»ƒn tiáº¿p duy nháº¥t. Trong khung nÃ y, giáº£i mÃ£ song song theo khá»‘i (Stern et al., 2018) vÃ  Medusa (Cai et al., 2023) Ä‘Ã o táº¡o nhiá»u Ä‘áº§u dá»±a trÃªn LLM Ä‘á»ƒ sinh token nhÃ¡p.

PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i khÃ¡c biá»‡t vá»›i nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y báº±ng cÃ¡ch truy xuáº¥t token nhÃ¡p tá»« kho dá»¯ liá»‡u, trÃ¬nh bÃ y má»™t con Ä‘Æ°á»ng má»›i cho cáº£i thiá»‡n hiá»‡u quáº£ trong sinh mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. Máº·c dÃ¹ cÃ³ má»™t nghiÃªn cá»©u tÆ°Æ¡ng tá»±, LLMA (Yang et al., 2023), sá»­ dá»¥ng truy xuáº¥t Ä‘á»ƒ tÄƒng tá»‘c sinh, cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i phÃ¢n biá»‡t mÃ¬nh theo hai cÃ¡ch chÃ­nh: (1) PhÆ°Æ¡ng phÃ¡p LLMA Ä‘Æ°á»£c thiáº¿t káº¿ cho cÃ¡c tÃ¬nh huá»‘ng mÃ  ngá»¯ cáº£nh Ä‘Æ°á»£c tham chiáº¿u (nhÆ° trong Sinh TÄƒng cÆ°á»ng Truy xuáº¥t vÃ  Sinh Há»— trá»£ Bá»™ Ä‘á»‡m) Ä‘Æ°á»£c cung cáº¥p trong quÃ¡ trÃ¬nh sinh, vÃ  nÃ³ chá»‰ truy xuáº¥t tá»« nhá»¯ng ngá»¯ cáº£nh Ä‘Æ°á»£c tham chiáº¿u nÃ y. NgÆ°á»£c láº¡i, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i truy xuáº¥t token nhÃ¡p tá»« má»™t kho dá»¯ liá»‡u toÃ n diá»‡n, do Ä‘Ã³ khÃ´ng bá»‹ giá»›i háº¡n trong má»™t ngá»¯ cáº£nh nhá». (2) Trong khung LLMA, thá»±c thá»ƒ Ä‘Æ°á»£c truy xuáº¥t thÆ°á»ng Ä‘Æ°á»£c giá»›i háº¡n trong má»™t hoáº·c má»™t sá»‘ Ã­t. Tuy nhiÃªn, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ má»™t sá»‘ lÆ°á»£ng thá»±c thá»ƒ Ä‘Æ°á»£c truy xuáº¥t lá»›n hÆ¡n nhiá»u. Sá»± khÃ¡c biá»‡t trong phÆ°Æ¡ng phÃ¡p nÃ y cho phÃ©p chÃºng tÃ´i táº­n dá»¥ng cÆ¡ sá»Ÿ thÃ´ng tin rá»™ng hÆ¡n trong quÃ¡ trÃ¬nh sinh.

3 Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t
Trong pháº§n nÃ y, Ä‘áº§u tiÃªn chÃºng tÃ´i cung cáº¥p kÃ½ hiá»‡u vÃ  tá»•ng quan ná»n táº£ng vá» giáº£i mÃ£ suy Ä‘oÃ¡n vÃ  sau Ä‘Ã³ giá»›i thiá»‡u khung REST Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i.

3.1 Ná»n táº£ng: Giáº£i MÃ£ Suy ÄoÃ¡n
ChÃºng tÃ´i sá»­ dá»¥ng xâˆˆ V Ä‘á»ƒ biá»ƒu thá»‹ má»™t token trong Ä‘Ã³ V lÃ  tá»« vá»±ng. Táº¡i má»—i bÆ°á»›c thá»i gian t, cho ngá»¯ cáº£nh trÆ°á»›c Ä‘Ã³ s= (x1, ..., xtâˆ’1, xt), phÆ°Æ¡ng phÃ¡p giáº£i mÃ£ tá»± há»“i quy sinh ra token táº¡i vá»‹ trÃ­ t+ 1 theo:
xt+1âˆ¼p(x|x1, . . . , xt;Î¸large),
trong Ä‘Ã³ p(Â·) lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n Ä‘Æ°á»£c tÃ­nh bá»Ÿi LLM vá»›i tham sá»‘ Î¸large. Trong quÃ¡ trÃ¬nh nÃ y, má»™t láº§n cháº¡y chuyá»ƒn tiáº¿p cá»§a LLM Ä‘Æ°á»£c yÃªu cáº§u táº¡i má»—i bÆ°á»›c sinh. Äiá»u nÃ y tá»‘n thá»i gian Ä‘Ã¡ng ká»ƒ do bÄƒng thÃ´ng bá»™ nhá»›

--- TRANG 3 ---
f = lambda num: [i for i â¬… ğŸ“Input Ngá»¯ cáº£nh Ä‘Æ°á»£c truy xuáº¥t
numbers = [â€¦] \n for i
dictionary = {â€¦} \n for i
import math \n for i
numbers = [â€¦] \n for i
file = open(â€¦) \n for i
def sorted_c(â€¦)\n for i Pháº§n tiáº¿p theo
in range(
, item in
in range(
in sorted(
in range(
in sorted Gá»‘c 3
2 in Trie cá»§a
Pháº§n tiáº¿p theo
1,1
1 sorted 3 range (
(
_
1 item
in 5
1 BÆ°á»›c 1: Truy xuáº¥t tÃ i liá»‡u BÆ°á»›c 2: XÃ¢y dá»±ng Trie
âœ”
âœ”âœ”
âœ”âœ”
âœ”âœ”âœ” in
range
sorted
( ChÃº Ã½ CÃ¢y BÆ°á»›c 3: XÃ¡c minh á»©ng viÃªn
Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t (REST) ğŸ“œ á»¨ng viÃªn
in
in range âœ…
âœ…âœ…
âŒ in range(
in sorted

HÃ¬nh 1: Tá»•ng quan vá» REST. Trong quÃ¡ trÃ¬nh suy luáº­n, ngá»¯ cáº£nh Ä‘áº§u vÃ o Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m truy váº¥n Ä‘á»ƒ truy xuáº¥t tÃ i liá»‡u tá»« kho dá»¯ liá»‡u khá»›p vá»›i háº­u tá»‘ dÃ i nháº¥t cá»§a Ä‘áº§u vÃ o. Má»™t Trie Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c pháº§n tiáº¿p theo tá»« cÃ¡c tÃ i liá»‡u Ä‘Æ°á»£c truy xuáº¥t. ChÃºng tÃ´i cáº¯t tá»‰a cÃ¡c nhÃ¡nh cÃ³ táº§n suáº¥t tháº¥p (trá»ng sá»‘) vÃ  cÃ¢y con cÃ²n láº¡i Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m á»©ng viÃªn. CÃ¡c á»©ng viÃªn sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o LLM vá»›i máº·t náº¡ chÃº Ã½ cÃ¢y Ä‘á»ƒ xÃ¡c minh. Táº¥t cáº£ token Ä‘Ãºng tá»« Ä‘áº§u sáº½ Ä‘Æ°á»£c cháº¥p nháº­n, vÃ  cÃ¡c token nhÃ¡p sau lá»—i Ä‘áº§u tiÃªn sáº½ bá»‹ tá»« chá»‘i.

vÃ  khÃ´ng thá»ƒ khai thÃ¡c Ä‘áº§y Ä‘á»§ sá»©c máº¡nh tÃ­nh toÃ¡n cá»§a pháº§n cá»©ng GPU hiá»‡n Ä‘áº¡i (Shazeer, 2019).

Giáº£i mÃ£ suy Ä‘oÃ¡n nháº±m giáº£m chi phÃ­ tÃ­nh toÃ¡n trong quÃ¡ trÃ¬nh suy luáº­n báº±ng cÃ¡ch giáº£m sá»‘ láº§n thá»±c thi vá»›i Î¸large. NgoÃ i LLM Î¸large, giáº£i mÃ£ suy Ä‘oÃ¡n táº­n dá»¥ng má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ khÃ¡c cÃ³ kÃ­ch thÆ°á»›c nhá» hÆ¡n nhiá»u vá»›i tham sá»‘ Î¸small. Táº¡i bÆ°á»›c t, phÆ°Æ¡ng phÃ¡p hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch thá»±c hiá»‡n láº·p Ä‘i láº·p láº¡i cÃ¡c bÆ°á»›c sau.

XÃ¢y dá»±ng báº£n nhÃ¡p Cho s= (x1, . . . , xt), LM nhá» Î¸small Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sinh ra m token tiáº¿p theo Ëœxt+1, . . . , Ëœxt+m theo cÃ¡ch tá»± há»“i quy:
Ëœxt+iâˆ¼p(x|s,Ëœxt+1, . . . , Ëœxt+iâˆ’1;Î¸small),
trong Ä‘Ã³ i= 1, . . . , m.

Máº·c dÃ¹ cÃ¡c token váº«n Ä‘Æ°á»£c sinh tá»«ng cÃ¡i má»™t, chi phÃ­ tÃ­nh toÃ¡n cá»§a quÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c giáº£m vÃ¬ nÃ³ sá»­ dá»¥ng Î¸small thay vÃ¬ Î¸large.

XÃ¡c minh báº£n nhÃ¡p Sau khi cÃ¡c token nhÃ¡p Ëœxt+1, . . . , Ëœxt+m Ä‘Æ°á»£c sinh ra, chÃºng Ä‘Æ°á»£c Ä‘Æ°a vÃ o LLM cÃ¹ng vá»›i ngá»¯ cáº£nh s. LLM Î¸large sau Ä‘Ã³ tÃ­nh cÃ¡c xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n vá»›i má»™t láº§n chuyá»ƒn tiáº¿p duy nháº¥t:
p(x|s;Î¸large),
p(x|s,Ëœxt+1;Î¸large),
. . .
p(x|s,Ëœxt+1, . . . , Ëœxt+mâˆ’1;Î¸large).

Cháº¥p nháº­n báº£n nhÃ¡p Báº¯t Ä‘áº§u tá»« token Ä‘Æ°á»£c sinh Ä‘áº§u tiÃªn trong báº£n nhÃ¡p, xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n rÃºt ra tá»« Î¸small Ä‘Æ°á»£c so sÃ¡nh vá»›i cá»§a Î¸large. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng láº¥y máº«u tá»« chá»‘i Ä‘Ã£ sá»­a Ä‘á»•i Ä‘á»ƒ khá»›p phÃ¢n phá»‘i Ä‘Æ°á»£c sinh vá»›i LLM (Leviathan et al., 2023; Chen et al., 2023). Äá»‘i vá»›i vá»‹ trÃ­ t+i, Ä‘áº§u tiÃªn chÃºng ta láº¥y máº«u má»™t giÃ¡ trá»‹ r tá»« phÃ¢n phá»‘i Ä‘á»u U(0,1). Náº¿u r <min 1,p(x|s,Ëœxt+1,...,Ëœxt+iâˆ’1;Î¸large) p(x|s,Ëœxt+1,...,Ëœxt+iâˆ’1;Î¸small), chÃºng ta cháº¥p nháº­n token nhÃ¡p Ëœxt+i vÃ  tiáº¿p tá»¥c xÃ¡c nháº­n token tiáº¿p theo Ëœxt+i+1. NgÆ°á»£c láº¡i, chÃºng ta dá»«ng quÃ¡ trÃ¬nh cháº¥p nháº­n, láº¥y máº«u láº¡i xt+i, tá»« chá»‘i táº¥t cáº£ token nhÃ¡p sau xt+i, vÃ  chuyá»ƒn sang quÃ¡ trÃ¬nh giáº£i mÃ£ suy Ä‘oÃ¡n má»›i táº¡i vá»‹ trÃ­ t+i+ 1.

3.2 PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i: REST
Trong khi trong giáº£i mÃ£ suy Ä‘oÃ¡n cá»• Ä‘iá»ƒn, má»™t LM nhá» hÆ¡n Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m mÃ´ hÃ¬nh nhÃ¡p, viá»‡c tÃ¬m má»™t mÃ´ hÃ¬nh nhÃ¡p cháº¥t lÆ°á»£ng cao thÆ°á»ng lÃ  thÃ¡ch thá»©c vÃ¬ má»™t sá»‘ lÃ½ do: (1) Äá»ƒ hiá»‡u quáº£, mÃ´ hÃ¬nh nhÃ¡p cáº§n Ä‘á»§ nháº¹ Ä‘á»ƒ khÃ´ng gÃ¢y ra nhiá»u chi phÃ­. (2) Äá»ƒ cháº¥t lÆ°á»£ng, nÃ³ cáº§n dá»± Ä‘oÃ¡n Ä‘áº§u ra LLM má»™t cÃ¡ch chÃ­nh xÃ¡c. (3) Äá»ƒ tÃ­ch há»£p há»‡ thá»‘ng, nÃ³ cáº§n cÃ¹ng bá»™ tá»« vá»±ng vá»›i LLM, vÃ  má»™t kiáº¿n trÃºc phÃ¢n phá»‘i dá»… dÃ ng vá»›i cáº¥u hÃ¬nh tÆ°Æ¡ng tá»± nhÆ° LLM (Chen et al., 2023). Nhá»¯ng thÃ¡ch thá»©c nÃ y Ä‘Ã²i há»i viá»‡c lá»±a chá»n cáº©n tháº­n hoáº·c tháº­m chÃ­ Ä‘Ã o táº¡o cÃ¡c mÃ´ hÃ¬nh nhÃ¡p tÃ¹y chá»‰nh cho má»—i LLM má»›i.

Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i giáº£i quyáº¿t cÃ¡c thÃ¡ch thá»©c theo cÃ¡ch khÃ¡c. ChÃºng tÃ´i phÃ¡t triá»ƒn má»™t phÆ°Æ¡ng phÃ¡p khÃ´ng cáº§n Ä‘Ã o táº¡o cho giáº£i mÃ£ suy Ä‘oÃ¡n

--- TRANG 4 ---
mÃ  cÃ³ thá»ƒ dá»… dÃ ng tÃ­ch há»£p vá»›i báº¥t ká»³ mÃ´ hÃ¬nh má»›i nÃ o Ä‘á»ƒ tÄƒng tá»‘c suy luáº­n. Thay vÃ¬ dá»±a vÃ o mÃ´ hÃ¬nh nhÃ¡p tham sá»‘, phÆ°Æ¡ng phÃ¡p Giáº£i MÃ£ Suy ÄoÃ¡n Dá»±a TrÃªn Truy Xuáº¥t (REST) cá»§a chÃºng tÃ´i Ä‘á» xuáº¥t sá»­ dá»¥ng truy xuáº¥t Ä‘á»ƒ xÃ¢y dá»±ng báº£n nhÃ¡p. Tá»•ng quan vá» REST Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 1. Trong pháº§n sau, Ä‘áº§u tiÃªn chÃºng tÃ´i mÃ´ táº£ viá»‡c xÃ¢y dá»±ng kho dá»¯ liá»‡u vÃ  cÃ¡c thao tÃ¡c trÃªn Ä‘Ã³, sau Ä‘Ã³ trÃ¬nh bÃ y viá»‡c sá»­ dá»¥ng nÃ³ Ä‘á»ƒ xÃ¢y dá»±ng vÃ  xÃ¡c minh báº£n nhÃ¡p. CÃ¹ng nhau, REST cung cáº¥p má»™t giáº£i phÃ¡p hiá»‡u quáº£, cháº¥t lÆ°á»£ng cao vÃ  dá»… tÃ­ch há»£p Ä‘á»ƒ tÄƒng tá»‘c suy luáº­n cá»§a LLM.

XÃ¢y dá»±ng kho dá»¯ liá»‡u REST hoáº¡t Ä‘á»™ng dá»±a trÃªn kho dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng sáºµn D={(ci, ti)}, trong Ä‘Ã³ ci Ä‘áº¡i diá»‡n cho má»™t ngá»¯ cáº£nh vÃ  ti Ä‘áº¡i diá»‡n cho pháº§n tiáº¿p theo tÆ°Æ¡ng á»©ng cá»§a ngá»¯ cáº£nh ci. Cho má»™t kho dá»¯ liá»‡u vÄƒn báº£n/mÃ£, chÃºng tÃ´i xÃ¢y dá»±ng kho dá»¯ liá»‡u D sá»­ dá»¥ng ngá»¯ cáº£nh tiá»n tá»‘ vÃ  pháº§n tiáº¿p theo tÆ°Æ¡ng á»©ng táº¡i má»—i vá»‹ trÃ­.

Truy xuáº¥t tá»« kho dá»¯ liá»‡u Trong suy luáº­n, cho má»™t ngá»¯ cáº£nh s= (x1, . . . , xt), má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  xÃ¢y dá»±ng cÃ¡c token nhÃ¡p cÃ³ kháº£ nÄƒng lÃ  pháº§n tiáº¿p theo cá»§a s. KhÃ¡c vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n vanilla sá»­ dá»¥ng LM nhá» Ä‘á»ƒ xÃ¢y dá»±ng báº£n nhÃ¡p, chÃºng tÃ´i táº­n dá»¥ng kho dá»¯ liá»‡u Ä‘Æ°á»£c xÃ¢y dá»±ng D vÃ  trá»±c tiáº¿p truy xuáº¥t token nhÃ¡p tá»« kho dá»¯ liá»‡u. Äáº§u tiÃªn chÃºng tÃ´i sá»­ dá»¥ng ngá»¯ cáº£nh s Ä‘á»ƒ truy xuáº¥t cÃ¡c cáº·p ngá»¯ cáº£nh-pháº§n tiáº¿p theo tá»« kho dá»¯ liá»‡u D vÃ  xÃ¢y dá»±ng má»™t táº­p há»£p cÃ¡c á»©ng viÃªn tiáº¿p theo S:
S={ti|(ci, ti)âˆˆRetrieve (D, s)},
trong Ä‘Ã³ Retrieve (D, s) thá»±c hiá»‡n má»™t quÃ¡ trÃ¬nh truy xuáº¥t trong kho dá»¯ liá»‡u D tráº£ vá» má»™t táº­p há»£p cÃ¡c cáº·p ngá»¯ cáº£nh-pháº§n tiáº¿p theo {(ci, ti)} báº±ng cÃ¡ch sá»­ dá»¥ng s lÃ m truy váº¥n.

Viá»‡c sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh truy xuáº¥t dÃ y Ä‘áº·c gáº§n Ä‘Ã¢y (Khandelwal et al., 2020; Karpukhin et al., 2020) Ä‘á»ƒ tÃ¬m ngá»¯ cáº£nh ci tÆ°Æ¡ng tá»± vá»›i s lÃ  Ä‘Æ¡n giáº£n. Tuy nhiÃªn, viá»‡c sá»­ dá»¥ng bá»™ truy xuáº¥t dÃ y Ä‘áº·c thÃªm chi phÃ­ bá»• sung trong quÃ¡ trÃ¬nh suy luáº­n. ChÃºng tÃ´i thay vÃ o Ä‘Ã³ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p khá»›p chÃ­nh xÃ¡c nhanh Ä‘á»ƒ truy xuáº¥t cÃ¡c á»©ng viÃªn tiáº¿p theo. QuÃ¡ trÃ¬nh truy xuáº¥t cá»§a chÃºng tÃ´i Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Thuáº­t toÃ¡n 1. ChÃºng tÃ´i nháº±m tÃ¬m cÃ¡c ngá»¯ cáº£nh trong D khá»›p vá»›i háº­u tá»‘ dÃ i nháº¥t cá»§a s. ChÃºng tÃ´i sá»­ dá»¥ng chiáº¿n lÆ°á»£c tham lam vÃ  báº¯t Ä‘áº§u tá»« giá»›i háº¡n trÃªn Ä‘á»™ dÃ i khá»›p Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c nmax. Äá»‘i vá»›i má»—i Ä‘á»™ dÃ i háº­u tá»‘ n, chÃºng tÃ´i láº¥y háº­u tá»‘ cá»§a ngá»¯ cáº£nh s vá»›i n token q (dÃ²ng 5), vÃ  láº¥y táº¥t cáº£ ngá»¯ cáº£nh ci khá»›p vá»›i q nhÆ° má»™t háº­u tá»‘ (dÃ²ng 6). Náº¿u Ã­t nháº¥t má»™t ngá»¯ cáº£nh trong D khá»›p vá»›i q hiá»‡n táº¡i (tá»©c lÃ  SÌ¸=âˆ…), chÃºng tÃ´i tráº£ vá» cÃ¡c cáº·p ngá»¯ cáº£nh-pháº§n tiáº¿p theo tÆ°Æ¡ng á»©ng lÃ m káº¿t quáº£ truy xuáº¥t; ngÆ°á»£c láº¡i chÃºng tÃ´i giáº£m Ä‘á»™ dÃ i khá»›p n Ä‘i má»™t vÃ  cá»‘ gáº¯ng khá»›p háº­u tá»‘ ngáº¯n hÆ¡n (dÃ²ng 7). ChÃºng tÃ´i sá»­ dá»¥ng máº£ng háº­u tá»‘ (Manber and Myers, 1993) Ä‘á»ƒ thá»±c hiá»‡n khá»›p chÃ­nh xÃ¡c hiá»‡u quáº£ trong kho dá»¯ liá»‡u D cho má»™t q cho trÆ°á»›c. QuÃ¡ trÃ¬nh truy xuáº¥t dáº«n Ä‘áº¿n chi phÃ­ khÃ´ng Ä‘Ã¡ng ká»ƒ (<6%) trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i (xem chi tiáº¿t trong Pháº§n 5).

Thuáº­t toÃ¡n 1 Thuáº­t toÃ¡n truy xuáº¥t dá»±a trÃªn khá»›p chÃ­nh xÃ¡c
Retrieve (D, s). ChÃºng tÃ´i tráº£ vá» cÃ¡c cáº·p ngá»¯ cáº£nh-pháº§n tiáº¿p theo trong D khá»›p vá»›i háº­u tá»‘ dÃ i nháº¥t cá»§a s.
1:Äáº§u vÃ o: Ngá»¯ cáº£nh s, kho dá»¯ liá»‡u D, Ä‘á»™ dÃ i háº­u tá»‘ tá»‘i Ä‘a nmax
2:Khá»Ÿi táº¡o nâ†nmax
3:Khá»Ÿi táº¡o Sâ† âˆ…
4:while S=âˆ…do
5: qâ†suffix (s, n)
6: Sâ† {(ci, ti)|q=suffix (ci, n)} âŠ†D
7: nâ†nâˆ’1
8:end while
9:return S

XÃ¢y dá»±ng báº£n nhÃ¡p tá»« káº¿t quáº£ truy xuáº¥t Káº¿t quáº£ truy xuáº¥t S bao gá»“m cÃ¡c pháº§n tiáº¿p theo cÃ³ thá»ƒ cÃ³ cá»§a ngá»¯ cáº£nh s. Äá»‘i vá»›i má»—i tiâˆˆS, báº¥t ká»³ tiá»n tá»‘ nÃ o cá»§a ti cÃ³ thá»ƒ phá»¥c vá»¥ nhÆ° token nhÃ¡p cá»§a s trong giáº£i mÃ£ suy Ä‘oÃ¡n vÃ  Ä‘Æ°á»£c xÃ¡c minh thÃªm bá»Ÿi LLM. LÆ°u Ã½ ráº±ng táº­p há»£p cÃ¡c á»©ng viÃªn tiáº¿p theo Ä‘Æ°á»£c truy xuáº¥t S cÃ³ thá»ƒ lá»›n. Viá»‡c sá»­ dá»¥ng táº¥t cáº£ á»©ng viÃªn lÃ m token nhÃ¡p vÃ  Ä‘Æ°a chÃºng vÃ o LLM Ä‘á»ƒ xÃ¡c minh lÃ  khÃ´ng kháº£ thi. á» Ä‘Ã¢y chÃºng tÃ´i trÃ¬nh bÃ y cÃ¡ch chá»n token nhÃ¡p cháº¥t lÆ°á»£ng cao tá»« táº­p há»£p Ä‘Æ°á»£c truy xuáº¥t S. Má»™t chiáº¿n lÆ°á»£c ngÃ¢y thÆ¡ lÃ  láº¥y máº«u má»™t táº­p con chuá»—i trong S lÃ m token nhÃ¡p. Tuy nhiÃªn, Ä‘iá»u nÃ y khÃ´ng tá»‘i Æ°u vÃ¬ viá»‡c láº¥y máº«u chá»©a tÃ­nh ngáº«u nhiÃªn khi S lá»›n.

ChÃºng tÃ´i chá»n token nhÃ¡p tá»« káº¿t quáº£ truy xuáº¥t S sá»­ dá»¥ng Trie. Trong Trie, Ä‘Æ°á»ng dáº«n duy nháº¥t tá»« má»™t nÃºt Ä‘áº¿n nÃºt gá»‘c tÆ°Æ¡ng á»©ng vá»›i má»™t tiá»n tá»‘ cá»§a tiâˆˆS. Äá»‘i vá»›i má»—i nÃºt, chÃºng tÃ´i gÃ¡n má»™t trá»ng sá»‘ pháº£n Ã¡nh sá»‘ lÆ°á»£ng (táº§n suáº¥t) cá»§a tiá»n tá»‘ tÆ°Æ¡ng á»©ng xuáº¥t hiá»‡n trong cÃ¡c á»©ng viÃªn Ä‘Æ°á»£c truy xuáº¥t. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Thuáº­t toÃ¡n 2, Ä‘áº§u tiÃªn chÃºng tÃ´i xÃ¢y dá»±ng má»™t Trie sá»­ dá»¥ng táº¥t cáº£ chuá»—i trong S, vÃ  trá»ng sá»‘ nÃºt Ä‘Æ°á»£c cáº­p nháº­t khi má»™t á»©ng viÃªn ti Ä‘Æ°á»£c chÃ¨n vÃ o Trie (dÃ²ng 2-7). Cáº¥u trÃºc dá»¯ liá»‡u Trie cho phÃ©p chÃºng tÃ´i Æ°u tiÃªn token sá»­ dá»¥ng trá»ng sá»‘ vÃ  chá»n cÃ¡c tiá»n tá»‘ táº§n suáº¥t cao (dÃ²ng 8-15). Trong viá»‡c thá»±c hiá»‡n thá»±c táº¿, chÃºng tÃ´i chá»n má»™t cÃ¢y con chá»©a c nÃºt hÃ ng Ä‘áº§u vá»›i trá»ng sá»‘ cao nháº¥t,

ChÃºng tÃ´i Ä‘áº·t nmax lÃ  16 trong cÃ¡c thÃ­ nghiá»‡m, vÃ¬ chá»‰ cÃ³ vÃ i trÆ°á»ng há»£p dáº«n Ä‘áº¿n khá»›p tá»‘i Ä‘a vá»›i hÆ¡n 16 token.

--- TRANG 5 ---
tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c chá»n c tiá»n tá»‘ táº§n suáº¥t cao hÃ ng Ä‘áº§u lÃ m chuá»—i nhÃ¡p.

Thuáº­t toÃ¡n 2 Lá»±a chá»n chuá»—i nhÃ¡p sá»­ dá»¥ng Trie.
1:Äáº§u vÃ o: á»¨ng viÃªn Tiáº¿p theo S, siÃªu tham sá»‘ c
2:Khá»Ÿi táº¡o Trie T
3:foreach tiâˆˆS do
4: foreach tiá»n tá»‘ cá»§a ti do
5: ChÃ¨n tiá»n tá»‘ vÃ o T vÃ  cáº­p nháº­t trá»ng sá»‘ nÃºt
6: end for
7:end for
8:Khá»Ÿi táº¡o hÃ ng Ä‘á»£i Æ°u tiÃªn trá»‘ng Q (Max Heap dá»±a trÃªn trá»ng sá»‘ nÃºt)
9:foreach nÃºt trong T do
10: ThÃªm (node.prefix, node.weight) vÃ o Q
11:end for
12:while Q.size > c do
13: Láº¥y ra tiá»n tá»‘ cÃ³ trá»ng sá»‘ nhá» nháº¥t tá»« Q
14:end while
15:return Q

XÃ¡c minh báº£n nhÃ¡p cá»§a REST Trong REST, nhiá»u chuá»—i nhÃ¡p cÃ³ thá»ƒ Ä‘Æ°á»£c truy xuáº¥t tá»« kho dá»¯ liá»‡u. Máº·c dÃ¹ ban Ä‘áº§u cÃ³ thá»ƒ tiáº¿p cáº­n cÃ¡c báº£n nhÃ¡p má»™t cÃ¡ch Ä‘á»™c láº­p vÃ  Ä‘Æ°a chÃºng vÃ o LLM nhÆ° cÃ¡c chuá»—i riÃªng biá»‡t trong má»™t batch, quan sÃ¡t thá»±c táº¿ cho tháº¥y nhiá»u báº£n nhÃ¡p chia sáº» tiá»n tá»‘ chung. Äiá»u nÃ y dáº«n Ä‘áº¿n tÃ­nh toÃ¡n dÆ° thá»«a cá»§a cÃ¡c lá»›p Transformer trÃªn nhá»¯ng tiá»n tá»‘ chia sáº» nÃ y qua cÃ¡c chuá»—i khÃ¡c nhau, dáº«n Ä‘áº¿n lÃ£ng phÃ­ sá»©c máº¡nh tÃ­nh toÃ¡n. Äá»ƒ tá»‘i Æ°u hÃ³a hiá»‡u quáº£, chÃºng tÃ´i xÃ¢y dá»±ng má»™t chuá»—i giáº£ tá»« cÃ¢y con sá»­ dá»¥ng tÃ¬m kiáº¿m theo chiá»u rá»™ng Ä‘áº§u tiÃªn. Theo Ä‘á»‹nh nghÄ©a, cÃ³ thá»ƒ ngay láº­p tá»©c thu Ä‘Æ°á»£c ráº±ng má»—i báº£n nhÃ¡p táº¡o thÃ nh má»™t chuá»—i con cá»§a chuá»—i giáº£ nÃ y, vÃ  báº¥t ká»³ tiá»n tá»‘ chia sáº» nÃ o chá»‰ xuáº¥t hiá»‡n má»™t láº§n. Äá»ƒ thá»±c hiá»‡n chÃ­nh xÃ¡c LLM trÃªn chuá»—i giáº£ nÃ y, chÃºng tÃ´i thá»±c hiá»‡n má»™t máº·t náº¡ chÃº Ã½ Ä‘Æ°á»£c thiáº¿t káº¿ cáº©n tháº­n trong má»—i lá»›p chÃº Ã½, Ä‘áº£m báº£o ráº±ng viá»‡c tÃ­nh toÃ¡n cá»§a má»—i token pháº£n Ã¡nh chÃ­nh xÃ¡c cÃ¡c phá»¥ thuá»™c cá»§a nÃ³ trong chuá»—i nhÃ¡p gá»‘c. Chiáº¿n lÆ°á»£c chÃº Ã½ nÃ y cÅ©ng Ä‘Æ°á»£c gá»i lÃ  chÃº Ã½ cÃ¢y (Cai et al., 2023; Miao et al., 2023; Spector and Re, 2023).

Cháº¥p nháº­n báº£n nhÃ¡p cá»§a REST ChÃºng tÃ´i Ã¡p dá»¥ng chiáº¿n lÆ°á»£c cháº¥p nháº­n Ä‘Æ¡n giáº£n hÆ¡n so vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n gá»‘c. Báº±ng cÃ¡ch Ä‘Æ°a cÃ¡c báº£n nhÃ¡p vÃ o LLM, chÃºng tÃ´i thu Ä‘Æ°á»£c phÃ¢n phá»‘i cÃ³ Ä‘iá»u kiá»‡n táº¡i má»—i vá»‹ trÃ­ Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi Î¸large, nÆ¡i chÃºng tÃ´i láº¥y máº«u token má»›i. Sau Ä‘Ã³ chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ liá»‡u token má»›i Ä‘Æ°á»£c láº¥y máº«u cÃ³ trÃ¹ng vá»›i token nhÃ¡p táº¡i má»—i vá»‹ trÃ­ hay khÃ´ng. Táº¥t cáº£ token nhÃ¡p Ä‘Ãºng tá»« Ä‘áº§u sáº½ Ä‘Æ°á»£c cháº¥p nháº­n, vÃ  cÃ¡c token nhÃ¡p sau lá»—i Ä‘áº§u tiÃªn sáº½ bá»‹ tá»« chá»‘i. Báº±ng cÃ¡ch nÃ y, cÃ¡c chuá»—i Ä‘Æ°á»£c táº¡o ra báº±ng REST giá»‘ng há»‡t vá»›i nhá»¯ng chuá»—i Ä‘Æ°á»£c sinh bá»Ÿi sinh tá»± há»“i quy tiÃªu chuáº©n.

So sÃ¡nh vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p hiá»‡n táº¡i Máº·c dÃ¹ REST tuÃ¢n theo lÆ°á»£c Ä‘á»“ tÆ°Æ¡ng tá»± nhÆ° cá»§a giáº£i mÃ£ suy Ä‘oÃ¡n, nÃ³ cung cáº¥p nhá»¯ng lá»£i tháº¿ Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p hiá»‡n táº¡i. CÃ¡c phÆ°Æ¡ng phÃ¡p giáº£i mÃ£ suy Ä‘oÃ¡n hiá»‡n táº¡i dá»±a vÃ o má»™t mÃ´ hÃ¬nh nhá» cháº¥t lÆ°á»£ng cao Ä‘á»ƒ sinh token nhÃ¡p (Leviathan et al., 2023; Chen et al., 2023). Nhá»¯ng phÆ°Æ¡ng phÃ¡p nhÆ° váº­y pháº£i cÃ¢n báº±ng giá»¯a kÃ­ch thÆ°á»›c nhá» vÃ  sá»©c máº¡nh dá»± Ä‘oÃ¡n máº¡nh máº½, Ä‘á»“ng thá»i cÅ©ng khá»›p vá»›i tá»« vá»±ng cá»§a mÃ´ hÃ¬nh cÆ¡ sá»Ÿ. HÆ¡n ná»¯a, chÃºng yÃªu cáº§u bá»™ nhá»› GPU bá»• sung vÃ  gÃ¢y ra Ä‘á»™ phá»©c táº¡p trong quÃ¡ trÃ¬nh suy luáº­n. NgÆ°á»£c láº¡i, REST trá»±c tiáº¿p truy xuáº¥t token nhÃ¡p tá»« kho dá»¯ liá»‡u, cÃ³ thá»ƒ dá»… dÃ ng tÃ­ch há»£p vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ cÃ³ báº¥t ká»³ kÃ­ch thÆ°á»›c, tá»« vá»±ng hoáº·c kiáº¿n trÃºc nÃ o. KhÃ¡c vá»›i Stern et al. (2018) vÃ  Cai et al. (2023) Ä‘Ã o táº¡o cÃ¡c mÃ´-Ä‘un chuyÃªn biá»‡t Ä‘á»ƒ táº¡o ra mÃ´ hÃ¬nh nhÃ¡p, REST loáº¡i bá» nhu cáº§u vá» báº¥t ká»³ bÆ°á»›c Ä‘Ã o táº¡o bá»• sung nÃ o vÃ  cÃ³ thá»ƒ phá»¥c vá»¥ nhÆ° má»™t giáº£i phÃ¡p cáº¯m-vÃ -cháº¡y Ä‘á»ƒ giáº£i mÃ£ hiá»‡u quáº£ qua cÃ¡c mÃ´ hÃ¬nh khÃ¡c nhau. HÆ¡n ná»¯a, hiá»‡u quáº£ cá»§a REST bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi cháº¥t lÆ°á»£ng káº¿t quáº£ truy xuáº¥t. Äiá»u nÃ y má»Ÿ ra cÆ¡ há»™i Ä‘á»ƒ nÃ¢ng cao hÆ¡n ná»¯a REST báº±ng cÃ¡ch sá»­ dá»¥ng kho dá»¯ liá»‡u tá»‘t hÆ¡n/lá»›n hÆ¡n hoáº·c mÃ´ hÃ¬nh truy xuáº¥t tiÃªn tiáº¿n. ChÃºng tÃ´i cÅ©ng lÆ°u Ã½ ráº±ng ngoÃ i viá»‡c sá»­ dá»¥ng REST trá»±c tiáº¿p, cÃ³ thá»ƒ káº¿t há»£p REST vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n vanilla. Sá»± káº¿t há»£p nÃ y cÃ³ thá»ƒ nÃ¢ng cao tá»‘c Ä‘á»™ sinh cá»§a LM nhá». ChÃºng tÃ´i Ä‘á»ƒ dÃ nh Ä‘iá»u nÃ y cho cÃ´ng viá»‡c tÆ°Æ¡ng lai.

4 ThÃ­ nghiá»‡m
4.1 Thiáº¿t láº­p ThÃ­ nghiá»‡m
Chiáº¿n lÆ°á»£c láº¥y máº«u ChÃºng tÃ´i thá»±c hiá»‡n hai cÆ¡ cháº¿ láº¥y máº«u: láº¥y máº«u tham lam vÃ  láº¥y máº«u nhÃ¢n (Holtzman et al., 2019) cho LLM. Láº¥y máº«u tham lam chá»n token cÃ³ xÃ¡c suáº¥t cao nháº¥t táº¡i má»—i bÆ°á»›c. Láº¥y máº«u nhÃ¢n, cÃ²n Ä‘Æ°á»£c gá»i lÃ  láº¥y máº«u top-p, sinh token báº±ng cÃ¡ch láº¥y máº«u tá»« cÃ¡c token cÃ³ kháº£ nÄƒng nháº¥t trong phÃ¢n phá»‘i dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh cho Ä‘áº¿n khi xÃ¡c suáº¥t tÃ­ch lÅ©y cá»§a chÃºng Ä‘áº¡t ngÆ°á»¡ng p. ÄÃ¡ng chÃº Ã½ ráº±ng theo phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i, chÃºng tÃ´i chá»‰ cháº¥p nháº­n token nhÃ¡p náº¿u chÃºng khá»›p vá»›i token Ä‘Æ°á»£c láº¥y máº«u tá»«

--- TRANG 6 ---
LLM. Do Ä‘Ã³, cÃ¡c chuá»—i Ä‘Æ°á»£c táº¡o ra báº±ng REST giá»‘ng há»‡t vá»›i nhá»¯ng chuá»—i Ä‘Æ°á»£c sinh bá»Ÿi sinh tá»± há»“i quy tiÃªu chuáº©n.

Táº­p dá»¯ liá»‡u vÃ  mÃ´ hÃ¬nh ChÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m trÃªn hai táº­p dá»¯ liá»‡u: HumanEval (Chen et al., 2021) vÃ  MT-Bench (Zheng et al., 2023). HumanEval lÃ  má»™t táº­p dá»¯ liá»‡u bao gá»“m 164 bÃ i toÃ¡n láº­p trÃ¬nh Python Ä‘Æ°á»£c viáº¿t bá»Ÿi con ngÆ°á»i. Má»¥c tiÃªu cho cÃ¡c mÃ´ hÃ¬nh lÃ  sinh ra giáº£i phÃ¡p mÃ£ sá»­ dá»¥ng docstring Ä‘Æ°á»£c cung cáº¥p lÃ m gá»£i Ã½. Máº·t khÃ¡c, MT-Bench chá»©a 80 cÃ¢u há»i nhiá»u lÆ°á»£t Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ mÃ´ phá»ng cÃ¡c cuá»™c Ä‘á»‘i thoáº¡i nhiá»u lÆ°á»£t tháº¿ giá»›i thá»±c. ChÃºng tÃ´i so sÃ¡nh tá»‘c Ä‘á»™ sinh cá»§a sinh tá»± há»“i quy tiÃªu chuáº©n vá»›i REST, táº­p trung vÃ o cáº£ táº­p dá»¯ liá»‡u HumanEval vÃ  MT-Bench. Äá»‘i vá»›i HumanEval, chÃºng tÃ´i thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡ 1-shot cho láº¥y máº«u tham lam vÃ  Ä‘Ã¡nh giÃ¡ 10-shot cho láº¥y máº«u nhÃ¢n vÃ  sá»­ dá»¥ng CodeLlama (RoziÃ¨re et al., 2023). Trong khi Ä‘á»‘i vá»›i MT-Bench, chÃºng tÃ´i thá»±c hiá»‡n Ä‘Ã¡nh giÃ¡ 1-shot cho cáº£ láº¥y máº«u tham lam vÃ  láº¥y máº«u nhÃ¢n vÃ  sá»­ dá»¥ng Vicuna (Chiang et al., 2023). ChÃºng tÃ´i kiá»ƒm tra cáº£ cáº¥u hÃ¬nh 7B vÃ  13B cá»§a CodeLlama vÃ  Vicuna, vá»›i giá»›i háº¡n sinh tá»‘i Ä‘a lÃ  512 token vÃ  1024 token tÆ°Æ¡ng á»©ng. Táº¥t cáº£ thÃ­ nghiá»‡m Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn má»™t GPU NVIDIA A6000 vÃ  96 lÃµi CPU. Táº¥t cáº£ káº¿t quáº£ Ä‘Æ°á»£c láº¥y trung bÃ¬nh qua ba láº§n cháº¡y khÃ¡c nhau.

SiÃªu tham sá»‘ Khi thá»±c hiá»‡n khá»›p chÃ­nh xÃ¡c trong kho dá»¯ liá»‡u, Ä‘á»™ dÃ i háº­u tá»‘ ngá»¯ cáº£nh báº¯t Ä‘áº§u, nmax, Ä‘Æ°á»£c Ä‘áº·t lÃ  16, vÃ  Ä‘Æ°á»£c giáº£m dáº§n Ä‘i má»™t cho Ä‘áº¿n khi chÃºng tÃ´i tÃ¬m tháº¥y ngá»¯ cáº£nh khá»›p trong kho dá»¯ liá»‡u. Äá»™ dÃ i cá»§a má»—i á»©ng viÃªn tiáº¿p theo Ä‘Æ°á»£c truy xuáº¥t Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  m, Ä‘Æ°á»£c cáº¯t ngáº¯n thÃ nh 10. Káº¿t quáº£ thá»±c nghiá»‡m tá»« Medusa (Cai et al., 2023) Ä‘á» xuáº¥t 64 token nhÃ¡p lÃ  cáº¥u hÃ¬nh tÃ­nh toÃ¡n tá»‘i Æ°u. Do Ä‘Ã³, chÃºng tÃ´i giá»›i háº¡n sá»‘ lÆ°á»£ng token nhÃ¡p Ä‘Æ°á»£c chá»n tá»‘i Ä‘a trong Trie Ä‘Æ°á»£c xÃ¢y dá»±ng thÃ nh 64, Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  c.

Thang Ä‘o Thang Ä‘o Ä‘áº§u tiÃªn chÃºng tÃ´i sá»­ dá»¥ng lÃ  Thá»i gian Token Trung bÃ¬nh, lÃ  thá»i gian sinh trung bÃ¬nh cá»§a má»™t token cho LLM. Thang Ä‘o khÃ¡c, Äá»™ dÃ i Sinh Trung bÃ¬nh, Ä‘Æ°á»£c tÃ­nh nhÆ° tá»· lá»‡ giá»¯a Ä‘á»™ dÃ i cá»§a cÃ¡c token Ä‘Æ°á»£c sinh vÃ  sá»‘ bÆ°á»›c chuyá»ƒn tiáº¿p Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi LLM gá»‘c. ChÃ­nh thá»©c, náº¿u L biá»ƒu thá»‹ Ä‘á»™ dÃ i cá»§a cÃ¡c token Ä‘Æ°á»£c sinh vÃ  F Ä‘áº¡i diá»‡n cho sá»‘ bÆ°á»›c chuyá»ƒn tiáº¿p, Äá»™ dÃ i Sinh Trung bÃ¬nh, M, Ä‘Æ°á»£c Ä‘Æ°a ra bá»Ÿi:
M=L/F.

LÆ°u Ã½ ráº±ng Äá»™ dÃ i Sinh Trung bÃ¬nh (M) hoáº¡t Ä‘á»™ng nhÆ° giá»›i háº¡n trÃªn cá»§a tÄƒng tá»‘c mÃ  REST cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c, bá» qua chi phÃ­ cho viá»‡c truy xuáº¥t vÃ  xÃ¢y dá»±ng token nhÃ¡p.

Kho dá»¯ liá»‡u Äá»‘i vá»›i CodeLlama, chÃºng tÃ´i xÃ¢y dá»±ng kho dá»¯ liá»‡u sá»­ dá»¥ng má»™t pháº§n mÃ£ tiá»n Ä‘Ã o táº¡o Python tá»« The Stack (Kocetkov et al., 2022). Táº­p dá»¯ liá»‡u nÃ y bao gá»“m khoáº£ng 2.7M máº«u mÃ£ Python vÃ  dáº«n Ä‘áº¿n kho dá»¯ liá»‡u cÃ³ kÃ­ch thÆ°á»›c 27GB. Máº·t khÃ¡c, Ä‘á»‘i vá»›i Vicuna, chÃºng tÃ´i xÃ¢y dá»±ng kho dá»¯ liá»‡u sá»­ dá»¥ng dá»¯ liá»‡u rÃºt ra tá»« UltraChat (Ding et al., 2023). Táº­p dá»¯ liá»‡u nÃ y bao gá»“m khoáº£ng 774K cuá»™c há»™i thoáº¡i tá»« ChatGPT, táº¡o ra kho dá»¯ liá»‡u cÃ³ kÃ­ch thÆ°á»›c 12GB.

Baseline ChÃºng tÃ´i thá»±c hiá»‡n giáº£i mÃ£ suy Ä‘oÃ¡n (Leviathan et al., 2023; Chen et al., 2023) lÃ m baseline Ä‘á»ƒ so sÃ¡nh. Äá»‘i vá»›i cÃ¡c LM nhÃ¡p nhá», chÃºng tÃ´i kiá»ƒm tra nhiá»u kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh khÃ¡c nhau, bao gá»“m Llama 68M vÃ  Llama 160M Ä‘Æ°á»£c Ä‘Ã o táº¡o bá»Ÿi Miao et al. (2023), TinyLlama 1.1B vÃ  TinyLlama-Chat 1.1B Ä‘Æ°á»£c Ä‘Ã o táº¡o bá»Ÿi Zhang et al. (2023). ChÃºng tÃ´i cÅ©ng kiá»ƒm tra sá»‘ lÆ°á»£ng token nhÃ¡p khÃ¡c nhau tá»« 1 Ä‘áº¿n 15 (hiá»‡u suáº¥t giáº£m khi lá»›n hÆ¡n 15).

4.2 Káº¿t quáº£ ChÃ­nh
Báº£ng 1 so sÃ¡nh tá»‘c Ä‘á»™ sinh cá»§a REST vá»›i tá»‘c Ä‘á»™ cá»§a giáº£i mÃ£ tá»± há»“i quy tiÃªu chuáº©n vÃ  giáº£i mÃ£ suy Ä‘oÃ¡n.

Vá» tá»‘c Ä‘á»™ sinh, REST thá»ƒ hiá»‡n sá»± nÃ¢ng cao tá»‘c Ä‘á»™ Ä‘Ã¡ng ká»ƒ so vá»›i giáº£i mÃ£ tá»± há»“i quy tiÃªu chuáº©n vÃ  giáº£i mÃ£ suy Ä‘oÃ¡n, Ä‘áº¡t Ä‘Æ°á»£c tÄƒng 2.16Ã— Ä‘áº¿n 2.36Ã— cho CodeLlama trong benchmark HumanEval. Benchmark MT-Bench cÅ©ng cho tháº¥y tÄƒng tá»‘c cho Vicuna khi sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i, vá»›i há»‡ sá»‘ tá»« 1.62Ã— Ä‘áº¿n 1.77Ã—. Nhá»¯ng káº¿t quáº£ thá»±c nghiá»‡m nÃ y lÃ m tÄƒng trá»ng lÆ°á»£ng cho hiá»‡u quáº£ cá»§a phÆ°Æ¡ng phÃ¡p chÃºng tÃ´i trong viá»‡c tÄƒng tá»‘c quÃ¡ trÃ¬nh sinh cá»§a LLM. LÆ°u Ã½ ráº±ng tÄƒng tá»‘c cá»§a láº¥y máº«u nhÃ¢n khÃ´ng tá»‘t báº±ng cá»§a láº¥y máº«u tham lam. ChÃºng tÃ´i suy Ä‘oÃ¡n ráº±ng sá»± giáº£m hiá»‡u suáº¥t nÃ y Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi tÃ­nh ngáº«u nhiÃªn Ä‘Æ°á»£c giá»›i thiá»‡u bá»Ÿi láº¥y máº«u nhÃ¢n. VÃ¬ giáº£i mÃ£ suy Ä‘oÃ¡n cÃ³ thá»ƒ Ä‘áº¡t káº¿t quáº£ tá»‘t hÆ¡n vá»›i LM nhÃ¡p máº¡nh hÆ¡n phÃ¹ há»£p vá»›i LLM, chÃºng tÃ´i khÃ´ng tuyÃªn bá»‘ ráº±ng REST cÃ³ thá»ƒ vÆ°á»£t trá»™i hÆ¡n giáº£i mÃ£ suy Ä‘oÃ¡n trong má»i hoÃ n cáº£nh. Tuy nhiÃªn, REST cháº¯c cháº¯n cung cáº¥p má»™t phÆ°Æ¡ng phÃ¡p máº¡nh máº½ vÃ  Ä‘Æ¡n giáº£n cho suy luáº­n nhanh hÆ¡n cá»§a LLM.

Má»™t quan sÃ¡t thÃº vá»‹ khÃ¡c ná»•i lÃªn tá»« nhá»¯ng káº¿t quáº£ nÃ y lÃ  báº£n cháº¥t phá»¥ thuá»™c vÃ o lÄ©nh vá»±c cá»§a cÃ¡c cáº£i thiá»‡n tá»‘c Ä‘á»™. Äáº·c Ä‘iá»ƒm nÃ y cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c ghi nháº­n trong cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhÆ° giáº£i mÃ£ suy Ä‘oÃ¡n (Chen et al., 2023) vÃ  Medusa (Cai et al., 2023). Cá»¥ thá»ƒ, tÄƒng tá»‘c Ä‘áº¡t Ä‘Æ°á»£c vá»›i REST lá»›n hÆ¡n Ä‘Ã¡ng ká»ƒ trong benchmark HumanEval so vá»›i benchmark MT-Bench, cho tháº¥y ráº±ng hiá»‡u quáº£ cá»§a REST cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y thuá»™c vÃ o lÄ©nh vá»±c cá»¥ thá»ƒ.

NgoÃ i ra, Ä‘iá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  thá»i gian trung bÃ¬nh (chia cho tá»•ng sá»‘ token) cáº§n thiáº¿t cho truy xuáº¥t (bao gá»“m thá»i gian Ä‘á»ƒ xÃ¢y dá»±ng Trie) lÃ  dÆ°á»›i 1 ms. Thá»i gian nÃ y ráº¥t nhá» vÃ  cÃ³ thá»ƒ, cho táº¥t cáº£ má»¥c Ä‘Ã­ch thá»±c táº¿, Ä‘Æ°á»£c coi lÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ. Thá»i gian truy xuáº¥t khÃ´ng Ä‘Ã¡ng ká»ƒ nÃ y cÃ ng nháº¥n máº¡nh hiá»‡u quáº£ cá»§a REST.

5 NghiÃªn cá»©u Khá»­ bá»
Äá»ƒ hiá»ƒu sÃ¢u hÆ¡n vá» phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i, chÃºng tÃ´i tiáº¿n hÃ nh má»™t loáº¡t nghiÃªn cá»©u khá»­ bá» vÃ  phÃ¢n tÃ­ch táº­p trung vÃ o tá»«ng thÃ nh pháº§n riÃªng láº». Nhiá»u nghiÃªn cá»©u khá»­ bá» khÃ¡c cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c B.

https://chat.openai.com/

--- TRANG 7 ---
[Báº£ng 1: Tá»‘c Ä‘á»™ trÃªn HumanEval vÃ  MT-Bench vá»›i giáº£i mÃ£ tá»± há»“i quy tiÃªu chuáº©n, giáº£i mÃ£ suy Ä‘oÃ¡n vÃ  REST. Nhiá»‡t Ä‘á»™ Ä‘Æ°á»£c Ä‘áº·t lÃ  0.8 vÃ  top-p lÃ  0.95 cho láº¥y máº«u nhÃ¢n trong HumanEval. Äá»‘i vá»›i MT-Bench, cÃ¡c thiáº¿t láº­p lÃ  0.7 cho nhiá»‡t Ä‘á»™ vÃ  0.8 cho top-p. Äá»‘i vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n, chÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m sá»­ dá»¥ng sá»‘ lÆ°á»£ng token nhÃ¡p khÃ¡c nhau vÃ  LM nhá» khÃ¡c nhau vÃ  ghi láº¡i káº¿t quáº£ tá»‘t nháº¥t (káº¿t quáº£ chi tiáº¿t cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c A). Táº¥t cáº£ thÃ­ nghiá»‡m Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn má»™t GPU NVIDIA A6000 vÃ  96 lÃµi CPU vá»›i kÃ­ch thÆ°á»›c batch lÃ  1.]

áº¢nh hÆ°á»Ÿng cá»§a kÃ­ch thÆ°á»›c kho dá»¯ liá»‡u TÄƒng kÃ­ch thÆ°á»›c kho dá»¯ liá»‡u lÃ  má»™t chiáº¿n lÆ°á»£c hiá»‡u quáº£ Ä‘á»ƒ nÃ¢ng cao Ä‘á»™ chÃ­nh xÃ¡c cá»§a token nhÃ¡p Ä‘Æ°á»£c truy xuáº¥t trong Trie, Ä‘iá»u nÃ y cÃ³ thá»ƒ tÄƒng Ä‘Ã¡ng ká»ƒ tá»‘c Ä‘á»™ sinh. Trong Báº£ng 2, chÃºng tÃ´i cho tháº¥y khi kÃ­ch thÆ°á»›c kho dá»¯ liá»‡u tÄƒng, cáº£ Äá»™ dÃ i Sinh Trung bÃ¬nh vÃ  Thá»i gian Token Trung bÃ¬nh Ä‘á»u cáº£i thiá»‡n tÆ°Æ¡ng á»©ng. Tuy nhiÃªn, Ä‘iá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  tÄƒng trÆ°á»Ÿng tÄƒng tá»‘c khÃ´ng rÃµ rÃ ng nhÆ° cá»§a Äá»™ dÃ i Sinh Trung bÃ¬nh. Sá»± khÃ¡c biá»‡t nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c quy cho chi phÃ­ cá»§a viá»‡c láº¥y token nhÃ¡p. ChÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng trong cÃ¡c á»©ng dá»¥ng cÃ´ng nghiá»‡p, sáº½ cÃ³ Ä‘á»§ lÆ°u trá»¯ Ä‘Ä©a Ä‘á»ƒ xÃ¢y dá»±ng kho dá»¯ liá»‡u lá»›n vÃ  Ä‘á»§ lÃµi CPU cho truy xuáº¥t nhanh. ChÃºng tÃ´i cÅ©ng trá»±c quan hÃ³a xu hÆ°á»›ng má»Ÿ rá»™ng kÃ­ch thÆ°á»›c kho dá»¯ liá»‡u truy xuáº¥t trong HÃ¬nh 2. Tá»« Ä‘Ã³, chÃºng tÃ´i cÃ³ thá»ƒ suy ra ráº±ng váº«n cÃ²n tiá»m nÄƒng Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ tháº­m chÃ­ nhanh hÆ¡n vá»›i kho dá»¯ liá»‡u lá»›n hÆ¡n.

áº¢nh hÆ°á»Ÿng cá»§a chiáº¿n lÆ°á»£c lá»±a chá»n token nhÃ¡p ChÃºng tÃ´i so sÃ¡nh viá»‡c lá»±a chá»n token nhÃ¡p trong Trie vá»›i viá»‡c láº¥y máº«u ngáº«u nhiÃªn cÃ¡c á»©ng viÃªn tiáº¿p theo Ä‘Æ°á»£c truy xuáº¥t lÃ m token nhÃ¡p. Äá»ƒ so sÃ¡nh cÃ´ng báº±ng, chÃºng tÃ´i sá»­ dá»¥ng ká»¹ thuáº­t láº¥y máº«u ngáº«u nhiÃªn Ä‘á»ƒ láº¥y máº«u nhiá»u nháº¥t tÃ¡m chuá»—i tá»« táº¥t cáº£ á»©ng viÃªn Ä‘Æ°á»£c truy xuáº¥t. HÆ¡n ná»¯a, má»—i chuá»—i Ä‘Æ°á»£c cáº¯t ngáº¯n Ä‘áº¿n Ä‘á»™ dÃ i tá»‘i Ä‘a lÃ  8. Äiá»u nÃ y dáº«n Ä‘áº¿n sá»‘ lÆ°á»£ng token nhÃ¡p tá»‘i Ä‘a lÃ  64, tÆ°Æ¡ng á»©ng vá»›i sá»‘ lÆ°á»£ng token nhÃ¡p Ä‘Æ°á»£c chá»n tá»‘i Ä‘a tá»« Trie. Dá»¯ liá»‡u Ä‘Æ°á»£c trÃ¬nh bÃ y trong Báº£ng 3 cho tháº¥y viá»‡c lá»±a chá»n token nhÃ¡p tá»« Trie, trÃ¡i ngÆ°á»£c vá»›i viá»‡c sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p láº¥y máº«u ngáº«u nhiÃªn, nÃ¢ng cao hiá»‡u suáº¥t.

áº¢nh hÆ°á»Ÿng cá»§a lá»±a chá»n Ä‘á»™ dÃ i háº­u tá»‘ tá»‘i Ä‘a ChÃºng tÃ´i thay Ä‘á»•i giÃ¡ trá»‹ cá»§a nmax Ä‘á»ƒ kiá»ƒm tra tá»‘c Ä‘á»™ sinh cá»§a REST. Káº¿t quáº£ cá»§a nghiÃªn cá»©u nÃ y Ä‘Æ°á»£c mÃ´ táº£ trong HÃ¬nh 3. Má»™t quan sÃ¡t thÃº vá»‹ lÃ  khi giÃ¡ trá»‹ cá»§a nmax Ä‘Æ°á»£c Ä‘áº·t dÆ°á»›i 6, cÃ³ sá»± tÄƒng Ä‘Ã¡ng ká»ƒ trong thá»i gian sinh. NgÆ°á»£c láº¡i, khi nmax vÆ°á»£t quÃ¡ 6, tá»‘c Ä‘á»™ sinh váº«n luÃ´n cao vÃ  dÆ°á»ng nhÆ° pháº§n lá»›n khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi nhá»¯ng thay Ä‘á»•i thÃªm vÃ o giÃ¡ trá»‹ nmax. Do Ä‘Ã³, trong thá»±c táº¿, khÃ´ng cÃ³ nhu cáº§u Ä‘Ã¡ng ká»ƒ Ä‘á»ƒ dÃ nh quÃ¡ nhiá»u ná»— lá»±c trong viá»‡c lá»±a chá»n giÃ¡ trá»‹ tá»‘i Æ°u chÃ­nh xÃ¡c cá»§a nmax.

6 Káº¿t luáº­n
Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t REST: giáº£i mÃ£ suy Ä‘oÃ¡n dá»±a trÃªn truy xuáº¥t. Thay vÃ¬ yÃªu cáº§u má»™t LM nhá», REST sá»­ dá»¥ng kho dá»¯ liá»‡u Ä‘á»ƒ truy xuáº¥t vÃ  sá»­ dá»¥ng token nhÃ¡p. ChÃºng tÃ´i xÃ¢y dá»±ng Trie Ä‘á»ƒ chá»n cÃ¡c token nhÃ¡p cÃ³ kháº£ nÄƒng nháº¥t. REST khÃ´ng chá»‰ Ä‘Æ¡n giáº£n Ä‘á»ƒ thá»±c hiá»‡n mÃ  cÃ²n dá»… dÃ ng tÃ­ch há»£p vÃ o quÃ¡ trÃ¬nh sinh cá»§a báº¥t ká»³ mÃ´ hÃ¬nh ngÃ´n ngá»¯ hiá»‡n táº¡i nÃ o mÃ  khÃ´ng cáº§n Ä‘Ã o táº¡o thÃªm. ChÃºng tÃ´i muá»‘n khÃ¡m phÃ¡ truy xuáº¥t quy mÃ´ lá»›n trong bÆ°á»›c tiáº¿p theo. Äá»‘i vá»›i cÃ¡c tÃ¬nh huá»‘ng mÃ  lÆ°u trá»¯ Ä‘Ä©a bá»‹ háº¡n cháº¿, chÃºng tÃ´i cÅ©ng sáº½ khÃ¡m phÃ¡ cÃ¡c phÆ°Æ¡ng phÃ¡p giáº£m thiá»ƒu kÃ­ch thÆ°á»›c kho dá»¯ liá»‡u mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u suáº¥t.

Háº¡n cháº¿
Nhá»¯ng háº¡n cháº¿ cá»§a cÃ´ng trÃ¬nh chÃºng tÃ´i nhÆ° sau:
â€¢ Máº·c dÃ¹ tÃ­nh cháº¥t cáº¯m-vÃ -cháº¡y cá»§a REST, Ä‘iá»u quan trá»ng cáº§n thá»«a nháº­n ráº±ng hiá»‡u suáº¥t cá»§a REST bá»‹ áº£nh hÆ°á»Ÿng trá»±c tiáº¿p bá»Ÿi Ä‘á»™ chÃ­nh xÃ¡c vÃ  tÃ­nh Ä‘áº§y Ä‘á»§ cá»§a kho dá»¯ liá»‡u. Äá»ƒ cáº£i thiá»‡n sá»± phÃ¹ há»£p vá»›i LLM, cÃ³ thá»ƒ cÃ³ lá»£i khi cÃ¢n nháº¯c xÃ¢y dá»±ng kho dá»¯ liá»‡u tá»« ná»™i dung Ä‘Æ°á»£c sinh bá»Ÿi chÃ­nh LLM.

â€¢ Thiáº¿u kháº£ nÄƒng trong ngá»¯ cáº£nh. VÃ­ dá»¥, thÃ¡ch thá»©c cá»§a viá»‡c truy xuáº¥t tÃªn biáº¿n Ä‘Æ°á»£c cÃ¡ nhÃ¢n hÃ³a trong sinh mÃ£â€”má»™t nhiá»‡m vá»¥ vá»‘n Ä‘Ã²i há»i hiá»ƒu biáº¿t ngá»¯ cáº£nhâ€”Ä‘áº·t ra má»™t cÃ¢u há»i thÃº vá»‹: LÃ m tháº¿ nÃ o chÃºng ta cÃ³ thá»ƒ trao quyá»n cho cÃ¡c phÆ°Æ¡ng phÃ¡p truy xuáº¥t Ä‘á»ƒ xá»­ lÃ½ hiá»‡u quáº£ nhá»¯ng phá»©c táº¡p nhÆ° váº­y?

Lá»i cáº£m Æ¡n
JDL ghi nháº­n sá»± há»— trá»£ cá»§a ARO dÆ°á»›i MURI Award W911NF-11-1-0304, Há»c bá»•ng NghiÃªn cá»©u Sloan, NSF CCF 2002272, NSF IIS 2107304, NSF CIF 2212262, Giáº£i thÆ°á»Ÿng NhÃ  Ä‘iá»u tra Tráº» ONR, vÃ  NSF CAREER Award 2144994. ChÃºng tÃ´i cáº£m Æ¡n táº¥t cáº£ cÃ¡c nhÃ  Ä‘Ã¡nh giÃ¡ áº©n danh vÃ¬ nhá»¯ng Ä‘Ã¡nh giÃ¡ ráº¥t cáº©n tháº­n vÃ  chi tiáº¿t cÅ©ng nhÆ° nhá»¯ng Ä‘á» xuáº¥t cÃ³ giÃ¡ trá»‹. Sá»± giÃºp Ä‘á»¡ cá»§a há» Ä‘Ã£ nÃ¢ng cao hÆ¡n ná»¯a cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i.

[Danh sÃ¡ch tÃ i liá»‡u tham kháº£o vÃ  cÃ¡c phá»¥ lá»¥c tiáº¿p tá»¥c...]
