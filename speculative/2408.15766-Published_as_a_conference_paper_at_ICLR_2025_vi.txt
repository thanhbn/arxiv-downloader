# 2408.15766.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/speculative/2408.15766.pdf
# KÃ­ch thÆ°á»›c file: 603718 bytes

===============================================
Ná»˜I DUNG FILE PDF
===============================================


--- TRANG 1 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
Há»ŒC BIá»‚U DIá»„N HÃ€I HÃ’A CHO
Láº¤Y MáºªU SUY ÄOÃN
Lefan Zhang, Xiaodan Wang, Yanhua Huangâˆ—, Ruiwen Xu
Xiaohongshu Inc.
Shanghai, China
{lefan,xiaodan2,yanhuahuang,ruiwenxu }@xiaohongshu.com
TÃ“M Táº®T
Láº¥y máº«u suy Ä‘oÃ¡n lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘áº§y há»©a háº¹n Ä‘á»ƒ tÄƒng tá»‘c giai Ä‘oáº¡n giáº£i mÃ£
cho cÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n (LLMs). Nhá»¯ng tiáº¿n bá»™ gáº§n Ä‘Ã¢y táº­n dá»¥ng thÃ´ng
tin ngá»¯ cáº£nh cá»§a LLM Ä‘Ã­ch, cháº³ng háº¡n nhÆ° tráº¡ng thÃ¡i áº©n vÃ  KV cache, Ä‘Ã£ cho
tháº¥y nhá»¯ng cáº£i thiá»‡n thá»±c táº¿ Ä‘Ã¡ng ká»ƒ. Tuy nhiÃªn, nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y gáº·p
pháº£i váº¥n Ä‘á» ngá»¯ cáº£nh khÃ´ng nháº¥t quÃ¡n giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£. ChÃºng tÃ´i
cÅ©ng quan sÃ¡t tháº¥y má»™t sá»± khÃ¡c biá»‡t khÃ¡c giá»¯a cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n vÃ  giáº£i
mÃ£ trong cÃ¡c phÆ°Æ¡ng phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n hiá»‡n cÃ³. Trong cÃ´ng trÃ¬nh nÃ y, chÃºng
tÃ´i Ä‘á» xuáº¥t má»™t giáº£i phÃ¡p cÃ³ tÃªn HArmonized Speculative Sampling (HASS) Ä‘á»ƒ
há»c cÃ¡c biá»ƒu diá»…n hÃ i hÃ²a nháº±m giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y. HASS tÄƒng tá»‘c giai
Ä‘oáº¡n giáº£i mÃ£ mÃ  khÃ´ng thÃªm chi phÃ­ suy luáº­n thÃ´ng qua chÆ°ng cáº¥t má»¥c tiÃªu hÃ i
hÃ²a vÃ  cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a. CÃ¡c thÃ­ nghiá»‡m trÃªn bá»‘n mÃ´ hÃ¬nh LLaMA
cho tháº¥y HASS Ä‘áº¡t Ä‘Æ°á»£c tá»‰ lá»‡ tÄƒng tá»‘c thá»i gian thá»±c tá»« 2.81x-4.05x trung bÃ¬nh
trÃªn ba bá»™ dá»¯ liá»‡u, vÆ°á»£t trá»™i hÆ¡n EAGLE-2 tá»« 8%-20%. MÃ£ nguá»“n cÃ³ sáºµn táº¡i
https://github.com/HArmonizedSS/HASS .
1 GIá»šI THIá»†U
CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n sinh (LLMs), cháº³ng háº¡n nhÆ° GPT-4 (Achiam et al., 2023) vÃ  LLaMA (Touvron et al., 2023), Ä‘Ã£ thá»ƒ hiá»‡n kháº£ nÄƒng Ä‘Ã¡ng chÃº Ã½ trÃªn má»™t loáº¡t rá»™ng cÃ¡c nhiá»‡m vá»¥. Tuy nhiÃªn, viá»‡c giáº£i mÃ£ hiá»‡u quáº£ tá»« nhá»¯ng mÃ´ hÃ¬nh nÃ y Ä‘áº·t ra má»™t thÃ¡ch thá»©c Ä‘Ã¡ng ká»ƒ do cÆ¡ cháº¿ giáº£i mÃ£ tá»± há»“i quy vá»‘n cÃ³, Ä‘iá»u nÃ y háº¡n cháº¿ kháº£ nÄƒng á»©ng dá»¥ng cá»§a chÃºng trong cÃ¡c tÃ¬nh huá»‘ng nháº¡y cáº£m vá» thá»i gian.
Láº¥y máº«u suy Ä‘oÃ¡n (Chen et al., 2023; Leviathan et al., 2023) cung cáº¥p má»™t giáº£i phÃ¡p báº±ng cÃ¡ch táº­n dá»¥ng cÃ¡c tÃ i nguyÃªn bá»• sung Ä‘á»ƒ tÄƒng tÃ­nh Ä‘á»“ng thá»i. Cá»¥ thá»ƒ, nÃ³ sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh draft hiá»‡u quáº£ Ä‘á»ƒ táº¡o cÃ¡c token draft má»™t cÃ¡ch tá»± há»“i quy, sau Ä‘Ã³ Ä‘Æ°á»£c xÃ¡c minh Ä‘á»“ng thá»i bá»Ÿi LLM Ä‘Ã­ch. Dá»±a trÃªn káº¿t quáº£ xÃ¡c minh, má»™t táº­p con cÃ¡c token draft báº£o toÃ n cÃ¹ng phÃ¢n phá»‘i vá»›i LLM Ä‘Ã­ch Ä‘Æ°á»£c cháº¥p nháº­n nhÆ° Ä‘áº§u ra cuá»‘i cÃ¹ng.
Leviathan et al. (2023) cho tháº¥y hiá»‡u suáº¥t thá»±c táº¿ cá»§a láº¥y máº«u suy Ä‘oÃ¡n cÃ³ liÃªn quan cháº·t cháº½ Ä‘áº¿n hai yáº¿u tá»‘: chi phÃ­ giáº£i mÃ£ cá»§a mÃ´ hÃ¬nh draft vÃ  sá»± cÄƒn chá»‰nh cá»§a nÃ³ vá»›i LLM Ä‘Ã­ch. Äá»ƒ phÃ¡t triá»ƒn cÃ¡c mÃ´ hÃ¬nh draft hiá»‡u quáº£ Ä‘Æ°á»£c cÄƒn chá»‰nh tá»‘t vá»›i LLM Ä‘Ã­ch, cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y Ä‘á» xuáº¥t táº­n dá»¥ng thÃ´ng tin ngá»¯ cáº£nh cá»§a LLM Ä‘Ã­ch (Xiao et al., 2024; Li et al., 2024b;c; Du et al., 2024). VÃ­ dá»¥, EAGLE (Li et al., 2024b;c) sá»­ dá»¥ng cÃ¡c tráº¡ng thÃ¡i áº©n trÆ°á»›c Ä‘Ã³ cá»§a LLM Ä‘Ã­ch lÃ m Ä‘áº·c trÆ°ng Ä‘áº§u vÃ o cá»§a mÃ´ hÃ¬nh draft. Tuy nhiÃªn, nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y gÃ¢y ra ngá»¯ cáº£nh khÃ´ng nháº¥t quÃ¡n giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£, nhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 2. Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, mÃ´ hÃ¬nh draft luÃ´n cÃ³ quyá»n truy cáº­p vÃ o cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch á»Ÿ cÃ¡c bÆ°á»›c thá»i gian trÆ°á»›c Ä‘Ã³. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh giáº£i mÃ£, mÃ´ hÃ¬nh draft khÃ´ng thá»ƒ truy cáº­p cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch cho cÃ¡c bÆ°á»›c thá»i gian chÆ°a Ä‘Æ°á»£c xÃ¡c minh, dáº«n Ä‘áº¿n sá»± khÃ´ng cÄƒn chá»‰nh ngá»¯ cáº£nh giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£. Váº¥n Ä‘á» nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c xem nhÆ° má»™t dáº¡ng bias phÆ¡i bÃ y (Bengio et al., 2015; Wang & Sennrich, 2020) á»Ÿ cáº¥p Ä‘á»™ Ä‘áº·c trÆ°ng trong láº¥y máº«u suy Ä‘oÃ¡n.
Má»™t sá»± khÃ¡c biá»‡t khÃ¡c cÅ©ng Ä‘Æ°á»£c quan sÃ¡t tháº¥y giá»¯a cÃ¡c má»¥c tiÃªu cá»§a giai Ä‘oáº¡n huáº¥n luyá»‡n vÃ  giáº£i mÃ£. Trong giai Ä‘oáº¡n giáº£i mÃ£, má»¥c tiÃªu cá»§a mÃ´ hÃ¬nh draft lÃ  Ä‘á» xuáº¥t cÃ¡c token mÃ  LLM Ä‘Ã­ch cÃ³ kháº£ nÄƒng gÃ¡n xÃ¡c suáº¥t cao (Li et al., 2024c; Miao et al., 2024; Sun et al., 2024). Trong tÃ¬nh huá»‘ng nÃ y, mÃ´ hÃ¬nh draft nÃªn táº­p trung nhiá»u hÆ¡n vÃ o viá»‡c ghi nhá»› cÃ¡c token mong muá»‘n, trong khi thá»© tá»± cá»¥ thá»ƒ
âˆ—TÃ¡c giáº£ liÃªn há»‡.
1arXiv:2408.15766v3  [cs.LG]  26 Feb 2025

--- TRANG 2 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
LLaMA2-Chat 7B T=0 LLaMA2-Chat 13B T=0 LLaMA3-Instruct 8B T=0 LLaMA3-Instruct 70B T=0 LLaMA2-Chat 7B T=1 LLaMA2-Chat 13B T=1 LLaMA3-Instruct 8B T=1 LLaMA3-Instruct 70B T=1
MÃ´ hÃ¬nh0.00.51.01.52.02.53.03.54.0TÄƒng tá»‘c3.24x3.65x
3.09x4.05x
2.90x3.48x
2.81x3.85x
2.81x3.30x
2.83x3.37x
2.60x3.21x
2.47x3.28x
2.01x2.22x
1.71x2.43x
1.76x2.05x
1.44x2.09xHASS
EAGLE-2
EAGLE
HÃ¬nh 1: Tá»‰ lá»‡ tÄƒng tá»‘c cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhau trÃªn LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}, trung bÃ¬nh trÃªn cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K.
cá»§a nhá»¯ng token nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c nháº¥n máº¡nh Ã­t hÆ¡n. HÆ¡n ná»¯a, háº§u háº¿t cÃ¡c á»©ng dá»¥ng LLM thá»±c hiá»‡n nucleus sampling (Holtzman et al., 2020) hoáº·c top-k sampling (Fan et al., 2018). Äá»‘i vá»›i cÃ¡c má»¥c tiÃªu giáº£i mÃ£ nÃ y, cÃ¡c token cÃ³ xÃ¡c suáº¥t cao Ä‘Ã³ng vai trÃ² quan trá»ng hÆ¡n trong viá»‡c xÃ¡c Ä‘á»‹nh Ä‘áº§u ra. Do Ä‘Ã³, Ä‘á»ƒ phÃ¡t triá»ƒn cÃ¡c mÃ´ hÃ¬nh draft hiá»‡u quáº£, cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n cá»§a chÃºng nÃªn xem xÃ©t nhá»¯ng Ä‘áº·c tÃ­nh nÃ y gáº·p pháº£i trong giai Ä‘oáº¡n giáº£i mÃ£. Theo hiá»ƒu biáº¿t tá»‘t nháº¥t cá»§a chÃºng tÃ´i, cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y vá» huáº¥n luyá»‡n mÃ´ hÃ¬nh draft cho láº¥y máº«u suy Ä‘oÃ¡n pháº§n lá»›n Ä‘Ã£ bá» qua nhá»¯ng cÃ¢n nháº¯c giáº£i mÃ£ nÃ y.
Má»™tLá»›pTá»±Há»“iQuyğ‘’!"#ğ‘“!"$(&)ğ‘’!ğ‘“!"#(&)ğ‘’!(#ğ‘£!"())/ğ‘“!(&)LLMÄÃ­chğ‘“!())ğ‘“!(#())Äáº§uDá»± ÄoÃ¡n&Láº¥yMáº«uğ‘¥!(#ğ‘¥!($
Nháº¥tQuÃ¡ntiáº¿ntrÃ¬nhHuáº¥nLuyá»‡ntiáº¿ntrÃ¬nhGiáº£iMÃ£tiáº¿ntrÃ¬nhTokenchÆ°aÄ‘Æ°á»£cxÃ¡cminh
HÃ¬nh 2: ChÃºng tÃ´i sá»­ dá»¥ng EAGLE (Li et al., 2024b) lÃ m vÃ­ dá»¥ Ä‘á»ƒ minh há»a sá»± khÃ´ng cÄƒn chá»‰nh ngá»¯ cáº£nh, trong Ä‘Ã³ viá»‡c suy Ä‘oÃ¡n báº¯t Ä‘áº§u tá»« bÆ°á»›c thá»i gian t. f(l) vÃ  f(s) Ä‘áº¡i diá»‡n cho cÃ¡c tráº¡ng thÃ¡i áº©n tá»« LLM Ä‘Ã­ch vÃ  mÃ´ hÃ¬nh draft. Khi giáº£i mÃ£ token draft xt+2, ngá»¯ cáº£nh Ä‘áº§u vÃ o khÃ´ng nháº¥t quÃ¡n giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£.Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i giá»›i thiá»‡u HArmonized Speculative Sampling (HASS), má»™t phÆ°Æ¡ng phÃ¡p má»›i Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃªu trÃªn báº±ng cÃ¡ch há»c cÃ¡c biá»ƒu diá»…n hÃ i hÃ²a. Cá»¥ thá»ƒ, Ä‘á»ƒ lÃ m cho cÃ¡c mÃ´ hÃ¬nh draft nháº­n thá»©c vá» chiáº¿n lÆ°á»£c giáº£i mÃ£, HASS má»Ÿ rá»™ng Ã½ tÆ°á»Ÿng chÆ°ng cáº¥t xáº¿p háº¡ng (Tang & Wang, 2018) tá»« há»‡ thá»‘ng gá»£i Ã½ sang láº¥y máº«u suy Ä‘oÃ¡n, dáº«n Ä‘áº¿n má»™t máº¥t mÃ¡t chÆ°ng cáº¥t táº­p trung vÃ o cÃ¡c token cÃ³ kháº£ nÄƒng cao nháº¥t trong phÃ¢n phá»‘i Ä‘Ã­ch. Äá»ƒ giáº£m thiá»ƒu sá»± khÃ´ng cÄƒn chá»‰nh ngá»¯ cáº£nh Ä‘Ã£ tháº£o luáº­n trÆ°á»›c Ä‘Ã¢y giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£, HASS sá»­ dá»¥ng má»™t chiáº¿n lÆ°á»£c huáº¥n luyá»‡n cÄƒn chá»‰nh ngá»¯ cáº£nh. CÃ¹ng nhau, hai chiáº¿n lÆ°á»£c nÃ y cá»§a HASS cáº£i thiá»‡n hiá»‡u suáº¥t tÄƒng tá»‘c mÃ  khÃ´ng cÃ³ báº¥t ká»³ chi phÃ­ suy luáº­n nÃ o vÃ  duy trÃ¬ hiá»‡u quáº£ huáº¥n luyá»‡n.
ChÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m trÃªn cÃ¡c nhiá»‡m vá»¥ Ä‘á»‘i thoáº¡i, táº¡o mÃ£, vÃ  lÃ½ luáº­n toÃ¡n há»c sá»­ dá»¥ng cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K tÆ°Æ¡ng á»©ng. XÃ¢y dá»±ng vá»›i EAGLE-2 (Li et al., 2024c), HASS Ä‘áº¡t Ä‘Æ°á»£c cáº£i thiá»‡n Ä‘á»™ dÃ i cháº¥p nháº­n 8%-16% so vá»›i nÃ³ trÃªn LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B, dáº«n Ä‘áº¿n tÄƒng tá»‘c thá»i gian thá»±c tá»« 2.81x-4.05x so vá»›i suy luáº­n vanilla trÃªn GPU NVIDIA H800.
2 SÆ  Bá»˜
Láº¥y máº«u suy Ä‘oÃ¡n táº­n dá»¥ng khÃ¡i niá»‡m thá»±c thi suy Ä‘oÃ¡n (Kung & Robinson, 1981; Hennessy & Patterson, 2011) Ä‘á»ƒ giáº£m thá»i gian thá»±c tá»« tÃ­nh Ä‘á»“ng thá»i cao hÆ¡n. Cá»¥ thá»ƒ, cho LLM Ä‘Ã­ch M(l) lÃ  trá»ng tÃ¢m cá»§a viá»‡c tÄƒng tá»‘c, láº¥y máº«u suy Ä‘oÃ¡n sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh draft
2

--- TRANG 3 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
M(s) Ä‘á»ƒ táº¡o cÃ¡c token draft má»™t cÃ¡ch suy Ä‘oÃ¡n vÃ  hiá»‡u quáº£. PhÆ°Æ¡ng phÃ¡p thÃ´ng thÆ°á»ng (Leviathan et al., 2023; Chen et al., 2023) phÃ¢n tÃ¡ch viá»‡c táº¡o bÆ°á»›c tiáº¿p theo thÃ nh ba bÆ°á»›c:
â€¢M(s) Ä‘á» xuáº¥t má»™t chuá»—i draft chÆ°a xÃ¡c minh vá»›i Ä‘á»™ dÃ i L báº±ng giáº£i mÃ£ tá»± há»“i quy.
â€¢M(l) Ä‘Ã¡nh giÃ¡ xÃ¡c suáº¥t háº­u nghiá»‡m cá»§a L token draft song song.
â€¢Ï„ token giá»¯ nguyÃªn phÃ¢n phá»‘i Ä‘Ã­ch Ä‘Æ°á»£c cháº¥p nháº­n bá»Ÿi má»™t lÆ°á»£c Ä‘á»“ láº¥y máº«u tá»« chá»‘i Ä‘Æ°á»£c sá»­a Ä‘á»•i dá»±a trÃªn chuá»—i draft vÃ  khoáº£ng cÃ¡ch phÃ¢n phá»‘i.
Leviathan et al. (2023) chá»©ng minh ráº±ng tá»‰ lá»‡ cáº£i thiá»‡n thá»i gian thá»±c tá»‰ lá»‡ thuáº­n vá»›i Ï„, trong khi tá»‰ lá»‡ gia tÄƒng phÃ©p toÃ¡n sá»‘ há»c tá»‰ lá»‡ nghá»‹ch vá»›i Ï„. Do Ä‘Ã³, Ï„, cÃ²n Ä‘Æ°á»£c gá»i lÃ  Ä‘á»™ dÃ i cháº¥p nháº­n, Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c xÃ¡c Ä‘á»‹nh hiá»‡u suáº¥t tÄƒng tá»‘c. PhÃ¢n tÃ­ch nÃ y cÅ©ng Ã¡p dá»¥ng khi sá»­ dá»¥ng nhiá»u chuá»—i draft (Miao et al., 2024; Li et al., 2024c;b; Sun et al., 2024). LÆ°u Ã½ ráº±ng Ï„ cÃ³ liÃªn quan cháº·t cháº½ Ä‘áº¿n khoáº£ng cÃ¡ch phÃ¢n phá»‘i giá»¯a LLM Ä‘Ã­ch vÃ  mÃ´ hÃ¬nh draft. Vá»›i yÃªu cáº§u giáº£i mÃ£ hiá»‡u quáº£, mÃ´ hÃ¬nh draft thÆ°á»ng cÃ³ kháº£ nÄƒng háº¡n cháº¿, dáº«n Ä‘áº¿n khoáº£ng cÃ¡ch phÃ¢n phá»‘i Ä‘Ã¡ng ká»ƒ so vá»›i LLM Ä‘Ã­ch. May máº¯n thay, trong quÃ¡ trÃ¬nh suy luáº­n, tá»· lá»‡ cháº¥p nháº­n chá»§ yáº¿u bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi sá»± cÄƒn chá»‰nh cá»§a cÃ¡c phÃ¢n phá»‘i trÃªn cÃ¡c token mong muá»‘n, tá»©c lÃ  cÃ¡c token mÃ  LLM Ä‘Ã­ch gÃ¡n xÃ¡c suáº¥t cao. Tuy nhiÃªn, cÃ¡c cÃ´ng trÃ¬nh láº¥y máº«u suy Ä‘oÃ¡n trÆ°á»›c Ä‘Ã¢y chá»§ yáº¿u táº­p trung vÃ o toÃ n bá»™ táº­p tá»« vá»±ng w.r.t. chÆ°ng cáº¥t kiáº¿n thá»©c tá»« LLM Ä‘Ã­ch (Li et al., 2024b; Zhou et al., 2024), do Ä‘Ã³ ngáº¯t káº¿t ná»‘i quÃ¡ trÃ¬nh huáº¥n luyá»‡n khá»i cÃ¡c yÃªu cáº§u giáº£i mÃ£ thá»±c táº¿.
EAGLE (Li et al., 2024b) lÃ  má»™t thiáº¿t káº¿ mÃ´ hÃ¬nh draft nháº¹, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 2. Trong quÃ¡ trÃ¬nh giáº£i mÃ£, nÃ³ sá»­ dá»¥ng LM Head cá»§a LLM Ä‘Ã­ch Ä‘á»ƒ táº¡o cÃ¡c token draft. Cá»¥ thá»ƒ, chÃºng ta giáº£ Ä‘á»‹nh ráº±ng suy Ä‘oÃ¡n báº¯t Ä‘áº§u tá»« bÆ°á»›c thá»i gian t, cÃ³ nghÄ©a lÃ  token draft Ä‘áº§u tiÃªn á»Ÿ bÆ°á»›c thá»i gian t+ 1. Äá»ƒ táº¡o token draft xt+1, tráº¡ng thÃ¡i áº©n f(l)tâˆ’1 cá»§a LLM Ä‘Ã­ch á»Ÿ lá»›p thá»© hai tá»« trÃªn xuá»‘ng Ä‘Æ°á»£c ná»‘i vá»›i embedding et Ä‘á»ƒ thá»±c hiá»‡n Ä‘áº§u vÃ o cá»§a mÃ´ hÃ¬nh draft. Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, EAGLE xÃ¢y dá»±ng má»™t nhiá»‡m vá»¥ há»“i quy giá»¯a f(l)s vÃ  cÃ¡c tráº¡ng thÃ¡i áº©n Ä‘Æ°á»£c dá»± Ä‘oÃ¡n f(s)s cá»§a mÃ´ hÃ¬nh draft. Tuy nhiÃªn, do giáº£i mÃ£ tá»± há»“i quy, mÃ´ hÃ¬nh draft chá»‰ truy cáº­p cÃ¡c Ä‘áº·c trÆ°ng cá»§a LLM Ä‘Ã­ch á»Ÿ Ä‘áº§u suy Ä‘oÃ¡n. NÃ³ sá»­ dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng do chÃ­nh nÃ³ táº¡o ra lÃ m Ä‘áº§u vÃ o cho cÃ¡c bÆ°á»›c tiáº¿p theo. Sá»± khÃ´ng cÄƒn chá»‰nh ngá»¯ cáº£nh nÃ y, xuáº¥t phÃ¡t tá»« sá»± khÃ´ng chÃ­nh xÃ¡c cá»§a Ä‘áº·c trÆ°ng, dáº«n Ä‘áº¿n tÃ­ch lÅ©y lá»—i vÃ  cáº£n trá»Ÿ hiá»‡u suáº¥t táº¡o cÃ¡c token draft sau nÃ y (Li et al., 2024b; Du et al., 2024). EAGLE-2 (Li et al., 2024c) sá»­ dá»¥ng cÃ¹ng thiáº¿t káº¿ mÃ´ hÃ¬nh nhÆ°ng lÃ m viá»‡c trÃªn cÃ¡c cáº¥u trÃºc draft Ä‘á»™ng thay vÃ¬ cáº¥u trÃºc cÃ¢y tÄ©nh trong giai Ä‘oáº¡n giáº£i mÃ£, tuy nhiÃªn váº¥n Ä‘á» nÃªu trÃªn váº«n chÆ°a Ä‘Æ°á»£c giáº£i quyáº¿t.
3 PHÆ¯Æ NG PHÃP
NhÆ° Ä‘Ã£ nÃªu trÆ°á»›c Ä‘Ã¢y, cÃ¡c phÆ°Æ¡ng phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n trÆ°á»›c Ä‘Ã¢y gáº·p pháº£i sá»± khÃ´ng hÃ i hÃ²a giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£. Pháº§n nÃ y giá»›i thiá»‡u HArmonized Speculative Sampling (HASS) Ä‘á»ƒ giáº£i quyáº¿t sá»± khÃ´ng cÄƒn chá»‰nh má»¥c tiÃªu vÃ  sá»± khÃ´ng nháº¥t quÃ¡n ngá»¯ cáº£nh thÃ´ng qua chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a vÃ  cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a tÆ°Æ¡ng á»©ng, nhÆ° Ä‘Æ°á»£c mÃ´ táº£ dÆ°á»›i Ä‘Ã¢y.
3.1 CHÆ¯NG Cáº¤T Má»¤C TIÃŠU HÃ€I HÃ’A
HASS Æ°u tiÃªn cÃ¡c token mong muá»‘n nháº¥t trong giáº£i mÃ£ báº±ng cÃ¡ch táº­n dá»¥ng Ã½ tÆ°á»Ÿng chÆ°ng cáº¥t xáº¿p háº¡ng (Tang & Wang, 2018) tá»« há»‡ thá»‘ng gá»£i Ã½. Cá»¥ thá»ƒ, chÆ°ng cáº¥t xáº¿p háº¡ng nháº±m má»¥c Ä‘Ã­ch huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh há»c sinh Ä‘á»ƒ gÃ¡n thá»© háº¡ng cao hÆ¡n cho cÃ¡c má»¥c Ä‘Æ°á»£c xáº¿p háº¡ng cao nháº¥t bá»Ÿi mÃ´ hÃ¬nh giÃ¡o viÃªn. Trong bá»‘i cáº£nh láº¥y máº«u suy Ä‘oÃ¡n, mÃ´ hÃ¬nh draft vÃ  LLM Ä‘Ã­ch Ä‘Ã³ng vai trÃ² lÃ  há»c sinh vÃ  giÃ¡o viÃªn tÆ°Æ¡ng á»©ng. CÃ¡c mÃ´ hÃ¬nh draft cÃ³ Ä‘áº·c tÃ­nh tÆ°Æ¡ng tá»± sáº½ thá»±c hiá»‡n á»Ÿ tá»· lá»‡ cháº¥p nháº­n cao hÆ¡n trong giai Ä‘oáº¡n giáº£i mÃ£. Xem xÃ©t táº­p há»£p K token cÃ³ xÃ¡c suáº¥t cao nháº¥t tá»« phÃ¢n phá»‘i xÃ¡c suáº¥t cá»§a LLM Ä‘Ã­ch lÃ  Ë†Î©âŠ‚Î©, trong Ä‘Ã³ Î© Ä‘áº¡i diá»‡n cho toÃ n bá»™ tá»« vá»±ng. HASS xem xÃ©t máº¥t mÃ¡t chÆ°ng cáº¥t Top-K sau Ä‘Ã¢y:
LTop-K =âˆ’X
xâˆˆË†Î©q(x) logp(x), (1)
trong Ä‘Ã³ q vÃ  p lÃ  cÃ¡c phÃ¢n phá»‘i xÃ¡c suáº¥t token tiáº¿p theo cá»§a LLM Ä‘Ã­ch vÃ  mÃ´ hÃ¬nh draft tÆ°Æ¡ng á»©ng. LÆ°u Ã½ ráº±ng, khi tÃ­ch há»£p vá»›i EAGLE, giai Ä‘oáº¡n huáº¥n luyá»‡n cÃ³ thá»ƒ thu Ä‘Æ°á»£c Ë†Î© tá»« cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  hÃ m máº¥t mÃ¡t Ä‘Æ°á»£c Ä‘á» xuáº¥t hÆ°á»Ÿng lá»£i tá»« cÃ¹ng chi phÃ­ huáº¥n luyá»‡n hiá»‡u quáº£ nhÆ° EAGLE. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ máº¥t mÃ¡t chÆ°ng cáº¥t Top-K Ä‘Æ°á»£c Ä‘á» xuáº¥t so vá»›i sÃ¡u máº¥t mÃ¡t thay tháº¿, cháº³ng háº¡n nhÆ° BiLD (Li et al., 2024a) vÃ  Recall@k Surrogate loss (Patel et al., 2022), thÃ´ng qua cÃ¡c nghiÃªn cá»©u loáº¡i bá».
3

--- TRANG 4 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
3.2 CÄ‚N CHá»ˆNH NGá»® Cáº¢NH HÃ€I HÃ’A
HASSHuáº¥nLuyá»‡nBÆ°á»›c1/EAGLEHuáº¥nLuyá»‡nâ„³(")!(")"(")!!"$"!"*(&)!!"#"!"$(&)!!"!"#(&)!!(#"!(&)
â„³(")!%($#)!!"$"!"*(&)!!"#"!"$()!)!!"!"#()")!!(#"!()#)"%&'("),"%&(($!),"%&)($"),"%($#)â„³(")!%&'(")!!"$"!"*(&)"%&'(")
â„³(")!%&(($!)!!"$"!"*(&)!!"#"!"$()!)"%&'("),"%&(($!)
â„³(")!%&)($")!!"$"!"*(&)!!"#"!"$()!)!!"!"#()")"%&'("),"%&(($!),"%&)($")
HASS/EAGLEGiáº£iMÃ£HASSHuáº¥nLuyá»‡nBÆ°á»›c2â„³(")!($!)!!"$!!"#!!!!(#"!"*(&)"!"$(&)"!"#(&)"!(&)"!"*(&)"!"$()!)"!"#()!)"!()!)"("),"($!)
HASSHuáº¥nLuyá»‡nBÆ°á»›c3â„³(")!($")"("),"($!),"($")!!"$!!"#!!!!(#"!"*(&)"!"$(&)"!"#(&)"!(&)"!"*(&)"!"$()!)"!"#()!)"!()!)"!"*(&)"!"$()!)"!"#()")"!()")â„³(")!($#)"("),"($!),"($"),"($#)!!"$!!"#!!!!(#"!"*(&)"!"$(&)"!"#(&)"!(&)"!"*(&)"!"$()!)"!"#()!)"!()!)"!"*(&)"!"$()!)"!"#()")"!()!)"!"*(&)"!"$()!)"!"#()")"!()#)HASSHuáº¥nLuyá»‡nBÆ°á»›c4
HÃ¬nh 3: Huáº¥n luyá»‡n vá»›i cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a, trong Ä‘Ã³ q vÃ  k tham chiáº¿u Ä‘áº¿n cÃ¡c tráº¡ng thÃ¡i query vÃ  key trong lá»›p transformer tÆ°Æ¡ng á»©ng. Chá»‰ sá»‘ trÃªn (l) kÃ½ hiá»‡u cÃ¡c tensor tá»« LLM Ä‘Ã­ch, vÃ  chá»‰ sá»‘ trÃªn (sj) kÃ½ hiá»‡u cÃ¡c tensor tá»« láº§n forward thá»© j cá»§a mÃ´ hÃ¬nh draft. LÆ°u Ã½ ráº±ng trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n (sj) tham chiáº¿u Ä‘áº¿n viá»‡c gá»i j láº§n mÃ´ hÃ¬nh draft trong má»™t batch, trong khi trong quÃ¡ trÃ¬nh suy luáº­n (sj) tham chiáº¿u Ä‘áº¿n giáº£i mÃ£ tá»± há»“i quy thá»© j.
HASS tuÃ¢n theo má»™t lÆ°á»£c Ä‘á»“ cÄƒn chá»‰nh ngá»¯ cáº£nh Ä‘á»ƒ cÄƒn chá»‰nh huáº¥n luyá»‡n vÃ  giáº£i mÃ£ trÃªn cÃ¡c ngá»¯ cáº£nh cá»§a chÃºng. Quy trÃ¬nh huáº¥n luyá»‡n cá»§a HASS Ä‘Æ°á»£c chia thÃ nh n bÆ°á»›c, cho phÃ©p mÃ´ hÃ¬nh draft sá»­ dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng ngá»¯ cáº£nh nháº¥t quÃ¡n vá»›i nhá»¯ng Ä‘áº·c trÆ°ng trong giai Ä‘oáº¡n giáº£i mÃ£ vÃ  giáº£i quyáº¿t sá»± khÃ´ng nháº¥t quÃ¡n ngá»¯ cáº£nh báº±ng cÃ¡ch thÃ­ch á»©ng vá»›i cÃ¡c Ä‘áº·c trÆ°ng khÃ´ng chÃ­nh xÃ¡c Ä‘Æ°á»£c táº¡o ra trong cÃ¡c bÆ°á»›c huáº¥n luyá»‡n HASS trÆ°á»›c Ä‘Ã³. Cá»¥ thá»ƒ, nÃ³ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch Ä‘áº§u tiÃªn láº¥y Ä‘áº·c trÆ°ng khÃ´ng chÃ­nh xÃ¡c tá»« mÃ´ hÃ¬nh draft cuá»‘i cÃ¹ng lÃ m query, sau Ä‘Ã³ xem xÃ©t sá»± tÃ­ch lÅ©y khÃ´ng chÃ­nh xÃ¡c trong pháº§n key-value cá»§a khá»‘i transformer.
Má»™t cÃ¡ch chÃ­nh thá»©c, trong bÆ°á»›c huáº¥n luyá»‡n HASS j, cho chuá»—i token Ä‘áº§u vÃ o x1, x2, .., x T, chÃºng ta tá»‘i Æ°u hÃ³a mÃ´ hÃ¬nh draft M(s) vá»›i hÃ m má»¥c tiÃªu sau:
min
M(s)Tâˆ’1X
t=1[CrossEntropy (P(l)(xt+1|x1, . . . , x t), P(s)(xt+1|x1, . . . , x t)) + Aux-loss ],trong Ä‘Ã³
P(s)(xt+1|x1, . . . , x t) =Head(f(sj)
t+1)
=Head(M(s)(Tá»« draft cuá»‘i cÃ¹ngz}|{
f(sjâˆ’1)
t|{z}
query,Tá»« LLM Ä‘Ã­chz }| {
f(l)
1âŠ• Â·Â·Â· âŠ• f(l)
tâˆ’j+1âŠ•Tá»« cÃ¡c mÃ´ hÃ¬nh draft trÆ°á»›c Ä‘Ã³z }| {
f(s1)
tâˆ’j+2âŠ• Â·Â·Â· âŠ• f(sjâˆ’1)
t| {z }
key & value)),
4

--- TRANG 5 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
Nhiá»‡t Ä‘á»™ = 0 Nhiá»‡t Ä‘á»™ = 1
MÃ´ hÃ¬nh PhÆ°Æ¡ng phÃ¡p MT-bench HumanEval GSM8K Trung bÃ¬nh MT-bench HumanEval GSM8K Trung bÃ¬nh
L2 7BPLD 1.43 1.59 1.37 1.46 - - - -
Lookahead 1.66 1.77 1.65 1.69 - - - -
SpS (V-68M) 2.02 2.03 2.04 2.03 1.72 1.50 1.65 1.62
SpS (L-68M) 1.83 1.81 1.83 1.82 1.47 1.36 1.46 1.43
Medusa 2.34 2.48 2.37 2.40 2.35 2.56 2.40 2.44
EAGLE 3.68 3.90 3.77 3.78 3.45 3.67 3.62 3.58
EAGLE-2 4.44 4.78 4.60 4.61 4.23 4.47 4.50 4.40
HASS 4.99 5.29 5.17 5.15 4.84 4.91 5.01 4.92
L2 13BPLD 1.46 1.70 1.44 1.53 - - - -
Lookahead 1.64 1.85 1.69 1.73 - - - -
SpS (V-68M) 2.13 2.61 2.21 2.32 1.73 2.25 1.81 1.93
SpS (L-68M) 1.83 1.67 1.70 1.73 1.50 1.34 1.45 1.43
Medusa 2.51 2.56 2.70 2.59 2.53 2.89 2.72 2.71
EAGLE 3.86 4.50 4.17 4.18 3.62 4.27 3.98 3.96
EAGLE-2 4.74 5.57 5.17 5.16 4.60 5.41 5.03 5.01
HASS 5.13 6.05 5.55 5.58 4.98 5.86 5.41 5.42
L3 8BEAGLE 2.91 3.66 3.57 3.38 2.67 3.35 3.30 3.11
EAGLE-2 4.21 4.93 4.42 4.52 3.90 4.73 4.30 4.31
HASS 4.68 5.54 5.02 5.08 4.26 5.30 4.85 4.80
L3 70BEAGLE 3.24 4.07 3.79 3.70 3.06 3.85 3.66 3.52
EAGLE-2 4.10 5.02 4.37 4.50 4.00 4.93 4.35 4.43
HASS 4.62 5.78 5.24 5.21 4.59 5.68 5.20 5.16
Báº£ng 1: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhau trÃªn cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat, trong khi L3 Ä‘áº¡i diá»‡n cho LLaMA3-Instruct. SpS viáº¿t táº¯t cho Vanilla Speculative Sampling, trong khi V-68M vÃ  L-68M Ä‘áº¡i diá»‡n cho Vicuna-68M vÃ  LLaMA-68M, lÃ  cÃ¡c mÃ´ hÃ¬nh draft cá»§a SpS.
P(l) lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t tá»± há»“i quy Ä‘Æ°á»£c cung cáº¥p bá»Ÿi LLM Ä‘Ã­ch, Aux-loss bao gá»“m máº¥t mÃ¡t Top-K Ä‘Æ°á»£c Ä‘á» xuáº¥t vÃ  máº¥t mÃ¡t há»“i quy Ä‘áº·c trÆ°ng (theo EAGLE), Head vÃ  âŠ• Ä‘áº¡i diá»‡n cho Ä‘áº§u mÃ´ hÃ¬nh hÃ³a ngÃ´n ngá»¯ vÃ  phÃ©p toÃ¡n ná»‘i tÆ°Æ¡ng á»©ng. Khi huáº¥n luyá»‡n cÃ¡c token trong toÃ n bá»™ chuá»—i song song, cÃ´ng thá»©c trÃªn thÃ­ch á»©ng vá»›i cÃ¡c Ä‘áº·c trÆ°ng khÃ´ng chÃ­nh xÃ¡c tá»« jâˆ’1 bÆ°á»›c trÆ°á»›c Ä‘Ã³ cho táº¥t cáº£ cÃ¡c vá»‹ trÃ­ trá»« jâˆ’1 vá»‹ trÃ­ Ä‘áº§u tiÃªn. LÆ°u Ã½ ráº±ng so vá»›i EAGLE, HASS cÃ³ chi phÃ­ huáº¥n luyá»‡n bá»• sung do nâˆ’1 bÆ°á»›c huáº¥n luyá»‡n thÃªm Ä‘á»ƒ thÃ­ch á»©ng vá»›i cÃ¡c Ä‘áº·c trÆ°ng khÃ´ng chÃ­nh xÃ¡c, trong khi duy trÃ¬ cÃ¹ng chi phÃ­ giáº£i mÃ£. Äá»ƒ tÄƒng tá»‘c quy trÃ¬nh huáº¥n luyá»‡n, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t sá»­a Ä‘á»•i cho cÆ¡ cháº¿ attention mask, nhÆ° Ä‘Æ°á»£c nÃªu dÆ°á»›i Ä‘Ã¢y:
â€¢ BÆ°á»›c Ä‘áº§u tiÃªn pháº£n Ã¡nh giai Ä‘oáº¡n huáº¥n luyá»‡n cá»§a EAGLE. Táº¡i bÆ°á»›c thá»i gian t+ 1, mÃ´ hÃ¬nh draft láº¥y Ä‘áº·c trÆ°ng f(l)t cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch lÃ m Ä‘áº§u vÃ o vÃ  táº¡o ra Ä‘áº·c trÆ°ng draft f(s1)t+1. Trong bÆ°á»›c nÃ y, attention mask váº«n giá»‘ng nhÆ° causal mask ban Ä‘áº§u mÃ  khÃ´ng cÃ³ báº¥t ká»³ sá»­a Ä‘á»•i nÃ o.
â€¢ Trong bÆ°á»›c thá»© hai, cÃ¡c Ä‘áº·c trÆ°ng tá»« bÆ°á»›c Ä‘áº§u tiÃªn Ä‘Æ°á»£c káº¿t há»£p. VÃ­ dá»¥, trong cÆ¡ cháº¿ self-attention táº¡i bÆ°á»›c thá»i gian t+ 1, f(s1)t Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh toÃ¡n query hiá»‡n táº¡i. CÃ¡c key vÃ  value Ä‘Æ°á»£c táº¡o ra tá»« f(l):tâŠ•f(s1)t, trong Ä‘Ã³ f(l):t bao gá»“m cÃ¡c Ä‘áº·c trÆ°ng tá»« cÃ¡c bÆ°á»›c thá»i gian sá»›m hÆ¡n t. Attention mask Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng Ä‘áº·c trÆ°ng trÆ°á»›c Ä‘Ã³ Ä‘Æ°á»£c tháº¥y bá»Ÿi f(s1)i luÃ´n lÃ  f(l)iâˆ’1, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong pháº§n 'HASS Training Step 2' cá»§a HÃ¬nh 3.
â€¢ Äá»‘i vá»›i bÆ°á»›c jâ‰¥3, Ä‘áº·c trÆ°ng tá»« bÆ°á»›c trÆ°á»›c Ä‘Ã³ f(sjâˆ’1)t Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÃ­nh toÃ¡n query táº¡i bÆ°á»›c thá»i gian t+ 1, trong khi cÃ¡c key vÃ  value Ä‘Æ°á»£c táº¡o ra bá»Ÿi f(l):tâˆ’j+2âŠ•f(s1)tâˆ’j+2âŠ•. . .âŠ•f(sjâˆ’1)t .
ChÃºng tÃ´i chá»©ng minh thá»±c nghiá»‡m ráº±ng hiá»‡u á»©ng tÄƒng tá»‘c há»™i tá»¥ vá»›i n nhá» Ä‘á»ƒ viá»‡c huáº¥n luyá»‡n HASS cÃ³ hiá»‡u quáº£ vá» chi phÃ­. Chi phÃ­ huáº¥n luyá»‡n thá»±c táº¿ cá»§a HASS vá» tá»‘c Ä‘á»™ huáº¥n luyá»‡n, chi phÃ­ tÃ­nh toÃ¡n, vÃ  bá»™ nhá»› GPU Ä‘Æ°á»£c kháº£o sÃ¡t trong Phá»¥ lá»¥c A.8.
5

--- TRANG 6 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
Nhiá»‡t Ä‘á»™ = 0 Nhiá»‡t Ä‘á»™ = 1
MÃ´ hÃ¬nh PhÆ°Æ¡ng phÃ¡p MT-bench HumanEval GSM8K Trung bÃ¬nh MT-bench HumanEval GSM8K Trung bÃ¬nh
L2 7BSpS (V-68M) 1.35x 1.38x 1.37x 1.37x 1.17x 1.02x 1.12x 1.10x
SpS (L-68M) 1.23x 1.24x 1.25x 1.24x 1.00x 0.94x 0.99x 0.98x
Medusa 1.91x 1.96x 2.20x 2.02x 2.00x 2.25x 2.15x 2.13x
EAGLE 1.90x 2.10x 2.04x 2.01x 1.50x 1.91x 1.87x 1.76x
EAGLE-2 2.66x 3.06x 2.72x 2.81x 2.39x 2.87x 2.54x 2.60x
HASS 2.99x 3.41x 3.32x 3.24x 2.70x 3.13x 2.87x 2.90x
L2 13BSpS (V-68M) 1.63x 1.98x 1.68x 1.76x 1.33x 1.72x 1.39x 1.48x
SpS (L-68M) 1.41x 1.29x 1.30x 1.33x 1.12x 1.04x 1.11x 1.09x
Medusa 2.26x 2.25x 2.71x 2.41x 2.31x 2.47x 2.36x 2.38x
EAGLE 1.80x 2.46x 2.41x 2.22x 1.84x 2.10x 2.21x 2.05x
EAGLE-2 3.02x 3.64x 3.23x 3.30x 3.04x 3.45x 3.13x 3.21x
HASS 3.23x 4.24x 3.48x 3.65x 3.28x 3.78x 3.37x 3.48x
L3 8BEAGLE 1.29x 2.00x 1.85x 1.71x 1.25x 1.41x 1.67x 1.44x
EAGLE-2 2.64x 3.31x 2.54x 2.83x 2.39x 2.54x 2.48x 2.47x
HASS 2.78x 3.43x 3.06x 3.09x 2.49x 3.05x 2.89x 2.81x
L3 70BEAGLE 2.14x 2.74x 2.42x 2.43x 1.80x 2.34x 2.12x 2.09x
EAGLE-2 2.94x 3.98x 3.19x 3.37x 3.02x 3.61x 3.21x 3.28x
HASS 3.40x 4.68x 4.08x 4.05x 3.43x 4.25x 3.87x 3.85x
Báº£ng 2: Tá»‰ lá»‡ tÄƒng tá»‘c cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhau trÃªn cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat, trong khi L3 Ä‘áº¡i diá»‡n cho LLaMA3-Instruct. SpS viáº¿t táº¯t cho Vanilla Speculative Sampling, trong khi V-68M vÃ  L-68M Ä‘áº¡i diá»‡n cho Vicuna-68M vÃ  LLaMA-68M, lÃ  cÃ¡c mÃ´ hÃ¬nh draft cá»§a SpS.
4 THÃ NGHIá»†M
4.1 THIáº¾T Láº¬P THÃ NGHIá»†M
LLM ÄÃ­ch. LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B.
Nhiá»‡m vá»¥. ChÃºng tÃ´i tiáº¿n hÃ nh Ä‘Ã¡nh giÃ¡ trÃªn ba nhiá»‡m vá»¥ sinh. Äá»‘i vá»›i há»™i thoáº¡i nhiá»u lÆ°á»£t, táº¡o mÃ£, vÃ  cÃ¡c nhiá»‡m vá»¥ lÃ½ luáº­n toÃ¡n há»c, chÃºng tÃ´i chá»n cÃ¡c bá»™ dá»¯ liá»‡u MT-bench (Zheng et al., 2024), HumanEval (Chen et al., 2021), vÃ  GSM8K (Cobbe et al., 2021) tÆ°Æ¡ng á»©ng. KÃ­ch thÆ°á»›c batch Ä‘Æ°á»£c Ä‘áº·t lÃ  1 dÆ°á»›i táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m theo Leviathan et al. (2023) vÃ  Zhou et al. (2024).
Chá»‰ sá»‘. HASS khÃ´ng tinh chá»‰nh trá»ng sá»‘ cá»§a LLM Ä‘Ã­ch trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n cÅ©ng nhÆ° khÃ´ng ná»›i lá»ng Ä‘iá»u kiá»‡n cháº¥p nháº­n trong quÃ¡ trÃ¬nh giáº£i mÃ£, lÃ m cho nÃ³ trá»Ÿ thÃ nh má»™t phÆ°Æ¡ng phÃ¡p tÄƒng tá»‘c khÃ´ng máº¥t mÃ¡t. Do Ä‘Ã³, cháº¥t lÆ°á»£ng sinh Ä‘Æ°á»£c há»©a háº¹n mÃ  khÃ´ng cáº§n Ä‘Ã¡nh giÃ¡. ChÃºng tÃ´i sá»­ dá»¥ng hai chá»‰ sá»‘ sau Ä‘á»ƒ Ä‘o hiá»‡u suáº¥t tÄƒng tá»‘c:
â€¢Tá»‰ lá»‡ TÄƒng tá»‘c : Tá»‰ lá»‡ tÄƒng tá»‘c kiá»ƒm tra thá»±c táº¿ tÆ°Æ¡ng Ä‘á»‘i so vá»›i giáº£i mÃ£ tá»± há»“i quy vanilla.
â€¢Äá»™ dÃ i Cháº¥p nháº­n Ï„: Sá»‘ lÆ°á»£ng token trung bÃ¬nh Ä‘Æ°á»£c táº¡o ra cho má»—i chu ká»³ draft-verification, chá»‰ ra sá»‘ lÆ°á»£ng token Ä‘Æ°á»£c LLM Ä‘Ã­ch cháº¥p nháº­n tá»« mÃ´ hÃ¬nh draft.
LÆ°u Ã½ ráº±ng tá»‰ lá»‡ tÄƒng tá»‘c nháº¡y cáº£m vá»›i pháº§n cá»©ng do sá»± biáº¿n Ä‘á»•i trong sá»©c máº¡nh tÃ­nh toÃ¡n, vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng nháº¹ bá»Ÿi pháº§n cá»©ng do lá»—i sá»‘. Do Ä‘Ã³, táº¥t cáº£ cÃ¡c quÃ¡ trÃ¬nh suy luáº­n Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn GPU NVIDIA H800.
So sÃ¡nh. Giáº£i mÃ£ tá»± há»“i quy vanilla Ä‘Æ°á»£c láº¥y lÃ m cÆ¡ sá»Ÿ, phá»¥c vá»¥ nhÆ° Ä‘iá»ƒm chuáº©n cho tá»‰ lá»‡ tÄƒng tá»‘c (1.00x). ChÃºng tÃ´i so sÃ¡nh HASS vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n khÃ´ng máº¥t mÃ¡t gáº§n Ä‘Ã¢y, bao gá»“m PLD (Saxena, 2023), Lookahead (Fu et al., 2023), Vanilla Speculative Sampling (Chen et al., 2023), Medusa (Cai et al., 2024), EAGLE (Li et al., 2024b), vÃ  EAGLE-2 (Li et al., 2024c). PLD vÃ  Lookahead khÃ´ng cáº§n huáº¥n luyá»‡n, láº§n lÆ°á»£t sá»­ dá»¥ng chuá»—i khá»›p tá»« prompt vÃ  cached n-gram lÃ m token draft thay vÃ¬ táº¡o token draft tá»« phÃ¢n phá»‘i xÃ¡c suáº¥t Ä‘Æ°á»£c dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh draft. Do Ä‘Ã³, káº¿t quáº£ cá»§a PLD vÃ  Lookahead dÆ°á»›i nhiá»‡t Ä‘á»™ = 1 khÃ´ng Ä‘Æ°á»£c bÃ¡o cÃ¡o trong Báº£ng 1.
6

--- TRANG 7 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
Triá»ƒn khai. MÃ£ cá»§a chÃºng tÃ´i Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn kho open-source cá»§a EAGLE-21. CÃ¡c thÃ­ nghiá»‡m trÃªn EAGLE vÃ  EAGLE-2 sá»­ dá»¥ng láº¡i trá»ng sá»‘ mÃ´ hÃ¬nh draft Ä‘Æ°á»£c huáº¥n luyá»‡n bá»Ÿi Li et al. (2024b). Äá»‘i vá»›i chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a, K Ä‘Æ°á»£c Ä‘áº·t lÃ  10, vÃ  máº¥t mÃ¡t cá»§a chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a Ä‘Æ°á»£c thÃªm vÃ o máº¥t mÃ¡t ban Ä‘áº§u cá»§a EAGLE vá»›i há»‡ sá»‘ w= 1.0. Äá»‘i vá»›i cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a, mÃ´ hÃ¬nh draft Ä‘Æ°á»£c cÄƒn chá»‰nh trong 3 bÆ°á»›c trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Äá»‘i vá»›i cáº¥u trÃºc cÃ¢y Ä‘á»™ng, chÃºng tÃ´i Ä‘áº·t tá»•ng sá»‘ token draft lÃ  60 cho táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m vá»›i Ä‘á»™ sÃ¢u cÃ¢y draft lÃ  6. ChÃºng tÃ´i giá»¯ cÃ¡c cÃ i Ä‘áº·t khÃ¡c, cháº³ng háº¡n nhÆ° bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n cá»‘ Ä‘á»‹nh, tá»©c lÃ  bá»™ dá»¯ liá»‡u ShareGPT2 vá»›i 68,000 cuá»™c Ä‘á»‘i thoáº¡i, vÃ  optimizer, nháº¥t quÃ¡n vá»›i EAGLE-2.
4.2 HIá»†U QUáº¢ & NGHIÃŠN Cá»¨U LOáº I Bá»
Trong pháº§n nÃ y, trÆ°á»›c tiÃªn chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cá»§a HASS báº±ng cÃ¡ch so sÃ¡nh nÃ³ vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n hiá»‡n cÃ³ vá» Ä‘á»™ dÃ i cháº¥p nháº­n vÃ  tá»‰ lá»‡ tÄƒng tá»‘c. Sau Ä‘Ã³, chÃºng tÃ´i tiáº¿n hÃ nh cÃ¡c nghiÃªn cá»©u loáº¡i bá» vá» chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a vÃ  cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a. ÄÆ°á»£c truyá»n cáº£m há»©ng bá»Ÿi Yi et al. (2024), chÃºng tÃ´i tiáº¿p tá»¥c tiáº¿n hÃ nh thÃ­ nghiá»‡m báº±ng cÃ¡ch huáº¥n luyá»‡n trÃªn cÃ¡c tá»‰ lá»‡ khÃ¡c nhau cá»§a bá»™ dá»¯ liá»‡u ShareGPT Ä‘á»ƒ kháº£o sÃ¡t kháº£ nÄƒng má»Ÿ rá»™ng cá»§a HASS khi Ä‘á»‘i máº·t vá»›i sá»± khan hiáº¿m dá»¯ liá»‡u (xem Phá»¥ lá»¥c A.6), vÃ  báº±ng cÃ¡ch Ä‘Ã¡nh giÃ¡ trÃªn cÃ¡c nhiá»‡m vá»¥ dá»‹ch thuáº­t Ä‘á»ƒ kháº£o sÃ¡t tÃ­nh máº¡nh máº½ cá»§a HASS trÃªn cÃ¡c loáº¡i nhiá»‡m vá»¥ khÃ¡c nhau (xem Phá»¥ lá»¥c A.7). NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« káº¿t quáº£, HASS cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng tá»‘t hÆ¡n EAGLE-2 vá»›i Ã­t dá»¯ liá»‡u huáº¥n luyá»‡n hÆ¡n vÃ  Ä‘áº¡t Ä‘Æ°á»£c nhá»¯ng cáº£i thiá»‡n Ä‘áº§y há»©a háº¹n so vá»›i EAGLE-2 trÃªn cÃ¡c nhiá»‡m vá»¥ dá»‹ch thuáº­t nháº¥t quÃ¡n vá»›i káº¿t quáº£ trÃªn MT-bench, HumanEval, vÃ  GSM8K.
4.2.1 HIá»†U QUáº¢
ChÃºng tÃ´i trÃ¬nh bÃ y Ä‘á»™ dÃ i cháº¥p nháº­n vÃ  tá»‰ lá»‡ tÄƒng tá»‘c cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c nhau trÃªn ba bá»™ dá»¯ liá»‡u trong Báº£ng 1 vÃ  2 tÆ°Æ¡ng á»©ng. HASS thá»±c hiá»‡n Ä‘á»™ dÃ i cháº¥p nháº­n lá»›n nháº¥t vÃ  tá»‰ lá»‡ tÄƒng tá»‘c cao nháº¥t trÃªn táº¥t cáº£ cÃ¡c bá»™ dá»¯ liá»‡u vÃ  LLM chÃºng tÃ´i kiá»ƒm tra. Háº§u háº¿t cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘t nháº¥t trÃªn bá»™ dá»¯ liá»‡u HumanEval, vÃ¬ cÃ¡c template cá»‘ Ä‘á»‹nh trong nhiá»‡m vá»¥ táº¡o mÃ£ dá»… draft vÃ  tÄƒng tá»‘c hÆ¡n. Máº·c dÃ¹ PLD vÃ  Lookahead khÃ´ng cáº§n huáº¥n luyá»‡n, chÃºng luÃ´n cho tháº¥y hiá»‡u suáº¥t kÃ©m hÆ¡n so vá»›i Medusa, EAGLE, EAGLE-2, vÃ  HASS.
4.2.2 NGHIÃŠN Cá»¨U LOáº I Bá» Vá»€ CHÆ¯NG Cáº¤T Má»¤C TIÃŠU HÃ€I HÃ’A
0 0.1 0.2 0.5 1.0 2.0
Trá»ng sá»‘4.84.95.05.15.25.3Äá»™ dÃ i Cháº¥p nháº­n
1 5 10 50 100
K4.84.95.05.15.25.3
T = 0
T = 1
HÃ¬nh 4: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vá»›i cÃ¡c K vÃ  trá»ng sá»‘ khÃ¡c nhau cá»§a máº¥t mÃ¡t Top-K. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7B vÃ  trung bÃ¬nh trÃªn cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.TrÆ°á»›c tiÃªn chÃºng tÃ´i nghiÃªn cá»©u áº£nh hÆ°á»Ÿng cá»§a cÃ¡c K khÃ¡c nhau vÃ  trá»ng sá»‘ w cá»§a máº¥t mÃ¡t Top-K báº±ng cÃ¡ch thay Ä‘á»•i cÃ¡c siÃªu tham sá»‘ nÃ y vÃ  tÃ³m táº¯t káº¿t quáº£ trong HÃ¬nh 4. Huáº¥n luyá»‡n vá»›i máº¥t mÃ¡t Top-K (w > 0) luÃ´n cáº£i thiá»‡n hiá»‡u suáº¥t so vá»›i huáº¥n luyá»‡n khÃ´ng cÃ³ máº¥t mÃ¡t Top-K ( w= 0). HASS Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ dÃ i cháº¥p nháº­n lá»›n nháº¥t khi w= 0.5. Má»™t giÃ¡ trá»‹ K nhá» cÃ³ thá»ƒ dáº«n Ä‘áº¿n suy thoÃ¡i hiá»‡u suáº¥t, vÃ¬ mÃ´ hÃ¬nh draft chá»‰ táº­p trung vÃ o token cÃ³ xÃ¡c suáº¥t cao nháº¥t vÃ  do Ä‘Ã³ bá» qua cÃ¡c token tiá»m nÄƒng khÃ¡c. Vá»›i K lá»›n hÆ¡n, máº¥t mÃ¡t Top-K thÆ°á»ng mang láº¡i káº¿t quáº£ tá»‘t hÆ¡n, trong khi Ä‘á»™ dÃ i cháº¥p nháº­n lá»›n nháº¥t khi K = 5.
VÃ¬ chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a cÃ³ thá»ƒ Ä‘Æ°á»£c triá»ƒn khai vá»›i báº¥t ká»³ hÃ m máº¥t mÃ¡t nÃ o táº­p trung vÃ o cÃ¡c token cÃ³ kháº£ nÄƒng cao nháº¥t w.r.t. phÃ¢n phá»‘i Ä‘Ã­ch, chÃºng tÃ´i tiáº¿p tá»¥c xem xÃ©t cÃ¡c hÃ m máº¥t mÃ¡t sau vÃ  so sÃ¡nh chÃºng vá»›i Máº¥t mÃ¡t Top-K:
â€¢ Máº¥t mÃ¡t Top-P, trong Ä‘Ã³ Ë†Î© Ä‘Æ°á»£c hÃ¬nh thÃ nh bá»Ÿi cÃ¡c token cÃ³ kháº£ nÄƒng cao nháº¥t cÃ³ xÃ¡c suáº¥t tÃ­ch lÅ©y vá»«a lá»›n hÆ¡n P.
â€¢ Máº¥t mÃ¡t Top-K Chuáº©n hÃ³a, trong Ä‘Ã³ cÃ¡c phÃ¢n phá»‘i Ä‘Ã­ch vÃ  draft Ä‘á»u Ä‘Æ°á»£c chuáº©n hÃ³a trÃªn Ë†Î©. PhÃ©p toÃ¡n chuáº©n hÃ³a cÃ³ thá»ƒ lÃ  tuyáº¿n tÃ­nh hoáº·c softmax.
1https://github.com/SafeAILab/EAGLE
2https://huggingface.co/datasets/Aeala/ShareGPT Vicuna unfiltered
7

--- TRANG 8 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
HÃ m Máº¥t mÃ¡t Nhiá»‡t Ä‘á»™ = 0 Nhiá»‡t Ä‘á»™ = 1 Trung bÃ¬nh
Máº¥t mÃ¡t Top-K 4.99 4.84 4.92
Máº¥t mÃ¡t Top-P 5.03 4.76 4.90
Máº¥t mÃ¡t Top-K Chuáº©n hÃ³a (Tuyáº¿n tÃ­nh) 4.97 4.83 4.90
Máº¥t mÃ¡t Top-K Chuáº©n hÃ³a (Softmax) 4.98 4.72 4.85
Máº¥t mÃ¡t Top-K Hai chiá»u 4.99 4.72 4.86
Máº¥t mÃ¡t Recall@k Surrogate 4.97 4.76 4.87
Máº¥t mÃ¡t BiLD 5.04 4.75 4.90
Báº£ng 3: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vá»›i cÃ¡c loáº¡i hÃ m máº¥t mÃ¡t khÃ¡c nhau cho chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7B trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
â€¢ Máº¥t mÃ¡t Top-K Hai chiá»u, trong Ä‘Ã³ chÆ°ng cáº¥t Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn cÃ¡c token cÃ³ kháº£ nÄƒng cao nháº¥t w.r.t. phÃ¢n phá»‘i Ä‘Ã­ch cÅ©ng nhÆ° phÃ¢n phá»‘i draft.
â€¢ Máº¥t mÃ¡t Recall@k Surrogate (Patel et al., 2022), trong Ä‘Ã³ má»™t xáº¥p xá»‰ mÆ°á»£t cá»§a chá»‰ sá»‘ recall Ä‘Æ°á»£c thu Ä‘Æ°á»£c vÃ  cÃ³ thá»ƒ phÃ¢n biá»‡t Ä‘Æ°á»£c Ä‘á»ƒ tá»‘i Æ°u hÃ³a trá»±c tiáº¿p.
â€¢ Máº¥t mÃ¡t BiLD (Li et al., 2024a), trong Ä‘Ã³ thÃ´ng tin xáº¿p háº¡ng logits ná»™i bá»™ Ä‘Æ°á»£c náº¯m báº¯t báº±ng cÃ¡ch xÃ¢y dá»±ng sá»± khÃ¡c biá»‡t logits vá»›i nhiá»…u Ä‘uÃ´i dÃ i Ä‘Æ°á»£c lá»c ra.
Sau khi tÃ¬m kiáº¿m cÃ¡c siÃªu tham sá»‘ tá»‘i Æ°u cho má»—i hÃ m máº¥t mÃ¡t Ä‘Æ°á»£c so sÃ¡nh, chÃºng tÃ´i tÃ³m táº¯t káº¿t quáº£ tá»‘t nháº¥t cá»§a chÃºng trong Báº£ng 3. Máº¥t mÃ¡t BiLD vÆ°á»£t trá»™i hÆ¡n cÃ¡c hÃ m máº¥t mÃ¡t khÃ¡c dÆ°á»›i nhiá»‡t Ä‘á»™ T = 0, trong khi máº¥t mÃ¡t Top-K vÆ°á»£t trá»™i hÆ¡n nhá»¯ng cÃ¡i khÃ¡c dÆ°á»›i nhiá»‡t Ä‘á»™ T = 1. NÃ³i chung, máº¥t mÃ¡t Top-K cho tháº¥y hiá»‡u suáº¥t tá»‘t nháº¥t. Má»™t hÃ m máº¥t mÃ¡t tá»‘t hÆ¡n cÃ³ thá»ƒ tá»“n táº¡i so vá»›i máº¥t mÃ¡t Top-K Ä‘á»ƒ khai thÃ¡c LLM Ä‘Ã­ch hÆ¡n ná»¯a. ChÃºng tÃ´i Ä‘á»ƒ láº¡i chá»§ Ä‘á» nÃ y trong cÃ¡c cÃ´ng viá»‡c tÆ°Æ¡ng lai.
ChÃºng tÃ´i cÅ©ng tiáº¿n hÃ nh má»™t thÃ­ nghiá»‡m vá»›i LLaMA2-Chat 7B, trong Ä‘Ã³ bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n cá»‘ Ä‘á»‹nh Ä‘Æ°á»£c thay tháº¿ báº±ng bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi LLM Ä‘Ã­ch (xem Phá»¥ lá»¥c A.4). ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng khi sá»­ dá»¥ng giáº£i mÃ£ khÃ´ng tham lam, Ä‘á»™ dÃ i cháº¥p nháº­n tÄƒng tá»« 4.92 lÃªn 5.19 trung bÃ¬nh trÃªn ba bá»™ dá»¯ liá»‡u. Do Ä‘Ã³, thÃ´ng tin thu Ä‘Æ°á»£c tá»« chÆ°ng cáº¥t má»¥c tiÃªu hÃ i hÃ²a khÃ´ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i chÆ°ng cáº¥t trá»±c tiáº¿p tá»« dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh Ä‘Ã­ch.
4.2.3 NGHIÃŠN Cá»¨U LOáº I Bá» Vá»€ CÄ‚N CHá»ˆNH NGá»® Cáº¢NH HÃ€I HÃ’A
BÆ°á»›c CÄƒn chá»‰nh MT-bench HumanEval GSM8K Trung bÃ¬nh
T=0EAGLE-2 + Top-K 4.59 4.97 4.77 4.78
HASS Align-2 4.95 5.25 5.12 5.11
HASS Align-3 4.99 5.29 5.17 5.15
HASS Align-4 4.99 5.30 5.18 5.16
HASS Align-5 4.98 5.26 5.09 5.11
T=1EAGLE-2 + Top-K 4.46 4.61 4.64 4.57
HASS Align-2 4.71 4.89 4.98 4.86
HASS Align-3 4.84 4.91 5.01 4.92
HASS Align-4 4.77 4.93 5.03 4.91
HASS Align-5 4.71 4.92 4.95 4.86
Báº£ng 4: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vá»›i cÃ¡c bÆ°á»›c cÄƒn chá»‰nh khÃ¡c nhau trong cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7B vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
ChÃºng tÃ´i Ä‘á» xuáº¥t cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a, loáº¡i bá» sá»± khÃ´ng nháº¥t quÃ¡n Ä‘áº·c trÆ°ng cá»§a cÃ¡c mÃ´ hÃ¬nh draft giá»¯a cÃ¡c giai Ä‘oáº¡n huáº¥n luyá»‡n vÃ  giáº£i mÃ£. Äá»ƒ nghiÃªn cá»©u áº£nh hÆ°á»Ÿng cá»§a viá»‡c tÄƒng cÃ¡c bÆ°á»›c cÄƒn chá»‰nh trong cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a, chÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m báº±ng cÃ¡ch thay Ä‘á»•i sá»‘ bÆ°á»›c vÃ  tÃ³m táº¯t káº¿t quáº£ trong Báº£ng 4.
VÃ¬ bÆ°á»›c huáº¥n luyá»‡n Ä‘áº§u tiÃªn cá»§a HASS giá»‘ng nhÆ° EAGLE-2, chÃºng tÃ´i tiáº¿p tá»¥c huáº¥n luyá»‡n trá»ng sá»‘ mÃ´ hÃ¬nh draft cá»§a EAGLE-2 vá»›i máº¥t mÃ¡t Top-K vÃ  coi nÃ³ lÃ  cÆ¡ sá»Ÿ. KhÃ´ng cÃ³ cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a (EAGLE-2 + Top-K), mÃ´ hÃ¬nh draft thá»±c hiá»‡n tá»‡ nháº¥t trÃªn táº¥t cáº£ cÃ¡c bá»™ dá»¯ liá»‡u. Huáº¥n luyá»‡n vá»›i 3/4 bÆ°á»›c cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a thÆ°á»ng thu Ä‘Æ°á»£c Ä‘á»™ dÃ i cháº¥p nháº­n Ä‘Ã¡ng ká»ƒ nháº¥t. Khi huáº¥n luyá»‡n vá»›i 5 bÆ°á»›c cÄƒn chá»‰nh ngá»¯ cáº£nh, Ä‘á»™ dÃ i cháº¥p nháº­n giáº£m. ChÃºng tÃ´i tin ráº±ng Ä‘iá»u nÃ y do kháº£ nÄƒng háº¡n cháº¿ cá»§a mÃ´ hÃ¬nh draft, vÃ¬ nÃ³ dá»± Ä‘oÃ¡n Ã­t chÃ­nh xÃ¡c hÆ¡n trÃªn cÃ¡c token cá»§a cÃ¡c bÆ°á»›c trÆ°á»›c khi chÃº Ã½ quÃ¡ nhiá»u Ä‘áº¿n nhá»¯ng bÆ°á»›c sau. HÃ¬nh 5 cho tháº¥y tá»· lá»‡ cháº¥p nháº­n Î± trÃªn cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n trÃªn bá»™ dá»¯ liá»‡u MT-bench theo Li et al. (2024c). Trong cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n sau, HASS thá»±c hiá»‡n tá»· lá»‡ cháº¥p nháº­n tá»‘t hÆ¡n so vá»›i EAGLE-2, chá»©ng minh hiá»‡u quáº£ cá»§a cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a.
8

--- TRANG 9 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 7B T=05560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 13B T=05560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 8B T=05560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 70B T=05560657075
HASS EAGLE-2
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 7B T=15560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 13B T=15560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 8B T=15560657075
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 70B T=15560657075
HÃ¬nh 5: Tá»· lá»‡ cháº¥p nháº­n Î±(%) cá»§a HASS vÃ  EAGLE-2 trÃªn cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n khÃ¡c nhau trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5, tá»· lá»‡ cháº¥p nháº­n cá»§a HASS giáº£m so vá»›i EAGLE-2 trÃªn LLaMA2-Chat 13B vÃ  LLaMA3-Instruct 70B á»Ÿ bÆ°á»›c Ä‘áº§u tiÃªn (0- Î±). CÃ¡c mÃ´ hÃ¬nh draft suy thoÃ¡i á»Ÿ bÆ°á»›c suy Ä‘oÃ¡n Ä‘áº§u tiÃªn vá»›i nhiá»u sá»± chÃº Ã½ dÃ nh cho cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n sau, trong khi tá»· lá»‡ cháº¥p nháº­n cá»§a bÆ°á»›c Ä‘áº§u tiÃªn lÃ  quan trá»ng cho Ä‘á»™ dÃ i cháº¥p nháº­n lá»›n hÆ¡n. ChÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m Ä‘á»ƒ nháº¥n máº¡nh táº§m quan trá»ng cá»§a cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n trÆ°á»›c báº±ng cÃ¡ch tÃ¡i cÃ¢n báº±ng máº¥t mÃ¡t huáº¥n luyá»‡n tá»« má»—i bÆ°á»›c vá»›i má»™t yáº¿u tá»‘ Î². Cá»¥ thá»ƒ, máº¥t mÃ¡t huáº¥n luyá»‡n cá»§a bÆ°á»›c j sáº½ Ä‘Æ°á»£c nhÃ¢n vá»›i Î²jâˆ’1. Báº£ng 5 vÃ  HÃ¬nh 6 cho tháº¥y Ä‘á»™ dÃ i cháº¥p nháº­n vÃ  tá»· lá»‡ cháº¥p nháº­n cá»§a HASS vá»›i cÃ¡c yáº¿u tá»‘ tÃ¡i cÃ¢n báº±ng khÃ¡c nhau trÃªn LLaMA3-Instruct 70B trÃªn bá»™ dá»¯ liá»‡u MT-bench tÆ°Æ¡ng á»©ng. Vá»›i yáº¿u tá»‘ Î² giáº£m tá»« 1.0 xuá»‘ng 0.5, HASS Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ dÃ i cháº¥p nháº­n tá»‘t hÆ¡n vá»›i cÃ¡c nhiá»‡t Ä‘á»™ khÃ¡c nhau. TÆ°Æ¡ng á»©ng, chÃºng ta nháº­n tháº¥y ráº±ng tá»· lá»‡ cháº¥p nháº­n á»Ÿ bÆ°á»›c suy Ä‘oÃ¡n Ä‘áº§u tiÃªn luÃ´n cao hÆ¡n vá»›i Î² nhá» hÆ¡n, trong khi tá»· lá»‡ cháº¥p nháº­n á»Ÿ cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n sau thÆ°á»ng giáº£m. Khi yáº¿u tá»‘ Î² giáº£m xuá»‘ng 0.3, quÃ¡ nhiá»u sá»± nháº¥n máº¡nh Ä‘Æ°á»£c gÃ¡n cho bÆ°á»›c suy Ä‘oÃ¡n Ä‘áº§u tiÃªn, dáº«n Ä‘áº¿n suy thoÃ¡i trong Ä‘á»™ dÃ i cháº¥p nháº­n. VÃ¬ viá»‡c khÃ¡m phÃ¡ thÃªm vá» sá»± Ä‘Ã¡nh Ä‘á»•i thÃ­ch há»£p giá»¯a cÃ¡c bÆ°á»›c suy Ä‘oÃ¡n khÃ¡c nhau náº±m ngoÃ i pháº¡m vi cá»§a bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘á»ƒ láº¡i nÃ³ cho cÃ´ng viá»‡c tÆ°Æ¡ng lai.
Yáº¿u tá»‘ TÃ¡i cÃ¢n báº±ng Î² T = 0 T = 1 Trung bÃ¬nh
1.0 (Máº·c Ä‘á»‹nh) 4.62 4.59 4.61
0.7 4.65 4.61 4.63
0.5 4.67 4.62 4.65
0.3 4.65 4.61 4.63
Báº£ng 5: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vá»›i cÃ¡c yáº¿u tá»‘ tÃ¡i cÃ¢n báº±ng Î² khÃ¡c nhau cho cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA3-Instruct 70B trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 70B T=066687072
0-
 1-
 2-
 3-
 4-
 5-
LLaMA3-Instruct 70B T=166687072
 = 1.0
 = 0.7
 = 0.5
 = 0.3
HÃ¬nh 6: Tá»· lá»‡ cháº¥p nháº­n Î±(%) cá»§a HASS vá»›i cÃ¡c yáº¿u tá»‘ tÃ¡i cÃ¢n báº±ng Î² khÃ¡c nhau cho cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA3-Instruct 70B trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
5 CÃ”NG TRÃŒNH LIÃŠN QUAN
ÄÃ£ cÃ³ má»™t sá»‘ cÃ´ng trÃ¬nh vá» viá»‡c cáº£i thiá»‡n tá»· lá»‡ cháº¥p nháº­n cá»§a láº¥y máº«u suy Ä‘oÃ¡n trong khi duy trÃ¬ phÃ¢n phá»‘i Ä‘Ã­ch. Háº§u háº¿t chÃºng thuá»™c vá» hai loáº¡i. (1) Loáº¡i thá»© nháº¥t
9

--- TRANG 10 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
lÃ  huáº¥n luyá»‡n cÄƒn chá»‰nh cá»‘ gáº¯ng thu Ä‘Æ°á»£c cÃ¡c mÃ´ hÃ¬nh draft Ä‘Æ°á»£c cÄƒn chá»‰nh vá»›i LLM Ä‘Ã­ch trÆ°á»›c giai Ä‘oáº¡n giáº£i mÃ£. Zhou et al. (2024) Ä‘á» xuáº¥t má»™t phÆ°Æ¡ng phÃ¡p chÆ°ng cáº¥t kiáº¿n thá»©c vÃ  nghiÃªn cá»©u má»™t sá»‘ chiáº¿n lÆ°á»£c Ä‘á»ƒ cáº£i thiá»‡n sá»± cÄƒn chá»‰nh. Li et al. (2024b) chá»©ng minh ráº±ng cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch lÃ m Ä‘áº§u vÃ o cá»§a mÃ´ hÃ¬nh draft cung cáº¥p thÃ´ng tin báº¥t Ä‘á»‹nh Ä‘áº·c trÆ°ng bá»• sung. Xiao et al. (2024) cÅ©ng sá»­ dá»¥ng cÃ¡c tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch vÃ  giá»›i thiá»‡u má»™t thiáº¿t káº¿ mÃ´ hÃ¬nh draft dá»±a trÃªn RNN Ä‘áº¡t Ä‘Æ°á»£c tá»· lá»‡ cháº¥p nháº­n tÆ°Æ¡ng Ä‘Æ°Æ¡ng. GLIDE (Du et al., 2024) thay vÃ o Ä‘Ã³ tÃ¡i sá»­ dá»¥ng KV cache cá»§a LLM Ä‘Ã­ch. NÃ³ cÅ©ng chÃº Ã½ Ä‘áº¿n sá»± khÃ´ng cÄƒn chá»‰nh ngá»¯ cáº£nh khi sá»­ dá»¥ng thÃ´ng tin tá»« LLM Ä‘Ã­ch, nhÆ°ng phÆ°Æ¡ng phÃ¡p attention mask theo khá»‘i Ä‘Æ°á»£c Ä‘á» xuáº¥t khÃ´ng thá»ƒ giáº£i quyáº¿t hoÃ n toÃ n sá»± khÃ´ng cÄƒn chá»‰nh. (2) Loáº¡i thá»© hai lÃ  giáº£i mÃ£ hiá»‡u quáº£, thiáº¿t káº¿ cÃ¡c chiáº¿n lÆ°á»£c giáº£i mÃ£ tinh vi Ä‘á»ƒ sá»­ dá»¥ng tÃ­nh Ä‘á»“ng thá»i má»™t cÃ¡ch hiá»‡u quáº£. Miao et al. (2024) Ä‘á» xuáº¥t sá»­ dá»¥ng nhiá»u mÃ´ hÃ¬nh draft vÃ  thiáº¿t káº¿ má»™t cÆ¡ cháº¿ attention dá»±a trÃªn cÃ¢y Ä‘á»ƒ xÃ¡c minh nhiá»u chuá»—i draft má»™t cÃ¡ch hiá»‡u quáº£. Li et al. (2024c) giá»›i thiá»‡u má»™t cáº¥u trÃºc Ä‘á»™ng Ä‘á»ƒ tiáº¿t kiá»‡m tÃ­nh toÃ¡n báº±ng cÃ¡ch cáº¯t tá»‰a cÃ¡c Ä‘Æ°á»ng dáº«n khÃ´ng hiá»‡u quáº£ trong cÃ¢y draft. Sun et al. (2024) nghiÃªn cá»©u cáº£i thiá»‡n giai Ä‘oáº¡n xÃ¡c minh thÃ´ng qua váº­n chuyá»ƒn tá»‘i Æ°u. Tuy nhiÃªn, nhá»¯ng cÃ´ng trÃ¬nh nÃ y cÃ³ xu hÆ°á»›ng chá»‰ xem xÃ©t huáº¥n luyá»‡n hoáº·c giáº£i mÃ£, bá» qua má»‘i liÃªn káº¿t cá»§a hai giai Ä‘oáº¡n nÃ y. CÃ´ng trÃ¬nh nÃ y thay vÃ o Ä‘Ã³ nháº±m liÃªn káº¿t huáº¥n luyá»‡n vÃ  giáº£i mÃ£, dáº«n Ä‘áº¿n láº¥y máº«u suy Ä‘oÃ¡n hÃ i hÃ²a.
6 Káº¾T LUáº¬N
BÃ i bÃ¡o nÃ y giá»›i thiá»‡u HASS, má»™t giáº£i phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n hÃ i hÃ²a giáº£i quyáº¿t sá»± khÃ´ng hÃ i hÃ²a giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£ vá» má»¥c tiÃªu vÃ  ngá»¯ cáº£nh cá»§a chÃºng. So vá»›i baseline gáº§n nháº¥t, EAGLE-2, HASS cáº£i thiá»‡n tá»· lá»‡ cháº¥p nháº­n mÃ  khÃ´ng cÃ³ báº¥t ká»³ chi phÃ­ suy luáº­n nÃ o. CÃ¡c thÃ­ nghiá»‡m Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B chá»©ng minh hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t cá»§a HASS. Trung bÃ¬nh trÃªn MT-bench, HumanEval, vÃ  GSM8K, HASS nhanh hÆ¡n 2.81x-4.05x so vá»›i giáº£i mÃ£ tá»± há»“i quy vanilla, nhanh hÆ¡n 8%-20% so vá»›i EAGLE-2.
TÃ€I LIá»†U THAM KHáº¢O
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al. BÃ¡o cÃ¡o ká»¹ thuáº­t gpt-4. arXiv , 2023.
Samy Bengio, Oriol Vinyals, Navdeep Jaitly, vÃ  Noam Shazeer. Láº¥y máº«u theo lá»‹ch trÃ¬nh cho dá»± Ä‘oÃ¡n chuá»—i vá»›i máº¡ng nÆ¡-ron há»“i quy. Trong Advances in Neural Information Processing Systems, táº­p 28, 2015.
Tianle Cai, Yuhong Li, Zhengyang Geng, Hongwu Peng, Jason D. Lee, Deming Chen, vÃ  Tri Dao. Medusa: Khung tÄƒng tá»‘c suy luáº­n LLM Ä‘Æ¡n giáº£n vá»›i nhiá»u Ä‘áº§u giáº£i mÃ£. Trong Proceedings of the 41st International Conference on Machine Learning , 2024.
Charlie Chen, Sebastian Borgeaud, Geoffrey Irving, Jean-Baptiste Lespiau, Laurent Sifre, vÃ  John Jumper. TÄƒng tá»‘c giáº£i mÃ£ mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n vá»›i láº¥y máº«u suy Ä‘oÃ¡n. arXiv , 2023.
Mark Chen, Jerry Tworek, Heewoo Jun, Qiming Yuan, Henrique Ponde De Oliveira Pinto, Jared Kaplan, Harri Edwards, Yuri Burda, Nicholas Joseph, Greg Brockman, et al. ÄÃ¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn mÃ£. arXiv , 2021.
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias Plappert, Jerry Tworek, Jacob Hilton, Reiichiro Nakano, et al. Huáº¥n luyá»‡n cÃ¡c trÃ¬nh xÃ¡c minh Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n tá»« toÃ¡n há»c. arXiv , 2021.
Cunxiao Du, Jing Jiang, Xu Yuanchen, Jiawei Wu, Sicheng Yu, Yongqi Li, Shenggui Li, Kai Xu, Liqiang Nie, Zhaopeng Tu, vÃ  Yang You. Glide vá»›i cÃ¡nh Ã¡o: Má»™t phÆ°Æ¡ng phÃ¡p Ã­t ráº¯c rá»‘i Ä‘á»ƒ tÄƒng tá»‘c giáº£i mÃ£ suy Ä‘oÃ¡n. Trong Proceedings of the 41st International Conference on Machine Learning , 2024.
Angela Fan, Mike Lewis, vÃ  Yann Dauphin. Táº¡o cÃ¢u chuyá»‡n nÆ¡-ron phÃ¢n cáº¥p. Trong Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics , pp. 889â€“898, 2018.
Yichao Fu, Peter Bailis, Ion Stoica, vÃ  Hao Zhang. PhÃ¡ vá»¡ sá»± phá»¥ thuá»™c tuáº§n tá»± cá»§a suy luáº­n llm báº±ng giáº£i mÃ£ lookahead, thÃ¡ng 11 nÄƒm 2023. URL https://lmsys.org/blog/2023-11-21-lookahead-decoding/ .
10

--- TRANG 11 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
John L Hennessy vÃ  David A Patterson. Kiáº¿n trÃºc mÃ¡y tÃ­nh: Má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»‹nh lÆ°á»£ng . Elsevier, 2011.
Ari Holtzman, Jan Buys, Li Du, Maxwell Forbes, vÃ  Yejin Choi. TrÆ°á»ng há»£p ká»³ láº¡ cá»§a sá»± suy thoÃ¡i vÄƒn báº£n nÆ¡-ron. Trong Proceedings of the 8th International Conference on Learning Representations , 2020.
Hsiang-Tsung Kung vÃ  John T Robinson. Vá» cÃ¡c phÆ°Æ¡ng phÃ¡p láº¡c quan cho kiá»ƒm soÃ¡t Ä‘á»“ng thá»i. ACM Transactions on Database Systems , 6(2):213â€“226, 1981.
Yaniv Leviathan, Matan Kalman, vÃ  Yossi Matias. Suy luáº­n nhanh tá»« transformers thÃ´ng qua giáº£i mÃ£ suy Ä‘oÃ¡n. Trong Proceedings of the 40th International Conference on Machine Learning , pp. 19274â€“19286. PMLR, 2023.
Minchong Li, Feng Zhou, vÃ  Xiaohui Song. Bild: Máº¥t mÃ¡t sá»± khÃ¡c biá»‡t logits hai chiá»u cho chÆ°ng cáº¥t mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv , 2024a.
Yuhui Li, Fangyun Wei, Chao Zhang, vÃ  Hongyang Zhang. Eagle: Láº¥y máº«u suy Ä‘oÃ¡n Ä‘Ã²i há»i suy nghÄ© láº¡i vá» báº¥t Ä‘á»‹nh Ä‘áº·c trÆ°ng. Trong Proceedings of the 41st International Conference on Machine Learning , 2024b.
Yuhui Li, Fangyun Wei, Chao Zhang, vÃ  Hongyang Zhang. Eagle-2: Suy luáº­n nhanh hÆ¡n cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ vá»›i cÃ¢y draft Ä‘á»™ng. arXiv , 2024c.
Xupeng Miao, Gabriele Oliaro, Zhihao Zhang, Xinhao Cheng, Zeyu Wang, Zhengxin Zhang, Rae Ying Yee Wong, Alan Zhu, Lijie Yang, Xiaoxiang Shi, et al. Specinfer: TÄƒng tá»‘c phá»¥c vá»¥ mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n vá»›i suy luáº­n suy Ä‘oÃ¡n vÃ  xÃ¡c minh dá»±a trÃªn cÃ¢y. Trong Proceedings of the 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 3 , pp. 932â€“949, 2024.
Yash Patel, Giorgos Tolias, vÃ  Ji Ë‡rÂ´Ä± Matas. Máº¥t mÃ¡t thay tháº¿ recall@ k vá»›i batch lá»›n vÃ  mixup tÆ°Æ¡ng tá»±. Trong Proceedings of the 2022 IEEE Conference on Computer Vision and Pattern Recognition , pp. 7502â€“7511, 2022.
Apoorv Saxena. Giáº£i mÃ£ tÃ¬m kiáº¿m prompt, thÃ¡ng 11 nÄƒm 2023. URL https://github.com/apoorvumang/prompt-lookup-decoding/ .
Ziteng Sun, Ananda Theertha Suresh, Jae Hun Ro, Ahmad Beirami, Himanshu Jain, vÃ  Felix Yu. Spectr: Giáº£i mÃ£ suy Ä‘oÃ¡n nhanh thÃ´ng qua váº­n chuyá»ƒn tá»‘i Æ°u. Trong Advances in Neural Information Processing Systems , táº­p 36, 2024.
Jiaxi Tang vÃ  Ke Wang. ChÆ°ng cáº¥t xáº¿p háº¡ng: Há»c cÃ¡c mÃ´ hÃ¬nh xáº¿p háº¡ng compact vá»›i hiá»‡u suáº¥t cao cho há»‡ thá»‘ng gá»£i Ã½. Trong Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining , pp. 2289â€“2298, 2018.
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. Llama 2: CÃ¡c mÃ´ hÃ¬nh chat ná»n táº£ng má»Ÿ vÃ  tinh chá»‰nh. arXiv , 2023.
Chaojun Wang vÃ  Rico Sennrich. Vá» bias phÆ¡i bÃ y, áº£o giÃ¡c vÃ  chuyá»ƒn Ä‘á»•i miá»n trong dá»‹ch mÃ¡y nÆ¡-ron. Trong Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics , pp. 3544â€“3552, 2020.
Bin Xiao, Lujun Gui, Lei Su, vÃ  Weipeng Chen. Clover-2: Suy luáº­n chÃ­nh xÃ¡c cho giáº£i mÃ£ suy Ä‘oÃ¡n nháº¹ há»“i quy. arXiv , 2024.
Euiin Yi, Taehyeon Kim, Hongseok Jeung, Du-Seong Chang, vÃ  Se-Young Yun. HÆ°á»›ng tá»›i suy luáº­n LLM Ä‘a ngÃ´n ngá»¯ nhanh: Giáº£i mÃ£ suy Ä‘oÃ¡n vÃ  cÃ¡c drafter chuyÃªn biá»‡t. Trong Proceedings of the 2024 Conference on Empirical Methods in Natural Language Processing , pp. 10789â€“10802, thÃ¡ng 11 nÄƒm 2024. URL https://aclanthology.org/2024.emnlp-main.602 .
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al. ÄÃ¡nh giÃ¡ llm-as-a-judge vá»›i mt-bench vÃ  chatbot arena. Trong Advances in Neural Information Processing Systems , táº­p 36, 2024.
11

--- TRANG 12 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
Yongchao Zhou, Kaifeng Lyu, Ankit Singh Rawat, Aditya Krishna Menon, Afshin Rostamizadeh, Sanjiv Kumar, Jean-Franc Â¸ois Kagy, vÃ  Rishabh Agarwal. Distillspec: Cáº£i thiá»‡n giáº£i mÃ£ suy Ä‘oÃ¡n thÃ´ng qua chÆ°ng cáº¥t kiáº¿n thá»©c. Trong Proceedings of the 12th International Conference on Learning Representations , 2024.
12

--- TRANG 13 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A PHá»¤ Lá»¤C
A.1 TRIá»‚N KHAI CÄ‚N CHá»ˆNH NGá»® Cáº¢NH HÃ€I HÃ’A
ChÃºng tÃ´i trÃ¬nh bÃ y mÃ£ giáº£ cá»§a cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a, Ä‘Æ°á»£c triá»ƒn khai mÃ  khÃ´ng cÃ³ attention mask tÃ¹y chá»‰nh, Ä‘á»ƒ hiá»ƒu rÃµ hÆ¡n. Viá»‡c triá»ƒn khai thá»±c táº¿ trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng attention mask tÃ¹y chá»‰nh nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3.
1def train_batch(
2 draft_model, # mÃ´ hÃ¬nh draft
3 lm_head, # Ä‘áº§u mÃ´ hÃ¬nh ngÃ´n ngá»¯
4 optimizer, # optimizer
5 forward_num, # cÃ¡c bÆ°á»›c cÄƒn chá»‰nh trong cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a
6 hidden_states_target, # Ä‘áº·c trÆ°ng cá»§a LLM Ä‘Ã­ch
7 input_ids, # token Ä‘áº§u vÃ o
8 ):
9 hidden_states_draft_list = []
10 for forward_idx in range(forward_num):
11 optimizer.zero_grad()
12 predict = draft_model(hidden_states_target, input_ids, hidden_states_draft_list)
13 hidden_states_draft = torch.cat([hidden_states_target[:, :1], predict[:, :-1]], dim=1).detach()
14 hidden_states_draft_list.append(hidden_states_draft)
15 target_head, pred_head = lm_head(hidden_states_target), lm_head(predict)
16 loss = feature_loss(hidden_states_target, predict) + logit_loss(target_head, pred_head)
17 loss.backward()
18 optimizer.step()
1def attention(
2 hidden_states_target, # Ä‘áº·c trÆ°ng cá»§a LLM Ä‘Ã­ch
3 attention_mask, # causal attention mask
4 hidden_states_draft_list, # danh sÃ¡ch cÃ¡c Ä‘áº·c trÆ°ng cá»§a mÃ´ hÃ¬nh draft
5 ):
6 bs, seq_len = hidden_states_target.shape[0], hidden_states_target.shape[1]
7 query = q_proj(hidden_states_draft_list[-1]) if hidden_states_draft_list else q_proj(hidden_states_target)
8 key_t, value_t = k_proj(hidden_states_target), v_proj(hidden_states_target)
9 attn_weight = torch.matmul(query, key_t.transpose(2, 3)) / math.sqrt(query.shape[-1]) + attention_mask
10 indices = torch.arange(seq_len)
11 for i, hidden_states_draft in enumerate(hidden_states_draft_list[::-1]):
12 key_d, ind_q, ind_k = k_proj(hidden_states_draft), indices[i:], indices[:seq_len - i]
13 attn_weight_d = torch.matmul(query, key_d.transpose(2, 3)) / math.sqrt(query.shape[-1])
14 attn_weight[:, :, ind_q, ind_k] = attn_weight_d[:, :, ind_q, ind_k]
15 attn_weight_normed = F.softmax(attn_weight, dim=-1)
16 attn_output = torch.matmul(attn_weight_normed, value_t)
17 for i, hidden_states_draft in enumerate(hidden_states_draft_list[::-1]):
18 value_d, ind_q, ind_k = v_proj(hidden_states_draft), indices[i:], indices[:seq_len - i]
19 attn_output[:, :, ind_q] += attn_weight[:, :, ind_q, ind_k][..., None] *(value_d[:, :, ind_k] -
value_t[:, :, ind_k])
20 attn_output = o_proj(attn_output.transpose(1, 2).reshape(bs, seq_len, -1))
21 return attn_output
13

--- TRANG 14 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.2 CÄ‚N CHá»ˆNH NGá»® Cáº¢NH HÃ€I HÃ’A TRÃŠN TOKEN
Trong pháº§n nÃ y, chÃºng tÃ´i cá»‘ gáº¯ng xÃ¡c minh liá»‡u viá»‡c Ã¡p dá»¥ng cÄƒn chá»‰nh token cÅ©ng nhÆ° cÄƒn chá»‰nh Ä‘áº·c trÆ°ng cÃ³ mang láº¡i hiá»‡u suáº¥t tá»‘t hÆ¡n hay khÃ´ng. Cá»¥ thá»ƒ, chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c token Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh draft Ä‘á»ƒ huáº¥n luyá»‡n trong cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a thay vÃ¬ sá»­ dá»¥ng cÃ¡c token tá»« dá»¯ liá»‡u huáº¥n luyá»‡n. ChÃºng tÃ´i Ã¡p dá»¥ng cÄƒn chá»‰nh Ä‘áº·c trÆ°ng vÃ  token cho trá»ng sá»‘ mÃ´ hÃ¬nh draft cá»§a EAGLE-2 vÃ  tÃ³m táº¯t káº¿t quáº£ trong Báº£ng 6 vÃ  HÃ¬nh 7.
Nhiá»‡t Ä‘á»™ = 0 Nhiá»‡t Ä‘á»™ = 1 Trung bÃ¬nh
EAGLE-2 4.44 4.23 4.34
Chá»‰ Äáº·c trÆ°ng 4.83 4.60 4.72
Äáº·c trÆ°ng + Token (0.1) 4.81 4.57 4.69
Äáº·c trÆ°ng + Token (0.2) 4.78 4.51 4.65
Äáº·c trÆ°ng + Token (1.0) 4.28 4.11 4.20
Báº£ng 6: Äá»™ dÃ i cháº¥p nháº­n Ï„ cá»§a viá»‡c Ã¡p dá»¥ng cÄƒn chá»‰nh Ä‘áº·c trÆ°ng vÃ  token cho trá»ng sá»‘ mÃ´ hÃ¬nh draft cá»§a EAGLE-2, trong Ä‘Ã³ 'Token ( x)' kÃ½ hiá»‡u cÃ¡c token tá»« dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘Æ°á»£c thay tháº¿ báº±ng cÃ¡c token Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh draft vá»›i xÃ¡c suáº¥t x. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7B trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 7B T=0646668707274
0-
 1-
 2-
 3-
 4-
 5-
LLaMA2-Chat 7B T=1646668707274
Chá»‰ Äáº·c trÆ°ng
Äáº·c trÆ°ng + Token (0.1)
Äáº·c trÆ°ng + Token (0.2)
HÃ¬nh 7: Tá»· lá»‡ cháº¥p nháº­n Î±(%) cá»§a viá»‡c Ã¡p dá»¥ng cÄƒn chá»‰nh Ä‘áº·c trÆ°ng vÃ  token cho trá»ng sá»‘ mÃ´ hÃ¬nh draft cá»§a EAGLE-2, trong Ä‘Ã³ 'Token ( x)' kÃ½ hiá»‡u cÃ¡c token tá»« dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘Æ°á»£c thay tháº¿ báº±ng cÃ¡c token Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh draft vá»›i xÃ¡c suáº¥t x. Káº¿t quáº£ Ä‘Æ°á»£c tiáº¿n hÃ nh trÃªn LLaMA2-Chat 7B trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
CÄƒn chá»‰nh chá»‰ Ä‘áº·c trÆ°ng mang láº¡i hiá»‡u suáº¥t tá»‘t nháº¥t, trong khi viá»‡c thÃªm cÄƒn chá»‰nh token dáº«n Ä‘áº¿n suy thoÃ¡i. Vá»›i xÃ¡c suáº¥t Ã¡p dá»¥ng cÄƒn chá»‰nh token tÄƒng tá»« 0.1 lÃªn 1.0, Ä‘á»™ dÃ i cháº¥p nháº­n giáº£m liÃªn tá»¥c. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 7, cÃ ng nhiá»u cÄƒn chá»‰nh token thÆ°á»ng gÃ¢y ra tá»· lá»‡ cháº¥p nháº­n tháº¥p hÆ¡n. Káº¿t quáº£ lÃ , huáº¥n luyá»‡n vá»›i cÃ¡c token Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh draft trong cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a lÃ m tá»•n háº¡i hiá»‡u suáº¥t tÄƒng tá»‘c.
14

--- TRANG 15 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.3 SIÃŠU THAM Sá» Cá»¦A Máº¤T MÃT TOP-K
ChÃºng tÃ´i tiáº¿n hÃ nh má»™t nghiÃªn cá»©u loáº¡i bá» vá» cÃ¡c siÃªu tham sá»‘ cá»§a máº¥t mÃ¡t Top-K, tá»©c lÃ  K vÃ  w, trong Pháº§n 4.2.2 vÃ  hiá»ƒn thá»‹ Ä‘á»™ dÃ i cháº¥p nháº­n trung bÃ¬nh trÃªn ba bá»™ dá»¯ liá»‡u trong HÃ¬nh 4. á» Ä‘Ã¢y, chÃºng tÃ´i trÃ¬nh bÃ y tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n cá»§a HASS vá»›i cÃ¡c K vÃ  w khÃ¡c nhau trong Báº£ng 7.
MT-bench HumanEval GSM8K Trung bÃ¬nh
K w TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„
T=01 1.0 2.89x 4.94 3.24x 5.19 3.11x 5.10 3.08x 5.08
5 1.0 2.90x 5.00 3.44x 5.29 3.33x 5.18 3.22x 5.16
10 1.0 2.99x 4.99 3.41x 5.29 3.32x 5.17 3.24x 5.15
50 1.0 2.85x 5.01 3.46x 5.29 3.41x 5.17 3.24x 5.16
100 1.0 2.93x 5.00 3.45x 5.29 3.45x 5.18 3.28x 5.16
10 0.0 2.77x 4.93 3.38x 5.22 3.18x 5.11 3.11x 5.09
10 0.1 2.98x 4.96 3.40x 5.26 3.51x 5.16 3.30x 5.13
10 0.2 2.87x 4.98 3.41x 5.29 3.35x 5.16 3.21x 5.14
10 0.5 3.00x 5.02 3.32x 5.31 3.50x 5.18 3.27x 5.17
10 2.0 2.94x 4.98 3.37x 5.29 3.34x 5.17 3.22x 5.15
T=11 1.0 2.58x 4.70 2.79x 4.80 2.83x 4.95 2.73x 4.82
5 1.0 2.64x 4.81 3.13x 4.94 2.93x 5.02 2.90x 4.92
10 1.0 2.70x 4.84 3.13x 4.91 2.87x 5.01 2.90x 4.92
50 1.0 2.62x 4.77 3.01x 4.88 2.99x 5.03 2.87x 4.89
100 1.0 2.66x 4.74 3.14x 4.97 2.90x 5.03 2.90x 4.91
10 0.0 2.61x 4.71 2.76x 4.84 2.79x 4.96 2.72x 4.84
10 0.1 2.69x 4.75 3.05x 4.94 2.87x 5.00 2.87x 4.90
10 0.2 2.66x 4.75 3.16x 4.95 2.88x 5.01 2.90x 4.90
10 0.5 2.68x 4.80 3.15x 4.93 2.96x 5.03 2.93x 4.92
10 2.0 2.68x 4.75 3.11x 4.89 2.89x 5.03 2.89x 4.89
Báº£ng 7: Tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vá»›i cÃ¡c K vÃ  w khÃ¡c nhau cá»§a máº¥t mÃ¡t Top-K trÃªn LLaMA2-Chat 7B trÃªn cÃ¡c bá»™ dá»¯ liá»‡u MT-bench, HumanEval, vÃ  GSM8K vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}.
15

--- TRANG 16 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.4 Tá»° CHÆ¯NG Cáº¤T
Trong vÄƒn báº£n chÃ­nh, chÃºng tÃ´i sá»­ dá»¥ng bá»™ dá»¯ liá»‡u ShareGPT cá»‘ Ä‘á»‹nh Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh draft Ä‘á»ƒ so sÃ¡nh cÃ´ng báº±ng vá»›i EAGLE vÃ  EAGLE-2. Theo cÃ¡c phÆ°Æ¡ng phÃ¡p láº¥y máº«u suy Ä‘oÃ¡n hiá»‡n cÃ³ (Zhou et al., 2024; Cai et al., 2024), chÃºng tÃ´i tiáº¿p tá»¥c sá»­ dá»¥ng Ä‘áº§u ra Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh Ä‘Ã­ch Ä‘á»ƒ chÆ°ng cáº¥t mÃ´ hÃ¬nh draft tá»« phÃ¢n phá»‘i Ä‘áº§u ra thá»±c cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch, Ä‘Æ°á»£c gá»i lÃ  tá»± chÆ°ng cáº¥t. Cá»¥ thá»ƒ, chÃºng tÃ´i Ä‘Æ°a cÃ¡c prompt tá»« bá»™ dá»¯ liá»‡u ShareGPT vÃ o cÃ¡c mÃ´ hÃ¬nh Ä‘Ã­ch má»™t cÃ¡ch Ä‘á»‡ quy vá»›i nhiá»‡t Ä‘á»™ Ä‘áº·t lÃ  0 vÃ  thu tháº­p cÃ¡c pháº£n há»“i dÆ°á»›i dáº¡ng cuá»™c há»™i thoáº¡i nhiá»u lÆ°á»£t Ä‘á»ƒ tá»± chÆ°ng cáº¥t theo Li et al. (2024b). Äá»ƒ nghiÃªn cá»©u áº£nh hÆ°á»Ÿng cá»§a tá»± chÆ°ng cáº¥t, chÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m trÃªn HASS vÃ  EAGLE-2 báº±ng cÃ¡ch huáº¥n luyá»‡n mÃ´ hÃ¬nh draft vá»›i dá»¯ liá»‡u cá»‘ Ä‘á»‹nh hoáº·c dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh vÃ  tÃ³m táº¯t káº¿t quáº£ trong Báº£ng 8.
MT-bench HumanEval GSM8K Trung bÃ¬nh
MÃ´ hÃ¬nh PhÆ°Æ¡ng phÃ¡p Dá»¯ liá»‡u TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„
T=0L2 7BEAGLE-2F 2.66x 4.44 3.06x 4.78 2.72x 4.60 2.81x 4.61
MG 2.86x 4.70 3.30x 5.12 3.03x 5.00 3.06x (+0.25) 4.94(+0.33)
HASSF 2.99x 4.99 3.41x 5.29 3.32x 5.17 3.24x 5.15
MG 3.13x 5.25 3.85x 5.70 3.40x 5.57 3.46x (+0.22) 5.51(+0.36)
L2 13BEAGLE-2F 3.02x 4.74 3.64x 5.57 3.23x 5.17 3.30x 5.16
MG 3.04x 4.80 3.47x 5.46 3.19x 5.16 3.23x(-0.07) 5.14(-0.02)
HASSF 3.23x 5.13 4.24x 6.05 3.48x 5.55 3.65x 5.58
MG 3.34x 5.27 4.42x 6.00 3.63x 5.61 3.80x (+0.15) 5.63(+0.05)
T=1L2 7BEAGLE-2F 2.39x 4.23 2.87x 4.47 2.54x 4.50 2.60x 4.40
MG 2.49x 4.38 2.94x 4.73 2.69x 4.80 2.71x (+0.11) 4.64(+0.24)
HASSF 2.70x 4.84 3.13x 4.91 2.87x 5.01 2.90x 4.92
MG 2.75x 4.97 3.39x 5.24 3.13x 5.35 3.09x (+0.19) 5.19(+0.27)
L2 13BEAGLE-2F 3.04x 4.60 3.45x 5.41 3.13x 5.03 3.21x 5.01
MG 3.08x 4.63 3.23x 5.25 3.04x 4.95 3.12x(-0.09) 4.94(-0.07)
HASSF 3.28x 4.98 3.78x 5.86 3.37x 5.41 3.48x 5.42
MG 3.33x 5.02 3.76x 5.80 3.60x 5.42 3.56x (+0.08) 5.41(-0.01)
Báº£ng 8: Tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vÃ  EAGLE-2 vá»›i dá»¯ liá»‡u huáº¥n luyá»‡n cá»‘ Ä‘á»‹nh hoáº·c Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh Ä‘Ã­ch. F vÃ  MG viáº¿t táº¯t cho 'Cá»‘ Ä‘á»‹nh' vÃ  'ÄÆ°á»£c Táº¡o ra bá»Ÿi MÃ´ hÃ¬nh' tÆ°Æ¡ng á»©ng. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat.
TrÃªn LLaMA2-Chat 7B, tá»± chÆ°ng cáº¥t liÃªn tá»¥c mang láº¡i cáº£i thiá»‡n cho HASS vÃ  EAGLE-2. TrÃªn LLaMA2-Chat 13B, tá»± chÆ°ng cáº¥t chá»‰ Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ tá»‘t hÆ¡n má»™t chÃºt hoáº·c tÆ°Æ¡ng Ä‘Æ°Æ¡ng, Ä‘iá»u nÃ y nháº¥t quÃ¡n vá»›i quan sÃ¡t tá»« Li et al. (2024b) ('dá»¯ liá»‡u tá»« LLM Ä‘Ã­ch cáº£i thiá»‡n hiá»‡u suáº¥t má»™t cÃ¡ch biÃªn táº¿' trong pháº§n 4.3.3 cá»§a há»). Äáº·c biá»‡t, Ä‘á»™ dÃ i cháº¥p nháº­n cá»§a HASS tá»± chÆ°ng cáº¥t tháº¥p hÆ¡n so vá»›i HASS vanilla trÃªn bá»™ dá»¯ liá»‡u HumanEval, trong khi cáº£ tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n cá»§a EAGLE-2 tá»± chÆ°ng cáº¥t Ä‘á»u tháº¥p hÆ¡n so vá»›i EAGLE-2 vanilla trÃªn cÃ¡c bá»™ dá»¯ liá»‡u HumanEval vÃ  GSM8K. CÃ³ thá»ƒ do bá»™ dá»¯ liá»‡u táº¡o mÃ£ HumanEval vÃ  bá»™ dá»¯ liá»‡u lÃ½ luáº­n toÃ¡n há»c GSM8K Ã­t tÆ°Æ¡ng tá»± vá»›i bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n ShareGPT so vá»›i MT-bench.
HASS vÆ°á»£t trá»™i hÆ¡n EAGLE-2 trÃªn cáº£ dá»¯ liá»‡u huáº¥n luyá»‡n cá»‘ Ä‘á»‹nh hoáº·c dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh. ÄÃ¡ng chÃº Ã½ lÃ  HASS Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn bá»™ dá»¯ liá»‡u cá»‘ Ä‘á»‹nh tháº­m chÃ­ Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘t hÆ¡n so vá»›i EAGLE-2 Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn dá»¯ liá»‡u Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh má»™t cÃ¡ch nháº¥t quÃ¡n. Vá»›i tá»± chÆ°ng cáº¥t, HASS liÃªn tá»¥c Ä‘áº¡t Ä‘Æ°á»£c nhiá»u cáº£i thiá»‡n hÆ¡n hoáº·c Ã­t suy thoÃ¡i hÆ¡n vá» Ä‘á»™ dÃ i cháº¥p nháº­n so vá»›i EAGLE-2.
16

--- TRANG 17 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.5 SIÃŠU THAM Sá» DRAFT
Li et al. (2024c) phÃ¡t hiá»‡n ráº±ng Ä‘iá»ƒm tin cáº­y cá»§a token draft cÃ³ tÆ°Æ¡ng quan tÃ­ch cá»±c máº¡nh vá»›i tá»· lá»‡ cháº¥p nháº­n, vÃ  do Ä‘Ã³ Ä‘á» xuáº¥t cÃ¢y draft Ä‘á»™ng cÄƒn chá»‰nh ngá»¯ cáº£nh, cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»™ng vá»›i hai siÃªu tham sá»‘: 'Ä‘á»™ sÃ¢u' vÃ  'sá»‘ lÆ°á»£ng token'. 'Äá»™ sÃ¢u' quyáº¿t Ä‘á»‹nh Ä‘á»™ sÃ¢u cá»§a cÃ¢y draft trong giai Ä‘oáº¡n má»Ÿ rá»™ng, trong khi 'sá»‘ lÆ°á»£ng token' quyáº¿t Ä‘á»‹nh cÃ³ bao nhiÃªu token draft sáº½ Ä‘Æ°á»£c giá»¯ láº¡i trong giai Ä‘oáº¡n xáº¿p háº¡ng láº¡i. TÄƒng cáº£ hai siÃªu tham sá»‘ nÃ y cháº¯c cháº¯n dáº«n Ä‘áº¿n Ä‘á»™ dÃ i cháº¥p nháº­n lá»›n hÆ¡n. Tuy nhiÃªn, gá»­i nhiá»u token draft hÆ¡n vÃ o mÃ´ hÃ¬nh Ä‘Ã­ch Ä‘á»ƒ xÃ¡c minh gÃ¢y ra chi phÃ­ cao hÆ¡n trong cÃ¡c á»©ng dá»¥ng thá»±c táº¿. Do Ä‘Ã³, chÃºng tÃ´i thay Ä‘á»•i cÃ¡c siÃªu tham sá»‘ nÃ y vÃ  bÃ¡o cÃ¡o tá»· lá»‡ tÄƒng tá»‘c trong Báº£ng 9 Ä‘á»ƒ tÃ¬m ra sá»± Ä‘Ã¡nh Ä‘á»•i tá»‘t hÆ¡n.
Äá»™ sÃ¢u 5 6 7 8 9
# Token 40 60 80 100 40 60 80 100 40 60 80 100 40 60 80 100 40 60 80 100
T=0L2 7BEAGLE-2 2.48x 2.78x 2.61x 2.69x 2.69x 2.66x 2.70x 2.79x 2.71x 2.86x 2.91x 2.95x 2.60x 2.60x 2.88x 2.89x 2.28x 2.54x 2.55x 2.65x
HASS-MG 3.09x 3.02x 3.04x 3.22x 3.08x 3.13x 3.19x 3.22x 3.14x 3.11x 3.29x 3.27x 3.07x 3.16x 3.31x 3.32x 2.78x 2.75x 2.95x 3.03x
L2 13BEAGLE-2 2.63x 2.96x 3.04x 3.06x 3.01x 3.02x 3.18x 3.22x 2.78x 3.12x 3.14x 3.24x 2.98x 3.12x 3.19x 3.26x 2.49x 2.64x 2.69x 2.72x
HASS-MG 3.25x 3.31x 3.24x 3.25x 3.33x 3.34x 3.49x 3.40x 3.19x 3.42x 3.36x 3.40x 3.15x 3.40x 3.40x 3.37x 2.70x 2.74x 3.09x 3.02x
T=1L2 7BEAGLE-2 2.31x 2.37x 2.55x 2.36x 2.42x 2.39x 2.33x 2.40x 2.49x 2.66x 2.65x 2.44x 2.36x 2.48x 2.38x 2.64x 2.29x 2.22x 2.27x 2.42x
HASS-MG 2.79x 2.89x 2.86x 2.88x 2.72x 2.75x 2.92x 2.82x 2.83x 2.76x 2.81x 2.75x 2.49x 2.68x 2.77x 2.77x 2.30x 2.35x 2.58x 2.50x
L2 13BEAGLE-2 2.92x 3.11x 2.88x 2.79x 3.06x 3.04x 3.16x 2.93x 3.05x 3.14x 3.14x 3.11x 3.00x 3.13x 3.15x 2.98x 2.61x 2.72x 2.65x 2.54x
HASS-MG 3.24x 3.30x 3.27x 3.19x 3.33x 3.33x 3.40x 3.28x 3.19x 3.26x 3.24x 3.26x 3.15x 3.26x 3.19x 3.17x 2.62x 2.77x 2.74x 2.84x
Báº£ng 9: Tá»· lá»‡ tÄƒng tá»‘c cá»§a EAGLE-2 vÃ  HASS-MG vá»›i cÃ¡c Ä‘á»™ sÃ¢u vÃ  sá»‘ lÆ°á»£ng token khÃ¡c nhau trÃªn bá»™ dá»¯ liá»‡u MT-bench vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}, trong Ä‘Ã³ HASS-MG kÃ½ hiá»‡u HASS Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i tá»± chÆ°ng cáº¥t. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat.
Khi 'Ä‘á»™ sÃ¢u' = 5, Ä‘á»™ dÃ i cháº¥p nháº­n tÆ°Æ¡ng Ä‘á»‘i nhá». Khi 'Ä‘á»™ sÃ¢u' = 9, chi phÃ­ xÃ¡c minh cá»±c ká»³ cao. Do Ä‘Ã³, khÃ´ng cÃ³ cÃ i Ä‘áº·t nÃ o trong sá»‘ nÃ y Ä‘áº¡t Ä‘Æ°á»£c tá»· lá»‡ tÄƒng tá»‘c Ä‘áº§y há»©a háº¹n. Äá»‘i vá»›i cáº£ HASS-MG vÃ  EAGLE-2, hiá»‡u suáº¥t tá»‘t nháº¥t Ä‘áº¡t Ä‘Æ°á»£c khi 'Ä‘á»™ sÃ¢u' âˆˆ {6,7,8} vÃ  '# token' âˆˆ {60,80,100}. HASS-MG liÃªn tá»¥c thu Ä‘Æ°á»£c hiá»‡u suáº¥t vÆ°á»£t trá»™i so vá»›i EAGLE-2 thÃ´ng qua Ä‘iá»u chá»‰nh siÃªu tham sá»‘ trÃªn cÃ¡c LLM vÃ  nhiá»‡t Ä‘á»™ khÃ¡c nhau.
17

--- TRANG 18 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.6 Sá» LÆ¯á»¢NG TOKEN HUáº¤N LUYá»†N
ÄÆ°á»£c truyá»n cáº£m há»©ng bá»Ÿi Yi et al. (2024), chÃºng tÃ´i láº¥y máº«u ngáº«u nhiÃªn cÃ¡c tá»· lá»‡ khÃ¡c nhau cá»§a bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n, tá»©c lÃ  bá»™ dá»¯ liá»‡u ShareGPT vá»›i 68,000 cuá»™c Ä‘á»‘i thoáº¡i, Ä‘á»ƒ kháº£o sÃ¡t áº£nh hÆ°á»Ÿng cá»§a sá»‘ lÆ°á»£ng token huáº¥n luyá»‡n. Cá»¥ thá»ƒ, chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh draft cá»§a HASS vÃ  EAGLE-2 vá»›i 1/8,1/4,1/2 vÃ  toÃ n bá»™ bá»™ dá»¯ liá»‡u ShareGPT vÃ  tÃ³m táº¯t káº¿t quáº£ trong HÃ¬nh 8 vÃ  Báº£ng 10.
1/8 1/4 1/2 1/1
LLaMA2-Chat 7B3456Äá»™ dÃ i Cháº¥p nháº­n
1/8 1/4 1/2 1/1
LLaMA2-Chat 13B3456
1/8 1/4 1/2 1/1
LLaMA3-Instruct 8B3456
1/8 1/4 1/2 1/1
LLaMA3-Instruct 70B3456
1/8 1/4 1/2 1/1
LLaMA2-Chat 7B234Tá»· lá»‡ TÄƒng tá»‘c
1/8 1/4 1/2 1/1
LLaMA2-Chat 13B234
1/8 1/4 1/2 1/1
LLaMA3-Instruct 8B234
1/8 1/4 1/2 1/1
LLaMA3-Instruct 70B234
HASS T=0
HASS T=1EAGLE-2 T=0
EAGLE-2 T=1
HÃ¬nh 8: Äá»™ dÃ i cháº¥p nháº­n Ï„ vÃ  tá»· lá»‡ tÄƒng tá»‘c cá»§a HASS vÃ  EAGLE-2 trung bÃ¬nh trÃªn MT-bench, HumanEval, vÃ  GSM8K vá»›i cÃ¡c tá»· lá»‡ khÃ¡c nhau cá»§a bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n, tá»©c lÃ  bá»™ dá»¯ liá»‡u ShareGPT vá»›i 68,000 cuá»™c Ä‘á»‘i thoáº¡i.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« HÃ¬nh 8, HASS liÃªn tá»¥c vÆ°á»£t trá»™i hÆ¡n EAGLE-2 dÆ°á»›i cÃ¡c tá»· lá»‡ khÃ¡c nhau cá»§a bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n vá»›i nhiá»‡t Ä‘á»™ T âˆˆ {0,1}. HASS vá»›i chá»‰ 1/4 bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘t hÆ¡n hoáº·c tÆ°Æ¡ng Ä‘Æ°Æ¡ng so vá»›i EAGLE-2 vá»›i toÃ n bá»™ bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n, Ä‘iá»u nÃ y chá»©ng minh kháº£ nÄƒng khai thÃ¡c dá»¯ liá»‡u vÃ  kháº£ nÄƒng má»Ÿ rá»™ng vÆ°á»£t trá»™i cá»§a HASS thu Ä‘Æ°á»£c thÃ´ng qua viá»‡c cÄƒn chá»‰nh thÃªm vá» má»¥c tiÃªu vÃ  ngá»¯ cáº£nh giá»¯a huáº¥n luyá»‡n vÃ  giáº£i mÃ£. Tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n cá»§a HASS vÃ  EAGLE-2 tá»· lá»‡ thuáº­n logarithmic vá»›i quy mÃ´ dá»¯ liá»‡u huáº¥n luyá»‡n, Ä‘iá»u nÃ y nháº¥t quÃ¡n vá»›i phÃ¡t hiá»‡n trong Yi et al. (2024). NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« Báº£ng 10, viá»‡c giáº£m dá»¯ liá»‡u huáº¥n luyá»‡n gÃ³p pháº§n vÃ o sá»± suy thoÃ¡i nghiÃªm trá»ng hÆ¡n trÃªn EAGLE-2 so vá»›i trÃªn HASS, pháº£n Ã¡nh tÃ­nh máº¡nh máº½ cá»§a HASS Ä‘á»‘i vá»›i sá»± khan hiáº¿m dá»¯ liá»‡u.
18

--- TRANG 19 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
MT-bench HumanEval GSM8K Trung bÃ¬nh
MÃ´ hÃ¬nh PhÆ°Æ¡ng phÃ¡p Tá»· lá»‡ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„ TÄƒng tá»‘c Ï„
T=0L2 7BEAGLE-21/8 1.74x 3.06 2.00x 3.39 2.12x 3.24 1.95x 3.23
1/4 2.08x 3.64 2.49x 3.93 2.21x 3.81 2.26x 3.79
1/2 2.36x 4.11 2.76x 4.46 2.64x 4.28 2.59x 4.28
1/1 2.66x 4.44 3.06x 4.78 2.72x 4.60 2.81x 4.61
HASS1/8 2.32x 3.92 2.69x 4.30 2.56x 4.12 2.52x 4.11
1/4 2.64x 4.42 3.05x 4.76 2.70x 4.59 2.80x 4.59
1/2 2.85x 4.79 3.36x 5.05 3.18x 4.94 3.13x 4.93
1/1 2.99x 4.99 3.41x 5.29 3.32x 5.17 3.24x 5.15
L2 13BEAGLE-21/8 1.88x 3.25 2.39x 3.79 2.27x 3.57 2.18x 3.54
1/4 2.38x 3.82 2.85x 4.53 2.79x 4.25 2.67x 4.20
1/2 2.74x 4.32 3.46x 5.18 3.08x 4.81 3.09x 4.77
1/1 3.02x 4.74 3.64x 5.57 3.23x 5.17 3.30x 5.16
HASS1/8 2.59x 4.01 3.37x 4.79 3.01x 4.43 2.99x 4.41
1/4 2.89x 4.55 3.59x 5.51 3.18x 5.00 3.22x 5.02
1/2 3.16x 4.90 4.20x 5.86 3.41x 5.31 3.59x 5.36
1/1 3.23x 5.13 4.24x 6.05 3.48x 5.55 3.65x 5.58
L3 8BEAGLE-21/8 1.54x 2.77 2.00x 3.12 1.61x 2.83 1.72x 2.91
1/4 1.89x 3.18 2.30x 3.59 2.08x 3.35 2.09x 3.37
1/2 2.24x 3.68 2.64x 4.16 2.42x 3.91 2.43x 3.92
1/1 2.64x 4.21 3.31x 4.93 2.54x 4.42 2.83x 4.52
HASS1/8 2.14x 3.61 2.84x 4.22 2.30x 3.78 2.43x 3.87
1/4 2.46x 4.04 3.24x 4.83 2.48x 4.27 2.73x 4.38
1/2 2.72x 4.43 3.38x 5.28 2.99x 4.71 3.03x 4.81
1/1 2.78x 4.68 3.43x 5.54 3.06x 5.02 3.09x 5.08
L3 70BEAGLE-21/8 2.09x 2.87 2.72x 3.45 2.29x 2.92 2.37x 3.08
1/4 2.47x 3.33 3.25x 4.01 2.71x 3.46 2.81x 3.60
1/2 2.76x 3.74 3.71x 4.57 3.11x 3.96 3.19x 4.09
1/1 2.94x 4.10 3.98x 5.02 3.19x 4.37 3.37x 4.50
HASS1/8 2.73x 3.68 3.79x 4.61 3.10x 3.95 3.21x 4.08
1/4 3.05x 4.12 4.23x 5.18 3.56x 4.54 3.61x 4.61
1/2 3.27x 4.40 4.52x 5.57 3.87x 4.92 3.89x 4.96
1/1 3.40x 4.62 4.68x 5.78 4.08x 5.24 4.05x 5.21
T=1L2 7BEAGLE-21/8 1.60x 2.99 1.90x 3.21 1.86x 3.17 1.79x 3.12
1/4 1.89x 3.48 2.28x 3.71 2.27x 3.71 2.15x 3.63
1/2 2.26x 3.93 2.57x 4.14 2.46x 4.17 2.43x 4.08
1/1 2.39x 4.23 2.87x 4.47 2.54x 4.50 2.60x 4.40
HASS1/8 2.19x 3.82 2.50x 4.06 2.41x 4.03 2.37x 3.97
1/4 2.50x 4.27 2.84x 4.46 2.61x 4.52 2.65x 4.42
1/2 2.63x 4.56 3.10x 4.75 2.81x 4.81 2.85x 4.71
1/1 2.70x 4.84 3.13x 4.91 2.87x 5.01 2.90x 4.92
L2 13BEAGLE-21/8 1.91x 3.16 2.18x 3.71 2.23x 3.46 2.11x 3.44
1/4 2.31x 3.68 2.72x 4.40 2.77x 4.11 2.60x 4.06
1/2 2.78x 4.20 3.19x 5.00 3.08x 4.67 3.02x 4.62
1/1 3.04x 4.60 3.45x 5.41 3.13x 5.03 3.21x 5.01
HASS1/8 2.49x 3.94 2.98x 4.70 2.99x 4.33 2.82x 4.32
1/4 2.87x 4.43 3.40x 5.35 3.11x 4.87 3.13x 4.88
1/2 3.22x 4.75 3.70x 5.69 3.26x 5.18 3.39x 5.21
1/1 3.28x 4.98 3.78x 5.86 3.37x 5.41 3.48x 5.42
L3 8BEAGLE-21/8 1.51x 2.64 1.63x 3.01 1.64x 2.81 1.59x 2.82
1/4 1.77x 2.99 1.87x 3.51 1.92x 3.29 1.85x 3.26
1/2 1.90x 3.40 2.25x 4.03 2.38x 3.82 2.18x 3.75
1/1 2.39x 3.90 2.54x 4.73 2.48x 4.30 2.47x 4.31
HASS1/8 1.96x 3.42 2.31x 4.10 2.25x 3.72 2.17x 3.75
1/4 2.22x 3.77 2.51x 4.63 2.45x 4.18 2.39x 4.19
1/2 2.43x 4.10 2.96x 5.07 2.82x 4.56 2.74x 4.58
1/1 2.49x 4.26 3.05x 5.30 2.89x 4.85 2.81x 4.80
L3 70BEAGLE-21/8 2.16x 2.85 2.52x 3.35 2.19x 2.91 2.29x 3.04
1/4 2.26x 3.29 3.01x 3.94 2.57x 3.44 2.61x 3.56
1/2 2.70x 3.67 3.37x 4.47 3.00x 3.94 3.02x 4.03
1/1 3.02x 4.00 3.61x 4.93 3.21x 4.35 3.28x 4.43
HASS1/8 2.80x 3.70 3.46x 4.52 2.98x 3.93 3.08x 4.05
1/4 3.10x 4.10 3.90x 5.11 3.41x 4.51 3.47x 4.57
1/2 3.28x 4.36 4.15x 5.46 3.72x 4.91 3.72x 4.91
1/1 3.43x 4.59 4.25x 5.68 3.87x 5.20 3.85x 5.16
Báº£ng 10: Tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vÃ  EAGLE-2 vá»›i cÃ¡c tá»· lá»‡ khÃ¡c nhau cá»§a bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n, tá»©c lÃ  bá»™ dá»¯ liá»‡u ShareGPT vá»›i 68,000 cuá»™c Ä‘á»‘i thoáº¡i. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat, trong khi L3 Ä‘áº¡i diá»‡n cho LLaMA3-Instruct.
19

--- TRANG 20 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.7 ÄÃNH GIÃ TRÃŠN CÃC NHIá»†M Vá»¤ Dá»ŠCH THUáº¬T
Äá»ƒ kháº£o sÃ¡t tÃ­nh máº¡nh máº½ cá»§a HASS trÃªn cÃ¡c loáº¡i nhiá»‡m vá»¥ khÃ¡c nhau, chÃºng tÃ´i tiáº¿p tá»¥c Ä‘Ã¡nh giÃ¡ HASS vÃ  EAGLE-2 trÃªn nÄƒm nhiá»‡m vá»¥ dá»‹ch thuáº­t3 báº±ng cÃ¡ch theo Yi et al. (2024). ÄÃ¡ng chÃº Ã½ lÃ  cáº£ HASS vÃ  EAGLE-2 Ä‘á»u Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn bá»™ dá»¯ liá»‡u ShareGPT cá»‘ Ä‘á»‹nh mÃ  khÃ´ng thÃ­ch á»©ng cho cÃ¡c nhiá»‡m vá»¥ dá»‹ch thuáº­t. ChÃºng tÃ´i tiáº¿n hÃ nh thÃ­ nghiá»‡m trÃªn LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B vÃ  tÃ³m táº¯t káº¿t quáº£ trong Báº£ng 11.
Deâ†’En Fr â†’En Ja â†’En Ru â†’En Zh â†’En Trung bÃ¬nh
MÃ´ hÃ¬nh PhÆ°Æ¡ng phÃ¡p TÄƒng tá»‘c Ï„TÄƒng tá»‘c Ï„TÄƒng tá»‘c Ï„TÄƒng tá»‘c Ï„TÄƒng tá»‘c Ï„TÄƒng tá»‘c Ï„
T=0L2 7BEAGLE-2 2.58x 4.06 2.47x 3.99 2.46x 3.79 2.23x 3.48 2.39x 3.68 2.43x 3.80
HASS 3.15x 4.55 2.99x 4.60 2.97x 4.26 2.64x 3.82 2.83x 4.10 2.92x 4.27
L2 13BEAGLE-2 2.95x 4.51 3.00x 4.41 2.67x 3.80 2.61x 3.65 2.60x 3.92 2.77x 4.06
HASS 3.63x 5.01 3.64x 4.94 3.05x 4.07 3.06x 4.03 3.02x 4.22 3.28x 4.45
L3 8BEAGLE-2 2.59x 3.89 2.34x 3.96 1.91x 2.97 1.90x 3.25 2.03x 3.17 2.15x 3.45
HASS 2.98x 4.30 2.79x 4.21 2.21x 3.19 2.28x 3.53 2.32x 3.38 2.52x 3.72
L3 70BEAGLE-2 3.10x 4.17 3.13x 4.07 2.35x 3.16 2.79x 3.76 2.52x 3.39 2.78x 3.71
HASS 3.75x 4.71 3.61x 4.47 2.67x 3.41 3.39x 4.25 2.84x 3.72 3.25x 4.12
T=1L2 7BEAGLE-2 2.26x 3.86 2.41x 3.91 2.09x 3.58 1.98x 3.34 2.25x 3.61 2.20x 3.66
HASS 2.80x 4.44 2.99x 4.59 2.66x 4.11 2.53x 3.74 2.65x 4.05 2.73x 4.19
L2 13BEAGLE-2 2.97x 4.29 2.77x 4.31 2.45x 3.73 2.33x 3.51 2.47x 3.72 2.60x 3.91
HASS 3.45x 4.88 3.22x 4.84 3.02x 4.13 2.79x 3.97 2.83x 4.01 3.06x 4.37
L3 8BEAGLE-2 2.23x 3.67 2.21x 3.69 1.85x 2.79 1.94x 3.15 1.89x 3.03 2.02x 3.27
HASS 2.80x 4.13 2.73x 4.08 2.21x 3.18 2.35x 3.54 2.11x 3.34 2.44x 3.65
L3 70BEAGLE-2 2.97x 4.02 2.95x 3.89 2.37x 3.16 2.72x 3.65 2.44x 3.34 2.69x 3.61
HASS 3.71x 4.67 3.49x 4.38 2.83x 3.47 3.25x 4.11 2.75x 3.70 3.21x 4.07
Báº£ng 11: Tá»· lá»‡ tÄƒng tá»‘c vÃ  Ä‘á»™ dÃ i cháº¥p nháº­n Ï„ cá»§a HASS vÃ  EAGLE-2 trÃªn nÄƒm nhiá»‡m vá»¥ dá»‹ch thuáº­t, trong Ä‘Ã³ cÃ¡c mÃ´ hÃ¬nh draft Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i bá»™ dá»¯ liá»‡u ShareGPT cá»‘ Ä‘á»‹nh. De, Fr, Ja, Ru, Zh, vÃ  En viáº¿t táº¯t cho tiáº¿ng Äá»©c, tiáº¿ng PhÃ¡p, tiáº¿ng Nháº­t, tiáº¿ng Nga, tiáº¿ng Trung, vÃ  tiáº¿ng Anh tÆ°Æ¡ng á»©ng. L2 Ä‘áº¡i diá»‡n cho LLaMA2-Chat, trong khi L3 Ä‘áº¡i diá»‡n cho LLaMA3-Instruct.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« Báº£ng 11, HASS liÃªn tá»¥c vÆ°á»£t trá»™i hÆ¡n EAGLE-2 dÆ°á»›i táº¥t cáº£ cÃ¡c cÃ i Ä‘áº·t. HASS Ä‘áº¡t Ä‘Æ°á»£c tá»· lá»‡ tÄƒng tá»‘c thá»i gian thá»±c tá»« 2.44x-3.28x trung bÃ¬nh trÃªn nÄƒm nhiá»‡m vá»¥ dá»‹ch thuáº­t, vÆ°á»£t trá»™i hÆ¡n EAGLE-2 tá»« 17%-24%. Vá» Ä‘á»™ dÃ i cháº¥p nháº­n, HASS Ä‘áº¡t Ä‘Æ°á»£c cáº£i thiá»‡n 8%-14% so vá»›i EAGLE-2. Nháº¥t quÃ¡n vá»›i káº¿t quáº£ trÃªn cÃ¡c nhiá»‡m vá»¥ Ä‘á»‘i thoáº¡i (MT-bench), táº¡o mÃ£ (HumanEval), vÃ  lÃ½ luáº­n toÃ¡n há»c (GSM8K), HASS cho tháº¥y nhá»¯ng cáº£i thiá»‡n Ä‘áº§y há»©a háº¹n so vá»›i EAGLE-2 trÃªn cÃ¡c nhiá»‡m vá»¥ dá»‹ch thuáº­t, pháº£n Ã¡nh tÃ­nh máº¡nh máº½ cá»§a nÃ³ trÃªn cÃ¡c loáº¡i nhiá»‡m vá»¥ khÃ¡c nhau.
3https://github.com/Kthyeon/Multilingual-SpecBench
20

--- TRANG 21 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
A.8 CHI PHÃ HUáº¤N LUYá»†N
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« Báº£ng 4, huáº¥n luyá»‡n vá»›i 3/4 bÆ°á»›c cÄƒn chá»‰nh ngá»¯ cáº£nh hÃ i hÃ²a thÆ°á»ng thu Ä‘Æ°á»£c Ä‘á»™ dÃ i cháº¥p nháº­n Ä‘Ã¡ng ká»ƒ nháº¥t, vÃ  do Ä‘Ã³ bÆ°á»›c cÄƒn chá»‰nh cá»§a HASS Ä‘Æ°á»£c cá»‘ Ä‘á»‹nh lÃ  3 (TiÃªu chuáº©n) trong bÃ i bÃ¡o nÃ y trá»« khi cÃ³ nÃªu khÃ¡c. Äá»ƒ kháº£o sÃ¡t chi phÃ­ huáº¥n luyá»‡n thá»±c táº¿ cá»§a HASS, chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh draft cho LLaMA2-Chat 7/13B vÃ  LLaMA3-Instruct 8/70B trÃªn má»™t GPU NVIDIA H800 duy nháº¥t vá»›i kÃ­ch thÆ°á»›c batch Ä‘áº·t lÃ  2 vÃ  cÃ¡c bÆ°á»›c cÄƒn chá»‰nh khÃ¡c nhau, vÃ  tÃ³m táº¯t káº¿t quáº£ vá» tá»‘c Ä‘á»™ huáº¥n luyá»‡n, chi phÃ­ tÃ­nh toÃ¡n, vÃ  bá»™ nhá»› GPU trong HÃ¬nh 9, 10, vÃ  11 tÆ°Æ¡ng á»©ng. ÄÃ¡ng nÃ³i lÃ  chi phÃ­ huáº¥n luyá»‡n cá»§a HASS vá»›i 1 bÆ°á»›c cÄƒn chá»‰nh giá»‘ng nhÆ° cá»§a EAGLE-2.
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5012345678Tá»‘c Ä‘á»™ Huáº¥n luyá»‡n (batch/s)6.07
5.56
3.93
2.61
1.78LLaMA2-Chat 7B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5012345678
4.70 4.61
3.09
2.04
1.46LLaMA2-Chat 13B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5012345678
6.75
5.39
3.53
2.46
1.77LLaMA3-Instruct 8B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5012345678
2.972.62
1.77
1.240.92LLaMA3-Instruct 70B
HÃ¬nh 9: Tá»‘c Ä‘á»™ huáº¥n luyá»‡n (batch/s) cá»§a HASS vá»›i cÃ¡c bÆ°á»›c cÄƒn chá»‰nh khÃ¡c nhau, trong Ä‘Ã³ tá»‘c Ä‘á»™ cá»§a Align-1 giá»‘ng nhÆ° cá»§a EAGLE/EAGLE-2.
Tá»‘c Ä‘á»™ huáº¥n luyá»‡n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ báº±ng sá»‘ batch cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ trong má»™t giÃ¢y, tá»©c lÃ  batch/s, vÃ  tá»· lá»‡ giá»¯a Align-1 vÃ  Align- j Ä‘áº¡i diá»‡n cho thá»i gian huáº¥n luyá»‡n cáº§n thiáº¿t Ä‘á»ƒ thá»±c hiá»‡n cÃ¹ng lÆ°á»£ng dá»¯ liá»‡u huáº¥n luyá»‡n so vá»›i EAGLE-2. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ tá»« HÃ¬nh 9, tá»‘c Ä‘á»™ huáº¥n luyá»‡n giáº£m vá»›i nhiá»u bÆ°á»›c cÄƒn chá»‰nh hÆ¡n. Tuy nhiÃªn, thá»i gian huáº¥n luyá»‡n thá»±c táº¿ cá»§a HASS tiÃªu chuáº©n (Align-3) chá»‰ nhiá»u hÆ¡n 66.34% so vá»›i EAGLE-2 trung bÃ¬nh trÃªn bá»‘n mÃ´ hÃ¬nh Ä‘Ã­ch, vÃ  chi phÃ­ thá»i gian thÃªm cao nháº¥t so vá»›i EAGLE-2 chá»‰ lÃ  91.47% (trÃªn LLaMA3-Instruct 8B). Chi phÃ­ huáº¥n luyá»‡n cá»§a HASS hoÃ n toÃ n cÃ³ thá»ƒ cháº¥p nháº­n Ä‘Æ°á»£c, trong khi HASS Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t vÆ°á»£t trá»™i vÃ  yÃªu cáº§u chi phÃ­ suy luáº­n khÃ´ng Ä‘á»•i.
0 5 10 15 20Align-1
(EAGLE)Align-2Align-3Align-4Align-5Tiáº¿n trÃ¬nhLLaMA2-Chat 7B
0 10 20 30Align-1
(EAGLE)Align-2Align-3Align-4Align-5LLaMA2-Chat 13B
0 10 20 30 40Align-1
(EAGLE)Align-2Align-3Align-4Align-5LLaMA3-Instruct 8B
0 20 40 60 80 100Align-1
(EAGLE)Align-2Align-3Align-4Align-5LLaMA3-Instruct 70B
Pháº§n Cá»‘ Ä‘á»‹nh
Pháº§n Attention
KhÃ¡c
0 20 40 60
TFLOPsAlign-1
(EAGLE)Align-2Align-3Align-4Align-5Tá»•ng
0 20 40 60 80 100
TFLOPsAlign-1
(EAGLE)Align-2Align-3Align-4Align-5
0 25 50 75 100
TFLOPsAlign-1
(EAGLE)Align-2Align-3Align-4Align-5
0 100 200 300
TFLOPsAlign-1
(EAGLE)Align-2Align-3Align-4Align-5
Tiáº¿n trÃ¬nh
NgÆ°á»£c
HÃ¬nh 10: FLOPs huáº¥n luyá»‡n cá»§a HASS vá»›i cÃ¡c bÆ°á»›c cÄƒn chá»‰nh khÃ¡c nhau, trong Ä‘Ã³ chi phÃ­ tÃ­nh toÃ¡n cá»§a Align-1 giá»‘ng nhÆ° cá»§a EAGLE/EAGLE-2. CÃ¡c hÃ¬nh trÃªn hiá»ƒn thá»‹ FLOPs cá»§a bÆ°á»›c tiáº¿n trÃ¬nh, trong khi cÃ¡c hÃ¬nh dÆ°á»›i hiá»ƒn thá»‹ FLOPs tá»•ng cá»™ng (bÆ°á»›c tiáº¿n trÃ¬nh vÃ  ngÆ°á»£c).
Chi phÃ­ tÃ­nh toÃ¡n Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ báº±ng TFLOPs vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c chia thÃ nh bÆ°á»›c tiáº¿n trÃ¬nh vÃ  bÆ°á»›c ngÆ°á»£c, chÃºng tÃ´i mÃ´ táº£ chi phÃ­ cá»§a bÆ°á»›c tiáº¿n trÃ¬nh vÃ  bÆ°á»›c ngÆ°á»£c trong cÃ¡c hÃ¬nh trÃªn vÃ  dÆ°á»›i trong HÃ¬nh 10 tÆ°Æ¡ng á»©ng. Chi phÃ­ cá»§a bÆ°á»›c tiáº¿n trÃ¬nh gá»“m ba pháº§n:
â€¢ Pháº§n cá»‘ Ä‘á»‹nh khÃ´ng thay Ä‘á»•i theo sá»‘ bÆ°á»›c cÄƒn chá»‰nh. Ãnh xáº¡ tráº¡ng thÃ¡i áº©n cá»§a LLM Ä‘Ã­ch thÃ nh q(x) (tham kháº£o pháº§n 3.1) vá»›i LM head Ä‘á»ƒ chÆ°ng cáº¥t mÃ´ hÃ¬nh draft Ä‘Æ°á»£c bao gá»“m trong pháº§n cá»‘ Ä‘á»‹nh.
21

--- TRANG 22 ---
ÄÆ°á»£c xuáº¥t báº£n nhÆ° má»™t bÃ i bÃ¡o há»™i nghá»‹ táº¡i ICLR 2025
â€¢ Pháº§n attention tá»· lá»‡ thuáº­n tuyáº¿n tÃ­nh vá»›i sá»‘ lÆ°á»£ng tráº¡ng thÃ¡i áº©n Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ´ hÃ¬nh draft, Ä‘Æ°á»£c tÃ­ch lÅ©y qua cÃ¡c bÆ°á»›c huáº¥n luyá»‡n HASS, tá»©c lÃ  Pj
i=1i cho Align- j. Káº¿t há»£p token embedding vá»›i tráº¡ng thÃ¡i áº©n, chiáº¿u tráº¡ng thÃ¡i áº©n thÃ nh key vÃ  value, vÃ  tiáº¿n hÃ nh cÃ¡c phÃ©p toÃ¡n attention giá»¯a query vÃ  má»™t sá»‘ cáº·p kv-pair cÃ³ nguá»“n gá»‘c tá»« cÃ¡c tráº¡ng thÃ¡i áº©n khÃ¡c nhau Ä‘Æ°á»£c bao gá»“m trong pháº§n attention.
â€¢ KhÃ¡c tá»· lá»‡ thuáº­n tuyáº¿n tÃ­nh vá»›i sá»‘ bÆ°á»›c cÄƒn chá»‰nh, tá»©c lÃ  j cho Align- j. Chi phÃ­ tÃ­nh toÃ¡n ngoÃ i cÃ¡c pháº§n cá»‘ Ä‘á»‹nh vÃ  attention Ä‘Æ°á»£c bao gá»“m trong khÃ¡c.
Chi phÃ­ cá»§a bÆ°á»›c ngÆ°á»£c cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  (A+O)Ã—2, trong Ä‘Ã³ A vÃ  O Ä‘áº¡i diá»‡n cho pháº§n attention vÃ  khÃ¡c tÆ°Æ¡ng á»©ng, vÃ¬ tÃ­nh toÃ¡n cá»§a pháº§n cá»‘ Ä‘á»‹nh khÃ´ng yÃªu cáº§u gradient. NÃ³i chung, HASS tiÃªu chuáº©n (Align-3) yÃªu cáº§u khoáº£ng 3x chi phÃ­ tÃ­nh toÃ¡n cá»§a EAGLE-2.
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5681012141618202 Bá»™ nhá»› GPU (GB)
LLaMA2-Chat 7B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-510.012.515.017.520.022.525.0
LLaMA2-Chat 13B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-51416182022242628
LLaMA3-Instruct 8B
Align-1
(EAGLE)Align-2 Align-3 Align-4 Align-5303540455055
LLaMA3-Instruct 70B
Trung bÃ¬nh Äá»‰nh
HÃ¬nh 11: Bá»™ nhá»› GPU huáº¥n luyá»‡n cá»§a HASS vá»›i cÃ¡c bÆ°á»›c cÄƒn chá»‰nh khÃ¡c nhau, trong Ä‘Ã³ bá»™ nhá»› GPU cá»§a Align-1 giá»‘ng nhÆ° cá»§a EAGLE/EAGLE-2. Trung bÃ¬nh vÃ  Äá»‰nh viáº¿t táº¯t cho bá»™ nhá»› GPU trung bÃ¬nh vÃ  Ä‘á»‰nh qua quÃ¡ trÃ¬nh huáº¥n luyá»‡n tÆ°Æ¡ng á»©ng.
Bá»™ nhá»› GPU Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ báº±ng GB vÃ  chÃºng tÃ´i bÃ¡o cÃ¡o bá»™ nhá»› GPU trung bÃ¬nh vÃ  Ä‘á»‰nh qua quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Cáº£ bá»™ nhá»› GPU trung bÃ¬nh vÃ  Ä‘á»‰nh Ä‘á»u tÄƒng vá»›i nhiá»u bÆ°á»›c cÄƒn chá»‰nh hÆ¡n. YÃªu cáº§u bá»™ nhá»› GPU cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘Ã¡p á»©ng bá»Ÿi má»™t GPU NVIDIA H800 duy nháº¥t ngay cáº£ á»Ÿ Align-5 vÃ  kÃ­ch thÆ°á»›c batch Ä‘áº·t lÃ  2.
22
