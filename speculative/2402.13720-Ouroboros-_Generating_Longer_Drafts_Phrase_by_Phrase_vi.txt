# 2402.13720.pdf
# ÄÆ°á»£c chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/speculative/2402.13720.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 803689 byte

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
Ouroboros: Táº¡o ra Báº£n Thè‰ DÃ i HÆ¡n Theo Tá»«ng Cá»¥m Tá»«
Ä‘á»ƒ Giáº£i MÃ£ Suy ÄoÃ¡n Nhanh HÆ¡n
Weilin Zhao1*, Yuxiang Huang1âˆ—, Xu Han1,2â€ , Wang Xu1, Chaojun Xiao1,
Xinrong Zhang1,Yewei Fang3,Kaihuo Zhang3,Zhiyuan Liu1â€ ,Maosong Sun1
1Khoa Khoa há»c MÃ¡y tÃ­nh vÃ  CÃ´ng nghá»‡, Viá»‡n TrÃ­ tuá»‡ NhÃ¢n táº¡o,
Trung tÃ¢m NghiÃªn cá»©u Quá»‘c gia Báº¯c Kinh vá» Khoa há»c vÃ  CÃ´ng nghá»‡ ThÃ´ng tin,
Äáº¡i há»c Thanh Hoa, Báº¯c Kinh, Trung Quá»‘c.
2PhÃ²ng thÃ­ nghiá»‡m TrÃ­ tuá»‡ NhÃ¢n táº¡o ThÆ°á»£ng Háº£i, ThÆ°á»£ng Háº£i, Trung Quá»‘c.3ModelBest Inc.
{zwl23,huang-yx21}@mails.tsinghua.edu.cn, {hanxu2022,liuzy}@tsinghua.edu.cn
TÃ³m táº¯t
Giáº£i mÃ£ suy Ä‘oÃ¡n lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i
nháº±m tÄƒng tá»‘c quÃ¡ trÃ¬nh táº¡o ra cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM) mÃ  khÃ´ng cÃ³ sá»±
thá»a hiá»‡p nÃ o trong hiá»‡u suáº¥t mÃ´ hÃ¬nh. NÃ³ Ä‘áº¡t Ä‘Æ°á»£c
má»¥c tiÃªu nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh nhá» hÆ¡n hiá»‡n cÃ³
Ä‘á»ƒ soáº¡n tháº£o vÃ  sau Ä‘Ã³ sá»­ dá»¥ng LLM Ä‘Ã­ch Ä‘á»ƒ xÃ¡c minh báº£n tháº£o theo cÃ¡ch song song
chi phÃ­ tháº¥p. DÆ°á»›i khung soáº¡n tháº£o-xÃ¡c minh
nhÆ° váº­y, hiá»‡u quáº£ soáº¡n tháº£o Ä‘Ã£ trá»Ÿ thÃ nh má»™t
nÃºt tháº¯t cá»• chai trong tá»‘c Ä‘á»™ cuá»‘i cÃ¹ng cá»§a giáº£i
mÃ£ suy Ä‘oÃ¡n. Do Ä‘Ã³, táº¡o ra cÃ¡c báº£n tháº£o dÃ i hÆ¡n
vá»›i chi phÃ­ Ã­t hÆ¡n cÃ³ thá»ƒ dáº«n Ä‘áº¿n tá»‘c Ä‘á»™ giáº£i mÃ£
tá»‘t hÆ¡n. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i giá»›i thiá»‡u
Ouroboros, cÃ³ thá»ƒ táº¡o ra cÃ¡c cá»¥m tá»« tháº£o
Ä‘á»ƒ song song hÃ³a quÃ¡ trÃ¬nh soáº¡n tháº£o vÃ  Ä‘á»“ng thá»i
lÃ m dÃ i cÃ¡c báº£n tháº£o theo cÃ¡ch khÃ´ng cáº§n Ä‘Ã o táº¡o.
Káº¿t quáº£ thá»±c nghiá»‡m trÃªn cÃ¡c nhiá»‡m vá»¥ táº¡o vÄƒn báº£n
Ä‘iá»ƒn hÃ¬nh khÃ¡c nhau cho tháº¥y Ouroboros cÃ³ thá»ƒ
Ä‘áº¡t tá»‘c Ä‘á»™ tÄƒng lÃªn Ä‘áº¿n 2.8Ã— so vá»›i giáº£i
mÃ£ suy Ä‘oÃ¡n vÃ  3.9Ã— so vá»›i giáº£i mÃ£ vanilla,
mÃ  khÃ´ng cáº§n tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh tháº£o vÃ  Ä‘Ã­ch.
MÃ£ nguá»“n cá»§a Ouroboros cÃ³ sáºµn táº¡i
https://github.com/thunlp/Ouroboros.
1 Giá»›i thiá»‡u
HÆ°á»Ÿng lá»£i tá»« nhá»¯ng tiáº¿n bá»™ gáº§n Ä‘Ã¢y trong cÃ¡c thiáº¿t bá»‹
tÃ­nh toÃ¡n song song vÃ  thuáº­t toÃ¡n Ä‘Ã o táº¡o phÃ¢n tÃ¡n
(Shoeybi et al., 2019; Rasley et al., 2020),
thá»i gian Ä‘Ã o táº¡o cá»§a LLM Ä‘Ã£ Ä‘Æ°á»£c rÃºt ngáº¯n Ä‘Ã¡ng ká»ƒ.
Tuy nhiÃªn, váº«n cÃ²n thÃ¡ch thá»©c Ä‘á»ƒ
Ä‘áº¡t Ä‘Æ°á»£c song song hÃ³a trong suy luáº­n mÃ´ hÃ¬nh vÃ¬
háº§u háº¿t cÃ¡c LLM dá»±a trÃªn cÆ¡ cháº¿ táº¡o
tá»± há»“i quy thá»ƒ hiá»‡n sá»± phá»¥ thuá»™c tuáº§n tá»±
giá»¯a cÃ¡c token Ä‘Æ°á»£c táº¡o ra. Äá»‘i vá»›i nhá»¯ng
LLM tá»± há»“i quy nÃ y, chÃºng pháº£i táº¡o token tá»«ng cÃ¡i má»™t.
Äá»ƒ tÄƒng tá»‘c suy luáº­n cá»§a LLM, cÃ¡c phÆ°Æ¡ng phÃ¡p
nÃ©n mÃ´ hÃ¬nh Ä‘iá»ƒn hÃ¬nh nhÆ° lÆ°á»£ng tá»­ hÃ³a
(Frantar et al., 2023; Lin et al., 2023; Kim
et al., 2023) vÃ  cáº¯t tá»‰a (Han et al., 2015; Wang
*cho biáº¿t Ä‘Ã³ng gÃ³p báº±ng nhau.
â€ cho biáº¿t tÃ¡c giáº£ tÆ°Æ¡ng á»©ng.
0.068 1.1 7 13
KÃ­ch thÆ°á»›c MÃ´ hÃ¬nh Tháº£o (B)15.015.516.016.517.0Tá»‘c Ä‘á»™ Giáº£i mÃ£ (token/s)
4 6 8 10
Äá»™ dÃ i Tháº£o (#token)
 cá»§a MÃ´ hÃ¬nh Tháº£o 7B16.517.017.518.0Tá»‘c Ä‘á»™ Giáº£i mÃ£ (token/s)1234
#Token Tháº£o ChÃ­nh xÃ¡c (Trung bÃ¬nh)3.03.54.04.5
#Token Tháº£o ChÃ­nh xÃ¡c (Trung bÃ¬nh)HÃ¬nh 1: Sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t soáº¡n tháº£o.
HÃ¬nh minh há»a tá»‘c Ä‘á»™ giáº£i mÃ£ suy Ä‘oÃ¡n tá»‘i Æ°u cá»§a
Llama-2-chat-70B trÃªn MT-Bench (Zheng et al., 2024) vÃ 
sá»‘ lÆ°á»£ng token tháº£o chÃ­nh xÃ¡c trung bÃ¬nh tÆ°Æ¡ng á»©ng táº¡i má»—i vÃ²ng láº·p.
et al., 2020; Xia et al., 2023b) cÃ³ thá»ƒ gÃ¢y suy giáº£m
hiá»‡u suáº¥t mÃ´ hÃ¬nh vÃ  Ä‘Ã´i khi tháº­m chÃ­ yÃªu cáº§u
chi phÃ­ Ä‘Ã o táº¡o bá»• sung khÃ´ng Ä‘Ã¡ng ká»ƒ. Äá»ƒ
tÄƒng tá»‘c suy luáº­n cá»§a LLM mÃ  khÃ´ng máº¥t mÃ¡t,
giáº£i mÃ£ suy Ä‘oÃ¡n (Xia et al., 2023a; Leviathan et al.,
2023; Chen et al., 2023a) Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» xuáº¥t. Vá»›i
má»™t LLM Ä‘Ã­ch, giáº£i mÃ£ suy Ä‘oÃ¡n chá»n má»™t
LLM nhá» hÆ¡n nhiá»u lÃ m mÃ´ hÃ¬nh tháº£o Ä‘á»ƒ táº¡o ra
nhiá»u token nhÆ° má»™t báº£n tháº£o. LLM Ä‘Ã­ch sau Ä‘Ã³ xem xÃ©t
báº£n tháº£o má»™t cÃ¡ch song song, cháº¥p nháº­n tiá»n tá»‘ chÃ­nh xÃ¡c dÃ i nháº¥t
trong khi loáº¡i bá» cÃ¡c token tháº£o cÃ²n láº¡i.
DÆ°á»›i khung soáº¡n tháº£o-xÃ¡c minh nhÆ° váº­y,
cÃ¡ch táº¡o ra cÃ¡c báº£n tháº£o dÃ i vÃ  chÃ­nh xÃ¡c má»™t cÃ¡ch hiá»‡u quáº£
Ä‘Ã£ trá»Ÿ thÃ nh má»™t yáº¿u tá»‘ quan trá»ng trong viá»‡c tÄƒng tá»‘c
suy luáº­n LLM. NhÆ° trong HÃ¬nh 1, chÃºng tÃ´i kiá»ƒm tra sá»± Ä‘Ã¡nh Ä‘á»•i
giá»¯a kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh tháº£o vÃ  tá»‘c Ä‘á»™ giáº£i mÃ£ suy Ä‘oÃ¡n.
ChÃºng tÃ´i quan sÃ¡t tháº¥y cÃ¡c mÃ´ hÃ¬nh tháº£o lá»›n hÆ¡n cÃ³ xu hÆ°á»›ng
Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c tháº£o cao hÆ¡n, nhÆ°ng chi phÃ­
táº¡o ra báº£n tháº£o cÅ©ng tÄƒng lÃªn, do Ä‘Ã³ cÃ¡c mÃ´ hÃ¬nh
cá»¡ trung bÃ¬nh mang láº¡i tá»‘c Ä‘á»™ giáº£i mÃ£ tá»‘t nháº¥t. BÃªn cáº¡nh Ä‘Ã³,
chÃºng tÃ´i Ä‘iá»u tra sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a Ä‘á»™ dÃ i tháº£o
vÃ  tá»‘c Ä‘á»™ giáº£i mÃ£ suy Ä‘oÃ¡n. Nhá»¯ng phÃ¡t hiá»‡n cá»§a chÃºng tÃ´i
chá»‰ ra ráº±ng mÃ´ hÃ¬nh Ä‘Ã­ch cÃ³ thá»ƒ cháº¥p nháº­n nhiá»u token hÆ¡n
trÃªn má»—i vÃ²ng láº·p trung bÃ¬nh khi báº£n tháº£o dÃ i hÆ¡n,
nhÆ°ng cÃ¡c báº£n tháº£o dÃ i hÆ¡n táº¡o ra nhiá»u lÆ°á»£t chuyá»ƒn tiáº¿n
cáº§n thiáº¿t cho mÃ´ hÃ¬nh tháº£o, vÃ  do Ä‘Ã³, Ä‘á»™ dÃ i tháº£o tá»‘i Æ°u
trong giáº£i mÃ£ suy Ä‘oÃ¡n khÃ´ng pháº£i lÃ  lá»›n nháº¥t.arXiv:2402.13720v3  [cs.CL]  15 ThÃ¡ng 10 2024

--- TRANG 2 ---
mal draft length in speculative decoding is not the
largest one.
Dá»±a trÃªn phÃ¢n tÃ­ch sÃ¢u hÆ¡n vá» cÃ¡c káº¿t quáº£ thá»±c nghiá»‡m thÃ­ Ä‘iá»ƒm
á»Ÿ trÃªn, khÃ´ng khÃ³ Ä‘á»ƒ quan sÃ¡t nhá»¯ng
háº¡n cháº¿ cá»§a giáº£i mÃ£ suy Ä‘oÃ¡n vá» hiá»‡u quáº£ soáº¡n tháº£o:
(1) Báº£n Tháº£o KhÃ´ng Äá»§. Soáº¡n tháº£o quÃ¡ ngáº¯n bá» lá»¡
kháº£ nÄƒng tÄƒng tá»‘c tiá»m nÄƒng. Tuy nhiÃªn,
vÃ¬ chi phÃ­ thá»i gian liÃªn quan Ä‘áº¿n chÃ­nh viá»‡c soáº¡n tháº£o,
táº¡o ra cÃ¡c báº£n tháº£o dÃ i cÃ³ thá»ƒ dáº«n Ä‘áº¿n chi phÃ­
cao khi nhá»¯ng báº£n tháº£o nÃ y tháº¥t báº¡i. Náº¿u cÃ³ thá»ƒ táº¡o ra
cÃ¡c báº£n tháº£o dÃ i hÆ¡n má»™t cÃ¡ch hiá»‡u quáº£ hÆ¡n, hiá»‡u á»©ng tÄƒng tá»‘c
sáº½ Ä‘Æ°á»£c tÄƒng cÆ°á»ng Ä‘Ã¡ng ká»ƒ. (2) Báº£n Tháº£o ChÆ°a ÄÆ°á»£c
Sá»­ Dá»¥ng Háº¿t. Äá»‘i vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n hiá»‡n táº¡i, nhá»¯ng token
khÃ´ng Ä‘Æ°á»£c mÃ´ hÃ¬nh Ä‘Ã­ch cháº¥p nháº­n bá»‹ loáº¡i bá» hoÃ n toÃ n,
dáº«n Ä‘áº¿n chi phÃ­ tháº¥t báº¡i cao khi táº¡o ra cÃ¡c báº£n tháº£o dÃ i.
Thá»±c táº¿, má»™t sá»‘ token bá»‹ loáº¡i bá» cÃ³ thá»ƒ chá»©a thÃ´ng tin
há»¯u Ã­ch cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c vÃ²ng láº·p soáº¡n tháº£o
tÆ°Æ¡ng lai.
Äá»ƒ vÆ°á»£t qua nhá»¯ng háº¡n cháº¿ trÃªn, bÃ i bÃ¡o nÃ y
giá»›i thiá»‡u má»™t khung giáº£i mÃ£ hiá»‡u quáº£ hÆ¡n
cÃ³ tÃªn Ouroboros, vá»›i nhá»¯ng cáº£i tiáº¿n so vá»›i giáº£i
mÃ£ suy Ä‘oÃ¡n nhÆ° sau:
(1) TÄƒng tá»‘c soáº¡n tháº£o qua cá»¥m tá»«. VÃ¬
viá»‡c táº¡o ra mÃ´ hÃ¬nh bá»‹ rÃ ng buá»™c bá»Ÿi bá»™ nhá»› hÆ¡n lÃ 
tÃ­nh toÃ¡n (Leviathan et al., 2023), soáº¡n tháº£o á»Ÿ cáº¥p Ä‘á»™
cá»¥m tá»« thay vÃ¬ cáº¥p Ä‘á»™ token cÃ³ thá»ƒ lÃ m cho giai Ä‘oáº¡n
soáº¡n tháº£o hiá»‡u quáº£ hÆ¡n trong viá»‡c táº¡o ra cÃ¡c báº£n tháº£o dÃ i hÆ¡n.
ÄÆ°á»£c truyá»n cáº£m há»©ng tá»« nhá»¯ng ná»— lá»±c trÆ°á»›c Ä‘Ã¢y
nhÆ° giáº£i mÃ£ nhÃ¬n trÆ°á»›c (Fu et al., 2023) Ä‘Ã£
thÃ nh cÃ´ng sá»­ dá»¥ng cá»¥m tá»« Ä‘á»ƒ tÄƒng tá»‘c mÃ´ hÃ¬nh
Ä‘Ã­ch, Ouroboros Ä‘iá»u chá»‰nh phÆ°Æ¡ng phÃ¡p nÃ y Ä‘á»ƒ
nÃ¢ng cao hiá»‡u quáº£ soáº¡n tháº£o. Trong cÃ¡c pháº§n tiáº¿p theo,
chÃºng tÃ´i sáº½ chá»©ng minh ráº±ng tÄƒng tá»‘c mÃ´ hÃ¬nh
tháº£o vá»›i cá»¥m tá»« trÆ°á»›c vÃ  sau Ä‘Ã³ sá»­ dá»¥ng
báº£n tháº£o Ä‘á»ƒ tÄƒng tá»‘c mÃ´ hÃ¬nh Ä‘Ã­ch sáº½ hiá»‡u quáº£ hÆ¡n
so vá»›i viá»‡c trá»±c tiáº¿p tÄƒng tá»‘c mÃ´ hÃ¬nh Ä‘Ã­ch vá»›i cá»¥m tá»«.
(2) LÃ m dÃ i báº£n tháº£o qua cá»¥m tá»«. Viá»‡c
ná»‘i cÃ¡c cá»¥m tá»« cÃ³ thá»ƒ má»Ÿ rá»™ng báº£n tháº£o tháº­m chÃ­ dÃ i hÆ¡n
vá»›i chi phÃ­ tháº¥p. Theo token cuá»‘i cÃ¹ng cá»§a báº£n tháº£o,
cÃ¡c cá»¥m tá»« báº¯t Ä‘áº§u báº±ng token cuá»‘i cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ
má»Ÿ rá»™ng báº£n tháº£o. Báº±ng cÃ¡ch ná»‘i báº£n tháº£o vÃ 
k cá»¥m tá»« khÃ¡c nhau, Ouroboros táº¡o ra k báº£n tháº£o
dÃ i hÆ¡n Ä‘á»ƒ mÃ´ hÃ¬nh Ä‘Ã­ch xÃ¡c minh, táº¡o ra
chi phÃ­ bá»• sung gáº§n nhÆ° báº±ng khÃ´ng.
(3) Táº¡o ra cá»¥m tá»« tá»« xÃ¡c minh. Trong
giai Ä‘oáº¡n xÃ¡c minh, Ouroboros lá»c ra
cÃ¡c cá»¥m tá»« cháº¥t lÆ°á»£ng cao tá»« nhá»¯ng token bá»‹ loáº¡i bá»
trong giáº£i mÃ£ suy Ä‘oÃ¡n. Nhá»¯ng cá»¥m tá»« bá»‹ loáº¡i bá» nÃ y
cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÄƒng tá»‘c soáº¡n tháº£o trong cÃ¡c
vÃ²ng láº·p tiáº¿p theo.
(4) TÃ¡i sá»­ dá»¥ng cá»¥m tá»« tá»« ngá»¯ cáº£nh lá»‹ch sá»­. ChÃºng tÃ´i
phÃ¡t hiá»‡n ráº±ng cÃ¡c cá»¥m tá»« Ä‘Æ°á»£c táº¡o ra tá»« cÃ¡c nhiá»‡m vá»¥ tÆ°Æ¡ng tá»± cÃ³ thá»ƒ
Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng Ä‘á»ƒ tÄƒng tá»‘c soáº¡n tháº£o vá»›i nhau.
Ouroboros do Ä‘Ã³ tÃ¡i sá»­ dá»¥ng cÃ¡c cá»¥m tá»« trong ngá»¯ cáº£nh lá»‹ch sá»­
Ä‘á»ƒ tÄƒng tá»‘c soáº¡n tháº£o trong cÃ¡c vÃ²ng láº·p tiáº¿p theo.
ÄÃ¡ng chÃº Ã½, Ouroboros khÃ´ng yÃªu cáº§u báº¥t ká»³
Ä‘Ã o táº¡o bá»• sung nÃ o, vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng trong táº¥t cáº£
cÃ¡c á»©ng dá»¥ng vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n. ChÃºng tÃ´i
triá»ƒn khai Ouroboros vÃ  tiáº¿n hÃ nh Ä‘á»§ thá»±c nghiá»‡m
trÃªn cÃ¡c nhiá»‡m vá»¥ táº¡o vÄƒn báº£n khÃ¡c nhau nhÆ°
táº¡o mÃ£ (Chen et al., 2021; Austin et al.,
2021), tÃ³m táº¯t vÄƒn báº£n (See et al., 2017; Hermann et al., 2015) vÃ  dá»‹ch mÃ¡y (Bojar et al., 2016). Káº¿t quáº£ thá»±c nghiá»‡m cho tháº¥y
Ouroboros hoÃ n toÃ n khÃ´ng máº¥t mÃ¡t vá» hiá»‡u suáº¥t nhiá»‡m vá»¥
vÃ  cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c suy luáº­n Ä‘Ã¡ng ká»ƒ mÃ  khÃ´ng cáº§n
tinh chá»‰nh mÃ´ hÃ¬nh bá»• sung. So vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p giáº£i mÃ£
cáº¡nh tranh gáº§n Ä‘Ã¢y, Ouroboros Ä‘áº¡t tá»‘c Ä‘á»™ tÄƒng lÃªn Ä‘áº¿n
1.9Ã— so vá»›i giáº£i mÃ£ nhÃ¬n trÆ°á»›c, lÃªn Ä‘áº¿n 2.8Ã— so vá»›i
giáº£i mÃ£ suy Ä‘oÃ¡n, vÃ  lÃªn Ä‘áº¿n 3.9Ã— so vá»›i giáº£i mÃ£
tá»± há»“i quy naÃ¯ve.
2 CÆ¡ sá»Ÿ lÃ½ thuyáº¿t
Äá»‘i vá»›i má»™t mÃ´ hÃ¬nh Ä‘Ã­ch T Ä‘á»ƒ tÄƒng tá»‘c suy luáº­n, giáº£i mÃ£
suy Ä‘oÃ¡n Ä‘áº§u tiÃªn tÃ¬m má»™t mÃ´ hÃ¬nh tháº£o phÃ¹ há»£p S.
Vá»›i má»™t tiá»n tá»‘ Ä‘áº§u vÃ o x1Â·Â·Â·n, giáº£i mÃ£ suy Ä‘oÃ¡n
sá»­ dá»¥ng mÃ´ hÃ¬nh tháº£o S Ä‘á»ƒ táº¡o ra má»™t báº£n tháº£o d1Â·Â·Â·Î³
gá»“m Î³ token theo cÃ¡ch tá»± há»“i quy,
d1= arg max
d1PS(d1|x1Â·Â·Â·n),
di= arg max
diPS(di|x1Â·Â·Â·n, d1Â·Â·Â·iâˆ’1), i= 2Â·Â·Â·Î³.(1)
Sau Ä‘Ã³, mÃ´ hÃ¬nh Ä‘Ã­ch T xÃ¡c minh báº£n tháº£o d1Â·Â·Â·Î³,
báº±ng cÃ¡ch nháº­p d1Â·Â·Â·Î³ vÃ  thá»±c hiá»‡n nhiá»‡m vá»¥
dá»± Ä‘oÃ¡n token tiáº¿p theo báº±ng má»™t lÆ°á»£t chuyá»ƒn tiáº¿n duy nháº¥t.
Má»—i káº¿t quáº£ xÃ¡c minh vi Ä‘Æ°á»£c láº¥y máº«u tá»« phÃ¢n phá»‘i
dá»± Ä‘oÃ¡n token tiáº¿p theo cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch,
v1âˆ¼PT(Â· |x1Â·Â·Â·n),
viâˆ¼PT(Â· |x1Â·Â·Â·n, d1Â·Â·Â·iâˆ’1), i= 2Â·Â·Â·Î³.(2)
Pháº£i tá»“n táº¡i má»™t Aâˆˆ[0, Î³] thá»a mÃ£n
v1Â·Â·Â·A=d1Â·Â·Â·A,
vA+1Ì¸=dA+1hoáº·c A=Î³.(3)
á» Ä‘Ã¢y, v1Â·Â·Â·A+1 sáº½ giá»‘ng nhÆ° káº¿t quáº£ khi
mÃ´ hÃ¬nh Ä‘Ã­ch tá»± há»“i quy táº¡o ra A+ 1
token tá»« x, vÃ¬ táº¡i thá»i Ä‘iá»ƒm nÃ y,
v1âˆ¼PT(Â· |x1Â·Â·Â·n),
viâˆ¼PT(Â· |x1Â·Â·Â·n, v1Â·Â·Â·iâˆ’1), i= 2Â·Â·Â·A+ 1.(4)
ChÃºng tÃ´i gá»i A lÃ  sá»‘ lÆ°á»£ng token chÃ­nh xÃ¡c trong
báº£n tháº£o, A+ 1 token d1Â·Â·Â·A, vA+1 Ä‘Æ°á»£c cháº¥p nháº­n nhÆ°

--- TRANG 3 ---
káº¿t quáº£ táº¡o ra cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch trong khi
cÃ¡c token tháº£o cÃ²n láº¡i dA+1Â·Â·Â·Î³ bá»‹ loáº¡i bá».
Xin lÆ°u Ã½ ráº±ng viá»‡c suy luáº­n á»Ÿ trÃªn khÃ¡c má»™t chÃºt
so vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n ban Ä‘áº§u (Chen et al.,
2023a): chÃºng tÃ´i Ä‘áº·t nhiá»‡t Ä‘á»™ cho viá»‡c láº¥y máº«u ngáº«u nhiÃªn
trong mÃ´ hÃ¬nh tháº£o thÃ nh 0 Ä‘á»ƒ giáº£i thÃ­ch rÃµ rÃ ng hÆ¡n,
nhÆ°ng Ä‘iá»u nÃ y sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n tÃ­nh Ä‘Ãºng Ä‘áº¯n cá»§a
mÃ´ hÃ¬nh Ä‘Ã­ch.
ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a A(Î³) lÃ  sá»‘ lÆ°á»£ng token chÃ­nh xÃ¡c
trung bÃ¬nh khi mÃ´ hÃ¬nh tháº£o lÃ  S vÃ  Ä‘á»™ dÃ i
tháº£o lÃ  Î³. Tá»‘c Ä‘á»™ tÄƒng cá»§a giáº£i mÃ£ suy Ä‘oÃ¡n
Ä‘Æ°á»£c tÃ­nh nhÆ° sau (Leviathan et al., 2023),
trong Ä‘Ã³ tS vÃ  tT lÃ  thá»i gian chuyá»ƒn tiáº¿n cá»§a mÃ´ hÃ¬nh
tháº£o vÃ  mÃ´ hÃ¬nh Ä‘Ã­ch, tÆ°Æ¡ng á»©ng,
[A(Î³) + 1]Â·tT
Î³Â·tS+tT, (5)
trong Ä‘Ã³ tá»­ sá»‘ lÃ  thá»i gian cho viá»‡c táº¡o ra vanilla
cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch, vÃ  máº«u sá»‘
lÃ  thá»i gian cá»§a giáº£i mÃ£ suy Ä‘oÃ¡n.
3 PhÆ°Æ¡ng phÃ¡p
Trong Ouroboros, chÃºng tÃ´i Ä‘áº§u tiÃªn tÄƒng tá»‘c soáº¡n tháº£o qua
cá»¥m tá»«, Ä‘á»ƒ chÃºng tÃ´i cÃ³ thá»ƒ táº¡o ra Î³ token vá»›i
Ã­t lÆ°á»£t chuyá»ƒn tiáº¿n hÆ¡n cá»§a mÃ´ hÃ¬nh tháº£o, vÃ  chÃºng tÃ´i
kÃ½ hiá»‡u tá»· lá»‡ giáº£m nÃ y lÃ  c. Tiáº¿p theo, do
thá»±c táº¿ ráº±ng hÃ m A(Î³) lÃ  Ä‘Æ¡n Ä‘iá»‡u
khÃ´ng giáº£m, chÃºng tÃ´i lÃ m dÃ i báº£n tháº£o qua cá»¥m tá»«, cho phÃ©p
táº¡o ra nhiá»u token hÆ¡n mÃ  khÃ´ng cáº§n
lÆ°á»£t chuyá»ƒn tiáº¿n bá»• sung. ChÃºng tÃ´i kÃ½ hiá»‡u
Ä‘á»™ dÃ i má»Ÿ rá»™ng khÃ´ng chi phÃ­ nÃ y lÃ  Î². Theo hai
hÆ°á»›ng tá»‘i Æ°u hÃ³a nÃ y, CÃ´ng thá»©c (5) trá»Ÿ thÃ nh
[A(Î³+Î²) + 1]Â·tT
1
cÎ³Â·tS+tT. (6)
ChÃºng tÃ´i tiáº¿p tá»¥c tÄƒng c báº±ng cÃ¡ch táº¡o ra
cá»¥m tá»« má»™t cÃ¡ch heuristic tá»« káº¿t quáº£ xÃ¡c minh vÃ  tÃ¡i sá»­ dá»¥ng
cá»¥m tá»« tá»« ngá»¯ cáº£nh Ä‘Æ°á»£c táº¡o ra trong lá»‹ch sá»­, cÃ³ thá»ƒ
dáº«n Ä‘áº¿n hiá»‡u quáº£ soáº¡n tháº£o tá»‘t hÆ¡n. Tiáº¿p theo, chÃºng tÃ´i sáº½
Ä‘i sÃ¢u vÃ o chi tiáº¿t cho tá»«ng pháº§n cá»§a Ouroboros.
3.1 TÄƒng tá»‘c Soáº¡n tháº£o qua Cá»¥m tá»«
ChÃºng tÃ´i láº¥y cáº£m há»©ng tá»« giáº£i mÃ£ nhÃ¬n trÆ°á»›c (Fu
et al., 2023), sá»­ dá»¥ng cá»¥m tá»« Ä‘á»ƒ trá»±c tiáº¿p tÄƒng tá»‘c
mÃ´ hÃ¬nh Ä‘Ã­ch T. Tuy nhiÃªn, má»—i vÃ²ng soáº¡n tháº£o
cá»¥m tá»« yÃªu cáº§u má»™t lÆ°á»£t chuyá»ƒn tiáº¿n cá»§a mÃ´ hÃ¬nh
Ä‘Ã­ch T Ä‘á»ƒ xÃ¡c minh báº£n tháº£o, háº¡n cháº¿ toÃ n bá»™
hiá»‡u á»©ng tÄƒng tá»‘c cá»§a giáº£i mÃ£ nhÃ¬n trÆ°á»›c. KhÃ¡c
vá»›i giáº£i mÃ£ nhÃ¬n trÆ°á»›c, chÃºng tÃ´i sá»­ dá»¥ng cá»¥m tá»« Ä‘á»ƒ
giÃ¡n tiáº¿p tÄƒng tá»‘c mÃ´ hÃ¬nh Ä‘Ã­ch T thÃ´ng qua
má»™t mÃ´ hÃ¬nh tháº£o S, cho phÃ©p má»—i lÆ°á»£t chuyá»ƒn tiáº¿n cá»§a
mÃ´ hÃ¬nh Ä‘Ã­ch Ä‘á»“ng thá»i xÃ¡c minh nhiá»u
vÃ²ng cá»¥m tá»«, Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c tá»‘t hÆ¡n.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 2, trong Ouroboros, quÃ¡ trÃ¬nh
soáº¡n tháº£o cá»§a mÃ´ hÃ¬nh tháº£o Ä‘Æ°á»£c thá»±c hiá»‡n tá»«ng cá»¥m tá»«
thay vÃ¬ tá»«ng token. Nhiá»u cá»¥m tá»« má»›i
Ä‘Æ°á»£c táº¡o ra song song trong má»—i lÆ°á»£t chuyá»ƒn tiáº¿n
cá»§a mÃ´ hÃ¬nh tháº£o. ChÃºng tÃ´i sáº½ khÃ´ng Ä‘i vÃ o chi tiáº¿t
cÃ¡ch táº¡o ra cÃ¡c cá»¥m tá»« tháº£o má»›i song song do
háº¡n cháº¿ vá» khÃ´ng gian, vÃ  cÃ³ thá»ƒ tham kháº£o Fu et al. (2023).
3.2 LÃ m dÃ i Báº£n tháº£o qua Cá»¥m tá»«
VÃ¬ viá»‡c táº¡o ra mÃ´ hÃ¬nh bá»‹ rÃ ng buá»™c bá»Ÿi bá»™ nhá»›, thá»i gian
mÃ´ hÃ¬nh Ä‘Ã­ch máº¥t Ä‘á»ƒ xÃ¡c minh hÃ ng chá»¥c token báº±ng
má»™t lÆ°á»£t chuyá»ƒn tiáº¿n duy nháº¥t khÃ´ng khÃ¡c nhiá»u so vá»›i thá»i gian
dÃ nh cho viá»‡c xÃ¡c minh má»™t token duy nháº¥t (Leviathan et al., 2023).
Do Ä‘Ã³, chÃºng tÃ´i Ä‘á» xuáº¥t sá»­ dá»¥ng cá»¥m tá»« Ä‘á»ƒ má»Ÿ rá»™ng
báº£n tháº£o má»™t cÃ¡ch heuristic vÃ¬ viá»‡c ná»‘i cá»¥m tá»« gáº§n nhÆ°
khÃ´ng tá»‘n chi phÃ­.

--- TRANG 4 ---
ğ‘‘!ğ‘‘"â‹¯ğ‘‘#ğ‘"!ğ‘$!ğ‘""ğ‘$"ğ‘¥!â‹¯ğ‘¥%ğ‘‘!ğ‘‘"â‹¯ğ‘‘#ğ‘""ğ‘$"ğ‘"!ğ‘$!Tiá»n tá»‘Báº£n tháº£oCá»¥m tá»« 1Cá»¥m tá»« 2ğ‘¥!â‹¯ğ‘¥%ğ‘‘!ğ‘‘"â‹¯ğ‘‘#ğ‘"!ğ‘$!ğ‘""ğ‘$"QKCá»¥m tá»«HÃ¬nh 3: CÆ¡ cháº¿ che attention tÃ¹y chá»‰nh
Ä‘á»ƒ xÃ¡c minh cÃ¡c báº£n tháº£o Ä‘Æ°á»£c lÃ m dÃ i.
Thá»­ nhiá»u cá»¥m tá»« Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c nhiá»u báº£n tháº£o dÃ i hÆ¡n
cÃ³ thá»ƒ tÄƒng xÃ¡c suáº¥t má»™t trong nhá»¯ng cá»¥m tá»« nÃ y
vÆ°á»£t qua xÃ¡c minh cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch.
NhÆ°ng chi phÃ­ xÃ¡c minh nhá»¯ng báº£n tháº£o dÃ i hÆ¡n nÃ y tá»«ng
cÃ¡i má»™t cÅ©ng khÃ´ng thá»ƒ chá»‹u Ä‘Æ°á»£c. ÄÆ°á»£c truyá»n cáº£m há»©ng
tá»« Cai et al. (2024), chÃºng tÃ´i xÃ¢y dá»±ng má»™t cÆ¡ cháº¿
che attention Transformer tinh vi Ä‘á»ƒ hoÃ n thÃ nh viá»‡c xÃ¡c minh
táº¥t cáº£ cÃ¡c báº£n tháº£o dÃ i hÆ¡n chá»‰ vá»›i má»™t lÆ°á»£t chuyá»ƒn tiáº¿n
cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch T, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3.
Cá»¥ thá»ƒ, vá»›i má»™t báº£n tháº£o d1Â·Â·Â·Î³, chÃºng tÃ´i chá»n ra K
cá»¥m tá»« p1
1Â·Â·Â·Î²,Â·Â·Â·, pK
1Â·Â·Â·Î² báº¯t Ä‘áº§u báº±ng token dÎ³,
tá»©c lÃ  p1
1=p2
1=Â·Â·Â·=pK
1=dÎ³. K báº£n tháº£o
Ä‘Æ°á»£c lÃ m dÃ i lÃ 

d1Â·Â·Â·Î³, p1
2Â·Â·Â·Î²,
d1Â·Â·Â·Î³, p2
2Â·Â·Â·Î²,
...
d1Â·Â·Â·Î³, pK
2Â·Â·Â·Î².(7)
MÃ´ hÃ¬nh Ä‘Ã­ch sau Ä‘Ã³ tÃ­nh toÃ¡n vj
i Ä‘á»ƒ xÃ¡c minh pj
i cho
táº¥t cáº£ j= 2Â·Â·Â·K, i= 2Â·Â·Â·Î²+ 1 trong CÃ´ng thá»©c (8). Táº¥t cáº£ vj
i
Ä‘Æ°á»£c tÃ­nh toÃ¡n song song báº±ng má»™t lÆ°á»£t chuyá»ƒn tiáº¿n duy nháº¥t
sá»­ dá»¥ng cÆ¡ cháº¿ che attention trong HÃ¬nh 3.
vj
iâˆ¼PT(Â· |x1Â·Â·Â·n, d1Â·Â·Â·Î³, pj
2Â·Â·Â·iâˆ’1) (8)
TÆ°Æ¡ng tá»± nhÆ° CÃ´ng thá»©c (3), chÃºng tÃ´i Ä‘á»‹nh nghÄ©a Ë†Aj thá»a mÃ£n
(vj
2Â·Â·Â·Ë†Aj=pj
2Â·Â·Â·Ë†Aj,
vj
Ë†Aj+1Ì¸=pj
Ë†Aj+1hoáº·c Ë†Aj=Î².(9)
Má»™t khi báº£n tháº£o d1Â·Â·Â·Î³ Ä‘Æ°á»£c mÃ´ hÃ¬nh Ä‘Ã­ch cháº¥p nháº­n
hoÃ n toÃ n, chÃºng tÃ´i sá»­ dá»¥ng cá»¥m tá»« pj vá»›i Ë†Aj lá»›n nháº¥t
Ä‘á»ƒ tÄƒng sá»‘ lÆ°á»£ng token Ä‘Æ°á»£c cháº¥p nháº­n. Cá»¥ thá»ƒ hÆ¡n,
d1Â·Â·Â·Î³, pj
2Â·Â·Â·Ë†Aj, vj
Ë†Aj+1 sáº½ Ä‘Æ°á»£c cháº¥p nháº­n.

Yi-base 34B/6B MBPP CNN/DM WMT-16
A 12.7 8.4 5.3
#Match 18.9 17.8 17.0
Báº£ng 1: Token khá»›p trung bÃ¬nh so vá»›i
sá»‘ lÆ°á»£ng token Ä‘Æ°á»£c cháº¥p nháº­n. Thá»±c nghiá»‡m trÃªn Yi-
base 34B/6B (Young et al., 2024) trÃªn ba bá»™ dá»¯ liá»‡u,
MBPP (Austin et al., 2021), CNN/DM (See et al., 2017;
Hermann et al., 2015) vÃ  WMT16 (Bojar et al., 2016)
sá»­ dá»¥ng Giáº£i mÃ£ Suy Ä‘oÃ¡n, vá»›i Ä‘á»™ dÃ i tháº£o Î³= 20.
3.3 Táº¡o ra Cá»¥m tá»« tá»« XÃ¡c minh
Trong giáº£i mÃ£ suy Ä‘oÃ¡n, chi phÃ­ khi má»™t báº£n tháº£o tháº¥t báº¡i
tÆ°Æ¡ng Ä‘á»‘i cao. Náº¿u báº£n tháº£o d1Â·Â·Â·Î³ khÃ´ng Ä‘Æ°á»£c cháº¥p nháº­n
hoÃ n toÃ n, xÃ¡c minh truyá»n thá»‘ng chá»‰ cháº¥p nháº­n tiá»n tá»‘
tháº£o Ä‘Ãºng d1Â·Â·Â·A vÃ  loáº¡i bá» dA+1Â·Â·Â·Î³, nhÆ° trong
Pháº§n 2. Äá»ƒ Ä‘Ã¡nh giÃ¡ thÃ´ng tin trong nhá»¯ng
token tháº£o bá»‹ loáº¡i bá» nÃ y, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a #Match (d1Â·Â·Â·Î³, v1Â·Â·Â·Î³)
lÃ  sá»‘ lÆ°á»£ng token khá»›p cá»§a báº£n tháº£o vÃ 
káº¿t quáº£ xÃ¡c minh,
#Match (d1Â·Â·Â·Î³, v1Â·Â·Â·Î³) =Î³X
i=1[di=vi], (10)
trong Ä‘Ã³ [di=vi] = 1 khi di=vi vÃ  0 ngÆ°á»£c láº¡i.
NhÆ° trong Báº£ng 1, chÃºng tÃ´i tháº¥y ráº±ng #Match lá»›n hÆ¡n
nhiá»u so vá»›i Ä‘á»™ dÃ i cá»§a tiá»n tá»‘ chÃ­nh xÃ¡c A. ChÃºng tÃ´i
xem xÃ©t má»™t sá»‘ trÆ°á»ng há»£p cá»¥ thá»ƒ vÃ  tháº¥y ráº±ng Ä‘Ã´i khi
sá»± xuáº¥t hiá»‡n cá»§a tÃ¬nh huá»‘ng nÃ y lÃ  do sá»±
Ä‘áº·t sai chá»— cá»§a viá»‡c táº¡o ra, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh
4. Do Ä‘Ã³, chÃºng tÃ´i Ä‘á» xuáº¥t lá»c ra nhá»¯ng
phÃ¢n Ä‘oáº¡n con cá»§a báº£n tháº£o bá»‹ loáº¡i bá» khá»›p vá»›i
káº¿t quáº£ xÃ¡c minh cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch, nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹
trong HÃ¬nh 4. Sau Ä‘Ã³ chÃºng tÃ´i chÃ¨n nhá»¯ng phÃ¢n Ä‘oáº¡n Ä‘Ã³ vÃ o
pool cá»¥m tá»« Ä‘á»ƒ tÄƒng tá»‘c cÃ¡c báº£n tháº£o tÆ°Æ¡ng lai.
NhÆ° trong Pháº§n 3.2, náº¿u báº£n tháº£o d1Â·Â·Â·Î³ Ä‘Æ°á»£c cháº¥p nháº­n
hoÃ n toÃ n, chá»‰ cÃ³ má»™t háº­u tá»‘ cá»¥m tá»« pj Ä‘Æ°á»£c sá»­ dá»¥ng,
Ä‘á»ƒ láº¡i táº¥t cáº£ cÃ¡c cá»¥m tá»« Ä‘Æ°á»£c thá»­ khÃ¡c khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng.
ChÃºng tÃ´i giáº£ Ä‘á»‹nh káº¿t quáº£ xÃ¡c minh vo
2Â·Â·Â·Î² sá»­a má»™t sá»‘
lá»—i trong cá»¥m tá»« po
2Â·Â·Â·Î² cho táº¥t cáº£ oÌ¸=j: chÃºng tÃ´i sá»­ dá»¥ng
po
1, vo
2Â·Â·Â·Î² Ä‘á»ƒ thay tháº¿ cá»¥m tá»« po
1Â·Â·Â·Î² trong pool cá»¥m tá»«.
3.4 TÃ¡i sá»­ dá»¥ng Cá»¥m tá»« tá»« Ngá»¯ cáº£nh Lá»‹ch sá»­
Trong cÃ¡c tÃ¬nh huá»‘ng thá»±c táº¿, nhá»¯ng cuá»™c há»™i thoáº¡i liá»n ká»
tá»« ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ thá»ƒ hiá»‡n sá»± tÆ°Æ¡ng tá»±. Táº­n dá»¥ng
nhá»¯ng Ä‘iá»ƒm tÆ°Æ¡ng Ä‘á»“ng nÃ y, chÃºng tÃ´i cÃ³ thá»ƒ tiáº¿p tá»¥c nÃ¢ng cao
tá»‘c Ä‘á»™ suy luáº­n cá»§a mÃ´ hÃ¬nh. KhÃ¡c vá»›i giáº£i mÃ£ nhÃ¬n trÆ°á»›c
lÃ m sáº¡ch cÃ¡c cá»¥m tá»« tá»« ngá»¯ cáº£nh lá»‹ch sá»­ khi tiáº¿n hÃ nh
viá»‡c táº¡o ra cÃ¡c truy váº¥n Ä‘áº§u vÃ o tiáº¿p theo, chÃºng tÃ´i Ä‘á» xuáº¥t
tÃ¡i sá»­ dá»¥ng cÃ¡c cá»¥m tá»« Ä‘Æ°á»£c táº¡o ra tá»« cÃ¡c láº§n táº¡o ra
trÆ°á»›c Ä‘Ã³ Ä‘á»ƒ tiáº¿p tá»¥c tÄƒng tá»‘c quÃ¡ trÃ¬nh soáº¡n tháº£o.

--- TRANG 5 ---
[P1,2,4,6,8XÃ¡c minh Song song(1 LÆ°á»£t chuyá»ƒn tiáº¿n)[2,424,6,,1.Tháº£oÃ—112.XÃ¡c minhÃ—1
[P2,4,6,8],8
3.Tháº£oÃ—74,6,8]
P[2,46,8],4.XÃ¡c minhÃ—1Tháº£o Láº·p láº¡i!5.Káº¿t quáº£ Ä‘áº§u raGiáº£i mÃ£ Suy Ä‘oÃ¡nOuroboros[P1,2,4,6,8XÃ¡c minh Song song(1 LÆ°á»£t chuyá»ƒn tiáº¿n)[2,424,6,,1.Tháº£oÃ—112.XÃ¡c minhÃ—1
[P2,4,6,8],8
4,6,8]
P[2,46,8],4.XÃ¡c minhÃ—15.Káº¿t quáº£ Ä‘áº§u ra,6,8]
Tháº£o Song song(1 LÆ°á»£t chuyá»ƒn tiáº¿n)3.Tháº£oÃ—3LÆ°á»£t chuyá»ƒn tiáº¿n cá»§a mÃ´ hÃ¬nh tháº£oLÆ°á»£t chuyá»ƒn tiáº¿n cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch
,
XÃ¡c minh Song song(1 LÆ°á»£t chuyá»ƒn tiáº¿n)
Háº§u háº¿t ÄÃºng nhÆ°ng Äáº·t sai chá»—
,
XÃ¡c minh Song song(1 LÆ°á»£t chuyá»ƒn tiáº¿n)
,6,8,[x*2 for x in [1,2,3,4]]=P=
LÆ°á»£t chuyá»ƒn tiáº¿n Ã­t hÆ¡n[x*2 for x in [1,2,3,4]]=P=Cá»¥m tá»«HÃ¬nh 4: Minh há»a viá»‡c táº¡o ra cá»¥m tá»« tá»« káº¿t quáº£ xÃ¡c minh cá»§a mÃ´ hÃ¬nh Ä‘Ã­ch.
3.5 Nhá»¯ng Æ¯u Ä‘iá»ƒm cá»§a Khung KhÃ´ng cáº§n ÄÃ o táº¡o
Ouroboros hoÃ n toÃ n khÃ´ng cáº§n Ä‘Ã o táº¡o. ChÃºng tÃ´i khÃ´ng
sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p nhÆ° chÆ°ng cáº¥t mÃ´ hÃ¬nh Ä‘á»ƒ
tÄƒng hÃ m A(Î³) hoáº·c nÃ©n mÃ´ hÃ¬nh
Ä‘á»ƒ giáº£m tS trong CÃ´ng thá»©c (5). Vá» máº·t táº¡o ra
cá»¥m tá»«, táº¥t cáº£ cÃ¡c chiáº¿n lÆ°á»£c táº¡o ra cá»¥m tá»« cá»§a chÃºng tÃ´i
Ä‘á»u lÃ  heuristic. Táº¥t cáº£ cÃ¡c cá»¥m tá»« Ä‘Æ°á»£c tÃ­ch lÅ©y dáº§n dáº§n
trong quÃ¡ trÃ¬nh táº¡o ra cá»§a mÃ´ hÃ¬nh, mÃ  khÃ´ng cáº§n
chuáº©n bá»‹ trÆ°á»›c trÃªn kho ngá»¯ liá»‡u quy mÃ´ lá»›n. Táº¥t cáº£
nhá»¯ng Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ , vá»›i má»™t mÃ´ hÃ¬nh tháº£o trong
báº¥t ká»³ phÆ°Æ¡ng phÃ¡p giáº£i mÃ£ suy Ä‘oÃ¡n nÃ o, chÃºng tÃ´i cÃ³ thá»ƒ
sá»­ dá»¥ng Ouroboros Ä‘á»ƒ giÃºp nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y Ä‘áº¡t Ä‘Æ°á»£c
tÄƒng tá»‘c hÆ¡n ná»¯a mÃ  khÃ´ng táº¡o ra chi phÃ­ bá»• sung.
4 Thá»±c nghiá»‡m
Pháº§n nÃ y táº­p trung vÃ o Ä‘Ã¡nh giÃ¡ Ouroboros trÃªn
cÃ¡c nhiá»‡m vá»¥ táº¡o vÄƒn báº£n khÃ¡c nhau Ä‘á»ƒ chá»©ng minh
hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t cá»§a Ouroboros.
4.1 CÃ i Ä‘áº·t Thá»±c nghiá»‡m
Äá»ƒ Ä‘Ã¡nh giÃ¡ tÄƒng tá»‘c tá»•ng thá»ƒ do
Ouroboros gÃ¢y ra, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ Ouroboros trÃªn cÃ¡c
nhiá»‡m vá»¥ táº¡o vÄƒn báº£n Ä‘iá»ƒn hÃ¬nh khÃ¡c nhau, bao gá»“m táº¡o mÃ£,
lÃ½ luáº­n sá»‘ há»c, tÃ³m táº¯t tÃ i liá»‡u,
vÃ  dá»‹ch mÃ¡y.
Bá»™ dá»¯ liá»‡u. Äá»‘i vá»›i táº¡o mÃ£, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡
Ouroboros trÃªn HumanEval (Chen et al., 2021) vÃ 
táº­p validation cá»§a MBPP (Austin et al., 2021).
CÃ³ 164 má»¥c trong HumanEval vÃ  chÃºng Ä‘Æ°á»£c
táº¡o thÃ nh tá»« má»™t lá»i nháº¯c vÄƒn báº£n vÃ  má»™t tiá»n tá»‘ cá»§a hÃ m Python.
Táº­p validation cá»§a MBPP cÃ³ 90 má»¥c,
trong Ä‘Ã³ toÃ n bá»™ hÃ m Ä‘Æ°á»£c mong Ä‘á»£i Ä‘á»ƒ
dá»± Ä‘oÃ¡n vá»›i má»™t lá»i nháº¯c vÄƒn báº£n vÃ  cÃ¡c trÆ°á»ng há»£p thá»­ nghiá»‡m Ä‘Ã£ cho.
Äá»™ dÃ i táº¡o ra tá»‘i Ä‘a trÃªn HumanEval
vÃ  MBPP Ä‘Æ°á»£c Ä‘áº·t thÃ nh 512. Äá»‘i vá»›i lÃ½ luáº­n sá»‘ há»c,
tÃ³m táº¯t tÃ i liá»‡u vÃ  dá»‹ch mÃ¡y, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡
phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i trÃªn GSM8K (Cobbe
et al., 2021), CNN/DM (See et al., 2017; Hermann
et al., 2015) vÃ  WMT16 (Bojar et al., 2016),
tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i láº¥y máº«u ngáº«u nhiÃªn 100 má»¥c tá»«
GSM8K vÃ  CNN/DM, vÃ  láº¥y máº«u 100 má»¥c
tá»« táº­p con dá»‹ch tiáº¿ng Äá»©c sang tiáº¿ng Anh cá»§a
WMT16. Äá»™ dÃ i táº¡o ra tá»‘i Ä‘a trÃªn
GSM8k, CNN/DM vÃ  WMT16 tÆ°Æ¡ng á»©ng
Ä‘Æ°á»£c Ä‘áº·t thÃ nh 256, 128, vÃ  64.
MÃ´ hÃ¬nh. Äá»‘i vá»›i HumanEval vÃ  MBPP, chÃºng tÃ´i sá»­ dá»¥ng
Yi-base-34B/6B (Young et al., 2024), DeepSeek-
coder-instruct-33b/6.7B (Bi et al., 2024) vÃ 
CodeLlama-instruct-34B/7B (Roziere et al., 2023)
lÃ m mÃ´ hÃ¬nh Ä‘Ã­ch/tháº£o cho cÃ¡c thá»±c nghiá»‡m cá»§a chÃºng tÃ´i. Äá»‘i vá»›i
GSM8K, CNN/DM vÃ  WMT16, chÃºng tÃ´i sá»­ dá»¥ng Yi-base-
34B/6B vÃ  Llama-2-chat-70B/7B (Touvron et al.,
2023). ChÃºng tÃ´i sá»­ dá»¥ng mÃ´ hÃ¬nh lá»›n hÆ¡n lÃ m mÃ´ hÃ¬nh Ä‘Ã­ch
vÃ  mÃ´ hÃ¬nh nhá» hÆ¡n Ä‘á»ƒ soáº¡n tháº£o. Táº¥t cáº£ nhá»¯ng mÃ´ hÃ¬nh nÃ y
Ä‘á»u lÃ  LLM Ä‘áº¡i diá»‡n vÃ  phá»• biáº¿n gáº§n Ä‘Ã¢y.
PhÆ°Æ¡ng phÃ¡p ÄÃ¡nh giÃ¡. CÃ¡c baseline cá»§a
thá»±c nghiá»‡m cá»§a chÃºng tÃ´i lÃ  giáº£i mÃ£ tá»± há»“i quy vanilla,
giáº£i mÃ£ suy Ä‘oÃ¡n (Leviathan et al., 2023; Chen
et al., 2023a), vÃ  giáº£i mÃ£ nhÃ¬n trÆ°á»›c (Fu et al.,
2023). ChÃºng tÃ´i bÃ¡o cÃ¡o tá»‘c Ä‘á»™ giáº£i mÃ£ (token/s) vÃ 

--- TRANG 6 ---
tá»· lá»‡ tÄƒng tá»‘c so vá»›i giáº£i mÃ£ tá»± há»“i quy vanilla.
Nhiá»u siÃªu tham sá»‘ khÃ¡c cá»§a thá»±c nghiá»‡m cá»§a chÃºng tÃ´i
Ä‘Æ°á»£c bao gá»“m trong Phá»¥ lá»¥c B.
Pháº§n cá»©ng vÃ  Triá»ƒn khai. Táº¥t cáº£ thá»±c nghiá»‡m
Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn 2 Ã—NVIDIA 80GB A800
GPU vá»›i NVLINK Ã—8 Ä‘Æ°á»£c káº¿t ná»‘i. CPU
Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  Intel(R) Xeon(R) Platinum 8350C. ChÃºng tÃ´i
sá»­ dá»¥ng gÃ³i transformers cá»§a Huggingface Ä‘á»ƒ
tiáº¿n hÃ nh song song hÃ³a mÃ´ hÃ¬nh tá»± Ä‘á»™ng cho cÃ¡c phÆ°Æ¡ng phÃ¡p
cá»§a chÃºng tÃ´i vÃ  táº¥t cáº£ cÃ¡c baseline.
4.2 Káº¿t quáº£ Tá»•ng thá»ƒ
ChÃºng tÃ´i tiáº¿n hÃ nh thá»±c nghiá»‡m trong cáº£ tÃ¬nh huá»‘ng
giáº£i mÃ£ tham lam vÃ  láº¥y máº«u ngáº«u nhiÃªn. Káº¿t quáº£
thá»±c nghiá»‡m Ä‘Æ°á»£c liá»‡t kÃª nhÆ° sau.
Giáº£i mÃ£ tham lam. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5, trong
tÃ¬nh huá»‘ng táº¡o ra tham lam, Ouroboros vÆ°á»£t trá»™i hÆ¡n
giáº£i mÃ£ tham lam vanilla, giáº£i mÃ£ nhÃ¬n trÆ°á»›c,
vÃ  giáº£i mÃ£ suy Ä‘oÃ¡n dÆ°á»›i táº¥t cáº£ cáº¥u hÃ¬nh
mÃ´ hÃ¬nh ná»n vÃ  bá»™ dá»¯ liá»‡u. Ouroboros cÃ³ thá»ƒ
Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ táº¡o ra lÃªn Ä‘áº¿n 61.2 token/s vá»›i
Ä‘á»™ dÃ i táº¡o ra tá»‘i Ä‘a lÃ  512, Ä‘áº¡t Ä‘Æ°á»£c
tá»‘c Ä‘á»™ tÄƒng 3.9Ã— so vá»›i giáº£i mÃ£ tham lam,
2.8Ã— so vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n, vÃ  1.9Ã—
so vá»›i giáº£i mÃ£ nhÃ¬n trÆ°á»›c. Báº£ng 2 cho tháº¥y
Ouroboros cÅ©ng cÃ³ thá»ƒ cÃ³ Ä‘Æ°á»£c tÄƒng tá»‘c Ä‘Ã¡ng ká»ƒ trÃªn
cÃ¡c nhiá»‡m vá»¥ ngÃ´n ngá»¯ tá»± nhiÃªn Ä‘iá»ƒn hÃ¬nh, nÆ¡i giáº£i mÃ£ nhÃ¬n trÆ°á»›c
vÃ  giáº£i mÃ£ suy Ä‘oÃ¡n chá»‰ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c
tÄƒng tá»‘c háº¡n cháº¿.
Láº¥y máº«u ngáº«u nhiÃªn. ChÃºng tÃ´i thá»­ nghiá»‡m Ouroboros trong
tÃ¬nh huá»‘ng láº¥y máº«u ngáº«u nhiÃªn sá»­ dá»¥ng Llama-2-chat-
70B/7B, xem xÃ©t ráº±ng nhá»¯ng mÃ´ hÃ¬nh sau SFT
phÃ¹ há»£p hÆ¡n Ä‘á»ƒ hiá»ƒu tá»‘t ngá»¯ nghÄ©a phong phÃº
Ä‘Æ°á»£c phÃ¢n phá»‘i trong ngÃ´n ngá»¯ tá»± nhiÃªn cá»§a con ngÆ°á»i vÃ 
táº¡o ra káº¿t quáº£ Ä‘a dáº¡ng. Äá»‘i vá»›i cÃ¡c siÃªu tham sá»‘
láº¥y máº«u, nhiá»‡t Ä‘á»™ táº¡o ra Ä‘Æ°á»£c Ä‘áº·t
giá»¯a 0.5 vÃ  1.0, vÃ  top-p Ä‘Æ°á»£c Ä‘áº·t thÃ nh 0.8. Báº£ng
3 cho tháº¥y Ouroboros cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho
láº¥y máº«u ngáº«u nhiÃªn, vÃ  tá»‘c Ä‘á»™ tÄƒng so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p
baseline khÃ´ng khÃ¡c nhiá»u so vá»›i cÃ¡c quan sÃ¡t
trong tÃ¬nh huá»‘ng giáº£i mÃ£ tham lam.

Yi
34B/6BDeepSeek-coder
34B/6.7BCodeLlama
34B/7B0204060token/s
15.621.532.361.2
15.421.525.141.0
18.323.427.239.2HumanEval
Vanilla
Suy Ä‘oÃ¡nNhÃ¬n trÆ°á»›c
Ouroboros
Yi
34B/6BDeepSeek-coder
34B/6.7BCodeLlama
34B/7B010203040token/s
15.521.827.744.0
15.018.019.031.8
16.520.122.734.5MBPP
Vanilla
Suy Ä‘oÃ¡nNhÃ¬n trÆ°á»›c
OuroborosHÃ¬nh 5: Tá»‘c Ä‘á»™ giáº£i mÃ£ tham lam (token/s) trÃªn HumanEval vÃ  MBPP.
Nhiá»‡m vá»¥ Thuáº­t toÃ¡nYi 34B/6B Llama-2 70B/7B
token/s tÄƒng tá»‘c token/s tÄƒng tá»‘c
GSM8kVanilla 15.33 1.00 Ã— 8.96 1.00 Ã—
Suy Ä‘oÃ¡n 16.99 1.11 Ã— 16.86 1.88 Ã—
NhÃ¬n trÆ°á»›c 25.14 1.64 Ã— 13.77 1.54 Ã—
Ouroboros 28.23 1.84 Ã— 24.03 2.68 Ã—
CNN/DMVanilla 14.62 1.00 8.12 1.00
Suy Ä‘oÃ¡n 17.82 1.22 Ã— 12.77 1.57 Ã—
NhÃ¬n trÆ°á»›c 18.77 1.28 Ã— 9.47 1.17 Ã—
Ouroboros 22.65 1.55 Ã— 14.67 1.81 Ã—
WMT16Vanilla 14.78 1.00 Ã— 9.52 1.00 Ã—
Suy Ä‘oÃ¡n 17.48 1.18 Ã— 14.72 1.55 Ã—
NhÃ¬n trÆ°á»›c 17.98 1.22 Ã— 14.65 1.54 Ã—
Ouroboros 19.94 1.35 Ã— 19.27 2.02 Ã—
Báº£ng 2: Tá»‘c Ä‘á»™ giáº£i mÃ£ tham lam (token/s) vÃ 
tá»· lá»‡ tÄƒng tá»‘c trÃªn GSM8K, CNN/DM vÃ  WMT16.
Nhiá»‡m vá»¥ Thuáº­t toÃ¡nTham lam Ngáº«u nhiÃªn
(temp=0.0) temp=0.5 temp=1.0
GSM8kVanilla 8.96 8.97 8.96
Suy Ä‘oÃ¡n 16.86 14.99 14.11
NhÃ¬n trÆ°á»›c 13.77 13.56 13.46
Ouroboros 24.03 22.04 19.27
CNN/DMVanilla 8.12 8.83 8.30
Suy Ä‘oÃ¡n 12.77 13.43 13.75
NhÃ¬n trÆ°á»›c 9.47 9.31 9.47
Ouroboros 14.67 14.97 14.23
WMT16Vanilla 9.52 9.75 9.75
Suy Ä‘oÃ¡n 14.72 13.91 14.28
NhÃ¬n trÆ°á»›c 14.65 12.05 11.91
Ouroboros 19.27 19.95 19.33
Báº£ng 3: Tá»‘c Ä‘á»™ láº¥y máº«u ngáº«u nhiÃªn (token/s)
so vá»›i tá»‘c Ä‘á»™ giáº£i mÃ£ tham lam (token/s), Ä‘Æ°á»£c thá»­ nghiá»‡m
trÃªn Llama-2-chat 70B/7B. "temp" cÃ³ nghÄ©a lÃ  nhiá»‡t Ä‘á»™
Ä‘Æ°á»£c sá»­ dá»¥ng trong tÃ¬nh huá»‘ng láº¥y máº«u ngáº«u nhiÃªn.

--- TRANG 7 ---
PhÆ°Æ¡ng phÃ¡p token/s
Baseline 21.46
+ TÄƒng tá»‘c soáº¡n tháº£o qua cá»¥m tá»« 49.90
+ LÃ m dÃ i báº£n tháº£o qua cá»¥m tá»« 55.92
+ Táº¡o ra cá»¥m tá»« tá»« xÃ¡c minh 58.18
+ TÃ¡i sá»­ dá»¥ng cá»¥m tá»« tá»« ngá»¯ cáº£nh lá»‹ch sá»­ 61.20
Báº£ng 4: NghiÃªn cá»©u loáº¡i bá» cá»§a tá»«ng thÃ nh pháº§n trong
Ouroboros trÃªn HumanEval sá»­ dá»¥ng Yi 34B/6B.
0 1 2 3 4 5 6 7 8 9 20
K5455565758token/s
HÃ¬nh 6: Hiá»‡u á»©ng cá»§a viá»‡c chá»n K cá»¥m tá»« cho CÃ´ng thá»©c (7),
Ä‘Æ°á»£c thá»­ nghiá»‡m trÃªn HumanEval sá»­ dá»¥ng Yi 34B/6B mÃ  khÃ´ng tÃ¡i sá»­ dá»¥ng
cá»¥m tá»« tá»« ngá»¯ cáº£nh lá»‹ch sá»­.
4.3 NghiÃªn cá»©u Loáº¡i bá» vÃ  PhÃ¢n tÃ­ch
Trong pháº§n nÃ y, Ä‘á»ƒ cÃ³ cÃ¡i nhÃ¬n sÃ¢u hÆ¡n vá» cÃ¡ch
Ouroboros Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ táº¡o ra cao hÆ¡n, chÃºng tÃ´i
tiáº¿n hÃ nh nghiÃªn cá»©u loáº¡i bá» vÃ  phÃ¢n tÃ­ch Ä‘á»ƒ tráº£ lá»i
cÃ¡c cÃ¢u há»i sau.
Hiá»‡u á»©ng cá»§a tá»«ng thÃ nh pháº§n lÃ  gÃ¬? Äá»ƒ
chá»©ng minh tÄƒng tá»‘c cá»¥ thá»ƒ Ä‘Æ°á»£c táº¡o ra bá»Ÿi
tá»«ng cÆ¡ cháº¿, káº¿t quáº£ loáº¡i bá» Ä‘Æ°á»£c trong Báº£ng 4.
Trong báº£ng, má»—i thÃ nh pháº§n cÃ³ thá»ƒ mang láº¡i má»™t má»©c tÄƒng
tá»‘c Ä‘á»™, trong khi tÄƒng tá»‘c soáº¡n tháº£o vÃ  lÃ m dÃ i
báº£n tháº£o lÃ  nhá»¯ng cÃ¡i hiá»‡u quáº£ nháº¥t.
Cáº§n bao nhiÃªu cá»¥m tá»« Ä‘á»ƒ lÃ m dÃ i
báº£n tháº£o? XÃ¡c minh quÃ¡ nhiá»u cá»¥m tá»« cÃ³ thá»ƒ
lÃ m cháº­m xÃ¡c minh trong cÃ¡c tÃ¬nh huá»‘ng suy luáº­n
mÃ´ hÃ¬nh thá»±c táº¿. á» Ä‘Ã¢y xuáº¥t hiá»‡n má»™t sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a
nhiá»u cá»¥m tá»« hÆ¡n cho kháº£ nÄƒng tÄƒng tá»‘c vÃ  xÃ¡c minh
cháº­m hÆ¡n. Trong HÃ¬nh 6, tá»“n táº¡i má»™t giÃ¡ trá»‹ K tá»‘t nháº¥t,
Ã­t hÆ¡n hoáº·c nhiá»u cá»¥m tá»« hÆ¡n gÃ¢y ra tá»‘c Ä‘á»™ giáº£i mÃ£ cháº­m hÆ¡n.
CÃ¡c thá»±c nghiá»‡m loáº¡i bá» khÃ¡c. Káº¿t quáº£ cá»§a
Ouroboros trÃªn cÃ¡c cÃ i Ä‘áº·t siÃªu tham sá»‘ vÃ  Ä‘á»™ dÃ i
khÃ¡c nhau Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Phá»¥ lá»¥c B vÃ  Phá»¥ lá»¥c E,
tÆ°Æ¡ng á»©ng. Viá»‡c loáº¡i bá» tÃ¡i sá»­ dá»¥ng cá»¥m tá»« trÃªn
tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh khÃ¡c nhau Ä‘Æ°á»£c trong Phá»¥ lá»¥c F.
4.4 So sÃ¡nh vá»›i CÃ¡c PhÆ°Æ¡ng phÃ¡p Dá»±a trÃªn ÄÃ o táº¡o
ChÃºng tÃ´i so sÃ¡nh Ouroboros khÃ´ng cáº§n Ä‘Ã o táº¡o cá»§a chÃºng tÃ´i vá»›i
phÆ°Æ¡ng phÃ¡p dá»±a trÃªn Ä‘Ã o táº¡o hiá»‡n Ä‘áº¡i nháº¥t Eagle (Li
et al., 2024) trÃªn Spec-Bench (Xia et al., 2024).
Ã tÆ°á»Ÿng chÃ­nh cá»§a Eagle lÃ  Ä‘Ã o táº¡o Ä‘áº·c biá»‡t má»™t
Spec-BenchOuroboros Eagle
token/s #accept token/s #accept
MT-Bench 24.23 5.16 28.20 3.52
Translation 18.91 3.92 24.23 3.16
Summarization 19.91 4.93 22.03 3.16
QA 21.63 4.67 24.83 3.23
Math Reasoning 25.39 4.95 29.90 3.81
RAG 19.00 5.43 20.56 3.54
Average 21.51 4.96 24.96 3.48
Báº£ng 5: Tá»‘c Ä‘á»™ (token/s) so sÃ¡nh vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p
dá»±a trÃªn Ä‘Ã o táº¡o, Ä‘Æ°á»£c thá»­ nghiá»‡m trÃªn Llama-2-chat-70B. "#accept"
cÃ³ nghÄ©a lÃ  sá»‘ lÆ°á»£ng token tháº£o Ä‘Æ°á»£c mÃ´ hÃ¬nh Ä‘Ã­ch cháº¥p nháº­n
trong má»—i vÃ²ng láº·p (trung bÃ¬nh). Ouroboros sá»­ dá»¥ng
Llama-2-chat-7B lÃ m mÃ´ hÃ¬nh tháº£o trong khi Eagle sá»­ dá»¥ng
mÃ´ hÃ¬nh 1B Ä‘Æ°á»£c Ä‘Ã o táº¡o cá»§a nÃ³ Ä‘á»ƒ soáº¡n tháº£o.
mÃ´ hÃ¬nh tháº£o nhá» dÆ°á»›i kiáº¿n trÃºc mÃ´ hÃ¬nh
Ä‘Æ°á»£c thiáº¿t káº¿ má»›i cá»§a há» vÃ  táº¡o ra cÃ¡c báº£n tháº£o kiá»ƒu cÃ¢y
cho LLM Ä‘Ã­ch. Äá»ƒ tÄƒng tá»‘c Llama-2-chat-
70B, nÃ³ Ä‘Ã o táº¡o má»™t mÃ´ hÃ¬nh tháº£o 1B báº±ng cÃ¡ch chÆ°ng cáº¥t tá»«
Llama-2-chat-70B. Káº¿t quáº£ trong Báº£ng 5 cho tháº¥y ráº±ng,
máº·c dÃ¹ Eagle Ä‘Ã o táº¡o má»™t mÃ´ hÃ¬nh tháº£o nhá» hÆ¡n nhiá»u vá»›i
1
7 quy mÃ´ cá»§a chÃºng tÃ´i Ä‘á»ƒ soáº¡n tháº£o, nÃ³ chá»‰ cÃ³ thá»ƒ
Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ nhanh hÆ¡n má»™t chÃºt so vá»›i phÆ°Æ¡ng phÃ¡p
khÃ´ng cáº§n Ä‘Ã o táº¡o cá»§a chÃºng tÃ´i. Äiá»u nÃ y lÃ  do mÃ´ hÃ¬nh
nhá» hÆ¡n nhiá»u lÃ m giáº£m Ä‘Ã¡ng ká»ƒ sá»‘ lÆ°á»£ng token tháº£o
Ä‘Æ°á»£c mÃ´ hÃ¬nh Ä‘Ã­ch cháº¥p nháº­n trong má»—i vÃ²ng láº·p,
tá»©c lÃ  máº¥t hiá»‡u quáº£ tháº£o. ChÃºng tÃ´i nhÃ¬n láº¡i
cÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn Ä‘Ã o táº¡o bao gá»“m Eagle, há»
theo Ä‘uá»•i tá»‘c Ä‘á»™ soáº¡n tháº£o tá»‘i Æ°u vá»›i cÃ¡i giÃ¡ pháº£i tráº£
lÃ  máº¥t Ä‘á»™ chÃ­nh xÃ¡c tháº£o. NgÆ°á»£c láº¡i, chÃºng tÃ´i
tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ soáº¡n tháº£o trong khi giá»¯ nguyÃªn Ä‘á»™ chÃ­nh xÃ¡c.
Hiá»‡n táº¡i, Eagle khÃ´ng thá»ƒ Ä‘Æ°á»£c tÃ­ch há»£p
vÃ o Ouroboros vÃ¬ kiáº¿n trÃºc mÃ´ hÃ¬nh Ä‘áº·c biá»‡t
cá»§a mÃ´ hÃ¬nh tháº£o cá»§a há» chá»‰ há»— trá»£ soáº¡n tháº£o
cáº¥p token tá»± há»“i quy. ChÃºng tÃ´i tin ráº±ng phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i
cÃ³ thá»ƒ tÃ¬m Ä‘Æ°á»£c sá»± cÃ¢n báº±ng tá»‘t hÆ¡n giá»¯a tá»‘c Ä‘á»™ soáº¡n tháº£o
vÃ  Ä‘á»™ chÃ­nh xÃ¡c khi káº¿t há»£p vá»›i Ä‘Ã o táº¡o, Ä‘Ã³ sáº½
lÃ  cÃ´ng viá»‡c tÆ°Æ¡ng lai cá»§a chÃºng tÃ´i.
4.5 So sÃ¡nh vá»›i CÃ¡c PhÆ°Æ¡ng phÃ¡p Dá»±a trÃªn Cá»¥m tá»«
ChÃºng tÃ´i so sÃ¡nh Ouroboros vá»›i phÆ°Æ¡ng phÃ¡p dá»±a trÃªn cá»¥m tá»«
khÃ¡c PLD (Saxena, 2023) vÃ  REST (He et al.,
2024) trÃªn Spec-Bench (Xia et al., 2024). Nhá»¯ng
phÆ°Æ¡ng phÃ¡p nÃ y truy xuáº¥t cá»¥m tá»« tá»« lá»i nháº¯c hoáº·c tÃ i liá»‡u
lÃ m báº£n tháº£o cho mÃ´ hÃ¬nh Ä‘Ã­ch xÃ¡c minh.
Ouroboros vÆ°á»£t trá»™i hÆ¡n nhá»¯ng baseline nÃ y vá»›i biÃªn Ä‘á»™
lá»›n trong Báº£ng 6, cho tháº¥y hiá»‡u quáº£
cá»§a viá»‡c sá»­ dá»¥ng mÃ´ hÃ¬nh tháº£o nhÆ° má»™t trung gian Ä‘á»ƒ lá»c
bá» cÃ¡c cá»¥m tá»« cháº¥t lÆ°á»£ng tháº¥p trÆ°á»›c khi cung cáº¥p chÃºng cho
mÃ´ hÃ¬nh Ä‘Ã­ch.

--- TRANG 8 ---
Spec-BenchOuroboros PLD REST
token/s #accept token/s #accept token/s #accept
MT-Bench 24.23 5.16 13.95 1.45 14.93 1.94
Translation 18.91 3.92 12.99 1.41 13.02 1.57
Summarization 19.91 4.93 16.98 1.97 12.60 1.69
QA 21.63 4.67 11.33 1.26 16.10 1.96
Math Reasoning 25.39 4.95 15.86 1.75 13.07 1.60
RAG 19.00 5.43 15.51 1.64 13.28 1.91
Average 21.51 4.96 14.44 1.51 13.83 1.83
Báº£ng 6: Tá»‘c Ä‘á»™ (token/s) so sÃ¡nh vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p
dá»±a trÃªn cá»¥m tá»«, Ä‘Æ°á»£c thá»­ nghiá»‡m trÃªn Llama-2-chat-70B. "#accept"
cÃ³ nghÄ©a lÃ  sá»‘ lÆ°á»£ng token tháº£o Ä‘Æ°á»£c mÃ´ hÃ¬nh Ä‘Ã­ch cháº¥p nháº­n
trong má»—i vÃ²ng láº·p (trung bÃ¬nh).
5 CÃ´ng trÃ¬nh LiÃªn quan
Pháº§n nÃ y giá»›i thiá»‡u cÃ¡c ná»— lá»±c hiá»‡n cÃ³ cho
suy luáº­n LLM hiá»‡u quáº£, bao gá»“m giáº£i mÃ£ hiá»‡u quáº£, triá»ƒn khai
hiá»‡u quáº£ vÃ  nÃ©n mÃ´ hÃ¬nh.
5.1 Giáº£i mÃ£ Hiá»‡u quáº£
Äá»ƒ giáº£m bá»›t cÃ¡c váº¥n Ä‘á» hiá»‡u quáº£ do giáº£i mÃ£
tá»± há»“i quy gÃ¢y ra, cÃ¡c phÆ°Æ¡ng phÃ¡p giáº£i mÃ£
khÃ´ng tá»± há»“i quy Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» xuáº¥t. Thay vÃ¬ táº¡o ra
token tá»«ng cÃ¡i má»™t, cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ´ng tá»± há»“i quy
táº¡o ra nhiá»u token song song táº¡i má»™t thá»i Ä‘iá»ƒm (Wei
et al., 2019; Guo et al., 2020; Ghazvininejad et al.,
2019). Nhá»¯ng phÆ°Æ¡ng phÃ¡p khÃ´ng tá»± há»“i quy nÃ y mang láº¡i
má»™t cáº£i thiá»‡n vá» hiá»‡u quáº£ suy luáº­n vÃ  cÅ©ng
lÃ m giáº£m Ä‘Ã¡ng ká»ƒ hiá»‡u suáº¥t mÃ´ hÃ¬nh. VÃ¬ váº­y,
cÃ¡c phÆ°Æ¡ng phÃ¡p soáº¡n tháº£o-rá»“i-xÃ¡c minh Ä‘Ã£ Ä‘Æ°á»£c
Ä‘á» xuáº¥t (Stern et al., 2018; Xia et al., 2023a;
Leviathan et al., 2023; Chen et al., 2023a). CÃ¡c
phÆ°Æ¡ng phÃ¡p soáº¡n tháº£o-rá»“i-xÃ¡c minh trÃ¡nh LLM khá»i
viá»‡c táº¡o ra tuáº§n tá»± vÃ  thay vÃ o Ä‘Ã³ sá»­ dá»¥ng chÃºng Ä‘á»ƒ xÃ¡c
minh báº£n tháº£o theo cÃ¡ch song song khÃ´ng tá»± há»“i quy,
khÃ´ng lÃ m giáº£m hiá»‡u suáº¥t mÃ´ hÃ¬nh vÃ 
tÄƒng tá»‘c Ä‘Ã¡ng ká»ƒ suy luáº­n.
ChÃ¬a khÃ³a cho cÃ¡c phÆ°Æ¡ng phÃ¡p soáº¡n tháº£o-rá»“i-xÃ¡c minh lÃ 
táº¡o ra báº£n tháº£o nhanh chÃ³ng vÃ  tá»‘t.
(1)CÃ¡c phÆ°Æ¡ng phÃ¡p nhÆ° giáº£i mÃ£ suy Ä‘oÃ¡n (Xia
et al., 2023a; Leviathan et al., 2023; Chen et al.,
2023a) sá»­ dá»¥ng má»™t mÃ´ hÃ¬nh nhá» hÆ¡n mÃ´ hÃ¬nh Ä‘Ã­ch
Ä‘á»ƒ táº¡o ra báº£n tháº£o. Äá»ƒ tiáº¿p tá»¥c cÄƒn chá»‰nh mÃ´ hÃ¬nh tháº£o
vá»›i mÃ´ hÃ¬nh Ä‘Ã­ch, cÃ¡c ká»¹ thuáº­t chÆ°ng cáº¥t Ä‘Æ°á»£c
Ã¡p dá»¥ng (Miao et al., 2023; Zhou et al., 2023). Tháº­m chÃ­
cÃ¡c mÃ´ hÃ¬nh nhá» hÆ¡n nhiá»u cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m báº£n tháº£o Ä‘á»ƒ tÄƒng tá»‘c
mÃ´ hÃ¬nh tháº£o, táº¡o thÃ nh giáº£i mÃ£ suy Ä‘oÃ¡n
Ä‘a giai Ä‘oáº¡n (Spector and Re, 2023; Chen et al.,
2023b). NgoÃ i viá»‡c sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh khÃ¡c nhau, Self-
Speculative (Zhang et al., 2024a) vÃ  PPD (Yang
et al., 2023b) chá»n má»™t pháº§n cá»§a cÃ¡c lá»›p mÃ´ hÃ¬nh lÃ m
mÃ´ hÃ¬nh tháº£o, trong khi nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y yÃªu cáº§u Ä‘Ã o táº¡o
hoáº·c tiá»n xá»­ lÃ½ bá»• sung.
(2)Má»™t sá»‘ ná»— lá»±c khÃ¡c khÃ¡m phÃ¡ viá»‡c sá»­ dá»¥ng chÃ­nh mÃ´ hÃ¬nh Ä‘Ã­ch
Ä‘á»ƒ táº¡o ra báº£n tháº£o má»™t cÃ¡ch hiá»‡u quáº£. Block-
wise (Stern et al., 2018) vÃ  Medusa (Cai et al.,
2024) Ä‘Ã o táº¡o nhiá»u Ä‘áº§u ra bá»• sung trÃªn Ä‘á»‰nh
LLM vÃ  tinh chá»‰nh cÃ¡c Ä‘áº§u ra Ä‘á»ƒ táº¡o ra nhiá»u
token tháº£o song song. Parallel Decoding (Santilli
et al., 2023) vÃ  PaSS (Monea et al., 2023) thÃªm
cÃ¡c háº­u tá»‘ Ä‘áº§u vÃ o phá»¥ trá»£ nhÆ° token Ä‘á»‡m hoáº·c
token Ä‘á»‡m cÃ³ thá»ƒ há»c Ä‘á»ƒ táº¡o ra cÃ¡c háº­u tá»‘ Ä‘áº§u ra tháº£o.
Lookahead Decoding (Fu et al., 2023)
táº¡o ra cÃ¡c pool n-gram sá»­ dá»¥ng láº·p Jacobi vÃ 
sá»­ dá»¥ng nhá»¯ng n-gram báº¯t Ä‘áº§u báº±ng token Ä‘Æ°á»£c táº¡o ra cuá»‘i cÃ¹ng
lÃ m báº£n tháº£o.
(3)CÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c khÃ¡m phÃ¡ viá»‡c truy xuáº¥t cá»¥m tá»«
tá»« cÃ¡c lá»i nháº¯c trÆ°á»›c Ä‘Ã³ hoáº·c tÃ i liá»‡u hiá»‡n cÃ³, nhÆ°
PLD (Saxena, 2023), LLMA (Yang et al., 2023a),
vÃ  REST (He et al., 2024). Nhá»¯ng phÆ°Æ¡ng phÃ¡p nÃ y sá»­ dá»¥ng
mÃ´ hÃ¬nh Ä‘Ã­ch Ä‘á»ƒ trá»±c tiáº¿p xÃ¡c minh cá»¥m tá»«, phÃ¡t sinh
chi phÃ­ tháº¥t báº¡i cao trÃªn má»—i láº§n thá»­ báº£n tháº£o. Tuy nhiÃªn, chÃºng tÃ´i
lÃ  nhá»¯ng ngÆ°á»i Ä‘áº§u tiÃªn sá»­ dá»¥ng mÃ´ hÃ¬nh tháº£o nhÆ° má»™t trung gian
Ä‘á»ƒ lá»c bá» cÃ¡c cá»¥m tá»« cháº¥t lÆ°á»£ng tháº¥p trÆ°á»›c khi cung cáº¥p
chÃºng cho mÃ´ hÃ¬nh Ä‘Ã­ch.
Cáº£ hai phÆ°Æ¡ng phÃ¡p trÃªn Ä‘á»u khÃ´ng Ä‘á»§ hiá»‡u quáº£,
vÃ¬ váº­y chÃºng tÃ´i Ä‘áº§u tiÃªn giá»›i thiá»‡u má»™t mÃ´ hÃ¬nh nhá» Ä‘á»ƒ soáº¡n tháº£o
vÃ  sau Ä‘Ã³ tiáº¿p tá»¥c tÄƒng tá»‘c quÃ¡ trÃ¬nh tháº£o
cá»§a mÃ´ hÃ¬nh nhá» báº±ng cÃ¡ch sá»­ dá»¥ng cá»¥m tá»«. ChÃºng tÃ´i liá»‡t kÃª cÃ¡c
kháº£ nÄƒng khÃ¡c nhau cho nguá»“n cá»§a cá»¥m tá»« (tá»«
mÃ´ hÃ¬nh tháº£o, tá»« xÃ¡c minh, vÃ  tá»« ngá»¯ cáº£nh
lá»‹ch sá»­) trong phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vÃ  tiáº¿n hÃ nh thá»±c nghiá»‡m loáº¡i bá»
cho má»—i nguá»“n. Äiá»u nÃ y chá»‰ ra kháº£ nÄƒng
ráº±ng cÃ¡c nguá»“n cá»¥m tá»« khÃ¡c (Saxena, 2023;
Yang et al., 2023a; He et al., 2024) cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­ch há»£p
vÃ o khung cá»§a chÃºng tÃ´i Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c hÆ¡n ná»¯a.
NgoÃ i viá»‡c táº¡o ra báº£n tháº£o tá»‘t hÆ¡n, che attention
tam giÃ¡c truyá»n thá»‘ng chá»‰ cÃ³ thá»ƒ xÃ¡c minh má»™t báº£n tháº£o
cÃ¢u sá»­ dá»¥ng má»™t lÆ°á»£t chuyá»ƒn tiáº¿n hoÃ n chá»‰nh. XÃ¡c minh
kiá»ƒu cÃ¢y (Miao et al., 2023; Cai et al., 2024; Fu
et al., 2023) thiáº¿t káº¿ che attention cá»¥ thá»ƒ Ä‘á»ƒ
xÃ¡c minh nhiá»u báº£n tháº£o cÃ³ thá»ƒ táº¡i má»™t thá»i Ä‘iá»ƒm.
5.2 Triá»ƒn khai Hiá»‡u quáº£
Giáº£i phÃ¡p trá»±c tiáº¿p nháº¥t Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c suy luáº­n
LLM hiá»‡u quáº£ lÃ  triá»ƒn khai LLM má»™t cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ táº­n dá»¥ng
cÃ¡c thiáº¿t bá»‹ pháº§n cá»©ng (nhÆ° GPU).
FlashDecoding (Dao et al., 2023) tÄƒng tá»‘c tÃ­nh toÃ¡n
attention Transformer trong LLM báº±ng cÃ¡ch phÃ¢n chia
chuá»—i giáº£i mÃ£ thÃ nh nhiá»u khá»‘i nhá» vÃ  thá»±c hiá»‡n
tÃ­nh toÃ¡n theo khá»‘i trong SRAM GPU nhanh
thay vÃ¬ GPU HBM. PageAttention (Kwon et al., 2023) sá»­ dá»¥ng quáº£n lÃ½ bá»™ nhá»› áº£o
Ä‘Æ°á»£c phÃ¢n trang Ä‘á»ƒ tá»• chá»©c bá»™ nhá»› Ä‘á»‡m giáº£i mÃ£
trong quÃ¡ trÃ¬nh giáº£i mÃ£, do Ä‘Ã³ sá»­ dá»¥ng hiá»‡u quáº£
bÄƒng thÃ´ng bá»™ nhá»› GPU Ä‘á»ƒ giáº£m chi phÃ­
truy cáº­p bá»™ nhá»› cá»§a suy luáº­n. Tensor Parallelism (Shoeybi et al., 2019) tÄƒng tá»‘c suy luáº­n
báº±ng cÃ¡ch chia sáº» ma tráº­n vÃ o cÃ¡c GPU phÃ¢n tÃ¡n vÃ  thá»±c hiá»‡n
phÃ©p nhÃ¢n ma tráº­n theo cÃ¡ch phÃ¢n tÃ¡n. Má»™t sá»‘ ná»— lá»±c triá»ƒn khai LLM báº±ng cÃ¡ch tá»‘i Æ°u hÃ³a
cÃ¡c toÃ¡n tá»­ cÆ¡ báº£n (Nvidia, a; Wang et al., 2021;
Nvidia, b) vÃ  Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£ há»©a háº¹n. LÆ°u Ã½
ráº±ng nhá»¯ng triá»ƒn khai hiá»‡u quáº£ cá»§a LLM nÃ y vÃ 
Ouroboros lÃ  trá»±c giao. Káº¿t há»£p cÃ¡c phÆ°Æ¡ng phÃ¡p triá»ƒn khai hiá»‡u quáº£
vÃ  Ouroboros cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c
tÄƒng tá»‘c suy luáº­n Ä‘Ã¡ng ká»ƒ hÆ¡n.
5.3 NÃ©n MÃ´ hÃ¬nh
CÃ¡c phÆ°Æ¡ng phÃ¡p nÃ©n mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘á» xuáº¥t Ä‘á»ƒ giáº£m
sá»‘ lÆ°á»£ng phÃ©p toÃ¡n cáº§n thiáº¿t cho viá»‡c thá»±c thi mÃ´ hÃ¬nh.
Cáº¯t tá»‰a cÃ³ cáº¥u trÃºc (Fan et al., 2020; Wang
et al., 2020; Zhang et al., 2021; Xia et al., 2022) vÃ 
cáº¯t tá»‰a khÃ´ng cÃ³ cáº¥u trÃºc (Han et al., 2015; Chen et al.,
2020; Xu et al., 2021) loáº¡i bá» cÃ¡c tham sá»‘
khÃ´ng cáº§n thiáº¿t. CÃ¡c phÆ°Æ¡ng phÃ¡p lÆ°á»£ng tá»­ hÃ³a (Zafrir et al., 2019; Frantar
et al., 2023; Lin et al., 2023; Kim et al., 2023; Stock
et al., 2021) lÆ°á»£ng tá»­ hÃ³a cÃ¡c tham sá»‘ thÃ nh cÃ¡c biá»ƒu diá»…n
bit tháº¥p. CÃ¡c phÆ°Æ¡ng phÃ¡p chÆ°ng cáº¥t (Hinton et al., 2015;
Sun et al., 2019; Jiao et al., 2020; Liu et al., 2022;
Park et al., 2021) Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giÃºp cÄƒn chá»‰nh
nhá»¯ng mÃ´ hÃ¬nh Ä‘Æ°á»£c nÃ©n Ä‘Ã³ vá»›i cÃ¡c phiÃªn báº£n gá»‘c cá»§a chÃºng
Ä‘á»ƒ duy trÃ¬ hiá»‡u suáº¥t mÃ´ hÃ¬nh. Early-exiting (Elbayad et al., 2019; Bae et al., 2023) káº¿t thÃºc
quÃ¡ trÃ¬nh suy luáº­n khi káº¿t quáº£ Ä‘áº§u ra trong
cÃ¡c lá»›p nÃ´ng Ä‘áº¡t ngÆ°á»¡ng Ä‘á»™ tin cáº­y.
MoEfication (Zhang et al., 2022; Song et al., 2023)
biáº¿n má»™t mÃ´ hÃ¬nh dÃ y Ä‘áº·c thÃ nh má»™t mÃ´ hÃ¬nh kÃ­ch hoáº¡t
thÆ°a thá»›t. NÃ©n mÃ´ hÃ¬nh vÃ  Ouroboros cÅ©ng trá»±c giao
vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­ch há»£p Ä‘á»ƒ tÄƒng tá»‘c hÆ¡n ná»¯a.
6 Káº¿t luáº­n
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t thuáº­t toÃ¡n thá»±c táº¿
Ouroboros Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u quáº£ soáº¡n tháº£o cho giáº£i
mÃ£ suy Ä‘oÃ¡n. ChÃºng tÃ´i táº¡o ra cá»¥m tá»« theo cÃ¡ch
heuristic vÃ  sá»­ dá»¥ng cá»¥m tá»« Ä‘á»ƒ giÃºp cÃ¡c mÃ´ hÃ¬nh tháº£o
tÄƒng tá»‘c soáº¡n tháº£o vÃ  lÃ m dÃ i báº£n tháº£o. Thá»±c nghiá»‡m cá»§a chÃºng tÃ´i
xÃ¡c minh ráº±ng, so vá»›i cÃ¡c baseline Ä‘iá»ƒn hÃ¬nh
giáº£i mÃ£ suy Ä‘oÃ¡n vanilla vÃ  giáº£i mÃ£ nhÃ¬n trÆ°á»›c,
Ouroboros tÆ°Æ¡ng á»©ng Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ tÄƒng
2.8Ã— vÃ  1.9Ã— vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cháº¥t lÆ°á»£ng
táº¡o ra chÃºt nÃ o. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i hoÃ n toÃ n khÃ´ng cáº§n Ä‘Ã o táº¡o,
Ä‘á»ƒ lÃ m cho nÃ³ dá»… dÃ ng Ã¡p dá»¥ng hÆ¡n cho ngÆ°á»i dÃ¹ng
giáº£i mÃ£ suy Ä‘oÃ¡n. VÃ  phiÃªn báº£n dá»±a trÃªn Ä‘Ã o táº¡o
cá»§a Ouroboros hÆ°á»›ng tá»›i tÄƒng tá»‘c cá»±c Ä‘áº¡i
sáº½ lÃ  cÃ´ng viá»‡c tiáº¿p theo cá»§a chÃºng tÃ´i.
Háº¡n cháº¿
ChÃºng tÃ´i chá»‰ táº­p trung vÃ o cáº¥u trÃºc mÃ´ hÃ¬nh chá»‰ giáº£i mÃ£
trong thá»±c nghiá»‡m. Tuy nhiÃªn, Ouroboros lÃ  má»™t
khung cÃ³ thá»ƒ má»Ÿ rá»™ng, cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho
cÃ¡c cáº¥u trÃºc mÃ´ hÃ¬nh khÃ¡c nhau. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i hiá»‡n táº¡i
táº­p trung vÃ o tá»‘i Æ°u hÃ³a trong cÃ¡c tÃ¬nh huá»‘ng khÃ´ng cáº§n Ä‘Ã o táº¡o. Náº¿u
tÃ­nh nháº¥t quÃ¡n cá»§a cÃ¡c mÃ´ hÃ¬nh lá»›n vÃ  nhá» Ä‘Æ°á»£c cáº£i thiá»‡n
thÃ´ng qua Ä‘Ã o táº¡o trong tÆ°Æ¡ng lai, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i
cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c cao hÆ¡n. Cáº£ triá»ƒn khai hiá»‡u quáº£
vÃ  nÃ©n mÃ´ hÃ¬nh Ä‘á»u trá»±c giao
vá»›i phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i, vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p Ä‘á»ƒ
tÄƒng tá»‘c hÆ¡n ná»¯a.
ChÃºng tÃ´i chá»‰ táº­p trung vÃ o tÃ¬nh huá»‘ng truy váº¥n Ä‘Æ¡n. Viá»‡c
Ã¡p dá»¥ng láº¥y máº«u suy Ä‘oÃ¡n trong tÃ¬nh huá»‘ng suy luáº­n
theo lÃ´ khÃ´ng náº±m trong pháº¡m vi cá»§a
bÃ i bÃ¡o nÃ y vÃ  cÃ³ thá»ƒ tham kháº£o (Liu et al., 2024; Qian et al.,
2024; Chen et al., 2024).
CÃ¢n nháº¯c Äáº¡o Ä‘á»©c
PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i khÃ´ng cÃ³ rá»§i ro tiá»m áº©n vÃ¬ chÃºng tÃ´i
khÃ´ng cáº§n Ä‘Ã o táº¡o vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ táº¡o ra
chÃºt nÃ o.
Lá»i cáº£m Æ¡n
CÃ´ng trÃ¬nh nÃ y Ä‘Æ°á»£c há»— trá»£ bá»Ÿi ChÆ°Æ¡ng trÃ¬nh R&D Chá»§ chá»‘t Quá»‘c gia
cá»§a Trung Quá»‘c (2022ZD0160501), Viá»‡n Guo
Qiang táº¡i Äáº¡i há»c Thanh Hoa. Yuxiang Huang Ä‘Æ°á»£c
há»— trá»£ bá»Ÿi ChÆ°Æ¡ng trÃ¬nh NghiÃªn cá»©u Khoa há»c SÃ¡ng kiáº¿n Äáº¡i há»c Thanh Hoa (ChÆ°Æ¡ng trÃ¬nh ThÃºc Ä‘áº©y NghiÃªn cá»©u Há»c thuáº­t Sinh viÃªn). ChÃºng tÃ´i ghi nháº­n
cÃ¡c cuá»™c tháº£o luáº­n cÃ³ giÃ¡ trá»‹ vá»›i Yuhui Li, tÃ¡c giáº£ cá»§a
EAGLE.
TÃ i liá»‡u tham kháº£o
Jacob Austin, Augustus Odena, Maxwell Nye, Maarten
Bosma, Henryk Michalewski, David Dohan, Ellen
Jiang, Carrie Cai, Michael Terry, Quoc Le, et al. 2021.
Program synthesis with large language models. arXiv
preprint arXiv:2108.07732 .
Sangmin Bae, Jongwoo Ko, Hwanjun Song, and Se-
Young Yun. 2023. Fast and robust early-exiting
framework for autoregressive language models with
synchronized parallel decoding. In Proceedings of
EMNLP .
Xiao Bi, Deli Chen, Guanting Chen, Shanhuang Chen,
Damai Dai, Chengqi Deng, Honghui Ding, Kai Dong,
Qiushi Du, Zhe Fu, et al. 2024. Deepseek llm: Scal-
ing open-source language models with longtermism.
arXiv preprint arXiv:2401.02954 .

--- TRANG 10 ---
OndÅ™ej Bojar, Rajen Chatterjee, Christian Federmann,
Yvette Graham, Barry Haddow, Matthias Huck, An-
tonio Jimeno Yepes, Philipp Koehn, Varvara Lo-
gacheva, Christof Monz, Matteo Negri, Aurelie
Neveol, Mariana Neves, Martin Popel, Matt Post,
Raphael Rubino, Carolina Scarton, Lucia Specia,
Marco Turchi, Karin Verspoor, and Marcos Zampieri.
2016. Findings of the 2016 conference on machine
translation. In Proceedings of the First Conference
on Machine Translation , pages 131â€“198.
Tianle Cai, Yuhong Li, Zhengyang Geng, Hongwu Peng,
Jason D. Lee, Deming Chen, and Tri Dao. 2024.
Medusa: Simple llm inference acceleration frame-
work with multiple decoding heads. arXiv preprint
arXiv: 2401.10774 .
Charlie Chen, Sebastian Borgeaud, Geoffrey Irving,
Jean-Baptiste Lespiau, Laurent Sifre, and John
Jumper. 2023a. Accelerating large language model
decoding with speculative sampling. arXiv preprint
arXiv:2302.01318 .
Jian Chen, Vashisth Tiwari, Ranajoy Sadhukhan,
Zhuoming Chen, Jinyuan Shi, Ian En-Hsu Yen,
and Beidi Chen. 2024. Magicdec: Breaking the
latency-throughput tradeoff for long context gen-
eration with speculative decoding. arXiv preprint
arXiv:2408.11049 .
Mark Chen, Jerry Tworek, Heewoo Jun, Qiming
Yuan, Henrique Ponde de Oliveira Pinto, Jared Ka-
plan, Harri Edwards, Yuri Burda, Nicholas Joseph,
Greg Brockman, et al. 2021. Evaluating large
language models trained on code. arXiv preprint
arXiv:2107.03374 .
Tianlong Chen, Jonathan Frankle, Shiyu Chang, Sijia
Liu, Yang Zhang, Zhangyang Wang, and Michael
Carbin. 2020. The lottery ticket hypothesis for pre-
trained bert networks. In Proceedings of NeurIPS ,
pages 15834â€“15846.
Ziyi Chen, Xiaocong Yang, Jiacheng Lin, Chenkai Sun,
Jie Huang, and Kevin Chen-Chuan Chang. 2023b.
Cascade speculative drafting for even faster llm infer-
ence. arXiv preprint arXiv:2312.11462 .
Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian,
Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias
Plappert, Jerry Tworek, Jacob Hilton, Reiichiro
Nakano, Christopher Hesse, and John Schulman.
2021. Training verifiers to solve math word prob-
lems. arXiv preprint arXiv:2110.14168 .
Tri Dao, Daniel Haziza, Francisco Massa, and Grig-
ory Sizov. 2023. Flash-decoding for long-context
inference.
Maha Elbayad, Jiatao Gu, Edouard Grave, and Michael
Auli. 2019. Depth-adaptive transformer. In Proceed-
ings of ICLR .
Angela Fan, Edouard Grave, and Armand Joulin. 2020.
Reducing transformer depth on demand with struc-
tured dropout. In Proceedings of ICLR .
Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and
Dan Alistarh. 2023. Gptq: Accurate quantization for
generative pre-trained transformers. In Proceedings
of ICLR .
Yichao Fu, Peter Bailis, Ion Stoica, and Hao Zhang.
2023. Breaking the sequential dependency of llm
inference using lookahead decoding.
Marjan Ghazvininejad, Omer Levy, Yinhan Liu, and
Luke Zettlemoyer. 2019. Mask-predict: Parallel
decoding of conditional masked language models.
arXiv preprint arXiv:1904.09324 .
Junliang Guo, Linli Xu, and Enhong Chen. 2020.
Jointly masked sequence-to-sequence model for non-
autoregressive neural machine translation. In Pro-
ceedings of ACL , pages 376â€“385.
Song Han, Jeff Pool, John Tran, and William J. Dally.
2015. Learning both weights and connections for
efficient neural network. In Proceedings of NeurIPS ,
pages 1135â€“1143.
Zhenyu He, Zexuan Zhong, Tianle Cai, Jason Lee, and
Di He. 2024. REST: Retrieval-based speculative
decoding. In Proceedings of NAACL , pages 1582â€“
1595.
Karl Moritz Hermann, TomÃ¡s KociskÃ½, Edward Grefen-
stette, Lasse Espeholt, Will Kay, Mustafa Suleyman,
and Phil Blunsom. 2015. Teaching machines to read
and comprehend. In Proceedings of NeurIPS , pages
1693â€“1701.
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. 2015.
Distilling the knowledge in a neural network. arXiv
preprint arXiv:1503.02531 .
Xiaoqi Jiao, Yichun Yin, Lifeng Shang, Xin Jiang, Xiao
Chen, Linlin Li, Fang Wang, and Qun Liu. 2020.
TinyBERT: Distilling BERT for natural language
understanding. In Findings of EMNLP , pages 4163â€“
4174.
Sehoon Kim, Coleman Hooper, Amir Gholami, Zhen
Dong, Xiuyu Li, Sheng Shen, Michael W Ma-
honey, and Kurt Keutzer. 2023. Squeezellm:
Dense-and-sparse quantization. arXiv preprint
arXiv:2306.07629 .
Woosuk Kwon, Zhuohan Li, Siyuan Zhuang, Ying
Sheng, Lianmin Zheng, Cody Hao Yu, Joseph E. Gon-
zalez, Hao Zhang, and Ion Stoica. 2023. Efficient
memory management for large language model serv-
ing with pagedattention. In Proceedings of SOSP .
Yaniv Leviathan, Matan Kalman, and Yossi Matias.
2023. Fast inference from transformers via spec-
ulative decoding. In Proceedings of ICML , pages
19274â€“19286.
Yuhui Li, Fangyun Wei, Chao Zhang, and Hongyang
Zhang. 2024. Eagle: Speculative sampling requires
rethinking feature uncertainty. In Proceedings of
ICML .

--- TRANG 11 ---
Ji Lin, Jiaming Tang, Haotian Tang, Shang Yang,
Xingyu Dang, and Song Han. 2023. Awq: Activation-
aware weight quantization for llm compression and
acceleration. arXiv preprint arXiv:2306.00978 .
Chang Liu, Chongyang Tao, Jiazhan Feng, and Dongyan
Zhao. 2022. Multi-granularity structural knowledge
distillation for language model compression. In Pro-
ceedings of ACL , pages 1001â€“1011.
Xiaoxuan Liu, Cade Daniel, Langxiang Hu, Woosuk
Kwon, Zhuohan Li, Xiangxi Mo, Alvin Cheung,
Zhijie Deng, Ion Stoica, and Hao Zhang. 2024.
Optimizing speculative decoding for serving large
language models using goodput. arXiv preprint
arXiv:2406.14066 .
Xupeng Miao, Gabriele Oliaro, Zhihao Zhang, Xinhao
Cheng, Zeyu Wang, Rae Ying Yee Wong, Zhuom-
ing Chen, Daiyaan Arfeen, Reyna Abhyankar, and
Zhihao Jia. 2023. Specinfer: Accelerating generative
llm serving with speculative inference and token tree
verification. arXiv preprint arXiv:2305.09781 .
Giovanni Monea, Armand Joulin, and Edouard Grave.
2023. Pass: Parallel speculative sampling. arXiv
preprint arXiv:2311.13581 .
Nvidia. a. Fastertransformer.
Nvidia. b. Tensorrt-llm.
Geondo Park, Gyeongman Kim, and Eunho Yang. 2021.
Distilling linguistic context for language model com-
pression. In Proceedings of EMNLP , pages 364â€“378.
Haifeng Qian, Sujan Kumar Gonugondla, Sungsoo Ha,
Mingyue Shang, Sanjay Krishna Gouda, Ramesh Nal-
lapati, Sudipta Sengupta, Xiaofei Ma, and Anoop De-
oras. 2024. Bass: Batched attention-optimized spec-
ulative sampling. arXiv preprint arXiv:2404.15778 .
Jeff Rasley, Samyam Rajbhandari, Olatunji Ruwase, and
Yuxiong He. 2020. Deepspeed: System optimiza-
tions enable training deep learning models with over
100 billion parameters. In Proceedings of SIGKDD ,
pages 3505â€“3506.
Baptiste Roziere, Jonas Gehring, Fabian Gloeckle, Sten
Sootla, Itai Gat, Xiaoqing Ellen Tan, Yossi Adi,
Jingyu Liu, Tal Remez, JÃ©rÃ©my Rapin, et al. 2023.
Code llama: Open foundation models for code. arXiv
preprint arXiv:2308.12950 .
Andrea Santilli, Silvio Severino, Emilian Postolache,
Valentino Maiorca, Michele Mancusi, Riccardo
Marin, and Emanuele RodolÃ . 2023. Accelerating
transformer inference for translation via parallel de-
coding. arXiv preprint arXiv:2305.10427 .
Apoorv Saxena. 2023. Prompt lookup decoding.
Abigail See, Peter J. Liu, and Christopher D. Manning.
2017. Get to the point: Summarization with pointer-
generator networks. In Proceedings of ACL , pages
1073â€“1083.
Mohammad Shoeybi, Mostofa Patwary, Raul Puri,
Patrick LeGresley, Jared Casper, and Bryan Catan-
zaro. 2019. Megatron-lm: Training multi-billion
parameter language models using model parallelism.
arXiv preprint arXiv:1909.08053 .
Yixin Song, Zeyu Mi, Haotong Xie, and Haibo Chen.
2023. Powerinfer: Fast large language model serv-
ing with a consumer-grade gpu. arXiv preprint
arXiv:2312.12456 .
Benjamin Spector and Chris Re. 2023. Accelerating llm
inference with staged speculative decoding. arXiv
preprint arXiv:2308.04623 .
Mitchell Stern, Noam Shazeer, and Jakob Uszkoreit.
2018. Blockwise parallel decoding for deep autore-
gressive models. volume 31.
Pierre Stock, Angela Fan, Benjamin Graham, Edouard
Grave, RÃ©mi Gribonval, Herve Jegou, and Armand
Joulin. 2021. Training with quantization noise for ex-
treme model compression. In Proceedings of ICLR .
Siqi Sun, Yu Cheng, Zhe Gan, and Jingjing Liu. 2019.
Patient knowledge distillation for BERT model com-
pression. In Proceedings EMNLP-IJCNLP , pages
4323â€“4332.
Hugo Touvron, Louis Martin, Kevin Stone, Peter Al-
bert, Amjad Almahairi, Yasmine Babaei, Nikolay
Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti
Bhosale, et al. 2023. Llama 2: Open founda-
tion and fine-tuned chat models. arXiv preprint
arXiv:2307.09288 .
Xiaohui Wang, Ying Xiong, Yang Wei, Mingxuan Wang,
and Lei Li. 2021. LightSeq: A high performance
inference library for transformers. In Proceedings of
NAACL , pages 113â€“120.
Ziheng Wang, Jeremy Wohlwend, and Tao Lei. 2020.
Structured pruning of large language models. In
Proceedings of EMNLP , pages 6151â€“6162.
Bingzhen Wei, Mingxuan Wang, Hao Zhou, Junyang
Lin, Jun Xie, and Xu Sun. 2019. Imitation learning
for non-autoregressive neural machine translation.
arXiv preprint arXiv:1906.02041 .
Heming Xia, Tao Ge, Peiyi Wang, Si-Qing Chen, Furu
Wei, and Zhifang Sui. 2023a. Speculative decod-
ing: Exploiting speculative execution for accelerat-
ing seq2seq generation. In Proceedings of EMNLP ,
pages 3909â€“3925.
Heming Xia, Zhe Yang, Qingxiu Dong, Peiyi Wang,
Yongqi Li, Tao Ge, Tianyu Liu, Wenjie Li, and
Zhifang Sui. 2024. Unlocking efficiency in large
language model inference: A comprehensive sur-
vey of speculative decoding. arXiv preprint
arXiv:2401.07851 .
Mengzhou Xia, Tianyu Gao, Zhiyuan Zeng, and Danqi
Chen. 2023b. Sheared llama: Accelerating language
model pre-training via structured pruning. arXiv
preprint arXiv:2310.06694 .

--- TRANG 12 ---
Mengzhou Xia, Zexuan Zhong, and Danqi Chen. 2022.
Structured pruning learns compact and accurate mod-
els. In Proceedings of ACL , pages 1513â€“1528.
Dongkuan Xu, Ian En-Hsu Yen, Jinxi Zhao, and Zhibin
Xiao. 2021. Rethinking network pruning â€“ under the
pre-train and fine-tune paradigm. In Proceedings of
NAACL , pages 2376â€“2382.
Nan Yang, Tao Ge, Liang Wang, Binxing Jiao, Daxin
Jiang, Linjun Yang, Rangan Majumder, and Furu
Wei. 2023a. Inference with reference: Lossless ac-
celeration of large language models. arXiv preprint
arXiv:2304.04487 .
Seongjun Yang, Gibbeum Lee, Jaewoong Cho, Dim-
itris Papailiopoulos, and Kangwook Lee. 2023b.
Predictive pipelined decoding: A compute-latency
trade-off for exact llm decoding. arXiv preprint
arXiv:2307.05908 .
Alex Young, Bei Chen, Chao Li, Chengen Huang,
Ge Zhang, Guanwei Zhang, Heng Li, Jiangcheng
Zhu, Jianqun Chen, Jing Chang, et al. 2024. Yi:
Open foundation models by 01. ai. arXiv preprint
arXiv:2403.04652 .
Ofir Zafrir, Guy Boudoukh, Peter Izsak, and Moshe
Wasserblat. 2019. Q8bert: Quantized 8bit bert. In
Proceedings of EMC2-NIPS , pages 36â€“39.
Jun Zhang, Jue Wang, Huan Li, Lidan Shou, Ke Chen,
Gang Chen, and Sharad Mehrotra. 2024a. Draft&
verify: Lossless large language model acceleration
via self-speculative decoding. In Proceedings of ACL ,
pages 11263â€“11282.
Peiyuan Zhang, Guangtao Zeng, Tianduo Wang, and
Wei Lu. 2024b. Tinyllama: An open-source small
language model. arXiv preprint arXiv:2401.02385 .
Zhengyan Zhang, Yankai Lin, Zhiyuan Liu, Peng Li,
Maosong Sun, and Jie Zhou. 2022. MoEfication:
Transformer feed-forward layers are mixtures of ex-
perts. In Findings of ACL , pages 877â€“890.
Zhengyan Zhang, Fanchao Qi, Zhiyuan Liu, Qun Liu,
and Maosong Sun. 2021. Know what you don't need:
Single-shot meta-pruning for attention heads. vol-
ume 2, pages 36â€“42.
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan
Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin,
Zhuohan Li, Dacheng Li, Eric Xing, et al. 2024.
Judging llm-as-a-judge with mt-bench and chatbot
arena. Proceedings of NeurIPS , 36.
Yongchao Zhou, Kaifeng Lyu, Ankit Singh Rawat,
Aditya Krishna Menon, Afshin Rostamizadeh, San-
jiv Kumar, Jean-FranÃ§ois Kagy, and Rishabh Agar-
wal. 2023. Distillspec: Improving speculative de-
coding via knowledge distillation. arXiv preprint
arXiv:2310.08461 .

--- TRANG 13 ---
A Ouroboros khÃ´ng gÃ¢y ra báº¥t ká»³
suy giáº£m hiá»‡u suáº¥t nÃ o
MÃ´ hÃ¬nhYi
34B/6BDeepSeek
33b/6.7BCodeLlama
34B/7B
HumanEvalTham lam 18.3 64.6 36.0
Suy Ä‘oÃ¡n 18.9 64.6 36.0
NhÃ¬n trÆ°á»›c 18.9 64.6 36.0
Ouroboros 18.9 64.6 36.0
MBPPTham lam 37.8 70.0 46.6
Suy Ä‘oÃ¡n 38.9 71.1 46.6
NhÃ¬n trÆ°á»›c 38.9 71.1 46.6
Ouroboros 38.9 71.1 46.6
Báº£ng 7: Hiá»‡u suáº¥t nhiá»‡m vá»¥ cá»§a HumanEval vÃ  MBPP
cá»§a Tham lam, Suy Ä‘oÃ¡n, NhÃ¬n trÆ°á»›c vÃ  Ouroboros sá»­
dá»¥ng táº¡o ra tham lam. ChÃºng tÃ´i bÃ¡o cÃ¡o Äá»™ chÃ­nh xÃ¡c(%) cá»§a Hu-
manEval vÃ  MBPP.
MÃ´ hÃ¬nhYi
34B/6BLlama
70B/7B
GSM8KTham lam 61.0 66.0
Suy Ä‘oÃ¡n 61.0 66.0
NhÃ¬n trÆ°á»›c 61.0 66.0
Ouroboros 61.0 65.0
CNN/DMTham lam 35.2 37.1
Suy Ä‘oÃ¡n 35.1 37.2
NhÃ¬n trÆ°á»›c 35.3 37.1
Ouroboros 35.3 37.1
WMT16Tham lam 21.7 31.1
Suy Ä‘oÃ¡n 21.9 31.1
NhÃ¬n trÆ°á»›c 22.0 31.1
Ouroboros 21.1 31.1
Báº£ng 8: Hiá»‡u suáº¥t nhiá»‡m vá»¥ cá»§a GSM8K, CNN/DM
vÃ  WMT16 cá»§a Tham lam, Suy Ä‘oÃ¡n, NhÃ¬n trÆ°á»›c vÃ 
Ouroboros sá»­ dá»¥ng táº¡o ra tham lam. ChÃºng tÃ´i bÃ¡o cÃ¡o Äá»™ chÃ­nh
xÃ¡c cá»§a GSM8K(%), Ä‘iá»ƒm Rouge1(%) cá»§a CNN/DM vÃ 
Ä‘iá»ƒm BLEU(%) cá»§a WMT16.
Báº£ng 7, 8 vÃ  9 cho tháº¥y hiá»‡u suáº¥t nhiá»‡m vá»¥ cá»§a
cÃ¡c thá»±c nghiá»‡m Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 5 vÃ  Báº£ng 2.
Vá» máº·t lÃ½ thuyáº¿t, Giáº£i mÃ£ Suy Ä‘oÃ¡n, Giáº£i mÃ£ NhÃ¬n trÆ°á»›c
vÃ  Ouroboros táº¡o ra cÃ¹ng má»™t chuá»—i token
so vá»›i Giáº£i mÃ£ vanilla.
ChÃºng tÃ´i quan sÃ¡t tháº¥y khÃ´ng cÃ³ suy giáº£m hiá»‡u suáº¥t tá»•ng thá»ƒ
nÃ o cá»§a Ouroboros tá»« Báº£ng 7, 8 vÃ  9. Sá»± khÃ¡c biá»‡t nhá»
trong hiá»‡u suáº¥t nhiá»‡m vá»¥ giá»¯a vanilla, Suy
Ä‘oÃ¡n, NhÃ¬n trÆ°á»›c vÃ  Ouroboros lÃ  do
lá»—i dáº¥u pháº©y Ä‘á»™ng, vÃ¬ cÃ¡c phÃ©p tÃ­nh khÃ´ng
hoÃ n toÃ n giá»‘ng nhau giá»¯a cÃ¡c phÆ°Æ¡ng phÃ¡p (Ä‘áº·c biá»‡t lÃ 
thá»© tá»± tÃ­nh toÃ¡n cá»§a attention). Káº¿t quáº£ thá»±c nghiá»‡m
cho tháº¥y ráº±ng lá»—i tÃ­nh toÃ¡n sáº½ khÃ´ng gÃ¢y ra
suy giáº£m hiá»‡u suáº¥t Ä‘Ã¡ng chÃº Ã½.
MÃ´ hÃ¬nhYi
34B/6B
HumanEvalLáº¥y máº«u Ngáº«u nhiÃªn 15.9
Suy Ä‘oÃ¡n 18.9
NhÃ¬n trÆ°á»›c 18.9
Ouroboros 17.7
MBPPLáº¥y máº«u Ngáº«u nhiÃªn 36.7
Suy Ä‘oÃ¡n 33.3
NhÃ¬n trÆ°á»›c 35.6
Ouroboros 36.7
GSM8KLáº¥y máº«u Ngáº«u nhiÃªn 67.0
Suy Ä‘oÃ¡n 70.0
NhÃ¬n trÆ°á»›c 69.0
Ouroboros 69.0
CNN/DMLáº¥y máº«u Ngáº«u nhiÃªn 34.6
Suy Ä‘oÃ¡n 34.0
NhÃ¬n trÆ°á»›c 34.6
Ouroboros 35.6
WMT16Láº¥y máº«u Ngáº«u nhiÃªn 20.6
Suy Ä‘oÃ¡n 21.2
NhÃ¬n trÆ°á»›c 22.7
Ouroboros 25.0
Báº£ng 9: Hiá»‡u suáº¥t nhiá»‡m vá»¥ sá»­ dá»¥ng láº¥y máº«u ngáº«u nhiÃªn. ChÃºng tÃ´i
bÃ¡o cÃ¡o Ä‘á»™ chÃ­nh xÃ¡c cho HumanEval, MBPP vÃ  GSM8K,
Ä‘iá»ƒm Rouge 1 cho CNN/DM vÃ  Ä‘iá»ƒm BLEU cho
WMT16.
B SiÃªu tham sá»‘
W lÃ  má»™t siÃªu tham sá»‘ Ä‘Æ°á»£c sá»­ dá»¥ng trong Giáº£i mÃ£ NhÃ¬n trÆ°á»›c
Ä‘á»ƒ táº¡o ra cá»¥m tá»«. W lá»›n hÆ¡n chá»‰ ra nhiá»u
cá»¥m tá»« hÆ¡n Ä‘Æ°á»£c táº¡o ra trong má»—i lÆ°á»£t chuyá»ƒn tiáº¿n cá»§a mÃ´ hÃ¬nh tháº£o
cá»§a chÃºng tÃ´i trong Ouroboros, nhÆ°ng cÅ©ng cÃ³ thá»ƒ tá»‘n thá»i gian hÆ¡n.
Äá»ƒ Ä‘iá»u tra Ä‘á»™ nháº¡y cáº£m cá»§a siÃªu tham sá»‘, chÃºng tÃ´i
tiáº¿n hÃ nh tÃ¬m kiáº¿m lÆ°á»›i trÃªn Î³, W vÃ  Î² trÃªn GSM8K
vá»›i Yi-34B/6B. ChÃºng tÃ´i bÃ¡o cÃ¡o token/s cá»§a má»—i cÃ i Ä‘áº·t.
W= 14 W= 15 W= 16
Î²= 5 Î²= 6 Î²= 7 Î²= 5 Î²= 6 Î²= 7 Î²= 5 Î²= 6 Î²= 7
Î³= 3 28.17 28.07 27.30 27.97 28.23 27.38 28.34 27.64 27.21
Î³= 4 28.52 28.42 27.91 29.06 28.77 28.23 29.00 28.68 27.64
Î³= 5 28.13 29.32 28.20 28.31 28.96 27.99 27.94 29.03 27.90
Ä‘á»™ lá»‡ch chuáº©n token/s: 0.57 Ä‘á»™ lá»‡ch chuáº©n tÄƒng tá»‘c: 0.04
Báº£ng 10: Káº¿t quáº£ cá»§a tÃ¬m kiáº¿m lÆ°á»›i vá»›i Î³âˆˆ
[3,5], Wâˆˆ[14,16], Î²âˆˆ[5,7]. "std" Ä‘áº¡i diá»‡n cho
Ä‘á»™ lá»‡ch chuáº©n.
Báº£ng 10 cho tháº¥y Ouroboros á»•n Ä‘á»‹nh vá»›i cÃ¡c
siÃªu tham sá»‘. Äiá»u nÃ y táº¡o cÆ¡ há»™i Ä‘á»ƒ cung
cáº¥p má»™t cÃ´ng thá»©c chung hoáº·c tiáº¿n hÃ nh tÃ¬m kiáº¿m heuristic
thay vÃ¬ tÃ¬m kiáº¿m lÆ°á»›i Ä‘á»ƒ tÃ¬m má»™t káº¿t há»£p tá»‘t
cá»§a cÃ¡c siÃªu tham sá»‘ trong thá»i gian ngáº¯n.
B.1 CÃ´ng thá»©c SiÃªu tham sá»‘
á» Ä‘Ã¢y, chÃºng tÃ´i cung cáº¥p má»™t cÃ´ng thá»©c chung cho viá»‡c Ä‘iá»u chá»‰nh
siÃªu tham sá»‘ trong Báº£ng 11. ChÃºng tÃ´i phÃ¢n biá»‡t cÃ¡c nhiá»‡m vá»¥
downstream thÃ nh hai loáº¡i: (1) HH: TÃ­nh Ä‘á»“ng nháº¥t cao
giá»¯a mÃ´ hÃ¬nh tháº£o vÃ  Ä‘Ã­ch, vÃ­ dá»¥: táº¡o mÃ£

--- TRANG 14 ---
tion; (2) LH: TÃ­nh Ä‘á»“ng nháº¥t tháº¥p giá»¯a mÃ´ hÃ¬nh tháº£o vÃ  Ä‘Ã­ch, vÃ­ dá»¥: dá»‹ch mÃ¡y.
Nhiá»‡m vá»¥ Î³ W Î² K
HH 7âˆ¼14 15 âˆ¼20 5 âˆ¼7 3âˆ¼5
LH 2âˆ¼6 15 âˆ¼20 5 âˆ¼7 3âˆ¼5
Báº£ng 11: Má»™t cÃ´ng thá»©c thá»±c nghiá»‡m cho viá»‡c Ä‘iá»u chá»‰nh siÃªu tham sá»‘.
B.2 Äiá»u chá»‰nh SiÃªu tham sá»‘
Theo tÃ­nh á»•n Ä‘á»‹nh cá»§a cÃ¡c siÃªu tham sá»‘, chÃºng tÃ´i
tiáº¿n hÃ nh tÃ¬m kiáº¿m heuristic Ä‘á»ƒ tÃ¬m má»™t káº¿t há»£p tá»‘t.
Thuáº­t toÃ¡n cá»§a tÃ¬m kiáº¿m heuristic Ä‘Æ°á»£c
mÃ´ táº£ trong Thuáº­t toÃ¡n 1.
Thuáº­t toÃ¡n 1: TÃ¬m kiáº¿m Heuristic cá»§a SiÃªu tham sá»‘
Äáº§u vÃ o: Loáº¡i nhiá»‡m vá»¥ T, Bá»™ dá»¯ liá»‡u D, HÃ m má»¥c tiÃªu f.
Äáº§u ra: SiÃªu tham sá»‘ Î³, W, Î², K
K0:= 3//K luÃ´n luÃ´n lÃ  3 trong cÃ¡c thá»±c nghiá»‡m cá»§a chÃºng tÃ´i
Ë†Wâˆ¼[15,20]
Ë†Î²âˆ¼[5,7]
náº¿u T=HH thÃ¬
Ë†Î³âˆ¼[7,14]
ngÆ°á»£c láº¡i
Ë†Î³âˆ¼[2,6]
káº¿t thÃºc náº¿u
Î³0:= arg min Î³Thá»i gian Äá»“ng há»“ (f(D; Ë†Î³,Ë†W,Ë†Î², K0))
W0:= arg min WThá»i gian Äá»“ng há»“ (f(D;Î³0,Ë†W,Ë†Î², K0))
Î²0:= arg min Î²Thá»i gian Äá»“ng há»“ (f(D;Î³0, W0,Ë†Î², K0))
tráº£ vá» Î³0, W0, Î²0, K0
B.3 SiÃªu tham sá»‘ ÄÆ°á»£c Sá»­ dá»¥ng trong Thá»±c nghiá»‡m cá»§a ChÃºng tÃ´i
CÃ¡c siÃªu tham sá»‘ cá»§a thá»±c nghiá»‡m cá»§a chÃºng tÃ´i Ä‘Æ°á»£c hiá»ƒn thá»‹
trong Báº£ng 12. Trong Báº£ng 4, chÃºng tÃ´i sá»­ dá»¥ng Î³= 12, W=
20, Î²= 8 vÃ  K= 3. Trong HÃ¬nh 6, chÃºng tÃ´i sá»­ dá»¥ng Î³=
12, W= 20, Î²= 8. Trong Báº£ng 17, chÃºng tÃ´i sá»­ dá»¥ng Î³=
6, W= 18, Î²= 6 vÃ  K= 3. Trong Báº£ng 13, chÃºng tÃ´i
theo cÃ¡c siÃªu tham sá»‘ trong Báº£ng 12.
C Hiá»‡u quáº£ Khá»‘i
Äá»ƒ cho tháº¥y tiá»m nÄƒng cá»§a viá»‡c tá»‘i Æ°u hÃ³a há»‡ thá»‘ng
hÆ¡n ná»¯a, chÃºng tÃ´i theo Miao et al. (2023) Ä‘á»ƒ kiá»ƒm tra
Hiá»‡u quáº£ Khá»‘i, vá»›i giáº£ Ä‘á»‹nh ráº±ng thá»i gian
soáº¡n tháº£o cÃ³ thá»ƒ Ä‘Æ°á»£c bá» qua hoÃ n toÃ n. Hiá»‡u quáº£ khá»‘i
lÃ  giá»›i háº¡n trÃªn lÃ½ thuyáº¿t cá»§a tá»· lá»‡ tÄƒng tá»‘c, mÃ  khÃ´ng
xem xÃ©t báº¥t ká»³ rÃ ng buá»™c tÃ i nguyÃªn nÃ o.
Äá»‹nh nghÄ©a C.1 (Hiá»‡u quáº£ Khá»‘i). Äá»‹nh nghÄ©a Hiá»‡u quáº£
Khá»‘i Î· nhÆ°
Î·=# Token Ä‘Æ°á»£c táº¡o ra
# Láº§n gá»i mÃ´ hÃ¬nh Ä‘Ã­ch
Nhiá»‡m vá»¥ MÃ´inhSpeculative Lookahead Ouroboros
Î³ W Î² Î³ W Î² K
HumanEvalYi-34B/6B 12 16 7 12 20 8 3
DeepSeek-33b/6.7B 3 16 7 11 20 8 3
CodeLlama-34B/7B 5 17 5 10 20 7 3
MBPPYi-34B/6B 6 16 6 6 18 6 3
DeepSeek-33b/6.7B 5 15 7 7 15 6 3
CodeLlama-34B/7B 4 16 6 8 16 7 3
GSM8KYi-34B/6B 7 15 6 4 15 7 3
Llama-70B/7B 7 15 6 6 17 7 3
CNN/DMYi-34B/6B 5 15 6 10 15 6 3
Llama-70B/7B 4 16 5 4 13 6 3
WMT16Yi-34B/6B 2 15 6 5 16 6 3
Llama-70B/7B 5 18 7 4 13 6 3
Báº£ng 12: SiÃªu tham sá»‘ cá»§a cÃ¡c thá»±c nghiá»‡m trong HÃ¬nh 5
vÃ  Báº£ng 2.
ChÃºng tÃ´i Ä‘o Hiá»‡u quáº£ Khá»‘i vá»›i Yi-34B/6B
trÃªn táº¥t cáº£ 5 bá»™ dá»¯ liá»‡u theo cÃ¡c cÃ i Ä‘áº·t cá»§a HÃ¬nh 5
vÃ  Báº£ng 2. Káº¿t quáº£ trong Báº£ng 13.
Speculative Lookahead Ouroboros
HumanEval 11.16 3.08 13.12
MBPP 6.14 2.71 7.43
GSM8K 5.23 2.30 4.65
CNN/DM 4.71 1.70 7.46
WMT16 2.41 1.37 4.05
Báº£ng 13: Hiá»‡u quáº£ Khá»‘i Î· cá»§a Yi-34B/6B trÃªn
HumanEval, MBPP, GSM8K, CNN/DM vÃ  WMT16.
PhÆ°Æ¡ng phÃ¡p vá»›i Î· lá»›n nháº¥t Ä‘Æ°á»£c lÃ m ná»•i báº­t báº±ng chá»¯ Ä‘áº­m,
vÃ  káº¿t quáº£ lá»›n thá»© hai Ä‘Æ°á»£c gáº¡ch chÃ¢n.
Tá»« Báº£ng 13, Ouroboros cÃ³ Hiá»‡u quáº£ Khá»‘i tÆ°Æ¡ng Ä‘á»‘i cao
trong háº§u háº¿t cÃ¡c tÃ¬nh huá»‘ng, cho tháº¥y ráº±ng
nÃ³ cÃ³ tá»· lá»‡ tÄƒng tá»‘c lÃ½ tÆ°á»Ÿng lá»›n hÆ¡n cÃ³ thá»ƒ
Ä‘Æ°á»£c Ä‘áº¡t Ä‘Æ°á»£c bá»Ÿi cÃ¡c thuáº­t toÃ¡n hoáº·c triá»ƒn khai há»‡ thá»‘ng
trong tÆ°Æ¡ng lai.
D So sÃ¡nh vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p
gia tá»‘c tháº£o khÃ¡c
Cascade Speculative Decoding (Chen et al., 2023b)
lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘iá»ƒn hÃ¬nh tÄƒng tá»‘c mÃ´ hÃ¬nh
tháº£o trong giáº£i mÃ£ suy Ä‘oÃ¡n báº±ng cÃ¡ch tiáº¿p tá»¥c sá»­ dá»¥ng
má»™t mÃ´ hÃ¬nh tháº­m chÃ­ nhá» hÆ¡n Ä‘á»ƒ soáº¡n tháº£o cho mÃ´ hÃ¬nh tháº£o.
So sÃ¡nh giá»¯a Ouroboros vÃ  Cascade
Ä‘Æ°á»£c mÃ´ táº£ trong Báº£ng 14. Káº¿t quáº£ cho tháº¥y ráº±ng
Ouroboros vÆ°á»£t trá»™i hÆ¡n Cascade, cho tháº¥y ráº±ng
cÃ¡ch chÃºng tÃ´i tÄƒng tá»‘c báº£n tháº£o hiá»‡u quáº£ hÆ¡n.
Cascade hoáº¡t Ä‘á»™ng cháº­m hÆ¡n so vá»›i giáº£i mÃ£ suy Ä‘oÃ¡n
ban Ä‘áº§u. Má»™t lÃ½ do cÃ³ thá»ƒ lÃ  cÃ¡c mÃ´ hÃ¬nh
nhá» Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ tÄƒng tá»‘c mÃ´ hÃ¬nh Llama-
2-7B, tá»©c lÃ  Llama-160M (Miao et al., 2023)
vÃ  TinyLlama-1.1B (Zhang et al., 2024b), khÃ´ng Ä‘Æ°á»£c
Ä‘Ã o táº¡o chÃ­nh thá»©c bá»Ÿi Meta. Äiá»u nÃ y Ä‘Ã£ dáº«n Ä‘áº¿n sá»±
khÃ´ng khá»›p trong Ä‘áº§u ra cá»§a mÃ´ hÃ¬nh, do Ä‘Ã³ lÃ m cháº­m
quÃ¡ trÃ¬nh soáº¡n tháº£o.

--- TRANG 15 ---
PhÆ°Æ¡ng phÃ¡p DÃ²ng MÃ´ hÃ¬nh token/s
Speculative 7Bâ†’70B 16.86
Cascade 160Mâ†’7Bâ†’70B 7.90
Cascade 1.1Bâ†’7Bâ†’70B 9.22
Ouroboros 7Bâ†’70B 24.03
Báº£ng 14: So sÃ¡nh vá»›i cÃ¡c phiÃªn báº£n cascade khÃ¡c nhau cá»§a
giáº£i mÃ£ suy Ä‘oÃ¡n, Ä‘Æ°á»£c thá»­ nghiá»‡m trÃªn GSM8K.
E Ouroboros dÆ°á»›i cÃ¡c Ä‘á»™ dÃ i táº¡o ra
khÃ¡c nhau
Äá»ƒ Ä‘iá»u tra tá»· lá»‡ tÄƒng tá»‘c dÆ°á»›i cÃ¡c giá»›i háº¡n Ä‘á»™ dÃ i
táº¡o ra khÃ¡c nhau, chÃºng tÃ´i tiáº¿n hÃ nh thá»±c nghiá»‡m sau
vá»›i cÃ¡c giá»›i háº¡n Ä‘á»™ dÃ i táº¡o ra 64, 128,
256, vÃ  512. Thá»±c nghiá»‡m nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn
GSM8K vá»›i Yi-34B/6B, vá»›i cÃ¡c siÃªu tham sá»‘ khÃ¡c
Ä‘Æ°á»£c cÄƒn chá»‰nh vá»›i Báº£ng 12.
Tham lam Speculative Lookahead Ouroboros
l= 64token/s 14.31 20.18 20.20 30.99
tÄƒng tá»‘c 1.00 1.41 1.41 2.17
l= 128token/s 14.57 21.90 22.68 35.32
tÄƒng tá»‘c 1.00 1.50 1.56 2.42
l= 256token/s 14.41 22.12 24.58 38.36
tÄƒng tá»‘c 1.00 1.54 1.71 2.66
l= 512token/s 15.35 21.45 25.14 40.94
tÄƒng tá»‘c 1.00 1.40 1.64 2.67
Báº£ng 15: TÄƒng tá»‘c vá»›i nhiá»u Ä‘á»™ dÃ i táº¡o ra. "l"
Ä‘áº¡i diá»‡n cho giá»›i háº¡n Ä‘á»™ dÃ i táº¡o ra.
Tham lam Speculative Lookahead Ouroboros
l= 64 44.51 44.51 44.51 44.51
l= 128 60.98 60.98 60.98 60.98
l= 256 64.02 64.02 63.41 63.41
l= 512 64.63 64.63 64.02 64.63
Báº£ng 16: Hiá»‡u suáº¥t nhiá»‡m vá»¥ (Ä‘á»™ chÃ­nh xÃ¡c) vá»›i nhiá»u
Ä‘á»™ dÃ i táº¡o ra. "l" Ä‘áº¡i diá»‡n cho giá»›i háº¡n Ä‘á»™ dÃ i táº¡o ra.
Tá»« Báº£ng 15, Ouroboros vÆ°á»£t trá»™i hÆ¡n giáº£i mÃ£
tá»± há»“i quy, Giáº£i mÃ£ Suy Ä‘oÃ¡n, vÃ 
Giáº£i mÃ£ NhÃ¬n trÆ°á»›c dÆ°á»›i cÃ¡c Ä‘á»™ dÃ i khÃ¡c nhau. Trong Báº£ng
16, giá»›i háº¡n Ä‘á»™ dÃ i táº¡o ra ngáº¯n (l= 64,128)
dáº«n Ä‘áº¿n viá»‡c cáº¯t cá»¥t cÃ¢u tráº£ lá»i, dáº«n Ä‘áº¿n
hiá»‡u suáº¥t nhiá»‡m vá»¥ tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ. Hiá»‡u suáº¥t nhiá»‡m vá»¥
gáº§n nhau vÃ  tá»· lá»‡ tÄƒng tá»‘c Ä‘Æ°á»£c Ä‘áº¡t Ä‘Æ°á»£c trong l=
256,512, cho tháº¥y ráº±ng táº¥t cáº£ cÃ¡c thuáº­t toÃ¡n dá»«ng láº¡i
ngay láº­p tá»©c sau khi táº¡o ra "<EOS>".
Hai káº¿t luáº­n cÃ³ thá»ƒ Ä‘Æ°á»£c rÃºt ra. Thá»© nháº¥t, cÃ¡c
giá»›i háº¡n Ä‘á»™ dÃ i Ä‘Æ°á»£c sá»­ dá»¥ng trong thá»±c nghiá»‡m cá»§a chÃºng tÃ´i lÃ  há»£p lÃ½,
vÃ¬ cÃ¡c giá»›i háº¡n Ä‘á»™ dÃ i ngáº¯n hÆ¡n dáº«n Ä‘áº¿n viá»‡c táº¡o ra
Nhiá»‡m vá»¥1Nhiá»‡m vá»¥2Nhiá»‡m vá»¥3Nhiá»‡m vá»¥44444333322221111434343432121212143214321432143214434433322122111CN=1CN=2CN=4xÃ¡o trá»™nThá»© tá»± ÄÃ¡nh giÃ¡HÃ¬nh 7: NghiÃªn cá»©u loáº¡i bá» vá» tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh. Trong
thá»±c nghiá»‡m cá»§a chÃºng tÃ´i, nhiá»‡m vá»¥ 1,2,3,4 tÆ°Æ¡ng á»©ng lÃ  MBPP, GSM8K,
CNN/DM, vÃ  WMT16.
cÃ¢u tráº£ lá»i kÃ©m. Thá»© hai, viá»‡c láº·p láº¡i cá»¥m tá»« trong viá»‡c táº¡o ra
khÃ´ng pháº£i lÃ  lÃ½ do táº¡i sao Ouroboros Ä‘áº¡t Ä‘Æ°á»£c
tÄƒng tá»‘c cao nhÆ° váº­y. Náº¿u váº­y, chÃºng ta sáº½ cÃ³ thá»ƒ quan sÃ¡t
hiá»‡u suáº¥t nhiá»‡m vá»¥ tháº¥p hÆ¡n vÃ  tÄƒng tá»‘c cao hÆ¡n nhiá»u
tá»« l= 256 Ä‘áº¿n l= 512.
F TÃ­nh Äá»‹a phÆ°Æ¡ng Ngá»¯ cáº£nh
ChÃºng tÃ´i tiáº¿p tá»¥c nghiÃªn cá»©u cÃ¡ch tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh tÄƒng tá»‘c
viá»‡c táº¡o ra thÃ´ng qua cÃ¡c giai Ä‘oáº¡n Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng tá»« lá»‹ch sá»­.
TÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh váº«n ráº¥t cao khi liÃªn tá»¥c
táº¡o ra trong má»™t nhiá»‡m vá»¥, nhÆ°ng cÃ³ thá»ƒ thay Ä‘á»•i
qua cÃ¡c bá»™ dá»¯ liá»‡u khÃ¡c nhau. VÃ­ dá»¥, pool cá»¥m tá»«
nÃªn chá»©a cÃ¡c Ä‘oáº¡n mÃ£ khi cháº¡y trÃªn
cÃ¡c bá»™ dá»¯ liá»‡u táº¡o mÃ£ nhÆ° HumanEval vÃ 
MBPP, nhÆ°ng nÃ³ cÃ³ thá»ƒ chá»©a cÃ¡c Ä‘oáº¡n ngÃ´n ngá»¯ tá»± nhiÃªn
khi táº¡o ra vÄƒn báº£n. Váº«n cÃ²n má»™t cÃ¢u há»i ráº±ng
liá»‡u má»™t loáº¡i Ä‘oáº¡n ngÃ´n ngá»¯ cÃ³ thá»ƒ tÄƒng tá»‘c
viá»‡c táº¡o ra loáº¡i ngÃ´n ngá»¯ khÃ¡c hay khÃ´ng. ChÃºng tÃ´i
tiáº¿n hÃ nh cÃ¡c thá»±c nghiá»‡m sau Ä‘á»ƒ Ä‘iá»u tra thÃªm
Ä‘áº¿n má»©c Ä‘á»™ nÃ o vÃ  cÃ¡ch tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh cÃ³ thá»ƒ
tÄƒng tá»‘c viá»‡c táº¡o ra thÃ´ng qua viá»‡c tÃ¡i sá»­ dá»¥ng cá»¥m tá»« tá»«
lá»‹ch sá»­.
ChÃºng tÃ´i chá»n bá»‘n bá»™ dá»¯ liá»‡u: MBPP, GSM8K,
CNN/DM, vÃ  WMT16, tÆ°Æ¡ng á»©ng vá»›i táº¡o mÃ£,
lÃ½ luáº­n sá»‘ há»c, tÃ³m táº¯t tÃ i liá»‡u,
vÃ  dá»‹ch mÃ¡y, vÃ  láº¥y máº«u
20 má»¥c tá»« má»—i bá»™ dá»¯ liá»‡u Ä‘á»ƒ tá»• chá»©c má»™t bá»™ dá»¯ liá»‡u má»›i
chá»©a cÃ¡c lÄ©nh vá»±c khÃ¡c nhau. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡
Ouroboros vá»›i nhiá»u thá»© tá»± Ä‘Ã¡nh giÃ¡, tá»«
Ä‘Ã³ chÃºng tÃ´i cÃ³ thá»ƒ thay Ä‘á»•i tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh. ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a
sá»‘ liÃªn tiáº¿p CN lÃ  bao nhiÃªu má»¥c
tá»« cÃ¹ng má»™t bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c kiá»ƒm tra liÃªn tiáº¿p, nhÆ°
Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 7. Trong cáº¥u hÃ¬nh "xÃ¡o trá»™n",
chÃºng tÃ´i lÃ m ngáº«u nhiÃªn thá»© tá»± cá»§a cÃ¡c má»¥c dá»¯ liá»‡u. CN cao hÆ¡n
chá»‰ ra tÃ­nh Ä‘á»‹a phÆ°Æ¡ng tá»‘t hÆ¡n, vÃ  cáº¥u hÃ¬nh "xÃ¡o trá»™n"
nÃªn cÃ³ tÃ­nh Ä‘á»‹a phÆ°Æ¡ng tá»‡ nháº¥t. Sau Ä‘Ã³ chÃºng tÃ´i
Ä‘o tá»‘c Ä‘á»™ táº¡o ra trong cÃ¡c cáº¥u hÃ¬nh CN khÃ¡c nhau
hoáº·c xÃ¡o trá»™n ngáº«u nhiÃªn.
Báº£ng 17 cho tháº¥y ráº±ng tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh thá»±c sá»± áº£nh hÆ°á»Ÿng
Ä‘áº¿n hiá»‡u quáº£ cá»§a viá»‡c tÃ¡i sá»­ dá»¥ng cá»¥m tá»«. Vá»›i
viá»‡c tÃ¡i sá»­ dá»¥ng cá»¥m tá»«, CN=20 dáº«n Ä‘áº¿n giáº£i mÃ£ nhanh hÆ¡n
CÃ i Ä‘áº·t xÃ¡o trá»™n CN=20 xÃ¡o trá»™n CN=20 CN=10 CN=4 CN = 1
TÃ¡i sá»­ dá»¥ng Cá»¥m tá»« táº¯t táº¯t báº­t báº­t báº­t báº­t báº­t
token/s 32.68 32.53 35.39 36.00 35.32 34.83 35.36
Báº£ng 17: Káº¿t quáº£ cá»§a nghiÃªn cá»©u loáº¡i bá» vá» tÃ­nh Ä‘á»‹a phÆ°Æ¡ng
ngá»¯ cáº£nh. "CN" Ä‘áº¡i diá»‡n cho sá»‘ liÃªn tiáº¿p.
so vá»›i cÃ i Ä‘áº·t xÃ¡o trá»™n. Tuy nhiÃªn, hiá»‡u á»©ng
gÃ¢y ra bá»Ÿi tÃ­nh Ä‘á»‹a phÆ°Æ¡ng ngá»¯ cáº£nh nhá» hÆ¡n so vá»›i viá»‡c
cÃ³ báº­t tÃ¡i sá»­ dá»¥ng cá»¥m tá»« hay khÃ´ng. Tá»‘c Ä‘á»™ cá»§a CN tháº¥p hÆ¡n
tÆ°Æ¡ng tá»± nhÆ° cÃ i Ä‘áº·t xÃ¡o trá»™n khi Ã¡p dá»¥ng
tÃ¡i sá»­ dá»¥ng cá»¥m tá»«, nhÆ°ng cáº£ hai Ä‘á»u nhanh hÆ¡n khoáº£ng
3 token/s so vá»›i cÃ i Ä‘áº·t khá»Ÿi Ä‘á»™ng láº¡nh,
chá»©ng minh ráº±ng pool cá»¥m tá»« váº«n hiá»‡u quáº£
qua nhiá»u nhiá»‡m vá»¥.

--- TRANG 16 ---
