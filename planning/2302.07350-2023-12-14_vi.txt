# Các lược đồ đồ thị như các trừu tượng hóa cho học chuyển giao, suy luận và lập kế hoạch

J. Swaroop Guntupalli1, Rajkumar Vasudeva Raju1, Shrinu Kushagra1, Carter Wendelken1, Danny Sawyer1,
Ishan Deshpande2, Guangyao Zhou1, Miguel Lázaro-Gredilla1và Dileep George1
1Google DeepMind,2Google Research

Việc chuyển giao cấu trúc tiềm ẩn từ một môi trường hoặc vấn đề này sang môi trường khác là một cơ chế mà con người và động vật sử dụng để khái quát hóa với rất ít dữ liệu. Được truyền cảm hứng từ các hiểu biết nhận thức và thần kinh sinh học, chúng tôi đề xuất các lược đồ đồ thị như một cơ chế trừu tượng hóa cho học chuyển giao. Các lược đồ đồ thị bắt đầu với việc học đồ thị tiềm ẩn, nơi các quan sát bị nhầm lẫn về mặt nhận thức được phân biệt trong không gian tiềm ẩn bằng cách sử dụng thông tin ngữ cảnh. Việc học đồ thị tiềm ẩn cũng đang nổi lên như một mô hình tính toán mới của vùng hải mã để giải thích việc học bản đồ và suy luận chuyển tiếp. Hiểu biết của chúng tôi là một đồ thị tiềm ẩn có thể được coi như một mẫu linh hoạt — một lược đồ — mô hình hóa các khái niệm và hành vi, với các vị trí ràng buộc các nhóm nút tiềm ẩn với các quan sát hoặc căn cứ cụ thể. Bằng cách coi các đồ thị tiềm ẩn đã học (lược đồ) như kiến thức tiên nghiệm, các môi trường mới có thể được học nhanh chóng như các tổ hợp của các lược đồ và các ràng buộc mới được học của chúng. Chúng tôi đánh giá các lược đồ đồ thị trên hai nhiệm vụ thử thách đã được công bố trước đây: trò chơi trí nhớ & lập kế hoạch và StreetLearn một lần, được thiết kế để kiểm tra khả năng giải quyết nhiệm vụ nhanh chóng trong các môi trường mới. Các lược đồ đồ thị có thể được học trong ít tập hơn nhiều so với các phương pháp cơ sở trước đây, và có thể mô hình hóa và lập kế hoạch trong vài bước trong các biến thể mới của những nhiệm vụ này. Chúng tôi cũng chứng minh việc học, khớp và tái sử dụng các lược đồ đồ thị trong các môi trường 2D và 3D thử thách hơn với việc nhầm lẫn nhận thức rộng rãi và các biến thể về kích thước, và chỉ ra cách các lược đồ khác nhau có thể được kết hợp để mô hình hóa các môi trường lớn hơn và phức tạp hơn. Tóm lại, đóng góp chính của chúng tôi là một hệ thống thống nhất, được truyền cảm hứng và có cơ sở trong khoa học nhận thức, tạo điều kiện cho việc học chuyển giao nhanh chóng các môi trường mới bằng cách sử dụng các lược đồ thông qua cảm ứng bản đồ và tổ hợp xử lý sự nhầm lẫn nhận thức.

## 1. Giới thiệu

Việc khám phá và sử dụng các trừu tượng hóa phù hợp trong các tình huống mới tạo điều kiện cho việc học chuyển giao hiệu quả cũng như suy luận và lập kế hoạch nhanh chóng. Con người xuất sắc trong khả năng này, được cho là một yếu tố quan trọng đằng sau trí thông minh và là một hạn chế cơ bản trong các hệ thống AI hiện tại (Shanahan và Mitchell, 2022). Các biểu diễn có cấu trúc phổ biến có thể tái sử dụng của các khái niệm hoặc hành vi—các lược đồ—đã được đề xuất như một cách mạnh mẽ để mã hóa các trừu tượng hóa (Mitchell, 2021; Tenenbaum et al., 2011). Việc có một mô hình tính toán với khả năng khám phá và tái sử dụng các lược đồ đã học trước đây để hành xử và lập kế hoạch trong các tình huống mới sẽ là thiết yếu cho AI.

Bằng chứng thực nghiệm cho thấy một số loài động vật có khả năng này (Farzanfar et al., 2023). Chuột cống và chuột nhà có xu hướng học các môi trường mới nhanh hơn nếu chúng có thể tái sử dụng các lược đồ trong quá khứ (Tse et al., 2007; Zhou et al., 2021), và các tế bào vùng hải mã của khỉ macaque mã hóa các lược đồ không gian (Baraduc et al., 2019). Các mạch thần kinh trong vùng hải mã và vỏ não trước trán (PFC) có liên quan đến việc học lược đồ, nhận dạng, cập nhật và duy trì và những quá trình này được coi là nền tảng của việc củng cố trí nhớ (Gilboa và Marlatte, 2017; Preston và Eichenbaum, 2013; Samborska et al., 2022). Các trải nghiệm mới được học trong một lần thử duy nhất nếu nó phù hợp với một lược đồ hiện có. Một lý thuyết hệ thống học tập bổ sung được cập nhật dựa trên bằng chứng này đã được đề xuất trong Kumaran et al. (2016), nhưng cho đến nay chưa có minh chứng rõ ràng nào về việc học nhanh chóng như vậy với việc tái sử dụng lược đồ theo như chúng tôi biết.

Các biểu diễn quan hệ có cấu trúc đã được đề xuất như một cơ chế chung trong vùng hải mã để hòa giải các nhiệm vụ không gian và phi không gian và trí nhớ vào quan điểm bản đồ nhận thức ban đầu (Eichenbaum và Cohen, 2014; Stachenfeld et al., 2017). Một số nghiên cứu gần đây mô hình hóa các bản đồ nhận thức như các cấu trúc đồ thị tiềm ẩn bậc cao và cho thấy sự khái quát hóa đến các chức năng khác nhau có liên quan trong vùng hải mã (George et al., 2021; Raju et al., 2022; Sharma et al., 2021; Whittington et al., 2020, 2021). Chúng tôi lấy một mô hình như vậy của các bản đồ nhận thức, đồ thị nhận thức có cấu trúc nhân bản (CSCG)(George et al., 2021), và mở rộng nó để cung cấp một mô hình tính toán cụ thể của các trừu tượng hóa sử dụng các lược đồ đồ thị. Các tiêu chí mong muốn cho mô hình của chúng tôi là một hệ thống thống nhất tạo điều kiện cho việc học các môi trường mới bằng cách sử dụng các lược đồ, xử lý sự nhầm lẫn nhận thức (Whitehead và Ballard, 1991), và khái quát hóa thông qua cảm ứng bản đồ (Sharma et al., 2021) và tổ hợp lược đồ.

Cài đặt của chúng tôi là một tác nhân điều hướng trong một môi trường được mô hình hóa như một đồ thị có hướng. Tác nhân quan sát các phát xạ tại nút hiện tại của nó và di chuyển đến các nút mới thông qua các cạnh với các hành động được gán nhãn. Nhiều nút có thể phát ra cùng một quan sát (tức là, chúng bị nhầm lẫn (Lajoie et al., 2019; Whitehead và Ballard, 1991)), vì vậy tác nhân không thể quan sát trạng thái một cách trực tiếp. Điều này có thể được coi như một quá trình quyết định Markov quan sát một phần thời gian rời rạc (POMDP). Khi tác nhân điều hướng một môi trường mới, mục tiêu của chúng tôi là học đồ thị tiềm ẩn cơ bản (tức là, cảm ứng bản đồ Sharma et al. (2021)) và làm điều đó một cách nhanh chóng bằng cách tái sử dụng các cấu trúc liên kết đồ thị đã học trước đây hoặc các lược đồ đồ thị. Chúng tôi chọn mô hình CSCG để xây dựng các lược đồ đồ thị vì nó đã được chứng minh là học các đồ thị bậc cao trong các cài đặt có độ nhầm lẫn cao sử dụng một tham số hóa mượt mà, xác suất của bài toán học đồ thị (George et al., 2021). Chúng tôi mở rộng mô hình này để mô tả cách các đồ thị đã học có thể được tái sử dụng như các lược đồ cho học chuyển giao, suy luận nhanh, và lập kế hoạch cho hành vi trong các tình huống mới bằng cách nhanh chóng học các ràng buộc quan sát và khám phá lược đồ tốt nhất trực tuyến.

## 2. Công trình liên quan

Nghiên cứu về việc chuyển giao nhanh chóng đến các nhiệm vụ mới trong các môi trường mới đã tập trung vào các khía cạnh khác nhau, từ khám phá đến mô hình hóa và lập kế hoạch. Một số công trình gần đây chủ yếu được thực hiện trong khung học tăng cường (RL), và các phương pháp RL khác nhau tập trung vào một hoặc nhiều khía cạnh này.

**Meta-RL** Các phương pháp meta-RL không có mô hình tập trung vào việc khái quát hóa chính sách khám phá đến các nhiệm vụ mới và các biến thể môi trường mà không có việc học mô hình rõ ràng. Một số cho thấy sự khái quát hóa đến các nhiệm vụ mới trong một môi trường đã biết, nhưng không đến các môi trường mới và cũng không xử lý sự nhầm lẫn (Rakelly et al., 2019; Wang et al., 2016). RL không có mô hình định kỳ đã cho thấy một số khái quát hóa đến các biến thể môi trường và trong các cài đặt POMDP (Ni et al., 2021). Những biến thể này là của các tham số để tạo ra môi trường, và mục tiêu là có thể học một chính sách khám phá khái quát hóa đến những biến thể tham số này. Những phương pháp này không tái sử dụng kiến thức rõ ràng của các môi trường trong quá khứ để mô hình hóa các môi trường mới và cũng không xử lý việc tổ hợp các môi trường đã biết (Packer et al., 2018). Các công trình gần đây hơn đã thêm bộ nhớ tập đoạn với các đầu chú ý để chọn lọc chú ý và tái sử dụng các ký ức được lưu trữ để nhanh chóng thích ứng với các nhiệm vụ trong các môi trường mới trong các cài đặt ít mẫu (ví dụ mạng lập kế hoạch tập đoạn)(Lampinen et al., 2021; Ritter et al., 2020). Những mô hình này khớp với lập kế hoạch tối ưu chỉ sau khi huấn luyện hàng tỷ bước. Hơn nữa, không có phương pháp nào trong số này xử lý sự nhầm lẫn, cũng không xây dựng rõ ràng các mô hình của môi trường và lập kế hoạch trên chúng. Gupta et al. (2017) cho thấy rằng việc sử dụng xây dựng mô hình rõ ràng (lập bản đồ) và điều hướng thông qua lập kế hoạch trong các môi trường không gian có thể xử lý khả năng quan sát một phần và vượt trội hơn các phương pháp không có khả năng này, nhưng nghiên cứu này không tái sử dụng những mô hình đó để nhanh chóng học các môi trường mới.

**Model based RL** Các công trình RL dựa trên mô hình học một mô hình rõ ràng của môi trường (Gregor et al., 2019), một số thậm chí dưới cài đặt POMDP (Igl et al., 2018), và có thể chuyển giao đến các nhiệm vụ mới trong môi trường đó, nhưng không thể chuyển giao đến các môi trường mới. Một số nghiên cứu sử dụng một phiên bản của khám phá và tái sử dụng mục tiêu phụ hoặc điểm mốc để khái quát hóa đến các nhiệm vụ mới (Eysenbach et al., 2019; Kipf et al., 2019; Zhang et al., 2021). Tuy nhiên, những phương pháp này không giải quyết khả năng quan sát một phần, và quan trọng hơn là sự khái quát hóa bị hạn chế trong cùng các môi trường. Bộ nhớ cấu trúc liên kết bán tham số là một phương pháp mở rộng điều hướng dựa trên điểm mốc để khái quát hóa đến các môi trường mới (Savinov et al., 2018). Phương pháp này huấn luyện một mạng để ước tính khả năng kết nối giữa các quan sát tại các vị trí khác nhau và sử dụng điều này để xây dựng một đồ thị các quan sát trong một môi trường mới. Phương pháp này có khái quát hóa đến các môi trường mới, nhưng hiệu suất của nó giảm đáng kể với sự gia tăng nhầm lẫn. Hơn nữa, một đường dẫn khám phá do con người tạo ra được sử dụng để xây dựng đồ thị.

Công trình của chúng tôi về khớp lược đồ và tái sử dụng có liên quan đến việc tìm tương ứng giữa các đồ thị trong các ngữ cảnh khác nhau. Phương pháp mạng thần kinh đầu tiên cho ánh xạ cấu trúc được đề xuất trong Crouse et al. (2021). Nhưng phương pháp này bị hạn chế trong bài toán khớp và không có cơ chế để giải quyết hoặc học các cấu trúc mới hoặc lập kế hoạch với các lược đồ khớp một phần. Một hướng công trình liên quan khác tập trung vào việc giải quyết các nhiệm vụ quan hệ đơn giản hóa được truyền cảm hứng từ Ma trận Tiến bộ của Raven (Kerg et al., 2022; Webb et al., 2021). Ý tưởng chính là tách các quan hệ trừu tượng khỏi các quan sát cảm giác trong quá trình huấn luyện, và học ánh xạ quan sát để giải quyết các nhiệm vụ mới với cùng các quan hệ nhưng ánh xạ mới, nhưng trong một cài đặt xác định và đơn giản hóa.

Đóng góp chính của bài báo này là một hệ thống thống nhất mà (i) tạo điều kiện cho việc học chuyển giao nhanh chóng các môi trường mới sử dụng các lược đồ thông qua cảm ứng bản đồ và tổ hợp, (ii) xử lý sự nhầm lẫn nhận thức, (iii) xây dựng các mô hình đồ thị tiềm ẩn rõ ràng của các môi trường trực tiếp từ các hành động và quan sát, (iv) hỗ trợ lập kế hoạch và suy luận, và (v) được truyền cảm hứng và có cơ sở trong khoa học nhận thức và thần kinh. Của chúng tôi là mô hình đầu tiên kết hợp tất cả những khía cạnh này trong một hệ thống duy nhất.

## 3. Phương pháp

### 3.1. Thiết lập bài toán

Xem xét một tác nhân điều hướng trong một đồ thị có hướng 𝐺. Khi tác nhân ghé thăm một nút trong đồ thị, nút đó phát ra một quan sát. Tuy nhiên, nhiều nút có thể phát ra cùng một quan sát (tức là, chúng bị nhầm lẫn), vì vậy quan sát không đủ để phân biệt tác nhân đang ở đâu trong đồ thị. Ngoài ra, các hành động không có kết quả xác định—thực hiện cùng một hành động tại cùng một nút có thể dẫn đến tác nhân điều hướng đến các nút khác nhau. Các cạnh đi ra từ một nút được gán nhãn với hành động sẽ duyệt chúng, và với xác suất duyệt chúng dưới hành động đó. Tổng các xác suất của tất cả các cạnh đi ra từ một nút với cùng nhãn hành động tổng bằng 1. Chúng tôi sử dụng đồ thị 𝐺 để mô hình hóa môi trường của tác nhân.

Khi tác nhân thực hiện một chuỗi hành động 𝑎1,...,𝑎𝑁 (với 𝑎𝑛 rời rạc ∈{1,...𝑁actions}), nó nhận được một chuỗi quan sát 𝑥1,...,𝑥𝑁 (với mỗi 𝑥𝑛∈ℝ𝑑 hoặc {1,...,𝑁obs} cho các quan sát liên tục và rời rạc, tương ứng). Mục tiêu của việc học là khôi phục cấu trúc liên kết của môi trường 𝐺 từ các chuỗi hành động và quan sát. Mục tiêu của việc chuyển giao là tái sử dụng cấu trúc liên kết của một đồ thị đã học trước đây để mô hình hóa một môi trường mới bằng cách gán nhãn lại các nút với các quan sát mới. Trong cả hai trường hợp, các đồ thị đã học có thể được khai thác cho các nhiệm vụ như điều hướng có mục tiêu.

### 3.2. Mô hình

Các đồ thị nhận thức có cấu trúc nhân bản (CSCG) được giới thiệu trong Dedieu et al. (2019); George et al. (2021) để khôi phục (một xấp xí của) đồ thị 𝐺 từ các chuỗi cặp hành động-quan sát. Để làm điều này, họ sử dụng các biến ẩn phân loại 𝑧1,...,𝑧𝑁 để mô hình hóa nút của đồ thị mà tác nhân đang ở trong mỗi bước thời gian. Với điều này, có thể công thức hóa một mô hình đồ thị cho chuỗi quan sát được cho các hành động. Ở đây, chúng tôi sử dụng phiên bản có điều kiện của mô hình của họ và mở rộng nó đến các quan sát liên tục:

𝑝(𝒙|𝒂)=∑︁𝒛∑︁𝒚𝑃(𝑧1)∏︁𝑛=2𝑁𝑃(𝑧𝑛|𝑧𝑛−1,𝑎𝑛−1)∏︁𝑛=1𝑁𝑃(𝑦𝑛|𝑧𝑛)𝑝(𝑥𝑛|𝑦𝑛), (1)

với 𝑝(𝑥𝑛|𝑦𝑛)=N(𝑥𝑛|𝜇𝑦𝑛,𝜎2𝐼). Chúng tôi sử dụng ký hiệu tắt sau cho một chuỗi hành động: 𝒂≡{𝑎1...,𝑎𝑁} (𝒙,𝒚,𝒛 được định nghĩa tương tự). Các chuyển tiếp được tham số hóa hoàn toàn thông qua một tensor chuyển tiếp có điều kiện hành động 𝑇 với các phần tử 𝑇𝑖𝑗𝑘=𝑃(𝑧𝑛=𝑘|𝑧𝑛−1=𝑗,𝑎𝑛−1=𝑖).

Để mở rộng CSCG đến các quan sát liên tục, chúng tôi đã giới thiệu một biến mới 𝑦𝑛 giữa trạng thái ẩn 𝑧𝑛 và quan sát 𝑥𝑛. Trong công thức này, mô hình quan sát được tham số hóa như một Gaussian đẳng hướng với phương sai 𝜎2 và trung bình 𝜇𝑦𝑛, là trọng tâm được liên kết với một phát xạ rời rạc 𝑦𝑛. Mô hình phát xạ được tham số hóa bởi một ma trận phát xạ 𝐸 với các phần tử 𝐸𝑖𝑗=𝑃(𝑦𝑛=𝑗|𝑧𝑛=𝑖). Trong một CSCG, theo thiết kế, nhiều trạng thái ẩn bị buộc phải chia sẻ cùng một phát xạ: nếu các trạng thái 𝑖 và 𝑗 là các bản sao của cùng một phát xạ, thì 𝑝(𝑦|𝑧𝑖)=𝑝(𝑦|𝑧𝑗). Ngoài ra, các phát xạ là xác định: mỗi hàng trong 𝐸 có một mục duy nhất được đặt thành 1, với các phần tử còn lại được đặt thành không. Các hàng được nhân bản (tương ứng với cùng một phát xạ) sẽ giống hệt nhau. Ý tưởng là các trạng thái tiềm ẩn khác nhau có thể tạo ra các quan sát có thể nhìn thấy tương tự, và trạng thái tiềm ẩn chỉ có thể được phân biệt thông qua ngữ cảnh thời gian. Chúng tôi định nghĩa 𝐶(𝑥𝑛) như tập hợp các bản sao của phát xạ 𝑥𝑛.

Trong một trường hợp đơn giản, nếu chúng ta có một số lượng hữu hạn các quan sát tiềm năng, chúng ta có thể phân bổ một trọng tâm cho mỗi quan sát và đặt 𝜎2→0. Khi các quan sát là rời rạc, mô hình quan sát trở thành xác định và chúng ta có thể đặt 𝑦=𝑥. Điều này khôi phục chính xác CSCG rời rạc từ George et al. (2021).

Để học CSCG rời rạc, cấu trúc nhân bản được quyết định trước bằng cách chọn bao nhiêu bản sao để gán cho mỗi quan sát (ví dụ, một số không đổi). Điều này định nghĩa hoàn toàn 𝐸. Sau đó, việc học một đồ thị 𝐺 mô tả một môi trường mới chỉ liên quan đến việc học 𝑇, tức là tối đa hóa 𝑃(𝒙|𝒂;𝑇,𝐸) đối với 𝑇. Điều này có thể được thực hiện thông qua kỳ vọng-tối đa hóa (EM), xem Phụ lục §A.1. Quy trình tương tự như việc học HMM, nhưng hiệu quả tính toán hơn bằng cách tận dụng mẫu thưa thớt của ma trận phát xạ.

Đối với các quan sát liên tục, xem Phụ lục §A.3 để mô tả cách học các trọng tâm 𝜇𝑦 và phân bổ các trạng thái ẩn cho chúng (tức là, gán cấu trúc nhân bản).

### 3.3. Lược đồ cho học chuyển giao

Chúng tôi gọi một mô hình đã học với bộ ba cố định 𝑆𝑔≡{𝑇,𝐶,𝐸} là một lược đồ có căn cứ. Việc học chuyển giao giữa các môi trường khác nhau chia sẻ cùng cấu trúc liên kết đồ thị nhưng với các phát xạ khác nhau được liên kết với các nút của nó là có thể bằng cách tái sử dụng các chuyển tiếp đã học trước đây 𝑇. Chúng ta có thể tối đa hóa 𝑝(𝒙|𝒂;𝑇,𝝁) đối với 𝝁 (hoặc 𝑝(𝒙|𝒂;𝑇,𝐸) đối với 𝐸 trong trường hợp rời rạc), trong khi giữ 𝑇 cố định ở giá trị đã biết từ môi trường trước đây (xem Phụ lục §A.2 và §A.4 cho các quan sát rời rạc và liên tục tương ứng). Chúng tôi gọi 𝑇 này mà không có cấu trúc nhân bản liên kết 𝐶 và ma trận phát xạ 𝐸 là một lược đồ không có căn cứ hoặc đơn giản là một lược đồ.

Hơn nữa, nếu chúng ta biết rằng môi trường mới cũng bảo tồn cấu trúc nhân bản 𝐶 (khi hai nút là bản sao trong môi trường ban đầu, chúng cũng là bản sao trong môi trường mới), thì chúng ta có thể hạn chế thêm mô hình quan sát để tôn trọng ràng buộc này trong quá trình học và tái sử dụng bộ 𝑆𝑢≡{𝑇,𝐶} và học 𝝁 hoặc 𝐸. Chúng tôi gọi bộ này 𝑆𝑢 là một lược đồ không có căn cứ với cấu trúc nhân bản (Hình 1E).

Ví dụ, trong cài đặt điều hướng phòng, một lược đồ mô hình hóa vị trí và hướng đầu của tác nhân trong một phòng và cách các hành động di chuyển tác nhân, cũng như kiến thức rằng sàn hoặc cửa có thể trông giống nhau tại nhiều vị trí trong phòng. Sử dụng EM, chúng tôi chỉ ra cách các lược đồ cho phép học mô hình nhanh chóng trong các môi trường mới có cấu trúc liên kết và cấu trúc phát xạ khớp với ràng buộc nhanh (Hình 1F). Suy luận có thể được thực hiện với các lược đồ khớp để chủ động lập kế hoạch và theo đuổi mục tiêu. Chúng ta cũng có thể phát hiện chuyển tiếp sang một lược đồ đã biết khác, hoặc đến vùng đất chưa biết bằng cách so sánh khả năng của các quan sát dưới các lược đồ khác nhau.

Các lược đồ cũng có thể được sử dụng như các khối xây dựng để nhanh chóng học các môi trường mới được tạo thành từ các cấu trúc liên kết khớp. Điều này bao gồm việc học các chuyển tiếp và phát xạ nhưng tái sử dụng các lược đồ đã biết nơi chúng phù hợp (Xem Phụ lục §B.5 và Phụ lục Thuật toán 2).

## 4. Kết quả

Chúng tôi chỉ ra kết quả từ hai bộ thí nghiệm: (i) các chuẩn mực tiêu chuẩn để đánh giá thích ứng nhanh, nơi các môi trường không có sự nhầm lẫn nhận thức, và (ii) cài đặt thử thách hơn của các môi trường với sự nhầm lẫn nhận thức rộng rãi.

### 4.1. Thích ứng nhanh và giải quyết nhiệm vụ trong các môi trường mới

Chúng tôi đầu tiên đánh giá mô hình của chúng tôi trên hai chuẩn mực được đề xuất bởi Ritter et al. (2020) để đánh giá thích ứng nhanh và giải quyết nhiệm vụ trong các môi trường mới: Trò chơi Trí nhớ & Lập kế hoạch (MPG) và StreetLearn Một lần.

#### 4.1.1. Trò chơi Trí nhớ & Lập kế hoạch

Trong MPG, tác nhân có thể điều hướng trên một lưới 4×4, quan sát các ký hiệu, và nhiệm vụ là thu thập phần thưởng tại một vị trí mục tiêu được chỉ định trong lưới đó (Hình 2A). Tất cả các vị trí lưới có các ký hiệu duy nhất và ánh xạ ký hiệu-vị trí được ngẫu nhiên hóa sau mỗi tập, kéo dài 100 bước. Xem Phụ lục §B.1 để biết chi tiết. Cài đặt này cho phép chúng tôi đánh giá mô hình của chúng tôi về khôi phục đồ thị sự thật và tái sử dụng lược đồ, vì cấu trúc được duy trì qua các tập. Tác nhân cần khám phá để thu thập các quan sát và ràng buộc chúng nhanh chóng với lược đồ để tối đa hóa phần thưởng với điều hướng tối ưu.

**Lược đồ CSCG học cấu trúc đồ thị trong vài tập.** Tác nhân lược đồ CSCG đầu tiên khám phá lưới ngẫu nhiên thu thập các quan sát trong vài tập. Sau mỗi tập, chúng tôi học một mô hình CSCG giải thích tốt nhất các trải nghiệm qua tất cả các tập đã quan sát cho đến nay. Chúng tôi tái sử dụng cùng một lược đồ (𝑇) qua tất cả các tập và học một ràng buộc mới (ma trận phát xạ 𝐸) cho mỗi tập. Chỉ mất 9 tập (900 bước) để học một lược đồ hoàn hảo của môi trường lưới 4×4 này. Trong các tập tiếp theo, chúng tôi nhanh chóng học các ràng buộc lược đồ và lập kế hoạch để tối đa hóa phần thưởng. Chúng tôi sử dụng hai chính sách khám phá được mã hóa cứng khác nhau: hành động điều hướng ngẫu nhiên và một tập hợp hành động tối ưu để bao phủ đồ thị chuyển tiếp đã học. Phần thưởng trung bình mỗi tập ± sai số chuẩn của trung bình (SEM) sau khi học lược đồ là: 17.3±0.57 cho ngẫu nhiên và 26.4±0.17 cho chính sách khám phá tối ưu, có thể so sánh với Mạng lập kế hoạch tập đoạn (EPN) (Ritter et al., 2020). Ngược lại, EPN mất hơn 10 triệu tập (>10^9 bước) huấn luyện để đạt hiệu suất tối ưu của nó (Hình 2B). Lập kế hoạch trong mô hình của chúng tôi là tối ưu về số bước đến phần thưởng, ngang bằng với EPN và oracle (Hình 2C). Hiệu suất CSCG vẫn giữ nguyên kể từ khi phần thưởng đầu tiên được thu thập sau khám phá và các kế hoạch là tối ưu sau đó. Lưu ý rằng số bước để hoàn thành nhiệm vụ đầu tiên dài hơn trong trường hợp của chúng tôi (18±0.09 bước) so với EPN, nhưng phần thưởng trung bình trong một tập là có thể so sánh.

#### 4.1.2. StreetLearn Một lần

StreetLearn Một lần là một biến thể thử thách của nhiệm vụ StreetLearn (Mirowski et al., 2019) với cấu trúc kết nối thay đổi qua các tập để đánh giá khả năng giải quyết nhiệm vụ nhanh chóng (Hình 2D). Trong mỗi tập, tác nhân được đặt trong một khu phố mới của một thành phố và nhiệm vụ là điều hướng đến một mục tiêu, được chỉ định bởi hình ảnh đường phố mục tiêu, và thu thập phần thưởng. Sau khi thu thập một phần thưởng, tác nhân được tái sinh tại một vị trí mới và một mục tiêu mới được chỉ định. Không giống như MPG, đồ thị chuyển tiếp thay đổi mỗi tập. Chúng tôi đánh giá khả năng của mô hình chúng tôi để học nhanh chóng trong một tập và điều hướng tối ưu đến các mục tiêu để tối đa hóa phần thưởng. Lưu ý rằng không có tái sử dụng lược đồ trong cài đặt này: chúng tôi học một mô hình mới cho mỗi tập. Điều này thể hiện khả năng học nhanh chóng trong vài bước mà không có bất kỳ huấn luyện trước nào và lập kế hoạch hiệu quả với mô hình đã học.

**CSCG khớp với lập kế hoạch tối ưu trong StreetLearn Một lần.** Đối với tác nhân CSCG, chúng tôi theo một chiến lược khám phá và khai thác với một chính sách khám phá được mã hóa cứng. Trong quá trình khám phá, tác nhân điều hướng mọi hành động từ mọi quan sát mà nó gặp phải trong khi thu thập phần thưởng khi nó gặp các mục tiêu, và sử dụng kinh nghiệm này để học một CSCG. Đây là một khám phá có hướng dẫn để bao phủ mọi cạnh có thể trong đồ thị chuyển tiếp. Sau khám phá, tác nhân lập kế hoạch với CSCG và thu thập phần thưởng (Xem Phụ lục §B.2 để biết chi tiết). Phần thưởng trung bình ± SEM trên 100 tập là 21.7±3.7, thấp hơn EPN (28.7) vì chiến lược khám phá của chúng tôi không tối ưu (Hình 2E). Vì chúng tôi không xem xét khám phá tối ưu trong công trình này, chúng tôi so sánh hiệu suất lập kế hoạch trên mô hình đã học sau khám phá. Sau khám phá, tác nhân của chúng tôi mất trung bình 4.8±0.03 bước để đạt mục tiêu, khớp với giá trị tối ưu (Ritter et al., 2020) (Hình 2F). Lưu ý rằng chúng tôi không chuyển giao bất kỳ việc học nào qua các tập trong cài đặt này vì đồ thị thay đổi mỗi tập. Trong các thành phố với cấu trúc đồ thị có thể tái sử dụng như bố cục lưới ở Manhattan, các lược đồ CSCG có lợi từ việc tái sử dụng. Chúng tôi đánh giá việc tái sử dụng lược đồ này một cách chi tiết trong các cài đặt khó hơn nhiều trong các thí nghiệm tiếp theo về điều hướng trong các phòng với các quan sát nhầm lẫn rộng rãi.

### 4.2. Khớp lược đồ và học chuyển giao trong các môi trường có độ nhầm lẫn cao

Trong bộ thí nghiệm tiếp theo, chúng tôi đánh giá khớp lược đồ và học chuyển giao trong các môi trường mới thay đổi về quan sát và trong một số trường hợp kích thước từ các môi trường huấn luyện. Đối với những thí nghiệm này, chúng tôi sử dụng một cài đặt thử thách hơn so với các chuẩn mực ở trên, với các môi trường mô phỏng 2D và 3D lớn hơn và sự nhầm lẫn rộng rãi (Beattie et al., 2016). Lưu ý rằng mặc dù chúng tôi sử dụng điều hướng không gian như cài đặt của chúng tôi, chúng tôi không sử dụng bất kỳ giả định nào về không gian (Euclide hoặc khác) và mô hình hóa nó như một bài toán điều hướng đồ thị. Đối với cả môi trường 2D và 3D, chúng tôi sử dụng một mô hình đơn giản của các quan sát của tác nhân không dựa vào nhận thức 3D, vì vậy kết quả của chúng tôi không phụ thuộc vào cài đặt không gian 3D cụ thể.

Chúng tôi bắt đầu với một tập hợp các môi trường có hình dạng và cấu trúc liên kết khác nhau với sự nhầm lẫn rộng rãi. Tương tự như một đấu trường rộng lớn trống, các quan sát ở nội thất của những môi trường này bị nhầm lẫn về mặt nhận thức Lajoie et al. (2019); Whitehead và Ballard (1991), xem Hình 1D. Sự nhầm lẫn xảy ra do xây dựng trong trường hợp 2D, và như kết quả của việc phân cụm trong trường hợp 3D. Chúng tôi đầu tiên học các lược đồ trong các phòng huấn luyện (Hình 1D), như được mô tả trong phần 3.3. Chúng tôi đánh giá khớp lược đồ trên các phòng thử nghiệm với bố cục tương tự nhưng với các quan sát mới và biến thể kích thước. Trong một phòng thử nghiệm mới, tác nhân thực hiện một bước đi ngẫu nhiên và đánh giá khả năng của các chuỗi quan sát được cho các hành động được thực hiện dưới các lược đồ đã học khác nhau (Hình 1E). Lưu ý rằng điều này đòi hỏi đầu tiên học ma trận phát xạ mới từ dữ liệu thu thập trong bước đi ngẫu nhiên này và tính toán khả năng cho mỗi lược đồ. Lược đồ với khả năng tốt nhất được coi là lược đồ khớp. Chúng tôi đánh giá khả năng của các lược đồ khác nhau tại nhiều khoảng thời gian trong các bước đi ngẫu nhiên. Xem Phụ lục §B.3 để biết chi tiết và tham số được sử dụng trong các thí nghiệm sau.

**Các lược đồ CSCG nhanh chóng học các ràng buộc khớp trong các môi trường mới.** Để chứng minh điều này, chúng tôi đã sử dụng các môi trường 3D (Beattie et al., 2016) với 6 bố cục khác nhau. Tác nhân có thể điều hướng với 3 hành động tâm điểm rời rạc (di chuyển về phía trước, quay trái, quay phải) và các quan sát là hình ảnh RGB tương ứng với góc nhìn của tác nhân (Hình 1A, B). Không gian quan sát trong cài đặt này lớn và phức tạp và chứng minh khả năng áp dụng của mô hình cho những trường hợp sử dụng như vậy. Chúng tôi theo quy trình cho các quan sát liên tục được mô tả trong §3.2 và Phụ lục §A.3 để học các mô hình của các môi trường huấn luyện (xem Hình S1 cho các đồ thị đã học sau huấn luyện sử dụng các bước đi ngẫu nhiên). Chúng tôi đánh giá việc học nhanh chóng trên các môi trường thử nghiệm với cùng bố cục nhưng với các bức tường màu khác nhau, sàn, và ánh sáng môi trường, tương ứng với các quan sát RGB hoàn toàn mới, cho một tác nhân điều hướng trong những phòng đó sử dụng quy trình được mô tả trong Phụ lục §A.4. Hình 3A cho thấy việc khớp nhanh chóng thành công của các lược đồ đúng trong các phòng thử nghiệm được đánh giá bởi khả năng logarit âm (Xem Phụ lục Hình S2 để biết kết quả đầy đủ). Lược đồ đúng được xác định cho tất cả sáu môi trường thử nghiệm, thường trong vòng 1.000 bước trong môi trường và trong tất cả các trường hợp trong vòng 2.000 bước, so với khoảng 50.000 bước được sử dụng để học mà không có tái sử dụng lược đồ.

Để kiểm tra việc chuyển giao đến các biến thể kích thước, chúng tôi đã sử dụng các phòng 2D của năm bố cục khác nhau (hình trụ, hình chữ nhật, hình vuông có lỗ, hình xuyến, và hình chữ U) mỗi cái trong 3 kích thước khác nhau (nhỏ, trung bình, lớn) (Hình S3). Chúng tôi học các lược đồ cho các phiên bản kích thước trung bình của những phòng này sử dụng một bước đi ngẫu nhiên 50.000 bước. Trong các phòng thử nghiệm với các ánh xạ quan sát mới, tác nhân thực hiện một bước đi ngẫu nhiên trong khi chúng tôi học các phát xạ mới và đánh giá khả năng của những quan sát này dưới tất cả các lược đồ mỗi 5 bước. Xem Phụ lục B.3.2 để biết chi tiết. Hình S3 cho thấy khả năng logarit âm của tất cả phòng thử nghiệm dưới tất cả các lược đồ. Bằng cách tái sử dụng cấu trúc nhân bản, chúng tôi có thể khớp đúng lược đồ trong tất cả các trường hợp bằng 95 bước chứng minh việc khớp và thích ứng nhanh chóng với các môi trường mới với các biến thể kích thước và quan sát (Phụ lục Hình S4 cho thấy kết quả mà không sử dụng cấu trúc nhân bản). Chúng tôi tái tạo những kết quả này sử dụng mười mẫu chữ số của bộ dữ liệu MNIST nhị phân như bố cục phòng của chúng tôi vì chúng cung cấp một sự đa dạng thú vị của các hình dạng và cấu trúc liên kết không được thiết kế bởi chúng tôi (xem Phụ lục §B.3.3 để biết kết quả).

Khớp lược đồ cũng hoạt động trong các môi trường được tạo thành từ nhiều lược đồ. Chúng tôi chứng minh điều này trong các môi trường thử nghiệm mới được tạo thành từ các cặp phòng chữ số MNIST, và cho thấy khớp lược đồ trực tuyến của từng chữ số. Xem Phụ lục §B.5 để biết chi tiết và kết quả.

### 4.3. Học nhanh chóng các môi trường mới với tính tổ hợp của các lược đồ đồ thị

Các lược đồ cũng có thể được sử dụng để học và điều hướng hiệu quả trong các môi trường lớn hơn được tạo thành từ các lược đồ đã biết. Chúng tôi làm điều này bằng cách khớp các lược đồ và học cấu trúc chuyển tiếp giữa chúng. Hình 3B cho thấy một ví dụ môi trường mô phỏng 3D, được tạo thành từ bốn phòng 3D nhỏ hơn. Tác nhân bước đi trong môi trường này và học mô hình tổ hợp (cả chuyển tiếp kết hợp và phát xạ) trong ít bước hơn nhiều so với cần thiết để học mà không sử dụng lược đồ. Hình 3B cũng cho thấy mô hình tiên nghiệm với tất cả kết nối tiềm năng và mô hình đã học tại hai chiều dài bước đi khác nhau. Chất lượng mô hình được đo bằng khả năng logarit âm trên các bước đi thử nghiệm 10.000 bước, cho các mô hình được huấn luyện sau các bước đi có chiều dài khác nhau có và không sử dụng lược đồ. Sử dụng lược đồ, chúng tôi có thể học một mô hình hoàn hảo của môi trường trong ít hơn 10.000 bước, trong khi học từ đầu tệ hơn đáng kể ngay cả sau 30.000 bước. Xem Phụ lục §B.5 để biết thuật toán học và chi tiết thí nghiệm. Khả năng học bằng cách tổ hợp và tái sử dụng các lược đồ đã học trước đây này cho phép thích ứng nhanh chóng với các môi trường mới chỉ trở nên tốt hơn với nhiều kinh nghiệm hơn.

### 4.4. Lập kế hoạch và điều hướng nhanh chóng trong các môi trường mới

Khớp lược đồ nhanh chóng và ràng buộc cho phép lập kế hoạch trong các môi trường mới với kinh nghiệm hạn chế. Chúng tôi đầu tiên chứng minh khả năng này trong một biến thể mới của môi trường 3D bốn phòng được giới thiệu trong Hình 4A. Trong minh chứng này, một tác nhân đầu tiên bước đi trong môi trường thử nghiệm, và sau đó được giao nhiệm vụ tìm tuyến đường ngắn nhất trở về vị trí khởi đầu của nó. Chúng tôi đã sử dụng một bước đi ban đầu được chỉ định thủ công để bao phủ một phần tốt của môi trường trong số bước tối thiểu. Trong trường hợp này, lược đồ – lược đồ tổ hợp đã được học trước đây cho sự kết hợp bốn phòng (Hình 3) – được biết trước. Tác nhân sử dụng các quan sát từ bước đi ban đầu để học các ràng buộc phát xạ mới và giải mã vị trí hiện tại và mục tiêu của nó trong mô hình. Tác nhân sau đó lập kế hoạch đường dẫn ngắn nhất đến mục tiêu sử dụng mô hình này (Hình 4B). Lưu ý rằng tuyến đường được lập kế hoạch đi qua một phần chưa được ghé thăm của môi trường.

Trong khi thực hiện một kế hoạch, nếu tác nhân ước tính rằng nó chưa đạt được mục tiêu sau khi tính đến các quan sát mới, có thể có một sự không khớp lược đồ hoặc ma trận phát xạ ước tính không chính xác. Khi điều này xảy ra, tác nhân có thể khởi tạo lập kế hoạch lại sau khi cập nhật mô hình sử dụng các kinh nghiệm mới thu được trong khi thực hiện kế hoạch. Quá trình này được lặp lại cho đến khi tác nhân tin rằng nó đã đạt được mục tiêu của mình sau khi giải mã các quan sát từ bước đi ngẫu nhiên ban đầu và tất cả các bước lập kế hoạch lại tiếp theo. Trong một thí nghiệm được thiết kế để kiểm tra khả năng này, chúng tôi đánh giá một cách có hệ thống tính mạnh mẽ này đối với sự không khớp lược đồ trong các môi trường 2D về khoảng cách Manhattan từ vị trí mục tiêu, và số lần lập kế hoạch lại cần thiết. Hình 4B cho thấy kết quả cho một lược đồ ví dụ. Chúng tôi có thể điều hướng thành công ngay cả với các biến thể kích thước và cấu trúc và hiệu suất giảm một cách duyên dáng khi sự biến thể giữa lược đồ và phòng thử nghiệm tăng lên. Số lần cố gắng lập kế hoạch cần thiết để đạt mục tiêu cũng tăng lên một cách mượt mà. Số hạng làm mượt đường chéo thêm xác suất chuyển tiếp tự (xem Phụ lục §B.6) là quan trọng để khái quát hóa đến các biến thể kích thước. Không có việc làm mượt này, tác nhân không bao giờ đạt được mục tiêu trong các biến thể kích thước lớn hơn của các phòng thử nghiệm như được chỉ ra trong Hình 4B (Xem Phụ lục §B.6 để biết kết quả trong một bố cục phòng khác).

## 5. Thảo luận và Công việc Tương lai

Việc học các trừu tượng hóa có thể nhanh chóng ràng buộc với các quan sát từ các môi trường chia sẻ cùng cấu trúc cơ bản là cơ chế được giả thuyết cho học chuyển giao ở con người và động vật (Kumaran et al., 2016; Tse et al., 2007; Zhou et al., 2021). Chúng tôi đã đề xuất một mô hình tính toán cụ thể của các trừu tượng hóa và ràng buộc nhanh chóng sử dụng các lược đồ đồ thị học các cấu trúc bậc cao từ các chuỗi quan sát nhầm lẫn, và sử dụng một cơ chế ràng buộc vị trí để chuyển giao những lược đồ đó để nhanh chóng học các mô hình của các môi trường mới. Các lược đồ CSCG đã học cấu trúc đồ thị trong ít tập hơn nhiều so với một tác nhân RL sâu và khớp với lập kế hoạch tối ưu trong các nhiệm vụ MPG và StreetLearn Một lần. Trong các môi trường có độ nhầm lẫn cao, các lược đồ CSCG đã tìm thấy các ràng buộc lược đồ khớp trong các phòng mới có kích thước khác nhau. Trong các phòng tổ hợp, chúng tôi có thể khớp các lược đồ đúng khi tác nhân di chuyển qua các phòng tương ứng với các lược đồ khác nhau. Chúng tôi đã chỉ ra lập kế hoạch thành công đến các mục tiêu trong các phòng có biến thể hình dạng và kích thước từ lược đồ khớp bằng cách lập kế hoạch lại và cập nhật mô hình trong khi bước đi đến mục tiêu. Quan trọng hơn, các lược đồ đã biết có thể được tổ hợp để nhanh chóng học các môi trường mới và các lược đồ lớn hơn mới. Khả năng này tự khởi động và chỉ trở nên tốt hơn với nhiều kinh nghiệm hơn. Có nhiều hướng rõ ràng cho các công việc tương lai tiềm năng để xây dựng trên công việc hiện tại của chúng tôi, và chúng tôi liệt kê một số trong số chúng dưới đây.

**Học lược đồ từ kinh nghiệm.** Chúng tôi đã học các lược đồ một cách độc lập và rõ ràng trong công việc này, nhưng trong thế giới thực, có thể không khả thi để có quyền truy cập vào các kinh nghiệm được phân biệt thuộc về các lược đồ riêng biệt. Việc học các lược đồ có thể tái sử dụng từ một dòng kinh nghiệm liên tục (Farzanfar et al., 2023) có thể là một công việc tương lai thú vị.

**Lược đồ so với ký ức.** Chúng tôi loại bỏ các phát xạ đã học trước đây từ các kinh nghiệm trong quá khứ và học một ràng buộc mới. Tuy nhiên, trong một số trường hợp, các phát xạ đã học trước đây có thể áp dụng trực tiếp và do đó việc giữ chúng thêm vào có thể cho phép thích ứng zero-shot thậm chí nhanh hơn khi có một khớp. Điều này có thể được coi như giữ các ký ức cụ thể so với sử dụng các lược đồ trừu tượng.

**Bảo trì lược đồ.** Các lược đồ của chúng tôi trong công việc này là cố định. Tuy nhiên, có thể cập nhật các lược đồ với các kinh nghiệm mới. Thực tế, trẻ em ban đầu có xu hướng nhận thức và ghi nhớ các kinh nghiệm phù hợp với các lược đồ hiện có của chúng và phát triển tính linh hoạt sau này (Piaget và Cook, 1952). Tương tự, chúng ta có thể cập nhật các lược đồ dựa trên các kinh nghiệm mới, và thậm chí làm cho chính các lược đồ linh hoạt để bao gồm các trừu tượng hóa liên quan nhưng vẫn bị ràng buộc bởi các quy tắc để cho phép suy luận nhất quán.

**Khám phá chủ động.** Chúng tôi đã sử dụng các chính sách khám phá ngẫu nhiên hoặc tối ưu đã biết để học và ràng buộc các lược đồ. Nhưng các lược đồ cung cấp niềm tin có điều kiện hành động về các quan sát tương lai, và bằng cách chọn các hành động có thể phân biệt tối ưu các lược đồ khác nhau và tìm cách học các kết nối giữa chúng, chúng ta có thể làm tốt hơn nhiều so với khám phá ngẫu nhiên. Tương tự, thay vì khám phá ngẫu nhiên để học một môi trường và lược đồ mới, chúng ta có thể hướng dẫn chính sách khám phá bằng cách tổ hợp các lược đồ đã biết (Sharma et al., 2021), và thậm chí chủ động học chúng trong khi khám phá.
