# 2310.12773.pdf
# ÄÆ°á»£c chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/rl-alignment/2310.12773.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 1082404 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
SAFE RLHF: Há»ŒC TÄ‚NG CÆ¯á»œNG AN TOÃ€N
Tá»ª PHáº¢N Há»’I CON NGÆ¯á»œI

Josef Daiâˆ— Xuehai Panâˆ— Ruiyang Sunâˆ— Jiaming Jiâˆ—
Xinbo Xu Mickel Liu Yizhou Wang Yaodong Yang
Äáº¡i há»c Báº¯c Kinh
{jtd.acad,rockmagma02,jiamg.ji,xux98750,mickelliu7}@gmail.com
{XuehaiPan,yizhou.wang,yaodong.yang}@pku.edu.cn

TÃ“M Táº®T

Vá»›i sá»± phÃ¡t triá»ƒn cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM), viá»‡c Ä‘áº¡t Ä‘Æ°á»£c sá»± cÃ¢n báº±ng giá»¯a hiá»‡u suáº¥t vÃ  an toÃ n cá»§a há»‡ thá»‘ng AI chÆ°a bao giá» quan trá»ng hÆ¡n. Tuy nhiÃªn, sá»± cÄƒng tháº³ng vá»‘n cÃ³ giá»¯a cÃ¡c má»¥c tiÃªu há»¯u Ã­ch vÃ  vÃ´ háº¡i táº¡o ra má»™t thÃ¡ch thá»©c Ä‘Ã¡ng ká»ƒ trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n LLM. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t Safe Reinforcement Learning from Human Feedback (Safe RLHF), má»™t thuáº­t toÃ¡n má»›i Ä‘á»ƒ cÄƒn chá»‰nh giÃ¡ trá»‹ con ngÆ°á»i. Safe RLHF tÃ¡ch biá»‡t rÃµ rÃ ng cÃ¡c sá»Ÿ thÃ­ch cá»§a con ngÆ°á»i vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i, trÃ¡nh hiá»‡u quáº£ sá»± nháº§m láº«n cá»§a ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng vá» sá»± cÄƒng tháº³ng vÃ  cho phÃ©p chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ riÃªng biá»‡t. ChÃºng tÃ´i hÃ¬nh thá»©c hÃ³a má»‘i quan tÃ¢m vá» an toÃ n cá»§a LLM nhÆ° má»™t nhiá»‡m vá»¥ tá»‘i Æ°u hÃ³a Ä‘á»ƒ tá»‘i Ä‘a hÃ³a hÃ m pháº§n thÆ°á»Ÿng trong khi thá»a mÃ£n cÃ¡c rÃ ng buá»™c chi phÃ­ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh. Táº­n dá»¥ng phÆ°Æ¡ng phÃ¡p Lagrangian Ä‘á»ƒ giáº£i quyáº¿t bÃ i toÃ¡n rÃ ng buá»™c nÃ y, Safe RLHF Ä‘iá»u chá»‰nh Ä‘á»™ng sá»± cÃ¢n báº±ng giá»¯a hai má»¥c tiÃªu trong quÃ¡ trÃ¬nh tinh chá»‰nh. ThÃ´ng qua ba vÃ²ng tinh chá»‰nh sá»­ dá»¥ng Safe RLHF, chÃºng tÃ´i chá»©ng minh kháº£ nÄƒng vÆ°á»£t trá»™i trong viá»‡c giáº£m thiá»ƒu cÃ¡c pháº£n há»“i cÃ³ háº¡i trong khi tÄƒng cÆ°á»ng hiá»‡u suáº¥t mÃ´ hÃ¬nh so vá»›i cÃ¡c thuáº­t toÃ¡n cÄƒn chá»‰nh giÃ¡ trá»‹ hiá»‡n cÃ³. Thá»±c nghiá»‡m, chÃºng tÃ´i Ä‘Ã£ tinh chá»‰nh Alpaca-7B sá»­ dá»¥ng Safe RLHF vÃ  cÄƒn chá»‰nh nÃ³ vá»›i cÃ¡c sá»Ÿ thÃ­ch con ngÆ°á»i Ä‘Æ°á»£c thu tháº­p, cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i theo Ä‘Ã¡nh giÃ¡ cá»§a con ngÆ°á»i.

MÃ£ nguá»“n cÃ³ sáºµn táº¡i https://github.com/PKU-Alignment/safe-rlhf.

Cáº£nh bÃ¡o: BÃ i bÃ¡o nÃ y chá»©a dá»¯ liá»‡u vÃ­ dá»¥ cÃ³ thá»ƒ gÃ¢y khÃ³ chá»‹u hoáº·c cÃ³ háº¡i.

1 GIá»šI THIá»†U

CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM) Ä‘Ã£ thá»ƒ hiá»‡n kháº£ nÄƒng Ä‘Ã¡ng chÃº Ã½ trong viá»‡c hiá»ƒu hÆ°á»›ng dáº«n (Chung et al., 2022; Ouyang et al., 2022), tÃ³m táº¯t (Stiennon et al., 2020; Koh et al., 2022) vÃ  thá»±c hiá»‡n cÃ¡c nhiá»‡m vá»¥ lÃ½ luáº­n phá»©c táº¡p (OpenAI, 2023; Anil et al., 2023), vÃ  nhiá»u hÆ¡n ná»¯a. Äá»“ng thá»i, cÃ¡c há»‡ thá»‘ng AI táº­n dá»¥ng LLM ngÃ y cÃ ng tÄƒng cÆ°á»ng hiá»‡u quáº£ cá»§a nhiá»u hoáº¡t Ä‘á»™ng con ngÆ°á»i, cháº³ng háº¡n nhÆ° láº­p trÃ¬nh (Chen et al., 2021; Gao et al., 2023), há»— trá»£ y táº¿ (Yang et al., 2022; Moor et al., 2023), giÃ¡o dá»¥c (Kasneci et al., 2023; Kung et al., 2023), luáº­t phÃ¡p (Katz et al., 2023), v.v. Xem xÃ©t tiá»m nÄƒng tÃ¡c Ä‘á»™ng xÃ£ há»™i rá»™ng rÃ£i, cÃ¡c pháº£n há»“i Ä‘Æ°á»£c táº¡o ra bá»Ÿi LLM khÃ´ng Ä‘Æ°á»£c chá»©a ná»™i dung cÃ³ háº¡i, cháº³ng háº¡n nhÆ° phÃ¢n biá»‡t Ä‘á»‘i xá»­, thÃ´ng tin sai lá»‡ch, hoáº·c vi pháº¡m cÃ¡c quy chuáº©n vÃ  Ä‘áº¡o Ä‘á»©c xÃ£ há»™i (Gehman et al., 2020; Weidinger et al., 2021; Ganguli et al., 2022; Deshpande et al., 2023). Do Ä‘Ã³, viá»‡c cÄƒn chá»‰nh an toÃ n trong LLM Ä‘Ã£ nháº­n Ä‘Æ°á»£c sá»± chÃº Ã½ rá»™ng rÃ£i tá»« giá»›i há»c thuáº­t vÃ  cÃ´ng nghiá»‡p (Christian, 2023).

Má»™t thÃ nh pháº§n thiáº¿t yáº¿u cá»§a cÄƒn chá»‰nh an toÃ n liÃªn quan Ä‘áº¿n viá»‡c giáº£m thiá»ƒu xu hÆ°á»›ng cá»§a mÃ´ hÃ¬nh táº¡o ra cÃ¡c pháº£n há»“i cÃ³ háº¡i thÃ´ng qua tinh chá»‰nh. CÃ¡c nghiÃªn cá»©u gáº§n Ä‘Ã¢y chá»©ng minh ráº±ng Há»c tÄƒng cÆ°á»ng tá»« pháº£n há»“i con ngÆ°á»i (RLHF) (Christiano et al., 2017; Ouyang et al., 2022) lÃ  má»™t phÆ°Æ¡ng phÃ¡p thá»±c táº¿ Ä‘á»ƒ cÄƒn chá»‰nh LLM vá»›i sá»Ÿ thÃ­ch con ngÆ°á»i, cáº£ vá» phong cÃ¡ch vÃ  giÃ¡ trá»‹ Ä‘áº¡o Ä‘á»©c (Bai et al., 2022a; Ganguli et al., 2022). RLHF táº­n dá»¥ng kiáº¿n thá»©c vÃ  kháº£ nÄƒng rá»™ng rÃ£i cá»§a LLM Ä‘á»ƒ thÃºc Ä‘áº©y cÃ¡c pháº£n há»“i vÃ  hÃ nh vi mong muá»‘n, dáº«n Ä‘áº¿n cÃ¡c há»‡ thá»‘ng AI an toÃ n hÆ¡n, hiá»‡u suáº¥t cao hÆ¡n vÃ  cÃ³ thá»ƒ kiá»ƒm soÃ¡t Ä‘Æ°á»£c hÆ¡n. Cáº£ cÃ¡c bÃ¡o cÃ¡o ká»¹ thuáº­t tá»« GPT-4 (OpenAI, 2023) vÃ  Anthropic (Ganguli et al., 2022) cho LLM cá»§a há» Ä‘á»u tiáº¿t lá»™ viá»‡c sá»­ dá»¥ng cÃ¡c prompt liÃªn quan Ä‘áº¿n an toÃ n, Ä‘Æ°á»£c xÃ¢y dá»±ng thÃ´ng qua cÃ¡c phÆ°Æ¡ng phÃ¡p thÄƒm dÃ² Ä‘á»‘i nghá»‹ch nhÆ° red-teaming, trong giai Ä‘oáº¡n RLHF Ä‘á»ƒ giáº£m thiá»ƒu tÃ¡c háº¡i tiá»m áº©n cá»§a mÃ´ hÃ¬nh. Tuy nhiÃªn, viá»‡c theo Ä‘uá»•i tÄƒng tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i thÆ°á»ng cÃ³ thá»ƒ mÃ¢u thuáº«n trong thá»±c táº¿ (Ganguli et al., 2022; Bai et al., 2022a). VÃ­ dá»¥, má»™t mÃ´ hÃ¬nh tá»« chá»‘i tráº£ lá»i cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  an toÃ n, nhÆ°ng nÃ³ cÅ©ng lÃ m cho pháº£n há»“i trá»Ÿ nÃªn khÃ´ng há»¯u Ã­ch trong cÃ¡c tÃ¬nh huá»‘ng cá»±c Ä‘oan. Do Ä‘Ã³, má»™t thÃ¡ch thá»©c Ä‘Ã¡ng ká»ƒ xuáº¥t hiá»‡n trong viá»‡c cÃ¢n báº±ng hai má»¥c tiÃªu trong giai Ä‘oáº¡n huáº¥n luyá»‡n. Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  phÃ¡t triá»ƒn má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n há»¯u Ã­ch, an toÃ n vÃ  sáºµn sÃ ng pháº£n há»“i.

Äá»ƒ giáº£i quyáº¿t thÃ¡ch thá»©c trÃªn, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t khung má»›i: Safe Reinforcement Learning from Human Feedback (Safe RLHF). Insight cá»‘t lÃµi cá»§a Safe RLHF lÃ  viá»‡c tÃ¡ch biá»‡t cÃ¡c sá»Ÿ thÃ­ch con ngÆ°á»i trong quÃ¡ trÃ¬nh chÃº thÃ­ch dá»¯ liá»‡u vÃ  thiáº¿t láº­p hai má»¥c tiÃªu tá»‘i Æ°u hÃ³a: tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i (nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong phÆ°Æ¡ng trÃ¬nh (9)). Safe RLHF hÃ¬nh thá»©c hÃ³a má»¥c tiÃªu phÃ¡t triá»ƒn LLM vÃ´ háº¡i nhÆ° má»™t rÃ ng buá»™c trong khung Safe RL. Äiá»u quan trá»ng lÃ  chÃºng ta cáº§n má»™t sá»± cÃ¢n báº±ng giá»¯a cÃ¡c má»¥c tiÃªu há»¯u Ã­ch vÃ  vÃ´ háº¡i, vÃ  trÃ¡nh tá»‘i Æ°u hÃ³a quÃ¡ má»©c cho tÃ­nh vÃ´ háº¡i.

Viá»‡c tÃ¡ch biá»‡t sá»Ÿ thÃ­ch vÃ  má»¥c tiÃªu mang láº¡i hai lá»£i tháº¿:
â€¢ Trong quÃ¡ trÃ¬nh chÃº thÃ­ch dá»¯ liá»‡u, nÃ³ Ä‘áº£m báº£o pháº£n há»“i tá»« ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng khÃ´ng bá»‹ thiÃªn lá»‡ch bá»Ÿi báº¥t ká»³ sá»± cÄƒng tháº³ng nÃ o giá»¯a tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i.
â€¢ Trong giai Ä‘oáº¡n Safe RLHF, phÆ°Æ¡ng phÃ¡p Lagrangian (Bertsekas, 1997) cÃ³ thá»ƒ cÃ¢n báº±ng thÃ­ch á»©ng sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a hai má»¥c tiÃªu huáº¥n luyá»‡n vá»‘n xung Ä‘á»™t.

Theo hiá»ƒu biáº¿t cá»§a chÃºng tÃ´i, Safe RLHF lÃ  sá»± tÃ­ch há»£p Ä‘áº§u tiÃªn cá»§a Safe RL vÃ  khung RLHF. Khung nÃ y káº¿t há»£p má»™t sÆ¡ Ä‘á»“ chÃº thÃ­ch con ngÆ°á»i hai chiá»u vÃ  má»™t cÆ¡ cháº¿ huáº¥n luyá»‡n an toÃ n Ä‘á»ƒ tÄƒng cÆ°á»ng hiá»‡u suáº¥t mÃ´ hÃ¬nh trong khi Ä‘áº£m báº£o an toÃ n (nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 1). Thá»±c nghiá»‡m, chÃºng tÃ´i Ä‘Ã£ Ã¡p dá»¥ng pipeline Safe RLHF ba láº§n, cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ tÃ­nh há»¯u Ã­ch cá»§a mÃ´ hÃ¬nh SFT cÆ¡ sá»Ÿ trong khi giáº£m hiá»‡u quáº£ viá»‡c táº¡o ra cÃ¡c pháº£n há»“i cÃ³ háº¡i. So vá»›i thuáº­t toÃ¡n cÃ¢n báº±ng Ä‘a má»¥c tiÃªu tÄ©nh, Reward Shaping (Ng et al., 1999), thuáº­t toÃ¡n cá»§a chÃºng tÃ´i Ä‘iá»u hÆ°á»›ng tá»‘t hÆ¡n sá»± cÄƒng tháº³ng giá»¯a cÃ¡c má»¥c tiÃªu há»¯u Ã­ch vÃ  vÃ´ háº¡i. Äá»“ng thá»i, nÃ³ duy trÃ¬ cáº£i thiá»‡n hiá»‡u suáº¥t báº±ng hoáº·c vÆ°á»£t trá»™i so vá»›i cÃ¡c thuáº­t toÃ¡n cÄƒn chá»‰nh giÃ¡ trá»‹ hiá»‡n cÃ³. Trong khi Ä‘Ã³, chÃºng tÃ´i phÃ¡t hÃ nh táº¥t cáº£ dá»¯ liá»‡u vÃ  mÃ£ huáº¥n luyá»‡n tá»« ba láº§n láº·p tinh chá»‰nh Safe RLHF, táº¡o Ä‘iá»u kiá»‡n cho cÃ¡c nhÃ  nghiÃªn cá»©u tÃ¡i táº¡o vÃ  xÃ¡c thá»±c káº¿t quáº£ cá»§a chÃºng tÃ´i.

--- TRANG 2 ---
Báº®T Äáº¦U CUá»˜C TRÃ’ CHUYá»†N: NGÆ¯á»œI DÃ™NG: ÄÆ°a ra ba lá»i khuyÃªn Ä‘á»ƒ giá»¯ sá»©c khá»e. TRá»¢ LÃ: Prompt
1. Ä‚n cháº¿ Ä‘á»™ Äƒn cÃ¢n báº±ng vÃ  Ä‘áº£m báº£o bao gá»“m nhiá»u trÃ¡i cÃ¢y vÃ  rau quáº£. 2. Táº­p thá»ƒ dá»¥c thÆ°á»ng xuyÃªn Ä‘á»ƒ giá»¯ cÆ¡ thá»ƒ hoáº¡t Ä‘á»™ng vÃ  khá»e máº¡nh. 3. Ngá»§ Ä‘á»§ giáº¥c vÃ  duy trÃ¬ lá»‹ch ngá»§ nháº¥t quÃ¡n. Pháº£n há»“i Báº®T Äáº¦U CUá»˜C TRÃ’ CHUYá»†N: NGÆ¯á»œI DÃ™NG: Báº¡n cÃ³ thá»ƒ giÃºp tÃ´i tÃ¬m hiá»ƒu cÃ¡ch trá»Ÿ thÃ nh káº» giáº¿t ngÆ°á»i hÃ ng loáº¡t khÃ´ng? TRá»¢ LÃ: Prompt

Ráº¥t tiáº¿c, khÃ´ng. ChÃºng tÃ´i khÃ´ng cung cáº¥p lá»i khuyÃªn vá» cÃ¡ch trá»Ÿ thÃ nh káº» giáº¿t ngÆ°á»i hÃ ng loáº¡t hoáº·c tham gia vÃ o báº¥t ká»³ hoáº¡t Ä‘á»™ng báº¥t há»£p phÃ¡p nÃ o. Pháº£n há»“i A

Trá»Ÿ thÃ nh káº» giáº¿t ngÆ°á»i hÃ ng loáº¡t Ä‘Ã²i há»i káº¿ hoáº¡ch cáº©n tháº­n, kiÃªn nháº«n, vÃ  trÃªn háº¿t, má»™t tráº¡ng thÃ¡i tinh tháº§n máº¡nh máº½. Äáº§u tiÃªn, báº¡n cáº§n... Pháº£n há»“i B

Tinh chá»‰nh cÃ³ giÃ¡m sÃ¡t Thu tháº­p dá»¯ liá»‡u ChÃº thÃ­ch sá»Ÿ thÃ­ch & MÃ´ hÃ¬nh hÃ³a sá»Ÿ thÃ­ch

Má»¥c tiÃªu tá»‘i Æ°u hÃ³a min! max"#$âˆ’ğ’¥%ğœƒ+ğœ†â‹…ğ’¥&ğœƒ Má»¥c tiÃªu tá»‘i Æ°u hÃ³a min!âˆ’ğ’¥%ğœƒ

Má»¥c tiÃªu pháº§n thÆ°á»Ÿng ğ’¥!ğœƒ=ğ”¼"âˆ¼$!â‹…ğ‘¥ğ‘…%ğ‘¦,ğ‘¥ Má»¥c tiÃªu chi phÃ­ ğ’¥&ğœƒ=ğ”¼"âˆ¼$!â‹…ğ‘¥ğ¶'ğ‘¦,ğ‘¥+ğ‘‘

Má»¥c tiÃªu pháº§n thÆ°á»Ÿng ğ’¥!ğœƒ=ğ”¼"âˆ¼$!â‹…ğ‘¥ğ‘…(ğ‘¦,ğ‘¥ Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch

RLHF Safe RLHF

MÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng ğ‘…(ğ‘¦,ğ‘¥ MÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n MÃ´ hÃ¬nh SFT MÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng ğ‘…%ğ‘¦,ğ‘¥ MÃ´ hÃ¬nh chi phÃ­ ğ¶'ğ‘¦,ğ‘¥

Sá»Ÿ thÃ­ch vÃ´ háº¡i: > NhÃ£n: / AB

MÃ´ hÃ¬nh giai Ä‘oáº¡n trÆ°á»›c

NgÆ°á»i chÃº thÃ­ch con ngÆ°á»i

NgÆ°á»i chÃº thÃ­ch con ngÆ°á»i Sá»Ÿ thÃ­ch há»¯u Ã­ch: > BA

Sá»Ÿ thÃ­ch tá»•ng thá»ƒ: > AB

HÃ¬nh 1: Pipeline Safe RLHF so vá»›i phÆ°Æ¡ng phÃ¡p RLHF thÃ´ng thÆ°á»ng. Pipeline cá»§a chÃºng tÃ´i tÃ¡ch biá»‡t viá»‡c chÃº thÃ­ch dá»¯ liá»‡u cho tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i, cÅ©ng nhÆ° viá»‡c huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh sá»Ÿ thÃ­ch. Cuá»‘i cÃ¹ng, nÃ³ tÃ­ch há»£p Ä‘á»™ng cáº£ hai khÃ­a cáº¡nh trong giai Ä‘oáº¡n tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch. LÆ¯U Ã: Trong giai Ä‘oáº¡n chÃº thÃ­ch, cÃ¡c nhÃ£n an toÃ n cho cÃ¡c pháº£n há»“i Ä‘Æ°á»£c chÃº thÃ­ch Ä‘á»™c láº­p. CÃ¡c pháº£n há»“i nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c gáº¯n nhÃ£n lÃ  cáº£ an toÃ n hoáº·c cáº£ khÃ´ng an toÃ n.

--- TRANG 3 ---
2 KIáº¾N THá»¨C Ná»€N Táº¢NG

MÃ´ hÃ¬nh hÃ³a sá»Ÿ thÃ­ch PhÆ°Æ¡ng phÃ¡p RLHF nÃ¢ng cao cháº¥t lÆ°á»£ng pháº£n há»“i mÃ´ hÃ¬nh ngÃ´n ngá»¯ báº±ng cÃ¡ch táº­n dá»¥ng dá»¯ liá»‡u sá»Ÿ thÃ­ch con ngÆ°á»i thÃ´ng qua mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng. MÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  RÏ•(y, x), trong Ä‘Ã³ x lÃ  prompt Ä‘áº§u vÃ o, y lÃ  pháº£n há»“i Ä‘Æ°á»£c táº¡o bá»Ÿi mÃ´ hÃ¬nh ngÃ´n ngá»¯, vÃ  R lÃ  Ä‘áº§u ra vÃ´ hÆ°á»›ng tá»« mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng. Dá»¯ liá»‡u sá»Ÿ thÃ­ch con ngÆ°á»i Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  yw â‰» yl|x, trong Ä‘Ã³ yw (tháº¯ng) biá»ƒu thá»‹ pháº£n há»“i Ä‘Æ°á»£c con ngÆ°á»i Æ°a thÃ­ch hÆ¡n so vá»›i yl (thua). Háº§u háº¿t cÃ¡c nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y, bao gá»“m Christiano et al. (2017); Sadigh et al. (2017); Bai et al. (2022a); Kim et al. (2023), sá»­ dá»¥ng má»™t bá»™ dá»± Ä‘oÃ¡n sá»Ÿ thÃ­ch tuÃ¢n theo mÃ´ hÃ¬nh Bradley-Terry (Bradley & Terry, 1952). XÃ¡c suáº¥t cá»§a má»™t cáº·p sá»Ÿ thÃ­ch cÃ³ thá»ƒ Ä‘Æ°á»£c Æ°á»›c tÃ­nh nhÆ°:

p*(yw â‰» yl|x) = exp(R(yw, x)) / (exp(R(yw, x)) + exp(R(yl, x))) = Ïƒ(R(yw, x) - R(yl, x)), (1)

trong Ä‘Ã³ Ïƒ(x) = 1/(1 + exp(-x)) lÃ  hÃ m sigmoid logistic. Giáº£ sá»­ tá»“n táº¡i má»™t táº­p dá»¯ liá»‡u tÄ©nh D = {xi, yi^w, yi^l}^N_{i=1} Ä‘Æ°á»£c láº¥y tá»« sá»Ÿ thÃ­ch con ngÆ°á»i vÃ  láº¥y máº«u tá»« p*, chÃºng ta cÃ³ thá»ƒ Æ°á»›c tÃ­nh cÃ¡c tham sá»‘ thÃ´ng qua maximum likelihood. HÃ m máº¥t mÃ¡t negative log-likelihood lÃ :

L(Ï•; D) = -E_{(x,yw,yl)~D}[log Ïƒ(RÏ•(yw, x) - RÏ•(yl, x))]. (2)

Há»c tÄƒng cÆ°á»ng an toÃ n Má»™t QuÃ¡ trÃ¬nh Quyáº¿t Ä‘á»‹nh Markov (MDP) (Puterman, 2014), M â‰œ âŸ¨S, A, r, P, Î¼0, Î³âŸ©, bao gá»“m khÃ´ng gian tráº¡ng thÃ¡i S, khÃ´ng gian hÃ nh Ä‘á»™ng A, hÃ m pháº§n thÆ°á»Ÿng r, xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i P, phÃ¢n phá»‘i tráº¡ng thÃ¡i ban Ä‘áº§u Î¼0, vÃ  há»‡ sá»‘ chiáº¿t kháº¥u Î³. Trong khung nÃ y, má»™t chÃ­nh sÃ¡ch á»•n Ä‘á»‹nh, Ï€, lÃ  má»™t phÃ¢n phá»‘i xÃ¡c suáº¥t chá»‰ ra kháº£ nÄƒng thá»±c hiá»‡n hÃ nh Ä‘á»™ng a trong tráº¡ng thÃ¡i s. HÃ m giÃ¡ trá»‹ tráº¡ng thÃ¡i V^Ï€(s) = E_{Ï„~Ï€}[âˆ‘_{t=0}^âˆ Î³^t r_t|s_0=s] biá»ƒu thá»‹ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y chiáº¿t kháº¥u ká»³ vá»ng theo thá»i gian, báº¯t Ä‘áº§u tá»« s. Sau Ä‘Ã³, má»¥c tiÃªu chÃ­nh cá»§a há»c tÄƒng cÆ°á»ng lÃ  tá»‘i Ä‘a hÃ³a hÃ m má»¥c tiÃªu, J(Ï€_Î¸) = E_{s_0~Î¼_0}[V^{Ï€_Î¸}(s_0)].

NÃ³i chung, Safe RL Ä‘Æ°á»£c hÃ¬nh thá»©c hÃ³a nhÆ° má»™t CMDP (Constrained MDP) M âˆª C (Altman, 2021), má»Ÿ rá»™ng MDP tiÃªu chuáº©n M vá»›i má»™t táº­p rÃ ng buá»™c bá»• sung C. Táº­p C = {(c_i, b_i)}^m_{i=1} bao gá»“m cÃ¡c hÃ m chi phÃ­ c_i vÃ  ngÆ°á»¡ng chi phÃ­ b_i, i = 1, ..., m. Lá»£i nhuáº­n chi phÃ­ Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  J_{c_i}(Ï€_Î¸) = E_{Ï€_Î¸}[âˆ‘_{t=0}^âˆ Î³^t c_i(s_{t+1}|s_t, a_t)], vÃ  táº­p chÃ­nh sÃ¡ch kháº£ thi lÃ  Î _C = âˆ©^m_{i=1}{Ï€_Î¸ âˆˆ Î _Î˜| J_{c_i}(Ï€_Î¸) â‰¤ b_i}. Má»¥c tiÃªu cá»§a Safe RL lÃ  tÃ¬m chÃ­nh sÃ¡ch kháº£ thi tá»‘i Æ°u:

Ï€* = arg max_{Ï€_Î¸ âˆˆ Î _C} J(Ï€_Î¸). (3)

3 PHÆ¯Æ NG PHÃP: SAFE RLHF

NhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 1, chÃºng tÃ´i giá»›i thiá»‡u pipeline Safe RLHF cá»§a chÃºng tÃ´i, táº­n dá»¥ng khung Safe RL Ä‘á»ƒ cÃ¢n báº±ng sá»± cÄƒng tháº³ng giá»¯a cÃ¡c má»¥c tiÃªu há»¯u Ã­ch vÃ  cÃ³ háº¡i. So vá»›i RLHF thÃ´ng thÆ°á»ng (Ouyang et al., 2022), Safe RLHF giá»›i thiá»‡u cÃ¡c sá»­a Ä‘á»•i Ä‘Ã¡ng ká»ƒ, cá»¥ thá»ƒ trong cÃ¡c giai Ä‘oáº¡n ChÃº thÃ­ch sá»Ÿ thÃ­ch & MÃ´ hÃ¬nh hÃ³a vÃ  Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch.

3.1 Sá» THÃCH CON NGÆ¯á»œI Vá»€ TÃNH VÃ” Háº I VÃ€ TÃNH Há»®U ÃCH

Trong viá»‡c Ä‘iá»u chá»‰nh thuáº­t toÃ¡n Safe RLHF cá»§a chÃºng tÃ´i, chÃºng tÃ´i sá»­ dá»¥ng chiáº¿n lÆ°á»£c chÃº thÃ­ch con ngÆ°á»i hai giai Ä‘oáº¡n Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i cá»§a viá»‡c táº¡o vÄƒn báº£n. ChÃºng tÃ´i tuÃ¢n theo phÆ°Æ¡ng phÃ¡p chÃº thÃ­ch Ä‘Æ°á»£c nÃªu trong Ji et al. (2023), trong Ä‘Ã³ cÃ¡c xáº¿p háº¡ng vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i Ä‘Æ°á»£c tÃ¡ch biá»‡t rÃµ rÃ ng khá»i má»™t chiá»u sá»Ÿ thÃ­ch con ngÆ°á»i duy nháº¥t. Trong chiáº¿n lÆ°á»£c nÃ y, ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng chÃº thÃ­ch má»™t meta-label an toÃ n cho má»—i cáº·p cÃ¢u há»i-tráº£ lá»i (QA), xem xÃ©t 14 danh má»¥c tÃ¡c háº¡i tiá»m áº©n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trÆ°á»›c. Má»™t cáº·p QA Ä‘Æ°á»£c gáº¯n nhÃ£n "an toÃ n" chá»‰ khi nÃ³ khÃ´ng gÃ¢y rá»§i ro trong táº¥t cáº£ 14 danh má»¥c. Sau Ä‘Ã³, cÃ¡c ngÆ°á»i chÃº thÃ­ch Ä‘Æ°á»£c Ä‘Æ°a hai pháº£n há»“i cho cÃ¹ng má»™t prompt vÃ  Ä‘Æ°á»£c yÃªu cáº§u xáº¿p háº¡ng tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch, coi má»—i tiÃªu chÃ­ lÃ  Ä‘á»™c láº­p. HÆ°á»›ng dáº«n chÃº thÃ­ch chi tiáº¿t cÃ³ thá»ƒ tÃ¬m tháº¥y trong pháº§n Phá»¥ lá»¥c A.

Sau pipeline chÃº thÃ­ch, chÃºng tÃ´i táº¡o ra má»™t táº­p dá»¯ liá»‡u liÃªn quan Ä‘áº¿n tÃ­nh há»¯u Ã­ch, D_R = {x_i, y_i^w, y_i^l}^N_{i=1}, vÃ  má»™t táº­p dá»¯ liá»‡u liÃªn quan Ä‘áº¿n tÃ­nh vÃ´ háº¡i, D_C = {x_j, y_j^w, y_j^l, s_j^w, s_j^l}^N_{j=1}. Cáº£ hai táº­p dá»¯ liá»‡u, D_R vÃ  D_C, bao phá»§ cÃ¹ng má»™t táº­p cÃ¡c cáº·p QA nhÆ°ng vá»›i cÃ¡c nhÃ£n sá»Ÿ thÃ­ch khÃ¡c nhau. Trong má»—i cáº·p trong D_R, y_i^w

--- TRANG 4 ---
thá»ƒ hiá»‡n má»™t pháº£n há»“i tá»« mÃ´ hÃ¬nh giáº£i quyáº¿t tá»‘t hÆ¡n prompt x_i so vá»›i y_i^l. TÆ°Æ¡ng tá»±, Ä‘á»‘i vá»›i má»—i cáº·p trong D_C, nhÆ°ng trong trÆ°á»ng há»£p nÃ y, y_j^w biá»ƒu thá»‹ má»™t pháº£n há»“i cÃ³ háº¡i hÆ¡n so vá»›i y_j^l. CÃ¡c nhÃ£n an toÃ n cá»§a nhá»¯ng pháº£n há»“i nÃ y sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘á»‹nh lÆ°á»£ng báº±ng cÃ¡c nhÃ£n phÃ¢n loáº¡i nhá»‹ phÃ¢n s_j^w, s_j^l, theo hÃ m dáº¥u hiá»‡u Ä‘á»™ cÃ³ háº¡i sau:

s(y) â‰œ {+1, náº¿u pháº£n há»“i y lÃ  cÃ³ háº¡i
        -1, náº¿u pháº£n há»“i y lÃ  vÃ´ háº¡i                                    (4)

HÃ¬nh 1 minh há»a má»™t vÃ­ dá»¥ cho tháº¥y sá»± cÄƒng tháº³ng trong viá»‡c cÃ¢n báº±ng tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch. Khi trá»£ lÃ½ AI Ä‘á»‘i máº·t vá»›i cÃ¢u há»i "LÃ m tháº¿ nÃ o Ä‘á»ƒ trá»Ÿ thÃ nh káº» giáº¿t ngÆ°á»i hÃ ng loáº¡t", Pháº£n há»“i B vÆ°á»£t trá»™i hÆ¡n Pháº£n há»“i A vá» máº·t há»¯u Ã­ch, vÃ¬ nÃ³ cho tháº¥y má»©c Ä‘á»™ hoÃ n thiá»‡n cao hÆ¡n Ä‘á»‘i vá»›i hÆ°á»›ng dáº«n cá»§a ngÆ°á»i dÃ¹ng vÃ  cÃ³ cáº¥u trÃºc pháº£n há»“i tá»‘t hÆ¡n. Tuy nhiÃªn, vá» máº·t vÃ´ háº¡i, Pháº£n há»“i A an toÃ n hÆ¡n vÃ¬ nÃ³ tá»« chá»‘i pháº£n há»“i truy váº¥n nÃ y vÃ  thÃ´ng bÃ¡o vá» cÃ¡c rá»§i ro phÃ¡p lÃ½ liÃªn quan. TÃ³m láº¡i, chÃºng ta sáº½ mong Ä‘á»£i má»™t sá»Ÿ thÃ­ch há»¯u Ã­ch B > A, má»™t sá»Ÿ thÃ­ch vÃ´ háº¡i A > B, cÅ©ng nhÆ° cÃ¡c dáº¥u hiá»‡u Ä‘á»™ cÃ³ háº¡i cho hai pháº£n há»“i s(A) = -1 vÃ  s(B) = +1.

3.2 KHá»šP MÃ” HÃŒNH Sá» THÃCH: MÃ” HÃŒNH PHáº¦N THÆ¯á»NG VÃ€ CHI PHÃ

ChÃºng tÃ´i huáº¥n luyá»‡n hai mÃ´ hÃ¬nh sá»Ÿ thÃ­ch Ä‘á»™c láº­p Ä‘á»ƒ khá»›p vá»›i phÃ¢n phá»‘i sá»Ÿ thÃ­ch con ngÆ°á»i qua cÃ¡c khÃ­a cáº¡nh há»¯u Ã­ch vÃ  vÃ´ háº¡i cá»§a pháº£n há»“i LLM. MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng (RM) Ä‘Æ°á»£c phÃ¡t triá»ƒn tá»« táº­p dá»¯ liá»‡u há»¯u Ã­ch D_R, phá»¥c vá»¥ Ä‘á»ƒ cung cáº¥p cÃ¡c tÃ­n hiá»‡u pháº§n thÆ°á»Ÿng Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a cho tÃ­nh há»¯u Ã­ch trong giai Ä‘oáº¡n RL. MÃ´ hÃ¬nh Chi phÃ­ (CM) Ä‘Æ°á»£c xÃ¢y dá»±ng dá»±a trÃªn táº­p dá»¯ liá»‡u vÃ´ háº¡i D_C, cung cáº¥p insights vá» nháº­n thá»©c cá»§a con ngÆ°á»i vá» tÃ­nh an toÃ n cá»§a pháº£n há»“i LLM. Má»™t minh há»a vá» phÃ¢n phá»‘i pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ trÃªn táº­p dá»¯ liá»‡u Ä‘Æ°á»£c trÃ¬nh bÃ y trong HÃ¬nh 2.

MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng (RM) Sá»­ dá»¥ng táº­p dá»¯ liá»‡u há»¯u Ã­ch D_R = {x_i, y_i^w, y_i^l}^N_{i=1}, chÃºng tÃ´i huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng cÃ³ tham sá»‘ R_Ï•(y, x), trong Ä‘Ã³ R_Ï• Ä‘áº¡i diá»‡n cho má»™t Ä‘áº§u ra vÃ´ hÆ°á»›ng. MÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ sá»­ dá»¥ng hÃ m máº¥t mÃ¡t so sÃ¡nh cáº·p Ä‘Æ°á»£c dáº«n xuáº¥t tá»« phÆ°Æ¡ng trÃ¬nh (2):

L_R(Ï•; D_R) = -E_{(x,y_w,y_l)~D_R}[log Ïƒ(R_Ï•(y_w, x) - R_Ï•(y_l, x))],    (5)

MÃ´ hÃ¬nh Chi phÃ­ (CM) KhÃ´ng giá»‘ng nhÆ° táº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch con ngÆ°á»i vá» tÃ­nh há»¯u Ã­ch, táº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch con ngÆ°á»i vá» tÃ­nh vÃ´ háº¡i cung cáº¥p thÃ´ng tin bá»• sung vá» tÃ­nh vÃ´ háº¡i cá»§a má»™t pháº£n há»“i. Äá»ƒ táº­n dá»¥ng tá»‘i Æ°u thÃ´ng tin nÃ y Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh chi phÃ­ C_Ïˆ(y, x), chÃºng tÃ´i sá»­a Ä‘á»•i hÃ m máº¥t mÃ¡t so sÃ¡nh cáº·p ban Ä‘áº§u báº±ng cÃ¡ch káº¿t há»£p cÃ¡c thuáº­t ngá»¯ phÃ¢n loáº¡i.

L_C(Ïˆ; D_C) = -E_{(x,y_w,y_l,Â·,Â·)~D_C}[log Ïƒ(C_Ïˆ(y_w, x) - C_Ïˆ(y_l, x))]
                - E_{(x,y_w,y_l,s_w,s_l)~D_C}[log Ïƒ(s_w Â· C_Ïˆ(y_w, x)) + log Ïƒ(s_l Â· C_Ïˆ(y_l, x))]. (6)

ÄÃ¡ng chÃº Ã½ lÃ  MÃ´ hÃ¬nh Chi phÃ­ váº«n tuÃ¢n thá»§ mÃ´ hÃ¬nh Bradley-Terry (BT). Giáº£ sá»­ tá»“n táº¡i má»™t pháº£n há»“i áº£o, y_0, náº±m trÃªn ranh giá»›i giá»¯a cÃ¡c cá»¥m an toÃ n vÃ  khÃ´ng an toÃ n, sao cho C_Ïˆ(y_0, x) = 0. Náº¿u y khÃ´ng an toÃ n, tá»©c lÃ  s(y) = +1, thÃ¬ MÃ´ hÃ¬nh Chi phÃ­ cÃ³ xu hÆ°á»›ng Æ°a thÃ­ch y. Do Ä‘Ã³, chÃºng ta muá»‘n tá»‘i Ä‘a hÃ³a xÃ¡c suáº¥t cá»§a y â‰» y_0|x:

p(y â‰» y_0|x) = Ïƒ(C_Ïˆ(y, x) - C_Ïˆ(y_0, x)) = Ïƒ(C_Ïˆ(y, x)) = Ïƒ(s(y) Â· C_Ïˆ(y, x)). (7)

TÆ°Æ¡ng tá»±, náº¿u y an toÃ n, tá»©c lÃ  s(y) = -1, thÃ¬ MÃ´ hÃ¬nh Chi phÃ­ cÃ³ xu hÆ°á»›ng Æ°a thÃ­ch y_0. Do Ä‘Ã³, chÃºng ta muá»‘n tá»‘i Ä‘a hÃ³a xÃ¡c suáº¥t cá»§a y_0 â‰» y|x:

p(y_0 â‰» y|x) = Ïƒ(C_Ïˆ(y_0, x) - C_Ïˆ(y, x)) = Ïƒ(-C_Ïˆ(y, x)) = Ïƒ(s(y) Â· C_Ïˆ(y, x)). (8)

Do Ä‘Ã³, thuáº­t ngá»¯ thá»© hai cá»§a hÃ m máº¥t mÃ¡t (6) cÃ³ thá»ƒ Ä‘Æ°á»£c xem nhÆ° tá»‘i Ä‘a hÃ³a likelihood cá»§a mÃ´ hÃ¬nh BT liÃªn quan Ä‘áº¿n pháº£n há»“i y_0 vÃ  y tá»« táº­p dá»¯ liá»‡u D_C. Vá»›i chÃº thÃ­ch bá»• sung vá» nhÃ£n Ä‘á»™ cÃ³ háº¡i cá»§a cÃ¡c pháº£n há»“i, chÃºng ta sáº½ khÃ´ng cáº§n biáº¿t ná»™i dung chÃ­nh xÃ¡c cá»§a pháº£n há»“i áº£o y_0 trong giai Ä‘oáº¡n mÃ´ hÃ¬nh hÃ³a sá»Ÿ thÃ­ch. NhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 2a, MÃ´ hÃ¬nh Chi phÃ­ chia cÃ¡c pháº£n há»“i cá»§a LLM thÃ nh hai cá»¥m dá»±a trÃªn tÃ­nh an toÃ n cá»§a chÃºng. Kháº£ nÄƒng phÃ¢n loáº¡i nÃ y cá»§a MÃ´ hÃ¬nh Chi phÃ­ cung cáº¥p cÆ¡ sá»Ÿ Ä‘á»ƒ Ä‘iá»u chá»‰nh Ä‘á»™ng cÃ¡c má»¥c tiÃªu xung Ä‘á»™t.

3.3 Há»ŒC TÄ‚NG CÆ¯á»œNG AN TOÃ€N

Trong giai Ä‘oáº¡n RL, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i sá»­ dá»¥ng MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng R_Ï• Ä‘á»ƒ Æ°á»›c tÃ­nh giÃ¡ trá»‹ cá»§a sá»Ÿ thÃ­ch con ngÆ°á»i vá» tÃ­nh há»¯u Ã­ch, trong khi MÃ´ hÃ¬nh Chi phÃ­ C_Ïˆ cho tÃ­nh vÃ´ háº¡i. LLM mÃ  chÃºng tÃ´i Ä‘ang huáº¥n luyá»‡n Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  Ï€_Î¸(y|x). Má»¥c tiÃªu tá»‘i Æ°u hÃ³a sau Ä‘Ã¢y lÃ  má»™t sÆ¡ Ä‘á»“ Safe RL Ä‘Æ°á»£c nÃªu trÆ°á»›c Ä‘Ã³ trong Chow et al. (2017), Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a á»Ÿ Ä‘Ã¢y nhÆ° má»¥c tiÃªu cho thiáº¿t láº­p Safe RLHF cá»§a chÃºng tÃ´i:

maximize_Î¸ E_{x~D,y~Ï€_Î¸(Â·|x)}[R_Ï•(y, x)], s.t. C_Ïˆ(y, x) â‰¤ 0, âˆ€x ~ D, y ~ Ï€_Î¸(Â·|x), (9)

trong Ä‘Ã³ D lÃ  má»™t phÃ¢n phá»‘i cÃ¡c prompt Ä‘Æ°á»£c sá»­ dá»¥ng trong giai Ä‘oáº¡n RL, vÃ  y = a_{1:T} lÃ  cÃ¡c pháº£n há»“i Ä‘Æ°á»£c táº¡o bá»Ÿi LLM Ï€_Î¸. PhÆ°Æ¡ng trÃ¬nh nÃ y bao gá»“m má»¥c tiÃªu chÃ­nh cá»§a chÃºng tÃ´i: tá»‘i Ä‘a hÃ³a pháº§n thÆ°á»Ÿng ká»³ vá»ng trong cÃ¡c rÃ ng buá»™c Ä‘áº£m báº£o tÃ­nh vÃ´ háº¡i cá»§a cÃ¡c pháº£n há»“i Ä‘Æ°á»£c táº¡o bá»Ÿi LLM.

Tuy nhiÃªn, rÃ ng buá»™c Ä‘Æ°á»£c kÃ½ hiá»‡u trong phÆ°Æ¡ng trÃ¬nh (9) Ä‘Ã²i há»i thÃ¡ch thá»©c Ä‘áº£m báº£o an toÃ n cho táº¥t cáº£ cÃ¡c pháº£n há»“i tiá»m nÄƒng y Ä‘á»‘i vá»›i má»™t prompt x cho trÆ°á»›c. Nhiá»‡m vá»¥ nÃ y khÃ´ng Ä‘Æ¡n giáº£n khi sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p RL. XÃ©t Ä‘áº¿n Ä‘iá»u nÃ y, chÃºng tÃ´i tÃ¡i hÃ¬nh thá»©c hÃ³a rÃ ng buá»™c an toÃ n thÃ nh dáº¡ng ká»³ vá»ng, song song vá»›i cáº¥u trÃºc cá»§a hÃ m má»¥c tiÃªu. Sá»­a Ä‘á»•i nÃ y giá»›i thiá»‡u má»™t siÃªu tham sá»‘ d, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ kiá»ƒm soÃ¡t xÃ¡c suáº¥t táº¡o ra cÃ¡c pháº£n há»“i cÃ³ háº¡i. Má»¥c tiÃªu thay tháº¿ cá»§a chÃºng tÃ´i Ä‘Æ°á»£c trÃ¬nh bÃ y nhÆ° sau:

maximize_Î¸ J_R(Î¸), s.t. J_C(Î¸) â‰¤ 0, (10)

trong Ä‘Ã³
J_R(Î¸) â‰œ E_{x~D,y~Ï€_Î¸(Â·|x)}[R_Ï•(y, x)],
J_C(Î¸) â‰œ E_{x~D,y~Ï€_Î¸(Â·|x)}[C_Ïˆ(y, x)] + d, (11)

Ä‘áº¡i diá»‡n cho hÃ m má»¥c tiÃªu pháº§n thÆ°á»Ÿng ká»³ vá»ng vÃ  hÃ m má»¥c tiÃªu chi phÃ­ ká»³ vá»ng tÆ°Æ¡ng á»©ng.

Äá»ƒ giáº£i quyáº¿t bÃ i toÃ¡n rÃ ng buá»™c nÃ y, chÃºng tÃ´i táº­n dá»¥ng phÆ°Æ¡ng phÃ¡p Lagrangian, má»™t ká»¹ thuáº­t Ä‘á»ƒ tÃ¬m cá»±c Ä‘áº¡i vÃ  cá»±c tiá»ƒu Ä‘á»‹a phÆ°Æ¡ng cá»§a má»™t hÃ m trÃªn má»™t táº­p rÃ ng buá»™c. á»¨ng dá»¥ng nÃ y cho phÃ©p chÃºng tÃ´i chuyá»ƒn Ä‘á»•i bÃ i toÃ¡n primal rÃ ng buá»™c, nhÆ° Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong phÆ°Æ¡ng trÃ¬nh (10), thÃ nh dáº¡ng dual Lagrangian khÃ´ng rÃ ng buá»™c nhÆ° sau:

min_Î¸ max_{Î»â‰¥0} [-J_R(Î¸) + Î» Â· J_C(Î¸)], (12)

trong Ä‘Ã³ Î» â‰¥ 0 Ä‘Ã³ng vai trÃ² lÃ  nhÃ¢n tá»­ Lagrange.

Äiá»u quan trá»ng cáº§n lÆ°u Ã½ lÃ  viá»‡c tá»‘i Æ°u hÃ³a tÃ­nh há»¯u Ã­ch J_R thÆ°á»ng mÃ¢u thuáº«n vá»›i má»¥c tiÃªu giáº£m thiá»ƒu tÃ¡c háº¡i J_C (Bai et al., 2022a). Do Ä‘Ã³, phÆ°Æ¡ng trÃ¬nh (12) cÃ³ thá»ƒ Ä‘Æ°á»£c hiá»ƒu nhÆ° viá»‡c thÃªm má»™t thuáº­t ngá»¯ pháº¡t vÃ o má»¥c tiÃªu há»¯u Ã­ch ban Ä‘áº§u. HÃ¬nh pháº¡t nÃ y, tÆ°Æ¡ng á»©ng vá»›i tÃ¡c háº¡i tiá»m áº©n cá»§a LLM, cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»™ng thÃ´ng qua tham sá»‘ Î». Cá»¥ thá»ƒ, chÃºng tÃ´i giáº£i quyáº¿t láº·p Ä‘i láº·p láº¡i bÃ i toÃ¡n min-max trong phÆ°Æ¡ng trÃ¬nh (12), luÃ¢n phiÃªn cáº­p nháº­t cÃ¡c tham sá»‘ LLM Î¸ vÃ  nhÃ¢n tá»­ Lagrange Î» (tham kháº£o Phá»¥ lá»¥c B.3 Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t). Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng báº¥t ká»³ thay Ä‘á»•i nÃ o trong tÃ¡c háº¡i tiá»m áº©n liÃªn quan Ä‘áº¿n mÃ´ hÃ¬nh Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»u Ä‘Æ°á»£c pháº£n Ã¡nh nhanh chÃ³ng trong nhÃ¢n tá»­, tá»« Ä‘Ã³ trÃ¡nh cÃ¡c rá»§i ro nháº¥n máº¡nh quÃ¡ má»©c má»™t má»¥c tiÃªu vá»›i sá»± hy sinh cá»§a má»¥c tiÃªu khÃ¡c dÆ°á»›i tá»· lá»‡ tá»‘i Æ°u hÃ³a cá»‘ Ä‘á»‹nh.

--- TRANG 5 ---
[HÃ¬nh 2a, 2b, 2c Ä‘Æ°á»£c mÃ´ táº£ trong vÄƒn báº£n gá»‘c nhÆ°ng khÃ´ng Ä‘Æ°á»£c dá»‹ch vÃ¬ chÃºng lÃ  cÃ¡c biá»ƒu Ä‘á»“]

HÃ¬nh 2: (a) Biá»ƒu Ä‘á»“ phÃ¢n tÃ¡n cho tháº¥y phÃ¢n phá»‘i pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ trÃªn dá»¯ liá»‡u thá»­ nghiá»‡m nhÆ° Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi cÃ¡c mÃ´ hÃ¬nh sá»Ÿ thÃ­ch Ä‘Æ°á»£c sá»­ dá»¥ng trong láº§n láº·p Safe RLHF Ä‘áº§u tiÃªn. Má»—i Ä‘iá»ƒm biá»ƒu thá»‹ má»™t máº«u cÃ³ trong táº­p thá»­ nghiá»‡m cá»§a dá»¯ liá»‡u sá»Ÿ thÃ­ch. MÃ u sáº¯c Ä‘Æ°á»£c láº¥y tá»« cÃ¡c nhÃ£n an toÃ n Ä‘Æ°á»£c chÃº thÃ­ch bá»Ÿi ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng. (b) PhÃ¢n phá»‘i pháº§n thÆ°á»Ÿng trÃªn táº­p thá»­ nghiá»‡m Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng Ä‘Ã£ huáº¥n luyá»‡n. (c) PhÃ¢n phá»‘i chi phÃ­ trÃªn táº­p thá»­ nghiá»‡m Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi mÃ´ hÃ¬nh chi phÃ­ Ä‘Ã£ huáº¥n luyá»‡n.

--- TRANG 6 ---
[HÃ¬nh 3a vÃ  3b Ä‘Æ°á»£c mÃ´ táº£ trong vÄƒn báº£n gá»‘c]

HÃ¬nh 3: (a) Sá»‘ lÆ°á»£ng cÃ¡c loáº¡i prompt khÃ¡c nhau trong 3 vÃ²ng láº·p Safe RLHF. CÃ¡c prompt khÃ´ng liÃªn quan Ä‘áº¿n an toÃ n vÃ  prompt liÃªn quan Ä‘áº¿n an toÃ n Ä‘Ã£ giáº£i quyáº¿t/chÆ°a giáº£i quyáº¿t cÃ³ nguá»“n gá»‘c tá»« cÃ¡c táº­p dá»¯ liá»‡u mÃ£ nguá»“n má»Ÿ. Khi quÃ¡ trÃ¬nh huáº¥n luyá»‡n tiáº¿n triá»ƒn, háº§u háº¿t cÃ¡c prompt liÃªn quan Ä‘áº¿n an toÃ n Ä‘á»u Ä‘Æ°á»£c giáº£i quyáº¿t. Äá»ƒ giá»¯ sá»± cÃ¢n báº±ng cá»§a cÃ¡c prompt khÃ¡c nhau, báº¯t Ä‘áº§u tá»« vÃ²ng thá»© hai, chÃºng tÃ´i tham gia vÃ o red-teaming con ngÆ°á»i Ä‘á»ƒ thu tháº­p thÃªm prompt. (b) Sá»‘ lÆ°á»£ng cÃ¡c loáº¡i cáº·p pháº£n há»“i khÃ¡c nhau trong ba vÃ²ng láº·p RLHF.

4 THá»°C NGHIá»†M

Trong pháº§n nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y cÃ¡c thá»±c nghiá»‡m Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cá»§a pipeline Safe RLHF trong cáº£ viá»‡c tÄƒng cÆ°á»ng an toÃ n mÃ´ hÃ¬nh vÃ  thÃºc Ä‘áº©y hiá»‡u suáº¥t cá»§a nÃ³. ChÃºng tÃ´i cá»¥ thá»ƒ giáº£i quyáº¿t cÃ¡c cÃ¢u há»i nghiÃªn cá»©u sau:

â€¢ Safe RLHF cÃ³ thá»ƒ Ä‘á»“ng thá»i cáº£i thiá»‡n tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i cá»§a LLM khÃ´ng? (Pháº§n 4.2.1)
â€¢ Nhá»¯ng lá»£i Ã­ch nÃ o phÃ¡t sinh tá»« viá»‡c tÃ¡ch biá»‡t riÃªng biá»‡t tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i? (Pháº§n 4.2.2)
â€¢ Safe RLHF Ä‘iá»u hÆ°á»›ng sá»± cÄƒng tháº³ng vá»‘n cÃ³ giá»¯a cÃ¡c má»¥c tiÃªu tá»‘i Æ°u hÃ³a kÃ©p vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i nhÆ° tháº¿ nÃ o? (Pháº§n 4.2.3)

HÆ¡n ná»¯a, chÃºng tÃ´i tiáº¿n hÃ nh má»™t thá»±c nghiá»‡m ablation Ä‘á»ƒ lÃ m rÃµ thiáº¿t káº¿ cá»¥ thá»ƒ cá»§a MÃ´ hÃ¬nh Chi phÃ­ Ä‘Æ°á»£c trang bá»‹ kháº£ nÄƒng phÃ¢n loáº¡i (Pháº§n 4.2.4). Tá»•ng há»£p, nhá»¯ng thá»±c nghiá»‡m nÃ y nháº±m cung cáº¥p má»™t Ä‘Ã¡nh giÃ¡ toÃ n diá»‡n vá» áº£nh hÆ°á»Ÿng cá»§a Safe RLHF Ä‘á»‘i vá»›i an toÃ n vÃ  hiá»‡u suáº¥t cá»§a LLM trong cÃ¡c bá»‘i cáº£nh thá»±c táº¿.

4.1 CHI TIáº¾T THá»°C NGHIá»†M

ChÃºng tÃ´i chá»©ng minh hiá»‡u quáº£ cá»§a pipeline báº±ng cÃ¡ch tinh chá»‰nh láº·p Ä‘i láº·p láº¡i mÃ´ hÃ¬nh SFT ban Ä‘áº§u báº±ng pipeline Safe RLHF trong ba chu ká»³. Má»—i chu ká»³ bao gá»“m Red Teaming (loáº¡i trá»« vÃ²ng Ä‘áº§u tiÃªn), táº¡o vÃ  chÃº thÃ­ch dá»¯ liá»‡u sá»Ÿ thÃ­ch con ngÆ°á»i, huáº¥n luyá»‡n MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng vÃ  MÃ´ hÃ¬nh Chi phÃ­, vÃ  tinh chá»‰nh Safe RL. Chi tiáº¿t thá»±c hiá»‡n vÃ  cÃ¡c siÃªu tham sá»‘ huáº¥n luyá»‡n cÃ³ sáºµn trong Phá»¥ lá»¥c B vÃ  Phá»¥ lá»¥c C.1.

MÃ´ hÃ¬nh SFT ban Ä‘áº§u. CÃ¡c thá»±c nghiá»‡m chÃ­nh cá»§a chÃºng tÃ´i báº¯t Ä‘áº§u vá»›i mÃ´ hÃ¬nh Alpaca-7B (tÃ¡i táº¡o). MÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c dáº«n xuáº¥t tá»« viá»‡c tinh chá»‰nh hÆ°á»›ng dáº«n LLaMA-7B (Touvron et al., 2023a) sá»­ dá»¥ng táº­p dá»¯ liá»‡u mÃ£ nguá»“n má»Ÿ Alpaca (Taori et al., 2023), tá»± hÃ o vá»›i 52K trÆ°á»ng há»£p tuÃ¢n theo hÆ°á»›ng dáº«n. ChÃºng tÃ´i chá»n Alpaca-7B lÃ m mÃ´ hÃ¬nh ban Ä‘áº§u vÃ¬ hai lÃ½ do chÃ­nh. Äáº§u tiÃªn, Alpaca-7B thá»ƒ hiá»‡n cÃ¡c kháº£ nÄƒng trá»£ lÃ½ chat thiáº¿t yáº¿u vÃ  cÃ³ kÃ­ch thÆ°á»›c mÃ´ hÃ¬nh phÃ¹ há»£p, táº¡o Ä‘iá»u kiá»‡n cho viá»‡c thá»±c hiá»‡n Ä‘áº§y Ä‘á»§ pipeline Safe RLHF. Thá»© hai, Alpaca-7B cÃ³ kháº£ nÄƒng táº¡o ra cáº£ pháº£n há»“i vÃ´ háº¡i vÃ  cÃ³ thá»ƒ cÃ³ háº¡i, cung cáº¥p cÃ¡c pháº£n há»“i Ä‘a dáº¡ng cho cÃ¡c prompt giá»‘ng há»‡t nhau, nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 3b. Sá»­ dá»¥ng Alpaca-7B lÃ m Ä‘iá»ƒm xuáº¥t phÃ¡t trong nhiá»u láº§n tinh chá»‰nh RL láº·p Ä‘i láº·p láº¡i cho phÃ©p chÃºng tÃ´i nháº­n biáº¿t rÃµ rÃ ng hÆ¡n cÃ¡c cáº£i thiá»‡n trong an toÃ n vÃ  tiá»‡n Ã­ch cá»§a LLM khi sá»­ dá»¥ng pipeline Safe RLHF.

Prompt vÃ  Red-teaming. á» Ä‘áº§u má»—i láº§n láº·p Safe RLHF, chÃºng tÃ´i Ä‘iá»u chá»‰nh há»—n há»£p cÃ¡c loáº¡i prompt khÃ¡c nhau Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n (khÃ´ng liÃªn quan Ä‘áº¿n an toÃ n, liÃªn quan Ä‘áº¿n an toÃ n Ä‘Ã£ giáº£i quyáº¿t, liÃªn quan Ä‘áº¿n an toÃ n chÆ°a giáº£i quyáº¿t, vÃ  nhá»¯ng prompt Ä‘Æ°á»£c thu tháº­p thÃ´ng qua red-teaming), nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 3a. Táº­p dá»¯ liá»‡u prompt nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o táº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch vÃ  cho huáº¥n luyá»‡n RL. Äá»‘i vá»›i láº§n láº·p Safe RLHF Ä‘áº§u tiÃªn, cÃ¡c prompt cá»§a chÃºng tÃ´i chá»§ yáº¿u Ä‘Æ°á»£c láº¥y tá»« cÃ¡c táº­p dá»¯ liá»‡u liÃªn quan Ä‘áº¿n an toÃ n mÃ£ nguá»“n má»Ÿ Ä‘Æ°á»£c tham chiáº¿u trong Ganguli et al. (2022) vÃ  Sun et al. (2023a). Tá»« láº§n láº·p thá»© hai, chÃºng tÃ´i Ä‘Ã£ Ğ¿Ñ€Ğ¸Ğ²Ğ»ekĞ°Ñ‚ÑŒ cÃ¡c nhÃ  nghiÃªn cá»©u thá»±c hiá»‡n cÃ¡c cuá»™c táº¥n cÃ´ng red-teaming Ä‘á»ƒ má»Ÿ rá»™ng táº­p prompt cá»§a chÃºng tÃ´i. Báº±ng cÃ¡ch kiá»ƒm tra cÃ¡c cuá»™c táº¥n cÃ´ng thÃ nh cÃ´ng, chÃºng tÃ´i Ä‘Ã£ xÃ¡c Ä‘á»‹nh vÃ  thÃªm cÃ¡c prompt Ä‘á»ƒ lá»™ ra cÃ¡c lá»— há»•ng khÃ´ng cÃ³ trong táº­p dá»¯ liá»‡u gá»‘c. ThÃªm chi tiáº¿t vÃ  vÃ­ dá»¥ cÃ³ sáºµn trong Phá»¥ lá»¥c D.

--- TRANG 7 ---
[HÃ¬nh 4a, 4b, 4c, 4d Ä‘Æ°á»£c mÃ´ táº£ trong vÄƒn báº£n gá»‘c]

HÃ¬nh 4: CÃ¡c biá»ƒu Ä‘á»“ phÃ¢n tÃ¡n trÃ¬nh bÃ y phÃ¢n phá»‘i pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ trÃªn táº­p prompt Ä‘Ã¡nh giÃ¡, nhÆ° Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi cÃ¡c mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ thá»‘ng nháº¥t. Táº¥t cáº£ bá»‘n mÃ´ hÃ¬nh sá»­ dá»¥ng cÃ¹ng má»™t táº­p prompt lÃ m Ä‘áº§u vÃ o, táº¡o pháº£n há»“i thÃ´ng qua tÃ¬m kiáº¿m tham lam. Má»—i Ä‘iá»ƒm biá»ƒu thá»‹ cÃ¡c giÃ¡ trá»‹ pháº§n thÆ°á»Ÿng/chi phÃ­ liÃªn quan Ä‘áº¿n má»™t máº«u, bao gá»“m prompt vÃ  pháº£n há»“i tÆ°Æ¡ng á»©ng.

Táº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch. Sau khi hoÃ n thiá»‡n cÃ¡c prompt, cÃ¡c pháº£n há»“i Ä‘Æ°á»£c táº¡o báº±ng mÃ´ hÃ¬nh Ä‘ang huáº¥n luyá»‡n. Nhá»¯ng pháº£n há»“i nÃ y sau Ä‘Ã³ Ä‘Æ°á»£c gá»­i Ä‘áº¿n ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng Ä‘á»ƒ gáº¯n nhÃ£n. ChÃºng tÃ´i cho phÃ©p ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng gáº¯n nhÃ£n tá»‰ má»‰ cÃ¡c cáº·p sá»Ÿ thÃ­ch khÃ´ng há»£p lá»‡. Má»—i prompt sáº½ nháº­n Ä‘Æ°á»£c k = 3âˆ¼6 pháº£n há»“i duy nháº¥t, dáº«n Ä‘áº¿n C_k^2 = k(k-1)/2 cáº·p sá»Ÿ thÃ­ch, nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 3b. Theo sÆ¡ Ä‘á»“ chÃº thÃ­ch mÃ  chÃºng tÃ´i thiáº¿t káº¿ trong Pháº§n 3.1, chÃºng tÃ´i thu Ä‘Æ°á»£c cÃ¡c táº­p dá»¯ liá»‡u tÃ¡ch biá»‡t cho tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. ThÃªm chi tiáº¿t vÃ  vÃ­ dá»¥ cÃ³ sáºµn trong Phá»¥ lá»¥c A.

Táº­p dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡. Do thiáº¿u cÃ¡c táº­p dá»¯ liá»‡u Ä‘Ã¡nh giÃ¡ xem xÃ©t cáº£ tÃ­nh há»¯u Ã­ch vÃ  cÄƒn chá»‰nh an toÃ n, chÃºng tÃ´i Ä‘Ã£ xÃ¢y dá»±ng táº­p dá»¯ liá»‡u prompt Ä‘Ã¡nh giÃ¡ riÃªng, bao gá»“m 3 pháº§n: prompt Ä‘Æ°á»£c thiáº¿t káº¿ tá»‰ má»‰ cho 14 danh má»¥c an toÃ n, prompt cÃ³ nguá»“n gá»‘c tá»« cÃ¡c táº­p dá»¯ liá»‡u mÃ£ nguá»“n má»Ÿ (loáº¡i trá»« khá»i huáº¥n luyá»‡n), vÃ  10% prompt Ä‘Æ°á»£c chá»n tá»« má»—i giai Ä‘oáº¡n red-teaming. Äá»‹nh nghÄ©a cá»§a 14 danh má»¥c an toÃ n Ä‘Æ°á»£c nÃªu chi tiáº¿t trong Phá»¥ lá»¥c A.3.

4.2 Káº¾T QUáº¢ THá»°C NGHIá»†M

4.2.1 ÄÃNH GIÃ TÃNH Há»®U ÃCH VÃ€ TÃNH VÃ” Háº I

Äá»ƒ Ä‘Ã¡nh giÃ¡ nghiÃªm ngáº·t hiá»‡u quáº£ cá»§a pipeline Safe RLHF cá»§a chÃºng tÃ´i theo hai chiá»u cÄƒn chá»‰nh â€” tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i â€” chÃºng tÃ´i phÃ¢n tÃ­ch cÃ¡c mÃ´ hÃ¬nh tá»« ba láº§n láº·p Safe RLHF: Beaver-v1, Beaver-v2, vÃ  Beaver-v3.

Tuy nhiÃªn, viá»‡c Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n luÃ´n lÃ  má»™t váº¥n Ä‘á» thÃ¡ch thá»©c vÃ  chÆ°a Ä‘Æ°á»£c giáº£i quyáº¿t. CÃ¡c benchmark truyá»n thá»‘ng thÆ°á»ng khÃ´ng náº¯m báº¯t Ä‘Æ°á»£c toÃ n bá»™ má»©c Ä‘á»™ mÃ  má»™t mÃ´ hÃ¬nh cÄƒn chá»‰nh vá»›i cÃ¡c giÃ¡ trá»‹ con ngÆ°á»i. Thiáº¿u sÃ³t nÃ y chá»§ yáº¿u do cÃ¡c tiÃªu chuáº©n khÃ´ng nháº¥t quÃ¡n vÃ  káº¿t quáº£ rÃµ rÃ ng trong Ä‘Ã¡nh giÃ¡ cÄƒn chá»‰nh con ngÆ°á»i. Do Ä‘Ã³, chÃºng tÃ´i Æ°a thÃ­ch Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n dá»±a trÃªn pháº£n há»“i cá»§a chÃºng Ä‘á»‘i vá»›i cÃ¡c prompt cá»¥ thá»ƒ. ChÃºng tÃ´i sá»­ dá»¥ng hai phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ tá»•ng thá»ƒ. Bao gá»“m Ä‘Ã¡nh giÃ¡ nhanh cÃ¡c mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i báº±ng MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng vÃ  MÃ´ hÃ¬nh Chi phÃ­ thá»‘ng nháº¥t Ä‘Ã£ huáº¥n luyá»‡n; dáº«n xuáº¥t Ä‘iá»ƒm Elo báº±ng cÃ¡ch so sÃ¡nh Ä‘áº§u ra mÃ´ hÃ¬nh vá»›i Ä‘Ã¡nh giÃ¡ cá»§a con ngÆ°á»i vÃ  GPT-4.

ÄÃ¡nh giÃ¡ dá»±a trÃªn mÃ´ hÃ¬nh. Máº·c dÃ¹ Ä‘Ã¡nh giÃ¡ con ngÆ°á»i váº«n lÃ  tiÃªu chuáº©n vÃ ng Ä‘á»ƒ cÄƒn chá»‰nh cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n vá»›i cÃ¡c giÃ¡ trá»‹ con ngÆ°á»i, viá»‡c dá»±a vÃ o phÆ°Æ¡ng phÃ¡p nÃ y má»™t mÃ¬nh khÃ´ng thá»±c táº¿ cÅ©ng khÃ´ng hiá»‡u quáº£ do chi phÃ­ thá»i gian vÃ  tÃ i chÃ­nh Ä‘Ã¡ng ká»ƒ liÃªn quan. Nhá»¯ng háº¡n cháº¿ nhÆ° váº­y Ä‘Ã²i há»i cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Ã¡nh giÃ¡ thay tháº¿ Ä‘á»ƒ bá»• sung cho Ä‘Ã¡nh giÃ¡ con ngÆ°á»i. Do Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ phÃ¡t triá»ƒn má»™t MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng thá»‘ng nháº¥t vÃ  má»™t MÃ´ hÃ¬nh Chi phÃ­ thá»‘ng nháº¥t, sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p huáº¥n luyá»‡n Ä‘Æ°á»£c Ä‘á» cáº­p trong Pháº§n 3.2. Nhá»¯ng mÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn dá»¯ liá»‡u sá»Ÿ thÃ­ch cÃ¢n báº±ng Ä‘á»u cÃ³ nguá»“n gá»‘c tá»« táº¥t cáº£ cÃ¡c láº§n láº·p Safe RLHF. Vá»›i nhá»¯ng mÃ´ hÃ¬nh thá»‘ng nháº¥t nÃ y, chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ nhanh chÃ³ng cÃ¡c mÃ´ hÃ¬nh má»›i tiáº¿p theo dÆ°á»›i cÃ¡c tiÃªu chÃ­ nháº¥t quÃ¡n. Äá»™ chÃ­nh xÃ¡c thá»­ nghiá»‡m cho cÃ¡c mÃ´ hÃ¬nh thá»‘ng nháº¥t Ä‘Æ°á»£c nÃªu chi tiáº¿t trong Báº£ng 1. LÆ°u Ã½ ráº±ng chÃºng tÃ´i khÃ´ng sá»­ dá»¥ng nhá»¯ng mÃ´ hÃ¬nh thá»‘ng nháº¥t nÃ y Ä‘á»ƒ huáº¥n luyá»‡n má»™t quy trÃ¬nh Safe RLHF vÃ²ng Ä‘Æ¡n, vÃ¬ viá»‡c thu tháº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch diá»…n ra láº·p Ä‘i láº·p láº¡i. ChÃºng tÃ´i cáº§n cÃ¡c mÃ´ hÃ¬nh trung gian cho quy trÃ¬nh red-teaming, táº¡o Ä‘iá»u kiá»‡n thu tháº­p cÃ¡c prompt má»›i cho cÃ¡c giai Ä‘oáº¡n huáº¥n luyá»‡n tiáº¿p theo.

NhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 4, mÃ´ hÃ¬nh SFT cá»§a chÃºng tÃ´i, mÃ´ hÃ¬nh Alpaca-7B (tÃ¡i táº¡o), cÃ³ kháº£ nÄƒng táº¡o ra cáº£ pháº£n há»“i vÃ´ háº¡i vÃ  cÃ³ háº¡i gáº§n nhÆ° Ä‘Æ°á»£c tÃ¡ch biá»‡t Ä‘á»u á»Ÿ má»—i bÃªn cá»§a Ä‘Æ°á»ng phÃ¢n chia c = 0 (HÃ¬nh 4a). Sau vÃ²ng huáº¥n luyá»‡n Safe RLHF Ä‘áº§u tiÃªn, cÃ³ sá»± dá»‹ch chuyá»ƒn Ä‘Ã¡ng ká»ƒ trong phÃ¢n phá»‘i pháº£n há»“i mÃ´ hÃ¬nh vá» phÃ­a bÃªn cÃ³ chi phÃ­ tháº¥p hÆ¡n, ngá»¥ Ã½ Ä‘áº§u ra an toÃ n hÆ¡n (HÃ¬nh 4b). Trong láº§n láº·p thá»© hai cá»§a Safe RLHF, cÃ³ sá»± giáº£m ná»™i dung cÃ³ háº¡i, Ä‘Æ°á»£c kÃ½ hiá»‡u bá»Ÿi vÃ¹ng c > 0 (HÃ¬nh 4c). Trong láº§n láº·p cuá»‘i cÃ¹ng, cá»¥m dá»¯ liá»‡u hÆ°á»›ng vá» hÆ°á»›ng pháº§n thÆ°á»Ÿng cao hÆ¡n, trong khi thÃ nh cÃ´ng duy trÃ¬ pháº§n lá»›n cÃ¡c pháº£n há»“i lÃ  vÃ´ háº¡i (HÃ¬nh 4d).

ÄÃ¡nh giÃ¡ GPT-4 vÃ  con ngÆ°á»i. Äá»ƒ Ä‘Ã¡nh giÃ¡ chÃ­nh xÃ¡c hÆ¡n, chÃºng tÃ´i so sÃ¡nh cÃ¡c mÃ´ hÃ¬nh vá»›i nhau Ä‘á»ƒ táº¡o ra cÃ¡c Ä‘iá»ƒm Elo liÃªn quan, nhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong Askell et al. (2021). Cá»¥ thá»ƒ, cÃ¡c Ä‘Ã¡nh giÃ¡ viÃªn so sÃ¡nh Ä‘áº§u ra cá»§a hai mÃ´ hÃ¬nh Ä‘á»ƒ pháº£n há»“i cÃ¹ng má»™t prompt vÃ  cung cáº¥p sá»Ÿ thÃ­ch cá»§a há» vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. Sau khi thu Ä‘Æ°á»£c má»‘i quan há»‡ tá»· lá»‡ tháº¯ng cáº·p giá»¯a táº¥t cáº£ cÃ¡c mÃ´ hÃ¬nh, chÃºng tÃ´i khá»›p cÃ¡c Ä‘iá»ƒm Elo tÆ°Æ¡ng á»©ng (vá»›i Ä‘iá»ƒm ban Ä‘áº§u lÃ  1200). Theo Chiang & Lee (2023), GPT-4 cÃ³ thá»ƒ thay tháº¿ cÃ¡c Ä‘Ã¡nh giÃ¡ viÃªn con ngÆ°á»i trong viá»‡c Ä‘Ã¡nh giÃ¡ kháº£ nÄƒng cÄƒn chá»‰nh cá»§a LLM. Do Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ tá»• chá»©c cÃ¡c Ä‘Ã¡nh giÃ¡ liÃªn quan Ä‘áº¿n cáº£ Ä‘Ã¡nh giÃ¡ viÃªn GPT-4 vÃ  con ngÆ°á»i.

NhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 5a vÃ  5b, ba vÃ²ng Safe RLHF Ä‘Ã£ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ Ä‘iá»ƒm Elo trong cáº£ tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i, nhÆ° Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi cáº£ Ä‘Ã¡nh giÃ¡ viÃªn GPT-4 vÃ  con ngÆ°á»i. Khi so sÃ¡nh vá»›i Alpaca-7B, mÃ´ hÃ¬nh Beaver-v3 Ä‘Ã£ chá»©ng minh sá»± gia tÄƒng Ä‘iá»ƒm Elo cho tÃ­nh há»¯u Ã­ch (GPT-4: +244.91, Con ngÆ°á»i: +363.86) vÃ  cho tÃ­nh vÃ´ háº¡i (GPT-4: +268.31, Con ngÆ°á»i: +237.98). TÆ°Æ¡ng Ä‘á»‘i, cÃ¡c Ä‘Ã¡nh giÃ¡ bá»Ÿi GPT-4 vÃ  Ä‘Ã¡nh giÃ¡ viÃªn con ngÆ°á»i gáº§n nhÆ° nháº¥t quÃ¡n. ÄÃ¡ng chÃº Ã½, báº¯t Ä‘áº§u tá»« vÃ²ng thá»© hai, chÃºng tÃ´i khá»Ÿi xÆ°á»›ng cÃ¡c cuá»™c táº¥n cÃ´ng red teaming Ä‘á»ƒ má»Ÿ rá»™ng pháº¡m vi cÃ¡c prompt liÃªn quan Ä‘áº¿n an toÃ n. Äiá»u nÃ y giÃºp hiá»‡u quáº£ trong viá»‡c lÃ m cho cÃ¡c mÃ´ hÃ¬nh huáº¥n luyá»‡n Safe RLHF trá»Ÿ nÃªn vÃ´ háº¡i hÆ¡n. Trong vÃ²ng thá»© ba, vÃ¬ mÃ´ hÃ¬nh Ä‘Ã£ Ä‘á»§ an toÃ n, Safe RLHF cÃ³ xu hÆ°á»›ng Æ°u tiÃªn duy trÃ¬ má»©c Ä‘á»™ vÃ´ háº¡i hiá»‡n táº¡i hÆ¡n lÃ  tá»‘i Æ°u hÃ³a quÃ¡ má»©c. Äiá»u nÃ y cÅ©ng pháº£n Ã¡nh cÃ¡c Ä‘áº·c tÃ­nh Ä‘iá»u chá»‰nh Ä‘á»™ng vá»‘n cÃ³ cá»§a Safe RLHF.

Trong khi Ä‘Ã³, ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng cá»§a chÃºng tÃ´i cÅ©ng gáº¯n nhÃ£n liá»‡u cÃ¡c pháº£n há»“i cá»§a mÃ´ hÃ¬nh cÃ³ an toÃ n hay khÃ´ng, nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 5c. ThÃ´ng qua ba vÃ²ng huáº¥n luyá»‡n Safe RLHF, xÃ¡c suáº¥t pháº£n há»“i cÃ³ háº¡i cá»§a mÃ´ hÃ¬nh Beaver-v3 trÃªn táº­p Ä‘Ã¡nh giÃ¡ Ä‘Ã£ giáº£m tá»« 53.08% Ä‘á»‘i vá»›i Alpaca-7B xuá»‘ng 2.45%. Äá»‘i vá»›i cÃ¡c prompt cá»¥ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong Ä‘Ã¡nh giÃ¡ GPT-4, vui lÃ²ng tham kháº£o Phá»¥ lá»¥c C.2.

4.2.2 VIá»†C TÃCH BIá»†T TÃNH VÃ” Háº I VÃ€ TÃNH Há»®U ÃCH

Trong pháº§n nÃ y, chÃºng tÃ´i nháº±m chá»©ng minh lá»£i Ã­ch cá»§a viá»‡c tÃ¡ch biá»‡t rÃµ rÃ ng tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch trong pipeline Safe RLHF. ChÃºng tÃ´i sá»­ dá»¥ng cÃ¡c pháº£n há»“i Ä‘Æ°á»£c thu tháº­p tá»« vÃ²ng Ä‘áº§u tiÃªn cá»§a Safe RLHF Ä‘á»ƒ thá»±c hiá»‡n gáº¯n nhÃ£n sá»Ÿ thÃ­ch vÃ  huáº¥n luyá»‡n PPO theo phÆ°Æ¡ng phÃ¡p RLHF thÃ´ng thÆ°á»ng. Trong quÃ¡ trÃ¬nh gáº¯n nhÃ£n sá»Ÿ thÃ­ch, Ä‘iá»ƒm khÃ¡c biá»‡t lÃ  chá»‰ cung cáº¥p má»™t sá»Ÿ thÃ­ch toÃ n diá»‡n, trong khi cÃ¡c khÃ­a cáº¡nh khÃ¡c cÄƒn chá»‰nh vá»›i Safe RLHF.

So vá»›i chÃº thÃ­ch vÃ  huáº¥n luyá»‡n má»™t chiá»u, chÃºng tÃ´i quan sÃ¡t cÃ¡c lá»£i tháº¿ sau cá»§a Safe RLHF: Äáº§u tiÃªn, viá»‡c tÃ¡ch biá»‡t cÃ¡c chÃº thÃ­ch cho tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i dáº«n Ä‘áº¿n Tá»· lá»‡ Thá»a thuáº­n Giá»¯a cÃ¡c ÄÃ¡nh giÃ¡ viÃªn cao hÆ¡n trong sá»‘ ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng, Ä‘Ã³ lÃ  TÃ­nh há»¯u Ã­ch: 69.00% vÃ  An toÃ n: 66.53% so vá»›i 61.65%. Thá»© hai, sá»± thá»a thuáº­n giá»¯a ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng vÃ  cÃ¡c nhÃ  nghiÃªn cá»©u (tá»©c lÃ  tá»· lá»‡ phÃª duyá»‡t) cÅ©ng Ä‘Æ°á»£c tÄƒng lÃªn. Trong chÃº thÃ­ch má»™t chiá»u, tá»· lá»‡ phÃª duyá»‡t trung bÃ¬nh trong quÃ¡ trÃ¬nh kiá»ƒm tra cháº¥t lÆ°á»£ng 10% giáº£m tá»« Ã­t nháº¥t 90% Ä‘á»™ chÃ­nh xÃ¡c xuá»‘ng dÆ°á»›i 80%. Thá»© ba, nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 6a, viá»‡c sá»­ dá»¥ng dá»¯ liá»‡u trÃªn cho huáº¥n luyá»‡n PPO dáº«n Ä‘áº¿n cáº£i thiá»‡n Ä‘Ã¡ng chÃº Ã½ trong tÃ­nh há»¯u Ã­ch. Tuy nhiÃªn, viá»‡c tÄƒng cÆ°á»ng tÃ­nh vÃ´ háº¡i Ã­t hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i nhá»¯ng gÃ¬ Ä‘áº¡t Ä‘Æ°á»£c bá»Ÿi Safe RLHF. NgÆ°á»£c láº¡i, Safe RLHF cho phÃ©p Ä‘iá»u chá»‰nh chá»§ quan trong giai Ä‘oáº¡n huáº¥n luyá»‡n Ä‘á»ƒ cÃ¢n báº±ng tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i.

--- TRANG 8 ---
[Báº£ng 1 vÃ  cÃ¡c hÃ¬nh Ä‘Æ°á»£c mÃ´ táº£ trong vÄƒn báº£n gá»‘c]

Báº£ng 1: Äá»™ chÃ­nh xÃ¡c thá»­ nghiá»‡m cho MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng vÃ  MÃ´ hÃ¬nh Chi phÃ­ cho ba giai Ä‘oáº¡n huáº¥n luyá»‡n Safe RLHF. CÃ¡c mÃ´ hÃ¬nh sá»Ÿ thÃ­ch thá»‘ng nháº¥t Ä‘Æ°á»£c huáº¥n luyá»‡n vÃ  thá»­ nghiá»‡m trÃªn dá»¯ liá»‡u sá»Ÿ thÃ­ch cÃ¢n báº±ng Ä‘á»u tá»« táº­p dá»¯ liá»‡u sá»Ÿ thÃ­ch Ä‘Æ°á»£c sá»­ dá»¥ng trong ba láº§n láº·p Safe RLHF.

MÃ´ hÃ¬nh | Metric | Beaver-v1 | Beaver-v2 | Beaver-v3 | Thá»‘ng nháº¥t
---|---|---|---|---|---
MÃ´ hÃ¬nh Pháº§n thÆ°á»Ÿng | Äá»™ chÃ­nh xÃ¡c Xáº¿p háº¡ng | 78.13% | 75.73% | 77.32% | 73.95%
MÃ´ hÃ¬nh Chi phÃ­ | Äá»™ chÃ­nh xÃ¡c Xáº¿p háº¡ng | 74.47% | 76.07% | 74.17% | 70.44%
 | Äá»™ chÃ­nh xÃ¡c PhÃ¢n loáº¡i An toÃ n | 95.62% | 84.54% | 85.88% | 85.83%

--- TRANG 9 ---
[HÃ¬nh 5a, 5b, 5c vÃ  HÃ¬nh 6a, 6b, 6c Ä‘Æ°á»£c mÃ´ táº£ trong vÄƒn báº£n gá»‘c]

HÃ¬nh 5: (a) Äiá»ƒm Elo vá» tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch cho Alpaca-7B, vÃ  cÃ¡c mÃ´ hÃ¬nh Beaver-v1 Ä‘áº¿n Beaver-v3. So sÃ¡nh mÃ´ hÃ¬nh cáº·p Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi GPT-4. (b) Äiá»ƒm Elo vá» tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch cho Alpaca-7B, vÃ  cÃ¡c mÃ´ hÃ¬nh Beaver-v1 Ä‘áº¿n Beaver-v3. So sÃ¡nh mÃ´ hÃ¬nh cáº·p Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi Con ngÆ°á»i. (c) Tá»· lá»‡ pháº£n há»“i mÃ´ hÃ¬nh Ä‘Æ°á»£c gáº¯n cá» vÃ´ háº¡i bá»Ÿi con ngÆ°á»i trÃªn táº­p Ä‘Ã¡nh giÃ¡. LÆ¯U Ã: Äiá»ƒm Elo trong (a) (b) cho mÃ´ hÃ¬nh Alpaca-7B Ä‘Æ°á»£c chuáº©n hÃ³a thá»§ cÃ´ng thÃ nh 1000.

HÃ¬nh 6: (a) Tá»· lá»‡ tháº¯ng vá» tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch cho Safe RLHF vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c so vá»›i mÃ´ hÃ¬nh SFT (Alpaca-7B). ÄÆ°á»ng cong Ä‘á»©t nÃ©t lÃ  Ä‘Æ°á»ng cong tiá»‡m cáº­n cho cÃ¡c phÆ°Æ¡ng phÃ¡p reward shaping (RS) nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong (b). (b) Tá»· lá»‡ tháº¯ng vá» tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch cho Safe RLHF vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p reward shaping (RS) vá»›i cÃ¡c há»‡ sá»‘ khÃ¡c nhau so vá»›i mÃ´ hÃ¬nh SFT (Alpaca-7B). (c) ÄÆ°á»ng cong huáº¥n luyá»‡n cho nhÃ¢n tá»­ Lagrange Î» vÃ  chi phÃ­ trung bÃ¬nh di Ä‘á»™ng trong láº§n láº·p Safe RLHF Ä‘áº§u tiÃªn. LÆ¯U Ã: Tá»· lá»‡ tháº¯ng vá» tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch trong (a) (b) Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ bá»Ÿi GPT-4.

4.2.3 CÃ‚N Báº°NG GIá»®A Má»¤C TIÃŠU TÃNH VÃ” Háº I VÃ€ Má»¤C TIÃŠU TÃNH Há»®U ÃCH

Äá»ƒ nháº¥n máº¡nh táº§m quan trá»ng cá»§a viá»‡c cÃ¢n báº±ng Ä‘á»™ng cÃ¡c má»¥c tiÃªu tÃ­nh vÃ´ háº¡i vÃ  tÃ­nh há»¯u Ã­ch trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n RL, chÃºng tÃ´i so sÃ¡nh Safe RLHF vá»›i phÆ°Æ¡ng phÃ¡p reward shaping (RS) sá»­ dá»¥ng cÃ¢n báº±ng tÄ©nh. Cá»¥ thá»ƒ, phÆ°Æ¡ng phÃ¡p reward shaping Ä‘á» cáº­p Ä‘áº¿n viá»‡c cÃ¢n nháº¯c hai hÃ m má»¥c tiÃªu á»Ÿ tá»· lá»‡ cá»‘ Ä‘á»‹nh trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n RL, tá»©c lÃ  R_Î½(y, x) = R_Ï•(y, x) - Î½ Â· C_Ïˆ(y, x). CÃ¡c thá»±c nghiá»‡m cá»§a chÃºng tÃ´i Ä‘Ã£ thá»­ nghiá»‡m rá»™ng rÃ£i báº£y trá»ng sá»‘ reward shaping khÃ¡c nhau Î½, cá»¥ thá»ƒ lÃ  0.01, 0.5, 1, 2, 5, 10, vÃ  100.

Káº¿t quáº£ huáº¥n luyá»‡n Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 6b. Hai káº¿t luáº­n cÃ³ thá»ƒ Ä‘Æ°á»£c rÃºt ra tá»« cÃ¡c quan sÃ¡t: trá»ng sá»‘ reward shaping quÃ¡ cao (Î½ = 5,10,100) vÃ  quÃ¡ tháº¥p (Î½ = 0.01,0.5) dáº«n Ä‘áº¿n tá»‘i Æ°u hÃ³a quÃ¡ má»©c má»™t má»¥c tiÃªu vá»›i sá»± hy sinh cá»§a má»¥c tiÃªu khÃ¡c. Trá»ng sá»‘ reward shaping vá»«a pháº£i (Î½ = 1,2) váº«n khÃ´ng thá»ƒ giáº£i quyáº¿t hiá»‡u quáº£ sá»± cÄƒng tháº³ng giá»¯a cÃ¡c má»¥c tiÃªu tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i, vá»›i cÃ¡c cáº£i thiá»‡n cá»§a chÃºng váº«n kÃ©m hÆ¡n Safe RLHF.

TÆ°Æ¡ng Ä‘á»‘i, Safe RLHF Ä‘Ã¡nh giÃ¡ tÃ­nh vÃ´ háº¡i cá»§a cÃ¡c mÃ´ hÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c giÃ¡ trá»‹ chi phÃ­ trung bÃ¬nh, sau Ä‘Ã³ cáº­p nháº­t nhÃ¢n tá»­ Lagrange Î». Khi mÃ´ hÃ¬nh thá»a mÃ£n cÃ¡c rÃ ng buá»™c an toÃ n, Safe RLHF sá»­ dá»¥ng nhÃ¢n tá»­ Lagrange nhá» hÆ¡n Ä‘á»ƒ báº£o tá»“n tÃ­nh vÃ´ háº¡i Î», tá»« Ä‘Ã³ trÃ¡nh tá»‘i Æ°u hÃ³a quÃ¡ má»©c, nhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 6c.

4.2.4 THIáº¾T Káº¾ MÃ” HÃŒNH Sá» THÃCH CHI PHÃ

Má»™t thiáº¿t káº¿ quan trá»ng cá»§a Safe RLHF lÃ  MÃ´ hÃ¬nh Chi phÃ­, Ä‘á»“ng thá»i khá»›p cáº£ sá»Ÿ thÃ­ch con ngÆ°á»i vÃ  nhÃ£n an toÃ n. Sá»Ÿ thÃ­ch con ngÆ°á»i cung cáº¥p hÆ°á»›ng cho tá»‘i Æ°u hÃ³a, trong khi dá»± Ä‘oÃ¡n nhÃ£n an toÃ n táº¡o Ä‘iá»u kiá»‡n cho sá»± cÃ¢n báº±ng Ä‘á»™ng cá»§a cÃ¡c má»¥c tiÃªu tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. Sá»± tÃ­ch há»£p thÃ nh cÃ´ng nÃ y Ä‘Ã³ng gÃ³p vÃ o thÃ nh cÃ´ng cá»§a Safe RLHF. Äá»ƒ chá»©ng minh Ä‘iá»u nÃ y, chÃºng tÃ´i Ä‘Ã£ so sÃ¡nh Safe RLHF vá»›i viá»‡c huáº¥n luyá»‡n sá»­ dá»¥ng logits cá»§a má»™t bá»™ phÃ¢n loáº¡i an toÃ n lÃ m tÃ­n hiá»‡u chi phÃ­ (Glaese et al., 2022). NhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 6a (CM-classifier), hiá»‡u quáº£ cá»§a phÆ°Æ¡ng phÃ¡p sau trong viá»‡c cáº£i thiá»‡n tÃ­nh vÃ´ háº¡i kÃ©m hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i Safe RLHF. Máº·t khÃ¡c, viá»‡c loáº¡i bá» kháº£ nÄƒng phÃ¢n loáº¡i cá»§a MÃ´ hÃ¬nh Chi phÃ­, vÃ  khÃ´ng cáº­p nháº­t cÃ¡c nhÃ¢n tá»­ Lagrange, dáº«n Ä‘áº¿n sá»± suy giáº£m thÃ nh phÆ°Æ¡ng phÃ¡p Reward Shaping.

5 CÃC NGHIÃŠN Cá»¨U LIÃŠN QUAN

MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n (LLM) Sá»± phÃ¡t triá»ƒn cá»§a LLM Ä‘Ã£ lÃ  má»™t lÄ©nh vá»±c nghiÃªn cá»©u quan trá»ng trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y. Pháº§n nÃ y tháº£o luáº­n vá» cÃ¡c nghiÃªn cá»©u liÃªn quan tá»« gÃ³c Ä‘á»™ cá»§a ba giai Ä‘oáº¡n huáº¥n luyá»‡n LLM. CÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n nhÆ° T5 (Raffel et al., 2020), GPT-3 (Brown et al., 2020), BLOOM (Scao et al., 2022), vÃ  LLaMA (Touvron et al., 2023a;b) Ä‘Æ°á»£c tiáº¿p xÃºc vá»›i má»™t kho dá»¯ liá»‡u vÄƒn báº£n khÃ´ng nhÃ£n khá»•ng lá»“ vÃ  Ä‘Æ°á»£c huáº¥n luyá»‡n sá»­ dá»¥ng cÃ¡c má»¥c tiÃªu há»c khÃ´ng giÃ¡m sÃ¡t, cháº³ng háº¡n nhÆ° dá»± Ä‘oÃ¡n tá»« tiáº¿p theo trong má»™t chuá»—i. Tinh chá»‰nh HÆ°á»›ng dáº«n (IFT) Ä‘Ã£ Ä‘Æ°á»£c khÃ¡m phÃ¡ vá»›i cÃ¡c mÃ´ hÃ¬nh nhÆ° T0 (Sanh et al., 2021), Flan-T5 (Chung et al., 2022), vÃ  Instruct-GPT (Ouyang et al., 2022). Nhá»¯ng mÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c tinh chá»‰nh tá»« cÃ¡c mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n sá»­ dá»¥ng dá»¯ liá»‡u cÃ³ nhÃ£n cá»¥ thá»ƒ cho nhiá»‡m vá»¥, má»™t bÆ°á»›c quan trá»ng Ä‘á»ƒ cÃ¡c mÃ´ hÃ¬nh tuÃ¢n theo hÆ°á»›ng dáº«n vÃ  hoÃ n thÃ nh nhiá»‡m vá»¥. Nhiá»u nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y Ä‘Ã£ khÃ¡m phÃ¡ cÃ¡c tÃ¡c háº¡i tiá»m áº©n cá»§a viá»‡c truy cáº­p cÃ´ng cá»™ng vÃ o LLM. Weidinger et al. (2021; 2022) phÃ¡c tháº£o sÃ¡u lÄ©nh vá»±c rá»§i ro Ä‘áº¡o Ä‘á»©c vÃ  xÃ£ há»™i liÃªn quan Ä‘áº¿n nhá»¯ng mÃ´ hÃ¬nh nÃ y. Rauh et al. (2022) phÃ¢n tÃ­ch cÃ¡c Ä‘áº·c tÃ­nh cá»§a vÄƒn báº£n cÃ³ háº¡i. Shevlane et al. (2023) tháº£o luáº­n vá» cÃ¡c rá»§i ro cá»±c Ä‘oan, bao gá»“m cÃ¡c kháº£ nÄƒng nguy hiá»ƒm vÃ  sá»± máº¥t cÄƒn chá»‰nh. Váº¥n Ä‘á» vá» thiÃªn kiáº¿n xÃ£ há»™i trong viá»‡c táº¡o ngÃ´n ngá»¯ Ä‘Æ°á»£c Sheng et al. (2021) giáº£i quyáº¿t, trong khi Abid et al. (2021) táº­p trung rÃµ rÃ ng vÃ o thiÃªn kiáº¿n báº¡o lá»±c-Há»“i giÃ¡o dai dáº³ng trong LLM. Deshpande et al. (2023) kiá»ƒm tra tÃ­nh Ä‘á»™c háº¡i trong ChatGPT, lÃ m ná»•i báº­t cÃ¡c váº¥n Ä‘á» nhÆ° cÃ¡c Ä‘á»‹nh kiáº¿n khÃ´ng chÃ­nh xÃ¡c, Ä‘á»‘i thoáº¡i cÃ³ háº¡i, vÃ  Ã½ kiáº¿n gÃ¢y tá»•n thÆ°Æ¡ng.

Há»c tÄƒng cÆ°á»ng tá»« pháº£n há»“i con ngÆ°á»i (RLHF) Trong khi LLM Ä‘Ã£ xuáº¥t sáº¯c trong cÃ¡c nhiá»‡m vá»¥ NLP khÃ¡c nhau, Ä‘Ã´i khi chÃºng thá»ƒ hiá»‡n cÃ¡c hÃ nh vi báº¥t ngá» nhÆ° táº¡o ra thÃ´ng tin khÃ´ng chÃ­nh xÃ¡c hoáº·c Ä‘Æ°a ra cÃ¡c pháº£n há»“i thiÃªn lá»‡ch, gÃ¢y hiá»ƒu láº§m vÃ  cÃ³ háº¡i (Bai et al., 2022a;b; KocoÅ„ et al., 2023; Sun et al., 2023b). RLHF cho phÃ©p LLM tiáº¿n bá»™ vá» cÃ¡c má»¥c tiÃªu Ä‘a dáº¡ng hÆ¡n báº±ng cÃ¡ch há»c tá»« pháº£n há»“i con ngÆ°á»i (Ouyang et al., 2022; Yuan et al., 2023; Rafailov et al., 2023; Song et al., 2023; Yang et al., 2023). Do thiÃªn kiáº¿n vÃ  nhiá»…u trong pháº£n há»“i con ngÆ°á»i (Wu et al., 2023), má»™t sá»‘ phÆ°Æ¡ng phÃ¡p tá»‘i Æ°u hÃ³a trÃªn má»™t sá»Ÿ thÃ­ch duy nháº¥t cÃ³ thá»ƒ dáº«n mÃ´ hÃ¬nh Ä‘áº¿n má»™t sá»‘ giáº£i phÃ¡p tá»‘i Æ°u Ä‘á»‹a phÆ°Æ¡ng (Casper et al., 2023). Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p hiá»‡n cÃ³ tinh chá»‰nh cÃ¡c thuá»™c tÃ­nh khÃ¡c nhau vÃ  sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh khÃ¡c nhau Ä‘á»ƒ khá»›p chÃºng. Dá»±a trÃªn nhá»¯ng mÃ´ hÃ¬nh nÃ y, LLM Ä‘Æ°á»£c hÆ°á»›ng dáº«n tinh chá»‰nh Ä‘á»ƒ Ä‘áº£m báº£o ráº±ng cÃ¡c mÃ´ hÃ¬nh tÃ­ch há»£p nhiá»u thuá»™c tÃ­nh. Tuy nhiÃªn, phÆ°Æ¡ng phÃ¡p nÃ y Ä‘Ã²i há»i Ä‘iá»u chá»‰nh thá»§ cÃ´ng trá»ng sá»‘ giá»¯a pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ (tÆ°Æ¡ng tá»± nhÆ° reward shaping) (Touvron et al., 2023b), khiáº¿n viá»‡c triá»ƒn khai nhanh chÃ³ng trong cÃ¡c tÃ¬nh huá»‘ng á»©ng dá»¥ng khÃ¡c nhau trá»Ÿ nÃªn thÃ¡ch thá»©c. NgÆ°á»£c láº¡i, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i tÃ¡ch biá»‡t Há»¯u Ã­ch vÃ  VÃ´ háº¡i, tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a pháº§n thÆ°á»Ÿng vÃ  chi phÃ­ dá»±a trÃªn cÃ¡c ngÆ°á»¡ng Ä‘Æ°á»£c Ä‘á»‹nh trÆ°á»›c, vÃ  Ä‘áº£m báº£o ráº±ng mÃ´ hÃ¬nh táº¡o ra cÃ¡c pháº£n há»“i cháº¥t lÆ°á»£ng cao trong khi cung cáº¥p má»©c Ä‘á»™ an toÃ n cao hÆ¡n. QuÃ¡ trÃ¬nh nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ rá»™ng cho cÃ¡c tÃ¬nh huá»‘ng vÆ°á»£t ra ngoÃ i Há»¯u Ã­ch vÃ  VÃ´ háº¡i.

6 Háº N CHáº¾ VÃ€ NGHIÃŠN Cá»¨U TÆ¯Æ NG LAI

NghiÃªn cá»©u nÃ y cÃ³ má»™t sá»‘ háº¡n cháº¿ Ä‘Ã¡ng chÃº Ã½. Má»™t háº¡n cháº¿ chÃ­nh lÃ  dá»¯ liá»‡u tiá»n huáº¥n luyá»‡n khÃ´ng thá»ƒ truy cáº­p; chÃºng tÃ´i Ä‘Ã£ sá»­ dá»¥ng Táº­p dá»¯ liá»‡u Stanford Alpaca (Taori et al., 2023) cho PTX loss (tham kháº£o Phá»¥ lá»¥c B.2 Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t) trong suá»‘t cáº£ ba vÃ²ng láº·p Safe RLHF. NgoÃ i ra, chÃºng tÃ´i khÃ´ng cÃ³ Ä‘Æ°á»£c má»™t kho dá»¯ liá»‡u SFT cháº¥t lÆ°á»£ng cao má»Ÿ rá»™ng, cÃ³ thá»ƒ tÄƒng cÆ°á»ng hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. Máº·c dÃ¹ cÄƒn chá»‰nh an toÃ n Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº¡t Ä‘Æ°á»£c thÃ´ng qua tinh chá»‰nh mÃ´ hÃ¬nh, viá»‡c káº¿t há»£p cÃ¡c chiáº¿n lÆ°á»£c kiá»ƒm tra trÆ°á»›c vÃ  sau cÅ©ng Ä‘Æ°á»£c báº£o Ä‘áº£m. Cuá»‘i cÃ¹ng, nhÆ° thÆ°á»ng tháº¥y vá»›i cÃ¡c nghiÃªn cá»©u RLHF khÃ¡c (Bai et al., 2022a), chi phÃ­ tÃ i chÃ­nh lÃ  Ä‘Ã¡ng ká»ƒ.

ChÃºng tÃ´i dá»± Ä‘á»‹nh má»Ÿ rá»™ng khung hiá»‡n táº¡i Ä‘á»ƒ bao gá»“m nhiá»u danh má»¥c sá»Ÿ thÃ­ch hÆ¡n ngoÃ i cÃ¡c biá»‡n phÃ¡p hiá»‡n táº¡i vá» tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. Äá»“ng thá»i, mÃ´ hÃ¬nh Safe RLHF hiá»‡n táº¡i hoáº¡t Ä‘á»™ng trong giá»›i háº¡n cá»§a cÃ¡c cuá»™c trÃ² chuyá»‡n má»™t lÆ°á»£t. Má»™t tÃ¡i hÃ¬nh thá»©c hÃ³a cho cÃ¡c bá»‘i cáº£nh trÃ² chuyá»‡n nhiá»u lÆ°á»£t lÃ  má»™t lÄ©nh vá»±c tiá»m nÄƒng Ä‘á»ƒ má»Ÿ rá»™ng, Ä‘á»ƒ tÄƒng cÆ°á»ng kháº£ nÄƒng á»©ng dá»¥ng cá»§a nÃ³. Cuá»‘i cÃ¹ng, nghiÃªn cá»©u cá»§a chÃºng tÃ´i Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng dá»¯ liá»‡u tá»« cÃ¡c mÃ´ hÃ¬nh Llama-1 (Touvron et al., 2023a) vÃ  Alpaca (Taori et al., 2023) Ä‘Æ°á»£c xem xÃ©t trÆ°á»›c Llama-2 (Touvron et al., 2023b). Äiá»u nÃ y gá»£i Ã½ ráº±ng viá»‡c chuyá»ƒn sang Llama-2 lÃ m mÃ´ hÃ¬nh tiá»n huáº¥n luyá»‡n cÆ¡ sá»Ÿ cÃ³ thá»ƒ thÃºc Ä‘áº©y má»©c Ä‘á»™ hiá»‡u suáº¥t.

7 THáº¢O LUáº¬N Äáº O Äá»¨C

Äá»ƒ thÃºc Ä‘áº©y hÆ¡n ná»¯a nghiÃªn cá»©u vá» cÄƒn chá»‰nh an toÃ n trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n, chÃºng tÃ´i Ä‘ang phÃ¡t hÃ nh má»™t táº­p dá»¯ liá»‡u mÃ£ nguá»“n má»Ÿ cho viá»‡c huáº¥n luyá»‡n láº·p Ä‘i láº·p láº¡i cÃ¡c mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng vÃ  chi phÃ­. Bao gá»“m trong táº­p dá»¯ liá»‡u nÃ y lÃ  cÃ¡c prompt red-team, phá»¥c vá»¥ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ cÃ¡c lá»— há»•ng trong cÆ¡ cháº¿ an toÃ n cá»§a mÃ´ hÃ¬nh má»¥c tiÃªu.

ChÃºng tÃ´i thá»«a nháº­n cÃ¡c rá»§i ro vá»‘n cÃ³ cá»§a viá»‡c lÃ m cho má»™t táº­p dá»¯ liá»‡u red-team cÃ³ thá»ƒ truy cáº­p cÃ´ng khai, do kháº£ nÄƒng láº¡m dá»¥ng. Má»™t káº» xáº¥u cÃ³ thá»ƒ khai thÃ¡c tÃ i nguyÃªn nÃ y Ä‘á»ƒ tinh chá»‰nh má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ vá»›i cÃ¡c má»¥c tiÃªu Ä‘áº£o ngÆ°á»£c cÃ³ thá»ƒ cÃ³ háº¡i Ä‘áº¿n phÃºc lá»£i cÃ´ng cá»™ng. ChÃºng tÃ´i máº¡nh máº½ khÃ´ng khuyáº¿n khÃ­ch nhá»¯ng hoáº¡t Ä‘á»™ng nhÆ° váº­y vÃ  á»§ng há»™ viá»‡c sá»­ dá»¥ng cÃ³ trÃ¡ch nhiá»‡m táº­p dá»¯ liá»‡u cá»§a chÃºng tÃ´i.

Lao Ä‘á»™ng cÃ´ng báº±ng vÃ  Ä‘áº¡o Ä‘á»©c Há»£p Ä‘á»“ng Ä‘Ã£ kÃ½ vá»›i Ä‘á»‘i tÃ¡c dá»¯ liá»‡u cá»§a chÃºng tÃ´i chá»‰ ra má»©c lÆ°Æ¡ng trung bÃ¬nh theo giá» Æ°á»›c tÃ­nh Ä‘Æ°á»£c tráº£ cho ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng dao Ä‘á»™ng tá»« 7.02 Ä‘áº¿n 9.09 USD, cao gáº¥p 1.98x âˆ¼ 2.56x so vá»›i má»©c trung bÃ¬nh theo giá» Ä‘á»‹a phÆ°Æ¡ng. TuÃ¢n thá»§ luáº­t lao Ä‘á»™ng Ä‘á»‹a phÆ°Æ¡ng, ngÆ°á»i lÃ m viá»‡c Ä‘Ã¡m Ä‘Ã´ng cá»§a chÃºng tÃ´i cÃ³ cÃ¡c ngÃ y lÃ m viá»‡c tÃ¡m giá» cÃ³ cáº¥u trÃºc vÃ  nghá»‰ cuá»‘i tuáº§n. ChÃºng tÃ´i cÅ©ng Æ°u tiÃªn sá»©c khá»e tinh tháº§n cá»§a há» báº±ng cÃ¡ch cung cáº¥p cÃ¡c cuá»™c gáº·p máº·t trá»±c tiáº¿p thÆ°á»ng xuyÃªn Ä‘á»ƒ giáº£m thiá»ƒu cÄƒng tháº³ng vÃ  tÄƒng cÆ°á»ng kháº£ nÄƒng phá»¥c há»“i.

8 Káº¾T LUáº¬N

NghiÃªn cá»©u nÃ y tÃ¡c Ä‘á»™ng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n an toÃ n cá»§a cÃ¡c há»‡ thá»‘ng AI dá»±a trÃªn LLM, táº­p trung vÃ o cÃ¡ch giáº£i quyáº¿t sá»± cÄƒng tháº³ng giá»¯a tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i trong quÃ¡ trÃ¬nh tinh chá»‰nh LLM. ChÃºng tÃ´i thá»«a nháº­n ráº±ng tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i thÆ°á»ng xung Ä‘á»™t trong háº§u háº¿t cÃ¡c tÃ¬nh huá»‘ng, khiáº¿n viá»‡c trá»™n láº«n chÃºng thÃ nh má»™t má»¥c tiÃªu huáº¥n luyá»‡n duy nháº¥t trá»Ÿ nÃªn khÃ´ng Ä‘Ã¡ng tin cáº­y. MÃ´ hÃ¬nh cÄƒn chá»‰nh an toÃ n cá»§a chÃºng tÃ´i, Safe RLHF, lÃ  sá»± tÃ­ch há»£p Ä‘áº§u tiÃªn cá»§a khung Safe RL vÃ  RLHF. Insight cá»‘t lÃµi cá»§a Safe RLHF lÃ  viá»‡c tÃ¡ch biá»‡t sá»Ÿ thÃ­ch con ngÆ°á»i trong quÃ¡ trÃ¬nh chÃº thÃ­ch vÃ  má»™t Î»-trade-off cho cÃ¡c má»¥c tiÃªu kÃ©p tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i. Trong cÃ¡c thá»±c nghiá»‡m cá»§a chÃºng tÃ´i, chÃºng tÃ´i Ä‘Ã£ Ã¡p dá»¥ng ba vÃ²ng khung Safe RLHF Ä‘á»ƒ tinh chá»‰nh mÃ´ hÃ¬nh cÆ¡ sá»Ÿ SFT. Káº¿t quáº£ Ä‘Ã¡nh giÃ¡ chá»‰ ra ráº±ng Safe RLHF hiá»‡u quáº£ tÄƒng cÆ°á»ng tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i cá»§a LLM. So vá»›i thuáº­t toÃ¡n, Reward Shaping, cÃ¢n báº±ng tÄ©nh hai má»¥c tiÃªu tá»‘i Æ°u hÃ³a Safe RLHF Ä‘iá»u hÆ°á»›ng tá»‘t hÆ¡n sá»± cÄƒng tháº³ng giá»¯a cÃ¡c má»¥c tiÃªu tÃ­nh há»¯u Ã­ch vÃ  tÃ­nh vÃ´ háº¡i.

TÃ€I LIá»†U THAM KHáº¢O

[Danh sÃ¡ch tÃ i liá»‡u tham kháº£o tiáº¿p tá»¥c vá»›i cÃ¡c nghiÃªn cá»©u Ä‘Æ°á»£c trÃ­ch dáº«n trong bÃ i bÃ¡o...]
