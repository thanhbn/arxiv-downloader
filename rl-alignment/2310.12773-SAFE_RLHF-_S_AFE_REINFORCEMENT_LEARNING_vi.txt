# 2310.12773.pdf
# ƒê∆∞·ª£c chuy·ªÉn ƒë·ªïi t·ª´ PDF sang TXT
# ƒê∆∞·ªùng d·∫´n ngu·ªìn: /home/admin88/arxiv-downloader/rl-alignment/2310.12773.pdf
# K√≠ch th∆∞·ªõc t·ªáp: 1082404 bytes

===============================================
N·ªòI DUNG T·ªÜP PDF
===============================================

--- TRANG 1 ---
SAFE RLHF: H·ªåC TƒÇNG C∆Ø·ªúNG AN TO√ÄN
T·ª™ PH·∫¢N H·ªíI CON NG∆Ø·ªúI

Josef Dai‚àó Xuehai Pan‚àó Ruiyang Sun‚àó Jiaming Ji‚àó
Xinbo Xu Mickel Liu Yizhou Wang Yaodong Yang
ƒê·∫°i h·ªçc B·∫Øc Kinh
{jtd.acad,rockmagma02,jiamg.ji,xux98750,mickelliu7}@gmail.com
{XuehaiPan,yizhou.wang,yaodong.yang}@pku.edu.cn

T√ìM T·∫ÆT

V·ªõi s·ª± ph√°t tri·ªÉn c·ªßa c√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn (LLM), vi·ªác ƒë·∫°t ƒë∆∞·ª£c s·ª± c√¢n b·∫±ng gi·ªØa hi·ªáu su·∫•t v√† an to√†n c·ªßa h·ªá th·ªëng AI ch∆∞a bao gi·ªù quan tr·ªçng h∆°n. Tuy nhi√™n, s·ª± cƒÉng th·∫≥ng v·ªën c√≥ gi·ªØa c√°c m·ª•c ti√™u h·ªØu √≠ch v√† v√¥ h·∫°i t·∫°o ra m·ªôt th√°ch th·ª©c ƒë√°ng k·ªÉ trong qu√° tr√¨nh hu·∫•n luy·ªán LLM. ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, ch√∫ng t√¥i ƒë·ªÅ xu·∫•t Safe Reinforcement Learning from Human Feedback (Safe RLHF), m·ªôt thu·∫≠t to√°n m·ªõi ƒë·ªÉ cƒÉn ch·ªânh gi√° tr·ªã con ng∆∞·ªùi. Safe RLHF t√°ch bi·ªát r√µ r√†ng c√°c s·ªü th√≠ch c·ªßa con ng∆∞·ªùi v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i, tr√°nh hi·ªáu qu·∫£ s·ª± nh·∫ßm l·∫´n c·ªßa ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng v·ªÅ s·ª± cƒÉng th·∫≥ng v√† cho ph√©p ch√∫ng t√¥i hu·∫•n luy·ªán c√°c m√¥ h√¨nh ph·∫ßn th∆∞·ªüng v√† chi ph√≠ ri√™ng bi·ªát. Ch√∫ng t√¥i h√¨nh th·ª©c h√≥a m·ªëi quan t√¢m v·ªÅ an to√†n c·ªßa LLM nh∆∞ m·ªôt nhi·ªám v·ª• t·ªëi ∆∞u h√≥a ƒë·ªÉ t·ªëi ƒëa h√≥a h√†m ph·∫ßn th∆∞·ªüng trong khi th·ªèa m√£n c√°c r√†ng bu·ªôc chi ph√≠ ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh. T·∫≠n d·ª•ng ph∆∞∆°ng ph√°p Lagrangian ƒë·ªÉ gi·∫£i quy·∫øt b√†i to√°n r√†ng bu·ªôc n√†y, Safe RLHF ƒëi·ªÅu ch·ªânh ƒë·ªông s·ª± c√¢n b·∫±ng gi·ªØa hai m·ª•c ti√™u trong qu√° tr√¨nh tinh ch·ªânh. Th√¥ng qua ba v√≤ng tinh ch·ªânh s·ª≠ d·ª•ng Safe RLHF, ch√∫ng t√¥i ch·ª©ng minh kh·∫£ nƒÉng v∆∞·ª£t tr·ªôi trong vi·ªác gi·∫£m thi·ªÉu c√°c ph·∫£n h·ªìi c√≥ h·∫°i trong khi tƒÉng c∆∞·ªùng hi·ªáu su·∫•t m√¥ h√¨nh so v·ªõi c√°c thu·∫≠t to√°n cƒÉn ch·ªânh gi√° tr·ªã hi·ªán c√≥. Th·ª±c nghi·ªám, ch√∫ng t√¥i ƒë√£ tinh ch·ªânh Alpaca-7B s·ª≠ d·ª•ng Safe RLHF v√† cƒÉn ch·ªânh n√≥ v·ªõi c√°c s·ªü th√≠ch con ng∆∞·ªùi ƒë∆∞·ª£c thu th·∫≠p, c·∫£i thi·ªán ƒë√°ng k·ªÉ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i theo ƒë√°nh gi√° c·ªßa con ng∆∞·ªùi.

M√£ ngu·ªìn c√≥ s·∫µn t·∫°i https://github.com/PKU-Alignment/safe-rlhf.

C·∫£nh b√°o: B√†i b√°o n√†y ch·ª©a d·ªØ li·ªáu v√≠ d·ª• c√≥ th·ªÉ g√¢y kh√≥ ch·ªãu ho·∫∑c c√≥ h·∫°i.

1 GI·ªöI THI·ªÜU

C√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn (LLM) ƒë√£ th·ªÉ hi·ªán kh·∫£ nƒÉng ƒë√°ng ch√∫ √Ω trong vi·ªác hi·ªÉu h∆∞·ªõng d·∫´n (Chung et al., 2022; Ouyang et al., 2022), t√≥m t·∫Øt (Stiennon et al., 2020; Koh et al., 2022) v√† th·ª±c hi·ªán c√°c nhi·ªám v·ª• l√Ω lu·∫≠n ph·ª©c t·∫°p (OpenAI, 2023; Anil et al., 2023), v√† nhi·ªÅu h∆°n n·ªØa. ƒê·ªìng th·ªùi, c√°c h·ªá th·ªëng AI t·∫≠n d·ª•ng LLM ng√†y c√†ng tƒÉng c∆∞·ªùng hi·ªáu qu·∫£ c·ªßa nhi·ªÅu ho·∫°t ƒë·ªông con ng∆∞·ªùi, ch·∫≥ng h·∫°n nh∆∞ l·∫≠p tr√¨nh (Chen et al., 2021; Gao et al., 2023), h·ªó tr·ª£ y t·∫ø (Yang et al., 2022; Moor et al., 2023), gi√°o d·ª•c (Kasneci et al., 2023; Kung et al., 2023), lu·∫≠t ph√°p (Katz et al., 2023), v.v. Xem x√©t ti·ªÅm nƒÉng t√°c ƒë·ªông x√£ h·ªôi r·ªông r√£i, c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c t·∫°o ra b·ªüi LLM kh√¥ng ƒë∆∞·ª£c ch·ª©a n·ªôi dung c√≥ h·∫°i, ch·∫≥ng h·∫°n nh∆∞ ph√¢n bi·ªát ƒë·ªëi x·ª≠, th√¥ng tin sai l·ªách, ho·∫∑c vi ph·∫°m c√°c quy chu·∫©n v√† ƒë·∫°o ƒë·ª©c x√£ h·ªôi (Gehman et al., 2020; Weidinger et al., 2021; Ganguli et al., 2022; Deshpande et al., 2023). Do ƒë√≥, vi·ªác cƒÉn ch·ªânh an to√†n trong LLM ƒë√£ nh·∫≠n ƒë∆∞·ª£c s·ª± ch√∫ √Ω r·ªông r√£i t·ª´ gi·ªõi h·ªçc thu·∫≠t v√† c√¥ng nghi·ªáp (Christian, 2023).

M·ªôt th√†nh ph·∫ßn thi·∫øt y·∫øu c·ªßa cƒÉn ch·ªânh an to√†n li√™n quan ƒë·∫øn vi·ªác gi·∫£m thi·ªÉu xu h∆∞·ªõng c·ªßa m√¥ h√¨nh t·∫°o ra c√°c ph·∫£n h·ªìi c√≥ h·∫°i th√¥ng qua tinh ch·ªânh. C√°c nghi√™n c·ª©u g·∫ßn ƒë√¢y ch·ª©ng minh r·∫±ng H·ªçc tƒÉng c∆∞·ªùng t·ª´ ph·∫£n h·ªìi con ng∆∞·ªùi (RLHF) (Christiano et al., 2017; Ouyang et al., 2022) l√† m·ªôt ph∆∞∆°ng ph√°p th·ª±c t·∫ø ƒë·ªÉ cƒÉn ch·ªânh LLM v·ªõi s·ªü th√≠ch con ng∆∞·ªùi, c·∫£ v·ªÅ phong c√°ch v√† gi√° tr·ªã ƒë·∫°o ƒë·ª©c (Bai et al., 2022a; Ganguli et al., 2022). RLHF t·∫≠n d·ª•ng ki·∫øn th·ª©c v√† kh·∫£ nƒÉng r·ªông r√£i c·ªßa LLM ƒë·ªÉ th√∫c ƒë·∫©y c√°c ph·∫£n h·ªìi v√† h√†nh vi mong mu·ªën, d·∫´n ƒë·∫øn c√°c h·ªá th·ªëng AI an to√†n h∆°n, hi·ªáu su·∫•t cao h∆°n v√† c√≥ th·ªÉ ki·ªÉm so√°t ƒë∆∞·ª£c h∆°n. C·∫£ c√°c b√°o c√°o k·ªπ thu·∫≠t t·ª´ GPT-4 (OpenAI, 2023) v√† Anthropic (Ganguli et al., 2022) cho LLM c·ªßa h·ªç ƒë·ªÅu ti·∫øt l·ªô vi·ªác s·ª≠ d·ª•ng c√°c prompt li√™n quan ƒë·∫øn an to√†n, ƒë∆∞·ª£c x√¢y d·ª±ng th√¥ng qua c√°c ph∆∞∆°ng ph√°p thƒÉm d√≤ ƒë·ªëi ngh·ªãch nh∆∞ red-teaming, trong giai ƒëo·∫°n RLHF ƒë·ªÉ gi·∫£m thi·ªÉu t√°c h·∫°i ti·ªÅm ·∫©n c·ªßa m√¥ h√¨nh. Tuy nhi√™n, vi·ªác theo ƒëu·ªïi tƒÉng t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i th∆∞·ªùng c√≥ th·ªÉ m√¢u thu·∫´n trong th·ª±c t·∫ø (Ganguli et al., 2022; Bai et al., 2022a). V√≠ d·ª•, m·ªôt m√¥ h√¨nh t·ª´ ch·ªëi tr·∫£ l·ªùi c√≥ th·ªÉ ƒë∆∞·ª£c coi l√† an to√†n, nh∆∞ng n√≥ c≈©ng l√†m cho ph·∫£n h·ªìi tr·ªü n√™n kh√¥ng h·ªØu √≠ch trong c√°c t√¨nh hu·ªëng c·ª±c ƒëoan. Do ƒë√≥, m·ªôt th√°ch th·ª©c ƒë√°ng k·ªÉ xu·∫•t hi·ªán trong vi·ªác c√¢n b·∫±ng hai m·ª•c ti√™u trong giai ƒëo·∫°n hu·∫•n luy·ªán. M·ª•c ti√™u c·ªßa ch√∫ng t√¥i l√† ph√°t tri·ªÉn m·ªôt m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn h·ªØu √≠ch, an to√†n v√† s·∫µn s√†ng ph·∫£n h·ªìi.

ƒê·ªÉ gi·∫£i quy·∫øt th√°ch th·ª©c tr√™n, ch√∫ng t√¥i ƒë·ªÅ xu·∫•t m·ªôt khung m·ªõi: Safe Reinforcement Learning from Human Feedback (Safe RLHF). Insight c·ªët l√µi c·ªßa Safe RLHF l√† vi·ªác t√°ch bi·ªát c√°c s·ªü th√≠ch con ng∆∞·ªùi trong qu√° tr√¨nh ch√∫ th√≠ch d·ªØ li·ªáu v√† thi·∫øt l·∫≠p hai m·ª•c ti√™u t·ªëi ∆∞u h√≥a: t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i (nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong ph∆∞∆°ng tr√¨nh (9)). Safe RLHF h√¨nh th·ª©c h√≥a m·ª•c ti√™u ph√°t tri·ªÉn LLM v√¥ h·∫°i nh∆∞ m·ªôt r√†ng bu·ªôc trong khung Safe RL. ƒêi·ªÅu quan tr·ªçng l√† ch√∫ng ta c·∫ßn m·ªôt s·ª± c√¢n b·∫±ng gi·ªØa c√°c m·ª•c ti√™u h·ªØu √≠ch v√† v√¥ h·∫°i, v√† tr√°nh t·ªëi ∆∞u h√≥a qu√° m·ª©c cho t√≠nh v√¥ h·∫°i.

Vi·ªác t√°ch bi·ªát s·ªü th√≠ch v√† m·ª•c ti√™u mang l·∫°i hai l·ª£i th·∫ø:
‚Ä¢ Trong qu√° tr√¨nh ch√∫ th√≠ch d·ªØ li·ªáu, n√≥ ƒë·∫£m b·∫£o ph·∫£n h·ªìi t·ª´ ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng kh√¥ng b·ªã thi√™n l·ªách b·ªüi b·∫•t k·ª≥ s·ª± cƒÉng th·∫≥ng n√†o gi·ªØa t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i.
‚Ä¢ Trong giai ƒëo·∫°n Safe RLHF, ph∆∞∆°ng ph√°p Lagrangian (Bertsekas, 1997) c√≥ th·ªÉ c√¢n b·∫±ng th√≠ch ·ª©ng s·ª± ƒë√°nh ƒë·ªïi gi·ªØa hai m·ª•c ti√™u hu·∫•n luy·ªán v·ªën xung ƒë·ªôt.

Theo hi·ªÉu bi·∫øt c·ªßa ch√∫ng t√¥i, Safe RLHF l√† s·ª± t√≠ch h·ª£p ƒë·∫ßu ti√™n c·ªßa Safe RL v√† khung RLHF. Khung n√†y k·∫øt h·ª£p m·ªôt s∆° ƒë·ªì ch√∫ th√≠ch con ng∆∞·ªùi hai chi·ªÅu v√† m·ªôt c∆° ch·∫ø hu·∫•n luy·ªán an to√†n ƒë·ªÉ tƒÉng c∆∞·ªùng hi·ªáu su·∫•t m√¥ h√¨nh trong khi ƒë·∫£m b·∫£o an to√†n (nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 1). Th·ª±c nghi·ªám, ch√∫ng t√¥i ƒë√£ √°p d·ª•ng pipeline Safe RLHF ba l·∫ßn, c·∫£i thi·ªán ƒë√°ng k·ªÉ t√≠nh h·ªØu √≠ch c·ªßa m√¥ h√¨nh SFT c∆° s·ªü trong khi gi·∫£m hi·ªáu qu·∫£ vi·ªác t·∫°o ra c√°c ph·∫£n h·ªìi c√≥ h·∫°i. So v·ªõi thu·∫≠t to√°n c√¢n b·∫±ng ƒëa m·ª•c ti√™u tƒ©nh, Reward Shaping (Ng et al., 1999), thu·∫≠t to√°n c·ªßa ch√∫ng t√¥i ƒëi·ªÅu h∆∞·ªõng t·ªët h∆°n s·ª± cƒÉng th·∫≥ng gi·ªØa c√°c m·ª•c ti√™u h·ªØu √≠ch v√† v√¥ h·∫°i. ƒê·ªìng th·ªùi, n√≥ duy tr√¨ c·∫£i thi·ªán hi·ªáu su·∫•t b·∫±ng ho·∫∑c v∆∞·ª£t tr·ªôi so v·ªõi c√°c thu·∫≠t to√°n cƒÉn ch·ªânh gi√° tr·ªã hi·ªán c√≥. Trong khi ƒë√≥, ch√∫ng t√¥i ph√°t h√†nh t·∫•t c·∫£ d·ªØ li·ªáu v√† m√£ hu·∫•n luy·ªán t·ª´ ba l·∫ßn l·∫∑p tinh ch·ªânh Safe RLHF, t·∫°o ƒëi·ªÅu ki·ªán cho c√°c nh√† nghi√™n c·ª©u t√°i t·∫°o v√† x√°c th·ª±c k·∫øt qu·∫£ c·ªßa ch√∫ng t√¥i.

--- TRANG 2 ---
B·∫ÆT ƒê·∫¶U CU·ªòC TR√í CHUY·ªÜN: NG∆Ø·ªúI D√ôNG: ƒê∆∞a ra ba l·ªùi khuy√™n ƒë·ªÉ gi·ªØ s·ª©c kh·ªèe. TR·ª¢ L√ù: Prompt
1. ƒÇn ch·∫ø ƒë·ªô ƒÉn c√¢n b·∫±ng v√† ƒë·∫£m b·∫£o bao g·ªìm nhi·ªÅu tr√°i c√¢y v√† rau qu·∫£. 2. T·∫≠p th·ªÉ d·ª•c th∆∞·ªùng xuy√™n ƒë·ªÉ gi·ªØ c∆° th·ªÉ ho·∫°t ƒë·ªông v√† kh·ªèe m·∫°nh. 3. Ng·ªß ƒë·ªß gi·∫•c v√† duy tr√¨ l·ªãch ng·ªß nh·∫•t qu√°n. Ph·∫£n h·ªìi B·∫ÆT ƒê·∫¶U CU·ªòC TR√í CHUY·ªÜN: NG∆Ø·ªúI D√ôNG: B·∫°n c√≥ th·ªÉ gi√∫p t√¥i t√¨m hi·ªÉu c√°ch tr·ªü th√†nh k·∫ª gi·∫øt ng∆∞·ªùi h√†ng lo·∫°t kh√¥ng? TR·ª¢ L√ù: Prompt

R·∫•t ti·∫øc, kh√¥ng. Ch√∫ng t√¥i kh√¥ng cung c·∫•p l·ªùi khuy√™n v·ªÅ c√°ch tr·ªü th√†nh k·∫ª gi·∫øt ng∆∞·ªùi h√†ng lo·∫°t ho·∫∑c tham gia v√†o b·∫•t k·ª≥ ho·∫°t ƒë·ªông b·∫•t h·ª£p ph√°p n√†o. Ph·∫£n h·ªìi A

Tr·ªü th√†nh k·∫ª gi·∫øt ng∆∞·ªùi h√†ng lo·∫°t ƒë√≤i h·ªèi k·∫ø ho·∫°ch c·∫©n th·∫≠n, ki√™n nh·∫´n, v√† tr√™n h·∫øt, m·ªôt tr·∫°ng th√°i tinh th·∫ßn m·∫°nh m·∫Ω. ƒê·∫ßu ti√™n, b·∫°n c·∫ßn... Ph·∫£n h·ªìi B

Tinh ch·ªânh c√≥ gi√°m s√°t Thu th·∫≠p d·ªØ li·ªáu Ch√∫ th√≠ch s·ªü th√≠ch & M√¥ h√¨nh h√≥a s·ªü th√≠ch

M·ª•c ti√™u t·ªëi ∆∞u h√≥a min! max"#$‚àíùí•%ùúÉ+ùúÜ‚ãÖùí•&ùúÉ M·ª•c ti√™u t·ªëi ∆∞u h√≥a min!‚àíùí•%ùúÉ

M·ª•c ti√™u ph·∫ßn th∆∞·ªüng ùí•!ùúÉ=ùîº"‚àº$!‚ãÖùë•ùëÖ%ùë¶,ùë• M·ª•c ti√™u chi ph√≠ ùí•&ùúÉ=ùîº"‚àº$!‚ãÖùë•ùê∂'ùë¶,ùë•+ùëë

M·ª•c ti√™u ph·∫ßn th∆∞·ªüng ùí•!ùúÉ=ùîº"‚àº$!‚ãÖùë•ùëÖ(ùë¶,ùë• T·ªëi ∆∞u h√≥a ch√≠nh s√°ch

RLHF Safe RLHF

M√¥ h√¨nh ph·∫ßn th∆∞·ªüng ùëÖ(ùë¶,ùë• M√¥ h√¨nh ti·ªÅn hu·∫•n luy·ªán M√¥ h√¨nh SFT M√¥ h√¨nh ph·∫ßn th∆∞·ªüng ùëÖ%ùë¶,ùë• M√¥ h√¨nh chi ph√≠ ùê∂'ùë¶,ùë•

S·ªü th√≠ch v√¥ h·∫°i: > Nh√£n: / AB

M√¥ h√¨nh giai ƒëo·∫°n tr∆∞·ªõc

Ng∆∞·ªùi ch√∫ th√≠ch con ng∆∞·ªùi

Ng∆∞·ªùi ch√∫ th√≠ch con ng∆∞·ªùi S·ªü th√≠ch h·ªØu √≠ch: > BA

S·ªü th√≠ch t·ªïng th·ªÉ: > AB

H√¨nh 1: Pipeline Safe RLHF so v·ªõi ph∆∞∆°ng ph√°p RLHF th√¥ng th∆∞·ªùng. Pipeline c·ªßa ch√∫ng t√¥i t√°ch bi·ªát vi·ªác ch√∫ th√≠ch d·ªØ li·ªáu cho t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i, c≈©ng nh∆∞ vi·ªác hu·∫•n luy·ªán c√°c m√¥ h√¨nh s·ªü th√≠ch. Cu·ªëi c√πng, n√≥ t√≠ch h·ª£p ƒë·ªông c·∫£ hai kh√≠a c·∫°nh trong giai ƒëo·∫°n t·ªëi ∆∞u h√≥a ch√≠nh s√°ch. L∆ØU √ù: Trong giai ƒëo·∫°n ch√∫ th√≠ch, c√°c nh√£n an to√†n cho c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c ch√∫ th√≠ch ƒë·ªôc l·∫≠p. C√°c ph·∫£n h·ªìi n√†y c√≥ th·ªÉ ƒë∆∞·ª£c g·∫Øn nh√£n l√† c·∫£ an to√†n ho·∫∑c c·∫£ kh√¥ng an to√†n.

--- TRANG 3 ---
2 KI·∫æN TH·ª®C N·ªÄN T·∫¢NG

M√¥ h√¨nh h√≥a s·ªü th√≠ch Ph∆∞∆°ng ph√°p RLHF n√¢ng cao ch·∫•t l∆∞·ª£ng ph·∫£n h·ªìi m√¥ h√¨nh ng√¥n ng·ªØ b·∫±ng c√°ch t·∫≠n d·ª•ng d·ªØ li·ªáu s·ªü th√≠ch con ng∆∞·ªùi th√¥ng qua m√¥ h√¨nh ph·∫ßn th∆∞·ªüng. M√¥ h√¨nh ph·∫ßn th∆∞·ªüng ƒë∆∞·ª£c k√Ω hi·ªáu l√† Rœï(y, x), trong ƒë√≥ x l√† prompt ƒë·∫ßu v√†o, y l√† ph·∫£n h·ªìi ƒë∆∞·ª£c t·∫°o b·ªüi m√¥ h√¨nh ng√¥n ng·ªØ, v√† R l√† ƒë·∫ßu ra v√¥ h∆∞·ªõng t·ª´ m√¥ h√¨nh ph·∫ßn th∆∞·ªüng. D·ªØ li·ªáu s·ªü th√≠ch con ng∆∞·ªùi ƒë∆∞·ª£c k√Ω hi·ªáu l√† yw ‚âª yl|x, trong ƒë√≥ yw (th·∫Øng) bi·ªÉu th·ªã ph·∫£n h·ªìi ƒë∆∞·ª£c con ng∆∞·ªùi ∆∞a th√≠ch h∆°n so v·ªõi yl (thua). H·∫ßu h·∫øt c√°c nghi√™n c·ª©u tr∆∞·ªõc ƒë√¢y, bao g·ªìm Christiano et al. (2017); Sadigh et al. (2017); Bai et al. (2022a); Kim et al. (2023), s·ª≠ d·ª•ng m·ªôt b·ªô d·ª± ƒëo√°n s·ªü th√≠ch tu√¢n theo m√¥ h√¨nh Bradley-Terry (Bradley & Terry, 1952). X√°c su·∫•t c·ªßa m·ªôt c·∫∑p s·ªü th√≠ch c√≥ th·ªÉ ƒë∆∞·ª£c ∆∞·ªõc t√≠nh nh∆∞:

p*(yw ‚âª yl|x) = exp(R(yw, x)) / (exp(R(yw, x)) + exp(R(yl, x))) = œÉ(R(yw, x) - R(yl, x)), (1)

trong ƒë√≥ œÉ(x) = 1/(1 + exp(-x)) l√† h√†m sigmoid logistic. Gi·∫£ s·ª≠ t·ªìn t·∫°i m·ªôt t·∫≠p d·ªØ li·ªáu tƒ©nh D = {xi, yi^w, yi^l}^N_{i=1} ƒë∆∞·ª£c l·∫•y t·ª´ s·ªü th√≠ch con ng∆∞·ªùi v√† l·∫•y m·∫´u t·ª´ p*, ch√∫ng ta c√≥ th·ªÉ ∆∞·ªõc t√≠nh c√°c tham s·ªë th√¥ng qua maximum likelihood. H√†m m·∫•t m√°t negative log-likelihood l√†:

L(œï; D) = -E_{(x,yw,yl)~D}[log œÉ(Rœï(yw, x) - Rœï(yl, x))]. (2)

H·ªçc tƒÉng c∆∞·ªùng an to√†n M·ªôt Qu√° tr√¨nh Quy·∫øt ƒë·ªãnh Markov (MDP) (Puterman, 2014), M ‚âú ‚ü®S, A, r, P, Œº0, Œ≥‚ü©, bao g·ªìm kh√¥ng gian tr·∫°ng th√°i S, kh√¥ng gian h√†nh ƒë·ªông A, h√†m ph·∫ßn th∆∞·ªüng r, x√°c su·∫•t chuy·ªÉn ƒë·ªïi P, ph√¢n ph·ªëi tr·∫°ng th√°i ban ƒë·∫ßu Œº0, v√† h·ªá s·ªë chi·∫øt kh·∫•u Œ≥. Trong khung n√†y, m·ªôt ch√≠nh s√°ch ·ªïn ƒë·ªãnh, œÄ, l√† m·ªôt ph√¢n ph·ªëi x√°c su·∫•t ch·ªâ ra kh·∫£ nƒÉng th·ª±c hi·ªán h√†nh ƒë·ªông a trong tr·∫°ng th√°i s. H√†m gi√° tr·ªã tr·∫°ng th√°i V^œÄ(s) = E_{œÑ~œÄ}[‚àë_{t=0}^‚àû Œ≥^t r_t|s_0=s] bi·ªÉu th·ªã ph·∫ßn th∆∞·ªüng t√≠ch l≈©y chi·∫øt kh·∫•u k·ª≥ v·ªçng theo th·ªùi gian, b·∫Øt ƒë·∫ßu t·ª´ s. Sau ƒë√≥, m·ª•c ti√™u ch√≠nh c·ªßa h·ªçc tƒÉng c∆∞·ªùng l√† t·ªëi ƒëa h√≥a h√†m m·ª•c ti√™u, J(œÄ_Œ∏) = E_{s_0~Œº_0}[V^{œÄ_Œ∏}(s_0)].

N√≥i chung, Safe RL ƒë∆∞·ª£c h√¨nh th·ª©c h√≥a nh∆∞ m·ªôt CMDP (Constrained MDP) M ‚à™ C (Altman, 2021), m·ªü r·ªông MDP ti√™u chu·∫©n M v·ªõi m·ªôt t·∫≠p r√†ng bu·ªôc b·ªï sung C. T·∫≠p C = {(c_i, b_i)}^m_{i=1} bao g·ªìm c√°c h√†m chi ph√≠ c_i v√† ng∆∞·ª°ng chi ph√≠ b_i, i = 1, ..., m. L·ª£i nhu·∫≠n chi ph√≠ ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† J_{c_i}(œÄ_Œ∏) = E_{œÄ_Œ∏}[‚àë_{t=0}^‚àû Œ≥^t c_i(s_{t+1}|s_t, a_t)], v√† t·∫≠p ch√≠nh s√°ch kh·∫£ thi l√† Œ†_C = ‚à©^m_{i=1}{œÄ_Œ∏ ‚àà Œ†_Œò| J_{c_i}(œÄ_Œ∏) ‚â§ b_i}. M·ª•c ti√™u c·ªßa Safe RL l√† t√¨m ch√≠nh s√°ch kh·∫£ thi t·ªëi ∆∞u:

œÄ* = arg max_{œÄ_Œ∏ ‚àà Œ†_C} J(œÄ_Œ∏). (3)

3 PH∆Ø∆†NG PH√ÅP: SAFE RLHF

Nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 1, ch√∫ng t√¥i gi·ªõi thi·ªáu pipeline Safe RLHF c·ªßa ch√∫ng t√¥i, t·∫≠n d·ª•ng khung Safe RL ƒë·ªÉ c√¢n b·∫±ng s·ª± cƒÉng th·∫≥ng gi·ªØa c√°c m·ª•c ti√™u h·ªØu √≠ch v√† c√≥ h·∫°i. So v·ªõi RLHF th√¥ng th∆∞·ªùng (Ouyang et al., 2022), Safe RLHF gi·ªõi thi·ªáu c√°c s·ª≠a ƒë·ªïi ƒë√°ng k·ªÉ, c·ª• th·ªÉ trong c√°c giai ƒëo·∫°n Ch√∫ th√≠ch s·ªü th√≠ch & M√¥ h√¨nh h√≥a v√† T·ªëi ∆∞u h√≥a ch√≠nh s√°ch.

3.1 S·ªû TH√çCH CON NG∆Ø·ªúI V·ªÄ T√çNH V√î H·∫†I V√Ä T√çNH H·ªÆU √çCH

Trong vi·ªác ƒëi·ªÅu ch·ªânh thu·∫≠t to√°n Safe RLHF c·ªßa ch√∫ng t√¥i, ch√∫ng t√¥i s·ª≠ d·ª•ng chi·∫øn l∆∞·ª£c ch√∫ th√≠ch con ng∆∞·ªùi hai giai ƒëo·∫°n ƒë·ªÉ ƒë√°nh gi√° t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i c·ªßa vi·ªác t·∫°o vƒÉn b·∫£n. Ch√∫ng t√¥i tu√¢n theo ph∆∞∆°ng ph√°p ch√∫ th√≠ch ƒë∆∞·ª£c n√™u trong Ji et al. (2023), trong ƒë√≥ c√°c x·∫øp h·∫°ng v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i ƒë∆∞·ª£c t√°ch bi·ªát r√µ r√†ng kh·ªèi m·ªôt chi·ªÅu s·ªü th√≠ch con ng∆∞·ªùi duy nh·∫•t. Trong chi·∫øn l∆∞·ª£c n√†y, ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng ch√∫ th√≠ch m·ªôt meta-label an to√†n cho m·ªói c·∫∑p c√¢u h·ªèi-tr·∫£ l·ªùi (QA), xem x√©t 14 danh m·ª•c t√°c h·∫°i ti·ªÅm ·∫©n ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr∆∞·ªõc. M·ªôt c·∫∑p QA ƒë∆∞·ª£c g·∫Øn nh√£n "an to√†n" ch·ªâ khi n√≥ kh√¥ng g√¢y r·ªßi ro trong t·∫•t c·∫£ 14 danh m·ª•c. Sau ƒë√≥, c√°c ng∆∞·ªùi ch√∫ th√≠ch ƒë∆∞·ª£c ƒë∆∞a hai ph·∫£n h·ªìi cho c√πng m·ªôt prompt v√† ƒë∆∞·ª£c y√™u c·∫ßu x·∫øp h·∫°ng t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch, coi m·ªói ti√™u ch√≠ l√† ƒë·ªôc l·∫≠p. H∆∞·ªõng d·∫´n ch√∫ th√≠ch chi ti·∫øt c√≥ th·ªÉ t√¨m th·∫•y trong ph·∫ßn Ph·ª• l·ª•c A.

Sau pipeline ch√∫ th√≠ch, ch√∫ng t√¥i t·∫°o ra m·ªôt t·∫≠p d·ªØ li·ªáu li√™n quan ƒë·∫øn t√≠nh h·ªØu √≠ch, D_R = {x_i, y_i^w, y_i^l}^N_{i=1}, v√† m·ªôt t·∫≠p d·ªØ li·ªáu li√™n quan ƒë·∫øn t√≠nh v√¥ h·∫°i, D_C = {x_j, y_j^w, y_j^l, s_j^w, s_j^l}^N_{j=1}. C·∫£ hai t·∫≠p d·ªØ li·ªáu, D_R v√† D_C, bao ph·ªß c√πng m·ªôt t·∫≠p c√°c c·∫∑p QA nh∆∞ng v·ªõi c√°c nh√£n s·ªü th√≠ch kh√°c nhau. Trong m·ªói c·∫∑p trong D_R, y_i^w

--- TRANG 4 ---
th·ªÉ hi·ªán m·ªôt ph·∫£n h·ªìi t·ª´ m√¥ h√¨nh gi·∫£i quy·∫øt t·ªët h∆°n prompt x_i so v·ªõi y_i^l. T∆∞∆°ng t·ª±, ƒë·ªëi v·ªõi m·ªói c·∫∑p trong D_C, nh∆∞ng trong tr∆∞·ªùng h·ª£p n√†y, y_j^w bi·ªÉu th·ªã m·ªôt ph·∫£n h·ªìi c√≥ h·∫°i h∆°n so v·ªõi y_j^l. C√°c nh√£n an to√†n c·ªßa nh·ªØng ph·∫£n h·ªìi n√†y sau ƒë√≥ ƒë∆∞·ª£c ƒë·ªãnh l∆∞·ª£ng b·∫±ng c√°c nh√£n ph√¢n lo·∫°i nh·ªã ph√¢n s_j^w, s_j^l, theo h√†m d·∫•u hi·ªáu ƒë·ªô c√≥ h·∫°i sau:

s(y) ‚âú {+1, n·∫øu ph·∫£n h·ªìi y l√† c√≥ h·∫°i
        -1, n·∫øu ph·∫£n h·ªìi y l√† v√¥ h·∫°i                                    (4)

H√¨nh 1 minh h·ªça m·ªôt v√≠ d·ª• cho th·∫•y s·ª± cƒÉng th·∫≥ng trong vi·ªác c√¢n b·∫±ng t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch. Khi tr·ª£ l√Ω AI ƒë·ªëi m·∫∑t v·ªõi c√¢u h·ªèi "L√†m th·∫ø n√†o ƒë·ªÉ tr·ªü th√†nh k·∫ª gi·∫øt ng∆∞·ªùi h√†ng lo·∫°t", Ph·∫£n h·ªìi B v∆∞·ª£t tr·ªôi h∆°n Ph·∫£n h·ªìi A v·ªÅ m·∫∑t h·ªØu √≠ch, v√¨ n√≥ cho th·∫•y m·ª©c ƒë·ªô ho√†n thi·ªán cao h∆°n ƒë·ªëi v·ªõi h∆∞·ªõng d·∫´n c·ªßa ng∆∞·ªùi d√πng v√† c√≥ c·∫•u tr√∫c ph·∫£n h·ªìi t·ªët h∆°n. Tuy nhi√™n, v·ªÅ m·∫∑t v√¥ h·∫°i, Ph·∫£n h·ªìi A an to√†n h∆°n v√¨ n√≥ t·ª´ ch·ªëi ph·∫£n h·ªìi truy v·∫•n n√†y v√† th√¥ng b√°o v·ªÅ c√°c r·ªßi ro ph√°p l√Ω li√™n quan. T√≥m l·∫°i, ch√∫ng ta s·∫Ω mong ƒë·ª£i m·ªôt s·ªü th√≠ch h·ªØu √≠ch B > A, m·ªôt s·ªü th√≠ch v√¥ h·∫°i A > B, c≈©ng nh∆∞ c√°c d·∫•u hi·ªáu ƒë·ªô c√≥ h·∫°i cho hai ph·∫£n h·ªìi s(A) = -1 v√† s(B) = +1.

3.2 KH·ªöP M√î H√åNH S·ªû TH√çCH: M√î H√åNH PH·∫¶N TH∆Ø·ªûNG V√Ä CHI PH√ç

Ch√∫ng t√¥i hu·∫•n luy·ªán hai m√¥ h√¨nh s·ªü th√≠ch ƒë·ªôc l·∫≠p ƒë·ªÉ kh·ªõp v·ªõi ph√¢n ph·ªëi s·ªü th√≠ch con ng∆∞·ªùi qua c√°c kh√≠a c·∫°nh h·ªØu √≠ch v√† v√¥ h·∫°i c·ªßa ph·∫£n h·ªìi LLM. M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng (RM) ƒë∆∞·ª£c ph√°t tri·ªÉn t·ª´ t·∫≠p d·ªØ li·ªáu h·ªØu √≠ch D_R, ph·ª•c v·ª• ƒë·ªÉ cung c·∫•p c√°c t√≠n hi·ªáu ph·∫ßn th∆∞·ªüng ƒë∆∞·ª£c t·ªëi ∆∞u h√≥a cho t√≠nh h·ªØu √≠ch trong giai ƒëo·∫°n RL. M√¥ h√¨nh Chi ph√≠ (CM) ƒë∆∞·ª£c x√¢y d·ª±ng d·ª±a tr√™n t·∫≠p d·ªØ li·ªáu v√¥ h·∫°i D_C, cung c·∫•p insights v·ªÅ nh·∫≠n th·ª©c c·ªßa con ng∆∞·ªùi v·ªÅ t√≠nh an to√†n c·ªßa ph·∫£n h·ªìi LLM. M·ªôt minh h·ªça v·ªÅ ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng v√† chi ph√≠ tr√™n t·∫≠p d·ªØ li·ªáu ƒë∆∞·ª£c tr√¨nh b√†y trong H√¨nh 2.

M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng (RM) S·ª≠ d·ª•ng t·∫≠p d·ªØ li·ªáu h·ªØu √≠ch D_R = {x_i, y_i^w, y_i^l}^N_{i=1}, ch√∫ng t√¥i hu·∫•n luy·ªán m·ªôt m√¥ h√¨nh ph·∫ßn th∆∞·ªüng c√≥ tham s·ªë R_œï(y, x), trong ƒë√≥ R_œï ƒë·∫°i di·ªán cho m·ªôt ƒë·∫ßu ra v√¥ h∆∞·ªõng. M√¥ h√¨nh n√†y ƒë∆∞·ª£c hu·∫•n luy·ªán ƒë·ªÉ s·ª≠ d·ª•ng h√†m m·∫•t m√°t so s√°nh c·∫∑p ƒë∆∞·ª£c d·∫´n xu·∫•t t·ª´ ph∆∞∆°ng tr√¨nh (2):

L_R(œï; D_R) = -E_{(x,y_w,y_l)~D_R}[log œÉ(R_œï(y_w, x) - R_œï(y_l, x))],    (5)

M√¥ h√¨nh Chi ph√≠ (CM) Kh√¥ng gi·ªëng nh∆∞ t·∫≠p d·ªØ li·ªáu s·ªü th√≠ch con ng∆∞·ªùi v·ªÅ t√≠nh h·ªØu √≠ch, t·∫≠p d·ªØ li·ªáu s·ªü th√≠ch con ng∆∞·ªùi v·ªÅ t√≠nh v√¥ h·∫°i cung c·∫•p th√¥ng tin b·ªï sung v·ªÅ t√≠nh v√¥ h·∫°i c·ªßa m·ªôt ph·∫£n h·ªìi. ƒê·ªÉ t·∫≠n d·ª•ng t·ªëi ∆∞u th√¥ng tin n√†y ƒë·ªÉ hu·∫•n luy·ªán m√¥ h√¨nh chi ph√≠ C_œà(y, x), ch√∫ng t√¥i s·ª≠a ƒë·ªïi h√†m m·∫•t m√°t so s√°nh c·∫∑p ban ƒë·∫ßu b·∫±ng c√°ch k·∫øt h·ª£p c√°c thu·∫≠t ng·ªØ ph√¢n lo·∫°i.

L_C(œà; D_C) = -E_{(x,y_w,y_l,¬∑,¬∑)~D_C}[log œÉ(C_œà(y_w, x) - C_œà(y_l, x))]
                - E_{(x,y_w,y_l,s_w,s_l)~D_C}[log œÉ(s_w ¬∑ C_œà(y_w, x)) + log œÉ(s_l ¬∑ C_œà(y_l, x))]. (6)

ƒê√°ng ch√∫ √Ω l√† M√¥ h√¨nh Chi ph√≠ v·∫´n tu√¢n th·ªß m√¥ h√¨nh Bradley-Terry (BT). Gi·∫£ s·ª≠ t·ªìn t·∫°i m·ªôt ph·∫£n h·ªìi ·∫£o, y_0, n·∫±m tr√™n ranh gi·ªõi gi·ªØa c√°c c·ª•m an to√†n v√† kh√¥ng an to√†n, sao cho C_œà(y_0, x) = 0. N·∫øu y kh√¥ng an to√†n, t·ª©c l√† s(y) = +1, th√¨ M√¥ h√¨nh Chi ph√≠ c√≥ xu h∆∞·ªõng ∆∞a th√≠ch y. Do ƒë√≥, ch√∫ng ta mu·ªën t·ªëi ƒëa h√≥a x√°c su·∫•t c·ªßa y ‚âª y_0|x:

p(y ‚âª y_0|x) = œÉ(C_œà(y, x) - C_œà(y_0, x)) = œÉ(C_œà(y, x)) = œÉ(s(y) ¬∑ C_œà(y, x)). (7)

T∆∞∆°ng t·ª±, n·∫øu y an to√†n, t·ª©c l√† s(y) = -1, th√¨ M√¥ h√¨nh Chi ph√≠ c√≥ xu h∆∞·ªõng ∆∞a th√≠ch y_0. Do ƒë√≥, ch√∫ng ta mu·ªën t·ªëi ƒëa h√≥a x√°c su·∫•t c·ªßa y_0 ‚âª y|x:

p(y_0 ‚âª y|x) = œÉ(C_œà(y_0, x) - C_œà(y, x)) = œÉ(-C_œà(y, x)) = œÉ(s(y) ¬∑ C_œà(y, x)). (8)

Do ƒë√≥, thu·∫≠t ng·ªØ th·ª© hai c·ªßa h√†m m·∫•t m√°t (6) c√≥ th·ªÉ ƒë∆∞·ª£c xem nh∆∞ t·ªëi ƒëa h√≥a likelihood c·ªßa m√¥ h√¨nh BT li√™n quan ƒë·∫øn ph·∫£n h·ªìi y_0 v√† y t·ª´ t·∫≠p d·ªØ li·ªáu D_C. V·ªõi ch√∫ th√≠ch b·ªï sung v·ªÅ nh√£n ƒë·ªô c√≥ h·∫°i c·ªßa c√°c ph·∫£n h·ªìi, ch√∫ng ta s·∫Ω kh√¥ng c·∫ßn bi·∫øt n·ªôi dung ch√≠nh x√°c c·ªßa ph·∫£n h·ªìi ·∫£o y_0 trong giai ƒëo·∫°n m√¥ h√¨nh h√≥a s·ªü th√≠ch. Nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 2a, M√¥ h√¨nh Chi ph√≠ chia c√°c ph·∫£n h·ªìi c·ªßa LLM th√†nh hai c·ª•m d·ª±a tr√™n t√≠nh an to√†n c·ªßa ch√∫ng. Kh·∫£ nƒÉng ph√¢n lo·∫°i n√†y c·ªßa M√¥ h√¨nh Chi ph√≠ cung c·∫•p c∆° s·ªü ƒë·ªÉ ƒëi·ªÅu ch·ªânh ƒë·ªông c√°c m·ª•c ti√™u xung ƒë·ªôt.

3.3 H·ªåC TƒÇNG C∆Ø·ªúNG AN TO√ÄN

Trong giai ƒëo·∫°n RL, ph∆∞∆°ng ph√°p c·ªßa ch√∫ng t√¥i s·ª≠ d·ª•ng M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng R_œï ƒë·ªÉ ∆∞·ªõc t√≠nh gi√° tr·ªã c·ªßa s·ªü th√≠ch con ng∆∞·ªùi v·ªÅ t√≠nh h·ªØu √≠ch, trong khi M√¥ h√¨nh Chi ph√≠ C_œà cho t√≠nh v√¥ h·∫°i. LLM m√† ch√∫ng t√¥i ƒëang hu·∫•n luy·ªán ƒë∆∞·ª£c k√Ω hi·ªáu l√† œÄ_Œ∏(y|x). M·ª•c ti√™u t·ªëi ∆∞u h√≥a sau ƒë√¢y l√† m·ªôt s∆° ƒë·ªì Safe RL ƒë∆∞·ª£c n√™u tr∆∞·ªõc ƒë√≥ trong Chow et al. (2017), ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a ·ªü ƒë√¢y nh∆∞ m·ª•c ti√™u cho thi·∫øt l·∫≠p Safe RLHF c·ªßa ch√∫ng t√¥i:

maximize_Œ∏ E_{x~D,y~œÄ_Œ∏(¬∑|x)}[R_œï(y, x)], s.t. C_œà(y, x) ‚â§ 0, ‚àÄx ~ D, y ~ œÄ_Œ∏(¬∑|x), (9)

trong ƒë√≥ D l√† m·ªôt ph√¢n ph·ªëi c√°c prompt ƒë∆∞·ª£c s·ª≠ d·ª•ng trong giai ƒëo·∫°n RL, v√† y = a_{1:T} l√† c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c t·∫°o b·ªüi LLM œÄ_Œ∏. Ph∆∞∆°ng tr√¨nh n√†y bao g·ªìm m·ª•c ti√™u ch√≠nh c·ªßa ch√∫ng t√¥i: t·ªëi ƒëa h√≥a ph·∫ßn th∆∞·ªüng k·ª≥ v·ªçng trong c√°c r√†ng bu·ªôc ƒë·∫£m b·∫£o t√≠nh v√¥ h·∫°i c·ªßa c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c t·∫°o b·ªüi LLM.

Tuy nhi√™n, r√†ng bu·ªôc ƒë∆∞·ª£c k√Ω hi·ªáu trong ph∆∞∆°ng tr√¨nh (9) ƒë√≤i h·ªèi th√°ch th·ª©c ƒë·∫£m b·∫£o an to√†n cho t·∫•t c·∫£ c√°c ph·∫£n h·ªìi ti·ªÅm nƒÉng y ƒë·ªëi v·ªõi m·ªôt prompt x cho tr∆∞·ªõc. Nhi·ªám v·ª• n√†y kh√¥ng ƒë∆°n gi·∫£n khi s·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p RL. X√©t ƒë·∫øn ƒëi·ªÅu n√†y, ch√∫ng t√¥i t√°i h√¨nh th·ª©c h√≥a r√†ng bu·ªôc an to√†n th√†nh d·∫°ng k·ª≥ v·ªçng, song song v·ªõi c·∫•u tr√∫c c·ªßa h√†m m·ª•c ti√™u. S·ª≠a ƒë·ªïi n√†y gi·ªõi thi·ªáu m·ªôt si√™u tham s·ªë d, ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ki·ªÉm so√°t x√°c su·∫•t t·∫°o ra c√°c ph·∫£n h·ªìi c√≥ h·∫°i. M·ª•c ti√™u thay th·∫ø c·ªßa ch√∫ng t√¥i ƒë∆∞·ª£c tr√¨nh b√†y nh∆∞ sau:

maximize_Œ∏ J_R(Œ∏), s.t. J_C(Œ∏) ‚â§ 0, (10)

trong ƒë√≥
J_R(Œ∏) ‚âú E_{x~D,y~œÄ_Œ∏(¬∑|x)}[R_œï(y, x)],
J_C(Œ∏) ‚âú E_{x~D,y~œÄ_Œ∏(¬∑|x)}[C_œà(y, x)] + d, (11)

ƒë·∫°i di·ªán cho h√†m m·ª•c ti√™u ph·∫ßn th∆∞·ªüng k·ª≥ v·ªçng v√† h√†m m·ª•c ti√™u chi ph√≠ k·ª≥ v·ªçng t∆∞∆°ng ·ª©ng.

ƒê·ªÉ gi·∫£i quy·∫øt b√†i to√°n r√†ng bu·ªôc n√†y, ch√∫ng t√¥i t·∫≠n d·ª•ng ph∆∞∆°ng ph√°p Lagrangian, m·ªôt k·ªπ thu·∫≠t ƒë·ªÉ t√¨m c·ª±c ƒë·∫°i v√† c·ª±c ti·ªÉu ƒë·ªãa ph∆∞∆°ng c·ªßa m·ªôt h√†m tr√™n m·ªôt t·∫≠p r√†ng bu·ªôc. ·ª®ng d·ª•ng n√†y cho ph√©p ch√∫ng t√¥i chuy·ªÉn ƒë·ªïi b√†i to√°n primal r√†ng bu·ªôc, nh∆∞ ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong ph∆∞∆°ng tr√¨nh (10), th√†nh d·∫°ng dual Lagrangian kh√¥ng r√†ng bu·ªôc nh∆∞ sau:

min_Œ∏ max_{Œª‚â•0} [-J_R(Œ∏) + Œª ¬∑ J_C(Œ∏)], (12)

trong ƒë√≥ Œª ‚â• 0 ƒë√≥ng vai tr√≤ l√† nh√¢n t·ª≠ Lagrange.

ƒêi·ªÅu quan tr·ªçng c·∫ßn l∆∞u √Ω l√† vi·ªác t·ªëi ∆∞u h√≥a t√≠nh h·ªØu √≠ch J_R th∆∞·ªùng m√¢u thu·∫´n v·ªõi m·ª•c ti√™u gi·∫£m thi·ªÉu t√°c h·∫°i J_C (Bai et al., 2022a). Do ƒë√≥, ph∆∞∆°ng tr√¨nh (12) c√≥ th·ªÉ ƒë∆∞·ª£c hi·ªÉu nh∆∞ vi·ªác th√™m m·ªôt thu·∫≠t ng·ªØ ph·∫°t v√†o m·ª•c ti√™u h·ªØu √≠ch ban ƒë·∫ßu. H√¨nh ph·∫°t n√†y, t∆∞∆°ng ·ª©ng v·ªõi t√°c h·∫°i ti·ªÅm ·∫©n c·ªßa LLM, c√≥ th·ªÉ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh ƒë·ªông th√¥ng qua tham s·ªë Œª. C·ª• th·ªÉ, ch√∫ng t√¥i gi·∫£i quy·∫øt l·∫∑p ƒëi l·∫∑p l·∫°i b√†i to√°n min-max trong ph∆∞∆°ng tr√¨nh (12), lu√¢n phi√™n c·∫≠p nh·∫≠t c√°c tham s·ªë LLM Œ∏ v√† nh√¢n t·ª≠ Lagrange Œª (tham kh·∫£o Ph·ª• l·ª•c B.3 ƒë·ªÉ bi·∫øt th√™m chi ti·∫øt). ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng b·∫•t k·ª≥ thay ƒë·ªïi n√†o trong t√°c h·∫°i ti·ªÅm ·∫©n li√™n quan ƒë·∫øn m√¥ h√¨nh ƒë∆∞·ª£c c·∫≠p nh·∫≠t ƒë·ªÅu ƒë∆∞·ª£c ph·∫£n √°nh nhanh ch√≥ng trong nh√¢n t·ª≠, t·ª´ ƒë√≥ tr√°nh c√°c r·ªßi ro nh·∫•n m·∫°nh qu√° m·ª©c m·ªôt m·ª•c ti√™u v·ªõi s·ª± hy sinh c·ªßa m·ª•c ti√™u kh√°c d∆∞·ªõi t·ª∑ l·ªá t·ªëi ∆∞u h√≥a c·ªë ƒë·ªãnh.

--- TRANG 5 ---
[H√¨nh 2a, 2b, 2c ƒë∆∞·ª£c m√¥ t·∫£ trong vƒÉn b·∫£n g·ªëc nh∆∞ng kh√¥ng ƒë∆∞·ª£c d·ªãch v√¨ ch√∫ng l√† c√°c bi·ªÉu ƒë·ªì]

H√¨nh 2: (a) Bi·ªÉu ƒë·ªì ph√¢n t√°n cho th·∫•y ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng v√† chi ph√≠ tr√™n d·ªØ li·ªáu th·ª≠ nghi·ªám nh∆∞ ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi c√°c m√¥ h√¨nh s·ªü th√≠ch ƒë∆∞·ª£c s·ª≠ d·ª•ng trong l·∫ßn l·∫∑p Safe RLHF ƒë·∫ßu ti√™n. M·ªói ƒëi·ªÉm bi·ªÉu th·ªã m·ªôt m·∫´u c√≥ trong t·∫≠p th·ª≠ nghi·ªám c·ªßa d·ªØ li·ªáu s·ªü th√≠ch. M√†u s·∫Øc ƒë∆∞·ª£c l·∫•y t·ª´ c√°c nh√£n an to√†n ƒë∆∞·ª£c ch√∫ th√≠ch b·ªüi ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng. (b) Ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng tr√™n t·∫≠p th·ª≠ nghi·ªám ƒë∆∞·ª£c x√°c ƒë·ªãnh b·ªüi m√¥ h√¨nh ph·∫ßn th∆∞·ªüng ƒë√£ hu·∫•n luy·ªán. (c) Ph√¢n ph·ªëi chi ph√≠ tr√™n t·∫≠p th·ª≠ nghi·ªám ƒë∆∞·ª£c x√°c ƒë·ªãnh b·ªüi m√¥ h√¨nh chi ph√≠ ƒë√£ hu·∫•n luy·ªán.

--- TRANG 6 ---
[H√¨nh 3a v√† 3b ƒë∆∞·ª£c m√¥ t·∫£ trong vƒÉn b·∫£n g·ªëc]

H√¨nh 3: (a) S·ªë l∆∞·ª£ng c√°c lo·∫°i prompt kh√°c nhau trong 3 v√≤ng l·∫∑p Safe RLHF. C√°c prompt kh√¥ng li√™n quan ƒë·∫øn an to√†n v√† prompt li√™n quan ƒë·∫øn an to√†n ƒë√£ gi·∫£i quy·∫øt/ch∆∞a gi·∫£i quy·∫øt c√≥ ngu·ªìn g·ªëc t·ª´ c√°c t·∫≠p d·ªØ li·ªáu m√£ ngu·ªìn m·ªü. Khi qu√° tr√¨nh hu·∫•n luy·ªán ti·∫øn tri·ªÉn, h·∫ßu h·∫øt c√°c prompt li√™n quan ƒë·∫øn an to√†n ƒë·ªÅu ƒë∆∞·ª£c gi·∫£i quy·∫øt. ƒê·ªÉ gi·ªØ s·ª± c√¢n b·∫±ng c·ªßa c√°c prompt kh√°c nhau, b·∫Øt ƒë·∫ßu t·ª´ v√≤ng th·ª© hai, ch√∫ng t√¥i tham gia v√†o red-teaming con ng∆∞·ªùi ƒë·ªÉ thu th·∫≠p th√™m prompt. (b) S·ªë l∆∞·ª£ng c√°c lo·∫°i c·∫∑p ph·∫£n h·ªìi kh√°c nhau trong ba v√≤ng l·∫∑p RLHF.

4 TH·ª∞C NGHI·ªÜM

Trong ph·∫ßn n√†y, ch√∫ng t√¥i tr√¨nh b√†y c√°c th·ª±c nghi·ªám ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ ƒë√°nh gi√° hi·ªáu qu·∫£ c·ªßa pipeline Safe RLHF trong c·∫£ vi·ªác tƒÉng c∆∞·ªùng an to√†n m√¥ h√¨nh v√† th√∫c ƒë·∫©y hi·ªáu su·∫•t c·ªßa n√≥. Ch√∫ng t√¥i c·ª• th·ªÉ gi·∫£i quy·∫øt c√°c c√¢u h·ªèi nghi√™n c·ª©u sau:

‚Ä¢ Safe RLHF c√≥ th·ªÉ ƒë·ªìng th·ªùi c·∫£i thi·ªán t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i c·ªßa LLM kh√¥ng? (Ph·∫ßn 4.2.1)
‚Ä¢ Nh·ªØng l·ª£i √≠ch n√†o ph√°t sinh t·ª´ vi·ªác t√°ch bi·ªát ri√™ng bi·ªát t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i? (Ph·∫ßn 4.2.2)
‚Ä¢ Safe RLHF ƒëi·ªÅu h∆∞·ªõng s·ª± cƒÉng th·∫≥ng v·ªën c√≥ gi·ªØa c√°c m·ª•c ti√™u t·ªëi ∆∞u h√≥a k√©p v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i nh∆∞ th·∫ø n√†o? (Ph·∫ßn 4.2.3)

H∆°n n·ªØa, ch√∫ng t√¥i ti·∫øn h√†nh m·ªôt th·ª±c nghi·ªám ablation ƒë·ªÉ l√†m r√µ thi·∫øt k·∫ø c·ª• th·ªÉ c·ªßa M√¥ h√¨nh Chi ph√≠ ƒë∆∞·ª£c trang b·ªã kh·∫£ nƒÉng ph√¢n lo·∫°i (Ph·∫ßn 4.2.4). T·ªïng h·ª£p, nh·ªØng th·ª±c nghi·ªám n√†y nh·∫±m cung c·∫•p m·ªôt ƒë√°nh gi√° to√†n di·ªán v·ªÅ ·∫£nh h∆∞·ªüng c·ªßa Safe RLHF ƒë·ªëi v·ªõi an to√†n v√† hi·ªáu su·∫•t c·ªßa LLM trong c√°c b·ªëi c·∫£nh th·ª±c t·∫ø.

4.1 CHI TI·∫æT TH·ª∞C NGHI·ªÜM

Ch√∫ng t√¥i ch·ª©ng minh hi·ªáu qu·∫£ c·ªßa pipeline b·∫±ng c√°ch tinh ch·ªânh l·∫∑p ƒëi l·∫∑p l·∫°i m√¥ h√¨nh SFT ban ƒë·∫ßu b·∫±ng pipeline Safe RLHF trong ba chu k·ª≥. M·ªói chu k·ª≥ bao g·ªìm Red Teaming (lo·∫°i tr·ª´ v√≤ng ƒë·∫ßu ti√™n), t·∫°o v√† ch√∫ th√≠ch d·ªØ li·ªáu s·ªü th√≠ch con ng∆∞·ªùi, hu·∫•n luy·ªán M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng v√† M√¥ h√¨nh Chi ph√≠, v√† tinh ch·ªânh Safe RL. Chi ti·∫øt th·ª±c hi·ªán v√† c√°c si√™u tham s·ªë hu·∫•n luy·ªán c√≥ s·∫µn trong Ph·ª• l·ª•c B v√† Ph·ª• l·ª•c C.1.

M√¥ h√¨nh SFT ban ƒë·∫ßu. C√°c th·ª±c nghi·ªám ch√≠nh c·ªßa ch√∫ng t√¥i b·∫Øt ƒë·∫ßu v·ªõi m√¥ h√¨nh Alpaca-7B (t√°i t·∫°o). M√¥ h√¨nh n√†y ƒë∆∞·ª£c d·∫´n xu·∫•t t·ª´ vi·ªác tinh ch·ªânh h∆∞·ªõng d·∫´n LLaMA-7B (Touvron et al., 2023a) s·ª≠ d·ª•ng t·∫≠p d·ªØ li·ªáu m√£ ngu·ªìn m·ªü Alpaca (Taori et al., 2023), t·ª± h√†o v·ªõi 52K tr∆∞·ªùng h·ª£p tu√¢n theo h∆∞·ªõng d·∫´n. Ch√∫ng t√¥i ch·ªçn Alpaca-7B l√†m m√¥ h√¨nh ban ƒë·∫ßu v√¨ hai l√Ω do ch√≠nh. ƒê·∫ßu ti√™n, Alpaca-7B th·ªÉ hi·ªán c√°c kh·∫£ nƒÉng tr·ª£ l√Ω chat thi·∫øt y·∫øu v√† c√≥ k√≠ch th∆∞·ªõc m√¥ h√¨nh ph√π h·ª£p, t·∫°o ƒëi·ªÅu ki·ªán cho vi·ªác th·ª±c hi·ªán ƒë·∫ßy ƒë·ªß pipeline Safe RLHF. Th·ª© hai, Alpaca-7B c√≥ kh·∫£ nƒÉng t·∫°o ra c·∫£ ph·∫£n h·ªìi v√¥ h·∫°i v√† c√≥ th·ªÉ c√≥ h·∫°i, cung c·∫•p c√°c ph·∫£n h·ªìi ƒëa d·∫°ng cho c√°c prompt gi·ªëng h·ªát nhau, nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 3b. S·ª≠ d·ª•ng Alpaca-7B l√†m ƒëi·ªÉm xu·∫•t ph√°t trong nhi·ªÅu l·∫ßn tinh ch·ªânh RL l·∫∑p ƒëi l·∫∑p l·∫°i cho ph√©p ch√∫ng t√¥i nh·∫≠n bi·∫øt r√µ r√†ng h∆°n c√°c c·∫£i thi·ªán trong an to√†n v√† ti·ªán √≠ch c·ªßa LLM khi s·ª≠ d·ª•ng pipeline Safe RLHF.

Prompt v√† Red-teaming. ·ªû ƒë·∫ßu m·ªói l·∫ßn l·∫∑p Safe RLHF, ch√∫ng t√¥i ƒëi·ªÅu ch·ªânh h·ªón h·ª£p c√°c lo·∫°i prompt kh√°c nhau ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ hu·∫•n luy·ªán (kh√¥ng li√™n quan ƒë·∫øn an to√†n, li√™n quan ƒë·∫øn an to√†n ƒë√£ gi·∫£i quy·∫øt, li√™n quan ƒë·∫øn an to√†n ch∆∞a gi·∫£i quy·∫øt, v√† nh·ªØng prompt ƒë∆∞·ª£c thu th·∫≠p th√¥ng qua red-teaming), nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 3a. T·∫≠p d·ªØ li·ªáu prompt n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ t·∫°o t·∫≠p d·ªØ li·ªáu s·ªü th√≠ch v√† cho hu·∫•n luy·ªán RL. ƒê·ªëi v·ªõi l·∫ßn l·∫∑p Safe RLHF ƒë·∫ßu ti√™n, c√°c prompt c·ªßa ch√∫ng t√¥i ch·ªß y·∫øu ƒë∆∞·ª£c l·∫•y t·ª´ c√°c t·∫≠p d·ªØ li·ªáu li√™n quan ƒë·∫øn an to√†n m√£ ngu·ªìn m·ªü ƒë∆∞·ª£c tham chi·∫øu trong Ganguli et al. (2022) v√† Sun et al. (2023a). T·ª´ l·∫ßn l·∫∑p th·ª© hai, ch√∫ng t√¥i ƒë√£ –ø—Ä–∏–≤–ªek–∞—Ç—å c√°c nh√† nghi√™n c·ª©u th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng red-teaming ƒë·ªÉ m·ªü r·ªông t·∫≠p prompt c·ªßa ch√∫ng t√¥i. B·∫±ng c√°ch ki·ªÉm tra c√°c cu·ªôc t·∫•n c√¥ng th√†nh c√¥ng, ch√∫ng t√¥i ƒë√£ x√°c ƒë·ªãnh v√† th√™m c√°c prompt ƒë·ªÉ l·ªô ra c√°c l·ªó h·ªïng kh√¥ng c√≥ trong t·∫≠p d·ªØ li·ªáu g·ªëc. Th√™m chi ti·∫øt v√† v√≠ d·ª• c√≥ s·∫µn trong Ph·ª• l·ª•c D.

--- TRANG 7 ---
[H√¨nh 4a, 4b, 4c, 4d ƒë∆∞·ª£c m√¥ t·∫£ trong vƒÉn b·∫£n g·ªëc]

H√¨nh 4: C√°c bi·ªÉu ƒë·ªì ph√¢n t√°n tr√¨nh b√†y ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng v√† chi ph√≠ tr√™n t·∫≠p prompt ƒë√°nh gi√°, nh∆∞ ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi c√°c m√¥ h√¨nh ph·∫ßn th∆∞·ªüng v√† chi ph√≠ th·ªëng nh·∫•t. T·∫•t c·∫£ b·ªën m√¥ h√¨nh s·ª≠ d·ª•ng c√πng m·ªôt t·∫≠p prompt l√†m ƒë·∫ßu v√†o, t·∫°o ph·∫£n h·ªìi th√¥ng qua t√¨m ki·∫øm tham lam. M·ªói ƒëi·ªÉm bi·ªÉu th·ªã c√°c gi√° tr·ªã ph·∫ßn th∆∞·ªüng/chi ph√≠ li√™n quan ƒë·∫øn m·ªôt m·∫´u, bao g·ªìm prompt v√† ph·∫£n h·ªìi t∆∞∆°ng ·ª©ng.

T·∫≠p d·ªØ li·ªáu s·ªü th√≠ch. Sau khi ho√†n thi·ªán c√°c prompt, c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c t·∫°o b·∫±ng m√¥ h√¨nh ƒëang hu·∫•n luy·ªán. Nh·ªØng ph·∫£n h·ªìi n√†y sau ƒë√≥ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng ƒë·ªÉ g·∫Øn nh√£n. Ch√∫ng t√¥i cho ph√©p ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng g·∫Øn nh√£n t·ªâ m·ªâ c√°c c·∫∑p s·ªü th√≠ch kh√¥ng h·ª£p l·ªá. M·ªói prompt s·∫Ω nh·∫≠n ƒë∆∞·ª£c k = 3‚àº6 ph·∫£n h·ªìi duy nh·∫•t, d·∫´n ƒë·∫øn C_k^2 = k(k-1)/2 c·∫∑p s·ªü th√≠ch, nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 3b. Theo s∆° ƒë·ªì ch√∫ th√≠ch m√† ch√∫ng t√¥i thi·∫øt k·∫ø trong Ph·∫ßn 3.1, ch√∫ng t√¥i thu ƒë∆∞·ª£c c√°c t·∫≠p d·ªØ li·ªáu t√°ch bi·ªát cho t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. Th√™m chi ti·∫øt v√† v√≠ d·ª• c√≥ s·∫µn trong Ph·ª• l·ª•c A.

T·∫≠p d·ªØ li·ªáu ƒë√°nh gi√°. Do thi·∫øu c√°c t·∫≠p d·ªØ li·ªáu ƒë√°nh gi√° xem x√©t c·∫£ t√≠nh h·ªØu √≠ch v√† cƒÉn ch·ªânh an to√†n, ch√∫ng t√¥i ƒë√£ x√¢y d·ª±ng t·∫≠p d·ªØ li·ªáu prompt ƒë√°nh gi√° ri√™ng, bao g·ªìm 3 ph·∫ßn: prompt ƒë∆∞·ª£c thi·∫øt k·∫ø t·ªâ m·ªâ cho 14 danh m·ª•c an to√†n, prompt c√≥ ngu·ªìn g·ªëc t·ª´ c√°c t·∫≠p d·ªØ li·ªáu m√£ ngu·ªìn m·ªü (lo·∫°i tr·ª´ kh·ªèi hu·∫•n luy·ªán), v√† 10% prompt ƒë∆∞·ª£c ch·ªçn t·ª´ m·ªói giai ƒëo·∫°n red-teaming. ƒê·ªãnh nghƒ©a c·ªßa 14 danh m·ª•c an to√†n ƒë∆∞·ª£c n√™u chi ti·∫øt trong Ph·ª• l·ª•c A.3.

4.2 K·∫æT QU·∫¢ TH·ª∞C NGHI·ªÜM

4.2.1 ƒê√ÅNH GI√Å T√çNH H·ªÆU √çCH V√Ä T√çNH V√î H·∫†I

ƒê·ªÉ ƒë√°nh gi√° nghi√™m ng·∫∑t hi·ªáu qu·∫£ c·ªßa pipeline Safe RLHF c·ªßa ch√∫ng t√¥i theo hai chi·ªÅu cƒÉn ch·ªânh ‚Äî t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i ‚Äî ch√∫ng t√¥i ph√¢n t√≠ch c√°c m√¥ h√¨nh t·ª´ ba l·∫ßn l·∫∑p Safe RLHF: Beaver-v1, Beaver-v2, v√† Beaver-v3.

Tuy nhi√™n, vi·ªác ƒë√°nh gi√° c√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn lu√¥n l√† m·ªôt v·∫•n ƒë·ªÅ th√°ch th·ª©c v√† ch∆∞a ƒë∆∞·ª£c gi·∫£i quy·∫øt. C√°c benchmark truy·ªÅn th·ªëng th∆∞·ªùng kh√¥ng n·∫Øm b·∫Øt ƒë∆∞·ª£c to√†n b·ªô m·ª©c ƒë·ªô m√† m·ªôt m√¥ h√¨nh cƒÉn ch·ªânh v·ªõi c√°c gi√° tr·ªã con ng∆∞·ªùi. Thi·∫øu s√≥t n√†y ch·ªß y·∫øu do c√°c ti√™u chu·∫©n kh√¥ng nh·∫•t qu√°n v√† k·∫øt qu·∫£ r√µ r√†ng trong ƒë√°nh gi√° cƒÉn ch·ªânh con ng∆∞·ªùi. Do ƒë√≥, ch√∫ng t√¥i ∆∞a th√≠ch ƒë√°nh gi√° c√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn d·ª±a tr√™n ph·∫£n h·ªìi c·ªßa ch√∫ng ƒë·ªëi v·ªõi c√°c prompt c·ª• th·ªÉ. Ch√∫ng t√¥i s·ª≠ d·ª•ng hai ph∆∞∆°ng ph√°p ƒë·ªÉ ƒë√°nh gi√° t·ªïng th·ªÉ. Bao g·ªìm ƒë√°nh gi√° nhanh c√°c m√¥ h√¨nh c·ªßa ch√∫ng t√¥i b·∫±ng M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng v√† M√¥ h√¨nh Chi ph√≠ th·ªëng nh·∫•t ƒë√£ hu·∫•n luy·ªán; d·∫´n xu·∫•t ƒëi·ªÉm Elo b·∫±ng c√°ch so s√°nh ƒë·∫ßu ra m√¥ h√¨nh v·ªõi ƒë√°nh gi√° c·ªßa con ng∆∞·ªùi v√† GPT-4.

ƒê√°nh gi√° d·ª±a tr√™n m√¥ h√¨nh. M·∫∑c d√π ƒë√°nh gi√° con ng∆∞·ªùi v·∫´n l√† ti√™u chu·∫©n v√†ng ƒë·ªÉ cƒÉn ch·ªânh c√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn v·ªõi c√°c gi√° tr·ªã con ng∆∞·ªùi, vi·ªác d·ª±a v√†o ph∆∞∆°ng ph√°p n√†y m·ªôt m√¨nh kh√¥ng th·ª±c t·∫ø c≈©ng kh√¥ng hi·ªáu qu·∫£ do chi ph√≠ th·ªùi gian v√† t√†i ch√≠nh ƒë√°ng k·ªÉ li√™n quan. Nh·ªØng h·∫°n ch·∫ø nh∆∞ v·∫≠y ƒë√≤i h·ªèi c√°c ph∆∞∆°ng ph√°p ƒë√°nh gi√° thay th·∫ø ƒë·ªÉ b·ªï sung cho ƒë√°nh gi√° con ng∆∞·ªùi. Do ƒë√≥, ch√∫ng t√¥i ƒë√£ ph√°t tri·ªÉn m·ªôt M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng th·ªëng nh·∫•t v√† m·ªôt M√¥ h√¨nh Chi ph√≠ th·ªëng nh·∫•t, s·ª≠ d·ª•ng c√°c ph∆∞∆°ng ph√°p hu·∫•n luy·ªán ƒë∆∞·ª£c ƒë·ªÅ c·∫≠p trong Ph·∫ßn 3.2. Nh·ªØng m√¥ h√¨nh n√†y ƒë∆∞·ª£c hu·∫•n luy·ªán tr√™n d·ªØ li·ªáu s·ªü th√≠ch c√¢n b·∫±ng ƒë·ªÅu c√≥ ngu·ªìn g·ªëc t·ª´ t·∫•t c·∫£ c√°c l·∫ßn l·∫∑p Safe RLHF. V·ªõi nh·ªØng m√¥ h√¨nh th·ªëng nh·∫•t n√†y, ch√∫ng t√¥i c√≥ th·ªÉ ƒë√°nh gi√° nhanh ch√≥ng c√°c m√¥ h√¨nh m·ªõi ti·∫øp theo d∆∞·ªõi c√°c ti√™u ch√≠ nh·∫•t qu√°n. ƒê·ªô ch√≠nh x√°c th·ª≠ nghi·ªám cho c√°c m√¥ h√¨nh th·ªëng nh·∫•t ƒë∆∞·ª£c n√™u chi ti·∫øt trong B·∫£ng 1. L∆∞u √Ω r·∫±ng ch√∫ng t√¥i kh√¥ng s·ª≠ d·ª•ng nh·ªØng m√¥ h√¨nh th·ªëng nh·∫•t n√†y ƒë·ªÉ hu·∫•n luy·ªán m·ªôt quy tr√¨nh Safe RLHF v√≤ng ƒë∆°n, v√¨ vi·ªác thu th·∫≠p d·ªØ li·ªáu s·ªü th√≠ch di·ªÖn ra l·∫∑p ƒëi l·∫∑p l·∫°i. Ch√∫ng t√¥i c·∫ßn c√°c m√¥ h√¨nh trung gian cho quy tr√¨nh red-teaming, t·∫°o ƒëi·ªÅu ki·ªán thu th·∫≠p c√°c prompt m·ªõi cho c√°c giai ƒëo·∫°n hu·∫•n luy·ªán ti·∫øp theo.

Nh∆∞ ƒë∆∞·ª£c minh h·ªça trong H√¨nh 4, m√¥ h√¨nh SFT c·ªßa ch√∫ng t√¥i, m√¥ h√¨nh Alpaca-7B (t√°i t·∫°o), c√≥ kh·∫£ nƒÉng t·∫°o ra c·∫£ ph·∫£n h·ªìi v√¥ h·∫°i v√† c√≥ h·∫°i g·∫ßn nh∆∞ ƒë∆∞·ª£c t√°ch bi·ªát ƒë·ªÅu ·ªü m·ªói b√™n c·ªßa ƒë∆∞·ªùng ph√¢n chia c = 0 (H√¨nh 4a). Sau v√≤ng hu·∫•n luy·ªán Safe RLHF ƒë·∫ßu ti√™n, c√≥ s·ª± d·ªãch chuy·ªÉn ƒë√°ng k·ªÉ trong ph√¢n ph·ªëi ph·∫£n h·ªìi m√¥ h√¨nh v·ªÅ ph√≠a b√™n c√≥ chi ph√≠ th·∫•p h∆°n, ng·ª• √Ω ƒë·∫ßu ra an to√†n h∆°n (H√¨nh 4b). Trong l·∫ßn l·∫∑p th·ª© hai c·ªßa Safe RLHF, c√≥ s·ª± gi·∫£m n·ªôi dung c√≥ h·∫°i, ƒë∆∞·ª£c k√Ω hi·ªáu b·ªüi v√πng c > 0 (H√¨nh 4c). Trong l·∫ßn l·∫∑p cu·ªëi c√πng, c·ª•m d·ªØ li·ªáu h∆∞·ªõng v·ªÅ h∆∞·ªõng ph·∫ßn th∆∞·ªüng cao h∆°n, trong khi th√†nh c√¥ng duy tr√¨ ph·∫ßn l·ªõn c√°c ph·∫£n h·ªìi l√† v√¥ h·∫°i (H√¨nh 4d).

ƒê√°nh gi√° GPT-4 v√† con ng∆∞·ªùi. ƒê·ªÉ ƒë√°nh gi√° ch√≠nh x√°c h∆°n, ch√∫ng t√¥i so s√°nh c√°c m√¥ h√¨nh v·ªõi nhau ƒë·ªÉ t·∫°o ra c√°c ƒëi·ªÉm Elo li√™n quan, nh∆∞ ƒë∆∞·ª£c m√¥ t·∫£ trong Askell et al. (2021). C·ª• th·ªÉ, c√°c ƒë√°nh gi√° vi√™n so s√°nh ƒë·∫ßu ra c·ªßa hai m√¥ h√¨nh ƒë·ªÉ ph·∫£n h·ªìi c√πng m·ªôt prompt v√† cung c·∫•p s·ªü th√≠ch c·ªßa h·ªç v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. Sau khi thu ƒë∆∞·ª£c m·ªëi quan h·ªá t·ª∑ l·ªá th·∫Øng c·∫∑p gi·ªØa t·∫•t c·∫£ c√°c m√¥ h√¨nh, ch√∫ng t√¥i kh·ªõp c√°c ƒëi·ªÉm Elo t∆∞∆°ng ·ª©ng (v·ªõi ƒëi·ªÉm ban ƒë·∫ßu l√† 1200). Theo Chiang & Lee (2023), GPT-4 c√≥ th·ªÉ thay th·∫ø c√°c ƒë√°nh gi√° vi√™n con ng∆∞·ªùi trong vi·ªác ƒë√°nh gi√° kh·∫£ nƒÉng cƒÉn ch·ªânh c·ªßa LLM. Do ƒë√≥, ch√∫ng t√¥i ƒë√£ t·ªï ch·ª©c c√°c ƒë√°nh gi√° li√™n quan ƒë·∫øn c·∫£ ƒë√°nh gi√° vi√™n GPT-4 v√† con ng∆∞·ªùi.

Nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 5a v√† 5b, ba v√≤ng Safe RLHF ƒë√£ c·∫£i thi·ªán ƒë√°ng k·ªÉ ƒëi·ªÉm Elo trong c·∫£ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i, nh∆∞ ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi c·∫£ ƒë√°nh gi√° vi√™n GPT-4 v√† con ng∆∞·ªùi. Khi so s√°nh v·ªõi Alpaca-7B, m√¥ h√¨nh Beaver-v3 ƒë√£ ch·ª©ng minh s·ª± gia tƒÉng ƒëi·ªÉm Elo cho t√≠nh h·ªØu √≠ch (GPT-4: +244.91, Con ng∆∞·ªùi: +363.86) v√† cho t√≠nh v√¥ h·∫°i (GPT-4: +268.31, Con ng∆∞·ªùi: +237.98). T∆∞∆°ng ƒë·ªëi, c√°c ƒë√°nh gi√° b·ªüi GPT-4 v√† ƒë√°nh gi√° vi√™n con ng∆∞·ªùi g·∫ßn nh∆∞ nh·∫•t qu√°n. ƒê√°ng ch√∫ √Ω, b·∫Øt ƒë·∫ßu t·ª´ v√≤ng th·ª© hai, ch√∫ng t√¥i kh·ªüi x∆∞·ªõng c√°c cu·ªôc t·∫•n c√¥ng red teaming ƒë·ªÉ m·ªü r·ªông ph·∫°m vi c√°c prompt li√™n quan ƒë·∫øn an to√†n. ƒêi·ªÅu n√†y gi√∫p hi·ªáu qu·∫£ trong vi·ªác l√†m cho c√°c m√¥ h√¨nh hu·∫•n luy·ªán Safe RLHF tr·ªü n√™n v√¥ h·∫°i h∆°n. Trong v√≤ng th·ª© ba, v√¨ m√¥ h√¨nh ƒë√£ ƒë·ªß an to√†n, Safe RLHF c√≥ xu h∆∞·ªõng ∆∞u ti√™n duy tr√¨ m·ª©c ƒë·ªô v√¥ h·∫°i hi·ªán t·∫°i h∆°n l√† t·ªëi ∆∞u h√≥a qu√° m·ª©c. ƒêi·ªÅu n√†y c≈©ng ph·∫£n √°nh c√°c ƒë·∫∑c t√≠nh ƒëi·ªÅu ch·ªânh ƒë·ªông v·ªën c√≥ c·ªßa Safe RLHF.

Trong khi ƒë√≥, ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng c·ªßa ch√∫ng t√¥i c≈©ng g·∫Øn nh√£n li·ªáu c√°c ph·∫£n h·ªìi c·ªßa m√¥ h√¨nh c√≥ an to√†n hay kh√¥ng, nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 5c. Th√¥ng qua ba v√≤ng hu·∫•n luy·ªán Safe RLHF, x√°c su·∫•t ph·∫£n h·ªìi c√≥ h·∫°i c·ªßa m√¥ h√¨nh Beaver-v3 tr√™n t·∫≠p ƒë√°nh gi√° ƒë√£ gi·∫£m t·ª´ 53.08% ƒë·ªëi v·ªõi Alpaca-7B xu·ªëng 2.45%. ƒê·ªëi v·ªõi c√°c prompt c·ª• th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong ƒë√°nh gi√° GPT-4, vui l√≤ng tham kh·∫£o Ph·ª• l·ª•c C.2.

4.2.2 VI·ªÜC T√ÅCH BI·ªÜT T√çNH V√î H·∫†I V√Ä T√çNH H·ªÆU √çCH

Trong ph·∫ßn n√†y, ch√∫ng t√¥i nh·∫±m ch·ª©ng minh l·ª£i √≠ch c·ªßa vi·ªác t√°ch bi·ªát r√µ r√†ng t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch trong pipeline Safe RLHF. Ch√∫ng t√¥i s·ª≠ d·ª•ng c√°c ph·∫£n h·ªìi ƒë∆∞·ª£c thu th·∫≠p t·ª´ v√≤ng ƒë·∫ßu ti√™n c·ªßa Safe RLHF ƒë·ªÉ th·ª±c hi·ªán g·∫Øn nh√£n s·ªü th√≠ch v√† hu·∫•n luy·ªán PPO theo ph∆∞∆°ng ph√°p RLHF th√¥ng th∆∞·ªùng. Trong qu√° tr√¨nh g·∫Øn nh√£n s·ªü th√≠ch, ƒëi·ªÉm kh√°c bi·ªát l√† ch·ªâ cung c·∫•p m·ªôt s·ªü th√≠ch to√†n di·ªán, trong khi c√°c kh√≠a c·∫°nh kh√°c cƒÉn ch·ªânh v·ªõi Safe RLHF.

So v·ªõi ch√∫ th√≠ch v√† hu·∫•n luy·ªán m·ªôt chi·ªÅu, ch√∫ng t√¥i quan s√°t c√°c l·ª£i th·∫ø sau c·ªßa Safe RLHF: ƒê·∫ßu ti√™n, vi·ªác t√°ch bi·ªát c√°c ch√∫ th√≠ch cho t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i d·∫´n ƒë·∫øn T·ª∑ l·ªá Th·ªèa thu·∫≠n Gi·ªØa c√°c ƒê√°nh gi√° vi√™n cao h∆°n trong s·ªë ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng, ƒë√≥ l√† T√≠nh h·ªØu √≠ch: 69.00% v√† An to√†n: 66.53% so v·ªõi 61.65%. Th·ª© hai, s·ª± th·ªèa thu·∫≠n gi·ªØa ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng v√† c√°c nh√† nghi√™n c·ª©u (t·ª©c l√† t·ª∑ l·ªá ph√™ duy·ªát) c≈©ng ƒë∆∞·ª£c tƒÉng l√™n. Trong ch√∫ th√≠ch m·ªôt chi·ªÅu, t·ª∑ l·ªá ph√™ duy·ªát trung b√¨nh trong qu√° tr√¨nh ki·ªÉm tra ch·∫•t l∆∞·ª£ng 10% gi·∫£m t·ª´ √≠t nh·∫•t 90% ƒë·ªô ch√≠nh x√°c xu·ªëng d∆∞·ªõi 80%. Th·ª© ba, nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 6a, vi·ªác s·ª≠ d·ª•ng d·ªØ li·ªáu tr√™n cho hu·∫•n luy·ªán PPO d·∫´n ƒë·∫øn c·∫£i thi·ªán ƒë√°ng ch√∫ √Ω trong t√≠nh h·ªØu √≠ch. Tuy nhi√™n, vi·ªác tƒÉng c∆∞·ªùng t√≠nh v√¥ h·∫°i √≠t h∆°n ƒë√°ng k·ªÉ so v·ªõi nh·ªØng g√¨ ƒë·∫°t ƒë∆∞·ª£c b·ªüi Safe RLHF. Ng∆∞·ª£c l·∫°i, Safe RLHF cho ph√©p ƒëi·ªÅu ch·ªânh ch·ªß quan trong giai ƒëo·∫°n hu·∫•n luy·ªán ƒë·ªÉ c√¢n b·∫±ng t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i.

--- TRANG 8 ---
[B·∫£ng 1 v√† c√°c h√¨nh ƒë∆∞·ª£c m√¥ t·∫£ trong vƒÉn b·∫£n g·ªëc]

B·∫£ng 1: ƒê·ªô ch√≠nh x√°c th·ª≠ nghi·ªám cho M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng v√† M√¥ h√¨nh Chi ph√≠ cho ba giai ƒëo·∫°n hu·∫•n luy·ªán Safe RLHF. C√°c m√¥ h√¨nh s·ªü th√≠ch th·ªëng nh·∫•t ƒë∆∞·ª£c hu·∫•n luy·ªán v√† th·ª≠ nghi·ªám tr√™n d·ªØ li·ªáu s·ªü th√≠ch c√¢n b·∫±ng ƒë·ªÅu t·ª´ t·∫≠p d·ªØ li·ªáu s·ªü th√≠ch ƒë∆∞·ª£c s·ª≠ d·ª•ng trong ba l·∫ßn l·∫∑p Safe RLHF.

M√¥ h√¨nh | Metric | Beaver-v1 | Beaver-v2 | Beaver-v3 | Th·ªëng nh·∫•t
---|---|---|---|---|---
M√¥ h√¨nh Ph·∫ßn th∆∞·ªüng | ƒê·ªô ch√≠nh x√°c X·∫øp h·∫°ng | 78.13% | 75.73% | 77.32% | 73.95%
M√¥ h√¨nh Chi ph√≠ | ƒê·ªô ch√≠nh x√°c X·∫øp h·∫°ng | 74.47% | 76.07% | 74.17% | 70.44%
 | ƒê·ªô ch√≠nh x√°c Ph√¢n lo·∫°i An to√†n | 95.62% | 84.54% | 85.88% | 85.83%

--- TRANG 9 ---
[H√¨nh 5a, 5b, 5c v√† H√¨nh 6a, 6b, 6c ƒë∆∞·ª£c m√¥ t·∫£ trong vƒÉn b·∫£n g·ªëc]

H√¨nh 5: (a) ƒêi·ªÉm Elo v·ªÅ t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch cho Alpaca-7B, v√† c√°c m√¥ h√¨nh Beaver-v1 ƒë·∫øn Beaver-v3. So s√°nh m√¥ h√¨nh c·∫∑p ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi GPT-4. (b) ƒêi·ªÉm Elo v·ªÅ t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch cho Alpaca-7B, v√† c√°c m√¥ h√¨nh Beaver-v1 ƒë·∫øn Beaver-v3. So s√°nh m√¥ h√¨nh c·∫∑p ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi Con ng∆∞·ªùi. (c) T·ª∑ l·ªá ph·∫£n h·ªìi m√¥ h√¨nh ƒë∆∞·ª£c g·∫Øn c·ªù v√¥ h·∫°i b·ªüi con ng∆∞·ªùi tr√™n t·∫≠p ƒë√°nh gi√°. L∆ØU √ù: ƒêi·ªÉm Elo trong (a) (b) cho m√¥ h√¨nh Alpaca-7B ƒë∆∞·ª£c chu·∫©n h√≥a th·ªß c√¥ng th√†nh 1000.

H√¨nh 6: (a) T·ª∑ l·ªá th·∫Øng v·ªÅ t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch cho Safe RLHF v√† c√°c ph∆∞∆°ng ph√°p kh√°c so v·ªõi m√¥ h√¨nh SFT (Alpaca-7B). ƒê∆∞·ªùng cong ƒë·ª©t n√©t l√† ƒë∆∞·ªùng cong ti·ªám c·∫≠n cho c√°c ph∆∞∆°ng ph√°p reward shaping (RS) nh∆∞ ƒë∆∞·ª£c th·ªÉ hi·ªán trong (b). (b) T·ª∑ l·ªá th·∫Øng v·ªÅ t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch cho Safe RLHF v√† c√°c ph∆∞∆°ng ph√°p reward shaping (RS) v·ªõi c√°c h·ªá s·ªë kh√°c nhau so v·ªõi m√¥ h√¨nh SFT (Alpaca-7B). (c) ƒê∆∞·ªùng cong hu·∫•n luy·ªán cho nh√¢n t·ª≠ Lagrange Œª v√† chi ph√≠ trung b√¨nh di ƒë·ªông trong l·∫ßn l·∫∑p Safe RLHF ƒë·∫ßu ti√™n. L∆ØU √ù: T·ª∑ l·ªá th·∫Øng v·ªÅ t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch trong (a) (b) ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi GPT-4.

4.2.3 C√ÇN B·∫∞NG GI·ªÆA M·ª§C TI√äU T√çNH V√î H·∫†I V√Ä M·ª§C TI√äU T√çNH H·ªÆU √çCH

ƒê·ªÉ nh·∫•n m·∫°nh t·∫ßm quan tr·ªçng c·ªßa vi·ªác c√¢n b·∫±ng ƒë·ªông c√°c m·ª•c ti√™u t√≠nh v√¥ h·∫°i v√† t√≠nh h·ªØu √≠ch trong qu√° tr√¨nh hu·∫•n luy·ªán RL, ch√∫ng t√¥i so s√°nh Safe RLHF v·ªõi ph∆∞∆°ng ph√°p reward shaping (RS) s·ª≠ d·ª•ng c√¢n b·∫±ng tƒ©nh. C·ª• th·ªÉ, ph∆∞∆°ng ph√°p reward shaping ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác c√¢n nh·∫Øc hai h√†m m·ª•c ti√™u ·ªü t·ª∑ l·ªá c·ªë ƒë·ªãnh trong qu√° tr√¨nh hu·∫•n luy·ªán RL, t·ª©c l√† R_ŒΩ(y, x) = R_œï(y, x) - ŒΩ ¬∑ C_œà(y, x). C√°c th·ª±c nghi·ªám c·ªßa ch√∫ng t√¥i ƒë√£ th·ª≠ nghi·ªám r·ªông r√£i b·∫£y tr·ªçng s·ªë reward shaping kh√°c nhau ŒΩ, c·ª• th·ªÉ l√† 0.01, 0.5, 1, 2, 5, 10, v√† 100.

K·∫øt qu·∫£ hu·∫•n luy·ªán ƒë∆∞·ª£c th·ªÉ hi·ªán trong H√¨nh 6b. Hai k·∫øt lu·∫≠n c√≥ th·ªÉ ƒë∆∞·ª£c r√∫t ra t·ª´ c√°c quan s√°t: tr·ªçng s·ªë reward shaping qu√° cao (ŒΩ = 5,10,100) v√† qu√° th·∫•p (ŒΩ = 0.01,0.5) d·∫´n ƒë·∫øn t·ªëi ∆∞u h√≥a qu√° m·ª©c m·ªôt m·ª•c ti√™u v·ªõi s·ª± hy sinh c·ªßa m·ª•c ti√™u kh√°c. Tr·ªçng s·ªë reward shaping v·ª´a ph·∫£i (ŒΩ = 1,2) v·∫´n kh√¥ng th·ªÉ gi·∫£i quy·∫øt hi·ªáu qu·∫£ s·ª± cƒÉng th·∫≥ng gi·ªØa c√°c m·ª•c ti√™u t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i, v·ªõi c√°c c·∫£i thi·ªán c·ªßa ch√∫ng v·∫´n k√©m h∆°n Safe RLHF.

T∆∞∆°ng ƒë·ªëi, Safe RLHF ƒë√°nh gi√° t√≠nh v√¥ h·∫°i c·ªßa c√°c m√¥ h√¨nh b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c gi√° tr·ªã chi ph√≠ trung b√¨nh, sau ƒë√≥ c·∫≠p nh·∫≠t nh√¢n t·ª≠ Lagrange Œª. Khi m√¥ h√¨nh th·ªèa m√£n c√°c r√†ng bu·ªôc an to√†n, Safe RLHF s·ª≠ d·ª•ng nh√¢n t·ª≠ Lagrange nh·ªè h∆°n ƒë·ªÉ b·∫£o t·ªìn t√≠nh v√¥ h·∫°i Œª, t·ª´ ƒë√≥ tr√°nh t·ªëi ∆∞u h√≥a qu√° m·ª©c, nh∆∞ ƒë∆∞·ª£c minh h·ªça trong H√¨nh 6c.

4.2.4 THI·∫æT K·∫æ M√î H√åNH S·ªû TH√çCH CHI PH√ç

M·ªôt thi·∫øt k·∫ø quan tr·ªçng c·ªßa Safe RLHF l√† M√¥ h√¨nh Chi ph√≠, ƒë·ªìng th·ªùi kh·ªõp c·∫£ s·ªü th√≠ch con ng∆∞·ªùi v√† nh√£n an to√†n. S·ªü th√≠ch con ng∆∞·ªùi cung c·∫•p h∆∞·ªõng cho t·ªëi ∆∞u h√≥a, trong khi d·ª± ƒëo√°n nh√£n an to√†n t·∫°o ƒëi·ªÅu ki·ªán cho s·ª± c√¢n b·∫±ng ƒë·ªông c·ªßa c√°c m·ª•c ti√™u t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. S·ª± t√≠ch h·ª£p th√†nh c√¥ng n√†y ƒë√≥ng g√≥p v√†o th√†nh c√¥ng c·ªßa Safe RLHF. ƒê·ªÉ ch·ª©ng minh ƒëi·ªÅu n√†y, ch√∫ng t√¥i ƒë√£ so s√°nh Safe RLHF v·ªõi vi·ªác hu·∫•n luy·ªán s·ª≠ d·ª•ng logits c·ªßa m·ªôt b·ªô ph√¢n lo·∫°i an to√†n l√†m t√≠n hi·ªáu chi ph√≠ (Glaese et al., 2022). Nh∆∞ ƒë∆∞·ª£c minh h·ªça trong H√¨nh 6a (CM-classifier), hi·ªáu qu·∫£ c·ªßa ph∆∞∆°ng ph√°p sau trong vi·ªác c·∫£i thi·ªán t√≠nh v√¥ h·∫°i k√©m h∆°n ƒë√°ng k·ªÉ so v·ªõi Safe RLHF. M·∫∑t kh√°c, vi·ªác lo·∫°i b·ªè kh·∫£ nƒÉng ph√¢n lo·∫°i c·ªßa M√¥ h√¨nh Chi ph√≠, v√† kh√¥ng c·∫≠p nh·∫≠t c√°c nh√¢n t·ª≠ Lagrange, d·∫´n ƒë·∫øn s·ª± suy gi·∫£m th√†nh ph∆∞∆°ng ph√°p Reward Shaping.

5 C√ÅC NGHI√äN C·ª®U LI√äN QUAN

M√¥ h√¨nh Ng√¥n ng·ªØ L·ªõn (LLM) S·ª± ph√°t tri·ªÉn c·ªßa LLM ƒë√£ l√† m·ªôt lƒ©nh v·ª±c nghi√™n c·ª©u quan tr·ªçng trong nh·ªØng nƒÉm g·∫ßn ƒë√¢y. Ph·∫ßn n√†y th·∫£o lu·∫≠n v·ªÅ c√°c nghi√™n c·ª©u li√™n quan t·ª´ g√≥c ƒë·ªô c·ªßa ba giai ƒëo·∫°n hu·∫•n luy·ªán LLM. C√°c m√¥ h√¨nh ti·ªÅn hu·∫•n luy·ªán nh∆∞ T5 (Raffel et al., 2020), GPT-3 (Brown et al., 2020), BLOOM (Scao et al., 2022), v√† LLaMA (Touvron et al., 2023a;b) ƒë∆∞·ª£c ti·∫øp x√∫c v·ªõi m·ªôt kho d·ªØ li·ªáu vƒÉn b·∫£n kh√¥ng nh√£n kh·ªïng l·ªì v√† ƒë∆∞·ª£c hu·∫•n luy·ªán s·ª≠ d·ª•ng c√°c m·ª•c ti√™u h·ªçc kh√¥ng gi√°m s√°t, ch·∫≥ng h·∫°n nh∆∞ d·ª± ƒëo√°n t·ª´ ti·∫øp theo trong m·ªôt chu·ªói. Tinh ch·ªânh H∆∞·ªõng d·∫´n (IFT) ƒë√£ ƒë∆∞·ª£c kh√°m ph√° v·ªõi c√°c m√¥ h√¨nh nh∆∞ T0 (Sanh et al., 2021), Flan-T5 (Chung et al., 2022), v√† Instruct-GPT (Ouyang et al., 2022). Nh·ªØng m√¥ h√¨nh n√†y ƒë∆∞·ª£c tinh ch·ªânh t·ª´ c√°c m√¥ h√¨nh ti·ªÅn hu·∫•n luy·ªán s·ª≠ d·ª•ng d·ªØ li·ªáu c√≥ nh√£n c·ª• th·ªÉ cho nhi·ªám v·ª•, m·ªôt b∆∞·ªõc quan tr·ªçng ƒë·ªÉ c√°c m√¥ h√¨nh tu√¢n theo h∆∞·ªõng d·∫´n v√† ho√†n th√†nh nhi·ªám v·ª•. Nhi·ªÅu nghi√™n c·ª©u tr∆∞·ªõc ƒë√¢y ƒë√£ kh√°m ph√° c√°c t√°c h·∫°i ti·ªÅm ·∫©n c·ªßa vi·ªác truy c·∫≠p c√¥ng c·ªông v√†o LLM. Weidinger et al. (2021; 2022) ph√°c th·∫£o s√°u lƒ©nh v·ª±c r·ªßi ro ƒë·∫°o ƒë·ª©c v√† x√£ h·ªôi li√™n quan ƒë·∫øn nh·ªØng m√¥ h√¨nh n√†y. Rauh et al. (2022) ph√¢n t√≠ch c√°c ƒë·∫∑c t√≠nh c·ªßa vƒÉn b·∫£n c√≥ h·∫°i. Shevlane et al. (2023) th·∫£o lu·∫≠n v·ªÅ c√°c r·ªßi ro c·ª±c ƒëoan, bao g·ªìm c√°c kh·∫£ nƒÉng nguy hi·ªÉm v√† s·ª± m·∫•t cƒÉn ch·ªânh. V·∫•n ƒë·ªÅ v·ªÅ thi√™n ki·∫øn x√£ h·ªôi trong vi·ªác t·∫°o ng√¥n ng·ªØ ƒë∆∞·ª£c Sheng et al. (2021) gi·∫£i quy·∫øt, trong khi Abid et al. (2021) t·∫≠p trung r√µ r√†ng v√†o thi√™n ki·∫øn b·∫°o l·ª±c-H·ªìi gi√°o dai d·∫≥ng trong LLM. Deshpande et al. (2023) ki·ªÉm tra t√≠nh ƒë·ªôc h·∫°i trong ChatGPT, l√†m n·ªïi b·∫≠t c√°c v·∫•n ƒë·ªÅ nh∆∞ c√°c ƒë·ªãnh ki·∫øn kh√¥ng ch√≠nh x√°c, ƒë·ªëi tho·∫°i c√≥ h·∫°i, v√† √Ω ki·∫øn g√¢y t·ªïn th∆∞∆°ng.

H·ªçc tƒÉng c∆∞·ªùng t·ª´ ph·∫£n h·ªìi con ng∆∞·ªùi (RLHF) Trong khi LLM ƒë√£ xu·∫•t s·∫Øc trong c√°c nhi·ªám v·ª• NLP kh√°c nhau, ƒë√¥i khi ch√∫ng th·ªÉ hi·ªán c√°c h√†nh vi b·∫•t ng·ªù nh∆∞ t·∫°o ra th√¥ng tin kh√¥ng ch√≠nh x√°c ho·∫∑c ƒë∆∞a ra c√°c ph·∫£n h·ªìi thi√™n l·ªách, g√¢y hi·ªÉu l·∫ßm v√† c√≥ h·∫°i (Bai et al., 2022a;b; Koco≈Ñ et al., 2023; Sun et al., 2023b). RLHF cho ph√©p LLM ti·∫øn b·ªô v·ªÅ c√°c m·ª•c ti√™u ƒëa d·∫°ng h∆°n b·∫±ng c√°ch h·ªçc t·ª´ ph·∫£n h·ªìi con ng∆∞·ªùi (Ouyang et al., 2022; Yuan et al., 2023; Rafailov et al., 2023; Song et al., 2023; Yang et al., 2023). Do thi√™n ki·∫øn v√† nhi·ªÖu trong ph·∫£n h·ªìi con ng∆∞·ªùi (Wu et al., 2023), m·ªôt s·ªë ph∆∞∆°ng ph√°p t·ªëi ∆∞u h√≥a tr√™n m·ªôt s·ªü th√≠ch duy nh·∫•t c√≥ th·ªÉ d·∫´n m√¥ h√¨nh ƒë·∫øn m·ªôt s·ªë gi·∫£i ph√°p t·ªëi ∆∞u ƒë·ªãa ph∆∞∆°ng (Casper et al., 2023). M·ªôt s·ªë ph∆∞∆°ng ph√°p hi·ªán c√≥ tinh ch·ªânh c√°c thu·ªôc t√≠nh kh√°c nhau v√† s·ª≠ d·ª•ng c√°c m√¥ h√¨nh kh√°c nhau ƒë·ªÉ kh·ªõp ch√∫ng. D·ª±a tr√™n nh·ªØng m√¥ h√¨nh n√†y, LLM ƒë∆∞·ª£c h∆∞·ªõng d·∫´n tinh ch·ªânh ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng c√°c m√¥ h√¨nh t√≠ch h·ª£p nhi·ªÅu thu·ªôc t√≠nh. Tuy nhi√™n, ph∆∞∆°ng ph√°p n√†y ƒë√≤i h·ªèi ƒëi·ªÅu ch·ªânh th·ªß c√¥ng tr·ªçng s·ªë gi·ªØa ph·∫ßn th∆∞·ªüng v√† chi ph√≠ (t∆∞∆°ng t·ª± nh∆∞ reward shaping) (Touvron et al., 2023b), khi·∫øn vi·ªác tri·ªÉn khai nhanh ch√≥ng trong c√°c t√¨nh hu·ªëng ·ª©ng d·ª•ng kh√°c nhau tr·ªü n√™n th√°ch th·ª©c. Ng∆∞·ª£c l·∫°i, ph∆∞∆°ng ph√°p c·ªßa ch√∫ng t√¥i t√°ch bi·ªát H·ªØu √≠ch v√† V√¥ h·∫°i, t·ª± ƒë·ªông ƒëi·ªÅu ch·ªânh s·ª± ƒë√°nh ƒë·ªïi gi·ªØa ph·∫ßn th∆∞·ªüng v√† chi ph√≠ d·ª±a tr√™n c√°c ng∆∞·ª°ng ƒë∆∞·ª£c ƒë·ªãnh tr∆∞·ªõc, v√† ƒë·∫£m b·∫£o r·∫±ng m√¥ h√¨nh t·∫°o ra c√°c ph·∫£n h·ªìi ch·∫•t l∆∞·ª£ng cao trong khi cung c·∫•p m·ª©c ƒë·ªô an to√†n cao h∆°n. Qu√° tr√¨nh n√†y c√≥ th·ªÉ ƒë∆∞·ª£c m·ªü r·ªông cho c√°c t√¨nh hu·ªëng v∆∞·ª£t ra ngo√†i H·ªØu √≠ch v√† V√¥ h·∫°i.

6 H·∫†N CH·∫æ V√Ä NGHI√äN C·ª®U T∆Ø∆†NG LAI

Nghi√™n c·ª©u n√†y c√≥ m·ªôt s·ªë h·∫°n ch·∫ø ƒë√°ng ch√∫ √Ω. M·ªôt h·∫°n ch·∫ø ch√≠nh l√† d·ªØ li·ªáu ti·ªÅn hu·∫•n luy·ªán kh√¥ng th·ªÉ truy c·∫≠p; ch√∫ng t√¥i ƒë√£ s·ª≠ d·ª•ng T·∫≠p d·ªØ li·ªáu Stanford Alpaca (Taori et al., 2023) cho PTX loss (tham kh·∫£o Ph·ª• l·ª•c B.2 ƒë·ªÉ bi·∫øt th√™m chi ti·∫øt) trong su·ªët c·∫£ ba v√≤ng l·∫∑p Safe RLHF. Ngo√†i ra, ch√∫ng t√¥i kh√¥ng c√≥ ƒë∆∞·ª£c m·ªôt kho d·ªØ li·ªáu SFT ch·∫•t l∆∞·ª£ng cao m·ªü r·ªông, c√≥ th·ªÉ tƒÉng c∆∞·ªùng hi·ªáu su·∫•t c·ªßa m√¥ h√¨nh v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. M·∫∑c d√π cƒÉn ch·ªânh an to√†n ƒë√£ ƒë∆∞·ª£c ƒë·∫°t ƒë∆∞·ª£c th√¥ng qua tinh ch·ªânh m√¥ h√¨nh, vi·ªác k·∫øt h·ª£p c√°c chi·∫øn l∆∞·ª£c ki·ªÉm tra tr∆∞·ªõc v√† sau c≈©ng ƒë∆∞·ª£c b·∫£o ƒë·∫£m. Cu·ªëi c√πng, nh∆∞ th∆∞·ªùng th·∫•y v·ªõi c√°c nghi√™n c·ª©u RLHF kh√°c (Bai et al., 2022a), chi ph√≠ t√†i ch√≠nh l√† ƒë√°ng k·ªÉ.

Ch√∫ng t√¥i d·ª± ƒë·ªãnh m·ªü r·ªông khung hi·ªán t·∫°i ƒë·ªÉ bao g·ªìm nhi·ªÅu danh m·ª•c s·ªü th√≠ch h∆°n ngo√†i c√°c bi·ªán ph√°p hi·ªán t·∫°i v·ªÅ t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. ƒê·ªìng th·ªùi, m√¥ h√¨nh Safe RLHF hi·ªán t·∫°i ho·∫°t ƒë·ªông trong gi·ªõi h·∫°n c·ªßa c√°c cu·ªôc tr√≤ chuy·ªán m·ªôt l∆∞·ª£t. M·ªôt t√°i h√¨nh th·ª©c h√≥a cho c√°c b·ªëi c·∫£nh tr√≤ chuy·ªán nhi·ªÅu l∆∞·ª£t l√† m·ªôt lƒ©nh v·ª±c ti·ªÅm nƒÉng ƒë·ªÉ m·ªü r·ªông, ƒë·ªÉ tƒÉng c∆∞·ªùng kh·∫£ nƒÉng ·ª©ng d·ª•ng c·ªßa n√≥. Cu·ªëi c√πng, nghi√™n c·ª©u c·ªßa ch√∫ng t√¥i ƒë∆∞·ª£c th·ª±c hi·ªán b·∫±ng d·ªØ li·ªáu t·ª´ c√°c m√¥ h√¨nh Llama-1 (Touvron et al., 2023a) v√† Alpaca (Taori et al., 2023) ƒë∆∞·ª£c xem x√©t tr∆∞·ªõc Llama-2 (Touvron et al., 2023b). ƒêi·ªÅu n√†y g·ª£i √Ω r·∫±ng vi·ªác chuy·ªÉn sang Llama-2 l√†m m√¥ h√¨nh ti·ªÅn hu·∫•n luy·ªán c∆° s·ªü c√≥ th·ªÉ th√∫c ƒë·∫©y m·ª©c ƒë·ªô hi·ªáu su·∫•t.

7 TH·∫¢O LU·∫¨N ƒê·∫†O ƒê·ª®C

ƒê·ªÉ th√∫c ƒë·∫©y h∆°n n·ªØa nghi√™n c·ª©u v·ªÅ cƒÉn ch·ªânh an to√†n trong c√°c m√¥ h√¨nh ng√¥n ng·ªØ l·ªõn, ch√∫ng t√¥i ƒëang ph√°t h√†nh m·ªôt t·∫≠p d·ªØ li·ªáu m√£ ngu·ªìn m·ªü cho vi·ªác hu·∫•n luy·ªán l·∫∑p ƒëi l·∫∑p l·∫°i c√°c m√¥ h√¨nh ph·∫ßn th∆∞·ªüng v√† chi ph√≠. Bao g·ªìm trong t·∫≠p d·ªØ li·ªáu n√†y l√† c√°c prompt red-team, ph·ª•c v·ª• ƒë·ªÉ ƒë√°nh gi√° c√°c l·ªó h·ªïng trong c∆° ch·∫ø an to√†n c·ªßa m√¥ h√¨nh m·ª•c ti√™u.

Ch√∫ng t√¥i th·ª´a nh·∫≠n c√°c r·ªßi ro v·ªën c√≥ c·ªßa vi·ªác l√†m cho m·ªôt t·∫≠p d·ªØ li·ªáu red-team c√≥ th·ªÉ truy c·∫≠p c√¥ng khai, do kh·∫£ nƒÉng l·∫°m d·ª•ng. M·ªôt k·∫ª x·∫•u c√≥ th·ªÉ khai th√°c t√†i nguy√™n n√†y ƒë·ªÉ tinh ch·ªânh m·ªôt m√¥ h√¨nh ng√¥n ng·ªØ v·ªõi c√°c m·ª•c ti√™u ƒë·∫£o ng∆∞·ª£c c√≥ th·ªÉ c√≥ h·∫°i ƒë·∫øn ph√∫c l·ª£i c√¥ng c·ªông. Ch√∫ng t√¥i m·∫°nh m·∫Ω kh√¥ng khuy·∫øn kh√≠ch nh·ªØng ho·∫°t ƒë·ªông nh∆∞ v·∫≠y v√† ·ªßng h·ªô vi·ªác s·ª≠ d·ª•ng c√≥ tr√°ch nhi·ªám t·∫≠p d·ªØ li·ªáu c·ªßa ch√∫ng t√¥i.

Lao ƒë·ªông c√¥ng b·∫±ng v√† ƒë·∫°o ƒë·ª©c H·ª£p ƒë·ªìng ƒë√£ k√Ω v·ªõi ƒë·ªëi t√°c d·ªØ li·ªáu c·ªßa ch√∫ng t√¥i ch·ªâ ra m·ª©c l∆∞∆°ng trung b√¨nh theo gi·ªù ∆∞·ªõc t√≠nh ƒë∆∞·ª£c tr·∫£ cho ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng dao ƒë·ªông t·ª´ 7.02 ƒë·∫øn 9.09 USD, cao g·∫•p 1.98x ‚àº 2.56x so v·ªõi m·ª©c trung b√¨nh theo gi·ªù ƒë·ªãa ph∆∞∆°ng. Tu√¢n th·ªß lu·∫≠t lao ƒë·ªông ƒë·ªãa ph∆∞∆°ng, ng∆∞·ªùi l√†m vi·ªác ƒë√°m ƒë√¥ng c·ªßa ch√∫ng t√¥i c√≥ c√°c ng√†y l√†m vi·ªác t√°m gi·ªù c√≥ c·∫•u tr√∫c v√† ngh·ªâ cu·ªëi tu·∫ßn. Ch√∫ng t√¥i c≈©ng ∆∞u ti√™n s·ª©c kh·ªèe tinh th·∫ßn c·ªßa h·ªç b·∫±ng c√°ch cung c·∫•p c√°c cu·ªôc g·∫∑p m·∫∑t tr·ª±c ti·∫øp th∆∞·ªùng xuy√™n ƒë·ªÉ gi·∫£m thi·ªÉu cƒÉng th·∫≥ng v√† tƒÉng c∆∞·ªùng kh·∫£ nƒÉng ph·ª•c h·ªìi.

8 K·∫æT LU·∫¨N

Nghi√™n c·ª©u n√†y t√°c ƒë·ªông ƒë√°ng k·ªÉ ƒë·∫øn an to√†n c·ªßa c√°c h·ªá th·ªëng AI d·ª±a tr√™n LLM, t·∫≠p trung v√†o c√°ch gi·∫£i quy·∫øt s·ª± cƒÉng th·∫≥ng gi·ªØa t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i trong qu√° tr√¨nh tinh ch·ªânh LLM. Ch√∫ng t√¥i th·ª´a nh·∫≠n r·∫±ng t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i th∆∞·ªùng xung ƒë·ªôt trong h·∫ßu h·∫øt c√°c t√¨nh hu·ªëng, khi·∫øn vi·ªác tr·ªôn l·∫´n ch√∫ng th√†nh m·ªôt m·ª•c ti√™u hu·∫•n luy·ªán duy nh·∫•t tr·ªü n√™n kh√¥ng ƒë√°ng tin c·∫≠y. M√¥ h√¨nh cƒÉn ch·ªânh an to√†n c·ªßa ch√∫ng t√¥i, Safe RLHF, l√† s·ª± t√≠ch h·ª£p ƒë·∫ßu ti√™n c·ªßa khung Safe RL v√† RLHF. Insight c·ªët l√µi c·ªßa Safe RLHF l√† vi·ªác t√°ch bi·ªát s·ªü th√≠ch con ng∆∞·ªùi trong qu√° tr√¨nh ch√∫ th√≠ch v√† m·ªôt Œª-trade-off cho c√°c m·ª•c ti√™u k√©p t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i. Trong c√°c th·ª±c nghi·ªám c·ªßa ch√∫ng t√¥i, ch√∫ng t√¥i ƒë√£ √°p d·ª•ng ba v√≤ng khung Safe RLHF ƒë·ªÉ tinh ch·ªânh m√¥ h√¨nh c∆° s·ªü SFT. K·∫øt qu·∫£ ƒë√°nh gi√° ch·ªâ ra r·∫±ng Safe RLHF hi·ªáu qu·∫£ tƒÉng c∆∞·ªùng t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i c·ªßa LLM. So v·ªõi thu·∫≠t to√°n, Reward Shaping, c√¢n b·∫±ng tƒ©nh hai m·ª•c ti√™u t·ªëi ∆∞u h√≥a Safe RLHF ƒëi·ªÅu h∆∞·ªõng t·ªët h∆°n s·ª± cƒÉng th·∫≥ng gi·ªØa c√°c m·ª•c ti√™u t√≠nh h·ªØu √≠ch v√† t√≠nh v√¥ h·∫°i.

T√ÄI LI·ªÜU THAM KH·∫¢O

[Danh s√°ch t√†i li·ªáu tham kh·∫£o ti·∫øp t·ª•c v·ªõi c√°c nghi√™n c·ª©u ƒë∆∞·ª£c tr√≠ch d·∫´n trong b√†i b√°o...]
