# 2306.07541.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/rl-alignment/2306.07541.pdf
# KÃ­ch thÆ°á»›c file: 1074903 bytes

===============================================
Ná»˜I DUNG FILE PDF
===============================================


--- TRANG 1 ---
Má»™t Khung LÃ m Viá»‡c Thá»‘ng Nháº¥t ÄÆ¡n Giáº£n HÆ°á»›ng Dáº«n Bá»Ÿi Äá»™ Báº¥t Äá»‹nh cho
Há»c TÄƒng CÆ°á»ng Offline-Ä‘áº¿n-Online
Siyuan Guo1,âˆ—Yanchao Sun2Jifeng Hu1Sili Huang1Xing Chen1
Hechang Chen1Haiyin Piao3Lichao Sun4Yi Chang1
1Khoa TrÃ­ Tuá»‡ NhÃ¢n Táº¡o, Äáº¡i há»c CÃ¡t LÃ¢m
2Khoa Khoa Há»c MÃ¡y TÃ­nh, Äáº¡i há»c Maryland
3Äáº¡i há»c CÃ´ng Nghá»‡ TÃ¢y Báº¯c4Äáº¡i há»c Lehigh
âˆ—guosyjlu@gmail.com
TÃ³m Táº¯t
Há»c tÄƒng cÆ°á»ng offline (RL) cung cáº¥p má»™t giáº£i phÃ¡p Ä‘áº§y há»©a háº¹n Ä‘á»ƒ há»c má»™t
agent hoÃ n toÃ n dá»±a vÃ o mÃ´ hÃ¬nh dá»¯ liá»‡u. Tuy nhiÃªn, bá»‹ háº¡n cháº¿ bá»Ÿi cháº¥t lÆ°á»£ng
háº¡n cháº¿ cá»§a táº­p dá»¯ liá»‡u offline, hiá»‡u suáº¥t cá»§a nÃ³ thÆ°á»ng lÃ  dÆ°á»›i má»©c tá»‘i Æ°u. Do Ä‘Ã³,
viá»‡c tiáº¿p tá»¥c tinh chá»‰nh agent thÃ´ng qua cÃ¡c tÆ°Æ¡ng tÃ¡c online bá»• sung trÆ°á»›c khi
triá»ƒn khai lÃ  mong muá»‘n. Tháº­t khÃ´ng may, RL offline-Ä‘áº¿n-online cÃ³ thá»ƒ gáº·p thÃ¡ch
thá»©c do hai thÃ¡ch thá»©c chÃ­nh: hÃ nh vi khÃ¡m phÃ¡ bá»‹ háº¡n cháº¿ vÃ  sá»± dá»‹ch chuyá»ƒn phÃ¢n
phá»‘i state-action. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t khung lÃ m viá»‡c
Simple Unified u Ncertainty-Guided (SUNG), tá»± nhiÃªn thá»‘ng nháº¥t giáº£i phÃ¡p cho
cáº£ hai thÃ¡ch thá»©c vá»›i cÃ´ng cá»¥ Ä‘á»™ báº¥t Ä‘á»‹nh. Cá»¥ thá»ƒ, SUNG Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh
thÃ´ng qua má»™t bá»™ Æ°á»›c tÃ­nh máº­t Ä‘á»™ truy cáº­p state-action dá»±a trÃªn VAE. Äá»ƒ táº¡o
Ä‘iá»u kiá»‡n khÃ¡m phÃ¡ hiá»‡u quáº£, SUNG trÃ¬nh bÃ y má»™t chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan
thá»±c táº¿ Ä‘á»ƒ chá»n cÃ¡c hÃ nh Ä‘á»™ng thÃ´ng tin cÃ³ cáº£ giÃ¡ trá»‹ cao vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh cao. HÆ¡n
ná»¯a, SUNG phÃ¡t triá»ƒn má»™t phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng báº±ng cÃ¡ch Ã¡p dá»¥ng
cÃ¡c má»¥c tiÃªu RL offline báº£o thá»§ cho cÃ¡c máº«u cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh cao vÃ  cÃ¡c má»¥c tiÃªu
RL online tiÃªu chuáº©n cho cÃ¡c máº«u cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh tháº¥p Ä‘á»ƒ káº¿t ná»‘i mÆ°á»£t mÃ  cÃ¡c
giai Ä‘oáº¡n offline vÃ  online. SUNG Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tinh chá»‰nh online tiÃªn tiáº¿n
nháº¥t khi káº¿t há»£p vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ¡c nhau, trÃªn nhiá»u mÃ´i trÆ°á»ng
vÃ  táº­p dá»¯ liá»‡u khÃ¡c nhau trong benchmark D4RL.1
1 Giá»›i Thiá»‡u
Há»c tÄƒng cÆ°á»ng offline (RL) [27], cho phÃ©p cÃ¡c agent há»c tá»« má»™t táº­p dá»¯ liá»‡u cá»‘ Ä‘á»‹nh mÃ  khÃ´ng
tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng, Ä‘Ã£ thá»ƒ hiá»‡n thÃ nh cÃ´ng Ä‘Ã¡ng ká»ƒ trong nhiá»u nhiá»‡m vá»¥ mÃ  viá»‡c tÆ°Æ¡ng tÃ¡c
tá»‘n kÃ©m hoáº·c rá»§i ro [5,26,46]. Tuy nhiÃªn, mÃ´ hÃ¬nh há»c dá»±a trÃªn dá»¯ liá»‡u nhÆ° váº­y vá»‘n dÄ© giá»›i háº¡n
hiá»‡u suáº¥t cá»§a agent vÃ¬ nÃ³ hoÃ n toÃ n dá»±a vÃ o má»™t táº­p dá»¯ liá»‡u thÆ°á»ng dÆ°á»›i má»©c tá»‘i Æ°u [25,45]. Äá»ƒ
kháº¯c phá»¥c váº¥n Ä‘á» nÃ y, cá»™ng Ä‘á»“ng RL Ä‘Ã£ khÃ¡m phÃ¡ cÃ i Ä‘áº·t offline-Ä‘áº¿n-online, káº¿t há»£p cÃ¡c tÆ°Æ¡ng tÃ¡c
online bá»• sung Ä‘á»ƒ tinh chá»‰nh thÃªm cÃ¡c agent RL offline Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c [25, 32, 45, 49].
Trong khi mÃ´ hÃ¬nh pretraining-finetuning trong RL offline-Ä‘áº¿n-online lÃ  tá»± nhiÃªn vÃ  trá»±c quan, viá»‡c
cung cáº¥p cáº£i thiá»‡n online mong Ä‘á»£i cÃ³ thá»ƒ gáº·p thÃ¡ch thá»©c trong thá»±c táº¿ do hai thÃ¡ch thá»©c chÃ­nh: (1)
HÃ nh vi khÃ¡m phÃ¡ bá»‹ háº¡n cháº¿: CÃ¡c má»¥c tiÃªu RL offline báº£o thá»§, yÃªu cáº§u cÃ¡c agent thá»±c hiá»‡n cÃ¡c
hÃ nh Ä‘á»™ng trong pháº¡m vi há»— trá»£ cá»§a táº­p dá»¯ liá»‡u trong quÃ¡ trÃ¬nh pretraining, cÃ³ thá»ƒ háº¡n cháº¿ hÃ nh vi
khÃ¡m phÃ¡ cá»§a cÃ¡c agent cho cÃ¡c tÆ°Æ¡ng tÃ¡c online. Káº¿t quáº£ lÃ , chÃºng khÃ´ng thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c khÃ¡m phÃ¡
hiá»‡u quáº£, vÃ  do Ä‘Ã³ khÃ´ng thá»ƒ táº­n dá»¥ng Ä‘áº§y Ä‘á»§ mÃ´ hÃ¬nh thá»­-vÃ -sai trong RL online. (2) Sá»± dá»‹ch
chuyá»ƒn phÃ¢n phá»‘i state-action: Trong giai Ä‘oáº¡n finetuning, cÃ¡c agent cÃ³ thá»ƒ gáº·p pháº£i cÃ¡c cháº¿ Ä‘á»™
state-action khÃ´ng quen thuá»™c náº±m ngoÃ i
1CÃ´ng trÃ¬nh nÃ y Ä‘Ã£ Ä‘Æ°á»£c gá»­i Ä‘áº¿n IEEE Ä‘á»ƒ cÃ³ thá»ƒ xuáº¥t báº£n. Báº£n quyá»n cÃ³ thá»ƒ Ä‘Æ°á»£c chuyá»ƒn giao mÃ  khÃ´ng
thÃ´ng bÃ¡o, sau Ä‘Ã³ phiÃªn báº£n nÃ y cÃ³ thá»ƒ khÃ´ng cÃ²n truy cáº­p Ä‘Æ°á»£c.
Preprint. Äang xem xÃ©t.arXiv:2306.07541v2  [cs.LG]  21 Feb 2024

--- TRANG 2 ---
pháº¡m vi há»— trá»£ cá»§a táº­p dá»¯ liá»‡u. Do Ä‘Ã³, sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action giá»¯a dá»¯ liá»‡u offline
vÃ  online xáº£y ra, dáº«n Ä‘áº¿n lá»—i ngoáº¡i suy ná»•i tiáº¿ng [13,23] trong quÃ¡ trÃ¬nh khai thÃ¡c, cÃ³ thá»ƒ xÃ³a bá»
viá»‡c khá»Ÿi táº¡o tá»‘t thu Ä‘Æ°á»£c tá»« giai Ä‘oáº¡n pretraining. NghiÃªn cá»©u hiá»‡n táº¡i thÆ°á»ng táº­p trung vÃ o giáº£i
quyáº¿t má»™t khÃ­a cáº¡nh cá»§a cÃ¡c thÃ¡ch thá»©c trÃªn báº±ng cÃ¡ch phÃ¡t triá»ƒn khÃ¡m phÃ¡ hiá»‡u quáº£
[49,33] hoáº·c khai thÃ¡c hiá»‡u quáº£ [25,48,45], dáº«n Ä‘áº¿n cáº£i thiá»‡n offline-Ä‘áº¿n-online háº¡n cháº¿.
Tuy nhiÃªn, viá»‡c Ä‘á»“ng thá»i giáº£i quyáº¿t cáº£ hai thÃ¡ch thá»©c mang láº¡i khÃ³ khÄƒn bá»• sung do xung Ä‘á»™t vá»‘n
cÃ³ giá»¯a khÃ¡m phÃ¡ vÃ  khai thÃ¡c: khÃ¡m phÃ¡ máº¡nh máº½ cÃ³ thá»ƒ lÃ m tráº§m trá»ng thÃªm sá»± dá»‹ch chuyá»ƒn phÃ¢n
phá»‘i, trong khi khai thÃ¡c báº£o thá»§ cÃ³ thá»ƒ cáº£n trá»Ÿ cÃ¡c agent khá»i tinh chá»‰nh online hiá»‡u quáº£.
Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i nháº±m cung cáº¥p má»™t giáº£i phÃ¡p thá»‘ng nháº¥t cho cáº£ hai thÃ¡ch thá»©c Ä‘á»ƒ
cÃ³ hiá»‡u quáº£ máº«u tá»‘t hÆ¡n trong quÃ¡ trÃ¬nh tinh chá»‰nh online. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i nháº­n ra
ráº±ng cáº£ hai thÃ¡ch thá»©c Ä‘á»u gáº¯n liá»n cháº·t cháº½ vá»›i viá»‡c xÃ¡c Ä‘á»‹nh vÃ  xá»­ lÃ½ thÃ­ch há»£p cÃ¡c cáº·p state-action
chÆ°a tháº¥y. Cá»¥ thá»ƒ, khÃ¡m phÃ¡ hiá»‡u quáº£ Ä‘Ã²i há»i khÃ¡m phÃ¡ cÃ¡c vÃ¹ng thÃ´ng tin chÆ°a tháº¥y cá»§a khÃ´ng
gian state-action. HÆ¡n ná»¯a, khai thÃ¡c hiá»‡u quáº£ cáº§n Ä‘áº·c tÃ­nh hÃ³a chÃ­nh xÃ¡c dá»¯ liá»‡u ngoÃ i phÃ¢n phá»‘i
(OOD) Ä‘á»ƒ trÃ¡nh há»c chÃ­nh sÃ¡ch quÃ¡ báº£o thá»§ hoáº·c quÃ¡ máº¡nh máº½. Do Ä‘Ã³, chÃºng tÃ´i táº­n dá»¥ng Ä‘á»‹nh
lÆ°á»£ng vÃ  sá»­ dá»¥ng thÃ­ch há»£p Ä‘á»™ báº¥t Ä‘á»‹nh [24,3,1,40] Ä‘á»ƒ tá»± nhiÃªn giáº£i quyáº¿t cáº£ hai thÃ¡ch thá»©c vÃ  Ä‘áº¡t
Ä‘Æ°á»£c sá»± cÃ¢n báº±ng mong muá»‘n giá»¯a khÃ¡m phÃ¡ vÃ  khai thÃ¡c.
Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y má»™t khung lÃ m viá»‡c Simple Unified u Ncertainty
Guided (SUNG), cung cáº¥p má»™t giáº£i phÃ¡p chung cho RL offline-Ä‘áº¿n-online Ä‘á»ƒ cho phÃ©p tinh chá»‰nh
cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá»›i cÃ¡c má»¥c tiÃªu RL offline khÃ¡c nhau. KhÃ´ng giá»‘ng nhÆ° cÃ¡c
phÆ°Æ¡ng phÃ¡p RL nháº­n thá»©c Ä‘á»™ báº¥t Ä‘á»‹nh gáº§n Ä‘Ã¢y dá»±a vÃ o ká»¹ thuáº­t ensemble Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t
Ä‘á»‹nh [3,1,24], SUNG sá»­ dá»¥ng má»™t cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£ Æ°á»›c tÃ­nh máº­t Ä‘á»™ truy cáº­p
state-action vá»›i má»™t bá»™ mÃ£ hÃ³a tá»± Ä‘á»™ng biáº¿n phÃ¢n (VAE) [18] Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh state-action.
TrÃ¡i ngÆ°á»£c vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline-Ä‘áº¿n-online trÆ°á»›c Ä‘Ã¢y, SUNG Ä‘á»“ng thá»i giáº£i quyáº¿t cáº£
hai thÃ¡ch thá»©c báº±ng cÃ¡ch táº­n dá»¥ng cÃ´ng cá»¥ Ä‘á»™ báº¥t Ä‘á»‹nh. Cá»¥ thá»ƒ, chÃºng tÃ´i phÃ¡t triá»ƒn má»™t chiáº¿n lÆ°á»£c
khÃ¡m phÃ¡ láº¡c quan thá»±c táº¿ tuÃ¢n theo nguyÃªn táº¯c láº¡c quan khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t Ä‘á»‹nh [4,2]. Ã tÆ°á»Ÿng
chÃ­nh á»Ÿ Ä‘Ã¢y lÃ  chá»n nhá»¯ng cáº·p state-action cÃ³ cáº£ giÃ¡ trá»‹ Q cao vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh cao cho khÃ¡m phÃ¡ hiá»‡u
quáº£. ChÃºng tÃ´i cÅ©ng Ä‘á» xuáº¥t má»™t phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng Ä‘á»ƒ xá»­ lÃ½ sá»± dá»‹ch chuyá»ƒn phÃ¢n
phá»‘i state-action báº±ng cÃ¡ch xÃ¡c Ä‘á»‹nh vÃ  háº¡n cháº¿ cÃ¡c máº«u OOD. ThÃ´ng tin quan trá»ng lÃ  táº­n dá»¥ng
cÃ¡c má»¥c tiÃªu RL offline báº£o thá»§ cho cÃ¡c máº«u cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh cao, vÃ  cÃ¡c má»¥c tiÃªu RL online tiÃªu
chuáº©n cho cÃ¡c máº«u cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh tháº¥p. Äiá»u nÃ y cho phÃ©p cÃ¡c agent thÃ­ch á»©ng mÆ°á»£t mÃ  vá»›i cÃ¡c
thay Ä‘á»•i trong phÃ¢n phá»‘i state-action. HÆ¡n ná»¯a, chÃºng tÃ´i sá»­ dá»¥ng bá»™ Ä‘á»‡m phÃ¡t láº¡i offline-Ä‘áº¿n-online
(OORB) [48] Ä‘á»ƒ káº¿t há»£p dá»¯ liá»‡u offline vÃ  online trong quÃ¡ trÃ¬nh finetuning. ÄÃ¡ng chÃº Ã½, nhá»¯ng
hiá»ƒu biáº¿t cá»§a SUNG cÃ³ thá»ƒ Ã¡p dá»¥ng chung vÃ  cÃ³ thá»ƒ káº¿t há»£p vá»›i háº§u háº¿t cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline
khÃ´ng mÃ´ hÃ¬nh vá» nguyÃªn táº¯c. Vá» máº·t thá»±c nghiá»‡m, SUNG hÆ°á»Ÿng lá»£i tá»« viá»‡c xem xÃ©t Ä‘á»™ báº¥t Ä‘á»‹nh
Ä‘á»ƒ hÆ°á»›ng dáº«n cáº£ khÃ¡m phÃ¡ vÃ  khai thÃ¡c, do Ä‘Ã³ vÆ°á»£t qua cÃ¡c phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n nháº¥t trÃªn cÃ¡c
benchmark D4RL [10], vá»›i 14.54% vÃ  14.80% cáº£i thiá»‡n offline-Ä‘áº¿n-online trung bÃ¬nh bá»• sung so
vá»›i baseline tá»‘t nháº¥t trong cÃ¡c miá»n MuJoCo vÃ  AntMaze, tÆ°Æ¡ng á»©ng.
TÃ³m Táº¯t ÄÃ³ng GÃ³p. (1) ChÃºng tÃ´i Ä‘á» xuáº¥t má»™t khung lÃ m viá»‡c chung SUNG cho RL offline-Ä‘áº¿n-online
hiá»‡u quáº£ máº«u, cÃ³ thá»ƒ káº¿t há»£p vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline hiá»‡n cÃ³, nhÆ° TD3+BC
[11] vÃ  CQL [23]. (2) ChÃºng tÃ´i giá»›i thiá»‡u má»™t chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan thÃ´ng qua lá»±a chá»n
hÃ nh Ä‘á»™ng hai cáº¥p Ä‘á»ƒ chá»n cÃ¡c hÃ nh Ä‘á»™ng thÃ´ng tin cho khÃ¡m phÃ¡ hiá»‡u quáº£. (3) ChÃºng tÃ´i phÃ¡t
triá»ƒn má»™t phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng vá»›i xÃ¡c Ä‘á»‹nh vÃ  Ä‘iá»u chá»‰nh máº«u OOD Ä‘á»ƒ káº¿t ná»‘i mÆ°á»£t
mÃ  cÃ¡c má»¥c tiÃªu RL offline vÃ  RL online. (4) Káº¿t quáº£ thá»±c nghiá»‡m chá»©ng minh ráº±ng SUNG vÆ°á»£t
trá»™i so vá»›i tiÃªn tiáº¿n nháº¥t trÆ°á»›c Ä‘Ã¢y khi káº¿t há»£p vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ¡c nhau, trÃªn
nhiá»u loáº¡i mÃ´i trÆ°á»ng vÃ  táº­p dá»¯ liá»‡u khÃ¡c nhau.
2 CÃ´ng TrÃ¬nh LiÃªn Quan
RL Offline. RL Offline [27] nháº±m há»c má»™t chÃ­nh sÃ¡ch chá»‰ tá»« má»™t táº­p dá»¯ liá»‡u offline cá»‘ Ä‘á»‹nh. Háº§u
háº¿t cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y trong RL offline Ä‘Ã£ Ä‘Æ°á»£c dÃ nh riÃªng Ä‘á»ƒ giáº£i quyáº¿t lá»—i ngoáº¡i suy do
truy váº¥n hÃ m giÃ¡ trá»‹ vá»›i cÃ¡c hÃ nh Ä‘á»™ng OOD [13,23]. Do Ä‘Ã³, viá»‡c háº¡n cháº¿ chÃ­nh sÃ¡ch Ä‘Ã£ há»c Ä‘á»ƒ
thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng trong táº­p há»— trá»£ cá»§a táº­p dá»¯ liá»‡u offline lÃ  quan trá»ng. CÃ¡c chiáº¿n lÆ°á»£c phá»•
biáº¿n bao gá»“m rÃ ng buá»™c chÃ­nh sÃ¡ch [13,22,11,39], Ä‘iá»u chá»‰nh giÃ¡ trá»‹ [23,31,20,3], v.v. Tuy nhiÃªn,
cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y Ä‘Ã£ chá»‰ ra ráº±ng hiá»‡u suáº¥t cá»§a agent RL offline thÆ°á»ng bá»‹ giá»›i háº¡n bá»Ÿi cháº¥t
lÆ°á»£ng cá»§a cÃ¡c táº­p dá»¯ liá»‡u
[34, 25], Ä‘iá»u nÃ y thÃºc Ä‘áº©y Ä‘iá»u tra thÃªm cho cÃ i Ä‘áº·t offline-Ä‘áº¿n-online.
RL Offline-Ä‘áº¿n-Online. RL Offline-Ä‘áº¿n-online bao gá»“m pretraining vá»›i RL offline vÃ  finetuning
thÃ´ng qua cÃ¡c tÆ°Æ¡ng tÃ¡c online. Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p RL offline tá»± nhiÃªn há»— trá»£ tinh chá»‰nh online
tiáº¿p tá»¥c vá»›i cÃ¡c má»¥c tiÃªu RL offline liÃªn tá»¥c [39,31,21]. Tuy nhiÃªn, chÃºng thÆ°á»ng cÃ³ xu hÆ°á»›ng quÃ¡
báº£o thá»§ vÃ  cho káº¿t quáº£ cáº£i thiá»‡n hiá»‡u suáº¥t háº¡n cháº¿ [44]. BÃªn cáº¡nh Ä‘Ã³, má»™t sá»‘ cÃ¡ch tiáº¿p cáº­n RL
offline-Ä‘áº¿n-online Ä‘Æ°á»£c
2

--- TRANG 3 ---
thiáº¿t káº¿ cho má»™t phÆ°Æ¡ng phÃ¡p RL offline cá»¥ thá»ƒ [49,35,47,30]. VÃ­ dá»¥, ODT [49] giá»›i thiá»‡u
RL entropy cá»±c Ä‘áº¡i Ä‘á»ƒ tinh chá»‰nh DT [6]. ABCR [47] Ä‘á» xuáº¥t ná»›i lá»ng thÃ­ch á»©ng cÃ¡c má»¥c tiÃªu
báº£o thá»§ cá»§a TD3+BC [11]. NgÆ°á»£c láº¡i, chÃºng tÃ´i táº­p trung vÃ o khung lÃ m viá»‡c RL offline-Ä‘áº¿n-online
chung cÃ³ thá»ƒ káº¿t há»£p vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ¡c nhau [25,33,48,45]. CÃ¡c cÃ´ng trÃ¬nh
trÆ°á»›c thÆ°á»ng giáº£i quyáº¿t cÃ¡c thÃ¡ch thá»©c cá»§a háº¡n cháº¿ khÃ¡m phÃ¡ vÃ  sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action.
Äá»‘i vá»›i cÃ¡i trÆ°á»›c, O3F [33] sá»­ dá»¥ng kiáº¿n thá»©c trong cÃ¡c hÃ m giÃ¡ trá»‹ Ä‘á»ƒ hÆ°á»›ng dáº«n khÃ¡m phÃ¡, nhÆ°ng
nÃ³ khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline dá»±a trÃªn Ä‘iá»u chá»‰nh giÃ¡ trá»‹. Äá»‘i vá»›i cÃ¡i sau,
BR [25] sá»­ dá»¥ng ká»¹ thuáº­t ensemble cÃ¹ng vá»›i bá»™ Ä‘á»‡m phÃ¡t láº¡i cÃ¢n báº±ng Æ°u tiÃªn cÃ¡c máº«u gáº§n-on-policy.
APL [48] Ä‘á» xuáº¥t táº­n dá»¥ng cÃ¡c lá»£i tháº¿ khÃ¡c nhau cá»§a dá»¯ liá»‡u offline vÃ  dá»¯ liá»‡u online Ä‘á»ƒ há»c chÃ­nh
sÃ¡ch thÃ­ch á»©ng. PEX [45] Ä‘Ã³ng bÄƒng cÃ¡c chÃ­nh sÃ¡ch Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vÃ  huáº¥n luyá»‡n má»™t chÃ­nh
sÃ¡ch má»›i tá»« Ä‘áº§u sá»­ dá»¥ng chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ thÃ­ch á»©ng Ä‘á»ƒ trÃ¡nh xÃ³a cÃ¡c chÃ­nh sÃ¡ch Ä‘Æ°á»£c huáº¥n
luyá»‡n trÆ°á»›c. KhÃ´ng giá»‘ng nhÆ° cÃ¡c cÃ¡ch tiáº¿p cáº­n Ä‘Ã£ nÃªu trÃªn, SUNG thá»‘ng nháº¥t hai thÃ¡ch thá»©c báº±ng
cÃ¡ch nháº¥n máº¡nh viá»‡c Æ°á»›c tÃ­nh vÃ  sá»­ dá»¥ng thÃ­ch há»£p Ä‘á»™ báº¥t Ä‘á»‹nh.
Äá»™ Báº¥t Äá»‹nh cho RL. RL nháº­n thá»©c Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c thÃ nh cÃ´ng Ä‘Ã¡ng chÃº Ã½ trong cáº£ RL
online vÃ  offline [28]. Vá» RL online, má»™t chá»§ Ä‘á» ná»•i báº­t trong khÃ¡m phÃ¡ lÃ  nghiÃªn cá»©u vá» Ä‘á»™ báº¥t
Ä‘á»‹nh nháº­n thá»©c, dáº«n Ä‘áº¿n sá»± phÃ¡t triá»ƒn cá»§a nguyÃªn táº¯c láº¡c quan ná»•i tiáº¿ng khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t
Ä‘á»‹nh [4,2,8,7,24]. Trong bá»‘i cáº£nh RL offline, cáº£ hai cÃ¡ch tiáº¿p cáº­n dá»±a trÃªn mÃ´ hÃ¬nh [17,15,43] vÃ 
khÃ´ng dá»±a trÃªn mÃ´ hÃ¬nh [1,3,40,14] cÃ³ thá»ƒ hÆ°á»Ÿng lá»£i tá»« viá»‡c xem xÃ©t Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vÃ 
xá»­ lÃ½ cÃ¡c hÃ nh Ä‘á»™ng OOD. Tuy nhiÃªn, cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘Ã£ nÃªu trÃªn thÆ°á»ng sá»­ dá»¥ng ká»¹ thuáº­t ensemble
Ä‘á»ƒ Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh, cÃ³ thá»ƒ tá»‘n kÃ©m vá» máº·t tÃ­nh toÃ¡n cáº£ vá» thá»i gian vÃ  tÃ i nguyÃªn huáº¥n luyá»‡n.
NgÆ°á»£c láº¡i, chÃºng tÃ´i Ã¡p dá»¥ng VAE [18] Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t. NgoÃ i ra,
chÃºng tÃ´i nghiÃªn cá»©u cÃ i Ä‘áº·t offline-Ä‘áº¿n-online, Ä‘iá»u nÃ y phÃ¢n biá»‡t cÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i vá»›i
chÃºng.
3 Kiáº¿n Thá»©c CÆ¡ Báº£n
RL. ChÃºng tÃ´i tuÃ¢n theo thiáº¿t láº­p RL tiÃªu chuáº©n cÃ´ng thá»©c hÃ³a mÃ´i trÆ°á»ng nhÆ° má»™t quÃ¡ trÃ¬nh quyáº¿t
Ä‘á»‹nh Markov (MDP) M= (S,A, p, r, Î³), trong Ä‘Ã³ S lÃ  khÃ´ng gian tráº¡ng thÃ¡i, A lÃ  khÃ´ng gian hÃ nh
Ä‘á»™ng, p(sâ€²|s, a) lÃ  phÃ¢n phá»‘i chuyá»ƒn tiáº¿p, r(s, a) lÃ  hÃ m pháº§n thÆ°á»Ÿng, vÃ  Î³âˆˆ[0,1) lÃ  há»‡ sá»‘ chiáº¿t
kháº¥u. Má»¥c tiÃªu cá»§a RL lÃ  tÃ¬m má»™t chÃ­nh sÃ¡ch Ï€(a|s) tá»‘i Ä‘a hÃ³a lá»£i nhuáº­n mong Ä‘á»£i EÏ€[Pâˆ
t=0Î³tr(st, at)].
RL Off-policy. CÃ¡c phÆ°Æ¡ng phÃ¡p RL off-policy, nhÆ° TD3 [12] vÃ  SAC [16], Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng
rá»™ng rÃ£i do hiá»‡u quáº£ máº«u cá»§a chÃºng. CÃ¡c phÆ°Æ¡ng phÃ¡p nÃ y thÆ°á»ng xen káº½ giá»¯a Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch
vÃ  cáº£i thiá»‡n chÃ­nh sÃ¡ch. Cá»¥ thá»ƒ, cho má»™t táº­p dá»¯ liá»‡u phÃ¡t láº¡i kinh nghiá»‡m D, TD3 há»c má»™t chÃ­nh
sÃ¡ch deterministic Ï€Ï•(s) vÃ  má»™t hÃ m giÃ¡ trá»‹ state-action QÎ¸(s, a), Ä‘Æ°á»£c tham sá»‘ hÃ³a bá»Ÿi Ï• vÃ  Î¸,
tÆ°Æ¡ng á»©ng. HÃ m giÃ¡ trá»‹ cÃ³ thá»ƒ Ä‘Æ°á»£c cáº­p nháº­t thÃ´ng qua há»c chÃªnh lá»‡ch thá»i gian (TD) nhÆ°
LQ(Î¸) =E(s,a,r,sâ€²)âˆ¼D[
(QÎ¸(s, a)âˆ’râˆ’Î³QÂ¯Î¸(sâ€², Ï€Ï•(sâ€²)))2], (1)
trong Ä‘Ã³ QÂ¯Î¸ lÃ  máº¡ng giÃ¡ trá»‹ má»¥c tiÃªu Ä‘á»ƒ á»•n Ä‘á»‹nh quÃ¡ trÃ¬nh há»c. Sau Ä‘Ã³, chÃ­nh sÃ¡ch cÃ³ thá»ƒ Ä‘Æ°á»£c
cáº­p nháº­t Ä‘á»ƒ tá»‘i Ä‘a hÃ³a giÃ¡ trá»‹ Q hiá»‡n táº¡i:
LÏ€(Ï•) =Esâˆ¼D[âˆ’QÎ¸(s, Ï€Ï•(s))]. (2)
RL Offline. Trong cÃ i Ä‘áº·t RL offline, agent chá»‰ cÃ³ quyá»n truy cáº­p vÃ o má»™t táº­p dá»¯ liá»‡u cá»‘ Ä‘á»‹nh
D={(s, a, r, sâ€²)}. Máº·c dÃ¹ cÃ¡c phÆ°Æ¡ng phÃ¡p RL off-policy cÃ³ thá»ƒ há»c tá»« dá»¯ liá»‡u Ä‘Æ°á»£c thu tháº­p bá»Ÿi
báº¥t ká»³ chÃ­nh sÃ¡ch nÃ o vá» nguyÃªn táº¯c, chÃºng tháº¥t báº¡i trong cÃ i Ä‘áº·t RL offline. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c
quy cho lá»—i ngoáº¡i suy ná»•i tiáº¿ng [13,23] do truy váº¥n hÃ m giÃ¡ trá»‹ vá»›i cÃ¡c hÃ nh Ä‘á»™ng OOD. Do Ä‘Ã³,
má»™t dÃ²ng nghiÃªn cá»©u RL offline khÃ´ng mÃ´ hÃ¬nh chÃ­nh lÃ  háº¡n cháº¿ chÃ­nh sÃ¡ch Ä‘Ã£ há»c Ä‘á»ƒ thá»±c hiá»‡n
cÃ¡c hÃ nh Ä‘á»™ng trong pháº¡m vi há»— trá»£ cá»§a táº­p dá»¯ liá»‡u theo nhá»¯ng cÃ¡ch khÃ¡c nhau, nhÆ° rÃ ng buá»™c
chÃ­nh sÃ¡ch [11,39], Ä‘iá»u chá»‰nh giÃ¡ trá»‹ [23,20,31] vÃ  v.v. Trong sá»‘ Ä‘Ã³, hai phÆ°Æ¡ng phÃ¡p RL offline
Ä‘áº¡i diá»‡n lÃ  TD3+BC [11] vÃ  CQL [23]. CÃ¡i trÆ°á»›c thÃªm má»™t thuáº­t ngá»¯ Ä‘iá»u chá»‰nh cloning hÃ nh vi
(BC) vÃ o cáº£i thiá»‡n chÃ­nh sÃ¡ch tiÃªu chuáº©n trong TD3:
LTD3+BC
Ï€ (Ï•) =LÏ€(Ï•) +Î»BCE(s,a)âˆ¼D[
(Ï€Ï•(s)âˆ’a)2], (3)
trong Ä‘Ã³ Î»BC cÃ¢n báº±ng máº¥t mÃ¡t cáº£i thiá»‡n chÃ­nh sÃ¡ch tiÃªu chuáº©n vÃ  Ä‘iá»u chá»‰nh BC. NgÆ°á»£c láº¡i, cÃ¡i
sau dÃ¹ng Ä‘áº¿n Æ°á»›c tÃ­nh bi quan dÆ°á»›i cá»§a cÃ¡c giÃ¡ trá»‹ Q trong quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch trong SAC bá»Ÿi
LCQL
Q(Î¸) =LQ(Î¸) +Î»CQL
Esâˆ¼D,aâˆ¼Ï€Ï•[QÎ¸(s, a)] +E(s,a)âˆ¼D[âˆ’QÎ¸(s, a)]
, (4)
trong Ä‘Ã³ Î»CQL biá»ƒu thá»‹ há»‡ sá»‘ cÃ¢n báº±ng. Sau Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ tÃ³m táº¯t chÃ­nh thá»©c cáº£ hai phÆ°Æ¡ng phÃ¡p nhÆ°
Loffline
F (Î˜) = LF(Î˜) + Î»RF(Î˜), (5)
3

--- TRANG 4 ---
ğ‘ğ‘–~ğœ‹ğœ™âˆ™|ğ‘ 
ğ‘ ,ğ‘,ğ‘Ÿ,ğ‘ â€²Táº­p HÃ nh Äá»™ng Chung Káº¿tğ‘ 
OORB:â„’â„±adpÎ˜=â„’â„±Î˜+â„›â„±Î˜:â„’â„±adpÎ˜=â„’â„±Î˜
ğ‘~Pğ‘ğ‘–Táº­p HÃ nh Äá»™ng á»¨ng ViÃªn Cáº¥p 1. 
Chá»n HÃ nh Äá»™ng Top-ğ‘˜-GiÃ¡ Trá»‹
Cáº¥p 2. 
Chá»n HÃ nh Äá»™ng Äá»™ Báº¥t Äá»‹nh Caoğ’°ğ‘ğœ“ğ‘ğœ‘
ğ‘ ,ğ‘,ğ‘Ÿ,ğ‘ â€²Bá»™ Nháº­n Diá»‡n 
Máº«u OOD
: VÃ¹ng GiÃ¡ Trá»‹ Tháº¥p             : VÃ¹ng GiÃ¡ Trá»‹ Cao       : HÃ nh Äá»™ng Äá»™ Báº¥t Äá»‹nh Tháº¥p       : HÃ nh Äá»™ng Äá»™ Báº¥t Äá»‹nh Cao ChÃº thÃ­chğ’°â‰â„’ELBO
(a) KhÃ¡m PhÃ¡ Láº¡c Quan qua Lá»±a Chá»n HÃ nh Äá»™ng Hai Cáº¥p (     ) 
 (b) Khai ThÃ¡c ThÃ­ch á»¨ng vá»›i Nháº­n Diá»‡n Máº«u OOD (     ) HÃ¬nh 1: Tá»•ng quan vá» SUNG. Trong quÃ¡ trÃ¬nh tinh chá»‰nh online, chÃºng tÃ´i xen káº½ giá»¯a (a) chiáº¿n lÆ°á»£c khÃ¡m
phÃ¡ láº¡c quan Ä‘á»ƒ thu tháº­p dá»¯ liá»‡u hÃ nh vi tá»« mÃ´i trÆ°á»ng vÃ  (b) phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng
Ä‘á»ƒ cáº£i thiá»‡n chÃ­nh sÃ¡ch. HÆ¡n ná»¯a, chÃºng tÃ´i Ã¡p dá»¥ng VAE Ä‘á»ƒ Æ°á»›c tÃ­nh máº­t Ä‘á»™ state-action Ä‘á»ƒ Ä‘á»‹nh
lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh, vÃ  OORB Ä‘á»ƒ lÆ°u trá»¯ cáº£ dá»¯ liá»‡u offline vÃ  online. HÃ¬nh nÃ y Ä‘Æ°á»£c xem tá»‘t nháº¥t
vá»›i mÃ u sáº¯c.
trong Ä‘Ã³ F Ä‘áº¡i diá»‡n cho má»™t chÃ­nh sÃ¡ch hoáº·c má»™t hÃ m giÃ¡ trá»‹, Ä‘Æ°á»£c tham sá»‘ hÃ³a bá»Ÿi Î˜, R biá»ƒu thá»‹
má»™t bá»™ Ä‘iá»u chá»‰nh Ä‘á»ƒ ngÄƒn cháº·n lá»—i ngoáº¡i suy, vÃ  Î» cÃ¢n báº±ng máº¥t mÃ¡t tiÃªu chuáº©n vÃ  Ä‘iá»u chá»‰nh.
LÆ°u Ã½ ráº±ng háº§u háº¿t cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ´ng mÃ´ hÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ³m táº¯t nhÆ° Eq.(5)
theo cÃ¡ch rÃµ rÃ ng [23,11,20,39,31] hoáº·c cÃ¡ch ngáº§m [22, 36, 21, 3, 42], Ä‘iá»u nÃ y thÃºc Ä‘áº©y khai
thÃ¡c thÃ­ch á»©ng trong Pháº§n 4.3.
4 SUNG
Trong pháº§n nÃ y, chÃºng tÃ´i trÃ¬nh bÃ y má»™t khung lÃ m viá»‡c hÆ°á»›ng dáº«n Ä‘á»™ báº¥t Ä‘á»‹nh thá»‘ng nháº¥t Ä‘Æ¡n giáº£n
(SUNG) cho RL offline-Ä‘áº¿n-online, nhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong HÃ¬nh 1. Cá»¥ thá»ƒ, SUNG chá»§ Ä‘á»™ng Ä‘á»‹nh
lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh state-action báº±ng cÃ¡ch Æ°á»›c tÃ­nh má»™t hÃ m máº­t Ä‘á»™ vá»›i VAE. Sau Ä‘Ã³, dÆ°á»›i sá»± hÆ°á»›ng
dáº«n cá»§a Ä‘á»™ báº¥t Ä‘á»‹nh, SUNG káº¿t há»£p má»™t chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan vÃ  má»™t phÆ°Æ¡ng phÃ¡p khai
thÃ¡c thÃ­ch á»©ng cho tinh chá»‰nh online.
Káº¿t há»£p vá»›i OORB, chÃºng tÃ´i cuá»‘i cÃ¹ng Ä‘áº¡t Ä‘áº¿n thuáº­t toÃ¡n hoÃ n chá»‰nh cá»§a SUNG.
4.1 Äá»‹nh LÆ°á»£ng Äá»™ Báº¥t Äá»‹nh vá»›i Æ¯á»›c TÃ­nh Máº­t Äá»™
Nhiá»u cÃ´ng trÃ¬nh trÆ°á»›c thÆ°á»ng sá»­ dá»¥ng cÃ¡c ensemble Q Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh [40,33,8,24].
Tuy nhiÃªn, ká»¹ thuáº­t ensemble cÃ³ thá»ƒ tÄƒng Ä‘Ã¡ng ká»ƒ chi phÃ­ tÃ­nh toÃ¡n. Do Ä‘Ã³, trong cÃ´ng trÃ¬nh nÃ y,
chÃºng tÃ´i sá»­ dá»¥ng má»™t cÃ¡ch tiáº¿p cáº­n Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£ báº±ng cÃ¡ch Ã¡p dá»¥ng VAE [18] nhÆ°
má»™t bá»™ Æ°á»›c tÃ­nh máº­t Ä‘á»™ truy cáº­p state-action Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh. Cá»¥ thá»ƒ, cho má»™t bá»™ mÃ£
hÃ³a qÏ†(z|s, a) vÃ  má»™t bá»™ giáº£i mÃ£ pÏˆ(s, a|z) vá»›i tham sá»‘ Ï† vÃ  Ïˆ, tÆ°Æ¡ng á»©ng, chÃºng ta cÃ³ thá»ƒ tá»‘i
Æ°u hÃ³a chÃºng vá»›i giá»›i háº¡n dÆ°á»›i báº±ng chá»©ng (ELBO)
LELBO (s, a;Ïˆ, Ï†) =EqÏ†(z|s,a)[âˆ’logpÏˆ(s, a|z)] +DKL[qÏ†(z|s, a)||p(z|s, a)], (6)
trong Ä‘Ã³ p(z|s, a) =N(0, I) lÃ  má»™t prior cá»‘ Ä‘á»‹nh. Sau Ä‘Ã³, chÃºng tÃ´i sá»­ dá»¥ng log likelihood Ã¢m cá»§a
máº­t Ä‘á»™ state-action Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh, tá»©c lÃ , U(s, a)def=âˆ’logp(s, a)â‰ˆ L ELBO (s, a;Ïˆ, Ï†),
vÃ¬ chÃºng ta biáº¿t logp(s, a) =âˆ’LELBO (s, a;Ïˆ, Ï†) +DKL[qÏ†(z|s, a)||pÏˆ(z|s, a)]. Má»™t cÃ¡ch trá»±c
quan, cáº£ máº¥t mÃ¡t tÃ¡i táº¡o vÃ  phÃ¢n ká»³ KL trong ELBO Ä‘á»u chá»‰ ra Ä‘á»™ báº¥t Ä‘á»‹nh state-action, tá»©c lÃ ,
liá»‡u má»™t cáº·p state-action cÃ³ thá»ƒ Ä‘Æ°á»£c náº¯m báº¯t tá»‘t bá»Ÿi phÃ¢n phá»‘i Ä‘Ã£ há»c hay khÃ´ng.
Máº·c dÃ¹ cÃ³ thá»ƒ chá»©ng minh lÃ½ thuyáº¿t ráº±ng má»™t Ä‘á»™ chá»‡ch tá»“n táº¡i giá»¯a ELBO vÃ  log likelihood Ã¢m
cá»§a máº­t Ä‘á»™ state-action, má»™t cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y Ä‘Ã£ chá»‰ ra ráº±ng sá»± xáº¥p xá»‰ nhÆ° váº­y lÃ  há»£p lá»‡ vá»
máº·t thá»±c nghiá»‡m [39]. Do Ä‘Ã³, chÃºng tÃ´i sá»­ dá»¥ng ELBO Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh trong thá»±c táº¿,
vÃ  Ä‘á»ƒ láº¡i viá»‡c khÃ¡m phÃ¡ cÃ¡c ká»¹ thuáº­t láº¥y máº«u quan trá»ng [19, 37] Ä‘á»ƒ giáº£m thiá»ƒu Ä‘á»™ chá»‡ch hÆ¡n ná»¯a
nhÆ° cÃ´ng viá»‡c tÆ°Æ¡ng lai.
4.2 KhÃ¡m PhÃ¡ Láº¡c Quan qua Lá»±a Chá»n HÃ nh Äá»™ng Hai Cáº¥p
Má»™t dÃ²ng chÃ­nh cá»§a cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ´ng mÃ´ hÃ¬nh thá»±c hiá»‡n cÃ¡c má»¥c tiÃªu báº£o thá»§
Ä‘á»ƒ pháº¡t cÃ¡c hÃ nh Ä‘á»™ng OOD trong quÃ¡ trÃ¬nh pretraining offline. Tuy nhiÃªn, nhá»¯ng má»¥c tiÃªu báº£o
thá»§ nhÆ° váº­y vá»‘n dÄ© giá»›i háº¡n sá»©c máº¡nh khÃ¡m phÃ¡ cá»§a cÃ¡c agent, Ä‘iá»u nÃ y cáº£n trá»Ÿ cÃ¡c agent táº­n dá»¥ng
Ä‘áº§y Ä‘á»§ tá»« tinh chá»‰nh online [33]. Äá»ƒ kháº¯c phá»¥c háº¡n cháº¿ nÃ y, má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  Ä‘o lÆ°á»ng
thÃ­ch há»£p tÃ­nh thÃ´ng tin cá»§a cÃ¡c hÃ nh Ä‘á»™ng chÆ°a tháº¥y, vÃ  sau Ä‘Ã³ chá»n hÃ nh Ä‘á»™ng thÃ´ng tin nháº¥t
cho khÃ¡m phÃ¡. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan dá»±a trÃªn
nguyÃªn táº¯c láº¡c quan khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t Ä‘á»‹nh [4,2]. ThÃ´ng tin quan trá»ng lÃ  má»™t hÃ nh Ä‘á»™ng
thÃ´ng tin Ä‘Æ°á»£c mong Ä‘á»£i sá»Ÿ há»¯u cáº£ giÃ¡ trá»‹ Q cao vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh cao.
CÃ¡c cÃ´ng trÃ¬nh hiá»‡n táº¡i thÆ°á»ng Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh nháº­n thá»©c thÃ´ng qua cÃ¡c ensemble Q vÃ  suy
ra má»™t giá»›i háº¡n tin cáº­y trÃªn (UCB) Ä‘á»ƒ chá»‰ Ä‘áº¡o viá»‡c khÃ¡m phÃ¡ [7,8,24]. KhÃ¡c vá»›i chÃºng, chÃºng tÃ´i
má»Ÿ rá»™ng Ã½ tÆ°á»Ÿng nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng U(s, a) Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh. Äá»ƒ trÃ¡nh cÃ¡c Æ°á»›c tÃ­nh
khÃ´ng chÃ­nh xÃ¡c cho giÃ¡ trá»‹ Q vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh, chÃºng tÃ´i chá»‰ chá»n cÃ¡c hÃ nh Ä‘á»™ng gáº§n-on-policy
cho khÃ¡m phÃ¡. Do Ä‘Ã³, má»¥c tiÃªu cá»§a chÃ­nh sÃ¡ch khÃ¡m phÃ¡ Ï€E(s) lÃ  tá»‘i Ä‘a hÃ³a tÃ­nh thÃ´ng tin trong
khi duy trÃ¬ gáº§n-on-policy, tá»©c lÃ ,
Ï€E(s) = arg max
aâˆˆAQÎ¸(s, a) +Î²U(s, a),
s.t.||aâˆ’Ï€Ï•(s)||2â‰¤Î´,(7)
trong Ä‘Ã³ Î² kiá»ƒm soÃ¡t má»©c Ä‘á»™ láº¡c quan vÃ  Î´ kiá»ƒm soÃ¡t tÃ­nh on-policy. Do Ä‘Ã³, chÃ­nh sÃ¡ch hÃ nh vi
suy ra khÃ´ng chá»‰ cÃ³ thá»ƒ tÄƒng cÆ¡ há»™i thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng thÃ´ng tin theo nguyÃªn táº¯c láº¡c quan
khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t Ä‘á»‹nh, mÃ  cÃ²n Ä‘áº£m báº£o tÃ­nh on-policy Ä‘á»ƒ Ä‘áº£m báº£o sá»± á»•n Ä‘á»‹nh.
Tuy nhiÃªn, má»™t váº¥n Ä‘á» tá»‘i Æ°u hÃ³a nhÆ° váº­y lÃ  khÃ´ng thá»±c táº¿ Ä‘á»ƒ giáº£i quyáº¿t do hai thÃ¡ch thá»©c chÃ­nh.
Má»™t máº·t, khÃ´ng Ä‘Æ¡n giáº£n Ä‘á»ƒ tÃ¬m hÃ nh Ä‘á»™ng tá»‘i Æ°u trong khÃ´ng gian hÃ nh Ä‘á»™ng liÃªn tá»¥c cÃ³ chiá»u
cao, khÃ´ng thá»ƒ liá»‡t kÃª hoÃ n toÃ n. Máº·t khÃ¡c, khÃ³ Ä‘áº·t giÃ¡ trá»‹ thÃ­ch há»£p cho má»©c Ä‘á»™ láº¡c quan Î² vÃ¬
giÃ¡ trá»‹ Q vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh cÃ³ pháº¡m vi giÃ¡ trá»‹ khÃ¡c nhau trÃªn cÃ¡c nhiá»‡m vá»¥ khÃ¡c nhau, Ä‘iá»u nÃ y Ä‘Ã²i
há»i Ä‘iá»u chá»‰nh siÃªu tham sá»‘ cá»¥ thá»ƒ cho nhiá»‡m vá»¥.
Äá»ƒ giáº£m thiá»ƒu cáº£ hai thÃ¡ch thá»©c trÃªn, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t cÆ¡ cháº¿ lá»±a chá»n hÃ nh Ä‘á»™ng hai cáº¥p
Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£. Äáº§u tiÃªn, chÃºng tÃ´i táº¡o má»™t táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={ai}N
i=1 vá»›i N
hÃ nh Ä‘á»™ng á»©ng viÃªn. á» Ä‘Ã¢y, hÃ nh Ä‘á»™ng Ä‘Æ°á»£c táº¡o báº±ng cÃ¡ch láº¥y máº«u aiâˆ¼Ï€Ï•(Â·|s) cho chÃ­nh sÃ¡ch
ngáº«u nhiÃªn, trong khi báº±ng cÃ¡ch thÃªm nhiá»…u Gaussian Ä‘Æ°á»£c láº¥y máº«u ai=Ï€Ï•(s) +Ïµi, Ïµiâˆ¼ N(0, Î´)
cho chÃ­nh sÃ¡ch deterministic. Sau Ä‘Ã³, chÃºng tÃ´i xáº¿p háº¡ng cÃ¡c hÃ nh Ä‘á»™ng á»©ng viÃªn theo cÃ¡c giÃ¡ trá»‹
Q (hoáº·c Ä‘á»™ báº¥t Ä‘á»‹nh) Ä‘á»ƒ chá»n k hÃ nh Ä‘á»™ng á»©ng viÃªn hÃ ng Ä‘áº§u nhÆ° má»™t táº­p hÃ nh Ä‘á»™ng chung káº¿t
Cf. Cuá»‘i cÃ¹ng, chÃºng tÃ´i xÃ¢y dá»±ng má»™t phÃ¢n phá»‘i categorical theo Ä‘á»™ báº¥t Ä‘á»‹nh (hoáº·c giÃ¡ trá»‹ Q)
Ä‘á»ƒ chá»n hÃ nh Ä‘á»™ng tá»« Cf Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng:
P(ai) :=exp (U(s, ai)/Î±)P
jexp (U(s, aj)/Î±),âˆ€iâˆˆ[1, ..., k ], (8)
trong Ä‘Ã³ Î± lÃ  nhiá»‡t Ä‘á»™ softmax. Báº±ng cÃ¡ch thay Ä‘á»•i tiÃªu chÃ­ xáº¿p háº¡ng cho táº­p hÃ nh Ä‘á»™ng chung káº¿t
vÃ  k, chÃºng ta cÃ³ thá»ƒ Ä‘iá»u chá»‰nh linh hoáº¡t sá»± Æ°u tiÃªn cho giÃ¡ trá»‹ Q cao hoáº·c Ä‘á»™ báº¥t Ä‘á»‹nh cao Ä‘á»ƒ Ä‘áº¡t
Ä‘Æ°á»£c sá»± cÃ¢n báº±ng mong muá»‘n.
Trong thá»±c táº¿, chÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline dá»±a trÃªn rÃ ng buá»™c chÃ­nh
sÃ¡ch cÃ³ thá»ƒ chá»©a sá»± Æ°u tiÃªn cho giÃ¡ trá»‹ Q cao hoáº·c Ä‘á»™ báº¥t Ä‘á»‹nh cao. Tuy nhiÃªn, cÃ¡c phÆ°Æ¡ng phÃ¡p
dá»±a trÃªn Ä‘iá»u chá»‰nh giÃ¡ trá»‹ cÃ³ thá»ƒ phÃ¢n ká»³ khi sá»± Æ°u tiÃªn cho giÃ¡ trá»‹ Q cÃ³ máº·t. ChÃºng tÃ´i tháº£o luáº­n
chi tiáº¿t hiá»‡n tÆ°á»£ng nÃ y trong Phá»¥ lá»¥c B.
Chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan cho phÃ©p cÃ¡c agent tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng báº±ng cÃ¡c hÃ nh Ä‘á»™ng
thÃ´ng tin, do Ä‘Ã³ tÄƒng cÆ°á»ng hiá»‡u quáº£ máº«u cá»§a RL offline-Ä‘áº¿n-online. Tuy nhiÃªn, nÃ³ cÅ©ng cÃ³ thá»ƒ
mang láº¡i tÃ¡c Ä‘á»™ng tiÃªu cá»±c báº±ng cÃ¡ch tÄƒng thÃªm sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action, nhÆ° má»™t
káº¿t quáº£ cá»§a nguyÃªn táº¯c láº¡c quan khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t Ä‘á»‹nh. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu nÃ y, chÃºng tÃ´i
giá»›i thiá»‡u má»™t phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng trong pháº§n tiáº¿p theo, nháº±m giáº£m thiá»ƒu sá»± dá»‹ch
chuyá»ƒn phÃ¢n phá»‘i state-action.
4.3 Khai ThÃ¡c ThÃ­ch á»¨ng vá»›i Nháº­n Diá»‡n Máº«u OOD
Sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i hÃ nh Ä‘á»™ng Ä‘áº·t ra má»™t thÃ¡ch thá»©c Ä‘Ã¡ng ká»ƒ cho cÃ¡c thuáº­t toÃ¡n RL offline
[13,22,27,23], vÃ¬ thuáº­t ngá»¯ bootstrapping trong Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch liÃªn quan Ä‘áº¿n cÃ¡c hÃ nh Ä‘á»™ng
Ä‘Æ°á»£c suy ra tá»« chÃ­nh sÃ¡ch Ä‘Ã£ há»c Ï€Ï•. Äiá»u nÃ y cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»—i ngoáº¡i suy do truy váº¥n cÃ¡c hÃ m
Q vá»›i cÃ¡c hÃ nh Ä‘á»™ng OOD, dáº«n Ä‘áº¿n cáº£i thiá»‡n chÃ­nh sÃ¡ch thiÃªn lá»‡ch hÆ°á»›ng tá»›i nhá»¯ng hÃ nh Ä‘á»™ng
OOD nÃ y vá»›i cÃ¡c giÃ¡ trá»‹ Q cao má»™t cÃ¡ch sai lá»‡ch. LÆ°u Ã½ ráº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ´ng
bá»‹ sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i tráº¡ng thÃ¡i trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, vÃ¬ Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch chá»‰ truy
váº¥n cÃ¡c hÃ m Q vá»›i cÃ¡c tráº¡ng thÃ¡i cÃ³ máº·t trong táº­p dá»¯ liá»‡u offline.
Tuy nhiÃªn, trong quÃ¡ trÃ¬nh tinh chá»‰nh online, cáº£ sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i tráº¡ng thÃ¡i vÃ  hÃ nh Ä‘á»™ng
Ä‘á»u xáº£y ra vÃ¬ cÃ¡c agent cÃ³ thá»ƒ gáº·p pháº£i cÃ¡c cháº¿ Ä‘á»™ state-action khÃ´ng quen thuá»™c náº±m ngoÃ i pháº¡m
vi há»— trá»£ cá»§a táº­p dá»¯ liá»‡u. Tá»‡ hÆ¡n ná»¯a, vÃ¬ chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan Ä‘Æ°á»£c Ä‘á» xuáº¥t tuÃ¢n theo
nguyÃªn táº¯c láº¡c quan khi Ä‘á»‘i máº·t vá»›i Ä‘á»™ báº¥t Ä‘á»‹nh, sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action cÃ³ thá»ƒ bá»‹
tráº§m trá»ng hÃ³a thÃªm. CÃ¡c thá»­ nghiá»‡m sÆ¡ bá»™ tá»« [25, 33, 48] cho tháº¥y ráº±ng Ä‘iá»u nÃ y cÃ³ thá»ƒ xÃ³a bá»
viá»‡c khá»Ÿi táº¡o tá»‘t thu Ä‘Æ°á»£c tá»« pretraining offline.
Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t phÆ°Æ¡ng phÃ¡p khai
thÃ¡c thÃ­ch á»©ng vá»›i nháº­n diá»‡n máº«u OOD. Ã tÆ°á»Ÿng cÆ¡ báº£n Ä‘Æ°á»£c phÃ¡t triá»ƒn tá»« cÃ¡c quan sÃ¡t trong cÃ¡c
cÃ´ng trÃ¬nh trÆ°á»›c
5

--- TRANG 5 ---
Thuáº­t ToÃ¡n 1 SUNG: Má»™t Khung LÃ m Viá»‡c HÆ°á»›ng Dáº«n Äá»™ Báº¥t Äá»‹nh Thá»‘ng Nháº¥t ÄÆ¡n Giáº£n cho RL Offline-Ä‘áº¿n-Online
1:Äáº§u vÃ o: Táº­p dá»¯ liá»‡u D, Thuáº­t toÃ¡n RL Offline {Loffline
Q (Î¸),Loffline
Ï€ (Ï•)}
2:Khá»Ÿi táº¡o máº¡ng Q QÎ¸, máº¡ng chÃ­nh sÃ¡ch Ï€Ï•, máº¡ng VAE pÏˆ vÃ  qÏ†
3:while trong giai Ä‘oáº¡n pretraining offline do
4: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a, r, sâ€²)âˆ¼ D
5: Cáº­p nháº­t Î¸ vÃ  Ï• tá»‘i thiá»ƒu hÃ³a Loffline
Q (Î¸) vÃ  Loffline
Ï€ (Ï•)
6: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
7:end while
8:Khá»Ÿi táº¡o OORB vá»›i BOORB â† {B =âˆ…,D}
9:while trong giai Ä‘oáº¡n tinh chá»‰nh online do
10: //KhÃ¡m PhÃ¡ Láº¡c Quan
11: Táº¡o táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={ai}N
i=1
12: Chá»n cÃ¡c hÃ nh Ä‘á»™ng vá»›i giÃ¡ trá»‹ Q (hoáº·c Ä‘á»™ báº¥t Ä‘á»‹nh) top-k nhÆ° táº­p hÃ nh Ä‘á»™ng chung káº¿t Cf
13: Láº¥y máº«u hÃ nh Ä‘á»™ng atâˆ¼P(ai), aiâˆˆ Cf trong Eq.(8) theo Ä‘á»™ báº¥t Ä‘á»‹nh (hoáº·c giÃ¡ trá»‹ Q)
14: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at, thu tháº­p st+1 vÃ  rt tá»« mÃ´i trÆ°á»ng
15: LÆ°u trá»¯ cÃ¡c chuyá»ƒn tiáº¿p (st, at, rt, st+1) vÃ o B vÃ  D
16: //Khai ThÃ¡c ThÃ­ch á»¨ng
17: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a, r, sâ€²)âˆ¼ B OORB
18: Cáº­p nháº­t Î¸ vÃ  Ï• tá»‘i thiá»ƒu hÃ³a Ladp
F(Î˜) trong Eq. (9)
19: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
20:end while
[25,33,48] ráº±ng tinh chá»‰nh vá»›i cÃ¡c má»¥c tiÃªu RL offline liÃªn tá»¥c thÆ°á»ng táº¡o ra hiá»‡u suáº¥t á»•n Ä‘á»‹nh
nhÆ°ng háº¡n cháº¿, trong khi tinh chá»‰nh vá»›i cÃ¡c má»¥c tiÃªu RL online thÆ°á»ng táº¡o ra hiá»‡u suáº¥t khÃ´ng á»•n
Ä‘á»‹nh do sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i gÃ¢y ra bá»Ÿi cÃ¡c cáº·p state-action OOD. Do Ä‘Ã³, chÃºng tÃ´i Ä‘á» xuáº¥t
má»™t cÃ¡ch tiáº¿p cáº­n má»›i táº­n dá»¥ng lá»£i Ã­ch cá»§a cáº£ hai má»¥c tiÃªu báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c má»¥c tiÃªu RL
offline báº£o thá»§ cho cÃ¡c cáº·p state-action cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh cao trong khi cÃ¡c má»¥c tiÃªu RL online máº¡nh
máº½ cho cÃ¡c cáº·p state-action cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh tháº¥p. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Eq. (5), cÃ¡c má»¥c tiÃªu
RL offline bao gá»“m má»™t má»¥c tiÃªu RL online tiÃªu chuáº©n LF(Î˜) vÃ  má»™t bá»™ Ä‘iá»u chá»‰nh RF(Î˜). Do
Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ suy ra cÃ¡c má»¥c tiÃªu cho khai thÃ¡c thÃ­ch á»©ng báº±ng cÃ¡ch giá»›i thiá»‡u má»™t bá»™ nháº­n
diá»‡n máº«u OOD hÆ°á»›ng dáº«n Ä‘á»™ báº¥t Ä‘á»‹nh I(s, a):
Ladp
F(Î˜) = LF(Î˜) + Î»I(s, Ï€Ï•(s))RF(Î˜). (9)
ChÃºng tÃ´i mong Ä‘á»£i ráº±ng I(s, a) lÃ  má»™t giÃ¡ trá»‹ lá»›n cho cÃ¡c cáº·p state-action cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh cao vÃ 
má»™t giÃ¡ trá»‹ nhá» cho nhá»¯ng cáº·p cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh tháº¥p. Do Ä‘Ã³, chÃºng tÃ´i xÃ¢y dá»±ng má»™t bá»™ nháº­n diá»‡n
nhÆ° váº­y sá»­ dá»¥ng Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh U(s, a) nhÆ° dÆ°á»›i Ä‘Ã¢y. Äá»‘i vá»›i má»™t minibatch cá»§a cÃ¡c cáº·p
state-action {si, ai}M
i=1, chÃºng tÃ´i chá»n p% hÃ ng Ä‘áº§u cá»§a chÃºng nhÆ° cÃ¡c táº­p cáº·p state-action OOD
DOOD, theo Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh tÆ°Æ¡ng á»©ng U(si, ai). QuÃ¡ trÃ¬nh lá»±a chá»n cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n
báº±ng cÃ¡ch láº¥y máº«u tá»« má»™t phÃ¢n phá»‘i categorical tÆ°Æ¡ng tá»± nhÆ° Eq. (8). Sau Ä‘Ã³, Ä‘á»ƒ Ä‘Æ¡n giáº£n, chÃºng
tÃ´i Ä‘á»‹nh nghÄ©a bá»™ nháº­n diá»‡n máº«u OOD nhÆ°
I(s, a) :=
1,náº¿u(s, a)âˆˆ D OOD,
0,khÃ¡c.(10)
Báº±ng cÃ¡ch Ä‘áº·t p= 0, má»¥c tiÃªu huáº¥n luyá»‡n chÃ­nh xÃ¡c lÃ  má»¥c tiÃªu RL offline, trong khi Ä‘áº·t p= 100
dáº«n Ä‘áº¿n má»¥c tiÃªu RL online. Do Ä‘Ã³, báº±ng cÃ¡ch Ä‘iá»u chá»‰nh giÃ¡ trá»‹ cá»§a p, phÆ°Æ¡ng phÃ¡p khai thÃ¡c
thÃ­ch á»©ng Ä‘Æ°á»£c Ä‘á» xuáº¥t cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c sá»± cÃ¢n báº±ng mong muá»‘n giá»¯a hiá»‡u suáº¥t vÃ  á»•n Ä‘á»‹nh.
4.4 Chi Tiáº¿t Triá»ƒn Khai Thuáº­t ToÃ¡n
Bá»™ Äá»‡m PhÃ¡t Láº¡i Offline-Ä‘áº¿n-Online. CÃ¡c nghiÃªn cá»©u trÆ°á»›c [25,48] Ä‘Ã£ nháº¥n máº¡nh táº§m quan
trá»ng cá»§a viá»‡c káº¿t há»£p cáº£ dá»¯ liá»‡u offline vÃ  online trong quÃ¡ trÃ¬nh tinh chá»‰nh. á» Ä‘Ã¢y, chÃºng tÃ´i
Ã¡p dá»¥ng bá»™ Ä‘á»‡m phÃ¡t láº¡i offline-Ä‘áº¿n-online Ä‘Æ°á»£c Ä‘á» xuáº¥t trong [48] do tÃ­nh Ä‘Æ¡n giáº£n cá»§a nÃ³. Cá»¥
thá»ƒ, OORB bao gá»“m hai bá»™ Ä‘á»‡m phÃ¡t láº¡i: má»™t bá»™ Ä‘á»‡m hoÃ n toÃ n online thu tháº­p cÃ¡c chuyá»ƒn tiáº¿p
tá»« cÃ¡c tÆ°Æ¡ng tÃ¡c online, vÃ  má»™t bá»™ Ä‘á»‡m offline lÆ°u trá»¯ cÃ¡c chuyá»ƒn tiáº¿p tá»« cáº£ táº­p dá»¯ liá»‡u offline
vÃ  cÃ¡c tÆ°Æ¡ng tÃ¡c online. Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, chÃºng tÃ´i láº¥y máº«u ngáº«u nhiÃªn cÃ¡c chuyá»ƒn
tiáº¿p tá»« OORB vá»›i má»™t phÃ¢n phá»‘i Bernoulli, trong Ä‘Ã³ xÃ¡c suáº¥t láº¥y máº«u tá»« bá»™ Ä‘á»‡m hoÃ n toÃ n online
lÃ  pOORB, vÃ  xÃ¡c suáº¥t láº¥y máº«u tá»« bá»™ Ä‘á»‡m offline lÃ  1âˆ’pOORB.
6

--- TRANG 6 ---
Khung LÃ m Viá»‡c SUNG cho RL Offline-Ä‘áº¿n-Online. Káº¿t há»£p táº¥t cáº£ láº¡i vá»›i nhau, chÃºng tÃ´i tÃ³m
táº¯t khung lÃ m viá»‡c Ä‘áº§y Ä‘á»§ trong Thuáº­t toÃ¡n 1. SUNG Ä‘áº§u tiÃªn pretrain cÃ¡c agent vÃ  VAE sá»­ dá»¥ng
táº­p dá»¯ liá»‡u offline. Sau Ä‘Ã³, nÃ³ chuyá»ƒn sang tinh chá»‰nh online vá»›i chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan
Ä‘Æ°á»£c Ä‘á» xuáº¥t vÃ  phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng. ChÃºng tÃ´i cÅ©ng cung cáº¥p hai trÆ°á»ng há»£p triá»ƒn
khai káº¿t ná»‘i TD3+BC vÃ  TD3, vÃ  káº¿t ná»‘i CQL vÃ  SAC trong Phá»¥ lá»¥c A.
5 Thá»­ Nghiá»‡m
Trong pháº§n nÃ y, chÃºng tÃ´i cung cáº¥p káº¿t quáº£ thá»±c nghiá»‡m Ä‘á»ƒ xÃ¡c minh hiá»‡u quáº£ cá»§a khung lÃ m viá»‡c
cá»§a chÃºng tÃ´i báº±ng cÃ¡ch tráº£ lá»i ba cÃ¢u há»i chÃ­nh: (1) SUNG so sÃ¡nh nhÆ° tháº¿ nÃ o vá»›i cÃ¡c phÆ°Æ¡ng
phÃ¡p tiÃªn tiáº¿n khÃ¡c khi káº¿t há»£p vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline khÃ¡c nhau, trÃªn cÃ¡c loáº¡i nhiá»‡m vá»¥
vÃ  táº­p dá»¯ liá»‡u khÃ¡c nhau? (2) CÃ¡c thÃ nh pháº§n chÃ­nh cá»§a SUNG áº£nh hÆ°á»Ÿng nhÆ° tháº¿ nÃ o Ä‘áº¿n hiá»‡u
suáº¥t offline-Ä‘áº¿n-online tá»•ng thá»ƒ? (3) ChÃºng ta nÃªn Ä‘áº·t siÃªu tham sá»‘ cho SUNG nhÆ° tháº¿ nÃ o trong
thá»±c táº¿, vÃ  nhiá»‡m vá»¥ nÃ y khÃ³ Ä‘áº¿n má»©c nÃ o?
5.1 Thiáº¿t Láº­p Thá»­ Nghiá»‡m
CÃ i Äáº·t. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ trÃªn benchmark D4RL [10], cung cáº¥p nhiá»u nhiá»‡m vá»¥ Ä‘iá»u khiá»ƒn liÃªn
tá»¥c vÃ  táº­p dá»¯ liá»‡u khÃ¡c nhau. ChÃºng tÃ´i táº­p trung vÃ o cÃ¡c miá»n MuJoCo vÃ  AntMaze. ChÃºng tÃ´i
Ä‘áº§u tiÃªn thá»±c hiá»‡n 1M bÆ°á»›c gradient cho pretraining offline, vÃ  sau Ä‘Ã³ thá»±c hiá»‡n 100K bÆ°á»›c mÃ´i
trÆ°á»ng cho tinh chá»‰nh online. Trong khi má»™t sá»‘ cÃ´ng trÃ¬nh trÆ°á»›c [21,45,48] láº¥y 1M bÆ°á»›c mÃ´i trÆ°á»ng
cho tinh chá»‰nh, chÃºng tÃ´i láº­p luáº­n ráº±ng 1M bÆ°á»›c mÃ´i trÆ°á»ng tháº­m chÃ­ Ä‘á»§ cho má»™t agent RL online
Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t cáº¥p Ä‘á»™ chuyÃªn gia. Do Ä‘Ã³, chÃºng tÃ´i tin ráº±ng tinh chá»‰nh trong 100K bÆ°á»›c
mÃ´i trÆ°á»ng lÃ  má»™t cÃ i Ä‘áº·t há»£p lÃ½ hÆ¡n, cÅ©ng Ä‘Æ°á»£c Ã¡p dá»¥ng bá»Ÿi [31, 48].
CÃ¡c PhÆ°Æ¡ng PhÃ¡p RL Offline ChÃ­nh. Äá»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh tá»•ng quÃ¡t cá»§a SUNG, chÃºng tÃ´i chá»n hai
phÆ°Æ¡ng phÃ¡p RL offline Ä‘áº¡i diá»‡n lÃ m xÆ°Æ¡ng sá»‘ng cho pretraining, tá»©c lÃ , TD3+BC [11] vÃ  CQL [23].
Cá»¥ thá»ƒ, TD3+BC má»Ÿ rá»™ng TD3 vá»›i rÃ ng buá»™c chÃ­nh sÃ¡ch dá»±a trÃªn behavior cloning, trong khi CQL
má»Ÿ rá»™ng SAC vá»›i Ä‘iá»u chá»‰nh giÃ¡ trá»‹. Äá»‘i vá»›i cÃ¡c miá»n AntMaze, chÃºng tÃ´i thay tháº¿ TD3+BC báº±ng
SPOT [39] do hiá»‡u suáº¥t kÃ©m cá»§a nÃ³. SPOT lÃ  má»™t pháº§n má»Ÿ rá»™ng khÃ¡c cá»§a TD3 nhÆ°ng vá»›i rÃ ng
buá»™c chÃ­nh sÃ¡ch hÆ°á»›ng dáº«n máº­t Ä‘á»™.
CÃ¡c Baseline. ChÃºng tÃ´i so sÃ¡nh SPOT vá»›i cÃ¡c baseline sau: (1) offline-ft táº­n dá»¥ng cÃ¡c tÆ°Æ¡ng tÃ¡c
online báº±ng cÃ¡ch thá»±c hiá»‡n cÃ¡c má»¥c tiÃªu RL offline. (2) online-ft táº­n dá»¥ng cÃ¡c tÆ°Æ¡ng tÃ¡c online
báº±ng cÃ¡ch thá»±c hiá»‡n cÃ¡c má»¥c tiÃªu RL online tÆ°Æ¡ng á»©ng vá»›i nhá»¯ng má»¥c tiÃªu Ä‘Æ°á»£c sá»­ dá»¥ng cho pretraining.
(3) BR [25] Æ°u tiÃªn cÃ¡c chuyá»ƒn tiáº¿p gáº§n-on-policy tá»« bá»™ Ä‘á»‡m phÃ¡t láº¡i. (4) O3F [33] sá»­ dá»¥ng kiáº¿n
thá»©c chá»©a trong cÃ¡c hÃ m giÃ¡ trá»‹ Ä‘á»ƒ hÆ°á»›ng dáº«n khÃ¡m phÃ¡. (5) APL [48] thá»±c hiá»‡n há»c chÃ­nh sÃ¡ch
thÃ­ch á»©ng báº±ng cÃ¡ch káº¿t há»£p cÃ¡c lá»£i tháº¿ khÃ¡c nhau cá»§a dá»¯ liá»‡u offline vÃ  online. (6) PEX [45] huáº¥n
luyá»‡n má»™t chÃ­nh sÃ¡ch má»›i tá»« Ä‘áº§u báº±ng cÃ¡ch sá»­ dá»¥ng chÃ­nh sÃ¡ch Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c Ä‘á»ƒ khÃ¡m
phÃ¡. LÆ°u Ã½ ráº±ng chÃºng tÃ´i cÅ©ng bao gá»“m ODT [49] Ä‘á»ƒ so sÃ¡nh vá»›i má»™t pháº§n riÃªng biá»‡t trong Phá»¥
lá»¥c D.2. Xem Phá»¥ lá»¥c C Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t triá»ƒn khai.
5.2 So SÃ¡nh trÃªn CÃ¡c Benchmark D4RL
Báº£ng 1: So sÃ¡nh Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c nhiá»‡m vá»¥ MuJoCo vá»›i TD3+BC lÃ m phÆ°Æ¡ng
phÃ¡p RL offline xÆ°Æ¡ng sá»‘ng. r = random, m = medium, m-r = medium-replay. ChÃºng tÃ´i bÃ¡o cÃ¡o
giÃ¡ trá»‹ trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed.
TD3+BC offline-ft online-ft BR O3F APL PEX SUNG
halfcheetah-r-v2 11.5 34.3 Â±2.4 57.7Â±1.6 67.6Â±11.9 71.4Â±3.3 70.0Â±4.7 53.4Â±9.1 76.6Â±2.0
hopper-r-v2 8.7 8.2 Â±0.2 11.2Â±1.9 25.7Â±8.7 11.7Â±2.0 27.1Â±14.0 37.4Â±10.6 38.7Â±15.0
walker2d-r-v2 5.4 7.0 Â±4.1 6.2Â±3.9 9.9Â±4.6 11.6Â±5.1 13.8Â±4.0 33.1Â±16.4 14.1Â±5.1
halfcheetah-m-v2 48.0 49.3 Â±0.4 67.6Â±2.4 79.5Â±7.4 77.8Â±1.1 80.9Â±2.0 52.3Â±21.1 80.7Â±2.5
hopper-m-v2 61.5 58.8 Â±3.9 78.3Â±32.7 93.1Â±10.8 102.0 Â±2.0 76.9Â±24.2 73.9Â±17.8 101.8 Â±6.0
walker2d-m-v2 82.2 84.6 Â±1.2 68.2Â±11.5 70.1Â±21.4 97.1Â±2.2 98.2Â±13.5 56.7Â±28.5 113.5 Â±1.9
halfcheetah-m-r-v2 44.6 47.0 Â±0.9 66.3Â±1.0 65.0Â±14.6 67.6Â±2.9 71.5Â±1.3 53.2Â±9.8 69.7Â±3.4
hopper-m-r-v2 55.9 85.4 Â±7.6 89.9Â±13.5 97.2Â±13.9 97.6Â±4.9 100.6 Â±9.8 90.8Â±18.7 101.3 Â±7.0
walker2d-m-r-v2 71.7 80.2 Â±8.7 87.4Â±4.0 82.7Â±17.8 100.9 Â±3.7 108.2 Â±3.6 70.6Â±13.3 109.2 Â±1.9
Tá»•ng 389.6 454.9 532.9 590.9 637.7 647.1 521.2 705.7
Káº¿t Quáº£ trÃªn MuJoCo. Káº¿t quáº£ cho cÃ¡c miá»n MuJoCo vá»›i TD3+BC vÃ  CQL lÃ m phÆ°Æ¡ng phÃ¡p RL
offline xÆ°Æ¡ng sá»‘ng Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 1 vÃ  2, tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i tháº¥y ráº±ng cÃ¡c tÆ°Æ¡ng
tÃ¡c online bá»• sung cÃ³ thá»ƒ mang láº¡i cáº£i thiá»‡n hiá»‡u suáº¥t thÃªm trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t. Tuy nhiÃªn,
hai ngoáº¡i lá»‡ lÃ  O3F vÃ  PEX,
7

--- TRANG 7 ---
Báº£ng 2: So sÃ¡nh Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c nhiá»‡m vá»¥ MuJoCo vá»›i CQL lÃ m phÆ°Æ¡ng phÃ¡p
RL offline xÆ°Æ¡ng sá»‘ng. r = random, m = medium, m-r = medium-replay. ChÃºng tÃ´i bÃ¡o cÃ¡o giÃ¡
trá»‹ trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed. LÆ°u Ã½ ráº±ng O3F bá»‹ bá» qua do sá»± phÃ¢n ká»³ cá»§a nÃ³ trong
cÃ i Ä‘áº·t nÃ y.
CQL offline-ft online-ft BR APL PEX SUNG
halfcheetah-r-v2 23.5 28.8 Â±2.3 50.2Â±1.5 61.8Â±12.3 67.7Â±9.6 50.6Â±2.2 69.1Â±9.2
hopper-r-v2 6.4 31.2 Â±0.5 28.3Â±6.2 23.8Â±7.9 41.8Â±22.0 34.3Â±8.9 44.3Â±11.7
walker2d-r-v2 4.5 5.6 Â±3.4 8.2Â±5.6 4.0Â±2.3 6.3Â±1.8 10.7Â±2.8 14.5Â±6.1
halfcheetah-m-v2 48.1 48.9 Â±0.2 52.1Â±25.6 56.7Â±28.5 44.7Â±38.5 43.5Â±2.4 79.7Â±1.0
hopper-m-v2 73.7 74.1 Â±1.4 91.0Â±10.4 97.7Â±3.7 102.7 Â±3.1 46.3Â±15.1 104.1 Â±1.3
walker2d-m-v2 84.3 83.5 Â±0.7 85.6Â±7.6 81.7Â±14.0 75.3Â±25.7 34.0Â±17.3 86.0Â±12.6
halfcheetah-m-r-v2 46.9 49.5 Â±0.3 61.3Â±1.0 64.9Â±5.8 78.6Â±1.2 45.5Â±1.7 75.6Â±1.9
hopper-m-r-v2 96.0 95.0 Â±1.0 92.8Â±19.5 88.5Â±21.8 97.4Â±9.5 66.5Â±24.2 101.9 Â±9.1
walker2d-m-r-v2 83.4 84.5 Â±1.0 86.9Â±12.4 78.8Â±28.0 103.2 Â±19.0 40.1Â±17.9 108.2 Â±4.2
Tá»•ng 466.9 501.1 556.4 558.0 617.8 371.5 683.4
khi káº¿t há»£p vá»›i CQL. NhÆ° Ä‘Æ°á»£c chá»‰ ra trong [33], O3F khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL
offline dá»±a trÃªn Ä‘iá»u chá»‰nh giÃ¡ trá»‹. Äiá»u nÃ y cÅ©ng Ä‘Æ°á»£c quan sÃ¡t bá»Ÿi [35] vÃ  chÃºng tÃ´i cung cáº¥p
giáº£i thÃ­ch chi tiáº¿t trong Phá»¥ lá»¥c B. NgÆ°á»£c láº¡i, PEX huáº¥n luyá»‡n má»™t chÃ­nh sÃ¡ch má»›i tá»« Ä‘áº§u, vÃ 
khÃ´ng thá»ƒ táº­n dá»¥ng Ä‘áº§y Ä‘á»§ viá»‡c tÃ¡i sá»­ dá»¥ng khá»Ÿi táº¡o tá»‘t tá»« pretraining, do Ä‘Ã³ dáº«n Ä‘áº¿n hiá»‡u suáº¥t
háº¡n cháº¿.
HÆ¡n ná»¯a, chÃºng tÃ´i nháº­n xÃ©t ráº±ng SUNG vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n nháº¥t
trÆ°á»›c Ä‘Ã¢y, thá»ƒ hiá»‡n thÃªm 15.04% vÃ  14.05% cáº£i thiá»‡n offline-Ä‘áº¿n-online so vá»›i baseline hoáº¡t Ä‘á»™ng
tá»‘t nháº¥t khi káº¿t há»£p vá»›i TD3+BC vÃ  CQL, tÆ°Æ¡ng á»©ng. Äiá»u nÃ y chá»©ng minh sá»± cáº§n thiáº¿t cá»§a viá»‡c
Æ°á»›c tÃ­nh vÃ  sá»­ dá»¥ng thÃ­ch há»£p Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘á»ƒ giáº£i quyáº¿t cáº£ hÃ nh vi khÃ¡m phÃ¡ bá»‹ háº¡n cháº¿ vÃ  sá»± dá»‹ch
chuyá»ƒn phÃ¢n phá»‘i state-action. HÆ¡n ná»¯a, Ä‘iá»u nÃ y cÅ©ng xÃ¡c minh tÃ­nh tá»•ng quÃ¡t cá»§a SUNG trong
viá»‡c táº¡o Ä‘iá»u kiá»‡n cáº£i thiá»‡n online cho cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p RL
offline khÃ¡c nhau.
Káº¿t Quáº£ trÃªn AntMaze. ChÃºng tÃ´i cÅ©ng cung cáº¥p káº¿t quáº£ cho cÃ¡c miá»n AntMaze thÃ¡ch thá»©c hÆ¡n
vá»›i SPOT vÃ  CQL lÃ m phÆ°Æ¡ng phÃ¡p RL offline xÆ°Æ¡ng sá»‘ng. ChÃºng tÃ´i hoÃ£n káº¿t quáº£ vÃ  phÃ¢n tÃ­ch
chi tiáº¿t Ä‘áº¿n Phá»¥ lá»¥c D.1. ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng SUNG vÆ°á»£t trá»™i so vá»›i táº¥t cáº£ cÃ¡c baseline
trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t.
5.3 NghiÃªn Cá»©u Loáº¡i Bá»
Trong pháº§n nÃ y, chÃºng tÃ´i thá»±c hiá»‡n má»™t nghiÃªn cá»©u loáº¡i bá» vá» cÃ¡c thÃ nh pháº§n trong SUNG trong
HÃ¬nh 2. Tham kháº£o Phá»¥ lá»¥c D.4 Ä‘á»ƒ biáº¿t chi tiáº¿t triá»ƒn khai vÃ  cÃ¡c nghiÃªn cá»©u loáº¡i bá» bá»• sung.
Loáº¡i Bá» vá» KhÃ¡m PhÃ¡ Láº¡c Quan. Äáº§u tiÃªn, chÃºng tÃ´i Ä‘Ã¡nh giÃ¡ (a)SUNG khÃ´ng cÃ³ chiáº¿n lÆ°á»£c
khÃ¡m phÃ¡ láº¡c quan, vÃ  tháº¥y ráº±ng viá»‡c loáº¡i bá» mang láº¡i tÃ¡c Ä‘á»™ng tiÃªu cá»±c Ä‘Ã¡ng ká»ƒ khi káº¿t há»£p vá»›i
TD3+BC, nhÆ°ng khÃ´ng cÃ³ tÃ¡c Ä‘á»™ng Ä‘Ã¡ng chÃº Ã½ khi káº¿t há»£p vá»›i CQL. LÃ½ do cho sá»± khÃ¡c biá»‡t nÃ y
lÃ  CQL Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn Ä‘á»‰nh SAC, cÃ³ thá»ƒ dáº§n dáº§n phá»¥c há»“i sá»©c máº¡nh khÃ¡m phÃ¡ thÃ´ng qua
khung lÃ m viá»‡c RL entropy cá»±c Ä‘áº¡i trong quÃ¡ trÃ¬nh tinh chá»‰nh online. Sau Ä‘Ã³, chÃºng tÃ´i loáº¡i bá»
(b)Ä‘á»™ báº¥t Ä‘á»‹nh vÃ  (c)giÃ¡ trá»‹ Q trong chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan Ä‘á»ƒ suy ra hai chiáº¿n lÆ°á»£c biáº¿n
thá»ƒ - má»™t tham lam cho giÃ¡ trá»‹ Q vÃ  má»™t khÃ¡c tham lam cho Ä‘á»™ báº¥t Ä‘á»‹nh. NhÆ° mong Ä‘á»£i, cáº£ hai
viá»‡c loáº¡i bá» Ä‘á»u lÃ m giáº£m hiá»‡u suáº¥t á»Ÿ má»©c Ä‘á»™ khÃ¡c nhau, nháº¥n máº¡nh táº§m quan trá»ng cá»§a cáº£ giÃ¡
trá»‹ Q vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh cho khÃ¡m phÃ¡. ÄÃ¡ng chÃº Ã½, viá»‡c loáº¡i bá» Ä‘á»™ báº¥t Ä‘á»‹nh trong SUNG khi káº¿t há»£p
vá»›i CQL gÃ¢y ra sá»± suy giáº£m hiá»‡u suáº¥t Ä‘Ã¡ng ká»ƒ, cÃ³ thá»ƒ Ä‘Æ°á»£c quy cho lÃ½ do tÆ°Æ¡ng tá»± Ä‘Æ°á»£c chi tiáº¿t
trong Phá»¥ lá»¥c B.
Loáº¡i Bá» vá» Khai ThÃ¡c ThÃ­ch á»¨ng. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ (d)SUNG khÃ´ng cÃ³ phÆ°Æ¡ng phÃ¡p khai thÃ¡c
thÃ­ch á»©ng, vÃ  quan sÃ¡t tháº¥y ráº±ng hiá»‡u suáº¥t cho tinh chá»‰nh TD3+BC vÃ  CQL suy giáº£m Ä‘Ã¡ng ká»ƒ trÃªn
háº§u háº¿t cÃ¡c nhiá»‡m vá»¥. Äiá»u nÃ y nháº¥n máº¡nh sá»± cáº§n thiáº¿t cá»§a viá»‡c giáº£i quyáº¿t váº¥n Ä‘á» dá»‹ch chuyá»ƒn
phÃ¢n phá»‘i state-action.
Loáº¡i Bá» vá» Äá»‹nh LÆ°á»£ng Äá»™ Báº¥t Äá»‹nh. Cuá»‘i cÃ¹ng, chÃºng tÃ´i (e)thay tháº¿ bá»™ Æ°á»›c tÃ­nh máº­t Ä‘á»™ dá»±a
trÃªn VAE báº±ng Ä‘á»™ lá»‡ch chuáº©n cá»§a cÃ¡c giÃ¡ trá»‹ Q kÃ©p Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh [8]. NhÆ° mong Ä‘á»£i,
káº¿t quáº£ cho tháº¥y ráº±ng viá»‡c thay tháº¿ nhÆ° váº­y dáº«n Ä‘áº¿n sá»± suy giáº£m hiá»‡u suáº¥t trÃªn háº§u háº¿t cÃ¡c nhiá»‡m
vá»¥, vÃ¬ nÃ³ khÃ´ng Ä‘á»§ Ä‘á»ƒ cung cáº¥p Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘Ã¡ng tin cáº­y. Trong khi viá»‡c sá»­ dá»¥ng ká»¹
thuáº­t ensemble cÃ³ thá»ƒ loáº¡i bá» váº¥n Ä‘á» nÃ y [24,7], nÃ³ cÃ³ thá»ƒ tÄƒng Ä‘Ã¡ng ká»ƒ chi phÃ­ tÃ­nh toÃ¡n. ChÃºng
tÃ´i Ä‘á»ƒ láº¡i viá»‡c khÃ¡m phÃ¡ cÃ¡c phÆ°Æ¡ng phÃ¡p thay tháº¿ nhÆ° cÃ´ng viá»‡c tÆ°Æ¡ng lai.
8

--- TRANG 8 ---
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr40
20
02040SUNG (TD3+BC) 
 Pháº§n TrÄƒm KhÃ¡c Biá»‡t(a)
w/o Opt. Exploration
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040(b)
Opt. Exploration w/o Unc.
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040(c)
Opt. Exploration w/o Q
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040(d)
w/o Adp. Exploitation
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040(e)
Unc. Estimation w/ Q std
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr40
20
02040SUNG (CQL) 
 Pháº§n TrÄƒm KhÃ¡c Biá»‡tw/o Opt. Exploration
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040Opt. Exploration w/o Unc.
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040Opt. Exploration w/o Q
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040w/o Adp. Exploitation
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040Unc. Estimation w/ Q stdHÃ¬nh 2: KhÃ¡c biá»‡t hiá»‡u suáº¥t cá»§a má»™t nghiÃªn cá»©u loáº¡i bá» cá»§a SUNG káº¿t há»£p vá»›i TD3+BC vÃ  CQL,
so vá»›i thuáº­t toÃ¡n Ä‘áº§y Ä‘á»§. Opt. = Optimistic, Unc. = Uncertainty, Adp. = Adaptive. hc =
HalfCheetah, hop = Hopper, w = Walker, r = random, m = medium, mr = medium-replay.
10 20 40 80
k707580Äiá»ƒm Sá»‘ D4RL Trung BÃ¬nh
SUNG (TD3+BC)
10 20 40 80
k50607080
SUNG (CQL)
Uncertainty first Q first best baseline
HÃ¬nh 3: So sÃ¡nh hiá»‡u suáº¥t vá»›i thá»© tá»± khÃ¡c
nhau cá»§a tiÃªu chÃ­ xáº¿p háº¡ng vÃ  kÃ­ch thÆ°á»›c táº­p
hÃ nh Ä‘á»™ng chung káº¿t k Ä‘Æ°á»£c sá»­ dá»¥ng trong
khÃ¡m phÃ¡ láº¡c quan.
1 5 10 20 50
p707580Äiá»ƒm Sá»‘ D4RL Trung BÃ¬nh
SUNG (TD3+BC)
1 5 10 20 50
p50607080
SUNG (CQL)
best baselineHÃ¬nh 4: So sÃ¡nh hiá»‡u suáº¥t vá»›i pháº§n trÄƒm p khÃ¡c
nhau cá»§a cÃ¡c máº«u OOD Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh tá»« mini-batch
Ä‘Æ°á»£c sá»­ dá»¥ng trong khai thÃ¡c thÃ­ch á»©ng.
5.4 PhÃ¢n TÃ­ch SiÃªu Tham Sá»‘
PhÃ¢n TÃ­ch vá» KhÃ¡m PhÃ¡ Láº¡c Quan. Äáº§u tiÃªn, chÃºng tÃ´i Ä‘iá»u tra thá»© tá»± cá»§a cÃ¡c tiÃªu chÃ­ xáº¿p háº¡ng
vÃ  kÃ­ch thÆ°á»›c táº­p hÃ nh Ä‘á»™ng chung káº¿t k trong khÃ¡m phÃ¡ láº¡c quan. Káº¿t quáº£ tá»•ng há»£p trung bÃ¬nh
trÃªn cÃ¡c miá»n MuJoCo Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 3. NhÆ° mong Ä‘á»£i trong Phá»¥ lá»¥c B, SUNG vá»›i
TD3+BC cÃ³ thá»ƒ chá»©a sá»± Æ°u tiÃªn cho cáº£ Ä‘á»™ báº¥t Ä‘á»‹nh cao vÃ  giÃ¡ trá»‹ cao, trong khi SUNG vá»›i CQL
chá»‰ cÃ³ thá»ƒ chá»©a sá»± Æ°u tiÃªn cho Ä‘á»™ báº¥t Ä‘á»‹nh cao. Do Ä‘Ã³, chÃºng tÃ´i chá»n thá»© tá»± vá»›i Q Ä‘áº§u tiÃªn cho
TD3+BC, vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘áº§u tiÃªn cho CQL. BÃªn cáº¡nh Ä‘Ã³, chÃºng tÃ´i nháº­n xÃ©t ráº±ng SUNG luÃ´n vÆ°á»£t
trá»™i so vá»›i baseline tá»‘t nháº¥t vá»›i báº¥t ká»³ lá»±a chá»n k nÃ o, Ä‘iá»u nÃ y tiáº¿p tá»¥c xÃ¡c minh sá»± vÆ°á»£t trá»™i cá»§a
SUNG.
PhÃ¢n TÃ­ch vá» Khai ThÃ¡c ThÃ­ch á»¨ng. HÆ¡n ná»¯a, chÃºng tÃ´i khÃ¡m phÃ¡ lá»±a chá»n pháº§n trÄƒm p cá»§a cÃ¡c
máº«u OOD Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh tá»« mini-batch trong khai thÃ¡c thÃ­ch á»©ng. Káº¿t quáº£ tá»•ng há»£p trung bÃ¬nh
trÃªn cÃ¡c miá»n MuJoCo Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 4. Dá»± Ä‘oÃ¡n Ä‘Æ°á»£c, viá»‡c Ä‘áº·t p quÃ¡ báº£o thá»§ hoáº·c
quÃ¡ máº¡nh máº½ cÃ³ thá»ƒ lÃ m giáº£m hiá»‡u suáº¥t má»™t cÃ¡ch báº¥t lá»£i. ChÃºng tÃ´i tháº¥y ráº±ng p= 5 hoáº¡t Ä‘á»™ng tá»‘t
nháº¥t khi káº¿t há»£p vá»›i TD3+BC hoáº·c CQL, Ä‘áº¡t Ä‘Æ°á»£c sá»± cÃ¢n báº±ng mong muá»‘n giá»¯a hiá»‡u suáº¥t vÃ  á»•n
Ä‘á»‹nh.
6 Káº¿t Luáº­n, Háº¡n Cháº¿, vÃ  TÃ¡c Äá»™ng Rá»™ng HÆ¡n
BÃ i bÃ¡o nÃ y nghiÃªn cá»©u cÃ¡ch tinh chá»‰nh hiá»‡u quáº£ cÃ¡c agent RL offline Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c thÃ´ng
qua cÃ¡c tÆ°Æ¡ng tÃ¡c online. ChÃºng tÃ´i trÃ¬nh bÃ y SUNG, má»™t khung lÃ m viá»‡c hÆ°á»›ng dáº«n Ä‘á»™ báº¥t Ä‘á»‹nh
thá»‘ng nháº¥t Ä‘Æ¡n giáº£n, Ä‘á»ƒ giáº£i quyáº¿t cáº£ hai thÃ¡ch thá»©c cá»§a hÃ nh vi khÃ¡m phÃ¡ bá»‹ háº¡n cháº¿ vÃ  sá»± dá»‹ch
chuyá»ƒn phÃ¢n phá»‘i state-action. SUNG táº­n dá»¥ng Ä‘á»™ báº¥t Ä‘á»‹nh Ä‘Æ°á»£c Ä‘á»‹nh lÆ°á»£ng Ä‘á»ƒ hÆ°á»›ng dáº«n khÃ¡m
phÃ¡ láº¡c quan vÃ  khai thÃ¡c thÃ­ch á»©ng. Káº¿t quáº£ thá»±c nghiá»‡m trÃªn cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline xÆ°Æ¡ng
sá»‘ng khÃ¡c nhau, mÃ´i trÆ°á»ng vÃ  táº­p dá»¯ liá»‡u xÃ¡c minh sá»± vÆ°á»£t trá»™i cá»§a SUNG.
9

--- TRANG 9 ---
Vá» máº·t háº¡n cháº¿, khung lÃ m viá»‡c offline-Ä‘áº¿n-online Ä‘Æ°á»£c Ä‘á» xuáº¥t khÃ´ng thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng trá»±c tiáº¿p
cho cÃ¡c tiáº¿n bá»™ gáº§n Ä‘Ã¢y trong RL offline, nhÆ° cÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn RL cÃ³ Ä‘iá»u kiá»‡n pháº§n
thÆ°á»Ÿng [6,9] vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p on-policy [50]. Tuy nhiÃªn, chÃºng tÃ´i láº­p luáº­n ráº±ng nhá»¯ng hiá»ƒu
biáº¿t cá»§a SUNG cÃ³ thá»ƒ Ã¡p dá»¥ng chung vá» nguyÃªn táº¯c. ChÃºng tÃ´i Ä‘á»ƒ Ä‘iá»u nÃ y nhÆ° cÃ´ng viá»‡c tÆ°Æ¡ng
lai. Vá» tÃ¡c Ä‘á»™ng xÃ£ há»™i, chÃºng tÃ´i khÃ´ng dá»± Ä‘oÃ¡n báº¥t ká»³ háº­u quáº£ tiÃªu cá»±c nÃ o tá»« viá»‡c sá»­ dá»¥ng
khung lÃ m viá»‡c cá»§a chÃºng tÃ´i trong thá»±c táº¿. ChÃºng tÃ´i cung cáº¥p tháº£o luáº­n chi tiáº¿t hÆ¡n trong Phá»¥
lá»¥c E.
10

--- TRANG 10 ---
TÃ i Liá»‡u Tham Kháº£o
[1]Gaon An, Seungyong Moon, Jang-Hyun Kim, vÃ  Hyun Oh Song. Há»c tÄƒng cÆ°á»ng offline dá»±a
trÃªn Ä‘á»™ báº¥t Ä‘á»‹nh vá»›i q-ensemble Ä‘a dáº¡ng. Advances in Neural Information Processing
Systems, 34:7436â€“7447, 2021.
[2]Jean-Yves Audibert, RÃ©mi Munos, vÃ  Csaba SzepesvÃ¡ri. CÃ¢n báº±ng khÃ¡m phÃ¡â€“khai thÃ¡c
sá»­ dá»¥ng Æ°á»›c tÃ­nh phÆ°Æ¡ng sai trong bandit Ä‘a tay. Theoretical Computer Science, 410(19):
1876â€“1902, 2009.
[3]Chenjia Bai, Lingxiao Wang, Zhuoran Yang, Zhi-Hong Deng, Animesh Garg, Peng Liu, vÃ 
Zhaoran Wang. Bootstrapping bi quan cho há»c tÄƒng cÆ°á»ng offline hÆ°á»›ng dáº«n Ä‘á»™ báº¥t Ä‘á»‹nh.
InInternational Conference on Learning Representations, 2022.
[4]Ronen I Brafman vÃ  Moshe Tennenholtz. R-max-má»™t thuáº­t toÃ¡n thá»i gian Ä‘a thá»©c tá»•ng quÃ¡t
cho há»c tÄƒng cÆ°á»ng gáº§n tá»‘i Æ°u. Journal of Machine Learning Research, 3(Oct):213â€“231,
2002.
[5]Kaylee Burns, Tianhe Yu, Chelsea Finn, vÃ  Karol Hausman. Há»c tÄƒng cÆ°á»ng offline á»Ÿ nhiá»u
táº§n sá»‘. In Conference on Robot Learning, pages 2041â€“2051, 2023.
[6]Lili Chen, Kevin Lu, Aravind Rajeswaran, Kimin Lee, Aditya Grover, Misha Laskin, Pieter
Abbeel, Aravind Srinivas, vÃ  Igor Mordatch. Decision transformer: Há»c tÄƒng cÆ°á»ng thÃ´ng
qua mÃ´ hÃ¬nh hÃ³a chuá»—i. Advances in Neural Information Processing Systems, 34:15084â€“15097,
2021.
[7]Richard Y Chen, Szymon Sidor, Pieter Abbeel, vÃ  John Schulman. KhÃ¡m phÃ¡ ucb thÃ´ng qua
q-ensembles. arXiv preprint arXiv:1706.01502, 2017.
[8]Kamil Ciosek, Quan Vuong, Robert Loftin, vÃ  Katja Hofmann. KhÃ¡m phÃ¡ tá»‘t hÆ¡n vá»›i
actor critic láº¡c quan. Advances in Neural Information Processing Systems, 32, 2019.
[9]Scott Emmons, Benjamin Eysenbach, Ilya Kostrikov, vÃ  Sergey Levine. Rvs: Äiá»u gÃ¬ lÃ  cáº§n
thiáº¿t cho rl offline thÃ´ng qua há»c cÃ³ giÃ¡m sÃ¡t? In International Conference on Learning Representations,
2022.
[10] Justin Fu, Aviral Kumar, Ofir Nachum, George Tucker, vÃ  Sergey Levine. D4rl: Táº­p dá»¯ liá»‡u
cho há»c tÄƒng cÆ°á»ng sÃ¢u dá»±a trÃªn dá»¯ liá»‡u. arXiv preprint arXiv:2004.07219, 2020.
[11] Scott Fujimoto vÃ  Shixiang Shane Gu. Má»™t cÃ¡ch tiáº¿p cáº­n tá»‘i giáº£n cho há»c tÄƒng cÆ°á»ng offline.
Advances in Neural Information Processing Systems, 34:20132â€“20145, 2021.
[12] Scott Fujimoto, Herke Hoof, vÃ  David Meger. Giáº£i quyáº¿t lá»—i xáº¥p xá»‰ hÃ m trong cÃ¡c phÆ°Æ¡ng
phÃ¡p actor-critic. In International Conference on Machine Learning, pages 1587â€“1596,
2018.
[13] Scott Fujimoto, David Meger, vÃ  Doina Precup. Há»c tÄƒng cÆ°á»ng sÃ¢u off-policy khÃ´ng cÃ³
khÃ¡m phÃ¡. In International Conference on Machine Learning, pages 2052â€“2062,
2019.
[14] Kamyar Ghasemipour, Shixiang Shane Gu, vÃ  Ofir Nachum. Táº¡i sao láº¡i bi quan? Æ°á»›c tÃ­nh
Ä‘á»™ báº¥t Ä‘á»‹nh cho rl offline thÃ´ng qua ensembles, vÃ  táº¡i sao sá»± Ä‘á»™c láº­p cá»§a chÃºng quan trá»ng. Advances in
Neural Information Processing Systems, 35:18267â€“18281, 2022.
[15] Kaiyang Guo, Shao Yunfeng, vÃ  Yanhui Geng. Há»c tÄƒng cÆ°á»ng offline dá»±a trÃªn mÃ´ hÃ¬nh
vá»›i niá»m tin Ä‘á»™ng há»c Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bi quan. Advances in Neural Information Processing
Systems, 35:449â€“461, 2022.
[16] Tuomas Haarnoja, Aurick Zhou, Kristian Hartikainen, George Tucker, Sehoon Ha, Jie Tan,
Vikash Kumar, Henry Zhu, Abhishek Gupta, Pieter Abbeel, et al. Thuáº­t toÃ¡n vÃ  á»©ng dá»¥ng
soft actor-critic. arXiv preprint arXiv:1812.05905, 2018.
[17] Rahul Kidambi, Aravind Rajeswaran, Praneeth Netrapalli, vÃ  Thorsten Joachims. Morel:
Há»c tÄƒng cÆ°á»ng offline dá»±a trÃªn mÃ´ hÃ¬nh. Advances in Neural Information Processing
Systems, 33:21810â€“21823, 2020.
11

--- TRANG 11 ---
[18] Diederik P Kingma vÃ  Max Welling. Auto-encoding variational bayes. International Confer-
ence on Learning Representations, 2013.
[19] Diederik P Kingma, Max Welling, et al. Giá»›i thiá»‡u vá» autoencoders biáº¿n phÃ¢n. Founda-
tions and TrendsÂ® in Machine Learning, 12(4):307â€“392, 2019.
[20] Ilya Kostrikov, Rob Fergus, Jonathan Tompson, vÃ  Ofir Nachum. Há»c tÄƒng cÆ°á»ng offline
vá»›i Ä‘iá»u chá»‰nh critic phÃ¢n ká»³ fisher. In International Conference on Machine
Learning, pages 5774â€“5783, 2021.
[21] Ilya Kostrikov, Ashvin Nair, vÃ  Sergey Levine. Há»c tÄƒng cÆ°á»ng offline vá»›i há»c q ngáº§m.
In International Conference on Learning Representations, 2022.
[22] Aviral Kumar, Justin Fu, Matthew Soh, George Tucker, vÃ  Sergey Levine. á»”n Ä‘á»‹nh há»c
q off-policy thÃ´ng qua giáº£m lá»—i bootstrapping. Advances in Neural Information Processing
Systems, 32, 2019.
[23] Aviral Kumar, Aurick Zhou, George Tucker, vÃ  Sergey Levine. Há»c q báº£o thá»§
cho há»c tÄƒng cÆ°á»ng offline. Advances in Neural Information Processing Systems, 33:
1179â€“1191, 2020.
[24] Kimin Lee, Michael Laskin, Aravind Srinivas, vÃ  Pieter Abbeel. Sunrise: Má»™t khung lÃ m viá»‡c
thá»‘ng nháº¥t Ä‘Æ¡n giáº£n cho há»c ensemble trong há»c tÄƒng cÆ°á»ng sÃ¢u. In International Conference
on Machine Learning, pages 6131â€“6141, 2021.
[25] Seunghyun Lee, Younggyo Seo, Kimin Lee, Pieter Abbeel, vÃ  Jinwoo Shin. Há»c tÄƒng cÆ°á»ng
offline-Ä‘áº¿n-online thÃ´ng qua phÃ¡t láº¡i cÃ¢n báº±ng vÃ  q-ensemble bi quan. In Conference on Robot
Learning, pages 1702â€“1712, 2022.
[26] Seunghyun Lee, Da Young Lee, Sujeong Im, Nan Hee Kim, vÃ  Sung-Min Park. Clinical
decision transformer: Khuyáº¿n nghá»‹ Ä‘iá»u trá»‹ dá»± Ä‘á»‹nh thÃ´ng qua prompting má»¥c tiÃªu. arXiv
preprint arXiv:2302.00612, 2023.
[27] Sergey Levine, Aviral Kumar, George Tucker, vÃ  Justin Fu. Há»c tÄƒng cÆ°á»ng offline:
HÆ°á»›ng dáº«n, Ä‘Ã¡nh giÃ¡, vÃ  quan Ä‘iá»ƒm vá» cÃ¡c váº¥n Ä‘á» má»Ÿ. arXiv preprint arXiv:2005.01643, 2020.
[28] Owen Lockwood vÃ  Mei Si. Má»™t Ä‘Ã¡nh giÃ¡ vá» Ä‘á»™ báº¥t Ä‘á»‹nh cho há»c tÄƒng cÆ°á»ng sÃ¢u. In Pro-
ceedings of the AAAI Conference on Artificial Intelligence and Interactive Digital Entertainment,
volume 18, pages 155â€“162, 2022.
[29] Cong Lu, Philip J Ball, Tim GJ Rudner, Jack Parker-Holder, Michael A Osborne, vÃ  Yee Whye
Teh. ThÃ¡ch thá»©c vÃ  cÆ¡ há»™i trong há»c tÄƒng cÆ°á»ng offline tá»« quan sÃ¡t trá»±c quan.
arXiv preprint arXiv:2206.04779, 2022.
[30] Yicheng Luo, Jackie Kay, Edward Grefenstette, vÃ  Marc Peter Deisenroth. Tinh chá»‰nh tá»«
há»c tÄƒng cÆ°á»ng offline: ThÃ¡ch thá»©c, cÃ¢n báº±ng vÃ  giáº£i phÃ¡p thá»±c táº¿. arXiv preprint
arXiv:2303.17396, 2023.
[31] Jiafei Lyu, Xiaoteng Ma, Xiu Li, vÃ  Zongqing Lu. Há»c q nháº¹ nhÃ ng báº£o thá»§ cho há»c tÄƒng cÆ°á»ng
offline. In Thirty-sixth Conference on Neural Information Processing Systems,
2022.
[32] Yihuan Mao, Chao Wang, Bin Wang, vÃ  Chongjie Zhang. Moore: Há»c tÄƒng cÆ°á»ng offline-Ä‘áº¿n-
online dá»±a trÃªn mÃ´ hÃ¬nh. arXiv preprint arXiv:2201.10070, 2022.
[33] Max Sobol Mark, Ali Ghadirzadeh, Xi Chen, vÃ  Chelsea Finn. Tinh chá»‰nh cÃ¡c chÃ­nh sÃ¡ch
offline vá»›i lá»±a chá»n hÃ nh Ä‘á»™ng láº¡c quan. In Deep Reinforcement Learning Workshop NeurIPS, 2022.
[34] Ashvin Nair, Abhishek Gupta, Murtaza Dalal, vÃ  Sergey Levine. Awac: TÄƒng tá»‘c há»c tÄƒng cÆ°á»ng
online vá»›i táº­p dá»¯ liá»‡u offline. arXiv preprint arXiv:2006.09359, 2020.
[35] Mitsuhiko Nakamoto, Yuexiang Zhai, Anikait Singh, Max Sobol Mark, Yi Ma, Chelsea Finn,
Aviral Kumar, vÃ  Sergey Levine. Cal-ql: Pretrain rl offline Ä‘Æ°á»£c hiá»‡u chuáº©n cho tinh chá»‰nh
online hiá»‡u quáº£. arXiv preprint arXiv:2303.05479, 2023.
12

--- TRANG 12 ---
[36] Shideh Rezaeifar, Robert Dadashi, Nino Vieillard, LÃ©onard Hussenot, Olivier Bachem, Olivier
Pietquin, vÃ  Matthieu Geist. Há»c tÄƒng cÆ°á»ng offline nhÆ° chá»‘ng khÃ¡m phÃ¡. In Proceedings
of the AAAI Conference on Artificial Intelligence, pages 8106â€“8114, 2022.
[37] Danilo Jimenez Rezende, Shakir Mohamed, vÃ  Daan Wierstra. Backpropagation ngáº«u nhiÃªn
vÃ  suy luáº­n xáº¥p xá»‰ trong cÃ¡c mÃ´ hÃ¬nh generative sÃ¢u. In International Conference on Machine
Learning, pages 1278â€“1286, 2014.
[38] Juergen Schmidhuber. Há»c tÄƒng cÆ°á»ng ngÆ°á»£c: Äá»«ng dá»± Ä‘oÃ¡n pháº§n thÆ°á»Ÿngâ€“chá»‰ cáº§n Ã¡nh xáº¡
chÃºng thÃ nh hÃ nh Ä‘á»™ng. arXiv preprint arXiv:1912.02875, 2019.
[39] Jialong Wu, Haixu Wu, Zihan Qiu, Jianmin Wang, vÃ  Mingsheng Long. Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch
Ä‘Æ°á»£c há»— trá»£ cho há»c tÄƒng cÆ°á»ng offline. In Advances in Neural Information Processing
Systems, 2022.
[40] Yue Wu, Shuangfei Zhai, Nitish Srivastava, Joshua M Susskind, Jian Zhang, Ruslan Salakhutdi-
nov, vÃ  Hanlin Goh. Actor-critic cÃ³ trá»ng sá»‘ Ä‘á»™ báº¥t Ä‘á»‹nh cho há»c tÄƒng cÆ°á»ng offline. In
International Conference on Machine Learning, pages 11319â€“11328, 2021.
[41] Haoran Xu, Li Jiang, Li Jianxiong, vÃ  Xianyuan Zhan. Má»™t cÃ¡ch tiáº¿p cáº­n báº¯t chÆ°á»›c hÆ°á»›ng dáº«n
chÃ­nh sÃ¡ch cho há»c tÄƒng cÆ°á»ng offline. Advances in Neural Information Processing Systems, 35:
4085â€“4098, 2022.
[42] Haoran Xu, Li Jiang, Jianxiong Li, Zhuoran Yang, Zhaoran Wang, Victor Wai Kin Chan,
vÃ  Xianyuan Zhan. Rl offline khÃ´ng cÃ³ hÃ nh Ä‘á»™ng ood: Há»c trong máº«u thÃ´ng qua Ä‘iá»u chá»‰nh
giÃ¡ trá»‹ ngáº§m. In International Conference on Learning Representations, 2023.
[43] Tianhe Yu, Garrett Thomas, Lantao Yu, Stefano Ermon, James Y Zou, Sergey Levine, Chelsea
Finn, vÃ  Tengyu Ma. Mopo: Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch offline dá»±a trÃªn mÃ´ hÃ¬nh. Advances in Neural
Information Processing Systems, 33:14129â€“14142, 2020.
[44] Zishun Yu vÃ  Xinhua Zhang. CÄƒn chá»‰nh actor-critic cho há»c tÄƒng cÆ°á»ng offline-Ä‘áº¿n-online.
2023.
[45] Haichao Zhang, We Xu, vÃ  Haonan Yu. Má»Ÿ rá»™ng chÃ­nh sÃ¡ch Ä‘á»ƒ káº¿t ná»‘i há»c tÄƒng cÆ°á»ng
offline-Ä‘áº¿n-online. The International Conference on Learning Representations, 2023.
[46] Kesen Zhao, Lixin Zou, Xiangyu Zhao, Maolin Wang, et al. Khuyáº¿n nghá»‹ hÆ°á»›ng duy trÃ¬ ngÆ°á»i
dÃ¹ng vá»›i decision transformer. Proceedings of the ACM Web Conference, 2023.
[47] Yi Zhao, Rinu Boney, Alexander Ilin, Juho Kannala, vÃ  Joni Pajarinen. Äiá»u chá»‰nh behavior
cloning thÃ­ch á»©ng cho há»c tÄƒng cÆ°á»ng offline-Ä‘áº¿n-online á»•n Ä‘á»‹nh. arXiv preprint
arXiv:2210.13846, 2022.
[48] Han Zheng, Xufang Luo, Pengfei Wei, Xuan Song, Dongsheng Li, vÃ  Jing Jiang. Há»c
chÃ­nh sÃ¡ch thÃ­ch á»©ng cho há»c tÄƒng cÆ°á»ng offline-Ä‘áº¿n-online. In Proceedings of the AAAI
Conference on Artificial Intelligence, 2023.
[49] Qinqing Zheng, Amy Zhang, vÃ  Aditya Grover. Decision transformer online. In International
Conference on Machine Learning, pages 27042â€“27059, 2022.
[50] Zifeng Zhuang, Kun LEI, Jinxin Liu, Donglin Wang, vÃ  Yilang Guo. Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch
proximal hÃ nh vi. In International Conference on Learning Representations, 2023. URL
https://openreview.net/forum?id=3c13LptpIph.
13

--- TRANG 13 ---
Phá»¥ Lá»¥c
A Chi Tiáº¿t Triá»ƒn Khai cá»§a SUNG
Trong pháº§n nÃ y, chÃºng tÃ´i cung cáº¥p hai trÆ°á»ng há»£p triá»ƒn khai cá»§a SUNG: má»™t káº¿t ná»‘i TD3+BC [11]
vÃ  TD3 [12], vÃ  má»™t khÃ¡c káº¿t ná»‘i CQL [23] vÃ  SAC [16]. LÆ°u Ã½ ráº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline
hiá»‡n táº¡i thÆ°á»ng Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn cÃ¡c phÆ°Æ¡ng phÃ¡p RL online off-policy. Do Ä‘Ã³, chÃºng tÃ´i sá»­
dá»¥ng cÃ¡c má»¥c tiÃªu RL online tÆ°Æ¡ng á»©ng cho tinh chá»‰nh online Ä‘á»ƒ giá»¯ nháº¥t quÃ¡n.
A.1 SUNG (TD3+BC): Káº¿t Ná»‘i TD3+BC vÃ  TD3
Äáº§u tiÃªn, chÃºng tÃ´i cho tháº¥y cÃ¡ch SUNG (TD3+BC) káº¿t ná»‘i TD3+BC vÃ  TD3 Ä‘á»ƒ tinh chá»‰nh chÃ­nh
sÃ¡ch deterministic Ï€Ï•(s) vÃ  hai hÃ m giÃ¡ trá»‹ Q QÎ¸1(s, a), QÎ¸2(s, a).
Vá» khÃ¡m phÃ¡, chÃ­nh sÃ¡ch hÃ nh vi cá»§a SUNG (TD3+BC) tÆ°Æ¡ng thÃ­ch vá»›i sá»± Æ°u tiÃªn cho giÃ¡ trá»‹
Q cao hoáº·c Ä‘á»™ báº¥t Ä‘á»‹nh cao, nhÆ° Ä‘Æ°á»£c chá»©ng minh trong pháº§n chÃ­nh. á» Ä‘Ã¢y, chÃºng tÃ´i láº¥y sá»± Æ°u
tiÃªn cho giÃ¡ trá»‹ Q cao lÃ m vÃ­ dá»¥. VÃ¬ TD3 sá»­ dá»¥ng chÃ­nh sÃ¡ch deterministic, chÃºng tÃ´i Ä‘áº§u tiÃªn táº¡o
má»™t táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={ai=Ï€Ï•(s) +Ïµi}N
i=1, trong Ä‘Ã³ Ïµiâˆ¼ N(0, Î´) lÃ  nhiá»…u Gaussian.
Sau Ä‘Ã³, cÃ¡c hÃ nh Ä‘á»™ng á»©ng viÃªn cÃ³ giÃ¡ trá»‹ Q top-k Ä‘Æ°á»£c chá»n nhÆ° táº­p hÃ nh Ä‘á»™ng chung káº¿t Cf.
Cuá»‘i cÃ¹ng, chÃºng tÃ´i láº¥y máº«u hÃ nh Ä‘á»™ng Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c tá»« má»™t phÃ¢n phá»‘i categorical P(ai), aiâˆˆ Cf
trong Eq. (8) theo Ä‘á»™ báº¥t Ä‘á»‹nh. Trong thá»±c táº¿, chÃºng tÃ´i Ä‘áº·t N= 100 vÃ  k= 10 Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i
mÃ´i trÆ°á»ng báº±ng cÃ¡ch chá»n cÃ¡c hÃ nh Ä‘á»™ng cÃ³ giÃ¡ trá»‹ cao vÃ  Ä‘á»™ báº¥t Ä‘á»‹nh tÆ°Æ¡ng Ä‘á»‘i cao.
Vá» khai thÃ¡c, SUNG (TD3+BC) tuÃ¢n theo TD3+BC vÃ  TD3 Ä‘á»ƒ há»c TD tiÃªu chuáº©n cho Ä‘Ã¡nh giÃ¡
chÃ­nh sÃ¡ch, vÃ  Ã¡p dá»¥ng phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng Ä‘Æ°á»£c Ä‘á» xuáº¥t cho cáº£i thiá»‡n chÃ­nh sÃ¡ch nhÆ°
Ladp,TD3+BC
Ï€ (Ï•) =Esâˆ¼BOORB [âˆ’QÎ¸(s, Ï€Ï•(s))] + Î»E(s,a)âˆ¼BOORB[
I(s, Ï€Ï•(s)) (Ï€Ï•(s)âˆ’a)2].
(11)
TÃ­ch há»£p cÃ¡c chi tiáº¿t trÃªn, chÃºng tÃ´i Ä‘Æ°a ra mÃ´ táº£ thuáº­t toÃ¡n chi tiáº¿t cá»§a SUNG (TD3+BC) trong
Thuáº­t toÃ¡n 2.
A.2 SUNG (CQL): Káº¿t Ná»‘i CQL vÃ  SAC
Sau Ä‘Ã³, chÃºng tÃ´i cho tháº¥y cÃ¡ch SUNG (CQL) káº¿t ná»‘i CQL vÃ  SAC Ä‘á»ƒ tinh chá»‰nh chÃ­nh sÃ¡ch ngáº«u
nhiÃªn Ï€Ï•(Â·|s) vÃ  hai hÃ m giÃ¡ trá»‹ Q QÎ¸1(s, a), QÎ¸2(s, a).
Vá» khÃ¡m phÃ¡, chÃ­nh sÃ¡ch hÃ nh vi cá»§a SUNG (CQL) chá»‰ tÆ°Æ¡ng thÃ­ch vá»›i sá»± Æ°u tiÃªn cho Ä‘á»™ báº¥t
Ä‘á»‹nh cao, nhÆ° Ä‘Æ°á»£c chá»©ng minh trong pháº§n chÃ­nh. VÃ¬ SAC sá»­ dá»¥ng chÃ­nh sÃ¡ch ngáº«u nhiÃªn, chÃºng
tÃ´i Ä‘áº§u tiÃªn táº¡o má»™t táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={aiâˆ¼Ï€Ï•(Â·|s)}N
i=1. Sau Ä‘Ã³, cÃ¡c hÃ nh Ä‘á»™ng á»©ng
viÃªn cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh top-k Ä‘Æ°á»£c chá»n nhÆ° táº­p hÃ nh Ä‘á»™ng chung káº¿t Cf. Cuá»‘i cÃ¹ng, chÃºng tÃ´i láº¥y
máº«u hÃ nh Ä‘á»™ng Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c tá»« má»™t phÃ¢n phá»‘i categorical P(ai), aiâˆˆ Cf tÆ°Æ¡ng tá»± nhÆ° Eq. (8)
theo giÃ¡ trá»‹ Q. Trong thá»±c táº¿, chÃºng tÃ´i Ä‘áº·t N= 100 vÃ  k= 20. LÆ°u Ã½ ráº±ng chÃºng tÃ´i tÄƒng nháº¹
giÃ¡ trá»‹ cá»§a k Ä‘á»ƒ trÃ¡nh cÃ¡c hÃ nh Ä‘á»™ng Ä‘Æ°á»£c chá»n cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh quÃ¡ cao cho hiá»‡u quáº£ máº«u. Do Ä‘Ã³,
chÃºng ta cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng báº±ng cÃ¡ch chá»n cÃ¡c hÃ nh Ä‘á»™ng cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh tÆ°Æ¡ng Ä‘á»‘i
cao vÃ  giÃ¡ trá»‹ Q tÆ°Æ¡ng Ä‘á»‘i cao.
Vá» khai thÃ¡c, SUNG (CQL) tuÃ¢n theo CQL vÃ  SAC Ä‘á»ƒ thá»±c hiá»‡n cáº£i thiá»‡n chÃ­nh sÃ¡ch nhÆ°
LSAC
Ï€(Ï•) =Esâˆ¼BOORB ,aâˆ¼Ï€Ï•(Â·|s)[QÎ¸(s, a)âˆ’logÏ€Ï•(a|s)], (12)
vÃ  Ã¡p dá»¥ng phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng Ä‘Æ°á»£c Ä‘á» xuáº¥t cho Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch nhÆ°
Ladp,CQL
Q (Î¸) =E(s,a,r,sâ€²)âˆ¼BOORB[
(QÎ¸(s, a)âˆ’râˆ’Î³QÂ¯Î¸(sâ€², Ï€Ï•(sâ€²)))2]
+Î»Esâˆ¼BOORB
I(s, Ï€Ï•(s))
Eaâˆ¼Ï€Ï•[QÎ¸(s, a)]âˆ’Eaâˆ¼BOORB [QÎ¸(s, a)]
,(13)
trong Ä‘Ã³ Ï€Ï•(s) biá»ƒu thá»‹ trung bÃ¬nh cá»§a chÃ­nh sÃ¡ch ngáº«u nhiÃªn Gaussian. TÃ­ch há»£p cÃ¡c chi tiáº¿t
trÃªn, chÃºng tÃ´i Ä‘Æ°a ra mÃ´ táº£ thuáº­t toÃ¡n chi tiáº¿t cá»§a SUNG (CQL) trong Thuáº­t toÃ¡n 3.
14

--- TRANG 14 ---
Thuáº­t ToÃ¡n 2 SUNG (TD3+BC): Káº¿t Ná»‘i TD3+BC vÃ  TD3
1:Äáº§u vÃ o: Táº­p dá»¯ liá»‡u D={(s, a, r, sâ€²)}
2://Pretraining Offline
3:Khá»Ÿi táº¡o máº¡ng Q QÎ¸, máº¡ng chÃ­nh sÃ¡ch Ï€Ï•, máº¡ng VAE vá»›i pÏˆ vÃ  qÏ†
4:fort= 1toT1do
5: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a)âˆ¼ D
6: Cáº­p nháº­t Î¸ vÃ  Ï• tá»‘i thiá»ƒu hÃ³a LQ(Î¸) trong Eq. (1) vÃ  LTD3+BC
Ï€ (Ï•) trong Eq. (3)
7: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
8:end for
9://Tinh Chá»‰nh Online
10:Khá»Ÿi táº¡o OORB vá»›i BOORB â† {B =âˆ…,D}
11:fort= 1toT2do
12: //KhÃ¡m PhÃ¡ Láº¡c Quan
13: Táº¡o táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={ai}N
i=1, trong Ä‘Ã³ ai=Ï€Ï•(st) +Ïµi,Ïµiâˆ¼ N(0, Î´)
14: Chá»n cÃ¡c hÃ nh Ä‘á»™ng cÃ³ giÃ¡ trá»‹ Q top-k nhÆ° táº­p hÃ nh Ä‘á»™ng chung káº¿t Cf
15: Láº¥y máº«u hÃ nh Ä‘á»™ng atâˆ¼P(ai), aiâˆˆ Cf trong Eq. (8) theo Ä‘á»™ báº¥t Ä‘á»‹nh
16: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at, thu tháº­p st+1 vÃ  rt tá»« mÃ´i trÆ°á»ng
17: LÆ°u trá»¯ cÃ¡c chuyá»ƒn tiáº¿p (st, at, rt, st+1) vÃ o B vÃ  D
18: //Khai ThÃ¡c ThÃ­ch á»¨ng
19: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a, r, sâ€²)âˆ¼ B OORB
20: XÃ¢y dá»±ng bá»™ nháº­n diá»‡n OOD I trong Eq. (10)
21: Cáº­p nháº­t Î¸ tá»‘i thiá»ƒu hÃ³a LQ(Î¸) trong Eq. (1)
22: Cáº­p nháº­t Ï• tá»‘i thiá»ƒu hÃ³a Ladp,TD3+BC
Ï€ (Ï•) trong Eq. (11)
23: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
24:end for
Thuáº­t ToÃ¡n 3 SUNG (CQL): Káº¿t Ná»‘i CQL vÃ  SAC
1:Äáº§u vÃ o: Táº­p dá»¯ liá»‡u D={(s, a, r, sâ€²)}
2://Pretraining Offline
3:Khá»Ÿi táº¡o máº¡ng Q QÎ¸, máº¡ng chÃ­nh sÃ¡ch Ï€Ï•, máº¡ng VAE vá»›i pÏˆ vÃ  qÏ†
4:fort= 1toT1do
5: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a)âˆ¼ D
6: Cáº­p nháº­t Î¸ vÃ  Ï• tá»‘i thiá»ƒu hÃ³a LCQL
Q(Î¸) trong Eq. (4) vÃ  LSAC
Ï€(Ï•) trong Eq. (12)
7: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
8:end for
9://Tinh Chá»‰nh Online
10:Khá»Ÿi táº¡o OORB vá»›i BOORB â† {B =âˆ…,D}
11:fort= 1toT2do
12: //KhÃ¡m PhÃ¡ Láº¡c Quan
13: Táº¡o táº­p hÃ nh Ä‘á»™ng á»©ng viÃªn C={aiâˆ¼Ï€Ï•(Â·|s)}N
i=1
14: Chá»n cÃ¡c hÃ nh Ä‘á»™ng cÃ³ Ä‘á»™ báº¥t Ä‘á»‹nh top-k nhÆ° táº­p hÃ nh Ä‘á»™ng chung káº¿t Cf
15: Láº¥y máº«u hÃ nh Ä‘á»™ng atâˆ¼P(ai), aiâˆˆ Cf tÆ°Æ¡ng tá»± nhÆ° Eq. (8) theo giÃ¡ trá»‹ Q
16: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at, thu tháº­p st+1 vÃ  rt tá»« mÃ´i trÆ°á»ng
17: LÆ°u trá»¯ cÃ¡c chuyá»ƒn tiáº¿p (st, at, rt, st+1) vÃ o B vÃ  D
18: //Khai ThÃ¡c ThÃ­ch á»¨ng
19: Láº¥y máº«u minibatch cá»§a cÃ¡c chuyá»ƒn tiáº¿p (s, a, r, sâ€²)âˆ¼ B OORB
20: XÃ¢y dá»±ng bá»™ nháº­n diá»‡n OOD I trong Eq. (10)
21: Cáº­p nháº­t Î¸ tá»‘i thiá»ƒu hÃ³a Ladp,CQL
Q (Î¸) trong Eq. (13)
22: Cáº­p nháº­t Ï• tá»‘i thiá»ƒu hÃ³a LSAC
Ï€(Ï•) trong Eq. (12)
23: Cáº­p nháº­t Ïˆ, Ï† tá»‘i thiá»ƒu hÃ³a LELBO (s, a;Ïˆ, Ï†) trong Eq. (6)
24:end for
15

--- TRANG 15 ---
B Táº¡i Sao KhÃ¡m PhÃ¡ vá»›i Sá»± Æ¯u TiÃªn cho GiÃ¡ Trá»‹ Cao Tháº¥t Báº¡i Khi Tinh Chá»‰nh
CQL?
Trong káº¿t quáº£ thá»±c nghiá»‡m, chÃºng tÃ´i tháº¥y ráº±ng O3F [33], chá»n cÃ¡c hÃ nh Ä‘á»™ng vá»›i sá»± Æ°u tiÃªn cho
giÃ¡ trá»‹ Q cao trong quÃ¡ trÃ¬nh khÃ¡m phÃ¡, tháº¥t báº¡i khi káº¿t há»£p vá»›i CQL [23]. BÃªn cáº¡nh Ä‘Ã³, SUNG
vá»›i sá»± Æ°u tiÃªn cho giÃ¡ trá»‹ Q cao Ä‘á»ƒ khÃ¡m phÃ¡ cÅ©ng tháº¥t báº¡i khi káº¿t há»£p vá»›i CQL. BÃ¢y giá», chÃºng
tÃ´i Ä‘Æ°a ra má»™t phÃ¢n tÃ­ch Ä‘á»‹nh tÃ­nh vá» lÃ½ do nÃ y. Äá»ƒ báº¯t Ä‘áº§u, chÃºng tÃ´i nhá»› láº¡i viá»‡c triá»ƒn khai thá»±c
táº¿ cá»§a Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch trong CQL:
arg min
QEsâˆˆD"
logX
aexp (Q(s, a))âˆ’Eaâˆ¼Ï€Î²(a|s)[Q(s, a)]#
+E(s,a,r,sâ€²)âˆ¼D
(Q(s, a)âˆ’y)2
,
(14)
trong Ä‘Ã³ Ï€Î² biá»ƒu thá»‹ chÃ­nh sÃ¡ch hÃ nh vi cá»§a táº­p dá»¯ liá»‡u offline vÃ  y biá»ƒu thá»‹ má»¥c tiÃªu TD tiÃªu chuáº©n
cho Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch.
CÃ³ ba thuáº­t ngá»¯ trong phÆ°Æ¡ng trÃ¬nh trÃªn: cho má»™t tráº¡ng thÃ¡i, thuáº­t ngá»¯ Ä‘áº§u tiÃªn tá»‘i thiá»ƒu hÃ³a cÃ¡c
giÃ¡ trá»‹ Q cá»§a táº¥t cáº£ cÃ¡c hÃ nh Ä‘á»™ng; thuáº­t ngá»¯ thá»© hai tá»‘i Ä‘a hÃ³a cÃ¡c giÃ¡ trá»‹ Q cá»§a hÃ nh Ä‘á»™ng Ä‘Æ°á»£c
thu tháº­p trong táº­p dá»¯ liá»‡u; thuáº­t ngá»¯ thá»© ba lÃ  há»c TD tiÃªu chuáº©n. Do Ä‘Ã³, cho tráº¡ng thÃ¡i s, khi
chÃºng ta chá»n hÃ nh Ä‘á»™ng giÃ¡ trá»‹ cao ah Ä‘á»ƒ khÃ¡m phÃ¡, chuyá»ƒn tiáº¿p (s, ah, sâ€², r) sáº½ Ä‘Æ°á»£c thu tháº­p
vÃ o bá»™ Ä‘á»‡m phÃ¡t láº¡i. Sau Ä‘Ã³, trong quÃ¡ trÃ¬nh khai thÃ¡c, sá»± káº¿t há»£p cá»§a thuáº­t ngá»¯ Ä‘áº§u tiÃªn vÃ  thá»©
hai trong phÆ°Æ¡ng trÃ¬nh dáº«n Ä‘áº¿n má»™t tÃ¬nh huá»‘ng mÃ  háº§u háº¿t cÃ¡c hÃ nh Ä‘á»™ng chÆ°a tháº¥y cÃ³ giÃ¡ trá»‹
tháº¥p vÃ  sáº½ cÃ³ giÃ¡ trá»‹ tháº¥p hÆ¡n do thuáº­t ngá»¯ Ä‘áº§u tiÃªn, trong khi má»™t sá»‘ hÃ nh Ä‘á»™ng Ä‘Ã£ tháº¥y cÃ³ giÃ¡
trá»‹ cao vÃ  sáº½ cÃ³ giÃ¡ trá»‹ cao hÆ¡n do thuáº­t ngá»¯ thá»© hai. VÃ¬ thuáº­t ngá»¯ thá»© ba liÃªn quan Ä‘áº¿n bootstrapping,
hÃ nh Ä‘á»™ng giÃ¡ trá»‹ cao sáº½ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ cÃ³ giÃ¡ trá»‹ tháº¥p hÆ¡n, dáº«n Ä‘áº¿n sá»± giáº£m nháº¥t quÃ¡n trong
cÃ¡c giÃ¡ trá»‹ cá»§a táº¥t cáº£ cÃ¡c hÃ nh Ä‘á»™ng vá»›i má»—i bÆ°á»›c gradient. Äiá»u nÃ y cuá»‘i cÃ¹ng cÃ³ thá»ƒ gÃ¢y ra sá»±
sá»¥p Ä‘á»• cá»§a cÃ¡c hÃ m giÃ¡ trá»‹ Q, dáº«n Ä‘áº¿n chÃ­nh sÃ¡ch kÃ©m thÃ´ng qua lan truyá»n trong cáº£i thiá»‡n chÃ­nh
sÃ¡ch.
ChÃºng tÃ´i nháº­n xÃ©t ráº±ng SUNG cÃ³ thá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch thay Ä‘á»•i tiÃªu chÃ­ xáº¿p háº¡ng
cho táº­p hÃ nh Ä‘á»™ng chung káº¿t vÃ  k Ä‘á»ƒ thá»ƒ hiá»‡n sá»± Æ°u tiÃªn cho Ä‘á»™ báº¥t Ä‘á»‹nh cao trong khi giÃ¡ trá»‹ Q
tÆ°Æ¡ng Ä‘á»‘i cao trong quÃ¡ trÃ¬nh khÃ¡m phÃ¡.
C Chi Tiáº¿t Thá»­ Nghiá»‡m ThÃªm
C.1 Chi Tiáº¿t CÃ i Äáº·t Thá»­ Nghiá»‡m
Äá»‘i vá»›i cÃ¡c nhiá»‡m vá»¥ MuJoCo, chÃºng tÃ´i tuÃ¢n theo cÃ´ng trÃ¬nh trÆ°á»›c [45] Ä‘á»ƒ bá» qua Ä‘Ã¡nh giÃ¡ trÃªn
cÃ¡c táº­p dá»¯ liá»‡u medium-expert vÃ  expert, nÆ¡i cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c offline Ä‘Ã£ cÃ³ thá»ƒ Ä‘áº¡t
Ä‘Æ°á»£c hiá»‡u suáº¥t cáº¥p Ä‘á»™ chuyÃªn gia vÃ  khÃ´ng cáº§n tinh chá»‰nh thÃªm. Táº¥t cáº£ cÃ¡c Ä‘Ã¡nh giÃ¡ sá»­ dá»¥ng cÃ¡c
táº­p dá»¯ liá»‡u cá»§a phiÃªn báº£n "-v2" Ä‘Æ°á»£c phÃ¡t hÃ nh má»›i nháº¥t. Táº¥t cáº£ cÃ¡c thá»­ nghiá»‡m Ä‘Æ°á»£c láº·p láº¡i vá»›i
5 seed ngáº«u nhiÃªn khÃ¡c nhau. Äá»‘i vá»›i má»—i Ä‘Ã¡nh giÃ¡, chÃºng tÃ´i cháº¡y 10 táº­p cho cÃ¡c nhiá»‡m vá»¥ MuJoCo
vÃ  100 táº­p cho cÃ¡c nhiá»‡m vá»¥ AntMaze. ChÃºng tÃ´i bÃ¡o cÃ¡o Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn 3 Ä‘Ã¡nh
giÃ¡ cuá»‘i cÃ¹ng cho cÃ¡c nhiá»‡m vá»¥ MuJoCo, vÃ  10 Ä‘Ã¡nh giÃ¡ cuá»‘i cÃ¹ng cho cÃ¡c nhiá»‡m vá»¥ AntMaze.
Äá»‘i vá»›i pretraining offline, chÃºng tÃ´i Ä‘áº§u tiÃªn huáº¥n luyá»‡n cÃ¡c agent vá»›i 1M bÆ°á»›c gradient báº±ng
cÃ¡ch thá»±c hiá»‡n quy trÃ¬nh tiÃªu chuáº©n Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a TD3+BC vÃ  CQL:
â€¢ TD3+BC [11]: https://github.com/sfujim/TD3_BC
â€¢ CQL [23]: https://github.com/young-geng/CQL
Sau Ä‘Ã³, checkpoint cuá»‘i cÃ¹ng cá»§a cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ khá»Ÿi Ä‘á»™ng
warm cho tinh chá»‰nh online. VÃ¬ cÃ¡c tÃ¡c giáº£ cá»§a SPOT [39] Ä‘Ã£ cung cáº¥p cÃ¡c checkpoint cá»§a cÃ¡c
agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c trong https://github.com/thuml/SPOT, chÃºng tÃ´i trá»±c tiáº¿p Ã¡p dá»¥ng
nhá»¯ng cÃ¡i nÃ y cho tinh chá»‰nh online.
ChÃºng tÃ´i tiáº¿n hÃ nh táº¥t cáº£ cÃ¡c thá»­ nghiá»‡m trÃªn 2 GPU NIVIDA 3090 vÃ  Intel Xeon Gold 6230
CPU táº¡i 2.10GHz.
C.2 Chi Tiáº¿t Triá»ƒn Khai vÃ  SiÃªu Tham Sá»‘
Äá»‘i vá»›i huáº¥n luyá»‡n VAE, chÃºng tÃ´i tuÃ¢n theo viá»‡c triá»ƒn khai chÃ­nh thá»©c cá»§a BCQ [13] vÃ  SPOT
[39]. TuÃ¢n theo SPOT, chÃºng tÃ´i chuáº©n hÃ³a cÃ¡c tráº¡ng thÃ¡i trong táº­p dá»¯ liá»‡u cho cÃ¡c miá»n MuJoCo
nhÆ°ng khÃ´ng chuáº©n hÃ³a cÃ¡c tráº¡ng thÃ¡i cho cÃ¡c miá»n AntMaze. KhÃ¡c vá»›i SPOT sá»­ dá»¥ng VAE Ä‘á»ƒ
Æ°á»›c tÃ­nh máº­t Ä‘á»™ cá»§a chÃ­nh sÃ¡ch hÃ nh vi, SUNG sá»­ dá»¥ng VAE Ä‘á»ƒ Æ°á»›c tÃ­nh máº­t Ä‘á»™ truy cáº­p state-action.
Do Ä‘Ã³, chÃºng tÃ´i Ä‘áº·t chiá»u tiá»m áº©n lÃ  2Ã—(state dim + action dim) thay vÃ¬ 2Ã—action dim. CÃ¡c siÃªu
tham sá»‘ chi tiáº¿t cho huáº¥n luyá»‡n VAE Ä‘Æ°á»£c liá»‡t kÃª trong Báº£ng 3. LÆ°u Ã½ ráº±ng chÃºng tÃ´i Ä‘Æ¡n giáº£n
láº¥y cÃ¡c siÃªu tham sá»‘ Ä‘Æ°á»£c bÃ¡o cÃ¡o trong
16

--- TRANG 16 ---
Báº£ng 3: SiÃªu tham sá»‘ cá»§a VAE Ä‘á»ƒ Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ báº¥t Ä‘á»‹nh trong SUNG.
SiÃªu tham sá»‘ GiÃ¡ trá»‹
Huáº¥n luyá»‡n VAEOptimizer Adam
Tá»· lá»‡ há»c 1e-3
Batch size 256
BÆ°á»›c gradient 1e5
Trá»ng sá»‘ thuáº­t ngá»¯ KL 0.5
Chuáº©n hÃ³a tráº¡ng thÃ¡i True cho MuJoCo
False cho AntMaze
Kiáº¿n trÃºc VAEEncoder hidden num 750
Encoder layers 3
Latent dim 2Ã—(state dim + action dim)
Decoder hidden dim 750
Decoder layers 3
Báº£ng 4: SiÃªu tham sá»‘ cá»§a tinh chá»‰nh online trong SUNG. LÆ°u Ã½ ráº±ng chÃºng tÃ´i khÃ´ng Ä‘iá»u chá»‰nh
báº¥t ká»³ siÃªu tham sá»‘ nÃ o trong RL xÆ°Æ¡ng sá»‘ng vÃ  kiáº¿n trÃºc.
SiÃªu tham sá»‘MuJoCo AntMaze
TD3+BC CQL SPOT CQL
RL XÆ°Æ¡ng Sá»‘ngOptimizer Adam Adam Adam Adam
Tá»· lá»‡ há»c Actor 3e-4 1e-4 1e-4 1e-4
Tá»· lá»‡ há»c Critic 3e-4 3e-4 3e-4 3e-4
Batch size 256 256 256 256
Há»‡ sá»‘ chiáº¿t kháº¥u 0.99 0.99 0.99 0.99
Tá»· lá»‡ cáº­p nháº­t má»¥c tiÃªu 5e-3 5e-3 5e-3 5e-3
Kiáº¿n TrÃºcActor hidden num 256 256 256 256
Actor layers 3 2 3 2
Critic hidden num 256 256 256 256
Actor layers 3 2 3 3
SUNGSá»‘ hÃ nh Ä‘á»™ng á»©ng viÃªn N 100 100 100 100
Sá»‘ hÃ nh Ä‘á»™ng chung káº¿t k 10 20 10 20
Thá»© tá»± tiÃªu chÃ­ xáº¿p háº¡ng qu uq qu uq
Nhiá»‡t Ä‘á»™ softmax Î± 1.0 1.0 1.0 1.0
Pháº§n trÄƒm máº«u OOD p 5 10 99 90
OORBKÃ­ch thÆ°á»›c bá»™ Ä‘á»‡m online 2e4 2e4 2e4 2e4
KÃ­ch thÆ°á»›c bá»™ Ä‘á»‡m offline 2e6 2e6 2e6 2e6
XÃ¡c suáº¥t OORB pOORB 0.1 0.1 0.2 0.7
SPOT [39] vÃ  bá» qua viá»‡c Ä‘iá»u chá»‰nh siÃªu tham sá»‘ cho huáº¥n luyá»‡n VAE. Do Ä‘Ã³, cáº£i thiá»‡n hiá»‡u
suáº¥t thÃªm Ä‘Æ°á»£c mong Ä‘á»£i tá»« viá»‡c Ä‘iá»u chá»‰nh cáº©n tháº­n.
Äá»‘i vá»›i tinh chá»‰nh online, chÃºng tÃ´i tuÃ¢n theo cÃ¹ng kiáº¿n trÃºc tiÃªu chuáº©n vÃ  cÃ¹ng siÃªu tham sá»‘ cá»§a
TD3+BC, CQL vÃ  SPOT cho táº¥t cáº£ cÃ¡c baseline. LÆ°u Ã½ ráº±ng chÃºng tÃ´i khÃ´ng Ä‘iá»u chá»‰nh báº¥t ká»³
siÃªu tham sá»‘ nÃ o cá»§a RL xÆ°Æ¡ng sá»‘ng vÃ  kiáº¿n trÃºc trong SUNG Ä‘á»ƒ so sÃ¡nh cÃ´ng báº±ng. Vá» tÃ¡i táº¡o
baseline, chÃºng tÃ´i tuÃ¢n thá»§ nghiÃªm ngáº·t viá»‡c triá»ƒn khai chÃ­nh thá»©c vÃ  cÃ¡c siÃªu tham sá»‘ Ä‘Æ°á»£c bÃ¡o
cÃ¡o trong bÃ i bÃ¡o gá»‘c cá»§a há» Ä‘á»ƒ tinh chá»‰nh cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá»›i TD3+BC, CQL
vÃ  SPOT cho cÃ¡c miá»n MuJoCo vÃ  AntMaze. Má»™t ngoáº¡i lá»‡ lÃ  ká»¹ thuáº­t ensemble náº·ng Ä‘Æ°á»£c loáº¡i
bá» trong BR Ä‘á»ƒ so sÃ¡nh cÃ´ng báº±ng. LÆ°u Ã½ ráº±ng chÃºng tÃ´i cÅ©ng trang bá»‹ baseline vá»›i OORB Ä‘á»ƒ so
sÃ¡nh cÃ´ng báº±ng. Táº¥t cáº£ cÃ¡c siÃªu tham sá»‘ chi tiáº¿t cho tinh chá»‰nh online Ä‘Æ°á»£c trÃ¬nh bÃ y trong Báº£ng
4.
17

--- TRANG 17 ---
Báº£ng 5: So sÃ¡nh Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c nhiá»‡m vá»¥ AntMaze vá»›i SPOT lÃ m phÆ°Æ¡ng phÃ¡p
RL offline xÆ°Æ¡ng sá»‘ng. ChÃºng tÃ´i bÃ¡o cÃ¡o giÃ¡ trá»‹ trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed.
SPOT offline-ft online-ft BR O3F APL PEX SUNG
antmaze-umaze-v2 93.2 96.6 Â±0.7 88.3Â±2.3 92.9Â±1.4 96.9Â±0.9 97.6Â±0.7 12.2Â±4.3 97.0Â±0.8
antmaze-umaze-diverse-v2 41.6 22.0 Â±2.5 0.0Â±0.0 0.0Â±0.0 65.3Â±2.2 50.5Â±3.1 0.0Â±0.0 71.7Â±6.2
antmaze-medium-play-v2 75.2 83.9 Â±2.2 0.0Â±0.0 6.4Â±5.0 85.6Â±1.3 86.0Â±1.4 0.1Â±0.1 88.6Â±1.5
antmaze-medium-diverse-v2 73.0 84.6 Â±2.0 0.5Â±0.5 0.0Â±0.0 80.1Â±4.2 86.0Â±2.4 0.0Â±0.0 91.7Â±1.2
antmaze-large-play-v2 40.8 40.9 Â±2.0 0.0Â±0.0 0.0Â±0.0 38.8Â±4.8 38.9Â±3.9 0.0Â±0.0 45.7Â±3.7
antmaze-large-diverse-v2 44.0 16.6 Â±2.0 0.0Â±0.0 0.0Â±0.0 3.0Â±0.9 3.8Â±0.9 0.0Â±0.0 19.8Â±1.6
Tá»•ng 367.8 344.6 88.8 99.3 369.7 362.8 12.3 414.5
Báº£ng 6: So sÃ¡nh Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c nhiá»‡m vá»¥ AntMaze vá»›i CQL lÃ m phÆ°Æ¡ng phÃ¡p
RL offline xÆ°Æ¡ng sá»‘ng. ChÃºng tÃ´i bÃ¡o cÃ¡o giÃ¡ trá»‹ trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed.
CQL offline-ft online-ft BR O3F APL PEX SUNG
antmaze-umaze-v2 88.6 87.9 Â±1.0 96.0Â±1.1 68.5Â±3.5 98.6Â±0.5 96.0Â±1.6 87.3Â±2.0 96.9Â±0.6
antmaze-umaze-diverse-v2 41.0 45.9 Â±1.8 0.0Â±0.1 0.0Â±0.0 0.0Â±0.0 0.0Â±0.0 0.7Â±1.4 50.5Â±3.1
antmaze-medium-play-v2 63.8 75.4 Â±1.9 18.6Â±11.0 22.2Â±8.2 67.3Â±2.3 22.8Â±2.5 0.3Â±0.4 86.3Â±1.4
antmaze-medium-diverse-v2 61.8 74.1 Â±1.8 22.1Â±9.1 13.6Â±4.9 80.8Â±2.9 36.8Â±4.3 0.3Â±1.0 85.6Â±2.1
antmaze-large-play-v2 32.0 41.8 Â±3.7 0.1Â±0.2 0.0Â±0.0 0.0Â±0.0 0.0Â±0.0 0.0Â±0.0 52.7Â±2.8
antmaze-large-diverse-v2 32.6 35.3 Â±2.6 0.7Â±1.8 0.1Â±0.1 0.0Â±0.0 0.0Â±0.0 0.0Â±0.0 44.1Â±3.5
Tá»•ng 319.6 360.4 137.5 104.3 246.7 155.6 88.6 416.1
D Káº¿t Quáº£ Thá»­ Nghiá»‡m ThÃªm
D.1 Thá»­ Nghiá»‡m trÃªn AntMaze
ChÃºng tÃ´i tiáº¿n hÃ nh thá»­ nghiá»‡m trÃªn cÃ¡c miá»n AntMaze thÃ¡ch thá»©c hÆ¡n, yÃªu cáº§u cÃ¡c agent xá»­ lÃ½
cÃ¡c pháº§n thÆ°á»Ÿng thÆ°a thá»›t vÃ  khÃ¢u ná»‘i cÃ¡c máº£nh quá»¹ Ä‘áº¡o dÆ°á»›i má»©c tá»‘i Æ°u. Káº¿t quáº£ cho cÃ¡c miá»n
AntMaze vá»›i SPOT vÃ  CQL lÃ m phÆ°Æ¡ng phÃ¡p RL offline xÆ°Æ¡ng sá»‘ng Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 5
vÃ  6, tÆ°Æ¡ng á»©ng. Tá»« káº¿t quáº£, chÃºng ta cÃ³ thá»ƒ quan sÃ¡t tháº¥y ráº±ng online-ft, BR vÃ  PEX gáº·p khÃ³
khÄƒn trong viá»‡c hÆ°á»Ÿng lá»£i tá»« tinh chá»‰nh online trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t, ngoáº¡i trá»« nhiá»‡m vá»¥ antmaze-umaze
tÆ°Æ¡ng Ä‘á»‘i dá»…. Äiá»u nÃ y xuáº¥t phÃ¡t tá»« nhu cáº§u vá» behavior cloning rÃµ rÃ ng hoáº·c ngáº§m Ä‘Æ°á»£c cung
cáº¥p bá»Ÿi cÃ¡c má»¥c tiÃªu RL offline, Ä‘iá»u nÃ y Ä‘Æ°á»£c yÃªu cáº§u Ä‘á»ƒ xá»­ lÃ½ cÃ¡c pháº§n thÆ°á»Ÿng thÆ°a thá»›t vÃ 
khÃ¢u ná»‘i cÃ¡c quá»¹ Ä‘áº¡o con dÆ°á»›i má»©c tá»‘i Æ°u. Tuy nhiÃªn, online-ft, BR vÃ  PEX Ä‘Æ°á»£c phÃ¡t triá»ƒn trÃªn
Ä‘á»‰nh cÃ¡c phÆ°Æ¡ng phÃ¡p RL hoÃ n toÃ n online, do Ä‘Ã³ tháº¥t báº¡i trong háº§u háº¿t cÃ¡c nhiá»‡m vá»¥.
HÆ¡n ná»¯a, chÃºng tÃ´i nháº­n xÃ©t ráº±ng SUNG, khi káº¿t há»£p vá»›i SPOT hoáº·c CQL, vÆ°á»£t trá»™i so vá»›i cÃ¡c
phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n khÃ¡c trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t. Äiá»u nÃ y chá»©ng minh sá»± vÆ°á»£t trá»™i cá»§a SUNG
trong viá»‡c khÃ¡m phÃ¡ cÃ¡c cáº·p state-action thÃ´ng tin cÃ³ thá»ƒ dáº«n Ä‘áº¿n káº¿t quáº£ cao, do Ä‘Ã³ cung cáº¥p
cÃ¡c máº«u hÃ nh vi cÃ³ giÃ¡ trá»‹ cho cÃ¡c agent há»c tá»« Ä‘Ã³. HÆ¡n ná»¯a, SUNG Ä‘áº¡t Ä‘Æ°á»£c sá»± cÃ¢n báº±ng linh
hoáº¡t giá»¯a cÃ¡c má»¥c tiÃªu RL offline vÃ  online báº±ng cÃ¡ch Ä‘iá»u chá»‰nh p, cho phÃ©p khÃ¢u ná»‘i cÃ¡c quá»¹
Ä‘áº¡o con dÆ°á»›i má»©c tá»‘i Æ°u vÃ  vÆ°á»£t qua váº¥n Ä‘á» pháº§n thÆ°á»Ÿng thÆ°a thá»›t.
D.2 So SÃ¡nh vá»›i Online Decision Transformer
VÃ¬ online decision transformer (ODT) [49] Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn Ä‘á»‰nh upside-down RL [38,6,9],
chÃºng tÃ´i so sÃ¡nh SUNG vá»›i ODT trong pháº§n riÃªng biá»‡t nÃ y. ChÃºng tÃ´i tuÃ¢n theo viá»‡c triá»ƒn khai
chÃ­nh thá»©c trong https://github.com/facebookresearch/online-dt Ä‘á»ƒ tÃ¡i táº¡o. ChÃºng tÃ´i tuÃ¢n thá»§
nghiÃªm ngáº·t cÃ i Ä‘áº·t thá»­ nghiá»‡m gá»‘c trong ODT Ä‘á»ƒ láº¥y 200K bÆ°á»›c mÃ´i trÆ°á»ng vÃ  chá»‰ xem xÃ©t cÃ¡c
nhiá»‡m vá»¥ vá»›i cÃ¡c táº­p dá»¯ liá»‡u offline medium vÃ  medium-replay cho tinh chá»‰nh online Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c
so sÃ¡nh cÃ´ng báº±ng.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 7, Ä‘á»‘i vá»›i háº§u háº¿t táº¥t cáº£ cÃ¡c cÃ i Ä‘áº·t, SUNG khi káº¿t há»£p vá»›i TD3+BC
hoáº·c CQL vÆ°á»£t trá»™i so vá»›i ODT báº±ng má»™t khoáº£ng cÃ¡ch lá»›n cáº£ vá» hiá»‡u suáº¥t cuá»‘i cÃ¹ng vÃ  cáº£i thiá»‡n
online Î´. Äiá»u nÃ y lÃ  do ODT há»c má»™t chÃ­nh sÃ¡ch cÃ³ Ä‘iá»u kiá»‡n pháº§n thÆ°á»Ÿng trong má»™t mÃ´ hÃ¬nh
há»c cÃ³ giÃ¡m sÃ¡t, do Ä‘Ã³ gáº·p khÃ³ khÄƒn trong viá»‡c táº­n dá»¥ng Ä‘áº§y Ä‘á»§ mÃ´ hÃ¬nh thá»­-vÃ -sai Ä‘Æ°á»£c sá»­ dá»¥ng
trong RL online truyá»n thá»‘ng. Tuy nhiÃªn, Ä‘Ã¡ng chÃº Ã½ ráº±ng ODT cho phÃ©p ngÆ°á»i dÃ¹ng tÃ¹y chá»‰nh
hÃ nh vi cá»§a cÃ¡c agent báº±ng cÃ¡ch chá»‰ Ä‘á»‹nh cÃ¡c Ä‘iá»u kiá»‡n khÃ¡c nhau, Ä‘iá»u nÃ y khÃ´ng Ä‘Æ°á»£c Ä‘áº·c trÆ°ng
bá»Ÿi RL truyá»n thá»‘ng.
18

--- TRANG 18 ---
Báº£ng 7: So sÃ¡nh Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c nhiá»‡m vá»¥ MuJoCo, táº­p trung vÃ o cáº£ hiá»‡u suáº¥t
cuá»‘i cÃ¹ng vÃ  cáº£i thiá»‡n online Î´. m = medium, m-r = medium-replay. ChÃºng tÃ´i cháº¡y 200K bÆ°á»›c
mÃ´i trÆ°á»ng Ä‘á»ƒ giá»¯ nháº¥t quÃ¡n vá»›i cÃ i Ä‘áº·t cá»§a ODT. ChÃºng tÃ´i bÃ¡o cÃ¡o giÃ¡ trá»‹ trung bÃ¬nh trÃªn 5 seed.
ODT (offline) ODT (online) Î´ TD3+BC SUNG Î´ CQL SUNG Î´
halfcheetah-m-v2 42.3 42.1 -0.2 48.0 85.5 37.5 48.1 86.7 38.6
hopper-m-v2 62.3 89.8 27.5 61.5 97.1 35.6 73.7 106.1 32.4
walker2d-m-v2 72.1 73.7 1.6 82.2 115.4 33.2 84.3 114.6 30.3
halfcheetah-m-r-v2 37.7 40.6 2.9 44.6 79.8 35.2 46.9 82.9 36.0
hopper-m-r-v2 83.2 88.3 5.1 55.9 104.1 48.2 96.0 83.5 -12.5
walker2d-m-r-v2 67.8 73.1 5.3 71.7 110.7 39.0 83.4 116.7 33.3
Tá»•ng 365.4 407.6 42.2 364.9 592.6 228.7 432.4 590.5 158.1
1 50 100304050607080Äiá»ƒm Sá»‘ D4RLhalfcheetah-r
1 50 10055606570758085halfcheetah-m
1 50 10045505560657075halfcheetah-m-r
1 50 100203040506070halfcheetah-r
1 50 1004050607080halfcheetah-m
1 50 1004050607080halfcheetah-m-r
1 50 1000102030405060Äiá»ƒm Sá»‘ D4RLhopper-r
1 50 1000255075100125hopper-m
1 50 100708090100110hopper-m-r
1 50 1000204060hopper-r
1 50 10060708090100110hopper-m
1 50 10060708090100110hopper-m-r
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)05101520Äiá»ƒm Sá»‘ D4RLwalker2d-r
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)6080100120walker2d-m
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)60708090100110walker2d-m-r
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)05101520walker2d-r
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)406080100walker2d-m
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)6080100120walker2d-m-rSUNG(CQL) SUNG(TD3+BC)
BR O3F APL SUNG|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
HÃ¬nh 5: ÄÆ°á»ng cong há»c cá»§a SUNG, khi káº¿t há»£p vá»›i TD3+BC vÃ  CQL, cho 100K bÆ°á»›c mÃ´i trÆ°á»ng
trÃªn cÃ¡c nhiá»‡m vá»¥ MuJoCo. ChÃºng tÃ´i cÅ©ng bao gá»“m ba baseline hoáº¡t Ä‘á»™ng tá»‘t nháº¥t, BR, O3F vÃ 
APL, Ä‘á»ƒ so sÃ¡nh. w = Walker, r = random, m = medium, m-r = medium-replay. ChÃºng tÃ´i bÃ¡o cÃ¡o
Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh vÃ  Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed huáº¥n luyá»‡n vá»›i 10 táº­p Ä‘Ã¡nh giÃ¡ má»—i láº§n.
LÆ°u Ã½ ráº±ng O3F bá»‹ bá» qua khi káº¿t há»£p vá»›i CQL do sá»± phÃ¢n ká»³ cá»§a nÃ³.
D.3 ÄÆ°á»ng Cong Há»c
ChÃºng tÃ´i hiá»ƒn thá»‹ cÃ¡c Ä‘Æ°á»ng cong há»c cá»§a SUNG khi káº¿t há»£p vá»›i TD3+BC vÃ  CQL cho cÃ¡c miá»n
MuJoCo trong HÃ¬nh 5. BÃªn cáº¡nh Ä‘Ã³, chÃºng tÃ´i hiá»ƒn thá»‹ cÃ¡c Ä‘Æ°á»ng cong há»c cá»§a SUNG khi káº¿t
há»£p vá»›i SPOT vÃ  CQL cho cÃ¡c miá»n AntMaze trong HÃ¬nh 6. Trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t, chÃºng ta
cÃ³ thá»ƒ quan sÃ¡t tháº¥y ráº±ng SUNG vÆ°á»£t qua cÃ¡c phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n nháº¥t trÆ°á»›c Ä‘Ã¢y vá» cáº£ hiá»‡u
suáº¥t cuá»‘i cÃ¹ng vÃ  hiá»‡u quáº£ máº«u.
D.4 NghiÃªn Cá»©u Loáº¡i Bá»
NghiÃªn Cá»©u Loáº¡i Bá» vá»›i CÃ¡c Biáº¿n Thá»ƒ cá»§a SUNG (HÃ¬nh 2). ChÃºng tÃ´i xem xÃ©t cÃ¡c biáº¿n thá»ƒ
sau cá»§a SUNG Ä‘á»ƒ thá»±c hiá»‡n nghiÃªn cá»©u loáº¡i bá» vá» cÃ¡c thÃ nh pháº§n cá»§a khung lÃ m viá»‡c cá»§a chÃºng
tÃ´i:
â€¢w/o Opt. Exploration: ChÃºng tÃ´i thay tháº¿ chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ láº¡c quan Ä‘Æ°á»£c Ä‘á» xuáº¥t báº±ng
khÃ¡m phÃ¡ máº·c Ä‘á»‹nh Ä‘Æ°á»£c cung cáº¥p bá»Ÿi TD3 vÃ  SAC. Äá»‘i vá»›i TD3, chÃºng tÃ´i chá»n hÃ nh Ä‘á»™ng
vá»›i nhiá»…u Gaussian
19

--- TRANG 19 ---
1 50 100707580859095100Äiá»ƒm Sá»‘ D4RLumaze
1 50 100707580859095medium-p
1 50 100010203040506070large-p
1 50 100405060708090100umaze
1 50 1005060708090medium-p
1 50 100202530354045505560large-p
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)020406080Äiá»ƒm Sá»‘ D4RLumaze-d
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)5060708090100medium-d
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)01020304050large-d
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)203040506070umaze-d
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)505560657075808590medium-d
1 50 100
BÆ°á»›c MÃ´i TrÆ°á»ng (1e3)20253035404550large-dSUNG(CQL) SUNG(SPOT)
offline-ft O3F APL SUNG|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
|
HÃ¬nh 6: ÄÆ°á»ng cong há»c cá»§a SUNG, khi káº¿t há»£p vá»›i SPOT vÃ  CQL, cho 100K bÆ°á»›c mÃ´i trÆ°á»ng
trÃªn cÃ¡c nhiá»‡m vá»¥ AntMaze. ChÃºng tÃ´i cÅ©ng bao gá»“m ba baseline hoáº¡t Ä‘á»™ng tá»‘t nháº¥t, offline-ft,
O3F vÃ  APL, Ä‘á»ƒ so sÃ¡nh. p = play, d = diverse. ChÃºng tÃ´i bÃ¡o cÃ¡o Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh vÃ 
Ä‘á»™ lá»‡ch chuáº©n trÃªn 5 seed huáº¥n luyá»‡n vá»›i 100 táº­p Ä‘Ã¡nh giÃ¡ má»—i láº§n.
Ä‘á»ƒ khÃ¡m phÃ¡, tá»©c lÃ , Ï€E(s) =Ï€Ï•(s) +Ïµ, Ïµâˆ¼ N(0, Î´). Äá»‘i vá»›i SAC, chÃºng tÃ´i láº¥y máº«u hÃ nh
Ä‘á»™ng tá»« chÃ­nh sÃ¡ch Ä‘á»ƒ khÃ¡m phÃ¡, tá»©c lÃ , Ï€E(s) =a, aâˆ¼Ï€Ï•(Â·|s).
â€¢Opt. Exploration w/o Unc.: ChÃºng tÃ´i loáº¡i bá» Ä‘á»™ báº¥t Ä‘á»‹nh khá»i chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ Ä‘Æ°á»£c
Ä‘á» xuáº¥t Ä‘á»ƒ tham lam chá»n hÃ nh Ä‘á»™ng tá»‘i Ä‘a hÃ³a giÃ¡ trá»‹ Q, tá»©c lÃ , Ï€E(s) = arg max aâˆˆCQ(s, a).
â€¢Opt. Exploration w/o Q: ChÃºng tÃ´i loáº¡i bá» giÃ¡ trá»‹ Q khá»i chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ Ä‘Æ°á»£c Ä‘á»
xuáº¥t Ä‘á»ƒ tham lam chá»n hÃ nh Ä‘á»™ng tá»‘i Ä‘a hÃ³a Ä‘á»™ báº¥t Ä‘á»‹nh, tá»©c lÃ , Ï€E(s) = arg max aâˆˆCU(s, a).
â€¢w/o Adp. Exploitation: ChÃºng tÃ´i thay tháº¿ phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng Ä‘Æ°á»£c Ä‘á» xuáº¥t
báº±ng má»¥c tiÃªu RL online tiÃªu chuáº©n cá»§a TD3 vÃ  SAC, tÆ°Æ¡ng á»©ng.
â€¢Unc. Estimation w/ Q std: ChÃºng tÃ´i thay tháº¿ VAE báº±ng Ä‘á»™ lá»‡ch chuáº©n cá»§a hai hÃ m giÃ¡
trá»‹ Q Ä‘á»ƒ Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh, tá»©c lÃ ,
U(s, a) =Ïƒ(QÎ¸1(s, a), QÎ¸2(s, a)) =|QÎ¸1(s, a)âˆ’QÎ¸2(s, a)|.
BÃªn cáº¡nh Ä‘Ã³, chÃºng tÃ´i cÅ©ng xem xÃ©t hai cÃ i Ä‘áº·t loáº¡i bá» thÃªm:
â€¢Adp. Exploitation w/ Rand.: ChÃºng tÃ´i xÃ¢y dá»±ng táº­p cáº·p state-action OOD DOOD báº±ng
cÃ¡ch láº¥y máº«u ngáº«u nhiÃªn tá»« mini-batch thay vÃ¬ sá»­ dá»¥ng bá»™ nháº­n diá»‡n máº«u OOD Ä‘Æ°á»£c Ä‘á» xuáº¥t.
â€¢OORB w/o Offline Data: ChÃºng tÃ´i khÃ´ng sá»­ dá»¥ng cÃ¡c chuyá»ƒn tiáº¿p tá»« táº­p dá»¯ liá»‡u offline
cho tinh chá»‰nh online báº±ng cÃ¡ch loáº¡i bá» dá»¯ liá»‡u offline khá»i OORB.
ChÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ cá»§a hai nghiÃªn cá»©u loáº¡i bá» trÃªn trong HÃ¬nh 7 vÃ  HÃ¬nh 8, tÆ°Æ¡ng á»©ng.
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 7, chÃºng ta cÃ³ thá»ƒ tháº¥y khi chÃºng ta sá»­ dá»¥ng chiáº¿n lÆ°á»£c láº¥y máº«u
ngáº«u nhiÃªn cho nháº­n diá»‡n máº«u OOD, hiá»‡u suáº¥t trÃªn háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t suy giáº£m. NhÆ° Ä‘Æ°á»£c hiá»ƒn
thá»‹ trong HÃ¬nh 8, chÃºng ta quan sÃ¡t tháº¥y ráº±ng viá»‡c loáº¡i bá» dá»¯ liá»‡u offline lÃ m háº¡i Ä‘Ã¡ng ká»ƒ hiá»‡u
suáº¥t offline-Ä‘áº¿n-online. Äiá»u nÃ y lÃ  do tinh chá»‰nh online cÃ³ thá»ƒ hÆ°á»Ÿng lá»£i tá»« viá»‡c tÃ¡i sá»­ dá»¥ng cÃ¡c
hÃ nh vi Ä‘a dáº¡ng chá»©a trong táº­p dá»¯ liá»‡u offline Ä‘á»ƒ trÃ¡nh overfitting.
PhÃ¢n TÃ­ch SiÃªu Tham Sá»‘ vá» Nhiá»‡t Äá»™ Softmax Î±. á» Ä‘Ã¢y, chÃºng tÃ´i Ä‘Æ°a ra phÃ¢n tÃ­ch siÃªu tham
sá»‘ cá»§a nhiá»‡t Ä‘á»™ softmax Î± trong Eq. (8). Cá»¥ thá»ƒ, chÃºng tÃ´i Ä‘iá»u tra lá»±a chá»n Î±âˆˆ {0.1,0.2,0.5,1.0,5.0,10.0,20.0,100.0}
cho cÃ¡c miá»n MuJoCo trong HÃ¬nh 9. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong hÃ¬nh, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng Î±
lÃ  má»™t siÃªu tham sá»‘ tÆ°Æ¡ng Ä‘á»‘i khÃ´ng nháº¡y cáº£m cho hiá»‡u suáº¥t offline-Ä‘áº¿n-online, vÃ  ráº±ng lá»±a chá»n
Î± hoáº¡t Ä‘á»™ng tá»‘t nháº¥t khÃ¡c nhau giá»¯a cÃ¡c cÃ i Ä‘áº·t khÃ¡c nhau. Do Ä‘Ã³, máº·c dÃ¹ viá»‡c Ä‘iá»u chá»‰nh cáº©n
tháº­n Î± sáº½ mang láº¡i cáº£i thiá»‡n offline-Ä‘áº¿n-online nhiá»u hÆ¡n, chÃºng tÃ´i Ä‘áº·t Î±= 1.0 trong táº¥t cáº£ káº¿t
quáº£ thá»­ nghiá»‡m xuyÃªn suá»‘t bÃ i bÃ¡o Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh Ä‘Æ¡n giáº£n cá»§a khung lÃ m viá»‡c Ä‘Æ°á»£c Ä‘á» xuáº¥t.
PhÃ¢n TÃ­ch SiÃªu Tham Sá»‘ vá» XÃ¡c Suáº¥t Láº¥y Máº«u OORB pOORB. HÆ¡n ná»¯a, chÃºng tÃ´i Ä‘Æ°a ra phÃ¢n
tÃ­ch siÃªu tham sá»‘ vá» pOORB cho OORB Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£. Cá»¥ thá»ƒ, chÃºng tÃ´i Ä‘iá»u tra
20

--- TRANG 20 ---
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr40
20
02040Pháº§n TrÄƒm KhÃ¡c Biá»‡tSUNG(TD3+BC)
Adp. Exploitation w/ Rand.
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040SUNG(CQL)
Adp. Exploitation w/ Rand.HÃ¬nh 7: KhÃ¡c biá»‡t hiá»‡u suáº¥t cá»§a hiá»‡u suáº¥t cá»§a
chiáº¿n lÆ°á»£c ngáº«u nhiÃªn cho nháº­n diá»‡n máº«u OOD,
so vá»›i thuáº­t toÃ¡n Ä‘áº§y Ä‘á»§.
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr40
20
02040Pháº§n TrÄƒm KhÃ¡c Biá»‡tSUNG(TD3+BC)
OORB w/o Offline Data
hc-rhop-rw-rhc-mhop-mw-mhc-mrhop-mrw-mr-40-2002040SUNG(CQL)
OORB w/o Offline DataHÃ¬nh 8: KhÃ¡c biá»‡t hiá»‡u suáº¥t cá»§a hiá»‡u suáº¥t khÃ´ng
cÃ³ dá»¯ liá»‡u offline, so vá»›i thuáº­t toÃ¡n Ä‘áº§y Ä‘á»§.
0.1 0.2 0.5 1.0 5.0 10.0 20.0 100.0
hc-r
hop-r
w-r
hc-m
hop-m
w-m
hc-mr
hop-mr
w-mr
totalÄiá»ƒm Sá»‘ D4RL Chuáº©n HÃ³a0.96 0.99 1.00 0.97 0.97 0.96 0.98 0.96
0.87 0.65 0.81 1.00 0.56 0.78 0.74 0.90
1.00 0.70 0.57 0.80 0.81 0.66 0.71 0.86
1.00 0.99 0.99 0.99 0.99 0.99 1.00 1.00
0.98 0.92 0.95 0.97 0.92 0.99 0.97 1.00
0.91 0.97 0.96 0.98 0.95 1.00 0.96 0.95
1.00 0.99 1.00 0.99 0.98 0.97 0.98 1.00
0.95 0.98 1.00 0.96 0.94 0.99 0.99 0.97
1.00 0.97 0.99 0.98 0.98 0.96 0.98 0.95
0.99 0.97 0.99 1.00 0.96 0.99 0.98 0.99SUNG(TD3+BC)
0.1 0.2 0.5 1.0 5.0 10.0 20.0 100.0
hc-r
hop-r
w-r
hc-m
hop-m
w-m
hc-mr
hop-mr
w-mr
totalÄiá»ƒm Sá»‘ D4RL Chuáº©n HÃ³a0.49 0.51 0.72 0.87 1.00 0.97 0.97 0.98
0.78 1.00 0.73 0.90 0.80 0.54 0.78 0.74
0.78 1.00 0.65 0.94 0.67 0.76 0.95 0.90
0.83 0.84 0.86 0.89 0.98 1.00 1.00 0.98
0.55 0.76 0.93 0.99 1.00 0.99 0.99 0.98
0.88 0.93 0.91 0.86 0.78 0.98 1.00 0.94
0.87 0.88 0.87 0.94 0.99 0.99 1.00 0.98
0.43 0.63 0.71 1.00 0.76 0.79 0.79 0.92
0.69 0.82 0.86 0.97 1.00 0.96 0.91 0.92
0.73 0.84 0.88 0.99 0.97 0.98 1.00 1.00SUNG(CQL)
0.600.650.700.750.800.850.900.951.00
0.50.60.70.80.91.0
HÃ¬nh 9: Heatmap cho hiá»‡u suáº¥t cá»§a SUNG vá»›i nhiá»‡t Ä‘á»™ softmax Î± khÃ¡c nhau. Káº¿t quáº£ cá»§a má»—i cÃ i
Ä‘áº·t Ä‘Æ°á»£c chuáº©n hÃ³a vá»›i chuáº©n hÃ³a tá»‘i Ä‘a Ä‘á»ƒ trá»±c quan hÃ³a tá»‘t hÆ¡n. hc = HalfCheetah, hop = Hopper,
w = Walker, r = random, m = medium, mr = medium-replay.
lá»±a chá»n xÃ¡c suáº¥t láº¥y máº«u OORB pOORB âˆˆ {0.0,0.1,0.2,0.4,0.6,0.8,1.0} cho cÃ¡c miá»n MuJoCo
trong HÃ¬nh 10. LÆ°u Ã½ ráº±ng xÃ¡c suáº¥t pOORB cao hÆ¡n chá»‰ ra viá»‡c tÃ¡i sá»­ dá»¥ng nhiá»u hÆ¡n táº­p dá»¯ liá»‡u
offline trong quÃ¡ trÃ¬nh há»c chÃ­nh sÃ¡ch. Tá»« káº¿t quáº£, chÃºng ta cÃ³ thá»ƒ quan sÃ¡t tháº¥y ráº±ng pOORB =
0.1 hoáº¡t Ä‘á»™ng tá»‘t nháº¥t khi káº¿t há»£p vá»›i TD3+BC vÃ  CQL, trong khi viá»‡c Ä‘áº·t pOORB quÃ¡ báº£o thá»§
(tá»©c lÃ , pOORB = 0) hoáº·c quÃ¡ máº¡nh máº½ (tá»©c lÃ , pOORB = 1.0) lÃ m háº¡i hiá»‡u suáº¥t. NhÆ° Ä‘Æ°á»£c chá»‰
ra bá»Ÿi Zheng et al. [48], dá»¯ liá»‡u offline cÃ³ thá»ƒ ngÄƒn cÃ¡c agent há»™i tá»¥ sá»›m Ä‘áº¿n cÃ¡c chÃ­nh sÃ¡ch dÆ°á»›i
má»©c tá»‘i Æ°u do sá»± Ä‘a dáº¡ng dá»¯ liá»‡u tiá»m nÄƒng, trong khi dá»¯ liá»‡u online cÃ³ thá»ƒ á»•n Ä‘á»‹nh huáº¥n luyá»‡n
vÃ  tÄƒng tá»‘c há»™i tá»¥. Do Ä‘Ã³, viá»‡c cÃ¡c thuáº­t toÃ¡n RL offline-Ä‘áº¿n-online hiá»‡u quáº£ máº«u káº¿t há»£p cáº£ dá»¯
liá»‡u offline vÃ  online trong quÃ¡ trÃ¬nh há»c chÃ­nh sÃ¡ch lÃ  quan trá»ng.
D.5 Suy Giáº£m vá» Trá»ng Sá»‘ Äiá»u Chá»‰nh Î»
Má»™t trá»±c giÃ¡c cho phÆ°Æ¡ng phÃ¡p khai thÃ¡c thÃ­ch á»©ng Ä‘Æ°á»£c Ä‘á» xuáº¥t lÃ  trá»ng sá»‘ Ä‘iá»u chá»‰nh Î» trong
Eq.(9) nÃªn Ä‘Æ°á»£c suy giáº£m trong quÃ¡ trÃ¬nh tinh chá»‰nh online, vÃ¬ sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i state-action
dáº§n dáº§n bá»‹ loáº¡i bá» vá»›i bÆ°á»›c mÃ´i trÆ°á»ng. Do Ä‘Ã³, trong pháº§n nÃ y, chÃºng tÃ´i khÃ¡m phÃ¡ cÆ¡ cháº¿ suy
giáº£m cho Î» báº±ng cÃ¡ch giáº£m tuyáº¿n tÃ­nh Î» Ä‘áº¿n {0.0,0.2,0.4,0.6,0.8,1.0} láº§n giÃ¡ trá»‹ ban Ä‘áº§u cá»§a
nÃ³ á»Ÿ cuá»‘i tinh chá»‰nh online. NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 11, khÃ´ng cÃ³ cÆ¡ cháº¿ suy giáº£m nÃ o vÆ°á»£t
trá»™i so vá»›i cÃ¡i khÃ¡c vá» hiá»‡u suáº¥t tá»•ng trung bÃ¬nh khi káº¿t há»£p vá»›i TD3+BC hoáº·c CQL. ChÃºng tÃ´i
phá»ng Ä‘oÃ¡n ráº±ng Ä‘iá»u nÃ y lÃ  do 100K bÆ°á»›c mÃ´i trÆ°á»ng khÃ´ng Ä‘á»§ cho cÃ¡c agent Ä‘á»ƒ hoÃ n toÃ n vÆ°á»£t
qua váº¥n Ä‘á» dá»‹ch chuyá»ƒn phÃ¢n phá»‘i trong háº§u háº¿t cÃ¡c cÃ i Ä‘áº·t. ChÃºng tÃ´i cÅ©ng lÆ°u Ã½ ráº±ng khÃ´ng cÃ³
cÆ¡ cháº¿ suy giáº£m khÃ´ng nháº¥t quÃ¡n vÆ°á»£t trá»™i so vá»›i táº¥t cáº£ cÃ¡c cÃ i Ä‘áº·t khÃ¡c, Ä‘iá»u nÃ y phá»¥ thuá»™c vÃ o
cháº¥t lÆ°á»£ng cá»§a táº­p dá»¯ liá»‡u vÃ  Ä‘á»™ khÃ³ cá»§a nhiá»‡m vá»¥. Do Ä‘Ã³,
21

--- TRANG 21 ---
0.0 0.1 0.2 0.4 0.6 0.8 1.0
pOORBhc-r
hop-r
w-r
hc-m
hop-m
w-m
hc-mr
hop-mr
w-mr
totalÄiá»ƒm Sá»‘ D4RL Chuáº©n HÃ³a0.93 1.00 0.99 0.98 0.92 0.83 0.58
0.72 1.00 0.71 0.96 0.38 0.38 0.33
0.59 0.90 1.00 0.75 0.57 0.76 0.39
0.98 1.00 1.00 0.95 0.95 0.88 0.80
0.90 0.97 0.97 0.97 0.97 1.00 0.92
0.72 1.00 0.99 0.94 0.90 0.90 0.79
0.98 1.00 0.98 0.98 0.93 0.93 0.86
0.73 0.98 0.98 1.00 0.97 0.96 0.92
0.89 1.00 1.00 0.96 0.94 0.92 0.85
0.86 1.00 0.98 0.97 0.91 0.90 0.80SUNG(TD3+BC)
0.0 0.1 0.2 0.4 0.6 0.8 1.0
pOORBhc-r
hop-r
w-r
hc-m
hop-m
w-m
hc-mr
hop-mr
w-mr
totalÄiá»ƒm Sá»‘ D4RL Chuáº©n HÃ³a0.89 0.93 1.00 0.88 0.77 0.75 0.55
0.42 1.00 0.79 0.62 0.70 0.72 0.57
0.35 0.90 0.83 1.00 0.85 0.72 0.54
0.98 0.99 1.00 1.00 0.91 0.90 0.77
0.92 1.00 1.00 0.96 0.95 0.96 0.93
1.00 0.82 0.90 0.90 0.87 0.84 0.78
0.99 1.00 1.00 0.97 0.80 0.82 0.75
0.77 0.98 0.84 0.92 0.97 1.00 0.94
0.89 1.00 0.97 0.88 0.88 0.87 0.86
0.91 1.00 0.98 0.95 0.91 0.91 0.82SUNG(CQL)
0.40.50.60.70.80.91.0
0.40.50.60.70.80.91.0HÃ¬nh 10: Heatmap cho hiá»‡u suáº¥t cá»§a SUNG vá»›i xÃ¡c suáº¥t láº¥y máº«u OORB pOORB khÃ¡c nhau. Káº¿t
quáº£ cá»§a má»—i cÃ i Ä‘áº·t Ä‘Æ°á»£c chuáº©n hÃ³a vá»›i chuáº©n hÃ³a tá»‘i Ä‘a Ä‘á»ƒ trá»±c quan hÃ³a tá»‘t hÆ¡n. hc = HalfCheetah,
hop = Hopper, w = Walker, r = random, m = medium, mr = medium-replay.
0.0 0.2 0.4 0.6 0.8 1.0
Suy Giáº£m Cuá»‘i707580Äiá»ƒm Sá»‘ D4RL Trung BÃ¬nh
SUNG (TD3+BC)
0.0 0.2 0.4 0.6 0.8 1.0
Suy Giáº£m Cuá»‘i657075
SUNG (CQL)
best baseline
HÃ¬nh 11: So sÃ¡nh hiá»‡u suáº¥t cá»§a SUNG vá»›i cuá»‘i
suy giáº£m khÃ¡c nhau cho trá»ng sá»‘ Ä‘iá»u chá»‰nh Î»,
trong Ä‘Ã³ trá»¥c x cÃ³ nghÄ©a lÃ  suy giáº£m cho Ä‘áº¿n
khi Ä‘áº¡t xÂ·Î» á»Ÿ cuá»‘i tinh chá»‰nh online. ChÃºng tÃ´i
trÃ¬nh bÃ y Ä‘iá»ƒm sá»‘ D4RL trung bÃ¬nh trÃªn cÃ¡c miá»n
MuJoCo. x= 1.0 Ä‘áº¡i diá»‡n cho SUNG khÃ´ng cÃ³
cÆ¡ cháº¿ suy giáº£m.
viá»‡c Ä‘iá»u chá»‰nh cáº©n tháº­n cÆ¡ cháº¿ suy giáº£m cÃ³ thá»ƒ mang láº¡i cáº£i thiá»‡n offline-Ä‘áº¿n-online bá»• sung,
Ä‘áº·c biá»‡t lÃ  cho má»™t lÆ°á»£ng lá»›n bÆ°á»›c mÃ´i trÆ°á»ng online. Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i khÃ´ng sá»­
dá»¥ng cÆ¡ cháº¿ suy giáº£m Ä‘á»ƒ Ä‘Æ¡n giáº£n. HÆ¡n ná»¯a, chÃºng tÃ´i cÅ©ng nháº­n xÃ©t ráº±ng SUNG vá»›i cÆ¡ cháº¿ suy
giáº£m khÃ¡c nhau váº«n vÆ°á»£t trá»™i so vá»›i baseline hoáº¡t Ä‘á»™ng tá»‘t nháº¥t, Ä‘iá»u nÃ y tiáº¿p tá»¥c chá»©ng minh sá»±
vÆ°á»£t trá»™i cá»§a khung lÃ m viá»‡c Ä‘Æ°á»£c Ä‘á» xuáº¥t.
E Tháº£o Luáº­n
Trong khi Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t Ä‘áº§y há»©a háº¹n, khung lÃ m viá»‡c Ä‘Æ°á»£c Ä‘á» xuáº¥t cÅ©ng cÃ³ má»™t sá»‘ háº¡n cháº¿
vá»‘n cÃ³. Má»™t sá»‘ phÆ°Æ¡ng phÃ¡p RL offline Ä‘Æ°á»£c phÃ¡t triá»ƒn gáº§n Ä‘Ã¢y cÃ³ thá»ƒ Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn Ä‘á»‰nh
RL on-policy [50] vÃ  mÃ´ hÃ¬nh há»c cÃ³ giÃ¡m sÃ¡t [6,9,41] thay vÃ¬ RL off-policy thuáº§n tÃºy. Do Ä‘Ã³,
má»™t háº¡n cháº¿ lÃ  SUNG khÃ´ng tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c agent Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c bá»Ÿi nhá»¯ng mÃ´ hÃ¬nh
má»›i nÃ y cho RL offline. Tuy nhiÃªn, chÃºng tÃ´i láº­p luáº­n ráº±ng nhá»¯ng hiá»ƒu biáº¿t cá»§a SUNG cÃ³ thá»ƒ
Ä‘Æ°á»£c Ã¡p dá»¥ng cho chÃºng vá» nguyÃªn táº¯c. ChÃºng tÃ´i Ä‘á»ƒ láº¡i viá»‡c khÃ¡m phÃ¡ triá»ƒn khai cá»§a nÃ³ Ä‘á»ƒ káº¿t
há»£p vá»›i RL on-policy vÃ  há»c cÃ³ giÃ¡m sÃ¡t nhÆ° má»™t cÃ´ng viá»‡c tÆ°Æ¡ng lai thÃº vá»‹. Trong phiÃªn báº£n
hiá»‡n táº¡i, SUNG Ä‘iá»u tra cÃ i Ä‘áº·t RL offline-Ä‘áº¿n-online Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c nhiá»‡m vá»¥ cÃ³ Ä‘áº§u vÃ o lÃ 
cÃ¡c tráº¡ng thÃ¡i cá»§a mÃ´i trÆ°á»ng mÃ´ phá»ng. Sáº½ thÃº vá»‹ khi tháº¥y liá»‡u SUNG cÅ©ng vÆ°á»£t trá»™i vá»›i cÃ i
Ä‘áº·t RL trá»±c quan [29]. HÆ¡n ná»¯a, Ä‘iá»u tra thÃªm vá» Æ°á»›c tÃ­nh Ä‘á»™ báº¥t Ä‘á»‹nh, bá»™ Ä‘á»‡m phÃ¡t láº¡i, vÃ  nhiá»u
phÆ°Æ¡ng phÃ¡p RL offline xÆ°Æ¡ng sá»‘ng cáº§n Ä‘Æ°á»£c khÃ¡m phÃ¡. Cuá»‘i cÃ¹ng, chÃºng tÃ´i nháº­n xÃ©t ráº±ng viá»‡c
khÃ¡m phÃ¡ á»©ng dá»¥ng cá»§a nÃ³ trÃªn cÃ¡c nhiá»‡m vá»¥ tháº¿ giá»›i thá»±c cÅ©ng lÃ  má»™t cÃ´ng viá»‡c tÆ°Æ¡ng lai thÃº vá»‹.
ChÃºng tÃ´i hy vá»ng cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i thá»ƒ hiá»‡n tiá»m nÄƒng cá»§a mÃ´ hÃ¬nh pretraining offline
vÃ  tinh chá»‰nh online trong viá»‡c triá»ƒn khai hiá»‡u quáº£ vÃ  hiá»‡u suáº¥t cÃ¡c thuáº­t toÃ¡n RL trong cÃ¡c á»©ng
dá»¥ng tháº¿ giá»›i thá»±c. BÃªn cáº¡nh Ä‘Ã³, chÃºng tÃ´i hy vá»ng ráº±ng cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i truyá»n cáº£m há»©ng
cho nghiÃªn cá»©u tÆ°Æ¡ng lai Ä‘á»ƒ phÃ¡t triá»ƒn cÃ¡c phÆ°Æ¡ng phÃ¡p RL offline-Ä‘áº¿n-online hiá»‡u quáº£ máº«u hÆ¡n.
ChÃºng tÃ´i khÃ´ng tháº¥y tÃ¡c Ä‘á»™ng xÃ£ há»™i tiÃªu cá»±c cá»§a cÃ´ng trÃ¬nh chÃºng tÃ´i trong thá»±c táº¿.
22
