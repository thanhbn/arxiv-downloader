# 2312.04410.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/diffusion/2312.04410.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 9073704 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
Smooth Diffusion: Táº¡o Ra KhÃ´ng Gian Latent MÆ°á»£t MÃ  Trong MÃ´ HÃ¬nh Khuáº¿ch TÃ¡n
Jiayi Guo1,2*, Xingqian Xu1,3*, Yifan Pu2, Zanlin Ni2, Chaofei Wang2, Manushree Vasu1,
Shiji Song2, Gao Huang2â€ , Humphrey Shi1,3â€ 
1SHI Labs @ Georgia Tech & UIUC2Äáº¡i há»c Tsinghua3Picsart AI Research (PAIR)
https://github.com/SHI-Labs/Smooth-Diffusion
"Má»™t con chÃ³ thá»±c táº¿"
HÃ¬nh AHÃ¬nh BNá»™i suySmoothDiffusion(Cá»§a chÃºng tÃ´i)StableDiffusionThay tháº¿ váº­t pháº©m: "thá»"â†’"mÃ¨o""Má»™t chuyáº¿n tÃ u Ä‘ang quay vá» Ä‘Æ°á»ng ray chá»©a Ä‘áº§y ngÆ°á»i""Má»™t con chuá»™t á»Ÿ cáº¡nh bÃ n phÃ­m trÃªn bÃ n"
ThÃªm váº­t pháº©m: +"thá»‹t xÃ´ng khÃ³i"Chuyá»ƒn Ä‘á»•i phong cÃ¡ch: "phong cÃ¡ch mÃ u nÆ°á»›c"KÃ©o Ä‘iá»ƒmNhiá»‡m vá»¥ 1: Ná»™i suy HÃ¬nh áº£nh
Nhiá»‡m vá»¥ 2: Äáº£o ngÆ°á»£c vÃ  TÃ¡i táº¡o HÃ¬nh áº£nhNhiá»‡m vá»¥ 3: Chá»‰nh sá»­a HÃ¬nh áº£nh
Smooth Diff.Stable Diff.Nguá»“n
Smooth Diff.Stable Diff.Nguá»“nSmooth Diff.Stable Diff.Nguá»“n
HÃ¬nh 1. Smooth Diffusion cho cÃ¡c nhiá»‡m vá»¥ tá»•ng há»£p hÃ¬nh áº£nh downstream. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i chÃ­nh thá»©c giá»›i thiá»‡u tÃ­nh mÆ°á»£t mÃ  cá»§a khÃ´ng gian latent vÃ o cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n nhÆ° Stable Diffusion [59]. TÃ­nh mÆ°á»£t mÃ  nÃ y há»— trá»£ Ä‘Ã¡ng ká»ƒ nhiá»u nhiá»‡m vá»¥ trong: 1) cáº£i thiá»‡n tÃ­nh liÃªn tá»¥c cá»§a chuyá»ƒn tiáº¿p trong ná»™i suy hÃ¬nh áº£nh, 2) giáº£m lá»—i xáº¥p xá»‰ trong Ä‘áº£o ngÆ°á»£c hÃ¬nh áº£nh, & 3) báº£o toÃ n tá»‘t hÆ¡n ná»™i dung chÆ°a Ä‘Æ°á»£c chá»‰nh sá»­a trong chá»‰nh sá»­a hÃ¬nh áº£nh.

TÃ³m táº¯t
Gáº§n Ä‘Ã¢y, cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n Ä‘Ã£ Ä‘áº¡t Ä‘Æ°á»£c tiáº¿n bá»™ Ä‘Ã¡ng ká»ƒ trong viá»‡c táº¡o ra hÃ¬nh áº£nh tá»« vÄƒn báº£n (T2I), tá»•ng há»£p cÃ¡c hÃ¬nh áº£nh vá»›i Ä‘á»™ trung thá»±c cao vÃ  ná»™i dung Ä‘a dáº¡ng. Máº·c dÃ¹ cÃ³ sá»± tiáº¿n bá»™ nÃ y, tÃ­nh mÆ°á»£t mÃ  cá»§a khÃ´ng gian latent trong cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n váº«n chÆ°a Ä‘Æ°á»£c khÃ¡m phÃ¡ nhiá»u. KhÃ´ng gian latent mÆ°á»£t mÃ  Ä‘áº£m báº£o ráº±ng má»™t nhiá»…u loáº¡n trÃªn latent Ä‘áº§u vÃ o tÆ°Æ¡ng á»©ng vá»›i má»™t thay Ä‘á»•i á»•n Ä‘á»‹nh trong hÃ¬nh áº£nh Ä‘áº§u ra. Äáº·c tÃ­nh nÃ y tá» ra cÃ³ lá»£i trong cÃ¡c nhiá»‡m vá»¥ downstream, bao gá»“m ná»™i suy hÃ¬nh áº£nh, Ä‘áº£o ngÆ°á»£c vÃ  chá»‰nh sá»­a. Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i phÆ¡i bÃ y tÃ­nh khÃ´ng mÆ°á»£t mÃ  cá»§a khÃ´ng gian latent khuáº¿ch tÃ¡n báº±ng cÃ¡ch quan sÃ¡t cÃ¡c biáº¿n Ä‘á»™ng thá»‹ giÃ¡c Ä‘Ã¡ng chÃº Ã½ phÃ¡t sinh tá»« cÃ¡c biáº¿n thiÃªn latent nhá». Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t Smooth Diffusion, má»™t loáº¡i mÃ´ hÃ¬nh khuáº¿ch tÃ¡n má»›i cÃ³ thá»ƒ Ä‘á»“ng thá»i hiá»‡u suáº¥t cao vÃ  mÆ°á»£t mÃ . Cá»¥ thá»ƒ, chÃºng tÃ´i giá»›i thiá»‡u Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c Ä‘á»ƒ Ã©p buá»™c tá»· lá»‡ giá»¯a cÃ¡c biáº¿n thiÃªn cá»§a má»™t latent Ä‘áº§u vÃ o tÃ¹y Ã½ vÃ  hÃ¬nh áº£nh Ä‘áº§u ra lÃ  má»™t háº±ng sá»‘ táº¡i báº¥t ká»³ bÆ°á»›c huáº¥n luyá»‡n khuáº¿ch tÃ¡n nÃ o. NgoÃ i ra, chÃºng tÃ´i thiáº¿t káº¿ má»™t chá»‰ sá»‘ Ä‘á»™ lá»‡ch chuáº©n ná»™i suy (ISTD) Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent cá»§a má»™t mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. CÃ¡c thÃ­ nghiá»‡m Ä‘á»‹nh lÆ°á»£ng vÃ  Ä‘á»‹nh tÃ­nh má»Ÿ rá»™ng chá»©ng minh ráº±ng Smooth Diffusion ná»•i báº­t nhÆ° má»™t giáº£i phÃ¡p mong muá»‘n hÆ¡n khÃ´ng chá»‰ trong viá»‡c táº¡o ra T2I mÃ  cÃ²n trong nhiá»u nhiá»‡m vá»¥ downstream khÃ¡c nhau. Smooth Diffusion Ä‘Æ°á»£c triá»ƒn khai nhÆ° má»™t Smooth-LoRA cáº¯m vÃ  cháº¡y Ä‘á»ƒ hoáº¡t Ä‘á»™ng vá»›i nhiá»u mÃ´ hÃ¬nh cá»™ng Ä‘á»“ng khÃ¡c nhau. MÃ£ nguá»“n cÃ³ táº¡i https://github.com/SHI-Labs/Smooth-Diffusion.
1arXiv:2312.04410v1  [cs.CV]  7 Dec 2023

--- TRANG 2 ---
1. Giá»›i thiá»‡u
Trong nhá»¯ng nÄƒm gáº§n Ä‘Ã¢y, cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n [13, 23, 59] Ä‘Ã£ nhanh chÃ³ng phÃ¡t triá»ƒn thÃ nh nhá»¯ng cÃ´ng cá»¥ ráº¥t máº¡nh máº½ cho AI táº¡o sinh, Ä‘áº·c biá»‡t lÃ  cho viá»‡c táº¡o ra hÃ¬nh áº£nh tá»« vÄƒn báº£n. Kháº£ nÄƒng Ä‘Ã¡ng chÃº Ã½ cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n, táº¡o ra nhá»¯ng hÃ¬nh áº£nh chÃ¢n thá»±c cháº¥t lÆ°á»£ng cao tá»« ngá»¯ cáº£nh má»Ÿ, Ä‘Ã£ Ä‘Æ°á»£c lÃ m ná»•i báº­t trong nhiá»u sáº£n pháº©m nghiÃªn cá»©u vÃ  thÆ°Æ¡ng máº¡i. ThÃ nh cÃ´ng nhÆ° váº­y cÅ©ng Ä‘Ã£ truyá»n cáº£m há»©ng cho nhiá»u nhiá»‡m vá»¥ downstream dá»±a trÃªn khuáº¿ch tÃ¡n, bao gá»“m ná»™i suy hÃ¬nh áº£nh [27, 75], Ä‘áº£o ngÆ°á»£c [14, 42, 51, 68, 74], chá»‰nh sá»­a [20, 40, 43, 52, 66, 72, 78, 79], v.v.

Máº·c dÃ¹ thÃ nh cÃ´ng lá»›n trong lÄ©nh vá»±c táº¡o sinh, cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n thá»‰nh thoáº£ng táº¡o ra káº¿t quáº£ cháº¥t lÆ°á»£ng tháº¥p vá»›i cÃ¡c hÃ nh vi khÃ´ng mong muá»‘n vÃ  khÃ´ng thá»ƒ dá»± Ä‘oÃ¡n. Cá»¥ thá»ƒ, Ä‘á»‘i vá»›i ná»™i suy hÃ¬nh áº£nh, thá»­ nghiá»‡m Stable Diffusion Walk (SDW) [27] kiá»ƒm tra khÃ´ng gian latent vá»›i cÃ¡c ná»™i suy tuyáº¿n tÃ­nh cáº§u, thÆ°á»ng dáº«n Ä‘áº¿n Ä‘áº§u ra biáº¿n Ä‘á»™ng cao vá»›i diá»‡n máº¡o thá»‹ giÃ¡c khÃ´ng thá»ƒ dá»± Ä‘oÃ¡n. CÃ¡c vÃ­ dá»¥ cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong HÃ¬nh 1 Nhiá»‡m vá»¥ 1, trong Ä‘Ã³ ná»™i suy nhÆ° váº­y thá»ƒ hiá»‡n nhá»¯ng thay Ä‘á»•i sáº¯c nÃ©t khÃ´ng mong muá»‘n cÅ©ng nhÆ° "hoáº¡t hÃ¬nh hÃ³a" trÃªn hÃ¬nh áº£nh chÃ³ chÃ¢n thá»±c, Ä‘Æ°á»£c lÃ m ná»•i báº­t trong há»™p Ä‘á». Äá»‘i vá»›i nhiá»‡m vá»¥ Ä‘áº£o ngÆ°á»£c hÃ¬nh áº£nh Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 1 Nhiá»‡m vá»¥ 2, viá»‡c Ã¡p dá»¥ng Ä‘Æ¡n giáº£n DDIM inversion [68] khÃ´ng thá»ƒ tÃ¡i táº¡o hÃ¬nh áº£nh má»™t cÃ¡ch trung thá»±c tá»« cÃ¡c nguá»“n. Thay vÃ o Ä‘Ã³, nÃ³ táº¡o ra mÃ u sáº¯c vÃ  hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng khÃ´ng chÃ­nh xÃ¡c, vÃ  hiá»ƒu nháº§m con chuá»™t mÃ¡y tÃ­nh nhÆ° má»™t con chuá»™t Ä‘á»™ng váº­t. Äá»‘i vá»›i nhiá»‡m vá»¥ chá»‰nh sá»­a hÃ¬nh áº£nh Ä‘Æ°á»£c hiá»ƒn thá»‹ trong HÃ¬nh 1 Nhiá»‡m vá»¥ 3, ngÆ°á»i ta cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng chá»‰ viá»‡c chá»‰nh sá»­a nhá» lá»i nháº¯c vÄƒn báº£n cÃ³ thá»ƒ dáº«n Ä‘áº¿n cÃ¡c cáº­p nháº­t lá»›n vá» ná»™i dung vÃ  bá»‘ cá»¥c hÃ¬nh áº£nh, trong Ä‘Ã³ Ä‘á»‘i tÆ°á»£ng (tá»©c lÃ  tÆ° tháº¿ cá»§a con mÃ¨o, vá»‹ trÃ­ cá»§a con ngá»±a, hÃ¬nh dáº¡ng cá»§a pizza) cÃ³ thá»ƒ bá»‹ thay Ä‘á»•i má»™t cÃ¡ch sai láº§m vÃ  nghiÃªm trá»ng. HÆ¡n ná»¯a, cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n hiá»‡n táº¡i khÃ´ng phÃ¹ há»£p vá»›i viá»‡c chá»‰nh sá»­a dá»±a trÃªn kÃ©o [66] vÃ¬ má»™t phÆ°Æ¡ng phÃ¡p kÃ©o Ä‘Æ°á»£c thiáº¿t káº¿ tinh vi váº«n cÃ³ kháº£ nÄƒng Ä‘Ã¡ng ká»ƒ phÃ¡ vá»¡ hÃ¬nh dáº¡ng vÃ  ngá»¯ nghÄ©a cá»§a Ä‘á»‘i tÆ°á»£ng.

Trong cÃ´ng trÃ¬nh nÃ y, chÃºng tÃ´i bÆ°á»›c vÃ o má»™t lÄ©nh vá»±c quan trá»ng nhÆ°ng chÆ°a Ä‘Æ°á»£c khÃ¡m phÃ¡ Ä‘áº§y Ä‘á»§: cáº£i thiá»‡n tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. Äá»™ng cÆ¡ cá»§a chÃºng tÃ´i Ä‘á»ƒ tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  latent Ä‘áº¿n tá»« nhu cáº§u thá»±c táº¿ Ä‘á»ƒ cáº£i thiá»‡n cháº¥t lÆ°á»£ng Ä‘áº§u ra cá»§a cÃ¡c nhiá»‡m vá»¥ downstream Ä‘Ã£ nÃªu trÃªn. Má»™t khÃ´ng gian latent mÆ°á»£t mÃ  ngá»¥ Ã½ má»™t biáº¿n Ä‘á»•i thá»‹ giÃ¡c máº¡nh máº½ dÆ°á»›i má»™t thay Ä‘á»•i latent nhá». Do Ä‘Ã³, viá»‡c tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  nhÆ° váº­y cÃ³ thá»ƒ giÃºp cáº£i thiá»‡n tÃ­nh liÃªn tá»¥c cá»§a ná»™i suy hÃ¬nh áº£nh, má»Ÿ rá»™ng kháº£ nÄƒng cá»§a Ä‘áº£o ngÆ°á»£c hÃ¬nh áº£nh, vÃ  duy trÃ¬ ngá»¯ nghÄ©a chÃ­nh xÃ¡c trong chá»‰nh sá»­a hÃ¬nh áº£nh. ÄÃ¡ng chÃº Ã½, cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y trong GANs [30, 31, 65] Ä‘Ã£ chá»©ng minh ráº±ng khÃ´ng gian latent mÆ°á»£t mÃ  cá»§a bá»™ táº¡o cÃ³ thá»ƒ cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ cháº¥t lÆ°á»£ng cá»§a cÃ¡c nhiá»‡m vá»¥ downstream, cung cáº¥p báº±ng chá»©ng bá»• sung vá» táº§m quan trá»ng cá»§a lÄ©nh vá»±c nÃ y.

Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»¥c tiÃªu cá»§a chÃºng tÃ´i, chÃºng tÃ´i Ä‘á» xuáº¥t Smooth Diffusion, má»™t loáº¡i mÃ´ hÃ¬nh khuáº¿ch tÃ¡n má»›i cÃ³ thá»ƒ Ä‘á»“ng thá»i hiá»‡u suáº¥t cao vÃ  mÆ°á»£t mÃ . ChÃºng tÃ´i báº¯t Ä‘áº§u khÃ¡m phÃ¡ báº±ng cÃ¡ch Ä‘áº§u tiÃªn chÃ­nh thá»©c hÃ³a má»¥c tiÃªu cho Smooth Diffusion, trong Ä‘Ã³ cÃ¡c nhiá»…u loáº¡n kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh âˆ†Ïµ trÃªn má»™t nhiá»…u latent Ïµ sáº½ táº¡o ra nhá»¯ng thay Ä‘á»•i thá»‹ giÃ¡c mÆ°á»£t mÃ  âˆ†cx0 trÃªn hÃ¬nh áº£nh tá»•ng há»£p cx0, Ä‘Æ°á»£c lÃ m trÃ²n Ä‘áº¿n má»™t tá»· lá»‡ háº±ng sá»‘ C. Máº·c dÃ¹ ngÆ°á»i ta cÃ³ thá»ƒ nghÄ© ráº±ng theo cÃ´ng thá»©c, rÃ ng buá»™c tÃ­nh mÆ°á»£t mÃ  cÃ³ thá»ƒ lÃ  má»™t hÃ m máº¥t mÃ¡t thá»i gian huáº¥n luyá»‡n cÃ³ thá»ƒ tiáº¿p cáº­n. Thá»±c táº¿, khÃ´ng cÃ³ á»©ng dá»¥ng trá»±c tiáº¿p cá»§a Ä‘iá»u chá»‰nh nhÆ° váº­y tá»« suy luáº­n Ä‘áº¿n huáº¥n luyá»‡n, vÃ  thÃ¡ch thá»©c náº±m á»Ÿ thá»±c táº¿ ráº±ng trong má»—i láº§n láº·p huáº¥n luyá»‡n (tá»©c lÃ , lan truyá»n ngÆ°á»£c), cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n chá»‰ tá»‘i Æ°u hÃ³a má»™t "áº£nh chá»¥p nhanh t-bÆ°á»›c" thay vÃ¬ toÃ n bá»™ quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n T-bÆ°á»›c.

Do Ä‘Ã³, chÃºng tÃ´i giá»›i thiá»‡u Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c, má»™t Ä‘iá»u chá»‰nh má»›i káº¿t há»£p liá»n máº¡ch má»¥c tiÃªu thá»i gian suy luáº­n cá»§a Smooth Diffusion vÃ o huáº¥n luyá»‡n. Äiá»u chá»‰nh nÃ y nháº±m giá»›i háº¡n 2-norm cá»§a biáº¿n thiÃªn Ä‘áº§u ra âˆ†cx0 cho má»™t thay Ä‘á»•i kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh âˆ†xt trong Ä‘áº§u vÃ o xt táº¡i má»™t bÆ°á»›c t tÃ¹y Ã½. LÃ½ luáº­n cá»§a viá»‡c tÃ¡i cÃ´ng thá»©c lÃ  trá»±c quan: Náº¿u xt vÃ  cx0 thá»ƒ hiá»‡n nhá»¯ng thay Ä‘á»•i mÆ°á»£t mÃ  táº¡i báº¥t ká»³ t nÃ o, thÃ¬ má»‘i quan há»‡ giá»¯a nhiá»…u latent Ïµ (tá»©c lÃ  xT) vÃ  cx0 chá»‰ lÃ  sá»± tÃ­ch lÅ©y cá»§a cÃ¡c biáº¿n thiÃªn mÆ°á»£t mÃ  vÃ  do Ä‘Ã³ cÅ©ng cÃ³ thá»ƒ mÆ°á»£t mÃ . Chi tiáº¿t hÆ¡n cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Pháº§n 3.

Trong thá»±c táº¿, Smooth Diffusion cá»§a chÃºng tÃ´i Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn má»™t mÃ´ hÃ¬nh vÄƒn báº£n-hÃ¬nh áº£nh ná»•i tiáº¿ng: Stable Diffusion [59]. ChÃºng tÃ´i kiá»ƒm tra vÃ  chá»©ng minh ráº±ng Smooth Diffusion cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent so vá»›i Ä‘Æ°á»ng cÆ¡ sá»Ÿ cá»§a nÃ³. Äá»“ng thá»i, chÃºng tÃ´i tiáº¿n hÃ nh nghiÃªn cá»©u má»Ÿ rá»™ng trÃªn nhiá»u nhiá»‡m vá»¥ downstream, bao gá»“m nhÆ°ng khÃ´ng giá»›i háº¡n á»Ÿ ná»™i suy hÃ¬nh áº£nh, Ä‘áº£o ngÆ°á»£c, chá»‰nh sá»­a, v.v. Cáº£ káº¿t quáº£ Ä‘á»‹nh tÃ­nh vÃ  Ä‘á»‹nh lÆ°á»£ng Ä‘á»u há»— trá»£ káº¿t luáº­n cá»§a chÃºng tÃ´i ráº±ng Smooth Diffusion cÃ³ thá»ƒ lÃ  mÃ´ hÃ¬nh táº¡o sinh hiá»‡u suáº¥t cao tháº¿ há»‡ tiáº¿p theo khÃ´ng chá»‰ cho nhiá»‡m vá»¥ vÄƒn báº£n-hÃ¬nh áº£nh cÆ¡ báº£n mÃ  cÃ²n cho nhiá»u nhiá»‡m vá»¥ downstream khÃ¡c nhau.

2. CÃ´ng trÃ¬nh liÃªn quan
CÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n Ä‘Æ°á»£c khá»Ÿi xÆ°á»›ng tá»« má»™t há» cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã³ bao gá»“m nhÆ°ng khÃ´ng giá»›i háº¡n á»Ÿ [10, 63, 67, 73]. Ká»ƒ tá»« Ä‘Ã³, DDPM [23] Ä‘Ã£ giá»›i thiá»‡u má»™t mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n nhiá»…u dá»±a trÃªn hÃ¬nh áº£nh, trá»Ÿ thÃ nh má»™t trong nhá»¯ng nghiÃªn cá»©u táº¡o sinh hÃ¬nh áº£nh phá»• biáº¿n nháº¥t. CÃ¡c cÃ´ng trÃ¬nh sau nÃ y [13, 45, 68] Ä‘Ã£ má»Ÿ rá»™ng DDPM, chá»©ng minh ráº±ng cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n thá»±c hiá»‡n ngang báº±ng vÃ  tháº­m chÃ­ vÆ°á»£t qua cÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn GAN [16, 28â€“31]. Gáº§n Ä‘Ã¢y, viá»‡c táº¡o ra hÃ¬nh áº£nh tá»« lá»i nháº¯c vÄƒn báº£n (T2I) trá»Ÿ thÃ nh má»™t lÄ©nh vá»±c má»›i ná»•i, trong Ä‘Ã³ cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n [17, 46, 56, 59, 61] Ä‘Ã£ trá»Ÿ nÃªn khÃ¡ ná»•i báº­t vá»›i cÃ´ng chÃºng. VÃ­ dá»¥, Stable Diffusion (SD) [59] bao gá»“m VAE [34] vÃ  CLIP [55], khuáº¿ch tÃ¡n khÃ´ng gian latent, vÃ  mang láº¡i sá»± cÃ¢n báº±ng xuáº¥t sáº¯c giá»¯a cháº¥t lÆ°á»£ng vÃ  tá»‘c Ä‘á»™. Theo sau SD [59], cÃ¡c nhÃ  nghiÃªn cá»©u cÅ©ng khÃ¡m phÃ¡ cÃ¡c phÆ°Æ¡ng phÃ¡p khuáº¿ch tÃ¡n cho Ä‘iá»u khiá»ƒn nhÆ° ControlNet [15, 25, 44, 54, 77, 82, 83, 86â€“88, 92] vÃ  Ä‘a phÆ°Æ¡ng thá»©c nhÆ° Versatile Diffusion [8, 39, 70, 85]. CÃ¡c cÃ´ng trÃ¬nh tá»« má»™t hÆ°á»›ng khÃ¡c giáº£m cÃ¡c bÆ°á»›c khuáº¿ch tÃ¡n Ä‘á»ƒ cáº£i thiá»‡n tá»‘c Ä‘á»™ [7, 32, 37, 41, 62, 69, 89, 93], hoáº·c háº¡n cháº¿ dá»¯ liá»‡u vÃ  miá»n cho há»c Ã­t vÃ­ dá»¥ [19, 24, 38, 60], táº¥t cáº£ Ä‘á»u Ä‘Ã£ thÃ nh cÃ´ng duy trÃ¬ cháº¥t lÆ°á»£ng Ä‘áº§u ra cao.

KhÃ´ng gian latent mÆ°á»£t mÃ  lÃ  má»™t trong nhá»¯ng Ä‘áº·c tÃ­nh ná»•i báº­t cá»§a cÃ¡c cÃ´ng trÃ¬nh GAN SOTA [11, 29â€“31], trong khi viá»‡c khÃ¡m phÃ¡ Ä‘áº·c tÃ­nh nhÆ° váº­y Ä‘Ã£ tráº£i qua nghiÃªn cá»©u GAN kÃ©o dÃ i má»™t tháº­p ká»· [5, 16], cÃ³ má»¥c tiÃªu chá»§ yáº¿u lÃ  huáº¥n luyá»‡n máº¡nh máº½. CÃ¡c Ã½ tÆ°á»Ÿng nhÆ° Wasserstein GAN [6, 18] Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh lÃ  hiá»‡u quáº£, Ã©p buá»™c tÃ­nh liÃªn tá»¥c Lipschitz trÃªn bá»™ phÃ¢n biá»‡t thÃ´ng qua cÃ¡c hÃ¬nh pháº¡t gradient. Má»™t ká»¹ thuáº­t khÃ¡c, Ä‘Æ°á»£c gá»i lÃ  Ä‘iá»u chá»‰nh Ä‘á»™ dÃ i Ä‘Æ°á»ng dáº«n, liÃªn quan Ä‘áº¿n viá»‡c káº¹p Jacobian trong [48], Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng trong StyleGAN2 [30] vÃ  sau Ä‘Ã³ trá»Ÿ thÃ nh má»™t thiáº¿t láº­p tiÃªu chuáº©n cho cÃ¡c bá»™ táº¡o dá»±a trÃªn GAN [12, 35, 84, 91]. HÆ°á»Ÿng lá»£i tá»« Ä‘áº·c tÃ­nh mÆ°á»£t mÃ , cÃ¡c nhÃ  nghiÃªn cá»©u Ä‘Ã£ quáº£n lÃ½ Ä‘á»ƒ thao tÃ¡c khÃ´ng gian latent trong nhiá»u dá»± Ã¡n nghiÃªn cá»©u downstream. CÃ¡c cÃ´ng trÃ¬nh nhÆ° [9, 47, 65, 80] Ä‘Ã£ khÃ¡m phÃ¡ viá»‡c tÃ¡ch rá»i khÃ´ng gian latent. GAN-inverse [3, 4, 49, 81] cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh lÃ  kháº£ thi, cÃ¹ng vá»›i má»™t há» cÃ¡c phÆ°Æ¡ng phÃ¡p chá»‰nh sá»­a hÃ¬nh áº£nh [50, 53, 57, 58, 71, 94]. NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, cÃ´ng trÃ¬nh cá»§a chÃºng tÃ´i nháº±m Ä‘iá»u tra tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent cho cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n, Ä‘iá»u mÃ  cho Ä‘áº¿n nay váº«n chÆ°a Ä‘Æ°á»£c khÃ¡m phÃ¡.

3. PhÆ°Æ¡ng phÃ¡p luáº­n
Trong pháº§n nÃ y, chÃºng tÃ´i Ä‘áº§u tiÃªn giá»›i thiá»‡u cÃ¡c kiáº¿n thá»©c chuáº©n bá»‹ cá»§a phÆ°Æ¡ng phÃ¡p chÃºng tÃ´i, bao gá»“m quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n [23], Ä‘áº£o ngÆ°á»£c khuáº¿ch tÃ¡n [13, 42, 68] vÃ  thÃ­ch á»©ng háº¡ng tháº¥p [24] (Pháº§n 3.1). Sau Ä‘Ã³ Smooth Diffusion Ä‘Æ°á»£c Ä‘á» xuáº¥t vá»›i Ä‘á»‹nh nghÄ©a, má»¥c tiÃªu (Pháº§n 3.2) vÃ  hÃ m Ä‘iá»u chá»‰nh (Pháº§n 3.3) cá»§a nÃ³.

3.1. Kiáº¿n thá»©c chuáº©n bá»‹
QuÃ¡ trÃ¬nh khuáº¿ch tÃ¡n [23] lÃ  má»™t loáº¡i chuá»—i Markov dáº§n dáº§n thÃªm nhiá»…u ngáº«u nhiÃªn Ïµtâˆ¼N(0,I) vÃ o tÃ­n hiá»‡u sá»± tháº­t cÆ¡ báº£n x0âˆ¼p(x0), táº¡o ra xT trong tá»•ng sá»‘ T bÆ°á»›c. Táº¡i má»—i bÆ°á»›c, dá»¯ liá»‡u nhiá»…u xt Ä‘Æ°á»£c tÃ­nh nhÆ° sau:
xt=âˆš(1âˆ’Î²t)xtâˆ’1+âˆšÎ²tÏµt, t= 1,2,Â·Â·Â·, T, (1)
trong Ä‘Ã³ Î²t lÃ  tá»‘c Ä‘á»™ khuáº¿ch tÃ¡n Ä‘áº·t trÆ°á»›c táº¡i bÆ°á»›c t. Báº±ng cÃ¡ch táº¡o Î±t= 1âˆ’Î²t, Î±t=âˆ(t=1 Ä‘áº¿n T)Î±t vÃ  Ïµâˆ¼N(0,I), chÃºng ta cÃ³ cÃ¡c tÆ°Æ¡ng Ä‘Æ°Æ¡ng sau:
xt=âˆšÎ±txtâˆ’1+âˆš(1âˆ’Î±t)Ïµt
=âˆšÎ±tx0+âˆš(1âˆ’Î±t)Ïµ, t= 1,2,Â·Â·Â·, T.(2)

Má»™t mÃ´ hÃ¬nh khuáº¿ch tÃ¡n ÏµÎ¸(xt, t) sau Ä‘Ã³ Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ Æ°á»›c tÃ­nh Ïµt tá»« xt, qua Ä‘Ã³ ngÆ°á»i ta cÃ³ thá»ƒ dá»± Ä‘oÃ¡n tÃ­n hiá»‡u gá»‘c x0 báº±ng cÃ¡ch dáº§n dáº§n loáº¡i bá» nhiá»…u tá»« xT xuá»‘ng cáº¥p [68]. Äiá»u nÃ y thÆ°á»ng Ä‘Æ°á»£c biáº¿t Ä‘áº¿n nhÆ° quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n ngÆ°á»£c:
xtâˆ’1=âˆš(Î±tâˆ’1/Î±t)xÌ‚t+ âˆš(1/Î±tâˆ’1âˆ’1âˆ’âˆš(1/Î±tâˆ’1))Â·ÏµÎ¸(xÌ‚t, t). (3)

Äáº£o ngÆ°á»£c khuáº¿ch tÃ¡n [13, 42, 68] nháº¯m má»¥c tiÃªu khÃ´i phá»¥c chÃ­nh xÃ¡c quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n ngÆ°á»£c (tá»©c lÃ  xÌ‚t, ÏµÎ¸(xÌ‚t, t), t= 1, ..., T) tá»« má»™t dá»± Ä‘oÃ¡n cuá»‘i cÃ¹ng Ä‘Ã£ biáº¿t xÌ‚0. Má»™t trong nhá»¯ng ká»¹ thuáº­t phá»• biáº¿n cho viá»‡c Ä‘áº£o ngÆ°á»£c nhÆ° váº­y lÃ  DDIM inversion [13, 68], Ä‘áº£o ngÆ°á»£c PhÆ°Æ¡ng trÃ¬nh (3) dÆ°á»›i má»™t xáº¥p xá»‰ tuyáº¿n tÃ­nh cá»¥c bá»™:
xÌ‚t+1=âˆš(Î±t+1/Î±t)xÌ‚t+ âˆš(1/Î±t+1âˆ’1âˆ’âˆš(1/Î±tâˆ’1))Â·ÏµÎ¸(xÌ‚t, t), (4)
trong Ä‘Ã³ xÌ‚t Ä‘áº¡i diá»‡n cho xÌ‚t Æ°á»›c tÃ­nh táº¡i thá»i gian t. Tuy nhiÃªn, DDIM inversion chá»‰ lÃ  má»™t Æ°á»›c tÃ­nh thÃ´. Äá»‘i vá»›i khuáº¿ch tÃ¡n vÄƒn báº£n-hÃ¬nh áº£nh, má»™t ká»¹ thuáº­t tiÃªn tiáº¿n hÆ¡n, Null-Text Inversion [42], tá»‘i Æ°u hÃ³a cÃ¡c embedding vÄƒn báº£n rá»—ng bá»• sung {âˆ…t}(T, t=1) cho má»—i bÆ°á»›c t, mÃ´ phá»ng quÃ¡ trÃ¬nh ngÆ°á»£c vá»›i ÏµÎ¸(xt, t, Î¾,âˆ…t), trong Ä‘Ã³ Î¾ lÃ  embedding vÄƒn báº£n Ä‘áº§u vÃ o. VÄƒn báº£n rá»—ng dá»± Ä‘oÃ¡n âˆ…t lÃ  Ä‘áº§u vÃ o rá»—ng cá»§a hÆ°á»›ng dáº«n khÃ´ng phÃ¢n loáº¡i [22] vá»›i tá»· lá»‡ hÆ°á»›ng dáº«n w:
ÏµÎ¸(xt, t, Î¾,âˆ…t) =wÂ·ÏµÎ¸(xt, t, Î¾) + (1 âˆ’w)Â·ÏµÎ¸(xt, t,âˆ…t). (5)

ThÃ­ch á»©ng háº¡ng tháº¥p (LoRA) [24] ban Ä‘áº§u Ä‘Æ°á»£c Ä‘á» xuáº¥t Ä‘á»ƒ thÃ­ch á»©ng hiá»‡u quáº£ cÃ¡c mÃ´ hÃ¬nh lá»›n Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá»›i cÃ¡c nhiá»‡m vá»¥ downstream. Giáº£ Ä‘á»‹nh chÃ­nh cá»§a LoRA lÃ  cÃ¡c thay Ä‘á»•i trá»ng sá»‘ cáº§n thiáº¿t trong quÃ¡ trÃ¬nh thÃ­ch á»©ng duy trÃ¬ má»™t háº¡ng tháº¥p. Cho má»™t trá»ng sá»‘ mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c W0âˆˆRdÃ—k, trá»ng sá»‘ cáº­p nháº­t âˆ†W cá»§a nÃ³ Ä‘Æ°á»£c biá»ƒu thá»‹ nhÆ° má»™t phÃ¢n tÃ­ch háº¡ng tháº¥p:
W0+ âˆ†W=W0+BA, (6)
trong Ä‘Ã³ BâˆˆRdÃ—r, AâˆˆRrÃ—k vÃ  râ‰ªmin(d, k). Trong quÃ¡ trÃ¬nh thÃ­ch á»©ng, W0 Ä‘Æ°á»£c Ä‘Ã³ng bÄƒng, trong khi B vÃ  A cÃ³ thá»ƒ huáº¥n luyá»‡n.

3.2. Smooth Diffusion
NhÆ° Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³, cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n hiá»‡n Ä‘áº¡i (DM) khÃ´ng Ä‘áº£m báº£o tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent, táº¡o ra khÃ´ng chá»‰ khoáº£ng cÃ¡ch nghiÃªn cá»©u giá»¯a GANs vÃ  khuáº¿ch tÃ¡n mÃ  cÃ²n nhá»¯ng thÃ¡ch thá»©c báº¥t ngá» trong cÃ¡c nhiá»‡m vá»¥ downstream. Äá»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t Smooth Diffusion, má»™t lá»›p mÃ´ hÃ¬nh khuáº¿ch tÃ¡n má»›i cÃ³ hiá»‡u suáº¥t cao vá»›i tÃ­nh mÆ°á»£t mÃ  Ä‘Æ°á»£c tÄƒng cÆ°á»ng trÃªn khÃ´ng gian latent cá»§a nÃ³. Ná»n táº£ng cá»§a Smooth Diffusion lÃ  lÆ°á»£c Ä‘á»“ huáº¥n luyá»‡n má»›i Ä‘Æ°á»£c Ä‘á» xuáº¥t trong Ä‘Ã³ chÃºng tÃ´i thá»±c hiá»‡n Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c Ä‘á»ƒ tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  cá»§a mÃ´ hÃ¬nh.

Äá»ƒ giáº£i thÃ­ch tá»‘t hÆ¡n má»¥c tiÃªu cá»§a chÃºng tÃ´i, chÃºng tÃ´i Ã¡p dá»¥ng cÃ¹ng thuáº­t ngá»¯ tá»« quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n thá»i gian suy luáº­n tiÃªu chuáº©n (HÃ¬nh 2a), liÃªn quan Ä‘áº¿n má»™t quy trÃ¬nh T bÆ°á»›c biáº¿n Ä‘á»•i nhiá»…u ngáº«u nhiÃªn Ïµ (tá»©c lÃ , xT) thÃ nh dá»± Ä‘oÃ¡n xÌ‚0. Má»¥c tiÃªu tá»•ng thá»ƒ cá»§a Smooth Diffusion sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t trong PhÆ°Æ¡ng trÃ¬nh 7: trong Ä‘Ã³ chÃºng tÃ´i mong Ä‘á»£i ráº±ng má»™t thay Ä‘á»•i kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh âˆ†Ïµ trÃªn Ïµ (tá»©c lÃ , âˆ†xT trÃªn xT) cuá»‘i cÃ¹ng sáº½ dáº«n Ä‘áº¿n má»™t thay Ä‘á»•i khÃ´ng báº±ng khÃ´ng, kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh âˆ†xÌ‚0 trÃªn xÌ‚0, Ä‘áº¿n má»™t tá»· lá»‡ háº±ng sá»‘ C:
âˆ¥âˆ†xÌ‚0âˆ¥2â‡”Câˆ¥âˆ†xTâˆ¥2=Câˆ¥âˆ†Ïµâˆ¥2,âˆ€Ïµ, (7)

LÆ°u Ã½ ráº±ng theo Ä‘á»‹nh nghÄ©a, xT lÃ  Ä‘áº§u vÃ o ban Ä‘áº§u cá»§a vÃ²ng láº·p khuáº¿ch tÃ¡n ngÆ°á»£c trong PhÆ°Æ¡ng trÃ¬nh 3. VÃ¬ xT gáº§n vá»›i Ïµâˆ¼N(0,1), Ä‘á»ƒ Ä‘Æ¡n giáº£n, chÃºng tÃ´i lÃ m cho chÃºng tÆ°Æ¡ng Ä‘Æ°Æ¡ng trong táº¥t cáº£ cÃ¡c phÆ°Æ¡ng trÃ¬nh sau.

Tuy nhiÃªn, ngÆ°á»i ta cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng má»¥c tiÃªu thá»i gian suy luáº­n cá»§a chÃºng tÃ´i trong PhÆ°Æ¡ng trÃ¬nh 7 khÃ´ng thá»ƒ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i trá»±c tiáº¿p thÃ nh má»™t hÃ m máº¥t mÃ¡t huáº¥n luyá»‡n. Äiá»u nÃ y lÃ  bá»Ÿi vÃ¬, trong má»™t láº§n láº·p huáº¥n luyá»‡n (tá»©c lÃ , lan truyá»n ngÆ°á»£c), cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n chá»‰ tá»‘i Æ°u hÃ³a má»™t "áº£nh chá»¥p nhanh t-bÆ°á»›c" cá»§a quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n (HÃ¬nh 2b), trong Ä‘Ã³ t Ä‘Æ°á»£c láº¥y máº«u Ä‘á»“ng nháº¥t tá»« 1 Ä‘áº¿n T. Do Ä‘Ã³, má»¥c tiÃªu "toÃ n cá»¥c" Ä‘Æ°á»£c Ä‘á» xuáº¥t (PhÆ°Æ¡ng trÃ¬nh 7) cho toÃ n bá»™ quÃ¡ trÃ¬nh T-bÆ°á»›c khÃ´ng thá»ƒ tiáº¿p cáº­n trong huáº¥n luyá»‡n. Do Ä‘Ã³, chÃºng tÃ´i cáº§n tÃ¡i cÃ´ng thá»©c má»¥c tiÃªu toÃ n cá»¥c cá»§a chÃºng tÃ´i thÃ nh má»™t má»¥c tiÃªu tá»«ng bÆ°á»›c Ä‘Æ°á»£c hiá»ƒn thá»‹ trong PhÆ°Æ¡ng trÃ¬nh 8, cÃ³ thá»ƒ sau Ä‘Ã³ Ä‘Æ°á»£c tÃ­ch há»£p vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n khuáº¿ch tÃ¡n nhÆ° má»™t hÃ m máº¥t mÃ¡t:
âˆ¥âˆ†xÌ‚0âˆ¥2â‡”Câˆ¥âˆ†xtâˆ¥2=Câˆš(1âˆ’Î±t)âˆ¥âˆ†Ïµâˆ¥2,âˆ€Ïµ,(8)
trong Ä‘Ã³ C lÃ  má»™t háº±ng sá»‘ khÃ´ng báº±ng khÃ´ng. Má»¥c tiÃªu tá»«ng bÆ°á»›c nÃ y chá»‰ ra ráº±ng táº¡i má»—i bÆ°á»›c huáº¥n luyá»‡n, cÃ¡c biáº¿n thiÃªn âˆ†Ïµ trÃªn Ïµ sáº½ ngá»¥ Ã½ cÃ¡c biáº¿n thiÃªn âˆ†xt trÃªn xt vá»›i má»™t tá»· lá»‡ tá»· lá»‡ thuáº­n vá»›i âˆš(1âˆ’Î±t). LÃ½ luáº­n cá»§a PhÆ°Æ¡ng trÃ¬nh 8 lÃ  trá»±c quan: Náº¿u xt vÃ  xÌ‚0 thá»ƒ hiá»‡n nhá»¯ng thay Ä‘á»•i mÆ°á»£t mÃ  táº¡i báº¥t ká»³ t nÃ o, thÃ¬ má»‘i quan há»‡ giá»¯a nhiá»…u latent Ïµ (tá»©c lÃ  xT) vÃ  xÌ‚0 chá»‰ lÃ  sá»± tÃ­ch lÅ©y cá»§a cÃ¡c biáº¿n thiÃªn mÆ°á»£t mÃ  vÃ  do Ä‘Ã³ cÅ©ng cÃ³ thá»ƒ mÆ°á»£t mÃ .

3.3. Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c
Trong khi Ä‘á»™ng cÆ¡ vÃ  cÃ´ng thá»©c cá»§a má»¥c tiÃªu Smooth Diffusion Ä‘Æ°á»£c trÃ¬nh bÃ y, cÃ¡ch thá»±c hiá»‡n má»¥c tiÃªu nhÆ° váº­y váº«n chÆ°a Ä‘Æ°á»£c giáº£i thÃ­ch. Do Ä‘Ã³, trong pháº§n nÃ y, chÃºng tÃ´i giá»›i thiá»‡u Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c Ä‘á»ƒ tÃ­ch há»£p hiá»‡u quáº£ má»¥c tiÃªu tá»«ng bÆ°á»›c vÃ o huáº¥n luyá»‡n khuáº¿ch tÃ¡n.

ChÃºng tÃ´i láº¥y cáº£m há»©ng tá»« cÃ¡c ká»¹ thuáº­t Ä‘iá»u chá»‰nh [30, 48] Ä‘Æ°á»£c Ã¡p dá»¥ng trong huáº¥n luyá»‡n GAN. Ã tÆ°á»Ÿng cá»‘t lÃµi cá»§a Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c lÃ  giá»›i háº¡n ma tráº­n Jacobian JÏµ=âˆ‚xÌ‚0/âˆ‚Ïµ cá»§a há»‡ thá»‘ng khuáº¿ch tÃ¡n báº±ng cÃ¡ch tá»‘i thiá»ƒu hÃ³a máº¥t mÃ¡t Ä‘iá»u chá»‰nh sau Ä‘Ã¢y táº¡i báº¥t ká»³ x0, Ïµ, vÃ  bÆ°á»›c t:
Lreg=Eâˆ†xÌ‚0,Ïµ[âˆš(1âˆ’Î±t)âˆ¥JTÏµâˆ†xÌ‚0âˆ¥2âˆ’a]2, (9)
trong Ä‘Ã³ âˆ†xÌ‚0 lÃ  cÆ°á»ng Ä‘á»™ pixel Ä‘Æ°á»£c láº¥y máº«u bÃ¬nh thÆ°á»ng Ä‘Æ°á»£c chuáº©n hÃ³a thÃ nh Ä‘á»™ dÃ i Ä‘Æ¡n vá»‹, Ïµ lÃ  má»™t nhiá»…u Ä‘Æ°á»£c láº¥y máº«u bÃ¬nh thÆ°á»ng trong PhÆ°Æ¡ng trÃ¬nh 2, vÃ  a lÃ  trung bÃ¬nh Ä‘á»™ng mÅ© cá»§a âˆš(1âˆ’Î±t)âˆ¥JTÏµâˆ†xÌ‚0âˆ¥2 Ä‘Æ°á»£c tÃ­nh toÃ¡n trá»±c tuyáº¿n trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Trong thá»±c táº¿, chÃºng tÃ´i tÃ­nh PhÆ°Æ¡ng trÃ¬nh 9 thÃ´ng qua lan truyá»n ngÆ°á»£c tiÃªu chuáº©n vá»›i Ä‘áº³ng thá»©c sau:
âˆš(1âˆ’Î±t)âˆ¥JTÏµâˆ†xÌ‚0âˆ¥2=âˆ¥âˆ‡Ïµ(âˆš(1âˆ’Î±t)xÌ‚0Â·âˆ†xÌ‚0)âˆ¥2.(10)

Äáº³ng thá»©c nÃ y Ä‘Ãºng vÃ¬ âˆ†xÌ‚0 Ä‘Æ°á»£c láº¥y máº«u Ä‘á»™c láº­p, vÃ  khÃ´ng tÆ°Æ¡ng quan vá»›i Ïµ.

Tiáº¿p theo, chÃºng tÃ´i chá»©ng minh ráº±ng má»¥c tiÃªu Ä‘Æ°á»£c Ä‘á» xuáº¥t trong PhÆ°Æ¡ng trÃ¬nh 9 khá»›p chÃ­nh xÃ¡c vá»›i má»¥c tiÃªu tá»‘i Æ°u hÃ³a cá»§a chÃºng tÃ´i trong PhÆ°Æ¡ng trÃ¬nh 8. Má»™t káº¿t quáº£ sÆ¡ bá»™, Ä‘Æ°á»£c chá»©ng minh trong [30], lÃ  trong cÃ¡c chiá»u cao, PhÆ°Æ¡ng trÃ¬nh 9 Ä‘Æ°á»£c tá»‘i thiá»ƒu hÃ³a khi JÏµ lÃ  trá»±c giao táº¡i báº¥t ká»³ Ïµ nÃ o Ä‘áº¿n má»™t yáº¿u tá»‘ tá»· lá»‡ toÃ n cá»¥c K (tá»©c lÃ  JÏµÂ·JTÏµ=KÂ·I). Báº±ng cÃ¡ch Ã¡p dá»¥ng tÃ­nh trá»±c giao cá»§a JÏµ, chÃºng ta cÃ³:
JTÏµâˆ†xÌ‚0=KJâˆ’1Ïµâˆ†xÌ‚0=Kâˆ‚Ïµ/âˆ‚xÌ‚0Â·âˆ†xÌ‚0=Kâˆ†Ïµ.(11)

Khi Lreg trong PhÆ°Æ¡ng trÃ¬nh 9 Ä‘áº¡t tá»‘i Æ°u, chÃºng ta sau Ä‘Ã³ cÃ³:
a=âˆš(1âˆ’Î±t)âˆ¥JTÏµâˆ†xÌ‚0âˆ¥2=âˆš(1âˆ’Î±t)Kâˆ¥âˆ†Ïµâˆ¥2. (12)

LÆ°u Ã½ ráº±ng a=aâˆ¥âˆ†xÌ‚0âˆ¥2, vÃ¬ âˆ¥âˆ†xÌ‚0âˆ¥2= 1 lÃ  vector Ä‘á»™ dÃ i Ä‘Æ¡n vá»‹ ngáº«u nhiÃªn Ä‘Ã£ Ä‘á» cáº­p trÆ°á»›c Ä‘Ã³. Do Ä‘Ã³, chÃºng ta cuá»‘i cÃ¹ng cÃ³ thá»ƒ tÃ¡i cÃ´ng thá»©c biá»ƒu thá»©c:
âˆ¥âˆ†xÌ‚0âˆ¥2=K/aÂ·âˆš(1âˆ’Î±t)âˆ¥âˆ†Ïµâˆ¥2
=Câˆš(1âˆ’Î±t)âˆ¥âˆ†Ïµâˆ¥2,(13)

--- TRANG 4 ---
DMDMğ‘‡ bÆ°á»›cğ(hoáº·c ğ’™!)$ğ’™"(a) Khuáº¿ch tÃ¡n thá»i gian suy luáº­n: Dá»± Ä‘oÃ¡n khá»­ nhiá»…u qua ğ‘» bÆ°á»›c (b) Khuáº¿ch tÃ¡n thá»i gian huáº¥n luyá»‡n: Dá»± Ä‘oÃ¡n khá»­ nhiá»…u táº¡i má»™t bÆ°á»›c Ä‘Æ¡n ğ’•ğ’™#$ğ’™"1âˆ’ğ›¼#ğğ›¼#ğ’™"+DMğ‘‡ bÆ°á»›c(hoáº·c ğ’™!+Î”ğ’™!)$ğ’™"+Î”$ğ’™"(c) Smooth Diffusion thá»i gian suy luáº­n: RÃ ng buá»™c biáº¿n thiÃªn qua ğ‘» bÆ°á»›c DM(d) Smooth Diffusion thá»i gian huáº¥n luyá»‡n: RÃ ng buá»™c biáº¿n thiÃªn táº¡i má»™t bÆ°á»›c Ä‘Æ¡n ğ’•ğ’™#+Î”ğ’™#$ğ’™"+Î”$ğ’™"1âˆ’ğ›¼#(ğ+Î”ğ)ğ›¼#ğ’™"+ğ+Î”ğğ¶Î”ğğŸ=ğ¶Î”ğ’™!%â‡”Î”$ğ’™"%,âˆ€ğğ¶1âˆ’ğ›¼#Î”ğğŸ=ğ¶Î”ğ’™#%â‡”Î”$ğ’™"%,âˆ€ğHÃ¬nh 2. Minh há»a cá»§a Smooth Diffusion. Smooth Diffusion (c) Ã©p buá»™c tá»· lá»‡ giá»¯a biáº¿n thiÃªn cá»§a latent Ä‘áº§u vÃ o (âˆ¥âˆ†Ïµâˆ¥2 hoáº·c âˆ¥âˆ†xTâˆ¥2) vÃ  biáº¿n thiÃªn cá»§a dá»± Ä‘oÃ¡n Ä‘áº§u ra (âˆ¥âˆ†xÌ‚0âˆ¥2) lÃ  má»™t háº±ng sá»‘ C. Khuáº¿ch tÃ¡n thá»i gian huáº¥n luyá»‡n (b) tá»‘i Æ°u hÃ³a má»™t "áº£nh chá»¥p nhanh t-bÆ°á»›c" cá»§a quÃ¡ trÃ¬nh dá»± Ä‘oÃ¡n khá»­ nhiá»…u trong Khuáº¿ch tÃ¡n thá»i gian suy luáº­n (a). TÆ°Æ¡ng tá»±, chÃºng tÃ´i Ä‘á» xuáº¥t Smooth Diffusion thá»i gian huáº¥n luyá»‡n (d) Ä‘á»ƒ tá»‘i Æ°u hÃ³a má»™t "áº£nh chá»¥p nhanh t-bÆ°á»›c" cá»§a rÃ ng buá»™c biáº¿n thiÃªn trong Smooth Diffusion thá»i gian suy luáº­n (c). DM: MÃ´ hÃ¬nh khuáº¿ch tÃ¡n.

Ä‘iá»u nÃ y khá»›p chÃ­nh xÃ¡c vá»›i má»¥c tiÃªu Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i trong PhÆ°Æ¡ng trÃ¬nh 8.
Äá»ƒ tÃ³m táº¯t, trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, má»¥c tiÃªu Smooth Diffusion bao gá»“m sá»± káº¿t há»£p cá»§a Lbase vÃ  Lreg:
L=Lbase+Î»Lreg, (14)
trong Ä‘Ã³ Lbase biá»ƒu thá»‹ má»¥c tiÃªu huáº¥n luyá»‡n cÆ¡ báº£n cá»§a má»™t mÃ´ hÃ¬nh khuáº¿ch tÃ¡n vÃ  Î» Ä‘áº¡i diá»‡n cho má»™t tham sá»‘ tá»· lá»‡ Ä‘iá»u khiá»ƒn cÆ°á»ng Ä‘á»™ cá»§a Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c.

4. ThÃ­ nghiá»‡m
4.1. Thiáº¿t láº­p thÃ­ nghiá»‡m
ÄÆ°á»ng cÆ¡ sá»Ÿ vÃ  thiáº¿t láº­p. ChÃºng tÃ´i chá»n Stable Diffusion [59] lÃ m Ä‘Æ°á»ng cÆ¡ sá»Ÿ chÃ­nh cho táº¥t cáº£ cÃ¡c nhiá»‡m vá»¥. NgoÃ i ra, Ä‘á»‘i vá»›i ná»™i suy hÃ¬nh áº£nh, chÃºng tÃ´i Ã¡p dá»¥ng ná»™i suy khÃ´ng gian VAE vÃ  ANID [75] lÃ m Ä‘á»‘i thá»§ cáº¡nh tranh. Äá»‘i vá»›i Ä‘áº£o ngÆ°á»£c hÃ¬nh áº£nh, chÃºng tÃ´i tÃ­ch há»£p Smooth Diffusion vÃ  Stable Diffusion vá»›i DDIM inversion [68] vÃ  Null-text inversion [42]. Äá»‘i vá»›i chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn vÄƒn báº£n, SDEdit [40], Prompt-to-Prompt (P2P) [20], Plug-and-Play (PnP) [72], Diffusion Disentanglement (Disentangle) [79], Pix2Pix-Zero [52] vÃ  Cycle Diffusion [78] Ä‘Æ°á»£c chá»n lÃ m cÃ¡c phÆ°Æ¡ng phÃ¡p SOTA. Äá»‘i vá»›i chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn kÃ©o, chÃºng tÃ´i so sÃ¡nh Smooth Diffusion vá»›i Stable Diffusion trong khung cá»§a DragDiffusion [66].

Chi tiáº¿t triá»ƒn khai. Smooth Diffusion Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn Stable Diffusion-V1.5 [59] Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c, sá»­ dá»¥ng ká»¹ thuáº­t tinh chá»‰nh LoRA [24]. UNet cá»§a Smooth Diffusion Ä‘Æ°á»£c Ä‘áº·t lÃ  cÃ³ thá»ƒ huáº¥n luyá»‡n vá»›i háº¡ng LoRA lÃ  8, trong khi VAE vÃ  bá»™ mÃ£ hÃ³a vÄƒn báº£n Ä‘Æ°á»£c Ä‘Ã³ng bÄƒng. ChÃºng tÃ´i táº­n dá»¥ng LAION Aesthetics 6.5+ lÃ m táº­p dá»¯ liá»‡u huáº¥n luyá»‡n, chá»©a 625K cáº·p hÃ¬nh áº£nh-vÄƒn báº£n vá»›i Ä‘iá»ƒm tháº©m má»¹ dá»± Ä‘oÃ¡n lÃ  6.5 hoáº·c cao hÆ¡n tá»« LAION-5B [64]. Smooth diffusion thÆ°á»ng Ä‘Æ°á»£c huáº¥n luyá»‡n trong 30K láº§n láº·p vá»›i kÃ­ch thÆ°á»›c batch lÃ  96, 3 máº«u trÃªn GPU, tá»•ng cá»™ng 4 A100 GPU, vÃ  tÃ­ch lÅ©y gradient lÃ  8. Bá»™ tá»‘i Æ°u AdamW [33] Ä‘Æ°á»£c Ã¡p dá»¥ng vá»›i tá»‘c Ä‘á»™ há»c táº­p khÃ´ng Ä‘á»•i lÃ  1Ã—10âˆ’4 vÃ  weight decay lÃ  1Ã—10âˆ’4. Tham sá»‘ tá»· lá»‡ Î» trong PhÆ°Æ¡ng trÃ¬nh 14 Ä‘Æ°á»£c Ä‘áº·t lÃ  1. Trong quÃ¡ trÃ¬nh suy luáº­n, tá»•ng sá»‘ bÆ°á»›c khuáº¿ch tÃ¡n Ä‘Æ°á»£c Ä‘áº·t lÃ  50 vÃ  tá»· lá»‡ hÆ°á»›ng dáº«n classifier-free [22] Ä‘Æ°á»£c Ä‘áº·t lÃ  7.5.

Chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡. Äá»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t táº¡o sinh vÄƒn báº£n-hÃ¬nh áº£nh tá»•ng quÃ¡t, chÃºng tÃ´i bÃ¡o cÃ¡o FID [21] phá»• biáº¿n vÃ  CLIP Score [55] trÃªn táº­p validation MS-COCO [36]. Äá»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent, chÃºng tÃ´i Ä‘á» xuáº¥t Ä‘á»™ lá»‡ch chuáº©n ná»™i suy (ISTD) lÃ m chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡. Cá»¥ thá»ƒ, chÃºng tÃ´i ngáº«u nhiÃªn rÃºt 500 lá»i nháº¯c vÄƒn báº£n tá»« táº­p validation MS-COCO. Äá»‘i vá»›i má»—i lá»i nháº¯c, chÃºng tÃ´i láº¥y máº«u má»™t cáº·p nhiá»…u Gaussian vÃ  ná»™i suy Ä‘á»“ng nháº¥t chÃºng tá»« má»™t sang cÃ¡i khÃ¡c 9 láº§n vá»›i tá»· lá»‡ há»—n há»£p tá»« 0.1 Ä‘áº¿n 0.9. ÄÆ°a vÃ o cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n cÃ¹ng vá»›i má»™t lá»i nháº¯c, chÃºng tÃ´i cÃ³ thá»ƒ thu Ä‘Æ°á»£c tá»•ng cá»™ng 11 hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra, 2 tá»« cÃ¡c nhiá»…u Gaussian nguá»“n vÃ  9 tá»« cÃ¡c nhiá»…u Ä‘Æ°á»£c ná»™i suy. ChÃºng tÃ´i tÃ­nh Ä‘á»™ lá»‡ch chuáº©n cá»§a khoáº£ng cÃ¡ch L2 giá»¯a má»—i hai hÃ¬nh áº£nh liá»n ká» trong khÃ´ng gian pixel. Cuá»‘i cÃ¹ng, chÃºng tÃ´i tÃ­nh trung bÃ¬nh Ä‘á»™ lá»‡ch chuáº©n trÃªn 500 lá»i nháº¯c nhÆ° ISTD. LÃ½ tÆ°á»Ÿng, giÃ¡ trá»‹ khÃ´ng cá»§a ISTD chá»‰ ra ráº±ng cÃ¡c biáº¿n Ä‘á»™ng thá»‹ giÃ¡c nháº¥t quÃ¡n vÃ  Ä‘á»“ng nháº¥t trong khÃ´ng gian pixel cho cÃ¡c thay Ä‘á»•i kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh giá»‘ng há»‡t nhau trong khÃ´ng gian latent, dáº«n Ä‘áº¿n má»™t khÃ´ng gian latent mÆ°á»£t mÃ . Äá»‘i vá»›i Ä‘áº£o ngÆ°á»£c hÃ¬nh áº£nh, lá»—i bÃ¬nh phÆ°Æ¡ng trung bÃ¬nh (MSE), LPIPS [90], SSIM [76] vÃ  PSNR [26] Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ kháº£ nÄƒng tÃ¡i táº¡o hÃ¬nh áº£nh.

4.2. Ná»™i suy KhÃ´ng gian Latent
So sÃ¡nh Ä‘á»‹nh tÃ­nh. CÃ¡ch Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ chá»©ng minh tÃ­nh mÆ°á»£t mÃ  cá»§a khÃ´ng gian latent lÃ  thÃ´ng qua quan sÃ¡t káº¿t quáº£ ná»™i suy giá»¯a cÃ¡c nhiá»…u latent. Trong HÃ¬nh 3, chÃºng tÃ´i trÃ¬nh bÃ y so sÃ¡nh ná»™i suy giá»¯a Smooth Diffusion vÃ  Stable Diffusion sá»­ dá»¥ng hÃ¬nh áº£nh thá»±c. Äá»ƒ táº¡o ra nhá»¯ng so sÃ¡nh nÃ y, chÃºng tÃ´i sá»­ dá»¥ng NTI [42] Ä‘á»ƒ Ä‘áº£o ngÆ°á»£c má»™t cáº·p hÃ¬nh áº£nh thá»±c thÃ nh nhiá»…u latent xT, chia sáº» cÃ¹ng {âˆ…t}Tt=1. Sau Ä‘Ã³ chÃºng tÃ´i thá»±c hiá»‡n ná»™i suy tuyáº¿n tÃ­nh cáº§u Ä‘á»“ng nháº¥t giá»¯a cÃ¡c nhiá»…u latent (cÃ²n Ä‘Æ°á»£c gá»i lÃ  Stable Diffusion Walk [27]), dáº«n Ä‘áº¿n 9 nhiá»…u trung gian vá»›i tá»· lá»‡ há»—n há»£p tá»« 0.1 Ä‘áº¿n 0.9. Sau Ä‘Ã³, chÃºng tÃ´i ná»‘i 11 hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o tá»« nhá»¯ng nhiá»…u nÃ y Ä‘á»ƒ táº¡o ra má»™t chuá»—i chuyá»ƒn tiáº¿p hÃ¬nh áº£nh trong cÃ¡c hÃ¬nh.

ÄÃ¡ng chÃº Ã½, nhÆ° Ä‘Æ°á»£c lÃ m ná»•i báº­t bá»Ÿi cÃ¡c há»™p Ä‘á», Stable Diffusion thá»ƒ hiá»‡n cÃ¡c biáº¿n Ä‘á»™ng thá»‹ giÃ¡c Ä‘Ã¡ng ká»ƒ trong quÃ¡ trÃ¬nh chuyá»ƒn tiáº¿p. Äáº·c biá»‡t, cÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c ná»™i suy cÃ³ thá»ƒ giá»›i thiá»‡u cÃ¡c thuá»™c tÃ­nh má»›i khÃ´ng liÃªn quan Ä‘áº¿n hÃ¬nh áº£nh nguá»“n, vÃ­ dá»¥, cÃ¡c Ä‘á»“ng cá» khÃ´ng mong muá»‘n trong hÃ ng thá»© hai cá»§a HÃ¬nh 3. NgÆ°á»£c láº¡i, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i, Smooth Diffusion, khÃ´ng chá»‰ trÃ¡nh viá»‡c giá»›i thiá»‡u cÃ¡c thuá»™c tÃ­nh khÃ´ng liÃªn quan rÃµ rÃ ng trong cÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c ná»™i suy mÃ  cÃ²n Ä‘áº£m báº£o ráº±ng cÃ¡c hiá»‡u á»©ng thá»‹ giÃ¡c thay Ä‘á»•i mÆ°á»£t mÃ  trong suá»‘t quÃ¡ trÃ¬nh chuyá»ƒn tiáº¿p. Káº¿t quáº£ ná»™i suy bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c xem trong tÃ i liá»‡u bá»• sung.

NgoÃ i Stable Diffusion, HÃ¬nh 3 cÅ©ng bao gá»“m hai phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»ng cÆ¡ sá»Ÿ khÃ¡c Ä‘á»ƒ so sÃ¡nh: 1) Ná»™i suy VAE (VAE Inter.), thá»±c hiá»‡n ná»™i suy trong khÃ´ng gian VAE cá»§a Stable Diffusion. Tuy nhiÃªn, káº¿t quáº£ gáº§n giá»‘ng vá»›i ná»™i suy khÃ´ng gian pixel, vá»›i sá»± suy giáº£m Ä‘Ã¡ng ká»ƒ cá»§a chi tiáº¿t thá»‹ giÃ¡c, Ä‘áº·c biá»‡t trong khu vá»±c há»™p Ä‘á» Ä‘Æ°á»£c lÃ m ná»•i báº­t. 2) ANID [75], Ä‘áº§u tiÃªn thÃªm nhiá»…u vÃ o hÃ¬nh áº£nh thá»±c vÃ  sau Ä‘Ã³ khá»­ nhiá»…u cÃ¡c hÃ¬nh áº£nh nhiá»…u Ä‘Æ°á»£c ná»™i suy báº±ng Stable Diffusion. Trong HÃ¬nh 3, ANID vá»›i bá»™ láº­p lá»‹ch 50-bÆ°á»›c thá»ƒ hiá»‡n káº¿t quáº£ ná»™i suy ráº¥t má». Khi ANID hoáº¡t Ä‘á»™ng vá»›i bá»™ láº­p lá»‹ch 200-bÆ°á»›c máº·c Ä‘á»‹nh, viá»‡c lÃ m má» cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£m thiá»ƒu, nhÆ°ng cháº¥t lÆ°á»£ng cá»§a cÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c ná»™i suy váº«n cÃ²n xa má»›i thá»a mÃ£n.

So sÃ¡nh Ä‘á»‹nh lÆ°á»£ng. Má»¥c tiÃªu cá»§a Smooth Diffusion lÃ  tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent mÃ  khÃ´ng lÃ m suy giáº£m hiá»‡u suáº¥t táº¡o sinh hÃ¬nh áº£nh so vá»›i Stable Diffusion. Theo Ä‘uá»•i má»¥c tiÃªu nÃ y, chÃºng tÃ´i sá»­ dá»¥ng ISTD Ä‘Æ°á»£c giá»›i thiá»‡u trong Pháº§n 4.1 Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent. NgoÃ i ra, chÃºng tÃ´i sá»­ dá»¥ng FID [21] vÃ  CLIP Score [55] Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t tá»•ng thá»ƒ cá»§a cÃ¡c bá»™ táº¡o. Káº¿t quáº£ Ä‘Æ°á»£c trÃ¬nh bÃ y trong Báº£ng 1 chá»©ng minh ráº±ng Smooth Diffusion vÆ°á»£t trá»™i Ä‘Ã¡ng ká»ƒ so vá»›i Stable Diffusion vá» ISTD, chá»‰ ra má»™t cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ trong tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent. HÆ¡n ná»¯a, Smooth Diffusion thá»ƒ hiá»‡n hiá»‡u suáº¥t vÆ°á»£t trá»™i trong cáº£ FID vÃ  CLIP Score, gá»£i Ã½ ráº±ng viá»‡c tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent vÃ  cháº¥t lÆ°á»£ng táº¡o sinh hÃ¬nh áº£nh tá»•ng thá»ƒ khÃ´ng loáº¡i trá»« láº«n nhau mÃ  bá»• sung cho nhau khi thuáº­t ngá»¯ Ä‘iá»u chá»‰nh Ä‘Æ°á»£c Ã¡p dá»¥ng vá»›i má»™t tá»· lá»‡ cÆ°á»ng Ä‘á»™ phÃ¹ há»£p.

4.3. Äáº£o ngÆ°á»£c vÃ  TÃ¡i táº¡o HÃ¬nh áº£nh
NghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y [30] trong lÄ©nh vá»±c GANs Ä‘Ã£ phÃ¡t hiá»‡n ra ráº±ng má»™t khÃ´ng gian latent mÆ°á»£t mÃ  hÆ¡n cÃ³ tÃ¡c Ä‘á»™ng tÃ­ch cá»±c Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c cá»§a Ä‘áº£o ngÆ°á»£c vÃ  tÃ¡i táº¡o hÃ¬nh áº£nh. ChÃºng tÃ´i xÃ¡c thá»±c thá»±c nghiá»‡m phÃ¡t hiá»‡n nÃ y trong bá»‘i cáº£nh cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. Cá»¥ thá»ƒ, hai ká»¹ thuáº­t Ä‘áº£o ngÆ°á»£c Ä‘áº¡i diá»‡n, DDIM inversion [68] vÃ  Null-text inversion (NTI) [42] Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ  tÃ­ch há»£p vá»›i Smooth Diffusion vÃ  Stable Diffusion riÃªng biá»‡t. ChÃºng tÃ´i so sÃ¡nh cáº£ Ä‘á»‹nh tÃ­nh vÃ  Ä‘á»‹nh lÆ°á»£ng hiá»‡u suáº¥t Ä‘áº£o ngÆ°á»£c vÃ  tÃ¡i táº¡o hÃ¬nh áº£nh cá»§a cÃ¡c mÃ´ hÃ¬nh tÃ­ch há»£p nÃ y sá»­ dá»¥ng 500 hÃ¬nh áº£nh Ä‘Æ°á»£c láº¥y máº«u ngáº«u nhiÃªn tá»« táº­p validation MS-COCO [36].

NhÆ° Ä‘Æ°á»£c minh há»a trong hai cá»™t ngoÃ i cÃ¹ng bÃªn pháº£i cá»§a HÃ¬nh 4, khi sá»­ dá»¥ng má»™t DDIM inversion Ä‘Æ¡n giáº£n, Smooth Diffusion vÆ°á»£t trá»™i hÆ¡n Stable Diffusion má»™t cÃ¡ch Ä‘Ã¡ng ká»ƒ vá» cháº¥t lÆ°á»£ng tÃ¡i táº¡o. Sá»± cáº£i thiá»‡n nÃ y rÃµ rÃ ng trong nhiá»u khÃ­a cáº¡nh khÃ¡c nhau, cháº³ng háº¡n nhÆ° viá»‡c táº¡o ra chÃ­nh xÃ¡c danh tÃ­nh nhÃ¢n váº­t, tÃ¡i táº¡o trung thá»±c cáº£nh quan thÃ nh phá»‘ phÃ­a sau thÃ¡p, vÃ  tÃ¡i táº¡o chÃ­nh xÃ¡c bá»‘ cá»¥c phÃ²ng. Hiá»‡n tÆ°á»£ng nÃ y nháº¥n máº¡nh thá»±c táº¿ ráº±ng khÃ´ng gian latent cá»§a Smooth Diffusion chá»‹u Ä‘á»±ng tá»‘t hÆ¡n cÃ¡c lá»—i Ä‘Æ°á»£c giá»›i thiá»‡u bá»Ÿi xáº¥p xá»‰ tuyáº¿n tÃ­nh cá»¥c bá»™ trong DDIM inversion. Do Ä‘Ã³, káº¿t quáº£ tÃ¡i táº¡o Ä‘Æ°á»£c táº¡o ra bá»Ÿi Smooth Diffusion quáº£n lÃ½ Ä‘á»ƒ giá»¯ láº¡i ná»™i dung cá»§a hÃ¬nh áº£nh nguá»“n á»Ÿ má»©c Ä‘á»™ lá»›n hÆ¡n. Máº·t khÃ¡c, khi ká»¹ thuáº­t NTI dá»±a trÃªn tá»‘i Æ°u hÃ³a Ä‘Æ°á»£c sá»­ dá»¥ng, sá»± khÃ¡c biá»‡t giá»¯a Smooth Diffusion vÃ  Stable Diffusion khÃ´ng rÃµ rÃ ng nhÆ° váº­y. Tuy nhiÃªn, váº«n cÃ³ nhá»¯ng trÆ°á»ng há»£p mÃ  Stable Diffusion thá»ƒ hiá»‡n káº¿t quáº£ dÆ°á»›i má»©c, cháº³ng háº¡n nhÆ° khuÃ´n máº·t ngÆ°á»i Ä‘Ã n Ã´ng bá»‹ há»ng trong HÃ¬nh 4.

Äá»ƒ Ä‘á»‹nh lÆ°á»£ng hiá»‡u suáº¥t tÃ¡i táº¡o hÃ¬nh áº£nh, MSE, LPIPS [90], SSIM [76] vÃ  PSNR [26] Ä‘Æ°á»£c bÃ¡o cÃ¡o trong Báº£ng 2. ÄÃ¡ng chÃº Ã½, lá»—i tÃ¡i táº¡o bao gá»“m hai thÃ nh pháº§n: 1) lá»—i tá»« cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘áº£o ngÆ°á»£c khÃ¡c nhau vÃ  cÃ¡c tham sá»‘ U-Net vÃ  2) lá»—i tá»« VAE Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c chia sáº» [34]. Do Ä‘Ã³, chÃºng tÃ´i bao gá»“m cÃ¡c lá»—i tÃ¡i táº¡o VAE nhÆ° cÃ¡c giÃ¡ trá»‹ tá»‘i Æ°u cho phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i. Káº¿t quáº£ thá»ƒ hiá»‡n hiá»‡u suáº¥t vÆ°á»£t trá»™i nháº¥t quÃ¡n cá»§a Smooth Diffusion so vá»›i Stable Diffusion trÃªn táº¥t cáº£ cÃ¡c chá»‰ sá»‘, cho dÃ¹ sá»­ dá»¥ng DDIM inversion hay NTI. HÆ¡n ná»¯a, "Smooth Diffusion + NTI" thá»±c hiá»‡n káº¿t quáº£ gáº§n vá»›i tÃ¡i táº¡o VAE, chá»‰ ra tÃ­nh Æ°u viá»‡t cá»§a nÃ³ Ä‘Æ°á»£c quy cho má»™t khÃ´ng gian latent mÆ°á»£t mÃ  hÆ¡n.

4.4. Chá»‰nh sá»­a HÃ¬nh áº£nh
TÃ­nh Æ°u viá»‡t cá»§a Smooth Diffusion trong Ä‘áº£o ngÆ°á»£c vÃ  tÃ¡i táº¡o hÃ¬nh áº£nh Ä‘Ã£ thÃºc Ä‘áº©y chÃºng tÃ´i khÃ¡m phÃ¡ tiá»m nÄƒng cá»§a nÃ³ Ä‘á»ƒ tÄƒng cÆ°á»ng cÃ¡c nhiá»‡m vá»¥ chá»‰nh sá»­a hÃ¬nh áº£nh. Trong pháº§n nÃ y, chÃºng tÃ´i Ä‘i sÃ¢u vÃ o hai ká»‹ch báº£n chá»‰nh sá»­a hÃ¬nh áº£nh Ä‘iá»ƒn hÃ¬nh: chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn vÄƒn báº£n vÃ  chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn kÃ©o.

Chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn vÄƒn báº£n. ÄÃ£ cÃ³ nhiá»u phÆ°Æ¡ng phÃ¡p [20, 40, 52, 72, 78, 79] Ä‘Æ°á»£c Ä‘á» xuáº¥t trong vÄƒn há»c, má»—i phÆ°Æ¡ng phÃ¡p cÃ³ thiáº¿t káº¿ Ä‘á»™c Ä‘Ã¡o riÃªng nháº±m Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t SOTA. NgÆ°á»£c láº¡i, chÃºng tÃ´i Ã¡p dá»¥ng má»™t pipeline Ä‘Æ¡n giáº£n hÆ¡n tÆ°Æ¡ng tá»± nhÆ° quÃ¡ trÃ¬nh Ä‘áº£o ngÆ°á»£c vÃ  tÃ¡i táº¡o hÃ¬nh áº£nh Ä‘Æ°á»£c tháº£o luáº­n trong Pháº§n 4.3. Sá»± khÃ¡c biá»‡t chÃ­nh náº±m á»Ÿ cÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i Ä‘á»ƒ sá»­a Ä‘á»•i lá»i nháº¯c vÄƒn báº£n trong cÃ¡c bÆ°á»›c thá»i gian sau cá»§a quÃ¡ trÃ¬nh tÃ¡i táº¡o. Cá»¥ thá»ƒ, ÏµÎ¸(xt, t,C,âˆ…t) gá»‘c trong PhÆ°Æ¡ng trÃ¬nh (5) trong quÃ¡ trÃ¬nh tÃ¡i táº¡o NTI (láº¥y máº«u khuáº¿ch tÃ¡n) Ä‘Æ°á»£c thay tháº¿ báº±ng:
ÏµÎ¸(xt, t,C,âˆ…t) ={
ÏµÎ¸(xt, t,Csrc,âˆ…t), t > T Ã—r,
ÏµÎ¸(xt, t,Ctrg,âˆ…t), tâ‰¤TÃ—r,(15)
trong Ä‘Ã³ Csrc Ä‘áº¡i diá»‡n cho lá»i nháº¯c vÄƒn báº£n nguá»“n cho Ä‘áº£o ngÆ°á»£c, trong khi Ctrg tÆ°Æ¡ng á»©ng vá»›i lá»i nháº¯c vÄƒn báº£n má»¥c tiÃªu cho chá»‰nh sá»­a. Tham sá»‘ r phá»¥c vá»¥ nhÆ° má»™t ngÆ°á»¡ng, xÃ¡c Ä‘á»‹nh khi nÃ o chuyá»ƒn tá»« Csrc sang Ctrg. Trong thá»±c táº¿, r thÆ°á»ng Ä‘Æ°á»£c chá»n trong {0.6, 0.7, 0.8, 0.9}, vá»›i giÃ¡ trá»‹ chÃ­nh xÃ¡c phá»¥ thuá»™c vÃ o hÃ¬nh áº£nh Ä‘áº§u vÃ o cá»¥ thá»ƒ vÃ  hiá»‡u á»©ng thá»‹ giÃ¡c má»¥c tiÃªu.

ThÃ´ng qua pipeline Ä‘Æ¡n giáº£n nÃ y, chÃºng tÃ´i tiáº¿n hÃ nh phÃ¢n tÃ­ch so sÃ¡nh hiá»‡u suáº¥t chá»‰nh sá»­a giá»¯a Smooth Diffusion vÃ  Stable Diffusion, nhÆ° Ä‘Æ°á»£c trÃ¬nh bÃ y trong ba cá»™t trÃ¡i nháº¥t cá»§a HÃ¬nh 5. ChÃºng tÃ´i cÅ©ng bao gá»“m káº¿t quáº£ chá»‰nh sá»­a thu Ä‘Æ°á»£c tá»« cÃ¡c phÆ°Æ¡ng phÃ¡p SOTA nhÆ° tham chiáº¿u. ÄÃ¡nh giÃ¡ cá»§a chÃºng tÃ´i bao gá»“m cáº£ nhiá»‡m vá»¥ chá»‰nh sá»­a cá»¥c bá»™ vÃ  toÃ n cá»¥c. CÃ¡c nhiá»‡m vá»¥ chá»‰nh sá»­a cá»¥c bá»™ liÃªn quan Ä‘áº¿n viá»‡c thay tháº¿ cÃ¡c má»¥c (vÃ­ dá»¥, thay Ä‘á»•i "kem" thÃ nh "dÃ¢u tÃ¢y") vÃ  thÃªm cÃ¡c má»¥c (vÃ­ dá»¥, "tÃ¡o"). Máº·t khÃ¡c, cÃ¡c nhiá»‡m vá»¥ chá»‰nh sá»­a toÃ n cá»¥c liÃªn quan Ä‘áº¿n chuyá»ƒn giao phong cÃ¡ch toÃ n cá»¥c, cháº³ng háº¡n nhÆ° biáº¿n Ä‘á»•i má»™t hÃ¬nh áº£nh thÃ nh "phong cÃ¡ch hoáº¡t hÃ¬nh". RÃµ rÃ ng ráº±ng trong khi Stable Diffusion xuáº¥t sáº¯c trong viá»‡c Ä‘áº¡t Ä‘Æ°á»£c tÃ¡i táº¡o hÃ¬nh áº£nh chÃ­nh xÃ¡c vá»›i NTI, nhÆ° Ä‘Ã£ tháº£o luáº­n trong Pháº§n 4.3, ngay cáº£ nhá»¯ng sá»­a Ä‘á»•i nhá» Ä‘á»‘i vá»›i lá»i nháº¯c vÄƒn báº£n cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n ná»™i dung cá»§a hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra. VÃ­ dá»¥, nÃ³ cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c yáº¿u tá»‘ nhÆ° phong cÃ¡ch cá»§a bÃ¡nh, hÃ¬nh dáº¡ng cá»§a quáº£ chuá»‘i, vÃ  kiá»ƒu tÃ³c cá»§a cÃ´ gÃ¡i. NgÆ°á»£c láº¡i, Smooth Diffusion khÃ´ng chá»‰ táº¡o ra chÃ­nh xÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c chá»‰nh sá»­a phÃ¹ há»£p vá»›i lá»i nháº¯c vÄƒn báº£n má»¥c tiÃªu mÃ  cÃ²n hiá»‡u quáº£ báº£o tá»“n ná»™i dung chÆ°a Ä‘Æ°á»£c chá»‰nh sá»­a. HÆ¡n ná»¯a, khi so sÃ¡nh vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p SOTA, ngay cáº£ vá»›i pipeline Ä‘Æ¡n giáº£n nÃ y, Smooth Diffusion liÃªn tá»¥c mang láº¡i káº¿t quáº£ cáº¡nh tranh trÃªn táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p.

Chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn kÃ©o. NhÆ° má»™t hÆ°á»›ng nghiÃªn cá»©u má»›i ná»•i trong cá»™ng Ä‘á»“ng, chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn kÃ©o [43, 50, 66] Ä‘Ã£ thu hÃºt sá»± chÃº Ã½ Ä‘Ã¡ng ká»ƒ gáº§n Ä‘Ã¢y. DragDiffusion [66] Ä‘áº§u tiÃªn giá»›i thiá»‡u má»™t khung cho chá»‰nh sá»­a hÃ¬nh áº£nh dá»±a trÃªn kÃ©o sá»­ dá»¥ng Stable Diffusion. Trong nhiá»‡m vá»¥ 3 cá»§a HÃ¬nh 1 vÃ  HÃ¬nh 6, chÃºng tÃ´i thá»ƒ hiá»‡n ráº±ng báº±ng cÃ¡ch tÃ­ch há»£p Smooth Diffusion vÃ o khung DragDiffusion, má»™t sá»‘ hoáº¡t Ä‘á»™ng chá»‰nh sá»­a trÆ°á»›c Ä‘Ã¢y khÃ´ng thÃ nh cÃ´ng vá»›i Stable Diffusion cÃ³ thá»ƒ Ä‘Æ°á»£c kÃ­ch hoáº¡t. NhÆ° Ä‘Æ°á»£c minh há»a, Smooth Diffusion Ä‘áº¡t Ä‘Æ°á»£c cÃ¡c hoáº¡t Ä‘á»™ng nhÆ° lÃ m cho cÃ¢y phÃ¡t triá»ƒn cao hÆ¡n mÃ  khÃ´ng lÃ m há»ng cÃ¡c nhÃ¡nh hiá»‡n cÃ³ (HÃ¬nh 1), xoay Ä‘áº§u mÃ¨o, táº¡o ra má»™t Ä‘á»‰nh nÃºi má»›i mÃ  khÃ´ng phÃ¡ há»§y cÃ¡i cÅ©, vÃ  Ä‘á»ƒ hoa má»›i phÃ¡t triá»ƒn trong bÃ¬nh (HÃ¬nh 6). Tuy nhiÃªn, nhá»¯ng hoáº¡t Ä‘á»™ng nÃ y tháº¥t báº¡i vá»›i Stable Diffusion, chá»‰ ra tÃ­nh khÃ´ng mÆ°á»£t mÃ  cá»§a khÃ´ng gian latent cá»§a nÃ³.

4.5. NghiÃªn cá»©u Loáº¡i bá»
Tá»· lá»‡ Ä‘iá»u chá»‰nh. Trong Báº£ng 3, chÃºng tÃ´i kiá»ƒm tra tÃ¡c Ä‘á»™ng cá»§a cÃ¡c tá»· lá»‡ cÆ°á»ng Ä‘á»™ Î» khÃ¡c nhau trong PhÆ°Æ¡ng trÃ¬nh (14). Tá»· lá»‡ nÃ y Ä‘iá»u chá»‰nh cÆ°á»ng Ä‘á»™ cá»§a Ä‘iá»u chá»‰nh biáº¿n thiÃªn tá»«ng bÆ°á»›c. Cá»¥ thá»ƒ, khi má»™t Ä‘iá»u chá»‰nh yáº¿u hÆ¡n Ä‘Æ°á»£c Ã¡p dá»¥ng (vÃ­ dá»¥, Î»= 0.1), chÃºng tÃ´i quan sÃ¡t má»™t cáº£i thiá»‡n nhá» trong CLIP Score. Tuy nhiÃªn, cÃ³ má»™t sá»± gia tÄƒng Ä‘Ã¡ng ká»ƒ trong ISTD, chá»‰ ra má»™t sá»± suy giáº£m Ä‘Ã¡ng chÃº Ã½ trong tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent. NgÆ°á»£c láº¡i, viá»‡c sá»­ dá»¥ng má»™t Ä‘iá»u chá»‰nh máº¡nh hÆ¡n (vÃ­ dá»¥, Î»= 10) dáº«n Ä‘áº¿n má»™t khÃ´ng gian latent mÆ°á»£t mÃ  hÆ¡n, nhÆ° Ä‘Æ°á»£c chá»©ng minh bá»Ÿi sá»± giáº£m ISTD. Tuy nhiÃªn, trong trÆ°á»ng há»£p nÃ y, chÃºng tÃ´i quan sÃ¡t má»™t sá»± gia tÄƒng báº¥t ngá» trong FID, chá»‰ ra má»™t sá»± suy giáº£m Ä‘Ã¡ng chÃº Ã½ trong cháº¥t lÆ°á»£ng cá»§a hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra. Do Ä‘Ã³, viá»‡c chá»n má»™t giÃ¡ trá»‹ Ä‘Ã¡nh Ä‘á»•i phÃ¹ há»£p cho Î» trá»Ÿ nÃªn quan trá»ng dá»±a trÃªn cÃ¡c thiáº¿t láº­p thÃ­ nghiá»‡m cá»¥ thá»ƒ. Trong thiáº¿t láº­p máº·c Ä‘á»‹nh cá»§a chÃºng tÃ´i, chÃºng tÃ´i tháº¥y ráº±ng Î»= 1 phá»¥c vá»¥ nhÆ° má»™t giÃ¡ trá»‹ phÃ¹ há»£p.

Háº¡ng LoRA. Trong Báº£ng 4, chÃºng tÃ´i kiá»ƒm tra tÃ¡c Ä‘á»™ng cá»§a cÃ¡c háº¡ng khÃ¡c nhau cá»§a thÃ nh pháº§n LoRA Ä‘Æ°á»£c sá»­ dá»¥ng trong Smooth diffusion cá»§a chÃºng tÃ´i. ChÃºng tÃ´i phÃ¡t hiá»‡n ra ráº±ng cÃ¡c háº¡ng LoRA trong pháº¡m vi [4,16] Ä‘á»u lÃ  cÃ¡c giÃ¡ trá»‹ phÃ¹ há»£p cho thiáº¿t láº­p máº·c Ä‘á»‹nh cá»§a chÃºng tÃ´i. ChÃºng tÃ´i chá»n háº¡ng máº·c Ä‘á»‹nh lÃ  8 vÃ¬ ISTD tháº¥p nháº¥t cá»§a nÃ³ trong ba hÃ ng Ä‘áº§u trong Báº£ng 4. HÆ¡n ná»¯a, chÃºng tÃ´i huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh Ä‘áº§y Ä‘á»§, Ä‘Æ°á»£c gá»i lÃ  "full", thá»ƒ hiá»‡n má»™t sá»± giáº£m thÃªm trong ISTD. Tuy nhiÃªn, Ä‘iá»u nÃ y Ä‘i kÃ¨m vá»›i chi phÃ­ lÃ  suy giáº£m Ä‘Ã¡ng ká»ƒ cháº¥t lÆ°á»£ng cá»§a hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra, nhÆ° Ä‘Æ°á»£c chá»‰ ra bá»Ÿi FID tÄƒng vÃ  CLIP Score giáº£m. Sá»± suy giáº£m hiá»‡u suáº¥t nÃ y nháº¥n máº¡nh tÃ­nh dá»… bá»‹ tá»•n thÆ°Æ¡ng cá»§a cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh Ä‘áº§y Ä‘á»§ Ä‘á»‘i vá»›i sá»± sá»¥p Ä‘á»• trong thiáº¿t láº­p máº·c Ä‘á»‹nh cá»§a chÃºng tÃ´i, nháº¥n máº¡nh nhu cáº§u cho cÃ¡c cÃ¢n nháº¯c thiáº¿t káº¿ tá»‰ má»‰ bá»• sung.

5. Káº¿t luáº­n
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘Ã£ khÃ¡m phÃ¡ Smooth Diffusion, má»™t mÃ´ hÃ¬nh khuáº¿ch tÃ¡n sÃ¡ng táº¡o tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent cho viá»‡c táº¡o sinh. Smooth Diffusion Ã¡p dá»¥ng Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c má»›i, thÃ nh cÃ´ng duy trÃ¬ biáº¿n thiÃªn giá»¯a latent Ä‘áº§u vÃ o tÃ¹y Ã½ vÃ  hÃ¬nh áº£nh Ä‘Æ°á»£c táº¡o ra trong má»™t pháº¡m vi giá»›i háº¡n hÆ¡n. Smooth Diffusion Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn mÃ´ hÃ¬nh vÄƒn báº£n-hÃ¬nh áº£nh phá»• biáº¿n, tá»« Ä‘Ã³ chÃºng tÃ´i tiáº¿n hÃ nh nghiÃªn cá»©u má»Ÿ rá»™ng, bao gá»“m nhÆ°ng khÃ´ng giá»›i háº¡n á»Ÿ ná»™i suy, Ä‘áº£o ngÆ°á»£c vÃ  chá»‰nh sá»­a, táº¥t cáº£ Ä‘á»u cho tháº¥y hiá»‡u suáº¥t cáº¡nh tranh. ThÃ´ng qua cÃ¡c Ä‘o lÆ°á»ng Ä‘á»‹nh tÃ­nh vÃ  Ä‘á»‹nh lÆ°á»£ng, chÃºng tÃ´i Ä‘Ã£ chá»©ng minh ráº±ng Smooth Diffusion quáº£n lÃ½ Ä‘á»ƒ táº¡o ra má»™t khÃ´ng gian latent mÆ°á»£t mÃ  hÆ¡n mÃ  khÃ´ng lÃ m tá»•n háº¡i cháº¥t lÆ°á»£ng Ä‘áº§u ra. ChÃºng tÃ´i tin ráº±ng Smooth Diffusion sáº½ trá»Ÿ thÃ nh má»™t giáº£i phÃ¡p cÃ³ giÃ¡ trá»‹ cho cÃ¡c nhiá»‡m vá»¥ thÃ¡ch thá»©c khÃ¡c, cháº³ng háº¡n nhÆ° táº¡o sinh video, trong tÆ°Æ¡ng lai.

--- TRANG 5 ---
[TÃ i liá»‡u tham kháº£o vá»›i 94 má»¥c tá»« [1] Ä‘áº¿n [94] - tÃ´i sáº½ giá»¯ nguyÃªn Ä‘á»‹nh dáº¡ng cá»§a cÃ¡c tÃ i liá»‡u tham kháº£o nÃ y]

--- TRANG 6 Ä‘áº¿n 15 ---
[Tiáº¿p tá»¥c vá»›i pháº§n TÃ i liá»‡u Bá»• sung vÃ  cÃ¡c hÃ¬nh áº£nh minh há»a thÃªm]

TÃ i liá»‡u Bá»• sung
A. Chi tiáº¿t Triá»ƒn khai
Pháº§n nÃ y má»Ÿ rá»™ng cÃ¡c chi tiáº¿t Ä‘Æ°á»£c giá»›i thiá»‡u ngáº¯n gá»n trong bÃ i bÃ¡o chÃ­nh. Nhá»¯ng chi tiáº¿t nÃ y bao gá»“m kÃ½ hiá»‡u, má»¥c tiÃªu huáº¥n luyá»‡n cÆ¡ báº£n, chá»‰ sá»‘ Ä‘á»™ lá»‡ch chuáº©n ná»™i suy (ISTD), vÃ  viá»‡c sá»­ dá»¥ng Null-text inversion (NTI) [42] cá»§a chÃºng tÃ´i cho ná»™i suy hÃ¬nh áº£nh thá»±c.

A.1. KÃ½ hiá»‡u
Stable Diffusion [59] sá»­ dá»¥ng má»™t pipeline khuáº¿ch tÃ¡n "latent" hiá»‡u quáº£. á» Ä‘Ã¢y "latent" Ä‘á» cáº­p Ä‘áº¿n viá»‡c sá»­ dá»¥ng má»™t VAE Ä‘Æ°á»£c huáº¥n luyá»‡n riÃªng [34] Ä‘á»ƒ nÃ©n má»™t hÃ¬nh áº£nh Ä‘áº§u vÃ o x0 thÃ nh biá»ƒu diá»…n khÃ´ng gian VAE z0 cá»§a nÃ³:
z0=E(x0),x0=D(z0), (16)
trong Ä‘Ã³ E vÃ  D Ä‘áº¡i diá»‡n cho bá»™ mÃ£ hÃ³a vÃ  giáº£i mÃ£ cá»§a VAE, tÆ°Æ¡ng á»©ng. Äá»ƒ Ä‘Æ¡n giáº£n, chÃºng tÃ´i loáº¡i trá»« quÃ¡ trÃ¬nh chuyá»ƒn Ä‘á»•i nÃ y vÃ  chá»‰ sá»­ dá»¥ng kÃ½ hiá»‡u dá»±a trÃªn "x" trong bÃ i bÃ¡o chÃ­nh. Máº·c dÃ¹ chÃºng tÃ´i chá»n Stable Diffusion lÃ m Ä‘Æ°á»ng cÆ¡ sá»Ÿ cá»§a chÃºng tÃ´i do tÃ­nh phá»• biáº¿n vÃ  hiá»‡u suáº¥t cao cá»§a nÃ³, pipeline huáº¥n luyá»‡n cá»§a chÃºng tÃ´i khÃ´ng Ä‘Æ°á»£c thiáº¿t káº¿ riÃªng cho cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n latent vÃ  tÆ°Æ¡ng thÃ­ch vá»›i cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n khÃ¡c.

A.2. Má»¥c tiÃªu Huáº¥n luyá»‡n CÆ¡ báº£n
Má»¥c tiÃªu huáº¥n luyá»‡n cá»§a Smooth Diffusion bao gá»“m hai thÃ nh pháº§n chÃ­nh: 1) má»™t má»¥c tiÃªu huáº¥n luyá»‡n cÆ¡ báº£n táº­p trung chá»§ yáº¿u vÃ o dá»± Ä‘oÃ¡n nhiá»…u nhÆ°ng linh hoáº¡t trong cÃ´ng thá»©c cho cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n khÃ¡c nhau, vÃ  2) thuáº­t ngá»¯ Äiá»u chá»‰nh Biáº¿n thiÃªn Tá»«ng bÆ°á»›c Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i. Trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i, má»¥c tiÃªu huáº¥n luyá»‡n cÆ¡ báº£n lÃ :
Lbase=Ex0,Ïµ,tâˆ¥Ïµâˆ’ÏµÎ¸(xt, t)âˆ¥22, (17)
Ä‘Ã¢y lÃ  má»™t má»¥c tiÃªu huáº¥n luyá»‡n Ä‘Æ°á»£c Ã¡p dá»¥ng phá»• biáº¿n trÃªn nhiá»u mÃ´ hÃ¬nh khuáº¿ch tÃ¡n, vÃ­ dá»¥, Stable Diffusion [59].

A.3. ISTD
Má»¥c tiÃªu cá»§a ISTD lÃ  Ä‘á»‹nh lÆ°á»£ng Ä‘á»™ lá»‡ch cá»§a cÃ¡c thay Ä‘á»•i khÃ´ng gian pixel cho cÃ¹ng nhá»¯ng thay Ä‘á»•i bÆ°á»›c cá»‘ Ä‘á»‹nh trong khÃ´ng gian latent. Má»™t Ä‘á»™ lá»‡ch tháº¥p hÆ¡n ngá»¥ Ã½ ráº±ng cÃ¡c latent Ä‘áº§u vÃ o vÃ  hÃ¬nh áº£nh Ä‘áº§u ra cÃ³ nhiá»u kháº£ nÄƒng thay Ä‘á»•i mÆ°á»£t mÃ  hÆ¡n. Trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i, chÃºng tÃ´i Ä‘áº§u tiÃªn ngáº«u nhiÃªn rÃºt 500 lá»i nháº¯c vÄƒn báº£n tá»« táº­p validation MS-COCO [36]. Äá»‘i vá»›i má»—i lá»i nháº¯c, sau Ä‘Ã³ chÃºng tÃ´i láº¥y máº«u hai nhiá»…u Gaussian ngáº«u nhiÃªn, Ïµa vÃ  Ïµb. Tiáº¿p theo, chÃºng tÃ´i thá»±c hiá»‡n ná»™i suy tuyáº¿n tÃ­nh cáº§u Ä‘á»“ng nháº¥t (slerp) giá»¯a Ïµa vÃ  Ïµb cho 11 láº§n, thay Ä‘á»•i tá»· lá»‡ há»—n há»£p Î· tá»« 0 Ä‘áº¿n 1:
ÏµÎ·= slerp( Ïµa,Ïµb, Î·), Î· = 0,0.1,0.2,Â·Â·Â·,1. (18)

ChÃºng tÃ´i sá»­ dá»¥ng mÃ´ hÃ¬nh khuáº¿ch tÃ¡n thá»­ nghiá»‡m Ä‘á»ƒ táº¡o ra 11 hÃ¬nh áº£nh Ä‘Æ°á»£c ná»™i suy {xÌ‚Î·0}1Î·=0 tá»« {ÏµÎ·}1Î·=0. LÆ°u Ã½ ráº±ng PhÆ°Æ¡ng trÃ¬nh 18 Ä‘áº£m báº£o ráº±ng cÃ¡c thay Ä‘á»•i khÃ´ng gian latent giá»¯a má»—i hai latent liá»n ká» (tá»©c lÃ , ÏµÎ· vÃ  ÏµÎ·+0.1) lÃ  giá»‘ng nhau. Do Ä‘Ã³, chÃºng tÃ´i tÃ­nh cÃ¡c khoáº£ng cÃ¡ch L2 giá»¯a má»—i hai hÃ¬nh áº£nh liá»n ká» (tá»©c lÃ , xÌ‚Î·0 vÃ  xÌ‚Î·+0.10) vÃ  tÃ­nh Ä‘á»™ lá»‡ch chuáº©n cá»§a cÃ¡c khoáº£ng cÃ¡ch nÃ y. Cuá»‘i cÃ¹ng, ISTD lÃ  trung bÃ¬nh cá»§a Ä‘á»™ lá»‡ch chuáº©n trÃªn 500 lá»i nháº¯c vÄƒn báº£n khÃ¡c nhau. Äá»ƒ so sÃ¡nh cÃ´ng báº±ng, cÃ¡c lá»i nháº¯c vÄƒn báº£n vÃ  nhiá»…u cho má»—i lá»i nháº¯c lÃ  giá»‘ng nhau cho cÃ¡c mÃ´ hÃ¬nh thá»­ nghiá»‡m khÃ¡c nhau.

A.4. NTI cho ná»™i suy hÃ¬nh áº£nh thá»±c
NTI ban Ä‘áº§u Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ biáº¿n Ä‘á»•i má»™t hÃ¬nh áº£nh thá»±c x0 thÃ nh má»™t latent xÌ‚T, cÃ¹ng vá»›i má»™t loáº¡t cÃ¡c embedding vÄƒn báº£n rá»—ng cÃ³ thá»ƒ há»c {âˆ…t}Tt=1 cho má»—i bÆ°á»›c t. Viá»‡c tá»‘i Æ°u hÃ³a cho má»—i âˆ…t Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ°:
minâˆ…tâˆ¥xÌ‚tâˆ’1âˆ’DDIM( xÌ‚t, t, Î¾,âˆ…t)âˆ¥22. (19)
trong Ä‘Ã³ {xÌ‚t}Tt=1 Ä‘áº¡i diá»‡n cho cÃ¡c hÃ¬nh áº£nh nhiá»…u trung gian Ä‘Æ°á»£c Æ°á»›c tÃ­nh bá»Ÿi DDIM inversion [68]. Äá»ƒ Ä‘Æ¡n giáº£n, DDIM( xÌ‚t, t, Î¾,âˆ…t) biá»ƒu thá»‹ quÃ¡ trÃ¬nh láº¥y máº«u DDIM táº¡i bÆ°á»›c t, sá»­ dá»¥ng embedding vÄƒn báº£n Î¾, embedding vÄƒn báº£n rá»—ng âˆ…t vÃ  tá»· lá»‡ hÆ°á»›ng dáº«n classifier-free w= 7.5.

Äá»‘i vá»›i ná»™i suy hÃ¬nh áº£nh thá»±c, chÃºng tÃ´i tá»‘i Æ°u hÃ³a má»™t loáº¡t chia sáº» {âˆ…t}Tt=1 cho hai hÃ¬nh áº£nh thá»±c, xa0 vÃ  xb0:
minâˆ…tâˆ¥xÌ‚atâˆ’1âˆ’DDIM( xÌ‚at, t, Î¾,âˆ…t)âˆ¥22+
âˆ¥xÌ‚btâˆ’1âˆ’DDIM(xÌ‚bt, t, Î¾,âˆ…t)âˆ¥22.(20)

Trong cÃ¡c thÃ­ nghiá»‡m cá»§a chÃºng tÃ´i, chÃºng tÃ´i chá»‰ ná»™i suy cÃ¡c latent xÌ‚aT vÃ  xÌ‚bT theo PhÆ°Æ¡ng trÃ¬nh 18 vÃ  sá»­ dá»¥ng cÃ¹ng embedding vÄƒn báº£n rá»—ng {âˆ…t}Tt=1 cho táº¥t cáº£ hÃ¬nh áº£nh Ä‘Æ°á»£c ná»™i suy.

B. Káº¿t quáº£ Bá»• sung
Pháº§n nÃ y cung cáº¥p káº¿t quáº£ thá»‹ giÃ¡c bá»• sung cá»§a Smooth Diffusion. ChÃºng tÃ´i hiá»ƒn thá»‹ káº¿t quáº£ ná»™i suy hÃ¬nh áº£nh trong HÃ¬nh 7 vÃ  HÃ¬nh 8, káº¿t quáº£ Ä‘áº£o ngÆ°á»£c vÃ  tÃ¡i táº¡o hÃ¬nh áº£nh trong HÃ¬nh 9, vÃ  káº¿t quáº£ chá»‰nh sá»­a hÃ¬nh áº£nh trong HÃ¬nh 10.

Kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng. ThÃ nh pháº§n LoRA cá»§a Smooth Diffusion váº«n cÃ³ thá»ƒ thÃ­ch á»©ng vá»›i cÃ¡c mÃ´ hÃ¬nh khÃ¡c chia sáº» cÃ¹ng kiáº¿n trÃºc vá»›i Stable Diffusion. Tuy nhiÃªn, hiá»‡u quáº£ cá»§a kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng nÃ y khÃ´ng Ä‘Æ°á»£c Ä‘áº£m báº£o. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ viá»‡c tÃ­ch há»£p thÃ nh pháº§n LoRA nÃ y vÃ o hai mÃ´ hÃ¬nh cá»™ng Ä‘á»“ng phá»• biáº¿n, RealisticVision-V2 [2] vÃ  OpenJourney-V4 [1]. NhÆ° Ä‘Æ°á»£c mÃ´ táº£ trong HÃ¬nh 8, viá»‡c tÃ­ch há»£p nÃ y cÅ©ng tÄƒng cÆ°á»ng tÃ­nh mÆ°á»£t mÃ  khÃ´ng gian latent cá»§a cÃ¡c mÃ´ hÃ¬nh nÃ y. Kháº£ nÄƒng tÃ¡i sá»­ dá»¥ng nÃ y lÃ m cho phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i loáº¡i bá» nhu cáº§u huáº¥n luyá»‡n láº·p Ä‘i láº·p láº¡i vÃ  trá»Ÿ thÃ nh má»™t mÃ´-Ä‘un cáº¯m vÃ  cháº¡y trÃªn nhiá»u mÃ´ hÃ¬nh khÃ¡c nhau.
