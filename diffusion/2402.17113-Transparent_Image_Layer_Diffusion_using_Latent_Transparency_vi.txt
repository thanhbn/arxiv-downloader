# Khuáº¿ch tÃ¡n táº§ng hÃ¬nh áº£nh trong suá»‘t sá»­ dá»¥ng Ä‘á»™ trong suá»‘t tiá»m áº©n

LVMIN ZHANG, Äáº¡i há»c Stanford, Hoa Ká»³
MANEESH AGRAWALA, Äáº¡i há»c Stanford, Hoa Ká»³

"Phá»¥ ná»¯ vá»›i tÃ³c rá»‘i, trong phÃ²ng ngá»§" "Gá»— Ä‘ang chÃ¡y, trÃªn bÃ n, á»Ÿ vÃ¹ng nÃ´ng thÃ´n"

Äáº§u ra há»—n há»£p Táº§ng Ä‘áº§u ra 1 Táº§ng Ä‘áº§u ra 2 Äáº§u ra há»—n há»£p Táº§ng Ä‘áº§u ra 1 Táº§ng Ä‘áº§u ra 2

HÃ¬nh 1. Táº¡o ra hÃ¬nh áº£nh vÃ  táº§ng trong suá»‘t. Vá»›i cÃ¡c lá»i nháº¯c vÄƒn báº£n Ä‘Ã£ cho (phÃ­a trÃªn), khung cÃ´ng tÃ¡c cá»§a chÃºng tÃ´i cÃ³ kháº£ nÄƒng táº¡o ra nhiá»u táº§ng vá»›i Ä‘á»™ trong suá»‘t. CÃ¡c táº§ng nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c há»—n há»£p Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh tÆ°Æ¡ng á»©ng vá»›i cÃ¡c lá»i nháº¯c. PhÃ³ng to Ä‘á»ƒ xem chi tiáº¿t bao gá»“m tÃ³c rá»‘i vÃ  lá»­a bÃ¡n trong suá»‘t.

ChÃºng tÃ´i trÃ¬nh bÃ y má»™t phÆ°Æ¡ng phÃ¡p cho phÃ©p cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n quy mÃ´ lá»›n táº¡o ra hÃ¬nh áº£nh trong suá»‘t. PhÆ°Æ¡ng phÃ¡p nÃ y cho phÃ©p táº¡o ra hÃ¬nh áº£nh trong suá»‘t Ä‘Æ¡n láº» hoáº·c nhiá»u táº§ng trong suá»‘t. PhÆ°Æ¡ng phÃ¡p há»c má»™t "Ä‘á»™ trong suá»‘t tiá»m áº©n" mÃ£ hÃ³a Ä‘á»™ trong suá»‘t kÃªnh alpha vÃ o Ä‘a táº¡p tiá»m áº©n cá»§a mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n. NÃ³ báº£o toÃ n cháº¥t lÆ°á»£ng sáºµn sÃ ng sáº£n xuáº¥t cá»§a mÃ´ hÃ¬nh khuáº¿ch tÃ¡n lá»›n báº±ng cÃ¡ch Ä‘iá»u chá»‰nh Ä‘á»™ trong suá»‘t Ä‘Æ°á»£c thÃªm vÃ o nhÆ° má»™t offset tiá»m áº©n vá»›i nhá»¯ng thay Ä‘á»•i tá»‘i thiá»ƒu Ä‘á»‘i vá»›i phÃ¢n phá»‘i tiá»m áº©n ban Ä‘áº§u cá»§a mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n. Theo cÃ¡ch nÃ y, báº¥t ká»³ mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n nÃ o cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh má»™t bá»™ táº¡o hÃ¬nh áº£nh trong suá»‘t báº±ng cÃ¡ch tinh chá»‰nh nÃ³ vá»›i khÃ´ng gian tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh. ChÃºng tÃ´i huáº¥n luyá»‡n mÃ´ hÃ¬nh vá»›i 1 triá»‡u cáº·p táº§ng hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c thu tháº­p báº±ng sÆ¡ Ä‘á»“ thu tháº­p cÃ³ con ngÆ°á»i trong vÃ²ng láº·p. ChÃºng tÃ´i cho tháº¥y ráº±ng Ä‘á»™ trong suá»‘t tiá»m áº©n cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho cÃ¡c bá»™ táº¡o hÃ¬nh áº£nh nguá»“n má»Ÿ khÃ¡c nhau, hoáº·c Ä‘Æ°á»£c thÃ­ch á»©ng vá»›i cÃ¡c há»‡ thá»‘ng kiá»ƒm soÃ¡t cÃ³ Ä‘iá»u kiá»‡n khÃ¡c nhau Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c cÃ¡c á»©ng dá»¥ng nhÆ° táº¡o táº§ng cÃ³ Ä‘iá»u kiá»‡n tiá»n cáº£nh/ná»n, táº¡o táº§ng chung, kiá»ƒm soÃ¡t cáº¥u trÃºc cá»§a ná»™i dung táº§ng, v.v. Má»™t nghiÃªn cá»©u ngÆ°á»i dÃ¹ng cho tháº¥y ráº±ng trong háº§u háº¿t cÃ¡c trÆ°á»ng há»£p (97%) ngÆ°á»i dÃ¹ng Æ°a thÃ­ch ná»™i dung trong suá»‘t Ä‘Æ°á»£c táº¡o ra báº£n Ä‘á»‹a cá»§a chÃºng tÃ´i hÆ¡n cÃ¡c giáº£i phÃ¡p ad-hoc trÆ°á»›c Ä‘Ã³ nhÆ° táº¡o ra vÃ  sau Ä‘Ã³ matting. NgÆ°á»i dÃ¹ng cÅ©ng bÃ¡o cÃ¡o ráº±ng cháº¥t lÆ°á»£ng cá»§a hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c táº¡o ra cá»§a chÃºng tÃ´i cÃ³ thá»ƒ so sÃ¡nh vá»›i cÃ¡c tÃ i sáº£n trong suá»‘t thÆ°Æ¡ng máº¡i thá»±c táº¿ nhÆ° Adobe Stock.

KhÃ¡i niá»‡m CCS: â€¢Tin há»c á»©ng dá»¥ng â†’Nghá»‡ thuáº­t táº¡o hÃ¬nh; Nghá»‡ thuáº­t truyá»n thÃ´ng.

Tá»« khÃ³a vÃ  cá»¥m tá»« bá»• sung: HÃ¬nh áº£nh trong suá»‘t, chá»‰nh sá»­a hÃ¬nh áº£nh, táº§ng hÃ¬nh áº£nh, khuáº¿ch tÃ¡n vÄƒn báº£n thÃ nh hÃ¬nh áº£nh

Äá»‹a chá»‰ tÃ¡c giáº£: Lvmin Zhang, lvmin@stanford.edu, Äáº¡i há»c Stanford, Hoa Ká»³; Maneesh Agrawala, maneesh@cs.stanford.edu, Äáº¡i há»c Stanford, Hoa Ká»³.

ÄÆ°á»£c phÃ©p táº¡o báº£n sao ká»¹ thuáº­t sá»‘ hoáº·c báº£n cá»©ng cá»§a táº¥t cáº£ hoáº·c má»™t pháº§n cÃ´ng viá»‡c nÃ y Ä‘á»ƒ sá»­ dá»¥ng cÃ¡ nhÃ¢n hoáº·c lá»›p há»c mÃ  khÃ´ng pháº£i tráº£ phÃ­ vá»›i Ä‘iá»u kiá»‡n cÃ¡c báº£n sao khÃ´ng Ä‘Æ°á»£c táº¡o ra hoáº·c phÃ¢n phá»‘i Ä‘á»ƒ kiáº¿m lá»£i nhuáº­n hoáº·c lá»£i tháº¿ thÆ°Æ¡ng máº¡i vÃ  cÃ¡c báº£n sao pháº£i mang thÃ´ng bÃ¡o nÃ y vÃ  trÃ­ch dáº«n Ä‘áº§y Ä‘á»§ trÃªn trang Ä‘áº§u tiÃªn. Báº£n quyá»n cho cÃ¡c thÃ nh pháº§n cá»§a cÃ´ng viá»‡c nÃ y thuá»™c sá»Ÿ há»¯u cá»§a nhá»¯ng ngÆ°á»i khÃ¡c ngoÃ i (cÃ¡c) tÃ¡c giáº£ pháº£i Ä‘Æ°á»£c tÃ´n trá»ng. TrÃ­ch dáº«n vá»›i tÃ­n dá»¥ng Ä‘Æ°á»£c cho phÃ©p. Äá»ƒ sao chÃ©p theo cÃ¡ch khÃ¡c, hoáº·c xuáº¥t báº£n láº¡i, Ä‘á»ƒ Ä‘Äƒng trÃªn mÃ¡y chá»§ hoáº·c phÃ¢n phá»‘i láº¡i danh sÃ¡ch, cáº§n cÃ³ sá»± cho phÃ©p trÆ°á»›c cá»¥ thá»ƒ vÃ /hoáº·c phÃ­. YÃªu cáº§u quyá»n tá»« permissions@acm.org.

Â©2024 Báº£n quyá»n thuá»™c vá» (cÃ¡c) chá»§ sá»Ÿ há»¯u/tÃ¡c giáº£. Quyá»n xuáº¥t báº£n Ä‘Æ°á»£c cáº¥p phÃ©p cho ACM.
ACM 0730-0301/2024/7-ART100
https://doi.org/10.1145/3658150

Äá»‹nh dáº¡ng tham chiáº¿u ACM:
Lvmin Zhang vÃ  Maneesh Agrawala. 2024. Khuáº¿ch tÃ¡n táº§ng hÃ¬nh áº£nh trong suá»‘t sá»­ dá»¥ng Ä‘á»™ trong suá»‘t tiá»m áº©n. ACM Trans. Graph. 43, 4, BÃ i bÃ¡o 100 (thÃ¡ng 7 nÄƒm 2024), 38 trang. https://doi.org/10.1145/3658150

1 GIá»šI THIá»†U

Máº·c dÃ¹ cÃ¡c mÃ´ hÃ¬nh quy mÃ´ lá»›n Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh Ä‘Ã£ trá»Ÿ thÃ nh ná»n táº£ng trong thá»‹ giÃ¡c mÃ¡y tÃ­nh vÃ  Ä‘á»“ há»a, nhÆ°ng Ä‘Ã¡ng ngáº¡c nhiÃªn lÃ  ráº¥t Ã­t chÃº Ã½ nghiÃªn cá»©u Ä‘Æ°á»£c dÃ nh cho viá»‡c táº¡o ná»™i dung phÃ¢n táº§ng hoáº·c táº¡o hÃ¬nh áº£nh trong suá»‘t. TÃ¬nh huá»‘ng nÃ y trÃ¡i ngÆ°á»£c hoÃ n toÃ n vá»›i nhu cáº§u thá»‹ trÆ°á»ng Ä‘Ã¡ng ká»ƒ. Pháº§n lá»›n pháº§n má»m vÃ  quy trÃ¬nh chá»‰nh sá»­a ná»™i dung thá»‹ giÃ¡c dá»±a trÃªn táº§ng, phá»¥ thuá»™c nhiá»u vÃ o cÃ¡c yáº¿u tá»‘ trong suá»‘t hoáº·c phÃ¢n táº§ng Ä‘á»ƒ táº¡o ra vÃ  sÃ¡ng táº¡o ná»™i dung.

CÃ¡c yáº¿u tá»‘ chÃ­nh gÃ³p pháº§n vÃ o khoáº£ng cÃ¡ch nghiÃªn cá»©u nÃ y lÃ  thiáº¿u dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  khÃ³ khÄƒn trong viá»‡c thao tÃ¡c biá»ƒu diá»…n dá»¯ liá»‡u cá»§a cÃ¡c bá»™ táº¡o hÃ¬nh áº£nh quy mÃ´ lá»›n hiá»‡n cÃ³. CÃ¡c yáº¿u tá»‘ hÃ¬nh áº£nh trong suá»‘t cháº¥t lÆ°á»£ng cao trÃªn Internet thÆ°á»ng Ä‘Æ°á»£c lÆ°u trá»¯ bá»Ÿi cÃ¡c kho hÃ¬nh áº£nh thÆ°Æ¡ng máº¡i vá»›i quyá»n truy cáº­p háº¡n cháº¿ (vÃ  tá»‘n kÃ©m), trÃ¡i ngÆ°á»£c vá»›i cÃ¡c bá»™ dá»¯ liá»‡u vÄƒn báº£n-hÃ¬nh áº£nh Ä‘Ã£ bao gá»“m hÃ ng tá»· hÃ¬nh áº£nh (vÃ­ dá»¥, LAION [Schuhmann et al.2022]). CÃ¡c bá»™ dá»¯ liá»‡u hÃ¬nh áº£nh trong suá»‘t nguá»“n má»Ÿ lá»›n nháº¥t thÆ°á»ng cÃ³ kÃ­ch thÆ°á»›c dÆ°á»›i 50K (vÃ­ dá»¥, DIM [Xu et al.2017] bao gá»“m 45.500 hÃ¬nh áº£nh trong suá»‘t). Trong khi Ä‘Ã³, háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh táº¡o hÃ¬nh áº£nh nguá»“n má»Ÿ, vÃ­ dá»¥, Stable Diffusion, lÃ  cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n nháº¡y cáº£m vá»›i biá»ƒu diá»…n dá»¯ liá»‡u khÃ´ng gian tiá»m áº©n cá»§a chÃºng. Ngay cáº£ nhá»¯ng thay Ä‘á»•i nhá» Ä‘á»‘i vá»›i phÃ¢n phá»‘i tiá»m áº©n cÅ©ng cÃ³ thá»ƒ lÃ m suy giáº£m nghiÃªm trá»ng viá»‡c suy luáº­n hoáº·c tinh chá»‰nh. VÃ­ dá»¥, Stable Diffusion 1.5 vÃ  XL sá»­ dá»¥ng cÃ¡c khÃ´ng gian tiá»m áº©n khÃ¡c nhau, vÃ  viá»‡c tinh chá»‰nh vá»›i cÃ¡c tiá»m áº©n khÃ´ng khá»›p cÃ³ thá»ƒ gÃ¢y ra sá»± suy giáº£m Ä‘Ã¡ng ká»ƒ trong cháº¥t lÆ°á»£ng hÃ¬nh áº£nh Ä‘áº§u ra [Stability 2022b]. Äiá»u nÃ y thÃªm vÃ o thÃ¡ch thá»©c cá»§a viá»‡c thao tÃ¡c biá»ƒu diá»…n dá»¯ liá»‡u cá»§a cÃ¡c mÃ´ hÃ¬nh hiá»‡n cÃ³ Ä‘á»ƒ há»— trá»£ cÃ¡c Ä‘á»‹nh dáº¡ng bá»• sung nhÆ° hÃ¬nh áº£nh trong suá»‘t.

ChÃºng tÃ´i trÃ¬nh bÃ y má»™t phÆ°Æ¡ng phÃ¡p "Ä‘á»™ trong suá»‘t tiá»m áº©n" cho phÃ©p cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n quy mÃ´ lá»›n táº¡o ra hÃ¬nh áº£nh trong suá»‘t cÅ©ng nhÆ° nhiá»u táº§ng trong suá»‘t. PhÆ°Æ¡ng phÃ¡p nÃ y mÃ£ hÃ³a Ä‘á»™ trong suá»‘t hÃ¬nh áº£nh thÃ nh má»™t offset tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh má»™t cÃ¡ch rÃµ rÃ ng Ä‘á»ƒ trÃ¡nh lÃ m giÃ¡n Ä‘oáº¡n phÃ¢n phá»‘i tiá»m áº©n. Äá»™ trong suá»‘t tiá»m áº©n Ä‘Æ°á»£c mÃ£ hÃ³a vÃ  giáº£i mÃ£ bá»Ÿi cÃ¡c mÃ´ hÃ¬nh Ä‘á»™c láº­p bÃªn ngoÃ i, Ä‘áº£m báº£o ráº±ng bá»™ mÃ£ hÃ³a/giáº£i mÃ£ tiá»m áº©n ban Ä‘áº§u Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n Ä‘Æ°á»£c báº£o toÃ n, Ä‘á»ƒ duy trÃ¬ káº¿t quáº£ cháº¥t lÆ°á»£ng cao cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiÃªn tiáº¿n. Äá»ƒ táº¡o ra nhiá»u táº§ng cÃ¹ng nhau, chÃºng tÃ´i sá»­ dá»¥ng má»™t cÆ¡ cháº¿ chÃº Ã½ chia sáº» Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n vÃ  há»—n há»£p hÃ i hÃ²a giá»¯a cÃ¡c táº§ng hÃ¬nh áº£nh, vÃ  chÃºng tÃ´i huáº¥n luyá»‡n LoRA Ä‘á»ƒ thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh vá»›i cÃ¡c Ä‘iá»u kiá»‡n táº§ng khÃ¡c nhau.

ChÃºng tÃ´i sá»­ dá»¥ng má»™t sÆ¡ Ä‘á»“ cÃ³ con ngÆ°á»i trong vÃ²ng láº·p Ä‘á»ƒ huáº¥n luyá»‡n khung cÃ´ng tÃ¡c cá»§a chÃºng tÃ´i vÃ  thu tháº­p dá»¯ liá»‡u Ä‘á»“ng thá»i. ChÃºng tÃ´i hoÃ n thiá»‡n quy mÃ´ bá»™ dá»¯ liá»‡u cá»§a chÃºng tÃ´i á»Ÿ má»©c 1 triá»‡u hÃ¬nh áº£nh trong suá»‘t, bao gá»“m sá»± Ä‘a dáº¡ng vá» chá»§ Ä‘á» ná»™i dung vÃ  phong cÃ¡ch. Sau Ä‘Ã³, chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p tiÃªn tiáº¿n nháº¥t Ä‘á»ƒ má»Ÿ rá»™ng bá»™ dá»¯ liá»‡u thÃ nh cÃ¡c máº«u Ä‘a táº§ng. Bá»™ dá»¯ liá»‡u nÃ y khÃ´ng chá»‰ cho phÃ©p huáº¥n luyá»‡n cÃ¡c bá»™ táº¡o hÃ¬nh áº£nh trong suá»‘t mÃ  cÃ²n cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c á»©ng dá»¥ng khÃ¡c nhau nhÆ° táº¡o cÃ³ Ä‘iá»u kiá»‡n ná»n/tiá»n cáº£nh, táº¡o cÃ³ hÆ°á»›ng dáº«n cáº¥u trÃºc, chuyá»ƒn Ä‘á»•i phong cÃ¡ch, v.v.

CÃ¡c thÃ­ nghiá»‡m cho tháº¥y ráº±ng trong pháº§n lá»›n cÃ¡c trÆ°á»ng há»£p (97%), ngÆ°á»i dÃ¹ng Æ°a thÃ­ch ná»™i dung trong suá»‘t Ä‘Æ°á»£c táº¡o ra báº£n Ä‘á»‹a bá»Ÿi phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i hÆ¡n cÃ¡c giáº£i phÃ¡p ad-hoc trÆ°á»›c Ä‘Ã³ nhÆ° táº¡o-sau-Ä‘Ã³-matting. Khi chÃºng tÃ´i so sÃ¡nh cháº¥t lÆ°á»£ng cá»§a káº¿t quáº£ Ä‘Æ°á»£c táº¡o ra cá»§a chÃºng tÃ´i vá»›i káº¿t quáº£ tÃ¬m kiáº¿m tá»« cÃ¡c trang tÃ i sáº£n trong suá»‘t thÆ°Æ¡ng máº¡i nhÆ° Adobe Stock, tá»· lá»‡ Æ°a thÃ­ch cá»§a ngÆ°á»i dÃ¹ng cho tháº¥y ráº±ng cháº¥t lÆ°á»£ng cÃ³ thá»ƒ so sÃ¡nh Ä‘Æ°á»£c.

TÃ³m láº¡i, chÃºng tÃ´i (1) Ä‘á» xuáº¥t "Ä‘á»™ trong suá»‘t tiá»m áº©n", má»™t phÆ°Æ¡ng phÃ¡p cho phÃ©p cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n quy mÃ´ lá»›n táº¡o ra hÃ¬nh áº£nh trong suá»‘t Ä‘Æ¡n láº» hoáº·c nhiá»u táº§ng trong suá»‘t, (2) chÃºng tÃ´i trÃ¬nh bÃ y má»™t cÆ¡ cháº¿ chÃº Ã½ chia sáº» Ä‘á»ƒ táº¡o ra cÃ¡c táº§ng vá»›i há»—n há»£p nháº¥t quÃ¡n vÃ  hÃ i hÃ²a, vÃ  (3) chÃºng tÃ´i trÃ¬nh bÃ y má»™t mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n Ä‘á»ƒ táº¡o hÃ¬nh áº£nh trong suá»‘t, hai LoRA Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n Ä‘á»ƒ táº¡o nhiá»u táº§ng, cÅ©ng nhÆ° má»™t sá»‘ kiáº¿n trÃºc ablative bá»• sung cho viá»‡c táº¡o Ä‘a táº§ng.

2 CÃ”NG VIá»†C LIÃŠN QUAN

2.1 áº¨n hÃ¬nh áº£nh bÃªn trong nhiá»…u loáº¡n

NghiÃªn cá»©u trong nhiá»u lÄ©nh vá»±c chá»‰ ra má»™t hiá»‡n tÆ°á»£ng: máº¡ng nÆ¡-ron cÃ³ kháº£ nÄƒng "áº©n" cÃ¡c Ä‘áº·c trÆ°ng trong nhiá»…u loáº¡n bÃªn trong cÃ¡c Ä‘áº·c trÆ°ng hiá»‡n cÃ³ mÃ  khÃ´ng thay Ä‘á»•i phÃ¢n phá»‘i Ä‘áº·c trÆ°ng tá»•ng thá»ƒ, vÃ­ dá»¥, áº©n má»™t hÃ¬nh áº£nh bÃªn trong má»™t hÃ¬nh áº£nh khÃ¡c thÃ´ng qua cÃ¡c nhiá»…u loáº¡n pixel nhá», khÃ´ng thá»ƒ nhÃ¬n tháº¥y. Má»™t thÃ­ nghiá»‡m CycleGAN [Zhu et al.2017] Ä‘iá»ƒn hÃ¬nh giá»›i thiá»‡u face-to-ramen, nÆ¡i nháº­n dáº¡ng khuÃ´n máº·t con ngÆ°á»i cÃ³ thá»ƒ Ä‘Æ°á»£c áº©n trong má»™t bá»©c áº£nh mÃ¬ ramen. TÆ°Æ¡ng tá»±, downscaling cÃ³ thá»ƒ Ä‘áº£o ngÆ°á»£c [Xiao et al.2020] vÃ  grayscale cÃ³ thá»ƒ Ä‘áº£o ngÆ°á»£c [Xia et al.2018] cho tháº¥y ráº±ng máº¡ng nÆ¡-ron cÃ³ thá»ƒ áº©n má»™t hÃ¬nh áº£nh lá»›n bÃªn trong má»™t hÃ¬nh áº£nh nhá» hÆ¡n, hoáº·c áº©n má»™t hÃ¬nh áº£nh Ä‘áº§y mÃ u sáº¯c bÃªn trong má»™t hÃ¬nh áº£nh grayscale, vÃ  sau Ä‘Ã³ tÃ¡i táº¡o láº¡i hÃ¬nh áº£nh ban Ä‘áº§u. Trong má»™t thÃ­ nghiá»‡m khÃ¡c Ä‘Æ°á»£c xÃ¡c minh rá»™ng rÃ£i, Goodfellow et al.[2015] cho tháº¥y ráº±ng cÃ¡c tÃ­n hiá»‡u vÃ­ dá»¥ Ä‘á»‘i nghá»‹ch cÃ³ thá»ƒ Ä‘Æ°á»£c áº©n bÃªn trong nhiá»…u loáº¡n Ä‘áº·c trÆ°ng Ä‘á»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n hÃ nh vi cá»§a cÃ¡c máº¡ng nÆ¡-ron khÃ¡c. Trong bÃ i bÃ¡o nÃ y, "Ä‘á»™ trong suá»‘t tiá»m áº©n" Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i sá»­ dá»¥ng cÃ¡c nguyÃªn táº¯c tÆ°Æ¡ng tá»±: áº©n cÃ¡c Ä‘áº·c trÆ°ng Ä‘á»™ trong suá»‘t hÃ¬nh áº£nh bÃªn trong má»™t nhiá»…u loáº¡n nhá» Ä‘Æ°á»£c thÃªm vÃ o khÃ´ng gian tiá»m áº©n cá»§a Stable Diffusion [Stability 2022a], trong khi cÃ¹ng lÃºc trÃ¡nh thay Ä‘á»•i phÃ¢n phá»‘i tá»•ng thá»ƒ cá»§a khÃ´ng gian tiá»m áº©n.

2.2 MÃ´ hÃ¬nh xÃ¡c suáº¥t khuáº¿ch tÃ¡n vÃ  khuáº¿ch tÃ¡n tiá»m áº©n

MÃ´ hÃ¬nh xÃ¡c suáº¥t khuáº¿ch tÃ¡n [Sohl-Dickstein et al.2015] vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p huáº¥n luyá»‡n vÃ  láº¥y máº«u liÃªn quan nhÆ° MÃ´ hÃ¬nh xÃ¡c suáº¥t khuáº¿ch tÃ¡n khá»­ nhiá»…u (DDPM) [Ho et al.2020], MÃ´ hÃ¬nh ngáº§m khuáº¿ch tÃ¡n khá»­ nhiá»…u (DDIM) [Song et al.2021], vÃ  khuáº¿ch tÃ¡n dá»±a trÃªn Ä‘iá»ƒm sá»‘ [Song et al.2020] Ä‘Ã³ng gÃ³p vÃ o ná»n táº£ng cá»§a cÃ¡c bá»™ táº¡o hÃ¬nh áº£nh quy mÃ´ lá»›n gáº§n Ä‘Ã¢y. CÃ¡c phÆ°Æ¡ng phÃ¡p khuáº¿ch tÃ¡n hÃ¬nh áº£nh sá»›m thÆ°á»ng trá»±c tiáº¿p sá»­ dá»¥ng mÃ u sáº¯c pixel lÃ m dá»¯ liá»‡u huáº¥n luyá»‡n [Kong and Ping 2021; San-Roman et al.2021; Song et al.2021]. TrÃ¡i láº¡i, MÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n (LDM) [Rombach et al.2022] hoáº¡t Ä‘á»™ng trong khÃ´ng gian tiá»m áº©n vÃ  Ä‘Ã£ Ä‘Æ°á»£c chá»©ng minh cho phÃ©p huáº¥n luyá»‡n dá»… dÃ ng hÆ¡n trong khi giáº£m yÃªu cáº§u tÃ­nh toÃ¡n. PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘Ã£ Ä‘Æ°á»£c má»Ÿ rá»™ng thÃªm Ä‘á»ƒ táº¡o ra Stable Diffusion [Stability 2022a]. Gáº§n Ä‘Ã¢y, eDiff-I [Balaji et al.2022] Ä‘Ã£ sá»­ dá»¥ng má»™t ensemble cá»§a nhiá»u Ä‘iá»u kiá»‡n bao gá»“m bá»™ mÃ£ hÃ³a vÄƒn báº£n T5 [Raffel et al.2019], bá»™ mÃ£ hÃ³a embedding vÄƒn báº£n vÃ  hÃ¬nh áº£nh CLIP [Ilharco et al.2021]. Versatile Diffusion [Xu et al.2022] Ã¡p dá»¥ng má»™t khung khuáº¿ch tÃ¡n Ä‘a má»¥c Ä‘Ã­ch Ä‘á»ƒ xá»­ lÃ½ vÄƒn báº£n, hÃ¬nh áº£nh, vÃ  cÃ¡c biáº¿n thá»ƒ trong má»™t mÃ´ hÃ¬nh duy nháº¥t.

2.3 MÃ´ hÃ¬nh khuáº¿ch tÃ¡n tÃ¹y chá»‰nh vÃ  chá»‰nh sá»­a hÃ¬nh áº£nh

CÃ¡c phÆ°Æ¡ng phÃ¡p sá»›m Ä‘á»ƒ tÃ¹y chá»‰nh mÃ´ hÃ¬nh khuáº¿ch tÃ¡n Ä‘Ã£ táº­p trung vÃ o hÆ°á»›ng dáº«n vÄƒn báº£n [Avrahami et al.2022; Kim et al.2022a; Nichol et al.2021]. CÃ¡c thuáº­t toÃ¡n khuáº¿ch tÃ¡n hÃ¬nh áº£nh cÅ©ng tá»± nhiÃªn há»— trá»£ inpainting [Avrahami et al.2022; Ramesh et al.2022]. Textual Inversion [Gal et al.2022] vÃ  DreamBooth [Ruiz et al.2022] cÃ³ thá»ƒ cÃ¡ nhÃ¢n hÃ³a ná»™i dung cá»§a káº¿t quáº£ Ä‘Æ°á»£c táº¡o ra dá»±a trÃªn má»™t táº­p nhá» cÃ¡c hÃ¬nh áº£nh máº«u vá» cÃ¹ng má»™t chá»§ Ä‘á» hoáº·c Ä‘á»‘i tÆ°á»£ng. Gáº§n Ä‘Ã¢y, cÃ¡c mÃ´ hÃ¬nh kiá»ƒm soÃ¡t cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thÃªm cÃ¡c Ä‘iá»u kiá»‡n bá»• sung cho viá»‡c táº¡o ra cÃ¡c mÃ´ hÃ¬nh vÄƒn báº£n thÃ nh hÃ¬nh áº£nh, vÃ­ dá»¥, ControlNet [Zhang and Agrawala 2023], T2I-adapter nháº¹ [Mou et al.2023], v.v. IP-Adapter [Ye et al.2023] sá»­ dá»¥ng cÆ¡ cháº¿ chÃº Ã½ chÃ©o Ä‘á»ƒ tÃ¡ch biá»‡t cÃ¡c Ä‘áº·c trÆ°ng vÄƒn báº£n vÃ  hÃ¬nh áº£nh, cho phÃ©p cÃ¡c tÃ­n hiá»‡u kiá»ƒm soÃ¡t cá»§a hÃ¬nh áº£nh tham chiáº¿u nhÆ° má»™t prompt thá»‹ giÃ¡c. [Li et al.2023a] sá»­ dá»¥ng máº·t náº¡ trong cÃ¡c Ä‘áº·c trÆ°ng máº¡ng nÆ¡-ron Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ¹ng ngá»¯ nghÄ©a. CÃ¡c phÆ°Æ¡ng phÃ¡p dá»±a trÃªn inversion cÅ©ng phá»• biáº¿n trong chá»‰nh sá»­a hÃ¬nh áº£nh. LÃ½ thuyáº¿t DDPM [Ho et al.2020] chá»‰ ra ráº±ng thuáº­t toÃ¡n khuáº¿ch tÃ¡n xÃ¢y dá»±ng dá»¯ liá»‡u vá»›i cÃ¡c biáº¿n thá»ƒ nhá» tÃ­ch lÅ©y vÃ  nhá»¯ng biáº¿n thá»ƒ Ä‘Ã³, cÃ³ Ä‘iá»u kiá»‡n trÃªn nhiá»…u, cÃ³ thá»ƒ Ä‘Æ°á»£c thao tÃ¡c vá»›i tá»‘i Æ°u hÃ³a Ä‘áº£o ngÆ°á»£c. Mokady et al.[2023] cho tháº¥y ráº±ng DDIM inversion cÃ³ thá»ƒ tá»‘i Æ°u hÃ³a hÃ¬nh áº£nh mÃ  khÃ´ng cáº§n Ä‘áº§u vÃ o Ä‘Æ°á»£c táº¡o ra bá»Ÿi má»™t quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n Ä‘Ã£ biáº¿t trÆ°á»›c Ä‘Ã³ (null-text embedding). Cao et al.[2023] vÃ  Narek et al.[2023] thao tÃ¡c cÃ¡c Ä‘áº·c trÆ°ng chÃº Ã½ chÃ©o khÃ´ng gian cá»§a cÃ¡c táº§ng Stable Diffusion cÃ¹ng vá»›i DDPM inversion. Hertz et al.[2023] chá»‰nh sá»­a cÃ¡c kÃ­ch hoáº¡t chÃº Ã½ cá»§a hÃ¬nh áº£nh Ä‘áº§u vÃ o vá»›i cÃ¡c prompt vÄƒn báº£n do ngÆ°á»i dÃ¹ng cung cáº¥p vÃ  Ä‘Æ°a chÃºng trá»Ÿ láº¡i mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. DiffEdit [2023] táº¡o ra máº·t náº¡ vÃ¹ng Ä‘á»ƒ chá»‰nh sá»­a hÃ¬nh áº£nh, vá»›i hÃ¬nh áº£nh Ä‘áº§u vÃ o vÃ  prompt ngÆ°á»i dÃ¹ng. Diffusion-CLIP [Kim et al.2022b] tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n vá»›i loss CLIP chá»‘ng láº¡i prompt. Imagic [Kawar et al.2023] Ä‘á»“ng thá»i tá»‘i Æ°u hÃ³a embedding vÄƒn báº£n cá»§a prompt ngÆ°á»i dÃ¹ng vÃ  gradient mÃ´ hÃ¬nh Ä‘á»ƒ tÃ¡i táº¡o hÃ¬nh áº£nh cho cÃ¡c á»©ng dá»¥ng chá»‰nh sá»­a hÃ¬nh áº£nh.

2.4 Xá»­ lÃ½ táº§ng hÃ¬nh áº£nh trong suá»‘t

Xá»­ lÃ½ hÃ¬nh áº£nh trong suá»‘t cÃ³ liÃªn quan cháº·t cháº½ Ä‘áº¿n phÃ¢n tÃ¡ch hÃ¬nh áº£nh, trÃ­ch xuáº¥t táº§ng, xá»­ lÃ½ báº£ng mÃ u, cÅ©ng nhÆ° matting hÃ¬nh áº£nh [Aksoy et al.2017a, 2016; Tang et al.2019]. PhÃ¢n tÃ¡ch dá»±a trÃªn mÃ u sáº¯c Ä‘iá»ƒn hÃ¬nh cÃ³ thá»ƒ Ä‘Æ°á»£c xem nhÆ° má»™t bÃ i toÃ¡n hÃ¬nh há»c khÃ´ng gian mÃ u RGB [Du et al.2023; Tan et al.2019, 2015, 2018, 2016]. Nhá»¯ng Ã½ tÆ°á»Ÿng nÃ y cÅ©ng Ä‘Ã£ Ä‘Æ°á»£c má»Ÿ rá»™ng Ä‘áº¿n viá»‡c há»—n há»£p nÃ¢ng cao hÆ¡n cá»§a cÃ¡c táº§ng hÃ¬nh áº£nh [Koyama and Goto 2018]. TÃ¡ch mÃ u dá»±a trÃªn unmixing cÅ©ng Ä‘Ã³ng gÃ³p vÃ o phÃ¢n tÃ¡ch hÃ¬nh áº£nh [Aksoy et al.2017b], vÃ  cÃ¡c Ä‘áº·c trÆ°ng ngá»¯ nghÄ©a cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong phÃ¢n Ä‘oáº¡n má»m hÃ¬nh áº£nh [Aksoy et al.2018]. ChÃºng tÃ´i so sÃ¡nh phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vá»›i má»™t sá»‘ phÆ°Æ¡ng phÃ¡p matting dá»±a trÃªn deep learning tiÃªn tiáº¿n trong cÃ¡c thÃ­ nghiá»‡m vÃ  tháº£o luáº­n cá»§a chÃºng tÃ´i. PPMatting [Chen et al.2022] lÃ  má»™t mÃ´ hÃ¬nh matting hÃ¬nh áº£nh máº¡ng nÆ¡-ron Ä‘Æ°á»£c huáº¥n luyá»‡n tá»« Ä‘áº§u sá»­ dá»¥ng cÃ¡c bá»™ dá»¯ liá»‡u matting tiÃªu chuáº©n. Matting Anything [Li et al.2023b] lÃ  má»™t mÃ´ hÃ¬nh matting hÃ¬nh áº£nh sá»­ dá»¥ng Segment Anything Model (SAM) [Kirillov et al.2023] lÃ m backbone. VitMatte [Yao et al.2024] lÃ  má»™t phÆ°Æ¡ng phÃ¡p matting dá»±a trÃªn tri-map sá»­ dá»¥ng Vision Transformer (ViT). Text2Layer [Zhang et al.2023] cá»‘ gáº¯ng sá»­ dá»¥ng hÆ°á»›ng dáº«n phÃ¢n Ä‘oáº¡n tiá»n cáº£nh Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u á»©ng phÃ¢n táº§ng trong cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n, vÃ  chá»‰ ra ráº±ng nÃºt tháº¯t cá»• chai chÃ­nh cá»§a nÃ³ lÃ  cháº¥t lÆ°á»£ng phÆ°Æ¡ng phÃ¡p matting tiá»n cáº£nh vÃ¬ má»¥c tiÃªu há»c táº­p cá»§a nÃ³ Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« phÃ¢n Ä‘oáº¡n hÃ¬nh áº£nh cá»§a cÃ¡c mÃ´ hÃ¬nh matting. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i báº¯t Ä‘áº§u tá»« viá»‡c táº¡o ra hÃ¬nh áº£nh trong suá»‘t báº£n Ä‘á»‹a thay vÃ¬ xá»­ lÃ½ háº­u ká»³ cá»§a matting hÃ¬nh áº£nh, vÃ  vá» cÆ¡ báº£n khÃ¡c biá»‡t vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p trÆ°á»›c Ä‘Ã³ sá»­ dá»¥ng matting nhÆ° xá»­ lÃ½ háº­u ká»³ cá»§a Ä‘áº§u ra mÃ´ hÃ¬nh hoáº·c sá»­ dá»¥ng matting Ä‘á»ƒ tá»•ng há»£p bá»™ dá»¯ liá»‡u.

2.5 HÃ i hÃ²a hÃ¬nh áº£nh

Há»—n há»£p hÃ i hÃ²a cá»§a cÃ¡c táº§ng hÃ¬nh áº£nh trong suá»‘t cÃ³ liÃªn quan cháº·t cháº½ Ä‘áº¿n nghiÃªn cá»©u hÃ i hÃ²a hÃ¬nh áº£nh. Äáº¡t Ä‘Æ°á»£c "sá»± hÃ i hÃ²a" thÆ°á»ng Ä‘Æ°á»£c xem nhÆ° má»™t bÃ i toÃ¡n tÆ°Æ¡ng quan mÃ u sáº¯c, Ä‘á»™ tÆ°Æ¡ng pháº£n, vÃ  cÃ¡c thÃ nh pháº§n phong cÃ¡ch giá»¯a tiá»n cáº£nh vÃ  ná»n Ä‘á»ƒ Ä‘áº£m báº£o diá»‡n máº¡o tá»± nhiÃªn vÃ  thÃ nh pháº§n nháº¥t quÃ¡n. CÃ¡c phÆ°Æ¡ng phÃ¡p deep learning [Chen et al.2023; Guerreiro et al.2023; Guo et al.2021; Tan et al.2023; Tsai et al.2017; Zhu et al.2015] Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» xuáº¥t Ä‘á»ƒ hÃ i hÃ²a hÃ¬nh áº£nh, sá»­ dá»¥ng cÃ¡c bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c chÃº thÃ­ch [Cong et al.2020; Niu et al.2023]. Nhá»¯ng cÃ´ng trÃ¬nh nÃ y sá»­ dá»¥ng kháº£ nÄƒng há»c táº­p cá»§a máº¡ng nÆ¡-ron Ä‘á»ƒ thu Ä‘Æ°á»£c kiáº¿n thá»©c tiá»n nghiá»‡m vá» hÃ i hÃ²a.

3 PHÆ¯Æ NG PHÃP

PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cho phÃ©p má»™t MÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n (LDM), nhÆ° Stable Diffusion, táº¡o ra hÃ¬nh áº£nh trong suá»‘t, vÃ  sau Ä‘Ã³ má»Ÿ rá»™ng mÃ´ hÃ¬nh Ä‘á»ƒ táº¡o ra nhiá»u táº§ng trong suá»‘t cÃ¹ng nhau. Trong pháº§n 3.1, chÃºng tÃ´i giá»›i thiá»‡u phÆ°Æ¡ng phÃ¡p Ä‘iá»u chá»‰nh khÃ´ng gian tiá»m áº©n LDM Ä‘á»ƒ há»— trá»£ mÃ£ hÃ³a/giáº£i mÃ£ hÃ¬nh áº£nh trong suá»‘t. Trong pháº§n 3.2, chÃºng tÃ´i thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vá»›i khÃ´ng gian tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh trong suá»‘t. Trong pháº§n 3.3, chÃºng tÃ´i mÃ´ táº£ phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ táº¡o táº§ng chung hoáº·c cÃ³ Ä‘iá»u kiá»‡n. Cuá»‘i cÃ¹ng, chÃºng tÃ´i trÃ¬nh bÃ y chi tiáº¿t vá» chuáº©n bá»‹ bá»™ dá»¯ liá»‡u vÃ  chi tiáº¿t triá»ƒn khai cho huáº¥n luyá»‡n máº¡ng nÆ¡-ron trong pháº§n 3.4.

Äá»‹nh nghÄ©a. Äá»ƒ lÃ m rÃµ viá»‡c trÃ¬nh bÃ y, trÆ°á»›c tiÃªn chÃºng tÃ´i Ä‘á»‹nh nghÄ©a má»™t sá»‘ thuáº­t ngá»¯. Äá»‘i vá»›i báº¥t ká»³ hÃ¬nh áº£nh trong suá»‘t nÃ o ğ‘°ğ‘¡âˆˆRâ„Ã—ğ‘¤Ã—4 vá»›i cÃ¡c kÃªnh RGBA, chÃºng tÃ´i kÃ½ hiá»‡u 3 kÃªnh mÃ u RGB Ä‘áº§u tiÃªn lÃ  ğ‘°ğ‘âˆˆRâ„Ã—ğ‘¤Ã—3 vÃ  kÃªnh alpha lÃ  ğ‘°ğ›¼âˆˆRâ„Ã—ğ‘¤Ã—1. VÃ¬ cÃ¡c mÃ u sáº¯c khÃ´ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh vá» máº·t váº­t lÃ½ táº¡i cÃ¡c pixel nÆ¡i giÃ¡ trá»‹ alpha báº±ng khÃ´ng nghiÃªm ngáº·t, trong bÃ i bÃ¡o nÃ y, táº¥t cáº£ cÃ¡c khu vá»±c khÃ´ng xÃ¡c Ä‘á»‹nh trong ğ‘°ğ‘ luÃ´n Ä‘Æ°á»£c Ä‘á»‡m báº±ng má»™t bá»™ lá»c Gaussian láº·p (xem thÃªm tÃ i liá»‡u bá»• sung) Ä‘á»ƒ trÃ¡nh aliasing vÃ  cÃ¡c máº«u cáº¡nh khÃ´ng cáº§n thiáº¿t. ChÃºng tÃ´i gá»i ğ‘°ğ‘ lÃ  "hÃ¬nh áº£nh RGB Ä‘Æ°á»£c Ä‘á»‡m" (HÃ¬nh 2). ğ‘°ğ‘¡ cÃ³ thá»ƒ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i thÃ nh "hÃ¬nh áº£nh Ä‘Æ°á»£c nhÃ¢n trÆ°á»›c" nhÆ° ğ‘° = ğ‘°ğ‘ âˆ— ğ‘°ğ‘ trong Ä‘Ã³ âˆ— biá»ƒu thá»‹ phÃ©p nhÃ¢n theo tá»«ng pixel. Trong bÃ i bÃ¡o nÃ y, táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ RGB Ä‘á»u trong pháº¡m vi [âˆ’1,1] (nháº¥t quÃ¡n vá»›i Stable Diffusion) trong khi táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ alpha Ä‘á»u trong pháº¡m vi [0,1]. HÃ¬nh áº£nh Ä‘Æ°á»£c nhÃ¢n trÆ°á»›c ğ‘° cÃ³ thá»ƒ Ä‘Æ°á»£c xem nhÆ° má»™t hÃ¬nh áº£nh RGB khÃ´ng trong suá»‘t thÃ´ng thÆ°á»ng cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi báº¥t ká»³ máº¡ng nÆ¡-ron Ä‘á»‹nh dáº¡ng RGB nÃ o. CÃ¡c hÃ¬nh áº£nh hÃ³a cá»§a nhá»¯ng hÃ¬nh áº£nh nÃ y Ä‘Æ°á»£c thá»ƒ hiá»‡n trong HÃ¬nh 2.

3.1 Äá»™ trong suá»‘t tiá»m áº©n

Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  thÃªm há»— trá»£ Ä‘á»™ trong suá»‘t cho cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n tiá»m áº©n quy mÃ´ lá»›n, nhÆ° Stable Diffusion (SD), thÆ°á»ng sá»­ dá»¥ng bá»™ mÃ£ hÃ³a tiá»m áº©n (VAE) Ä‘á»ƒ chuyá»ƒn Ä‘á»•i hÃ¬nh áº£nh RGB thÃ nh hÃ¬nh áº£nh tiá»m áº©n trÆ°á»›c khi Ä‘Æ°a vÃ o mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. á» Ä‘Ã¢y, VAE vÃ  mÃ´ hÃ¬nh khuáº¿ch tÃ¡n pháº£i chia sáº» cÃ¹ng má»™t phÃ¢n phá»‘i tiá»m áº©n, vÃ¬ báº¥t ká»³ sá»± khÃ´ng khá»›p lá»›n nÃ o cÅ©ng cÃ³ thá»ƒ lÃ m suy giáº£m Ä‘Ã¡ng ká»ƒ viá»‡c suy luáº­n/huáº¥n luyá»‡n/tinh chá»‰nh cá»§a khung khuáº¿ch tÃ¡n tiá»m áº©n. Khi chÃºng tÃ´i Ä‘iá»u chá»‰nh khÃ´ng gian tiá»m áº©n Ä‘á»ƒ há»— trá»£ Ä‘á»™ trong suá»‘t, phÃ¢n phá»‘i tiá»m áº©n ban Ä‘áº§u pháº£i Ä‘Æ°á»£c báº£o toÃ n cÃ ng nhiá»u cÃ ng tá»‘t. Nhá»¯ng má»¥c tiÃªu dÆ°á»ng nhÆ° mÃ¢u thuáº«n nÃ y (thÃªm há»— trá»£ Ä‘á»™ trong suá»‘t trong khi báº£o toÃ n phÃ¢n phá»‘i tiá»m áº©n ban Ä‘áº§u) cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ vá»›i má»™t phÃ©p Ä‘o Ä‘Æ¡n giáº£n: chÃºng ta cÃ³ thá»ƒ kiá»ƒm tra xem phÃ¢n phá»‘i tiá»m áº©n Ä‘Æ°á»£c sá»­a Ä‘á»•i cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i mÃ£ tá»‘t nhÆ° tháº¿ nÃ o bá»Ÿi bá»™ giáº£i mÃ£ tiá»m áº©n Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vÃ  Ä‘Ã´ng láº¡nh ban Ä‘áº§u â€” náº¿u viá»‡c giáº£i mÃ£ má»™t hÃ¬nh áº£nh tiá»m áº©n Ä‘Æ°á»£c sá»­a Ä‘á»•i táº¡o ra cÃ¡c artifact nghiÃªm trá»ng, phÃ¢n phá»‘i tiá»m áº©n bá»‹ lá»‡ch hoáº·c bá»‹ há»ng.

ChÃºng ta cÃ³ thá»ƒ viáº¿t phÃ©p Ä‘o "Ä‘á»™ cÃ³ háº¡i" nÃ y theo toÃ¡n há»c nhÆ° sau. Vá»›i má»™t hÃ¬nh áº£nh RGB ğ‘°, bá»™ mÃ£ hÃ³a tiá»m áº©n Stable Diffusion Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vÃ  Ä‘Ã´ng láº¡nh Eâˆ—ğ‘ ğ‘‘(Â·) vÃ  bá»™ giáº£i mÃ£ Dâˆ—ğ‘ ğ‘‘(Â·), trong Ä‘Ã³ âˆ— chá»‰ ra cÃ¡c mÃ´ hÃ¬nh Ä‘Ã´ng láº¡nh, chÃºng ta kÃ½ hiá»‡u hÃ¬nh áº£nh tiá»m áº©n lÃ  ğ’™ = Eâˆ—ğ‘ ğ‘‘(ğ‘°). Giáº£ sá»­ hÃ¬nh áº£nh tiá»m áº©n nÃ y ğ’™ Ä‘Æ°á»£c sá»­a Ä‘á»•i bá»Ÿi báº¥t ká»³ offset ğ’™ğœ– nÃ o, táº¡o ra má»™t tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh ğ’™ğ‘ = ğ’™ + ğ’™ğœ–. Viá»‡c tÃ¡i táº¡o RGB Ä‘Æ°á»£c giáº£i mÃ£ sau Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t lÃ  Ë†ğ‘° = Dâˆ—ğ‘ ğ‘‘(ğ’™ğ‘) vÃ  chÃºng ta cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ "cÃ³ háº¡i" cá»§a offset ğ’™ğœ– lÃ 

Lidentity = ||ğ‘° âˆ’ Ë†ğ‘°||2 = ||ğ‘° âˆ’ Dâˆ—ğ‘ ğ‘‘(Eâˆ—ğ‘ ğ‘‘(ğ‘°) + ğ’™ğœ–)||2, (1)

trong Ä‘Ã³ ||Â·||2 lÃ  khoáº£ng cÃ¡ch chuáº©n L2 (sai sá»‘ bÃ¬nh phÆ°Æ¡ng trung bÃ¬nh). Trá»±c quan, náº¿u Lidentity tÆ°Æ¡ng Ä‘á»‘i cao, ğ’™ğœ– cÃ³ thá»ƒ cÃ³ háº¡i vÃ  cÃ³ thá»ƒ Ä‘Ã£ phÃ¡ há»§y chá»©c nÄƒng tÃ¡i táº¡o cá»§a bá»™ mÃ£ hÃ³a-giáº£i mÃ£ SD, ngÆ°á»£c láº¡i náº¿u Lidentity tÆ°Æ¡ng Ä‘á»‘i tháº¥p, offset ğ’™ğœ– khÃ´ng phÃ¡ vá»¡ viá»‡c tÃ¡i táº¡o tiá»m áº©n vÃ  tiá»m áº©n Ä‘Æ°á»£c sá»­a Ä‘á»•i váº«n cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi Stable Diffusion Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n.

BÃªn cáº¡nh Ä‘Ã³, vÃ¬ háº§u háº¿t VAE chÃ­nh thá»‘ng cho cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n lÃ  cÃ¡c mÃ´ hÃ¬nh KL-Divergence hoáº·c Diagonal Gaussian Distribution, nhá»¯ng mÃ´ hÃ¬nh nÃ y thÆ°á»ng cÃ³ má»™t tham sá»‘ Ä‘Æ°á»£c huáº¥n luyá»‡n má»™t cÃ¡ch Ä‘Æ¡n giáº£n cho Ä‘á»™ lá»‡ch chuáº©n nhÆ° má»™t offset trong khÃ´ng gian tiá»m áº©n. XÃ©t Ä‘á»™ lá»‡ch nhÆ° váº­y Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  ğ’™std, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tham sá»‘ Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n nÃ y Ä‘á»ƒ xÃ¢y dá»±ng ğ’™ğœ– = ğœ†offsetğ’™stdğ’™offset trong Ä‘Ã³ ğ’™offset lÃ  Ä‘áº§u ra thÃ´ tá»« bá»™ mÃ£ hÃ³a má»›i Ä‘Æ°á»£c thÃªm vÃ o, ğ’™std lÃ  Ä‘áº§u ra Ä‘á»™ lá»‡ch cá»§a VAE Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n, vÃ  ğœ†offset lÃ  má»™t tham sá»‘ trá»ng sá»‘ vá»›i máº·c Ä‘á»‹nh ğœ†offset = 1ğ‘’âˆ’2.

ChÃºng tÃ´i sá»­ dá»¥ng offset tiá»m áº©n ğ’™ğœ– Ä‘á»ƒ thiáº¿t láº­p "Ä‘á»™ trong suá»‘t tiá»m áº©n" cho viá»‡c mÃ£ hÃ³a/giáº£i mÃ£ hÃ¬nh áº£nh trong suá»‘t. Cá»¥ thá»ƒ hÆ¡n, chÃºng tÃ´i huáº¥n luyá»‡n tá»« Ä‘áº§u má»™t bá»™ mÃ£ hÃ³a Ä‘á»™ trong suá»‘t tiá»m áº©n E(Â·,Â·) nháº­n cÃ¡c kÃªnh RGB ğ‘°ğ‘ vÃ  kÃªnh alpha ğ‘°ğ›¼ lÃ m Ä‘áº§u vÃ o Ä‘á»ƒ chuyá»ƒn Ä‘á»•i Ä‘á»™ trong suá»‘t khÃ´ng gian pixel thÃ nh má»™t offset tiá»m áº©n

ğ’™ğœ– = E(ğ‘°ğ‘, ğ‘°ğ›¼). (2)

Sau Ä‘Ã³ chÃºng tÃ´i huáº¥n luyá»‡n tá»« Ä‘áº§u má»™t bá»™ giáº£i mÃ£ Ä‘á»™ trong suá»‘t tiá»m áº©n khÃ¡c D(Â·,Â·) nháº­n tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh ğ’™ğ‘ = ğ’™ + ğ’™ğœ– vÃ  viá»‡c tÃ¡i táº¡o RGB Ä‘Æ°á»£c Ä‘á» cáº­p á»Ÿ trÃªn Ë†ğ‘° = Dâˆ—ğ‘ ğ‘‘(ğ’™ğ‘) Ä‘á»ƒ trÃ­ch xuáº¥t hÃ¬nh áº£nh trong suá»‘t tá»« khÃ´ng gian tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh

[Ë†ğ‘°ğ‘Ë†ğ‘°ğ›¼] = D(Ë†ğ‘°, ğ’™ğ‘), (3)

trong Ä‘Ã³ Ë†ğ‘°ğ‘, Ë†ğ‘°ğ›¼ lÃ  cÃ¡c kÃªnh mÃ u vÃ  alpha Ä‘Æ°á»£c tÃ¡i táº¡o. Kiáº¿n trÃºc lá»›p máº¡ng nÆ¡-ron cá»§a E(Â·,Â·) vÃ  D(Â·,Â·) cÃ³ trong tÃ i liá»‡u bá»• sung. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ viá»‡c tÃ¡i táº¡o vá»›i

Lrecon = ||ğ‘°ğ‘ âˆ’ Ë†ğ‘°ğ‘||2 + ||ğ‘°ğ‘ âˆ’ Ë†ğ‘°ğ‘||2, (4)

vÃ  chÃºng tÃ´i tÃ¬m tháº¥y thÃ´ng qua thÃ­ nghiá»‡m ráº±ng cháº¥t lÆ°á»£ng káº¿t quáº£ cÃ³ thá»ƒ Ä‘Æ°á»£c cáº£i thiá»‡n thÃªm báº±ng cÃ¡ch giá»›i thiá»‡u má»™t loss discriminator PatchGAN

Ldisc = Ldisc([Ë†ğ‘°ğ‘, Ë†ğ‘°ğ‘]), (5)

trong Ä‘Ã³ Ldisc(Â·,Â·) lÃ  má»™t má»¥c tiÃªu GAN tá»« má»™t discriminator patch 5 lá»›p (chi tiáº¿t trong tÃ i liá»‡u bá»• sung). Má»¥c tiÃªu cuá»‘i cÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t chung lÃ 

Lvae = ğœ†reconLrecon + ğœ†identityLidentity + ğœ†discLdisc, (6)

trong Ä‘Ã³ ğœ†... lÃ  cÃ¡c tham sá»‘ trá»ng sá»‘: theo máº·c Ä‘á»‹nh chÃºng tÃ´i sá»­ dá»¥ng ğœ†recon = 1, ğœ†identity = 1, ğœ†disc = 0.01. Báº±ng cÃ¡ch huáº¥n luyá»‡n khung nÃ y vá»›i Lvae, tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh ğ’™ğ‘ cÃ³ thá»ƒ Ä‘Æ°á»£c mÃ£ hÃ³a tá»« hÃ¬nh áº£nh trong suá»‘t hoáº·c ngÆ°á»£c láº¡i, vÃ  nhá»¯ng hÃ¬nh áº£nh tiá»m áº©n Ä‘Ã³ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng trong viá»‡c tinh chá»‰nh Stable Diffusion. ChÃºng tÃ´i hÃ¬nh áº£nh hÃ³a pipeline trong HÃ¬nh 2.

3.2 MÃ´ hÃ¬nh khuáº¿ch tÃ¡n vá»›i Ä‘á»™ trong suá»‘t tiá»m áº©n

VÃ¬ khÃ´ng gian tiá»m áº©n thay Ä‘á»•i vá»›i Ä‘á»™ trong suá»‘t tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh má»™t cÃ¡ch rÃµ rÃ ng Ä‘á»ƒ phÃ¹ há»£p vá»›i phÃ¢n phá»‘i tiá»m áº©n Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n ban Ä‘áº§u (PhÆ°Æ¡ng trÃ¬nh 1), Stable Diffusion cÃ³ thá»ƒ Ä‘Æ°á»£c tinh chá»‰nh trá»±c tiáº¿p trÃªn khÃ´ng gian tiá»m áº©n thay Ä‘á»•i. Vá»›i tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh ğ’™ğ‘, cÃ¡c thuáº­t toÃ¡n khuáº¿ch tÃ¡n tá»« tá»« thÃªm nhiá»…u vÃ o hÃ¬nh áº£nh vÃ  táº¡o ra má»™t hÃ¬nh áº£nh nhiá»…u ğ’™ğ‘¡, vá»›i ğ‘¡ biá»ƒu thá»‹ sá»‘ láº§n nhiá»…u Ä‘Æ°á»£c thÃªm vÃ o. Khi ğ‘¡ Ä‘á»§ lá»›n, hÃ¬nh áº£nh tiá»m áº©n xáº¥p xá»‰ nhiá»…u thuáº§n tÃºy. Vá»›i má»™t táº­p há»£p cÃ¡c Ä‘iá»u kiá»‡n bao gá»“m bÆ°á»›c thá»i gian ğ‘¡ vÃ  prompt vÄƒn báº£n ğ’„ğ‘¡, cÃ¡c thuáº­t toÃ¡n khuáº¿ch tÃ¡n hÃ¬nh áº£nh há»c má»™t máº¡ng ğœ–ğœƒ dá»± Ä‘oÃ¡n nhiá»…u Ä‘Æ°á»£c thÃªm vÃ o hÃ¬nh áº£nh tiá»m áº©n nhiá»…u ğ’™ğ‘¡ vá»›i

L = Eğ’™ğ‘¡,ğ‘¡,ğ’„ğ‘¡,ğœ–âˆ¼N(0,1)[âˆ¥ğœ– âˆ’ ğœ–ğœƒ(ğ’™ğ‘¡, ğ‘¡, ğ’„ğ‘¡))âˆ¥2â‚‚] (7)

trong Ä‘Ã³ L lÃ  má»¥c tiÃªu há»c táº­p tá»•ng thá»ƒ cá»§a toÃ n bá»™ mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. Viá»‡c huáº¥n luyá»‡n nÃ y Ä‘Æ°á»£c hÃ¬nh áº£nh hÃ³a trong HÃ¬nh 3-(a).

3.3 Táº¡o nhiá»u táº§ng

ChÃºng tÃ´i má»Ÿ rá»™ng thÃªm mÃ´ hÃ¬nh cÆ¡ sá»Ÿ thÃ nh má»™t mÃ´ hÃ¬nh Ä‘a táº§ng sá»­ dá»¥ng chia sáº» attention vÃ  LoRA [Hu et al.2021], nhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 3-(b). ChÃºng tÃ´i kÃ½ hiá»‡u tiá»m áº©n nhiá»…u tiá»n cáº£nh lÃ  ğ’™ğ‘“ vÃ  ná»n lÃ  ğ’™ğ‘, vÃ  huáº¥n luyá»‡n hai LoRA, má»™t LoRA tiá»n cáº£nh Ä‘Æ°á»£c tham sá»‘ hÃ³a bá»Ÿi ğœƒf vÃ  má»™t LoRA ná»n bá»Ÿi ğœƒb, Ä‘á»ƒ khá»­ nhiá»…u hÃ¬nh áº£nh tiá»m áº©n. Náº¿u hai mÃ´ hÃ¬nh Ä‘á»™c láº­p khá»­ nhiá»…u hai hÃ¬nh áº£nh, chÃºng ta cÃ³ hai má»¥c tiÃªu vá»›i

{Eğ’™ğ‘“,ğ‘¡,ğ’„ğ‘¡,ğœ–ğ‘“âˆ¼N(0,1)[âˆ¥ğœ–ğ‘“ âˆ’ ğœ–ğœƒ,ğœƒf(ğ’™ğ‘“, ğ‘¡, ğ’„ğ‘¡))âˆ¥2â‚‚]
Eğ’™ğ‘,ğ‘¡,ğ’„ğ‘¡,ğœ–ğ‘âˆ¼N(0,1)[âˆ¥ğœ–ğ‘ âˆ’ ğœ–ğœƒ,ğœƒb(ğ’™ğ‘, ğ‘¡, ğ’„ğ‘¡))âˆ¥2â‚‚]} (8)

trong Ä‘Ã³ ğœ–ğ‘“, ğœ–ğ‘ lÃ  nhiá»…u tiá»m áº©n cho tiá»n cáº£nh vÃ  ná»n. Sau Ä‘Ã³ chÃºng tÃ´i há»£p nháº¥t hai quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n Ä‘á»™c láº­p Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c viá»‡c táº¡o ra nháº¥t quÃ¡n. Äá»‘i vá»›i má»—i lá»›p attention trong mÃ´ hÃ¬nh khuáº¿ch tÃ¡n, chÃºng tÃ´i ná»‘i táº¥t cáº£ cÃ¡c vector {key, query, value} Ä‘Æ°á»£c kÃ­ch hoáº¡t bá»Ÿi hai hÃ¬nh áº£nh, Ä‘á»ƒ hai láº§n cháº¡y cÃ³ thá»ƒ Ä‘Æ°á»£c há»£p nháº¥t thÃ nh má»™t mÃ´ hÃ¬nh lá»›n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a chung ğœ–ğœƒ,ğœƒf,ğœƒg(Â·). ChÃºng tÃ´i kÃ½ hiá»‡u nhiá»…u Ä‘Æ°á»£c há»£p nháº¥t lÃ  ğœ–ğ‘š = [ğœ–ğ‘“, ğœ–ğ‘] Ä‘Æ°á»£c ná»‘i, vÃ  chÃºng ta cÃ³ má»¥c tiÃªu cuá»‘i cÃ¹ng

Llayer = Eğ’™ğ‘“,ğ’™ğ‘,ğ‘¡,ğ’„ğ‘¡,ğœ–ğ‘šâˆ¼N(0,1)[âˆ¥ğœ–ğ‘š âˆ’ ğœ–ğœƒ,ğœƒf,ğœƒg(ğ’™ğ‘“, ğ’™ğ‘, ğ‘¡, ğ’„ğ‘¡))âˆ¥2â‚‚] (9)

Ä‘á»ƒ táº¡o ra nhiá»u táº§ng cÃ¹ng nhau má»™t cÃ¡ch nháº¥t quÃ¡n. ChÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n nhá»¯ng sá»­a Ä‘á»•i Ä‘Æ¡n giáº£n Ä‘á»‘i vá»›i má»¥c tiÃªu nÃ y Ä‘á»ƒ há»— trá»£ viá»‡c táº¡o táº§ng cÃ³ Ä‘iá»u kiá»‡n (vÃ­ dá»¥, táº¡o ná»n cÃ³ Ä‘iá»u kiá»‡n tiá»n cáº£nh hoáº·c táº¡o tiá»n cáº£nh cÃ³ Ä‘iá»u kiá»‡n ná»n). Cá»¥ thá»ƒ hÆ¡n, báº±ng cÃ¡ch sá»­ dá»¥ng má»™t tiá»m áº©n sáº¡ch cho tiá»n cáº£nh thay vÃ¬ tiá»m áº©n nhiá»…u (tá»©c lÃ , báº±ng cÃ¡ch luÃ´n Ä‘áº·t ğœ–ğ‘“ = 0), mÃ´ hÃ¬nh sáº½ khÃ´ng khá»­ nhiá»…u tiá»n cáº£nh, vÃ  khung trá»Ÿ thÃ nh má»™t bá»™ táº¡o cÃ³ Ä‘iá»u kiá»‡n tiá»n cáº£nh. TÆ°Æ¡ng tá»±, báº±ng cÃ¡ch Ä‘áº·t ğœ–ğ‘ = 0, khung trá»Ÿ thÃ nh má»™t bá»™ táº¡o cÃ³ Ä‘iá»u kiá»‡n ná»n. ChÃºng tÃ´i triá»ƒn khai táº¥t cáº£ cÃ¡c biáº¿n thá»ƒ cÃ³ Ä‘iá»u kiá»‡n nÃ y trong cÃ¡c thÃ­ nghiá»‡m.

3.4 Chuáº©n bá»‹ bá»™ dá»¯ liá»‡u vÃ  chi tiáº¿t huáº¥n luyá»‡n

Bá»™ dá»¯ liá»‡u cÆ¡ sá»Ÿ. ChÃºng tÃ´i sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p cÃ³ con ngÆ°á»i trong vÃ²ng láº·p Ä‘á»ƒ thu tháº­p má»™t bá»™ dá»¯ liá»‡u hÃ¬nh áº£nh trong suá»‘t vÃ  huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i. Bá»™ dá»¯ liá»‡u ban Ä‘áº§u chá»©a 20k hÃ¬nh áº£nh PNG trong suá»‘t cháº¥t lÆ°á»£ng cao Ä‘Æ°á»£c mua hoáº·c táº£i xuá»‘ng miá»…n phÃ­ tá»« 5 kho hÃ¬nh áº£nh trá»±c tuyáº¿n (táº¥t cáº£ hÃ¬nh áº£nh Ä‘á»u bao gá»“m quyá»n sá»­ dá»¥ng thÆ°Æ¡ng máº¡i (vÃ­ dá»¥ trong HÃ¬nh 4-(a)). Sau Ä‘Ã³ chÃºng tÃ´i huáº¥n luyá»‡n SDXL VAE vá»›i Ä‘á»™ trong suá»‘t tiá»m áº©n sá»­ dá»¥ng cÃ¡c hÃ¬nh áº£nh Ä‘Æ°á»£c láº¥y máº«u ngáº«u nhiÃªn vá»›i xÃ¡c suáº¥t báº±ng nhau (á»Ÿ kÃ­ch thÆ°á»›c batch 8), vÃ  sau Ä‘Ã³ huáº¥n luyá»‡n mÃ´ hÃ¬nh khuáº¿ch tÃ¡n SDXL sá»­ dá»¥ng cÃ¹ng dá»¯ liá»‡u vá»›i cÃ¡c tiá»m áº©n Ä‘Æ°á»£c Ä‘iá»u chá»‰nh. Tiáº¿p theo chÃºng tÃ´i láº·p láº¡i cÃ¡c bÆ°á»›c sau trong tá»•ng cá»™ng 25 vÃ²ng. á» Ä‘áº§u má»—i vÃ²ng, chÃºng tÃ´i táº¡o ra 10k máº«u ngáº«u nhiÃªn sá»­ dá»¥ng mÃ´ hÃ¬nh cuá»‘i cÃ¹ng trong vÃ²ng trÆ°á»›c Ä‘Ã³. vÃ  cÃ¡c prompt ngáº«u nhiÃªn tá»« LAIONPOP [Schuhmann and Bevan 2023]. Sau Ä‘Ã³ chÃºng tÃ´i thá»§ cÃ´ng chá»n 1000 máº«u Ä‘á»ƒ thÃªm trá»Ÿ láº¡i vÃ o bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n. CÃ¡c máº«u má»›i Ä‘Æ°á»£c thÃªm vÃ o Ä‘Æ°á»£c cho xÃ¡c suáº¥t cao hÆ¡n 2 láº§n xuáº¥t hiá»‡n trong cÃ¡c batch huáº¥n luyá»‡n á»Ÿ vÃ²ng tiáº¿p theo. Sau Ä‘Ã³ chÃºng tÃ´i huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh mÃ£ hÃ³a-giáº£i mÃ£ Ä‘á»™ trong suá»‘t tiá»m áº©n vÃ  khuáº¿ch tÃ¡n má»™t láº§n ná»¯a. Sau 25 vÃ²ng, kÃ­ch thÆ°á»›c cá»§a bá»™ dá»¯ liá»‡u tÄƒng lÃªn 45K. Sau Ä‘Ã³, chÃºng tÃ´i táº¡o ra 5 triá»‡u cáº·p máº«u mÃ  khÃ´ng cÃ³ tÆ°Æ¡ng tÃ¡c cá»§a con ngÆ°á»i vÃ  sá»­ dá»¥ng ngÆ°á»¡ng tháº©m má»¹ LAION [Schuhmann et al.2022] thiáº¿t láº­p á»Ÿ má»©c 5.5 vÃ  sáº¯p xáº¿p Ä‘iá»ƒm sá»‘ clip Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c 1 triá»‡u cáº·p máº«u. ChÃºng tÃ´i tá»± Ä‘á»™ng loáº¡i bá» cÃ¡c máº«u khÃ´ng chá»©a báº¥t ká»³ pixel trong suá»‘t nÃ o cÅ©ng nhÆ° nhá»¯ng máº«u khÃ´ng chá»©a báº¥t ká»³ pixel cÃ³ thá»ƒ nhÃ¬n tháº¥y nÃ o. Cuá»‘i cÃ¹ng, táº¥t cáº£ hÃ¬nh áº£nh Ä‘Æ°á»£c gáº¯n chÃº thÃ­ch vá»›i LLaVA [Liu et al.2023] (má»™t GPT Ä‘a phÆ°Æ¡ng thá»©c nguá»“n má»Ÿ tÆ°Æ¡ng tá»± nhÆ° GPT4v) Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c cÃ¡c prompt vÄƒn báº£n chi tiáº¿t. Viá»‡c huáº¥n luyá»‡n cáº£ VAE vÃ  mÃ´ hÃ¬nh khuáº¿ch tÃ¡n Ä‘Æ°á»£c hoÃ n thiá»‡n vá»›i thÃªm 15k láº§n láº·p sá»­ dá»¥ng bá»™ dá»¯ liá»‡u 1 triá»‡u cuá»‘i cÃ¹ng.

PhÃ¢n tÃ­ch thá»‘ng kÃª. ChÃºng tÃ´i phÃ¢n tÃ­ch ngáº¯n gá»n á»Ÿ Ä‘Ã¢y cÃ¡ch viá»‡c lá»±a chá»n dá»¯ liá»‡u cá»§a con ngÆ°á»i cáº£i thiá»‡n cháº¥t lÆ°á»£ng cá»§a bá»™ dá»¯ liá»‡u cÅ©ng nhÆ° kháº£ nÄƒng mÃ´ hÃ¬nh. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 5, chÃºng tÃ´i hÃ¬nh áº£nh hÃ³a cÃ¡c máº«u Ä‘Æ°á»£c giá»¯ láº¡i hoáº·c loáº¡i bá» trong má»—i vÃ²ng lá»±a chá»n cÃ³ con ngÆ°á»i trong vÃ²ng láº·p. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng ná»— lá»±c cá»§a con ngÆ°á»i loáº¡i bá» má»™t sá»‘ khuyáº¿t Ä‘iá»ƒm rÃµ rÃ ng (vÃ­ dá»¥, hÃ¬nh áº£nh trá»‘ng, mÃ u sáº¯c hoÃ n toÃ n má» Ä‘á»¥c cho kÃ­nh, v.v.) vÃ  tÄƒng cÆ°á»ng sá»± Ä‘a dáº¡ng cá»§a ná»™i dung bá»™ dá»¯ liá»‡u (vÃ­ dá»¥, hiá»‡u á»©ng phÃ¡t sÃ¡ng trÃªn sÃ¡ch ma thuáº­t, v.v.). Trong Báº£ng 1, chÃºng tÃ´i tiáº¿p tá»¥c checkpoint tá»« má»—i vÃ²ng thu tháº­p dá»¯ liá»‡u Ä‘á»ƒ láº¥y máº«u hÃ¬nh áº£nh, vÃ  yÃªu cáº§u ngÆ°á»i dÃ¹ng xem láº¡i hÃ¬nh áº£nh vÃ  Ä‘áº¿m hÃ¬nh áº£nh cÃ³ khuyáº¿t Ä‘iá»ƒm rÃµ rÃ ng. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng khi sá»‘ vÃ²ng tÄƒng lÃªn, tá»· lá»‡ Ä‘áº§u ra cÃ³ khuyáº¿t Ä‘iá»ƒm giáº£m dáº§n.

Bá»™ dá»¯ liá»‡u Ä‘a táº§ng. ChÃºng tÃ´i má»Ÿ rá»™ng thÃªm bá»™ dá»¯ liá»‡u {vÄƒn báº£n, hÃ¬nh áº£nh trong suá»‘t} cá»§a chÃºng tÃ´i thÃ nh má»™t bá»™ dá»¯ liá»‡u {vÄƒn báº£n, táº§ng tiá»n cáº£nh, táº§ng ná»n}, Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh Ä‘a táº§ng. NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 4-(b), chÃºng tÃ´i yÃªu cáº§u GPT (chÃºng tÃ´i Ä‘Ã£ sá»­ dá»¥ng ChatGPT cho 100k yÃªu cáº§u vÃ  sau Ä‘Ã³ chuyá»ƒn sang LLAMA2 cho 900k yÃªu cáº§u) táº¡o ra cÃ¡c cáº·p prompt cÃ³ cáº¥u trÃºc cho tiá»n cáº£nh nhÆ° "má»™t con mÃ¨o dá»… thÆ°Æ¡ng", toÃ n bá»™ hÃ¬nh áº£nh nhÆ° "mÃ¨o trong vÆ°á»n", vÃ  ná»n nhÆ° "khÃ´ng cÃ³ gÃ¬ trong vÆ°á»n" (chÃºng tÃ´i yÃªu cáº§u GPT thÃªm tá»« "khÃ´ng cÃ³ gÃ¬" vÃ o prompt ná»n). Prompt tiá»n cáº£nh Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi bá»™ táº¡o hÃ¬nh áº£nh trong suá»‘t Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n cá»§a chÃºng tÃ´i (Pháº§n 3.2) Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c hÃ¬nh áº£nh trong suá»‘t. Sau Ä‘Ã³, chÃºng tÃ´i sá»­ dá»¥ng mÃ´ hÃ¬nh Diffusers Stable Diffusion XL Inpaint [diffusers 2024] Ä‘á»ƒ inpaint táº¥t cáº£ cÃ¡c pixel cÃ³ alpha nhá» hÆ¡n má»™t Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c hÃ¬nh áº£nh trung gian sá»­ dá»¥ng prompt cho toÃ n bá»™ hÃ¬nh áº£nh. Cuá»‘i cÃ¹ng, chÃºng tÃ´i Ä‘áº£o ngÆ°á»£c máº·t náº¡ alpha, erode ğ‘˜ = 8 pixel vÃ  inpaint láº§n ná»¯a vá»›i prompt ná»n Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c táº§ng ná»n. ChÃºng tÃ´i láº·p láº¡i quÃ¡ trÃ¬nh nÃ y 1 triá»‡u láº§n Ä‘á»ƒ táº¡o ra 1 triá»‡u cáº·p táº§ng.

Chi tiáº¿t huáº¥n luyá»‡n. ChÃºng tÃ´i sá»­ dá»¥ng optimizer AdamW vá»›i learning rate 1e-5 cho cáº£ VAE vÃ  mÃ´ hÃ¬nh khuáº¿ch tÃ¡n. MÃ´ hÃ¬nh Stable Diffusion Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n lÃ  SDXL [Podell et al.2023]. Äá»‘i vá»›i viá»‡c huáº¥n luyá»‡n LoRA [Hu et al.2021], chÃºng tÃ´i luÃ´n sá»­ dá»¥ng rank 256 cho táº¥t cáº£ cÃ¡c táº§ng. ChÃºng tÃ´i sá»­ dá»¥ng tiÃªu chuáº©n cá»§a Diffusers Ä‘á»ƒ Ä‘áº·t tÃªn vÃ  trÃ­ch xuáº¥t cÃ¡c khÃ³a LoRA. Trong viá»‡c thu tháº­p dá»¯ liá»‡u cÃ³ con ngÆ°á»i trong vÃ²ng láº·p, má»—i vÃ²ng chá»©a 10k láº§n láº·p á»Ÿ kÃ­ch thÆ°á»›c batch 16. CÃ¡c thiáº¿t bá»‹ huáº¥n luyá»‡n lÃ  4x A100 80G NV-link, vÃ  toÃ n bá»™ viá»‡c huáº¥n luyá»‡n máº¥t má»™t tuáº§n (Ä‘á»ƒ giáº£m ngÃ¢n sÃ¡ch, viá»‡c huáº¥n luyá»‡n Ä‘Æ°á»£c táº¡m dá»«ng khi con ngÆ°á»i Ä‘ang thu tháº­p dá»¯ liá»‡u cho vÃ²ng tá»‘i Æ°u hÃ³a tiáº¿p theo) vÃ  thá»i gian GPU thá»±c táº¿ lÃ  khoáº£ng 350 giá» A100. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i thÃ¢n thiá»‡n vá»›i huáº¥n luyá»‡n cho quy mÃ´ cÃ¡ nhÃ¢n hoáº·c quy mÃ´ phÃ²ng thÃ­ nghiá»‡m vÃ¬ 350 giá» GPU thÆ°á»ng cÃ³ thá»ƒ Ä‘Æ°á»£c xá»­ lÃ½ trong vÃ²ng 1K USD.

4 CÃC THÃ NGHIá»†M

ChÃºng tÃ´i trÃ¬nh bÃ y chi tiáº¿t cÃ¡c thÃ­ nghiá»‡m Ä‘á»‹nh tÃ­nh vÃ  Ä‘á»‹nh lÆ°á»£ng vá»›i há»‡ thá»‘ng cá»§a chÃºng tÃ´i. TrÆ°á»›c tiÃªn chÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ Ä‘á»‹nh tÃ­nh vá»›i hÃ¬nh áº£nh Ä‘Æ¡n láº» (Pháº§n 4.1), nhiá»u táº§ng (Pháº§n 4.2), cÅ©ng nhÆ° táº¡o ra láº·p láº¡i (Pháº§n 4.3), vÃ  sau Ä‘Ã³ cho tháº¥y ráº±ng khung cá»§a chÃºng tÃ´i cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i cÃ¡c mÃ´-Ä‘un kiá»ƒm soÃ¡t cho cÃ¡c á»©ng dá»¥ng rá»™ng hÆ¡n (Pháº§n 4.4). Sau Ä‘Ã³ chÃºng tÃ´i phÃ¢n tÃ­ch táº§m quan trá»ng cá»§a tá»«ng thÃ nh pháº§n vá»›i nghiÃªn cá»©u ablative (Pháº§n 4.5), vÃ  sau Ä‘Ã³ tháº£o luáº­n vá» sá»± khÃ¡c biá»‡t vÃ  káº¿t ná»‘i giá»¯a phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vÃ  matting hÃ¬nh áº£nh (Pháº§n 4.6). Cuá»‘i cÃ¹ng, chÃºng tÃ´i tiáº¿n hÃ nh nghiÃªn cá»©u ngÆ°á»i dÃ¹ng nháº­n thá»©c (Pháº§n 4.7) vÃ  trÃ¬nh bÃ y má»™t loáº¡t cÃ¡c tháº£o luáº­n Ä‘á»ƒ nghiÃªn cá»©u thÃªm vá» hÃ nh vi cá»§a khung cá»§a chÃºng tÃ´i (Pháº§n 4.8, 4.10, 4.12).

4.1 Káº¿t quáº£ Ä‘á»‹nh tÃ­nh

ChÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ Ä‘á»‹nh tÃ­nh trong HÃ¬nh 6 vá»›i má»™t táº­p há»£p Ä‘a dáº¡ng cÃ¡c hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c táº¡o ra báº±ng mÃ´ hÃ¬nh cÆ¡ sá»Ÿ hÃ¬nh áº£nh Ä‘Æ¡n láº» cá»§a chÃºng tÃ´i. Nhá»¯ng káº¿t quáº£ nÃ y thá»ƒ hiá»‡n kháº£ nÄƒng cá»§a mÃ´ hÃ¬nh trong viá»‡c táº¡o ra hÃ¬nh áº£nh trong suá»‘t báº£n Ä‘á»‹a mang láº¡i Ä‘á»™ trong suá»‘t kÃ­nh cháº¥t lÆ°á»£ng cao, tÃ³c, lÃ´ng, vÃ  hiá»‡u á»©ng bÃ¡n trong suá»‘t nhÆ° Ã¡nh sÃ¡ng phÃ¡t sÃ¡ng, lá»­a, hiá»‡u á»©ng ma thuáº­t, v.v. Nhá»¯ng káº¿t quáº£ nÃ y cÅ©ng thá»ƒ hiá»‡n kháº£ nÄƒng tá»•ng quÃ¡t hÃ³a cá»§a mÃ´ hÃ¬nh Ä‘á»‘i vá»›i cÃ¡c chá»§ Ä‘á» ná»™i dung Ä‘a dáº¡ng.

ChÃºng tÃ´i trÃ¬nh bÃ y thÃªm káº¿t quáº£ Ä‘a táº§ng trong HÃ¬nh 7 vá»›i cÃ¡c táº§ng trong suá»‘t Ä‘Æ°á»£c táº¡o ra bá»Ÿi mÃ´ hÃ¬nh Ä‘a táº§ng cá»§a chÃºng tÃ´i vÃ  hÃ¬nh áº£nh Ä‘Æ°á»£c há»—n há»£p. Nhá»¯ng káº¿t quáº£ nÃ y thá»ƒ hiá»‡n kháº£ nÄƒng cá»§a mÃ´ hÃ¬nh trong viá»‡c táº¡o ra cÃ¡c thÃ nh pháº§n hÃ i hÃ²a cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ Ä‘Æ°á»£c há»—n há»£p cÃ¹ng nhau má»™t cÃ¡ch liá»n máº¡ch. CÃ¡c táº§ng khÃ´ng chá»‰ nháº¥t quÃ¡n vá» chiáº¿u sÃ¡ng vÃ  má»‘i quan há»‡ hÃ¬nh há»c, mÃ  cÃ²n thá»ƒ hiá»‡n cháº¥t lÆ°á»£ng tháº©m má»¹ cá»§a Stable Diffusion (vÃ­ dá»¥, viá»‡c lá»±a chá»n mÃ u sáº¯c cá»§a ná»n vÃ  tiá»n cáº£nh theo má»™t phÃ¢n phá»‘i Ä‘Ã£ há»c trÃ´ng hÃ i hÃ²a vÃ  tháº©m má»¹).

4.2 Táº¡o táº§ng cÃ³ Ä‘iá»u kiá»‡n

ChÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ táº¡o táº§ng cÃ³ Ä‘iá»u kiá»‡n (tá»©c lÃ , táº¡o ná»n cÃ³ Ä‘iá»u kiá»‡n tiá»n cáº£nh vÃ  táº¡o tiá»n cáº£nh cÃ³ Ä‘iá»u kiá»‡n ná»n) trong HÃ¬nh 8. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng táº¡o ra thÃ nh pháº§n nháº¥t quÃ¡n vá»›i hÃ¬nh há»c vÃ  chiáº¿u sÃ¡ng máº¡ch láº¡c. Trong vÃ­ dá»¥ "bÃ³ng Ä‘Ã¨n trong nhÃ  thá»", mÃ´ hÃ¬nh cá»‘ gáº¯ng táº¡o ra má»™t thiáº¿t káº¿ Ä‘á»‘i xá»©ng tháº©m má»¹ Ä‘á»ƒ phÃ¹ há»£p vá»›i tiá»n cáº£nh. CÃ¡c vÃ­ dá»¥ "ngá»“i trÃªn gháº¿ bÄƒng"/"ngá»“i trÃªn gháº¿ sofa" chá»©ng tá» ráº±ng mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng suy luáº­n tÆ°Æ¡ng tÃ¡c giá»¯a tiá»n cáº£nh vÃ  ná»n vÃ  táº¡o ra hÃ¬nh há»c tÆ°Æ¡ng á»©ng.

4.3 Táº¡o ra láº·p láº¡i

HÃ¬nh 9 cho tháº¥y ráº±ng chÃºng ta cÃ³ thá»ƒ láº·p láº¡i sá»­ dá»¥ng mÃ´ hÃ¬nh táº¡o tiá»n cáº£nh cÃ³ Ä‘iá»u kiá»‡n ná»n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c thÃ nh pháº§n hoáº·c sá»‘ lÆ°á»£ng táº§ng tÃ¹y Ã½. Äá»‘i vá»›i má»—i táº§ng má»›i, chÃºng tÃ´i há»—n há»£p táº¥t cáº£ cÃ¡c táº§ng Ä‘Æ°á»£c táº¡o ra trÆ°á»›c Ä‘Ã³ thÃ nh má»™t hÃ¬nh áº£nh RGB vÃ  Ä‘Æ°a nÃ³ vÃ o mÃ´ hÃ¬nh táº¡o tiá»n cáº£nh cÃ³ Ä‘iá»u kiá»‡n ná»n. ChÃºng tÃ´i cÅ©ng quan sÃ¡t tháº¥y ráº±ng mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng diá»…n giáº£i ngÃ´n ngá»¯ tá»± nhiÃªn trong bá»‘i cáº£nh cá»§a hÃ¬nh áº£nh ná»n, vÃ­ dá»¥, táº¡o ra má»™t cuá»‘n sÃ¡ch trÆ°á»›c con mÃ¨o. MÃ´ hÃ¬nh thá»ƒ hiá»‡n kháº£ nÄƒng thÃ nh pháº§n hÃ¬nh há»c máº¡nh máº½, vÃ­ dá»¥, táº¡o ra má»™t con ngÆ°á»i ngá»“i trÃªn há»™p.

4.4 Táº¡o ra cÃ³ thá»ƒ kiá»ƒm soÃ¡t

NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 10, chÃºng tÃ´i chá»©ng minh ráº±ng cÃ¡c mÃ´ hÃ¬nh kiá»ƒm soÃ¡t hiá»‡n cÃ³ nhÆ° ControlNet [Zhang and Agrawala 2023] cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ o mÃ´ hÃ¬nh cá»§a chÃºng tÃ´i Ä‘á»ƒ cÃ³ chá»©c nÄƒng phong phÃº hÆ¡n. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng báº£o toÃ n cáº¥u trÃºc toÃ n cáº§u theo tÃ­n hiá»‡u ControlNet Ä‘á»ƒ táº¡o ra cÃ¡c thÃ nh pháº§n hÃ i hÃ²a vá»›i hiá»‡u á»©ng chiáº¿u sÃ¡ng nháº¥t quÃ¡n. ChÃºng tÃ´i cÅ©ng sá»­ dá»¥ng má»™t vÃ­ dá»¥ "quáº£ cáº§u pháº£n chiáº¿u" Ä‘á»ƒ cho tháº¥y ráº±ng mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng tÆ°Æ¡ng tÃ¡c vá»›i ná»™i dung cá»§a tiá»n cáº£nh vÃ  ná»n Ä‘á»ƒ táº¡o ra chiáº¿u sÃ¡ng nháº¥t quÃ¡n nhÆ° pháº£n chiáº¿u.

4.5 NghiÃªn cá»©u Ablative

ChÃºng tÃ´i tiáº¿n hÃ nh má»™t nghiÃªn cá»©u ablative Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ sá»± Ä‘Ã³ng gÃ³p cá»§a tá»«ng thÃ nh pháº§n trong khung cá»§a chÃºng tÃ´i. ChÃºng tÃ´i quan tÃ¢m Ä‘áº¿n má»™t kiáº¿n trÃºc cÃ³ thá»ƒ khÃ´ng sá»­a Ä‘á»•i bá»™ mÃ£ hÃ³a/giáº£i mÃ£ latent VAE cá»§a Stable Diffusion, mÃ  chá»‰ thÃªm kÃªnh vÃ o UNet. Trong Stable Diffusion ban Ä‘áº§u, má»™t hÃ¬nh áº£nh 512Ã—512Ã—3 Ä‘Æ°á»£c mÃ£ hÃ³a thÃ nh má»™t hÃ¬nh áº£nh tiá»m áº©n cÃ³ kÃ­ch thÆ°á»›c 64Ã—64Ã—4. Äiá»u nÃ y chá»‰ ra ráº±ng náº¿u chÃºng ta nhÃ¢n Ä‘Ã´i kÃªnh alpha 512Ã—512Ã—1 thÃ nh 3 láº§n thÃ nh má»™t ma tráº­n 512Ã—512Ã—3, alpha cÃ³ thá»ƒ Ä‘Æ°á»£c mÃ£ hÃ³a trá»±c tiáº¿p thÃ nh má»™t hÃ¬nh áº£nh tiá»m áº©n 64Ã—64Ã—4. Báº±ng cÃ¡ch ná»‘i Ä‘iá»u nÃ y vá»›i hÃ¬nh áº£nh tiá»m áº©n ban Ä‘áº§u, hÃ¬nh áº£nh tiá»m áº©n cuá»‘i cÃ¹ng sáº½ táº¡o thÃ nh má»™t ma tráº­n 64Ã—64Ã—8. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ thá»ƒ thÃªm 4 kÃªnh vÃ o Stable Diffusion UNet Ä‘á»ƒ buá»™c nÃ³ há»— trá»£ kÃªnh alpha. ChÃºng tÃ´i trÃ¬nh bÃ y káº¿t quáº£ cá»§a phÆ°Æ¡ng phÃ¡p nÃ y trong HÃ¬nh 11-(a). ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng phÆ°Æ¡ng phÃ¡p nÃ y lÃ m suy giáº£m nghiÃªm trá»ng cháº¥t lÆ°á»£ng táº¡o ra cá»§a mÃ´ hÃ¬nh lá»›n Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n, vÃ¬ phÃ¢n phá»‘i tiá»m áº©n cá»§a nÃ³ bá»‹ thay Ä‘á»•i; máº·c dÃ¹ VAE khÃ´ng thay Ä‘á»•i (nÃ³ Ä‘Æ°á»£c Ä‘Ã´ng láº¡nh), 4 kÃªnh bá»• sung thay Ä‘á»•i Ä‘Ã¡ng ká»ƒ phÃ¢n phá»‘i Ä‘áº·c trÆ°ng sau lá»›p convolution Ä‘áº§u tiÃªn trong VAE UNet. LÆ°u Ã½ ráº±ng Ä‘iá»u nÃ y khÃ¡c vá»›i viá»‡c thÃªm tÃ­n hiá»‡u kiá»ƒm soÃ¡t vÃ o UNet â€” UNet pháº£i táº¡o ra vÃ  nháº­n ra cÃ¡c kÃªnh Ä‘Æ°á»£c thÃªm vÃ o cÃ¹ng má»™t lÃºc vÃ¬ khuáº¿ch tÃ¡n lÃ  má»™t quÃ¡ trÃ¬nh láº·p láº¡i, vÃ  Ä‘áº§u ra cá»§a báº¥t ká»³ bÆ°á»›c khuáº¿ch tÃ¡n nÃ o trá»Ÿ thÃ nh Ä‘áº§u vÃ o cá»§a bÆ°á»›c khuáº¿ch tÃ¡n tiáº¿p theo.

Trong HÃ¬nh 11-(b), chÃºng tÃ´i thá»­ nghiá»‡m má»™t kiáº¿n trÃºc khÃ¡c thÃªm trá»±c tiáº¿p má»™t kÃªnh vÃ o bá»™ mÃ£ hÃ³a vÃ  giáº£i mÃ£ VAE. ChÃºng tÃ´i huáº¥n luyá»‡n VAE Ä‘á»ƒ bao gá»“m má»™t kÃªnh alpha, vÃ  sau Ä‘Ã³ huáº¥n luyá»‡n thÃªm UNet. ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng viá»‡c huáº¥n luyá»‡n nhÆ° váº­y ráº¥t khÃ´ng á»•n Ä‘á»‹nh, vÃ  káº¿t quáº£ gáº·p pháº£i cÃ¡c loáº¡i sá»¥p Ä‘á»• khÃ¡c nhau tá»« thá»i gian nÃ y sang thá»i gian khÃ¡c. LÃ½ do cá»‘t lÃµi dáº«n Ä‘áº¿n hiá»‡n tÆ°á»£ng nÃ y lÃ  phÃ¢n phá»‘i tiá»m áº©n bá»‹ thay Ä‘á»•i quÃ¡ nhiá»u trong quÃ¡ trÃ¬nh tinh chá»‰nh VAE.

ChÃºng tÃ´i cÅ©ng giá»›i thiá»‡u má»™t sá»‘ kiáº¿n trÃºc thay tháº¿ trong HÃ¬nh 12 cho cÃ¡c quy trÃ¬nh lÃ m viá»‡c phá»©c táº¡p hÆ¡n. ChÃºng ta cÃ³ thá»ƒ thÃªm cÃ¡c kÃªnh Ä‘Æ°á»£c khá»Ÿi táº¡o báº±ng khÃ´ng vÃ o UNet vÃ  sá»­ dá»¥ng VAE (cÃ³ hoáº·c khÃ´ng cÃ³ Ä‘á»™ trong suá»‘t tiá»m áº©n) Ä‘á»ƒ mÃ£ hÃ³a tiá»n cáº£nh, hoáº·c ná»n, hoáº·c káº¿t há»£p táº§ng thÃ nh Ä‘iá»u kiá»‡n, vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh Ä‘á»ƒ táº¡o ra tiá»n cáº£nh hoáº·c ná»n hoáº·c trá»±c tiáº¿p táº¡o ra hÃ¬nh áº£nh Ä‘Æ°á»£c há»—n há»£p (vÃ­ dá»¥, HÃ¬nh 12-(a, b, c)). ChÃºng tÃ´i hÃ¬nh áº£nh hÃ³a cÃ¡c vÃ­ dá»¥ cá»§a pipeline hai giai Ä‘oáº¡n nÃ y trong HÃ¬nh 12-(d, e).

4.6 Má»‘i quan há»‡ vá»›i Image Matting

ChÃºng tÃ´i tháº£o luáº­n vá» sá»± khÃ¡c biá»‡t vÃ  káº¿t ná»‘i giá»¯a viá»‡c táº¡o ra hÃ¬nh áº£nh trong suá»‘t báº£n Ä‘á»‹a vÃ  matting hÃ¬nh áº£nh. Cá»¥ thá»ƒ, chÃºng tÃ´i thá»­ nghiá»‡m cÃ¡c phÆ°Æ¡ng phÃ¡p matting sau: (1) PPMatting [Chen et al.2022] lÃ  má»™t mÃ´ hÃ¬nh matting hÃ¬nh áº£nh máº¡ng nÆ¡-ron tiÃªn tiáº¿n nháº¥t. MÃ´ hÃ¬nh nÃ y bÃ¡o cÃ¡o Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c cao nháº¥t trong táº¥t cáº£ cÃ¡c phÆ°Æ¡ng phÃ¡p matting dá»±a trÃªn máº¡ng nÆ¡-ron "cá»• Ä‘iá»ƒn", tá»©c lÃ , cÃ¡c mÃ´ hÃ¬nh nÆ¡-ron Ä‘Æ°á»£c huáº¥n luyá»‡n tá»« Ä‘áº§u trÃªn má»™t bá»™ dá»¯ liá»‡u hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c thu tháº­p. MÃ´ hÃ¬nh nÃ y hoÃ n toÃ n tá»± Ä‘á»™ng vÃ  khÃ´ng cáº§n tri-map do ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh. (2) Matting Anything [Li et al.2023b] lÃ  má»™t loáº¡i mÃ´ hÃ¬nh matting hÃ¬nh áº£nh má»›i dá»±a trÃªn Segment Anything Model (SAM) [Kirillov et al.2023] Ä‘Æ°á»£c phÃ¡t hÃ nh gáº§n Ä‘Ã¢y. MÃ´ hÃ¬nh nÃ y sá»­ dá»¥ng SAM Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n lÃ m cÆ¡ sá»Ÿ vÃ  tinh chá»‰nh nÃ³ Ä‘á»ƒ thá»±c hiá»‡n matting. MÃ´ hÃ¬nh nÃ y cÅ©ng khÃ´ng cáº§n tri-map do ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh. ChÃºng tÃ´i cÅ©ng bao gá»“m má»™t phÆ°Æ¡ng phÃ¡p dá»±a trÃªn tri-map Ä‘á»ƒ nghiÃªn cá»©u tiá»m nÄƒng trÃ­ch xuáº¥t matte cÃ³ hÆ°á»›ng dáº«n tá»« ngÆ°á»i dÃ¹ng. (3) VitMatte [Yao et al.2024] lÃ  má»™t mÃ´ hÃ¬nh matting tiÃªn tiáº¿n nháº¥t sá»­ dá»¥ng tri-map. Kiáº¿n trÃºc lÃ  Vision Transformer (ViT) vÃ  Ä‘áº¡i diá»‡n cho cháº¥t lÆ°á»£ng cao nháº¥t cá»§a cÃ¡c mÃ´ hÃ¬nh matting cÃ³ hÆ°á»›ng dáº«n tá»« ngÆ°á»i dÃ¹ng hiá»‡n táº¡i.

NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 13, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng má»™t sá»‘ loáº¡i máº«u khÃ³ Ä‘á»‘i vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p matting, vÃ­ dá»¥, hiá»‡u á»©ng bÃ¡n trong suá»‘t nhÆ° lá»­a, lÃ´ng tráº¯ng thuáº§n tÃºy trÃªn ná»n tráº¯ng thuáº§n tÃºy, tÃ¡ch bÃ³ng, v.v. Äá»‘i vá»›i ná»™i dung bÃ¡n trong suá»‘t nhÆ° lá»­a vÃ  bÃ³ng, má»™t khi nhá»¯ng máº«u nÃ y Ä‘Æ°á»£c há»—n há»£p vá»›i ná»n phá»©c táº¡p, viá»‡c tÃ¡ch chÃºng trá»Ÿ thÃ nh má»™t nhiá»‡m vá»¥ gáº§n nhÆ° khÃ´ng thá»ƒ. Äá»ƒ cÃ³ Ä‘Æ°á»£c cÃ¡c yáº¿u tá»‘ hoÃ n háº£o sáº¡ch sáº½, cÃ³ láº½ phÆ°Æ¡ng phÃ¡p duy nháº¥t lÃ  tá»•ng há»£p cÃ¡c yáº¿u tá»‘ tá»« Ä‘áº§u, sá»­ dá»¥ng má»™t bá»™ táº¡o táº§ng trong suá»‘t báº£n Ä‘á»‹a. ChÃºng tÃ´i cÅ©ng chÃº Ã½ Ä‘áº¿n tiá»m nÄƒng sá»­ dá»¥ng Ä‘áº§u ra cá»§a khung cá»§a chÃºng tÃ´i Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh matting.

4.7 NghiÃªn cá»©u ngÆ°á»i dÃ¹ng nháº­n thá»©c

Äá»ƒ Ä‘Ã¡nh giÃ¡ vÃ  so sÃ¡nh phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vá»›i cÃ¡c phÆ°Æ¡ng phÃ¡p hiá»‡n cÃ³ vá» máº·t nháº­n thá»©c, chÃºng tÃ´i thá»±c hiá»‡n má»™t nghiÃªn cá»©u ngÆ°á»i dÃ¹ng nháº­n thá»©c táº­p trung vÃ o cÃ¡c khÃ­a cáº¡nh cá»§a con ngÆ°á»i Ä‘á»‘i vá»›i káº¿t quáº£ trong suá»‘t báº£n Ä‘á»‹a cá»§a chÃºng tÃ´i vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p ad-hoc nhÆ° Stable Diffusion + táº¡o ra vÃ  matting. ChÃºng tÃ´i nháº¯m má»¥c tiÃªu Ä‘áº¿n cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng thá»±c táº¿ nÆ¡i ngÆ°á»i dÃ¹ng muá»‘n cÃ³ Ä‘Æ°á»£c cÃ¡c yáº¿u tá»‘ trong suá»‘t vá»›i cÃ¡c yÃªu cáº§u cá»¥ thá»ƒ (prompt). NghiÃªn cá»©u cá»§a chÃºng tÃ´i thá»­ nghiá»‡m nhiá»u loáº¡i phÆ°Æ¡ng phÃ¡p (táº¡o ra trong suá»‘t báº£n Ä‘á»‹a, táº¡o ra vÃ  matting, kho thÆ°Æ¡ng máº¡i trá»±c tuyáº¿n) Ä‘á»ƒ xem chÃºng Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u nhÆ° váº­y nhÆ° tháº¿ nÃ o (báº±ng cÃ¡ch há»i ngÆ°á»i dÃ¹ng há» thÃ­ch cÃ¡i nÃ o hÆ¡n).

Cá»¥ thá»ƒ, nghiÃªn cá»©u ngÆ°á»i dÃ¹ng cá»§a chÃºng tÃ´i bao gá»“m 14 cÃ¡ nhÃ¢n, trong Ä‘Ã³ 11 cÃ¡ nhÃ¢n lÃ  nhÃ¢n viÃªn crowd-source trá»±c tuyáº¿n, 1 lÃ  sinh viÃªn khoa há»c mÃ¡y tÃ­nh, vÃ  2 cÃ²n láº¡i lÃ  nhá»¯ng nhÃ  sÃ¡ng táº¡o ná»™i dung chuyÃªn nghiá»‡p. ChÃºng tÃ´i láº¥y máº«u 100 káº¿t quáº£ sá»­ dá»¥ng 3 phÆ°Æ¡ng phÃ¡p (prompt Ä‘Æ°á»£c láº¥y máº«u ngáº«u nhiÃªn tá»« PickaPic [Kirstain et al.2023]), vÃ  Ä‘iá»u nÃ y dáº«n Ä‘áº¿n 100 nhÃ³m káº¿t quáº£, vá»›i má»—i nhÃ³m chá»©a 3 káº¿t quáº£ tá»« 3 phÆ°Æ¡ng phÃ¡p. Nhá»¯ng ngÆ°á»i tham gia Ä‘Æ°á»£c má»i xáº¿p háº¡ng káº¿t quáº£ trong má»—i nhÃ³m. Khi xáº¿p háº¡ng káº¿t quáº£ trong má»—i nhÃ³m, chÃºng tÃ´i há»i ngÆ°á»i dÃ¹ng cÃ¢u há»i - "Báº¡n thÃ­ch káº¿t quáº£ nÃ o sau Ä‘Ã¢y nháº¥t? Vui lÃ²ng xáº¿p háº¡ng cÃ¡c yáº¿u tá»‘ trong suá»‘t sau Ä‘Ã¢y theo sá»Ÿ thÃ­ch cá»§a báº¡n". ChÃºng tÃ´i sá»­ dá»¥ng tá»· lá»‡ Æ°a thÃ­ch lÃ m thÆ°á»›c Ä‘o kiá»ƒm tra. QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c láº·p láº¡i 4 láº§n Ä‘á»ƒ tÃ­nh toÃ¡n Ä‘á»™ lá»‡ch chuáº©n. Sau Ä‘Ã³, chÃºng tÃ´i tÃ­nh toÃ¡n tá»· lá»‡ Æ°a thÃ­ch trung bÃ¬nh cá»§a tá»«ng phÆ°Æ¡ng phÃ¡p. ChÃºng tÃ´i gá»i nghiÃªn cá»©u ngÆ°á»i dÃ¹ng nÃ y lÃ  "nhÃ³m 1".

ChÃºng tÃ´i so sÃ¡nh phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vá»›i SD+PPMatting [Chen et al.2022], SD+Matting Anything [Li et al.2023b]. á» Ä‘Ã¢y, "SD+" cÃ³ nghÄ©a lÃ  trÆ°á»›c tiÃªn chÃºng tÃ´i sá»­ dá»¥ng Stable Diffusion XL Ä‘á»ƒ táº¡o ra má»™t hÃ¬nh áº£nh RGB, vÃ  sau Ä‘Ã³ thá»±c hiá»‡n matting sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p tÆ°Æ¡ng á»©ng. Káº¿t quáº£ Ä‘Æ°á»£c thá»ƒ hiá»‡n trong Báº£ng 2, nhÃ³m 1. ChÃºng tÃ´i tÃ¬m tháº¥y ráº±ng ngÆ°á»i dÃ¹ng Æ°a thÃ­ch phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i hÆ¡n táº¥t cáº£ cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ¡c (trong hÆ¡n 97% trÆ°á»ng há»£p). Äiá»u nÃ y chá»©ng tá» Æ°u tháº¿ cá»§a viá»‡c táº¡o ra hÃ¬nh áº£nh trong suá»‘t báº£n Ä‘á»‹a so vá»›i giáº£i phÃ¡p ad-hoc nhÆ° táº¡o ra sau Ä‘Ã³ matting.

ChÃºng tÃ´i cÅ©ng thá»±c hiá»‡n má»™t thÃ­ nghiá»‡m Æ°a thÃ­ch ngÆ°á»i dÃ¹ng khÃ¡c trong "nhÃ³m 2", so sÃ¡nh káº¿t quáº£ cá»§a chÃºng tÃ´i vá»›i viá»‡c tÃ¬m kiáº¿m tÃ i sáº£n trong suá»‘t thÆ°Æ¡ng máº¡i tá»« Adobe Stock, sá»­ dá»¥ng cÃ¹ng thÆ°á»›c Ä‘o Æ°a thÃ­ch ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c Ä‘á» cáº­p á»Ÿ trÃªn. Trong Báº£ng 2, nhÃ³m 2, chÃºng tÃ´i bÃ¡o cÃ¡o ráº±ng tá»· lá»‡ Æ°a thÃ­ch cá»§a phÆ°Æ¡ng phÃ¡p chÃºng tÃ´i gáº§n vá»›i kho thÆ°Æ¡ng máº¡i (45.3% so vá»›i 54.7%). Máº·c dÃ¹ ná»™i dung tráº£ phÃ­ cháº¥t lÆ°á»£ng cao tá»« kho thÆ°Æ¡ng máº¡i váº«n Ä‘Æ°á»£c Æ°a thÃ­ch hÆ¡n má»™t chÃºt. Káº¿t quáº£ nÃ y cho tháº¥y ráº±ng ná»™i dung trong suá»‘t Ä‘Æ°á»£c táº¡o ra cá»§a chÃºng tÃ´i cÃ³ thá»ƒ cáº¡nh tranh vá»›i cÃ¡c nguá»“n thÆ°Æ¡ng máº¡i yÃªu cáº§u ngÆ°á»i dÃ¹ng tráº£ tiá»n cho má»—i hÃ¬nh áº£nh.

4.8 KÃªnh RGBA thÃ´

HÃ¬nh 14 cho tháº¥y cÃ¡c Ä‘áº§u ra thÃ´ vá»›i tá»«ng kÃªnh trong hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c táº¡o ra cá»§a chÃºng tÃ´i. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng mÃ´ hÃ¬nh trÃ¡nh aliasing báº±ng cÃ¡ch Ä‘á»‡m kÃªnh RGB vá»›i mÃ u sáº¯c "cháº£y mÃ¡u" má»‹n. PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘áº£m báº£o cháº¥t lÆ°á»£ng mÃ u tiá»n cáº£nh cao trong cÃ¡c khu vá»±c há»—n há»£p alpha.

4.9 Bá»™ giáº£i mÃ£ máº¡nh máº½ vá»›i tÄƒng cÆ°á»ng dá»¯ liá»‡u

HÃ¬nh 15 cho tháº¥y ráº±ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p tÄƒng cÆ°á»ng dá»¯ liá»‡u Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c bá»™ giáº£i mÃ£ máº¡nh máº½ hÆ¡n Ä‘á»ƒ xá»­ lÃ½ cÃ¡c tÃ¬nh huá»‘ng khi UNet khÃ´ng thá»ƒ khuáº¿ch tÃ¡n cÃ¡c offset tiá»m áº©n mong muá»‘n. Äiá»u nÃ y cÃ³ thá»ƒ há»¯u Ã­ch khi má»™t sá»‘ mÃ´ hÃ¬nh cá»™ng Ä‘á»“ng nháº¥t Ä‘á»‹nh (vÃ­ dá»¥, anime, hoáº¡t hÃ¬nh, v.v.) khÃ´ng thá»ƒ táº¡o ra offset tiá»m áº©n mong muá»‘n trong quÃ¡ trÃ¬nh khuáº¿ch tÃ¡n, vÃ  chÃºng ta váº«n muá»‘n giáº£i mÃ£ hÃ¬nh áº£nh trong suá»‘t há»¯u Ã­ch tá»« nhá»¯ng khÃ´ng gian tiá»m áº©n hÆ¡i khÃ´ng khá»›p Ä‘Ã³ Ä‘Æ°á»£c táº¡o ra bá»Ÿi nhá»¯ng mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh Ä‘Ã³. Cá»¥ thá»ƒ, HÃ¬nh 15 Ä‘Æ¡n giáº£n lÃ  dropout 30% offset khi huáº¥n luyá»‡n bá»™ giáº£i mÃ£.

4.10 MÃ´ hÃ¬nh cá»™ng Ä‘á»“ng

NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 16, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ°á»£c Ã¡p dá»¥ng cho cÃ¡c mÃ´ hÃ¬nh cá»™ng Ä‘á»“ng, LoRA, vÃ  phong cÃ¡ch prompt khÃ¡c nhau, mÃ  khÃ´ng cáº§n huáº¥n luyá»‡n bá»• sung. Cá»¥ thá»ƒ hÆ¡n, chÃºng tÃ´i thá»­ má»™t LoRA Minecraft, má»™t LoRA pixel art, má»™t mÃ´ hÃ¬nh anime [cagliostrolab 2024], vÃ  má»™t sá»‘ phong cÃ¡ch prompt cá»™ng Ä‘á»“ng. ChÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng viá»‡c Ã¡p dá»¥ng cho cÃ¡c mÃ´ hÃ¬nh khÃ¡c nhau khÃ´ng lÃ m suy giáº£m cháº¥t lÆ°á»£ng cá»§a mÃ´ hÃ¬nh/LoRA Ä‘Ã­ch cÅ©ng nhÆ° khÃ´ng lÃ m suy giáº£m cháº¥t lÆ°á»£ng cá»§a Ä‘á»™ trong suá»‘t hÃ¬nh áº£nh. Kháº£ nÄƒng tÃ­ch há»£p nÃ y cho tháº¥y tiá»m nÄƒng cá»§a mÃ´ hÃ¬nh Ä‘á»ƒ sá»­ dá»¥ng rá»™ng rÃ£i hÆ¡n trong cÃ¡c lÄ©nh vá»±c sÃ¡ng táº¡o vÃ  chuyÃªn nghiá»‡p Ä‘a dáº¡ng.

4.11 Tá»‘c Ä‘á»™ suy luáº­n

Trong Báº£ng 3, chÃºng tÃ´i bÃ¡o cÃ¡o tá»‘c Ä‘á»™ suy luáº­n vá»›i cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n cÆ¡ sá»Ÿ vÃ  kiáº¿n trÃºc khÃ¡c nhau. Táº¥t cáº£ cÃ¡c thá»­ nghiá»‡m Ä‘á»u dá»±a trÃªn cÃ¡c thiáº¿t bá»‹ tÃ­nh toÃ¡n cáº¥p Ä‘á»™ cÃ¡ nhÃ¢n. ChÃºng tÃ´i Ä‘Ã£ thá»­ nghiá»‡m SD1.5 vÃ  SDXL vá»›i Nvidia RTX 3070 vÃ  RTX 4090. CÃ¡c thá»­ nghiá»‡m cá»§a chÃºng tÃ´i bao gá»“m táº¡o ra hÃ¬nh áº£nh trong suá»‘t Ä‘Æ¡n láº», táº¡o ra nhiá»u táº§ng cÃ¹ng nhau, vÃ  táº¡o ra nhiá»u táº§ng sá»­ dá»¥ng cÃ¡c pipeline hai giai Ä‘oáº¡n.

4.12 Háº¡n cháº¿

NhÆ° thá»ƒ hiá»‡n trong HÃ¬nh 17, má»™t sá»± Ä‘Ã¡nh Ä‘á»•i vá»›i khung cá»§a chÃºng tÃ´i lÃ  giá»¯a viá»‡c táº¡o ra "yáº¿u tá»‘ trong suá»‘t sáº¡ch sáº½" vÃ  "há»—n há»£p hÃ i hÃ²a". VÃ­ dá»¥, náº¿u hÃ¬nh áº£nh trong suá»‘t lÃ  má»™t Ä‘á»‘i tÆ°á»£ng sáº¡ch sáº½ vÃ  cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng mÃ  khÃ´ng cÃ³ báº¥t ká»³ hiá»‡u á»©ng chiáº¿u sÃ¡ng hoáº·c bÃ³ng Ä‘á»• nÃ o, viá»‡c táº¡o ra má»™t ná»n cÃ³ thá»ƒ Ä‘Æ°á»£c há»—n há»£p hÃ i hÃ²a vá»›i tiá»n cáº£nh cÃ³ thá»ƒ ráº¥t thÃ¡ch thá»©c vÃ  mÃ´ hÃ¬nh cÃ³ thá»ƒ khÃ´ng thÃ nh cÃ´ng trong má»i trÆ°á»ng há»£p (HÃ¬nh 17-(c) lÃ  má»™t trÆ°á»ng há»£p tháº¥t báº¡i). Hiá»‡n tÆ°á»£ng nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c chá»¯a trá»‹ á»Ÿ má»™t má»©c Ä‘á»™ nÃ o Ä‘Ã³ náº¿u chÃºng ta chá»‰ sá»­ dá»¥ng ná»n lÃ m Ä‘iá»u kiá»‡n Ä‘á»ƒ táº¡o ra tiá»n cáº£nh Ä‘á»ƒ buá»™c má»™t sá»± há»—n há»£p hÃ i hÃ²a (HÃ¬nh 17-(d)). Tuy nhiÃªn, Ä‘iá»u nÃ y cÅ©ng sáº½ dáº«n Ä‘áº¿n chiáº¿u sÃ¡ng áº£nh hÆ°á»Ÿng Ä‘áº¿n Ä‘á»‘i tÆ°á»£ng trong suá»‘t, lÃ m cho cÃ¡c Ä‘á»‘i tÆ°á»£ng trong suá»‘t Ã­t cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng hÆ¡n. NgÆ°á»i ta cÃ³ thá»ƒ láº­p luáº­n ráº±ng hÃ¬nh áº£nh trong HÃ¬nh 17-(a) cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng nhiá»u hÆ¡n cho cÃ¡c nhÃ  thiáº¿t káº¿ vÃ  trong cÃ¡c á»©ng dá»¥ng thá»±c táº¿ so vá»›i hÃ¬nh áº£nh trong suá»‘t trong HÃ¬nh 17-(d) chá»©a nhiá»u máº«u cá»¥ thá»ƒ gáº¯n liá»n vá»›i ná»n.

5 Káº¾T LUáº¬N

TÃ³m láº¡i, bÃ i bÃ¡o nÃ y giá»›i thiá»‡u "Ä‘á»™ trong suá»‘t tiá»m áº©n", má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ táº¡o ra hÃ¬nh áº£nh trong suá»‘t cÃ¡ nhÃ¢n hoáº·c má»™t loáº¡t cÃ¡c táº§ng trong suá»‘t nháº¥t quÃ¡n. PhÆ°Æ¡ng phÃ¡p mÃ£ hÃ³a kÃªnh alpha trong suá»‘t vÃ o phÃ¢n phá»‘i tiá»m áº©n cá»§a Stable Diffusion. QuÃ¡ trÃ¬nh nÃ y Ä‘áº£m báº£o Ä‘áº§u ra cháº¥t lÆ°á»£ng cao cá»§a cÃ¡c mÃ´ hÃ¬nh khuáº¿ch tÃ¡n hÃ¬nh áº£nh quy mÃ´ lá»›n, báº±ng cÃ¡ch Ä‘iá»u chá»‰nh má»™t offset Ä‘Æ°á»£c thÃªm vÃ o khÃ´ng gian tiá»m áº©n. Viá»‡c huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh bao gá»“m 1 triá»‡u cáº·p táº§ng hÃ¬nh áº£nh trong suá»‘t, Ä‘Æ°á»£c thu tháº­p báº±ng sÆ¡ Ä‘á»“ thu tháº­p cÃ³ con ngÆ°á»i trong vÃ²ng láº·p. ChÃºng tÃ´i trÃ¬nh bÃ y má»™t loáº¡t cÃ¡c á»©ng dá»¥ng, cháº³ng háº¡n nhÆ° táº¡o ra cÃ¡c táº§ng cÃ³ Ä‘iá»u kiá»‡n tiá»n cáº£nh/ná»n, káº¿t há»£p cÃ¡c táº§ng, táº¡o ra táº§ng cÃ³ kiá»ƒm soÃ¡t cáº¥u trÃºc, v.v. Káº¿t quáº£ nghiÃªn cá»©u ngÆ°á»i dÃ¹ng cho tháº¥y ráº±ng trong pháº§n lá»›n cÃ¡c trÆ°á»ng há»£p, ngÆ°á»i dÃ¹ng Æ°a thÃ­ch ná»™i dung trong suá»‘t Ä‘Æ°á»£c táº¡o ra báº£n Ä‘á»‹a bá»Ÿi phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i hÆ¡n cÃ¡c phÆ°Æ¡ng phÃ¡p truyá»n thá»‘ng nhÆ° táº¡o ra sau Ä‘Ã³ matting. Cháº¥t lÆ°á»£ng cá»§a hÃ¬nh áº£nh trong suá»‘t Ä‘Æ°á»£c táº¡o ra Ä‘Æ°á»£c tÃ¬m tháº¥y lÃ  cÃ³ thá»ƒ so sÃ¡nh vá»›i cÃ¡c tÃ i sáº£n trong cÃ¡c kho thÆ°Æ¡ng máº¡i.

Lá»œI Cáº¢M Æ N

CÃ´ng viá»‡c nÃ y Ä‘Æ°á»£c há»— trá»£ má»™t pháº§n bá»Ÿi Google thÃ´ng qua liÃªn káº¿t cá»§a há» vá»›i Stanford Institute for Human-centered Artificial Intelligence (HAI).

TÃ€I LIá»†U THAM KHáº¢O

[CÃ¡c tÃ i liá»‡u tham kháº£o Ä‘Æ°á»£c giá»¯ nguyÃªn Ä‘á»‹nh dáº¡ng gá»‘c]
