# 2309.17382.pdf
# Chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/icl/2309.17382.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 4080694 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================

--- TRANG 1 ---
LÃ½ luáº­n cho TÆ°Æ¡ng lai, HÃ nh Ä‘á»™ng cho Hiá»‡n táº¡i: Má»™t Khung
NguyÃªn lÃ½ cho CÃ¡c TÃ¡c nhÃ¢n LLM Tá»± Ä‘á»™ng vá»›i Hiá»‡u quáº£
Máº«u CÃ³ thá»ƒ Chá»©ng minh
Zhihan Liuâˆ—â€ Hao Huâˆ—â€¡Shenao Zhangâˆ—â€ 
Hongyi Guoâ€ Shuqi KeÂ§Boyi Liuâ€ Zhaoran Wangâ€ 
2 thÃ¡ng 7, 2024
TÃ³m táº¯t
CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM) thá»ƒ hiá»‡n kháº£ nÄƒng lÃ½ luáº­n áº¥n tÆ°á»£ng,
nhÆ°ng viá»‡c chuyá»ƒn Ä‘á»•i lÃ½ luáº­n thÃ nh hÃ nh Ä‘á»™ng trong tháº¿ giá»›i thá»±c váº«n lÃ  thÃ¡ch thá»©c. Cá»¥
thá»ƒ, khÃ´ng rÃµ lÃ m tháº¿ nÃ o Ä‘á»ƒ hoÃ n thÃ nh má»™t nhiá»‡m vá»¥ cho trÆ°á»›c má»™t cÃ¡ch cÃ³ thá»ƒ chá»©ng minh trong
sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tá»‘i thiá»ƒu vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i, vÃ­ dá»¥, thÃ´ng qua má»™t
cÆ¡ cháº¿ lÃ½ luáº­n ná»™i bá»™. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t khung Ä‘áº§u tiÃªn
vá»›i Ä‘áº£m báº£o há»‘i tiáº¿c cÃ³ thá»ƒ chá»©ng minh Ä‘á»ƒ Ä‘iá»u phá»‘i lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng, mÃ  chÃºng tÃ´i
gá»i lÃ  "lÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i" (RAFA). Cá»¥ thá»ƒ, chÃºng tÃ´i thiáº¿t káº¿ má»™t máº«u
nháº¯c cho lÃ½ luáº­n há»c tá»« bá»™ Ä‘á»‡m bá»™ nhá»› vÃ  láº­p káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai
trÃªn má»™t chÃ¢n trá»i dÃ i ("lÃ½ luáº­n cho tÆ°Æ¡ng lai"). Táº¡i má»—i bÆ°á»›c, tÃ¡c nhÃ¢n LLM
thá»±c hiá»‡n hÃ nh Ä‘á»™ng ban Ä‘áº§u cá»§a quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i"), lÆ°u trá»¯
pháº£n há»“i thu tháº­p Ä‘Æ°á»£c trong bá»™ Ä‘á»‡m bá»™ nhá»›, vÃ  gá»i láº¡i thÃ³i quen lÃ½ luáº­n
Ä‘á»ƒ láº­p láº¡i káº¿ hoáº¡ch quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai tá»« tráº¡ng thÃ¡i má»›i. Ã tÆ°á»Ÿng chÃ­nh lÃ 
coi lÃ½ luáº­n trong LLM nhÆ° há»c vÃ  láº­p káº¿ hoáº¡ch trong cÃ¡c quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov
thÃ­ch á»©ng Bayesian (MDP). TÆ°Æ¡ng á»©ng, chÃºng tÃ´i nháº¯c LLM vá»›i bá»™ Ä‘á»‡m
bá»™ nhá»› Ä‘á»ƒ Æ°á»›c tÃ­nh mÃ´i trÆ°á»ng chÆ°a biáº¿t (há»c) vÃ  táº¡o ra má»™t
quá»¹ Ä‘áº¡o tá»‘i Æ°u cho nhiá»u bÆ°á»›c tÆ°Æ¡ng lai Ä‘á»ƒ tá»‘i Ä‘a hÃ³a má»™t hÃ m giÃ¡ trá»‹
(láº­p káº¿ hoáº¡ch). CÃ¡c thÃ³i quen há»c vÃ  láº­p káº¿ hoáº¡ch Ä‘Æ°á»£c thá»±c hiá»‡n theo cÃ¡ch "trong
ngá»¯ cáº£nh" Ä‘á»ƒ mÃ´ phá»ng cáº­p nháº­t actor-critic cho MDP. PhÃ¢n tÃ­ch lÃ½ thuyáº¿t cá»§a chÃºng tÃ´i
thiáº¿t láº­p má»™t há»‘i tiáº¿c âˆšT, trong khi xÃ¡c nháº­n thá»±c nghiá»‡m cá»§a chÃºng tÃ´i thá»ƒ hiá»‡n
hiá»‡u suáº¥t thá»±c nghiá»‡m vÆ°á»£t trá»™i. á» Ä‘Ã¢y, T biá»ƒu thá»‹ sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n.
Trang dá»± Ã¡n: https://agentification.github.io/RAFA .

âˆ—ÄÃ³ng gÃ³p ngang nhau.
â€ Äáº¡i há»c Northwestern. {zhihanliu2027,shenaozhang2028,hongyiguo2025,boyiliu2018 }
@u.northwestern.edu,zhaoranwang@gmail.com
â€¡Äáº¡i há»c Thanh Hoa. huh22@mails.tsinghua.edu.cn
Â§Äáº¡i há»c Trung vÄƒn Há»“ng KÃ´ng. shuqike@link.cuhk.edu.cn
1arXiv:2309.17382v3  [cs.AI]  24 thÃ¡ng 6 2024

--- TRANG 2 ---
Má»¥c lá»¥c
1 Giá»›i thiá»‡u 4
1.1 TÃ i liá»‡u tham kháº£o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
1.2 KÃ½ hiá»‡u . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2 Ná»‘i cáº§u LLM vÃ  RL 8
3 Thuáº­t toÃ¡n 11
4 ThÃ­ nghiá»‡m 15
4.1 TrÃ² chÆ¡i 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
4.2 ALFWorld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
4.3 BlocksWorld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
4.4 Tic-Tac-Toe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
5 PhÃ¢n tÃ­ch LÃ½ thuyáº¿t 19
5.1 TÃ­nh tá»‘i Æ°u cá»§a Láº­p káº¿ hoáº¡ch . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
5.2 LLM vá»›i CÄƒn chá»‰nh Háº­u nghiá»‡m Thá»±c hiá»‡n Trung bÃ¬nh MÃ´ hÃ¬nh Bayesian (BMA) 20
5.3 RÃ ng buá»™c Há»‘i tiáº¿c cá»§a RAFA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
5.4 RAFA vá»›i Chiáº¿n lÆ°á»£c KhÃ¡m phÃ¡ Hiá»‡u quáº£ . . . . . . . . . . . . . . . . . . . . . . . 23
5.4.1 ThÆ°á»Ÿng Láº¡c quan . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
5.4.2 Láº¥y máº«u Háº­u nghiá»‡m . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
6 Káº¿t luáº­n 27
A KÃ½ hiá»‡u 35
B ThÃªm Thuáº­t toÃ¡n 36
C Chá»©ng minh ChÃ­nh 38
C.1 Chá»©ng minh Má»‡nh Ä‘á» 5.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
C.2 LLM vá»›i CÄƒn chá»‰nh Háº­u nghiá»‡m Thá»±c hiá»‡n BMA . . . . . . . . . . . . . . . . . 38
C.3 TÃ­nh cháº¥t Co láº¡i cá»§a PhÆ°Æ¡ng sai Háº­u nghiá»‡m . . . . . . . . . . . . . . . . . . 39
C.4 Chá»©ng minh Äá»‹nh lÃ½ 5.7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
C.5 Chá»©ng minh Äá»‹nh lÃ½ 5.8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
C.6 Chá»©ng minh Äá»‹nh lÃ½ 5.10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
C.7 Ná»›i lá»ng Giáº£ Ä‘á»‹nh 5.3 cho Äá»‹nh lÃ½ 5.7 . . . . . . . . . . . . . . . . . . . . . . . 53
D Chá»©ng minh Thiáº¿u trong Phá»¥ lá»¥c C 57
D.1 Chá»©ng minh Bá»• Ä‘á» C.2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
E TrÆ°á»ng há»£p Äáº·c biá»‡t Tuyáº¿n tÃ­nh 60

--- TRANG 3 ---
F ThÃªm ThÃ­ nghiá»‡m 63
F.1 TrÃ² chÆ¡i 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
F.2 ALFWorld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
F.3 BlocksWorld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
F.4 Tic-Tac-Toe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
G Lá»i nháº¯c 69
G.1 TrÃ² chÆ¡i 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
G.2 ALFWorld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
G.3 Blocksworld . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
G.4 Tic-Tac-Toe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
3

--- TRANG 4 ---
1 Giá»›i thiá»‡u
CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM) thá»ƒ hiá»‡n kháº£ nÄƒng lÃ½ luáº­n Ä‘Ã¡ng chÃº Ã½, Ä‘iá»u nÃ y má»Ÿ ra má»™t
hÆ°á»›ng má»›i cho cÃ¡c tÃ¡c nhÃ¢n tÆ°Æ¡ng tÃ¡c vá»›i tháº¿ giá»›i thá»±c má»™t cÃ¡ch tá»± Ä‘á»™ng. Tuy nhiÃªn, viá»‡c biáº¿n lÃ½ luáº­n
thÃ nh hÃ nh Ä‘á»™ng váº«n lÃ  thÃ¡ch thá»©c. Cá»¥ thá»ƒ, máº·c dÃ¹ LLM Ä‘Æ°á»£c trang bá»‹ kiáº¿n thá»©c tiÃªn nghiá»‡m
thu Ä‘Æ°á»£c thÃ´ng qua tiá»n huáº¥n luyá»‡n, báº£n cháº¥t cá»§a nÃ³ lÃ  khÃ´ng tráº¡ng thÃ¡i vÃ  khÃ´ng Ä‘Æ°á»£c Ä‘á»‹nh vá»‹ trong tháº¿ giá»›i
thá»±c, Ä‘iá»u nÃ y lÃ m cho hÃ nh Ä‘á»™ng káº¿t quáº£ khÃ´ng tá»‘i Æ°u. Äá»ƒ báº¯c cáº§u khoáº£ng trá»‘ng lÃ½ luáº­n-hÃ nh Ä‘á»™ng, chÃºng
tÃ´i nháº±m thiáº¿t káº¿ má»™t cÆ¡ cháº¿ lÃ½ luáº­n ná»™i bá»™ trÃªn ná»n táº£ng LLM, tá»‘i Æ°u hÃ³a hÃ nh Ä‘á»™ng
má»™t cÃ¡ch láº·p Ä‘i láº·p láº¡i báº±ng cÃ¡ch káº¿t há»£p pháº£n há»“i tá»« mÃ´i trÆ°á»ng bÃªn ngoÃ i. Cá»¥ thá»ƒ, chÃºng tÃ´i táº­p trung
vÃ o hiá»‡u quáº£ máº«u cá»§a cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng trong cÃ¡c nhiá»‡m vá»¥ ra quyáº¿t Ä‘á»‹nh tÆ°Æ¡ng tÃ¡c,
Ä‘iá»u nÃ y Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c Ã¡p dá»¥ng thá»±c táº¿ cá»§a chÃºng, Ä‘áº·c biá»‡t khi cÃ¡c tÆ°Æ¡ng tÃ¡c tá»‘n kÃ©m vÃ 
rá»§i ro. Má»¥c tiÃªu chÃ­nh cá»§a chÃºng tÃ´i lÃ  cho phÃ©p cÃ¡c tÃ¡c nhÃ¢n hoÃ n thÃ nh má»™t nhiá»‡m vá»¥ cho trÆ°á»›c má»™t cÃ¡ch Ä‘áº£m báº£o
thÃ´ng qua lÃ½ luáº­n trong sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tá»‘i thiá»ƒu vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i.

Há»c tÄƒng cÆ°á»ng (RL) lÃ  má»™t paradigm Ä‘Æ°á»£c nghiÃªn cá»©u ká»¹ lÆ°á»¡ng Ä‘á»ƒ cáº£i thiá»‡n hÃ nh Ä‘á»™ng báº±ng cÃ¡ch thu
tháº­p pháº£n há»“i. Tuy nhiÃªn, Ä‘á»ƒ Ä‘iá»u chá»‰nh cÃ¡c ká»¹ thuáº­t RL hiá»‡n cÃ³ cho cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng,
chÃºng ta thiáº¿u má»™t Ã¡nh xáº¡ nghiÃªm ngáº·t giá»¯a RL vÃ  LLM, dáº«n Ä‘áº¿n cÃ¡c sá»± khÃ¡c biá»‡t khÃ¡i niá»‡m
khÃ¡c nhau. VÃ­ dá»¥, RL hoáº¡t Ä‘á»™ng trong má»™t há»‡ thá»‘ng sá»‘, nÆ¡i pháº§n thÆ°á»Ÿng vÃ  chuyá»ƒn tiáº¿p
Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi vÃ´ hÆ°á»›ng vÃ  xÃ¡c suáº¥t. Trong khi Ä‘Ã³, Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra cá»§a LLM
Ä‘Æ°á»£c mÃ´ táº£ bá»Ÿi token trong má»™t há»‡ thá»‘ng ngÃ´n ngá»¯ há»c. LÃ  má»™t vÃ­ dá»¥ khÃ¡c, LLM Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn má»™t
corpus cÃ³ má»¥c Ä‘Ã­ch chung vÃ  giá»¯ cá»‘ Ä‘á»‹nh trong suá»‘t quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c. NgÆ°á»£c láº¡i, RL
huáº¥n luyá»‡n actor vÃ  critic thÃ´ng qua cáº­p nháº­t tham sá»‘ trÃªn pháº£n há»“i thu tháº­p Ä‘Æ°á»£c má»™t cÃ¡ch láº·p Ä‘i láº·p láº¡i. VÃ¬ váº­y, cÃ³
váº» khÃ´ng phÃ¹ há»£p khi coi LLM nhÆ° actor hoáº·c critic dÆ°á»›i khung RL, máº·c dÃ¹
táº¥t cáº£ chÃºng Ä‘á»u Ä‘Æ°á»£c tham sá»‘ hÃ³a bá»Ÿi máº¡ng nÆ¡-ron sÃ¢u. HÆ¡n ná»¯a, váº«n khÃ´ng rÃµ lÃ½ luáº­n vá»›i LLM cÃ³ nghÄ©a lÃ  gÃ¬ dÆ°á»›i khung RL, vÃ­ dá»¥, Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra cá»§a má»™t thÃ³i quen lÃ½ luáº­n lÃ  gÃ¬ vÃ  lÃ½ luáº­n nÃªn Ä‘Æ°á»£c phá»‘i há»£p vá»›i hÃ nh Ä‘á»™ng nhÆ° tháº¿ nÃ o. Nhá»¯ng sá»± khÃ¡c biá»‡t khÃ¡i niá»‡m nhÆ° váº­y ngÄƒn cáº£n chÃºng ta thiáº¿t láº­p má»™t khung nguyÃªn lÃ½ ngoÃ i viá»‡c mÆ°á»£n khÃ¡i niá»‡m "thá»­ vÃ  sai" tá»« RL má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  khiáº¿n viá»‡c thiáº¿t láº­p Ä‘áº£m báº£o lÃ½ thuyáº¿t trá»Ÿ nÃªn khÃ³ khÄƒn.

Äá»ƒ giáº£i quyáº¿t nhá»¯ng sá»± khÃ¡c biá»‡t khÃ¡i niá»‡m nhÆ° váº­y, chÃºng tÃ´i chÃ­nh thá»©c hÃ³a lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng vá»›i LLM
dÆ°á»›i khung quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov thÃ­ch á»©ng Bayesian (MDP), nÆ¡i biáº¿n áº©n
quan tÃ¢m lÃ  mÃ´i trÆ°á»ng chÆ°a biáº¿t. Äiá»ƒm khá»Ÿi Ä‘áº§u lÃ  coi toÃ n bá»™ lá»‹ch sá»­
cá»§a tráº¡ng thÃ¡i (cá»§a mÃ´i trÆ°á»ng bÃªn ngoÃ i), hÃ nh Ä‘á»™ng, pháº§n thÆ°á»Ÿng, vÃ  tÃ³m táº¯t ngÃ´n ngá»¯ cá»§a chÃºng trong
bá»™ Ä‘á»‡m bá»™ nhá»› nhÆ° tráº¡ng thÃ¡i thÃ´ng tin cá»§a MDP thÃ­ch á»©ng Bayesian. Trong suá»‘t quÃ¡ trÃ¬nh
tÆ°Æ¡ng tÃ¡c, tráº¡ng thÃ¡i thÃ´ng tin tÃ­ch lÅ©y má»™t táº­p há»£p pháº£n há»“i ngÃ y cÃ ng tÄƒng tá»«
mÃ´i trÆ°á»ng bÃªn ngoÃ i, Ä‘Æ°á»£c Ã¡nh xáº¡ thÃ nh má»™t hÃ nh Ä‘á»™ng tá»‘i Æ°u hÃ³a táº¡i má»—i bÆ°á»›c bá»Ÿi má»™t cÆ¡
cháº¿ lÃ½ luáº­n ná»™i bá»™. NhÆ° Ä‘Æ°á»£c chi tiáº¿t dÆ°á»›i Ä‘Ã¢y, chÃºng tÃ´i xÃ¢y dá»±ng thÃ³i quen lÃ½ luáº­n thÃ´ng qua
hai thÃ³i quen con chÃ­nh, cá»¥ thá»ƒ lÃ  há»c vÃ  láº­p káº¿ hoáº¡ch, Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi LLM vá»›i
cÃ¡c lá»i nháº¯c Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c biá»‡t. (a) ThÃ³i quen con há»c táº¡o ra Æ°á»›c tÃ­nh cá»§a mÃ´i trÆ°á»ng bÃªn ngoÃ i
cho bá»™ Ä‘á»‡m bá»™ nhá»›, nÆ¡i LLM Ä‘Æ°á»£c nháº¯c Ä‘á»ƒ suy ra chuyá»ƒn tiáº¿p
vÃ  mÃ´ hÃ¬nh pháº§n thÆ°á»Ÿng (mÃ´ hÃ¬nh) hoáº·c/vÃ  hÃ m giÃ¡ trá»‹ (critic). (b) ThÃ³i quen con láº­p káº¿ hoáº¡ch
táº¡o ra má»™t chÃ­nh sÃ¡ch tá»‘i Æ°u (actor) hoáº·c quá»¹ Ä‘áº¡o cho nhiá»u bÆ°á»›c tÆ°Æ¡ng lai, tá»‘i Ä‘a hÃ³a
hÃ m giÃ¡ trá»‹ (Ä‘áº¿n má»™t sai sá»‘ nháº¥t Ä‘á»‹nh). TÃ¹y thuá»™c vÃ o cáº¥u hÃ¬nh cá»¥ thá»ƒ cá»§a
4

--- TRANG 5 ---
Ì‚P,Ì‚r,Ì‚VpriorposteriorQuy táº¯c Bayes
MÃ´i trÆ°á»ngatLearninÄst+1Planningtt+1t+2t+3s0,a0,s1,r0stkâˆ’1,atkâˆ’1,stk,rtkâˆ’1â‹¯Ì‚Vt+3st,at,st+1,rtâ‹¯stk,atk,stk+1,rtkÌ‚st+2at+1at+2thÃªmTÃ¡c nhÃ¢nstdepth-3 tree-searchbreadth-2
tree-search"hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i""lÃ½ luáº­n
cho tÆ°Æ¡ng lai"st+1t+4
ğ™¸ğšâˆ’ğš‚ğš ğš’ğšğšŒğš‘bá»ğšˆğš˜ğšğš›ğšŠğšğšğšğš–ğš™ğšğšğšğšŠğš—ğšœğš ğšğš›ğšœğšŠğš—ğšğšğšğšğšğš‹ğšŠğšŒğš”ğšœğšŠğš›ğš{ğšğš¡ğšŠğš–ğš™ğš•ğšğšœ}:rtâ†r(st,at)st+1âˆ¼P(â‹…|st,at)pháº£n há»“i má»›i thu tháº­pbá»™ Ä‘á»‡m bá»™ nhá»›HÃ¬nh 1: Minh
há»a khung RAFA
("lÃ½ luáº­n cho tÆ°Æ¡ng
lai, hÃ nh Ä‘á»™ng cho
hiá»‡n táº¡i").

khÃ´ng gian tráº¡ng thÃ¡i vÃ  hÃ nh Ä‘á»™ng (liÃªn tá»¥c so vá»›i rá»i ráº¡c) vÃ  mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng (ngáº«u nhiÃªn so vá»›i xÃ¡c Ä‘á»‹nh), thÃ³i quen con láº­p káº¿ hoáº¡ch mÃ´ phá»ng thuáº­t toÃ¡n láº·p giÃ¡ trá»‹, thuáº­t toÃ¡n báº¯n ngáº«u nhiÃªn, hoáº·c thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Monte-Carlo.

Máº·c dÃ¹ LLM giá»¯ cá»‘ Ä‘á»‹nh trong suá»‘t quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c, chÃºng ta cÃ³ thá»ƒ giáº£m báº¥t Ä‘á»‹nh Æ°á»›c tÃ­nh cá»§a chÃºng báº±ng cÃ¡ch nháº¯c táº­p há»£p pháº£n há»“i ngÃ y cÃ ng tÄƒng tá»« mÃ´i trÆ°á»ng bÃªn ngoÃ i nhÆ° ngá»¯ cáº£nh, Ä‘iá»u nÃ y Ä‘Æ°á»£c xÃ¡c minh cáº£ vá» máº·t lÃ½ thuyáº¿t vÃ  thá»±c nghiá»‡m trong bÃ i bÃ¡o nÃ y. Tá»« quan Ä‘iá»ƒm cá»§a MDP thÃ­ch á»©ng Bayesian, LLM cÃ³ thá»ƒ Ä‘Æ°á»£c coi nhÆ° má»™t sá»‘ hÃ m cá»§a háº­u nghiá»‡m cá»§a mÃ´i trÆ°á»ng (vÃ­ dá»¥, trung bÃ¬nh mÃ´ hÃ¬nh Bayesian (Wasserman, 2000)), do Ä‘Ã³ báº¥t Ä‘á»‹nh Æ°á»›c tÃ­nh giáº£m vá»›i thÃ´ng tin tÄƒng thÃ´ng qua tÆ°Æ¡ng tÃ¡c. Äá»‘i vá»›i má»™t sá»‘ nhiá»‡m vá»¥, chÃºng tÃ´i chá»©ng minh ráº±ng LLM cÃ³ thá»ƒ Ä‘Æ°a ra dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c hÆ¡n khi Ä‘Æ°á»£c nháº¯c vá»›i nhiá»u dá»¯ liá»‡u hÆ¡n nhÆ° ngá»¯ cáº£nh. Do Ä‘Ã³, LLM cÃ³ thá»ƒ Ä‘Ã³ng vai trÃ² tÆ°Æ¡ng tá»± nhÆ° bá»™ Æ°á»›c tÃ­nh mÃ´ hÃ¬nh trong thiáº¿t káº¿ thuáº­t toÃ¡n RL trá»±c tuyáº¿n cho tÆ°Æ¡ng tÃ¡c. ChÃºng tÃ´i cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c cá»§a LLM báº±ng cÃ¡ch Ä‘Æ¡n giáº£n thÃªm pháº£n há»“i má»›i vÃ o bá»™ Ä‘á»‡m bá»™ nhá»› nhÆ° ngá»¯ cáº£nh, thay vÃ¬ thá»±c hiá»‡n cáº­p nháº­t tham sá»‘ rÃµ rÃ ng (nhÆ° gradient descent) trÃªn máº¡ng nÆ¡-ron sÃ¢u nhÆ° trong cÃ¡c phÆ°Æ¡ng phÃ¡p RL hiá»‡n cÃ³.

ChÃºng tÃ´i káº¿t luáº­n Ä‘Ã³ng gÃ³p cá»§a chÃºng tÃ´i trong bÃ i bÃ¡o nÃ y tá»« ba quan Ä‘iá»ƒm. (a) ChÃºng tÃ´i thiáº¿t láº­p tÆ°Æ¡ng á»©ng LLM-RL vÃ  thiáº¿t káº¿ má»™t khung nguyÃªn lÃ½ RAFA Ä‘á»ƒ Ä‘iá»u phá»‘i lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng cá»§a LLM. (b) XÃ¡c nháº­n thá»±c nghiá»‡m cá»§a chÃºng tÃ´i cho tháº¥y RAFA vÆ°á»£t trá»™i hÆ¡n cÃ¡c khung hiá»‡n cÃ³ khÃ¡c nhau trong cÃ¡c nhiá»‡m vá»¥ ra quyáº¿t Ä‘á»‹nh tÆ°Æ¡ng tÃ¡c, bao gá»“m ALFWorld, BlocksWorld, TrÃ² chÆ¡i 24, vÃ  má»™t benchmark má»›i dá»±a trÃªn Tic-Tac-Toe. (c) PhÃ¢n tÃ­ch lÃ½ thuyáº¿t cá»§a chÃºng tÃ´i chá»©ng minh ráº±ng RAFA Ä‘áº¡t Ä‘Æ°á»£c há»‘i tiáº¿c âˆšT, giáº£i thÃ­ch táº¡i sao RAFA thá»ƒ hiá»‡n hiá»‡u suáº¥t thá»±c nghiá»‡m máº¡nh máº½. á» Ä‘Ã¢y, T biá»ƒu thá»‹ sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n. ChÃºng tÃ´i cÅ©ng cung cáº¥p hai biáº¿n thá»ƒ hiá»‡u quáº£ cÃ³ thá»ƒ chá»©ng minh cá»§a RAFA Ä‘á»ƒ thá»±c hiá»‡n khÃ¡m phÃ¡ hiá»‡u quáº£ cho cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p hÆ¡n.

1.1 TÃ i liá»‡u tham kháº£o
LÃ½ luáº­n vá»›i LLM. ChÃºng tÃ´i xÃ¢y dá»±ng trÃªn má»™t dÃ²ng cÃ´ng viá»‡c gáº§n Ä‘Ã¢y phÃ¡t triá»ƒn cÃ¡c sÆ¡ Ä‘á»“ nháº¯c khÃ¡c nhau Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t lÃ½ luáº­n cá»§a LLM. "Chuá»—i suy nghÄ©" ("CoT") (Wei et al., 2022) phÃ¢n tÃ¡ch má»™t váº¥n Ä‘á» thÃ¡ch thá»©c thÃ nh nhiá»u giai Ä‘oáº¡n lÃ½ luáº­n vÃ  hÆ°á»›ng dáº«n LLM giáº£i quyáº¿t tá»«ng giai Ä‘oáº¡n má»™t. NhÆ° cÃ¡c tá»•ng quÃ¡t hÃ³a, "cÃ¢y suy nghÄ©" (Yao et al., 2023a), "Ä‘á»“ thá»‹ suy nghÄ©" (Yao et al., 2023b), "thuáº­t toÃ¡n cá»§a suy nghÄ©" (Sel et al., 2023), vÃ  "lÃ½ luáº­n tÃ­ch lÅ©y" (Zhang et al., 2023a) cung cáº¥p cÃ¡c sÆ¡ Ä‘á»“ tÃ¬m kiáº¿m Ä‘á»“ thá»‹ khÃ¡c nhau Ä‘á»ƒ hÆ°á»›ng dáº«n LLM. Xem thÃªm
5

--- TRANG 6 ---
Wang et al. (2022a); Creswell et al. (2022); Creswell vÃ  Shanahan (2022); Guo et al. (2024); Zhang et al. (2024). NgoÃ i ra, "lÃ½ luáº­n thÃ´ng qua láº­p káº¿ hoáº¡ch" ("RAP") (Hao et al., 2023) mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Monte-Carlo (MCTS) Ä‘á»ƒ giáº£m Ä‘á»™ phá»©c táº¡p tÃ¬m kiáº¿m. Pouplin et al. (2024) cáº£i thiá»‡n quÃ¡ trÃ¬nh lÃ½ luáº­n LLM vá»›i MCTS vÃ  cÃ´ng thá»©c hÃ³a quÃ¡ trÃ¬nh lÃ½ luáº­n nhÆ° má»™t MDP. Sun et al. (2023a) sá»­ dá»¥ng RL nghá»‹ch Ä‘áº£o ngoáº¡i tuyáº¿n Ä‘á»ƒ tá»‘i Æ°u hÃ³a cÃ¡c lá»i nháº¯c cho cÃ¡c bÃ i toÃ¡n sá»‘ há»c. Äá»‘i vá»›i cÃ¡c tÃ¡c nhÃ¢n LLM hiá»‡n thÃ¢n, Huang et al. (2022a) Ä‘á» xuáº¥t phÃ¢n tÃ¡ch má»™t nhiá»‡m vá»¥ phá»©c táº¡p thÃ nh nhiá»u bÆ°á»›c cÃ³ thá»ƒ thá»±c thi. Háº§u háº¿t trong sá»‘ chÃºng táº­p trung vÃ o cÃ¡c nhiá»‡m vá»¥ lÃ½ luáº­n chung, vÃ­ dá»¥, giáº£i má»™t cÃ¢u Ä‘á»‘ toÃ¡n há»c hoáº·c logic, nÆ¡i LLM táº¡o ra má»™t dáº¥u váº¿t chi tiáº¿t (quá»¹ Ä‘áº¡o) cá»§a cÃ¡c luáº­n cá»© thÃ´ng qua má»™t cÆ¡ cháº¿ ná»™i bá»™ Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c má»™t cÃ¢u tráº£ lá»i cuá»‘i cÃ¹ng. á» Ä‘Ã¢y, LLM Ä‘Ã³ng vai trÃ² tÆ°Æ¡ng tá»± nhÆ° thÃ³i quen con láº­p káº¿ hoáº¡ch trong RAFA. NgÆ°á»£c láº¡i, chÃºng tÃ´i táº­p trung vÃ o cÃ¡c nhiá»‡m vá»¥ ra quyáº¿t Ä‘á»‹nh tÆ°Æ¡ng tÃ¡c, nÆ¡i cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng thu tháº­p pháº£n há»“i tá»« mÃ´i trÆ°á»ng bÃªn ngoÃ i Ä‘á»ƒ tá»‘i Æ°u hÃ³a hÃ nh Ä‘á»™ng má»™t cÃ¡ch láº·p Ä‘i láº·p láº¡i. Cá»¥ thá»ƒ, chÃºng tÃ´i nháº±m hoÃ n thÃ nh má»™t nhiá»‡m vá»¥ cho trÆ°á»›c trong sá»‘ lÆ°á»£ng tÆ°Æ¡ng tÃ¡c tá»‘i thiá»ƒu vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i. Äá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Ä‘iá»u nÃ y, viá»‡c váº­n hÃ nh ba mÃ´-Ä‘un xen káº½, cá»¥ thá»ƒ lÃ  há»c, láº­p káº¿ hoáº¡ch, vÃ  hÃ nh Ä‘á»™ng, trong má»™t vÃ²ng láº·p khÃ©p kÃ­n lÃ  thiáº¿t yáº¿u. Máº·c dÃ¹ cÃ³ thá»ƒ káº¿t há»£p cÃ¡c sÆ¡ Ä‘á»“ tÃ¬m kiáº¿m Ä‘á»“ thá»‹ hoáº·c MCTS hiá»‡n cÃ³ nhÆ° thÃ³i quen con láº­p káº¿ hoáº¡ch Ä‘á»ƒ táº¡o quá»¹ Ä‘áº¡o, Ä‘Ã³ng gÃ³p cá»‘t lÃµi cá»§a chÃºng tÃ´i lÃ  má»™t khung nguyÃªn lÃ½ thá»±c thi má»™t táº­p con Ä‘Æ°á»£c chá»n cá»§a quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch Ä‘á»ƒ thu tháº­p pháº£n há»“i ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i") vÃ  láº­p láº¡i káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o cáº£i thiá»‡n tá»« tráº¡ng thÃ¡i má»›i báº±ng cÃ¡ch há»c tá»« pháº£n há»“i ("lÃ½ luáº­n cho tÆ°Æ¡ng lai"). Tá»« quan Ä‘iá»ƒm RL, cÃ¡c sÆ¡ Ä‘á»“ tÃ¬m kiáº¿m Ä‘á»“ thá»‹ hoáº·c MCTS hiá»‡n cÃ³ tÆ°Æ¡ng tá»± nhÆ° má»™t phÆ°Æ¡ng phÃ¡p vÃ²ng láº·p má»Ÿ, vÃ­ dá»¥, láº­p káº¿ hoáº¡ch chuyá»ƒn Ä‘á»™ng hoáº·c tá»‘i Æ°u hÃ³a quá»¹ Ä‘áº¡o (Betts, 1998), khÃ´ng liÃªn quan Ä‘áº¿n tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i. Äá»ƒ tÃ­ch há»£p chÃºng vÃ o má»™t cÃ¡ch tiáº¿p cáº­n vÃ²ng láº·p khÃ©p kÃ­n, vÃ­ dá»¥, Ä‘iá»u khiá»ƒn dá»± Ä‘oÃ¡n mÃ´ hÃ¬nh (Rawlings, 2000), ngÆ°á»i ta pháº£i chá»‰ Ä‘á»‹nh cÃ¡ch hÃ nh Ä‘á»™ng cho quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch vÃ  khi nÃ o gá»i láº¡i thÃ³i quen lÃ½ luáº­n (há»c vÃ  láº­p káº¿ hoáº¡ch), Ä‘Ã¢y lÃ  ká»¹ thuáº­t chÃ­nh cá»§a RAFA. Má»™t dÃ²ng cÃ´ng viá»‡c gáº§n Ä‘Ã¢y khÃ¡c giáº£i quyáº¿t cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p hÆ¡n báº±ng cÃ¡ch cho phÃ©p LLM truy cáº­p cÃ¡c mÃ´-Ä‘un bá»• sung khÃ¡c nhau, vÃ­ dá»¥, cÃ´ng cá»¥, chÆ°Æ¡ng trÃ¬nh, vÃ  cÃ¡c thuáº­t toÃ¡n há»c khÃ¡c (Ahn et al., 2022; Shen et al., 2023; Lu et al., 2023; Liu et al., 2023a; Cai et al., 2023), hoáº·c báº±ng cÃ¡ch tinh chá»‰nh LLM trÃªn pháº£n há»“i (Zelikman et al., 2022; Li et al., 2022; Paul et al., 2023; Sun, 2023).

HÃ nh Ä‘á»™ng (vÃ  LÃ½ luáº­n) vá»›i LLM. ChÃºng tÃ´i xÃ¢y dá»±ng trÃªn má»™t dÃ²ng cÃ´ng viá»‡c gáº§n Ä‘Ã¢y phÃ¡t triá»ƒn cÃ¡c khung vÃ²ng láº·p khÃ©p kÃ­n khÃ¡c nhau Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i. "Äá»™c thoáº¡i ná»™i tÃ¢m" (Huang et al., 2022b) vÃ  "ReAct" (Yao et al., 2022) káº¿t há»£p lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng Ä‘á»ƒ tinh chá»‰nh láº«n nhau láº§n Ä‘áº§u tiÃªn. So vá»›i Ä‘Ã³, RAFA cung cáº¥p má»™t lá»‹ch trÃ¬nh cá»¥ thá»ƒ Ä‘á»ƒ Ä‘iá»u phá»‘i lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng (nhÆ° Ä‘Ã£ tháº£o luáº­n á»Ÿ trÃªn). NhÆ° cÃ¡c tá»•ng quÃ¡t hÃ³a, "Reflexion" (Shinn et al., 2023) cho phÃ©p cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng sá»­a Ä‘á»•i hÃ nh Ä‘á»™ng hiá»‡n táº¡i cá»§a má»™t quá»¹ Ä‘áº¡o Ä‘Æ°á»£c táº¡o trÆ°á»›c báº±ng cÃ¡ch há»c tá»« pháº£n há»“i, Ä‘áº·c biá»‡t khi chÃºng máº¯c lá»—i. Xem thÃªm Kim et al. (2023). Tuy nhiÃªn, viá»‡c thá»±c hiá»‡n sá»­a Ä‘á»•i cá»¥c bá»™ Ä‘á»‘i vá»›i quá»¹ Ä‘áº¡o Ä‘Æ°á»£c táº¡o trÆ°á»›c lÃ  cáº­n thá»‹ vÃ¬ nÃ³ khÃ´ng xem xÃ©t háº­u quáº£ dÃ i háº¡n cá»§a hÃ nh Ä‘á»™ng. Káº¿t quáº£ lÃ , chÃ­nh sÃ¡ch thu Ä‘Æ°á»£c cÃ³ thá»ƒ bá»‹ máº¯c káº¹t bá»Ÿi má»™t tá»‘i Æ°u cá»¥c bá»™. Tá»« quan Ä‘iá»ƒm RL, "Reflexion" (Shinn et al., 2023) lÃ  má»™t phiÃªn báº£n Ä‘Æ¡n giáº£n hÃ³a quÃ¡ má»©c cá»§a RAFA, nÆ¡i thÃ³i quen con láº­p káº¿ hoáº¡ch sá»­a Ä‘á»•i hÃ nh Ä‘á»™ng hiá»‡n táº¡i Ä‘á»ƒ tá»‘i Ä‘a hÃ³a hÃ m pháº§n thÆ°á»Ÿng ("lÃ½ luáº­n cho hiá»‡n táº¡i") thay vÃ¬ láº­p káº¿ hoáº¡ch nhiá»u
6

--- TRANG 7 ---
CÆ¡ cháº¿ VÃ²ng láº·p KhÃ©p kÃ­n KhÃ´ng Cáº­p nháº­t Tham sá»‘ Äáº£m báº£o LÃ½ thuyáº¿t
RAFA âœ“ âœ“
RL SÃ¢u Dá»±a trÃªn MÃ´ hÃ¬nh âœ— âœ“
Äiá»u khiá»ƒn Dá»± Ä‘oÃ¡n MÃ´ hÃ¬nh âœ— âœ“
Láº¥y máº«u Thompson âœ— âœ“
"React", "Reflexion", vÃ  "Adaplanner" âœ“ âœ—
Báº£ng 1: So sÃ¡nh giá»¯a RAFA vÃ  cÃ¡c cÆ¡ cháº¿ khÃ¡c.

bÆ°á»›c tÆ°Æ¡ng lai Ä‘á»ƒ tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ ("lÃ½ luáº­n cho tÆ°Æ¡ng lai"), Ä‘o lÆ°á»ng pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n. Äá»ƒ kháº¯c phá»¥c váº¥n Ä‘á» nÃ y, "AdaPlanner" (Sun et al., 2023b) tÃ¡i táº¡o toÃ n bá»™ quá»¹ Ä‘áº¡o táº¡i má»—i bÆ°á»›c, mang láº¡i cáº£i thiá»‡n toÃ n cá»¥c. Xem thÃªm Wang et al. (2023b). Tuy nhiÃªn, thÃ³i quen lÃ½ luáº­n cá»§a "AdaPlanner" yÃªu cáº§u má»™t táº­p há»£p chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c cháº¿ tÃ¡c thá»§ cÃ´ng Ä‘á»ƒ tá»« chá»‘i cÃ¡c quá»¹ Ä‘áº¡o á»©ng viÃªn khÃ´ng tá»‘i Æ°u. KhÃ´ng cÃ³ kiáº¿n thá»©c lÄ©nh vá»±c cá»§a nhiá»‡m vá»¥ hiá»‡n táº¡i, quá»¹ Ä‘áº¡o Ä‘Æ°á»£c tÃ¡i táº¡o khÃ´ng nháº¥t thiáº¿t pháº£i tá»‘i Æ°u, tá»©c lÃ , tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ (Ä‘áº¿n má»™t sai sá»‘ nháº¥t Ä‘á»‹nh). NgÆ°á»£c láº¡i, thÃ³i quen lÃ½ luáº­n cá»§a RAFA Ä‘Æ°á»£c thiáº¿t káº¿ theo cÃ¡ch tiáº¿p cáº­n nguyÃªn lÃ½ trong RL. Cá»¥ thá»ƒ, thÃ³i quen con há»c suy ra mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng (mÃ´ hÃ¬nh) hoáº·c/vÃ  hÃ m giÃ¡ trá»‹ (critic), trong khi thÃ³i quen con láº­p káº¿ hoáº¡ch mÃ´ phá»ng thuáº­t toÃ¡n láº·p giÃ¡ trá»‹, thuáº­t toÃ¡n báº¯n ngáº«u nhiÃªn, hoáº·c thuáº­t toÃ¡n MCTS, khÃ´ng cÃ³ thuáº­t toÃ¡n nÃ o sá»­ dá»¥ng báº¥t ká»³ kiáº¿n thá»©c lÄ©nh vá»±c nÃ o. RAFA cÅ©ng Ä‘áº¡t Ä‘Æ°á»£c Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh láº§n Ä‘áº§u tiÃªn vÃ  vÆ°á»£t trá»™i hÆ¡n nhá»¯ng khung hiá»‡n cÃ³ vá» máº·t thá»±c nghiá»‡m.

MÃ´ hÃ¬nh NgÃ´n ngá»¯ Lá»›n (LLM) vÃ  Há»c Trong Ngá»¯ cáº£nh (ICL). LLM (Radford et al., 2019; Brown et al., 2020; Hoffmann et al., 2022; Chowdhery et al., 2022; OpenAI, 2023; Touvron et al., 2023) thá»ƒ hiá»‡n kháº£ nÄƒng lÃ½ luáº­n Ä‘Ã¡ng chÃº Ã½. Má»™t khÃ­a cáº¡nh quan trá»ng cá»§a lÃ½ luáº­n lÃ  kháº£ nÄƒng ICL (Liang et al., 2022; Razeghi et al., 2022; Shin et al., 2022; Olsson et al., 2022; AkyÃ¼rek et al., 2022; Kirsch et al., 2022; Garg et al., 2022; Von Oswald et al., 2023; Li et al., 2023; Abernethy et al., 2023), cho phÃ©p LLM giáº£i quyáº¿t má»™t loáº¡t rá»™ng cÃ¡c nhiá»‡m vá»¥ chá»‰ vá»›i má»™t vÃ i vÃ­ dá»¥ trong ngá»¯ cáº£nh thay vÃ¬ tinh chá»‰nh tham sá»‘ trÃªn má»™t táº­p dá»¯ liá»‡u cá»¥ thá»ƒ. ChÃºng tÃ´i táº­p trung vÃ o khai thÃ¡c kháº£ nÄƒng ICL cá»§a LLM Ä‘á»ƒ tá»‘i Æ°u hÃ³a hÃ nh Ä‘á»™ng trong tháº¿ giá»›i thá»±c, Ä‘iá»u nÃ y quan trá»ng Ä‘á»‘i vá»›i cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng. Cá»¥ thá»ƒ, chÃºng tÃ´i xÃ¢y dá»±ng trÃªn má»™t dÃ²ng cÃ´ng viá»‡c gáº§n Ä‘Ã¢y (Xie et al., 2021; Zhang et al., 2022, 2023b; Wang et al., 2023a; Wies et al., 2023; Jiang, 2023; Lee et al., 2023) quy kháº£ nÄƒng ICL cho suy luáº­n Bayesian áº©n, tá»©c lÃ , má»™t cÆ¡ cháº¿ áº©n cho phÃ©p LLM suy ra má»™t khÃ¡i niá»‡m áº©n tá»« nhá»¯ng vÃ­ dá»¥ trong ngá»¯ cáº£nh, Ä‘Æ°á»£c xÃ¡c minh cáº£ vá» máº·t lÃ½ thuyáº¿t vÃ  thá»±c nghiá»‡m. Trong RAFA, khÃ¡i niá»‡m áº©n lÃ  mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng (mÃ´ hÃ¬nh) cá»§a mÃ´i trÆ°á»ng chÆ°a biáº¿t hoáº·c/vÃ  hÃ m giÃ¡ trá»‹ (critic), Ä‘Æ°á»£c suy ra tá»« bá»™ Ä‘á»‡m bá»™ nhá»› trong thÃ³i quen con há»c. Kháº³ng Ä‘á»‹nh 2.1 cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  káº¿t quáº£ cá»§a kháº£ nÄƒng ICL.

Há»c TÄƒng cÆ°á»ng (RL) dÆ°á»›i Khung Bayesian. ChÃºng tÃ´i xÃ¢y dá»±ng trÃªn má»™t dÃ²ng cÃ´ng viá»‡c gáº§n Ä‘Ã¢y vá» chÃ¢n trá»i vÃ´ háº¡n (Abbasi-Yadkori vÃ  SzepesvÃ¡ti, 2015; Dong et al., 2019;
7

--- TRANG 8 ---
Wei et al., 2020; Zhou et al., 2021a,b; Chen et al., 2022; Chua et al., 2018; Hafner et al., 2019; Sekar et al., 2020) vÃ  cÃ i Ä‘áº·t Bayesian (Strens, 2000; Osband et al., 2013; Russo vÃ  Van Roy, 2014a,b, 2016; Lu vÃ  Van Roy, 2019) cá»§a RL, bao gá»“m RL sÃ¢u dá»±a trÃªn mÃ´ hÃ¬nh (Janner et al., 2019; Liu et al., 2023b; Wang et al., 2022b; Liu et al., 2024), Ä‘iá»u khiá»ƒn dá»± Ä‘oÃ¡n mÃ´ hÃ¬nh (Morari vÃ  Lee, 1999), vÃ  láº¥y máº«u Thompson (Russo vÃ  Van Roy, 2014b). CÃ i Ä‘áº·t chÃ¢n trá»i vÃ´ háº¡n cho phÃ©p RAFA tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i liÃªn tá»¥c mÃ  khÃ´ng Ä‘áº·t láº¡i vá» tráº¡ng thÃ¡i ban Ä‘áº§u, trong khi cÃ i Ä‘áº·t Bayesian cho phÃ©p chÃºng ta káº¿t ná»‘i RAFA vá»›i BMA vÃ  thiáº¿t láº­p Ä‘áº£m báº£o lÃ½ thuyáº¿t. RL hoáº¡t Ä‘á»™ng trong má»™t há»‡ thá»‘ng sá»‘, nÆ¡i pháº§n thÆ°á»Ÿng vÃ  chuyá»ƒn tiáº¿p Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi vÃ´ hÆ°á»›ng vÃ  xÃ¡c suáº¥t, vÃ  huáº¥n luyá»‡n actor vÃ  critic trÃªn pháº£n há»“i thu tháº­p Ä‘Æ°á»£c má»™t cÃ¡ch láº·p Ä‘i láº·p láº¡i. ChÃºng tÃ´i táº­p trung vÃ o mÃ´ phá»ng cáº­p nháº­t actor-mÃ´ hÃ¬nh hoáº·c actor-critic trong RL thÃ´ng qua má»™t cÆ¡ cháº¿ lÃ½ luáº­n ná»™i bá»™ trÃªn ná»n táº£ng LLM, cho phÃ©p dá»¯ liá»‡u vÃ  hÃ nh Ä‘á»™ng lÃ  token trong má»™t há»‡ thá»‘ng ngÃ´n ngá»¯ há»c trong khi bá» qua viá»‡c cáº­p nháº­t tham sá»‘ rÃµ rÃ ng trong RL dá»±a trÃªn mÃ´ hÃ¬nh (Chua et al., 2018; Hafner et al., 2019; Sekar et al., 2020; Liu et al., 2022b; Zhong et al., 2022; Zheng et al., 2022; Liu et al., 2022a). Cá»¥ thá»ƒ, cÃ¡c thÃ³i quen con há»c vÃ  láº­p káº¿ hoáº¡ch cá»§a RAFA mÃ´ phá»ng cáº­p nháº­t háº­u nghiá»‡m vÃ  cÃ¡c thuáº­t toÃ¡n láº­p káº¿ hoáº¡ch khÃ¡c nhau trong RL. HÆ¡n ná»¯a, RAFA Ä‘iá»u phá»‘i lÃ½ luáº­n (há»c vÃ  láº­p káº¿ hoáº¡ch) vÃ  hÃ nh Ä‘á»™ng theo cÃ¡ch tiáº¿p cáº­n nguyÃªn lÃ½ trong RL, tá»©c lÃ , (tÃ¡i) láº­p káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai trÃªn má»™t chÃ¢n trá»i dÃ i ("lÃ½ luáº­n cho tÆ°Æ¡ng lai") táº¡i tráº¡ng thÃ¡i má»›i vÃ  thá»±c hiá»‡n hÃ nh Ä‘á»™ng ban Ä‘áº§u cá»§a quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i"). Káº¿t quáº£ lÃ , RAFA káº¿ thá»«a Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh tá»« RL. ChÃºng tÃ´i tÃ³m táº¯t so sÃ¡nh giá»¯a RAFA vÃ  cÃ¡c cÆ¡ cháº¿ vÃ²ng láº·p khÃ©p kÃ­n khÃ¡c trong Báº£ng 1.

1.2 KÃ½ hiá»‡u
ChÃºng tÃ´i cung cáº¥p má»™t báº£ng kÃ½ hiá»‡u trong Phá»¥ lá»¥c A.

2 Ná»‘i cáº§u LLM vÃ  RL
Giao thá»©c TÆ°Æ¡ng tÃ¡c. ChÃºng tÃ´i sá»­ dá»¥ng cÃ¡c quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov thÃ­ch á»©ng Bayesian (MDP) (Ghavamzadeh et al., 2015) Ä‘á»ƒ mÃ´ hÃ¬nh hÃ³a cÃ¡ch cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i. ChÃºng tÃ´i xem xÃ©t má»™t MDP chÃ¢n trá»i vÃ´ háº¡n M= (S,A, P, r, Ï, Î³, P0), trong Ä‘Ã³ S lÃ  khÃ´ng gian tráº¡ng thÃ¡i, A lÃ  khÃ´ng gian hÃ nh Ä‘á»™ng, P:S Ã— A 7â†’ âˆ†(S) lÃ  nhÃ¢n chuyá»ƒn tiáº¿p, r:S Ã— A 7â†’ R lÃ  hÃ m pháº§n thÆ°á»Ÿng, Ï lÃ  phÃ¢n phá»‘i ban Ä‘áº§u cá»§a tráº¡ng thÃ¡i, Î³âˆˆ(0,1) lÃ  há»‡ sá»‘ giáº£m giÃ¡, vÃ  P0 lÃ  phÃ¢n phá»‘i tiÃªn nghiá»‡m cá»§a nhÃ¢n chuyá»ƒn tiáº¿p vÃ  hÃ m pháº§n thÆ°á»Ÿng. á» Ä‘Ã¢y, P cho xÃ¡c suáº¥t phÃ¢n phá»‘i cá»§a tráº¡ng thÃ¡i tiáº¿p theo cho tráº¡ng thÃ¡i hiá»‡n táº¡i vÃ  hÃ nh Ä‘á»™ng, trong khi r Ä‘Æ°á»£c giáº£ Ä‘á»‹nh lÃ  xÃ¡c Ä‘á»‹nh mÃ  khÃ´ng máº¥t tÃ­nh tá»•ng quÃ¡t. Äá»ƒ Ä‘Æ¡n giáº£n kÃ½ hiá»‡u, chÃºng tÃ´i tham sá»‘ hÃ³a P vÃ  r bá»Ÿi má»™t tham sá»‘ chung Î¸âˆˆÎ˜ vÃ  kÃ½ hiá»‡u chÃºng lÃ  PÎ¸ vÃ  rÎ¸. á» Ä‘áº§u tÆ°Æ¡ng tÃ¡c, tham sá»‘ sinh dá»¯ liá»‡u Î¸â‹† Ä‘Æ°á»£c láº¥y máº«u tá»« tiÃªn nghiá»‡m P0. Táº¡i bÆ°á»›c thá»© t trong quÃ¡ trÃ¬nh tÆ°Æ¡ng tÃ¡c, tÃ¡c nhÃ¢n LLM nháº­n má»™t tráº¡ng thÃ¡i stâˆˆ S, thá»±c hiá»‡n má»™t hÃ nh Ä‘á»™ng atâˆˆ A theo chÃ­nh sÃ¡ch hiá»‡n táº¡i Ï€t:S 7â†’ A, vÃ  nháº­n má»™t pháº§n thÆ°á»Ÿng rt=rÎ¸â‹†(st, at). Tiáº¿p theo, mÃ´i trÆ°á»ng bÃªn ngoÃ i chuyá»ƒn tiáº¿p Ä‘áº¿n tráº¡ng thÃ¡i tiáº¿p theo st+1âˆ¼PÎ¸â‹†(Â·|st, at), trong khi tÃ¡c nhÃ¢n LLM tÃ­nh toÃ¡n chÃ­nh sÃ¡ch cáº­p nháº­t Ï€t+1 thÃ´ng qua má»™t cÆ¡ cháº¿ lÃ½ luáº­n ná»™i bá»™ (nhÆ° Ä‘Ã£ tháº£o luáº­n dÆ°á»›i Ä‘Ã¢y). LÆ°u Ã½ ráº±ng S vÃ  A Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi token trong má»™t há»‡ thá»‘ng ngÃ´n ngá»¯ há»c. á» Ä‘Ã¢y, Ï€âˆˆÎ  Ä‘Æ°á»£c giáº£ Ä‘á»‹nh lÃ  xÃ¡c Ä‘á»‹nh mÃ  khÃ´ng máº¥t tÃ­nh tá»•ng quÃ¡t, trong Ä‘Ã³ Î  lÃ  táº­p há»£p kháº£ thi cá»§a cÃ¡c chÃ­nh sÃ¡ch.
8

--- TRANG 9 ---
HÃ m GiÃ¡ trá»‹. Äá»‘i vá»›i má»™t chÃ­nh sÃ¡ch Ï€ vÃ  má»™t tham sá»‘ Î¸ cá»§a mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a cÃ¡c hÃ m giÃ¡ trá»‹ tráº¡ng thÃ¡i vÃ  giÃ¡ trá»‹ hÃ nh Ä‘á»™ng nhÆ°

VÏ€_Î¸(s) =E[hâˆâˆ‘_t=0Î³^t rÎ¸(st, at)|s0=s],

QÏ€_Î¸(s, a) =E[hâˆâˆ‘_t=0Î³^t rÎ¸(st, at)|s0=s, a0=a], (2.1)

trong Ä‘Ã³ E Ä‘Æ°á»£c láº¥y Ä‘á»‘i vá»›i at=Ï€(st) vÃ  st+1âˆ¼PÎ¸(Â·|st, at) cho táº¥t cáº£ tâ‰¥0. NÃ³i cÃ¡ch khÃ¡c, VÏ€_Î¸ (vÃ  QÏ€_Î¸) cho pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n tá»« tráº¡ng thÃ¡i hiá»‡n táº¡i s (vÃ  hÃ nh Ä‘á»™ng a).

ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a chÃ­nh sÃ¡ch tá»‘i Æ°u Ï€â‹†_Î¸ Ä‘á»‘i vá»›i má»™t tham sá»‘ Î¸ cho trÆ°á»›c nhÆ° Ï€â‹†_Î¸= argmaxaA Qâ‹†_Î¸, trong Ä‘Ã³ Qâ‹†_Î¸ lÃ  Ä‘iá»ƒm cá»‘ Ä‘á»‹nh cá»§a phÆ°Æ¡ng trÃ¬nh tá»‘i Æ°u Bellman sau,

Qâ‹†_Î¸(s, a) = (BÎ¸Vâ‹†_Î¸) (s, a),
Vâ‹†_Î¸(s) = max_aâˆˆA Qâ‹†_Î¸(s, a), (2.2)

trong Ä‘Ã³ Qâ‹†_Î¸ vÃ  Vâ‹†_Î¸ lÃ  cÃ¡c giáº£i phÃ¡p Ä‘iá»ƒm cá»‘ Ä‘á»‹nh. á» Ä‘Ã¢y, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a (BÎ¸V)(s, a) =rÎ¸(s, a) +Î³Â·(PÎ¸â‹†V)(s, a) vÃ  (PÎ¸V)(s, a) =Esâ€²âˆ¼PÎ¸(Â·|s,a)[V(sâ€²)] cho báº¥t ká»³ hÃ m giÃ¡ trá»‹ V nÃ o. Xem Sutton vÃ  Barto (2018) cho cÃ¡c Ä‘áº£m báº£o tá»“n táº¡i vÃ  duy nháº¥t cho Qâ‹†_Î¸, Vâ‹†_Î¸, vÃ  Ï€â‹†_Î¸.

Háº­u nghiá»‡m, Entropy, vÃ  TÄƒng ThÃ´ng tin. Bá»Ÿi quy táº¯c Bayes, háº­u nghiá»‡m cá»§a Î¸â‹† cho báº¥t ká»³ táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D nÃ o lÃ 

Ppost(Î¸|D)âˆP0(Î¸)L(D|Î¸), (2.3)

trong Ä‘Ã³ chÃºng tÃ´i kÃ½ hiá»‡u bá»Ÿi L(D|Î¸) kháº£ nÄƒng cá»§a D cÃ³ Ä‘iá»u kiá»‡n trÃªn Î¸. ChÃºng tÃ´i Ä‘á»‹nh nghÄ©a biáº¿n ngáº«u nhiÃªn Î¾(s,a) nhÆ° cáº·p cá»§a tráº¡ng thÃ¡i tiáº¿p theo vÃ  pháº§n thÆ°á»Ÿng hiá»‡n táº¡i (sâ€², r) cho cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a). Cho báº¥t ká»³ táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D vÃ  cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a) nÃ o, háº­u nghiá»‡m cá»§a Î¾(s,a) cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh lÃ 

Ppost(Î¾(s,a)|D, s, a) =EÎ¸âˆ¼Ppost(Â·|D)[PÎ¸(sâ€²|s, a)Â·1(r=rÎ¸(s, a))], (2.4)

trong Ä‘Ã³ chÃºng tÃ´i sá»­ dá»¥ng quy táº¯c Bayes vÃ  thá»±c táº¿ ráº±ng cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a) lÃ  Ä‘á»™c láº­p cÃ³ Ä‘iá»u kiá»‡n cá»§a Î¸â‹† cho D. Äá»ƒ Ä‘áº·c trÆ°ng báº¥t Ä‘á»‹nh cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn D, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a entropy háº­u nghiá»‡m H(Î¸|D) lÃ 

H(Î¸|D) =EÎ¸âˆ¼Ppost(Â·|D)[-log ppost(Î¸|D)], (2.5)

9

--- TRANG 10 ---
trong Ä‘Ã³ ppost lÃ  hÃ m khá»‘i lÆ°á»£ng xÃ¡c suáº¥t (hoáº·c máº­t Ä‘á»™) cá»§a Ppost. Entropy háº­u nghiá»‡m cao H(Î¸|D) cÃ³ nghÄ©a lÃ  báº¥t Ä‘á»‹nh cao cá»§a Î¸â‹†, Ä‘iá»u nÃ y cho tháº¥y ráº±ng khÃ³ khÄƒn cho tÃ¡c nhÃ¢n Ä‘Æ°a ra dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c cho D. ChÃºng tÃ´i cÅ©ng Ä‘á»‹nh nghÄ©a tÄƒng thÃ´ng tin I(Î¸;Î¾|D) lÃ  H(Î¸|D)âˆ’ H(Î¸|D, Î¾), Ä‘áº·c trÆ°ng cho lÆ°á»£ng thÃ´ng tin mÃ  Î¾(s,a) mang láº¡i Ä‘á»ƒ giáº£m báº¥t Ä‘á»‹nh cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn D.

Hiá»‡u quáº£ Máº«u. NhÆ° thÆ°á»›c Ä‘o hiá»‡u suáº¥t, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a há»‘i tiáº¿c Bayesian sau T bÆ°á»›c tÆ°Æ¡ng tÃ¡c,

R(T) =E[âˆ‘Tâˆ’1_t=0 VÏ€â‹†_Î¸â‹†(st)âˆ’VÏ€t_Î¸â‹†(st)], (2.6)

trong Ä‘Ã³ Ï€â‹†=Ï€â‹†_Î¸â‹†, E Ä‘Æ°á»£c láº¥y Ä‘á»‘i vá»›i phÃ¢n phá»‘i tiÃªn nghiá»‡m P0 cá»§a Î¸â‹†, káº¿t quáº£ ngáº«u nhiÃªn cá»§a st, vÃ  cáº­p nháº­t láº·p cá»§a Ï€t, liÃªn quan Ä‘áº¿n tráº¡ng thÃ¡i, hÃ nh Ä‘á»™ng, vÃ  pháº§n thÆ°á»Ÿng cho Ä‘áº¿n bÆ°á»›c thá»© t, tá»©c lÃ , toÃ n bá»™ lá»‹ch sá»­ Dt={(si, ai, si+1, ri)}tâˆ’1_i=0. ChÃºng tÃ´i nháº±m thiáº¿t káº¿ má»™t tÃ¡c nhÃ¢n hiá»‡u quáº£ máº«u thá»a mÃ£n R(T) =o(T), tá»©c lÃ , há»‘i tiáº¿c Bayesian lÃ  dÆ°á»›i tuyáº¿n tÃ­nh trong tá»•ng sá»‘ tÆ°Æ¡ng tÃ¡c T.

Ã nghÄ©a cá»§a LÃ½ luáº­n vÃ  Vai trÃ² cá»§a LLM. Äá»ƒ ná»‘i cáº§u cÆ¡ cháº¿ LLM vá»›i thuáº­t toÃ¡n RL trá»±c tuyáº¿n, chÃºng tÃ´i kháº³ng Ä‘á»‹nh ráº±ng LLM cÃ³ thá»ƒ Ä‘Ã³ng vai trÃ² tÆ°Æ¡ng tá»± nhÆ° bá»™ Æ°á»›c tÃ­nh mÃ´ hÃ¬nh trong thiáº¿t káº¿ thuáº­t toÃ¡n RL trá»±c tuyáº¿n cho tÆ°Æ¡ng tÃ¡c, Ä‘Ã¢y lÃ  má»™t khÃ­a cáº¡nh cá»§a kháº£ nÄƒng Há»c Trong Ngá»¯ cáº£nh (ICL) cá»§a LLM.

Kháº³ng Ä‘á»‹nh 2.1. LLM cung cáº¥p Æ°á»›c tÃ­nh chÃ­nh xÃ¡c hÆ¡n cho mÃ´i trÆ°á»ng vá»›i nhiá»u pháº£n há»“i hÆ¡n tá»« tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n.

Trong Má»‡nh Ä‘á» 5.4 trong Pháº§n 5, chÃºng tÃ´i chá»©ng minh ráº±ng LLM vá»›i cÄƒn chá»‰nh háº­u nghiá»‡m thá»±c hiá»‡n trung bÃ¬nh mÃ´ hÃ¬nh Bayesian (BMA). Káº¿t quáº£ lÃ½ thuyáº¿t nÃ y há»— trá»£ Kháº³ng Ä‘á»‹nh 2.1, vÃ¬ báº¥t Ä‘á»‹nh Æ°á»›c tÃ­nh cá»§a BMA giáº£m cho nhiá»u pháº£n há»“i hÆ¡n tá»« tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng (Wasserman, 2000). ChÃºng tÃ´i cÅ©ng cung cáº¥p báº±ng chá»©ng thá»±c nghiá»‡m trÃªn ba nhiá»‡m vá»¥ cho Kháº³ng Ä‘á»‹nh 2.1 nhÆ° sau.

(a) Information Bandit. Má»¥c tiÃªu cá»§a thÃ­ nghiá»‡m bandit 100 cÃ¡nh tay cá»§a chÃºng tÃ´i lÃ  tÃ¬m cÃ¡nh tay cÃ³ pháº§n thÆ°á»Ÿng cao nháº¥t. CÃ³ má»™t cÃ¡nh tay thÃ´ng tin cÃ³ pháº§n thÆ°á»Ÿng lÃ  chá»‰ sá»‘ cá»§a cÃ¡nh tay tá»‘t nháº¥t. ChÃºng tÃ´i nháº¯c LLM (gpt-4) kÃ©o cÃ¡nh tay báº±ng cÃ¡ch cung cáº¥p cho nÃ³ dá»¯ liá»‡u lá»‹ch sá»­ cá»§a má»™t sá»‘ trÆ°á»ng há»£p bandit chia sáº» cÃ¹ng má»™t cÃ¡nh tay thÃ´ng tin. CÃ³ thá»ƒ quan sÃ¡t tá»« hÃ¬nh bÃªn pháº£i ráº±ng LLM cÃ³ thá»ƒ há»c cÃ¡nh tay tá»‘t nháº¥t chá»‰ vá»›i 6 vÃ­ dá»¥, vÃ  do Ä‘Ã³ lÃ  má»™t bá»™ Æ°á»›c tÃ­nh pháº§n thÆ°á»Ÿng hiá»‡u quáº£.

(b) Há»c KhÃ¡i niá»‡m. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ LLM (Llama 2-7B) trong ba nhiá»‡m vá»¥ (Todd et al., 2023) vá»›i cÃ¡c khÃ¡i niá»‡m áº©n: (1) Antonym: Táº¡o tá»« cÃ³ nghÄ©a trÃ¡i ngÆ°á»£c cho má»™t tá»« Ä‘áº§u vÃ o; (2) Country-Capital: Táº¡o thÃ nh phá»‘ thá»§ Ä‘Ã´ cá»§a má»™t quá»‘c gia cho trÆ°á»›c; vÃ  (3) Present-Past: Táº¡o biáº¿n thá»ƒ quÃ¡ khá»© cá»§a Ä‘á»™ng tá»« cho má»™t Ä‘á»™ng tá»« á»Ÿ thÃ¬ hiá»‡n táº¡i. ChÃºng tÃ´i quan sÃ¡t ráº±ng vá»›i nhiá»u vÃ­ dá»¥ trong ngá»¯ cáº£nh hÆ¡n Ä‘Æ°á»£c cung cáº¥p cho LLM, Ä‘á»™ chÃ­nh xÃ¡c cá»§a trÆ°á»ng há»£p kiá»ƒm tra tÄƒng má»™t cÃ¡ch Ä‘Æ¡n Ä‘iá»‡u, cho tháº¥y ráº±ng cÃ¡c khÃ¡i niá»‡m áº©n cá»§a nhiá»‡m vá»¥ Ä‘Æ°á»£c há»c.
10

--- TRANG 11 ---
2 6 10 14 18
Sá»‘ VÃ­ dá»¥0.00.20.40.60.81.0Äá»™ chÃ­nh xÃ¡c
bandit(a) Information bandit.

0 1 5 10
Sá»‘ VÃ­ dá»¥0.00.20.40.60.81.0Äá»™ chÃ­nh xÃ¡c
antonym
country-capital
present-past (b) Há»c khÃ¡i niá»‡m.

0 60 120 180 240 300
Sá»‘ Token10âˆ’510âˆ’410âˆ’310âˆ’210âˆ’1100CNLL xÂ·sin(x)
x
x2
exp(x2/2)Â·sin(x)
sin(x) (c) Dá»± Ä‘oÃ¡n giÃ¡ trá»‹ hÃ m.

HÃ¬nh 2: Báº±ng chá»©ng thá»±c nghiá»‡m cho Kháº³ng Ä‘á»‹nh 2.1 trÃªn cÃ¡c nhiá»‡m vá»¥ khÃ¡c nhau. LLM thá»ƒ hiá»‡n kháº£ nÄƒng dá»± Ä‘oÃ¡n Ä‘Æ°á»£c cáº£i thiá»‡n khi sá»‘ lÆ°á»£ng máº«u trong ngá»¯ cáº£nh tÄƒng.

(c) Dá»± Ä‘oÃ¡n GiÃ¡ trá»‹ HÃ m. Má»¥c tiÃªu cá»§a thÃ­ nghiá»‡m nÃ y lÃ  Ä‘á»ƒ LLM (gpt-3) dá»± Ä‘oÃ¡n cÃ¡c giÃ¡ trá»‹ cá»§a má»™t hÃ m trÃªn cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u chÆ°a tháº¥y cho cÃ¡c giÃ¡ trá»‹ trÃªn cÃ¡c Ä‘iá»ƒm vá»›i khoáº£ng cÃ¡ch cá»‘ Ä‘á»‹nh. Theo Gruver et al. (2023), chÃºng tÃ´i bÃ¡o cÃ¡o kháº£ nÄƒng log Ã¢m tÃ­ch lÅ©y t-interval CNLL = âˆ’âˆ‘t_i log P(vi|promptiâˆ’1), trong Ä‘Ã³ vi lÃ  giÃ¡ trá»‹ cá»§a hÃ m táº¡i Ä‘iá»ƒm dá»¯ liá»‡u i. CÃ³ thá»ƒ quan sÃ¡t ráº±ng LLM lÃ  nhá»¯ng nhÃ  dá»± bÃ¡o chuá»—i thá»i gian tá»‘t.

DÆ°á»›i Kháº³ng Ä‘á»‹nh 2.1, chÃºng tÃ´i thiáº¿t láº­p tÆ°Æ¡ng á»©ng giá»¯a LLM vÃ  RL báº±ng cÃ¡ch sá»­ dá»¥ng LLM nhÆ° bá»™ Æ°á»›c tÃ­nh mÃ´ hÃ¬nh trong thuáº­t toÃ¡n RL, Ä‘iá»u nÃ y má»Ÿ ra cÃ¡nh cá»­a Ä‘á»ƒ táº¡o ra má»™t thuáº­t toÃ¡n thá»±c táº¿ káº¿t há»£p Ä‘iá»ƒm máº¡nh cá»§a cáº£ LLM vÃ  RL. LLM xuáº¥t sáº¯c trong Ä‘á»™ chÃ­nh xÃ¡c vá»›i pháº£n há»“i tá»‘i thiá»ƒu, Ä‘iá»u nÃ y cáº£i thiá»‡n hiá»‡u quáº£ máº«u. LLM cÅ©ng cÃ³ thá»ƒ tinh chá»‰nh Æ°á»›c tÃ­nh báº±ng cÃ¡ch sá»­ dá»¥ng pháº£n há»“i má»›i nhÆ° lá»i nháº¯c, Ä‘iá»u nÃ y trÃ¡nh Ä‘Æ°á»£c cáº­p nháº­t tham sá»‘ rÃµ rÃ ng. Thuáº­t toÃ¡n RL hÆ°á»Ÿng lá»£i tá»« tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n Ä‘á»ƒ cáº£i thiá»‡n Æ°á»›c tÃ­nh vÃ  chÃ­nh sÃ¡ch vÃ  cÃ³ Ä‘áº£m báº£o lÃ½ thuyáº¿t vá»›i thuáº­t toÃ¡n láº­p káº¿ hoáº¡ch tá»‘i Æ°u nhÆ° láº·p giÃ¡ trá»‹. TÆ°Æ¡ng á»©ng LLM-RL nÃ y truyá»n cáº£m há»©ng cho chÃºng tÃ´i giá»›i thiá»‡u má»™t khung má»›i trong pháº§n tiáº¿p theo, nháº±m Ä‘iá»u phá»‘i lÃ½ luáº­n (há»c vÃ  láº­p káº¿ hoáº¡ch) vÃ  hÃ nh Ä‘á»™ng cá»§a LLM.

3 Thuáº­t toÃ¡n
Kiáº¿n trÃºc cá»§a RAFA. Báº±ng cÃ¡ch táº­n dá»¥ng tÆ°Æ¡ng á»©ng LLM-RL trong Pháº§n 2, chÃºng tÃ´i cung cáº¥p má»™t khung nguyÃªn lÃ½ Ä‘á»ƒ Ä‘iá»u phá»‘i lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng, cá»¥ thá»ƒ lÃ  "lÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i" (RAFA), trong Thuáº­t toÃ¡n 1 vÃ  2. Táº¡i bÆ°á»›c thá»© t cá»§a Thuáº­t toÃ¡n 1, tÃ¡c nhÃ¢n LLM gá»i thÃ³i quen lÃ½ luáº­n, há»c tá»« bá»™ Ä‘á»‡m bá»™ nhá»› vÃ  láº­p káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai trÃªn má»™t chÃ¢n trá»i dÃ i ("lÃ½ luáº­n cho tÆ°Æ¡ng lai" trong DÃ²ng 6), thá»±c hiá»‡n hÃ nh Ä‘á»™ng ban Ä‘áº§u cá»§a quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i" trong DÃ²ng 7), vÃ  lÆ°u trá»¯ pháº£n há»“i thu tháº­p Ä‘Æ°á»£c (tráº¡ng thÃ¡i, hÃ nh Ä‘á»™ng, vÃ  pháº§n thÆ°á»Ÿng) trong bá»™ Ä‘á»‡m bá»™ nhá»› (DÃ²ng 8). Khi chuyá»ƒn tiáº¿p tráº¡ng thÃ¡i cá»§a mÃ´i trÆ°á»ng bÃªn ngoÃ i, tÃ¡c nhÃ¢n LLM gá»i láº¡i thÃ³i quen lÃ½ luáº­n Ä‘á»ƒ láº­p láº¡i káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai khÃ¡c tá»« tráº¡ng thÃ¡i má»›i (DÃ²ng 6 sau DÃ²ng 9). Äá»ƒ Ä‘áº£m báº£o tÃ­nh á»•n Ä‘á»‹nh cá»§a há»c vÃ  láº­p káº¿ hoáº¡ch, chÃºng tÃ´i Ã¡p Ä‘áº·t Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i (DÃ²ng 10) Ä‘á»ƒ quyáº¿t Ä‘á»‹nh cÃ³ nÃªn káº¿t há»£p pháº§n lá»‹ch sá»­ má»›i nháº¥t, tá»©c lÃ , hiá»‡u táº­p Dtâˆ’ D tk, vÃ o tráº¡ng thÃ¡i thÃ´ng tin, Ä‘Æ°á»£c sá»­ dá»¥ng trong thÃ³i quen lÃ½ luáº­n nhÆ° ngá»¯ cáº£nh. NÃ³i cÃ¡ch khÃ¡c, thÃ³i quen lÃ½ luáº­n sá»­ dá»¥ng cÃ¹ng má»™t
11

--- TRANG 12 ---
Thuáº­t toÃ¡n 1 LÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i (RAFA): PhiÃªn báº£n LLM.
1:Ä‘áº§u vÃ o : Má»™t ngÆ°á»i há»c-láº­p káº¿ hoáº¡ch LLM LLM-LR-PL, nháº±m táº¡o ra má»™t quá»¹ Ä‘áº¡o tá»‘i Æ°u cho má»™t tráº¡ng thÃ¡i ban Ä‘áº§u vÃ  tráº£ vá» hÃ nh Ä‘á»™ng ban Ä‘áº§u (vÃ­ dá»¥, Thuáº­t toÃ¡n 2), vÃ  má»™t Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i If-Switch.
2:khá»Ÿi táº¡o : Láº¥y máº«u tráº¡ng thÃ¡i ban Ä‘áº§u s0âˆ¼Ï, Ä‘áº·t t= 0, vÃ  khá»Ÿi táº¡o bá»™ Ä‘á»‡m bá»™ nhá»› D0=âˆ….
3:cho k= 0,1, . . . ,thá»±c hiá»‡n
4: Äáº·t tkâ†t.
5:láº·p láº¡i
6: Há»c vÃ  láº­p káº¿ hoáº¡ch cho bá»™ nhá»› Dtk Ä‘á»ƒ cÃ³ hÃ nh Ä‘á»™ng atâ†LLM-LR-PL (Dtk, st). ("lÃ½ luáº­n cho tÆ°Æ¡ng lai")
7: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at Ä‘á»ƒ nháº­n pháº§n thÆ°á»Ÿng rt vÃ  tráº¡ng thÃ¡i st+1 tá»« mÃ´i trÆ°á»ng. ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i")
8: Cáº­p nháº­t bá»™ nhá»› Dt+1â† D tâˆª {(st, at, st+1, rt)}.
9: Äáº·t tâ†t+ 1.
10: cho Ä‘áº¿n khi If-Switch (Dt) lÃ  True. (Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c thá»a mÃ£n)
11:káº¿t thÃºc cho

MÃ´ hÃ¬nh LLM Elite LLM
MÃ´itrÆ°á»ngLÃ½ luáº­n
HÃ nh Ä‘á»™ngÄáº§u vÃ o: 2 5 8 112*5
2+511-52*5=10
(cÃ²n láº¡i: 8 10 11)
2+5=7
(cÃ²n láº¡i: 7 8 11)11-5=6
(cÃ²n láº¡i: 2 6 8)
11-5
8/6
2*2
8-2
MÃ´iTrÆ°á»ng2*211-5=6
(cÃ²n láº¡i: 2 6 8)
11-5=6
(cÃ²n láº¡i: 2 6 8)
8/6
8-68/28/6=1.33
(cÃ²n láº¡i: 2 1.33)
8-6=2
(cÃ²n láº¡i: 2 2)8/2=4
(cÃ²n láº¡i: 4 6)
6-4
4*6
4+6
CÃ³ kháº£ nÄƒngCritic LLM
KhÃ´ng thá»ƒ
KhÃ´ng thá»ƒ
TÃ´i Ä‘Ã£ sá»­ dá»¥ng 2 láº·p láº¡i. 2*2=4:
KhÃ´ng thá»ƒCÃ³ kháº£ nÄƒng
KhÃ´ng thá»ƒ
KhÃ´ng thá»ƒ
8/6=1.33
(cÃ²n láº¡i: 2 1.33)
2*2=4
(cÃ²n láº¡i: 4 6)
8-2=6
(cÃ²n láº¡i: 6 6)
6/4=2
(cÃ²n láº¡i: 2)
4*6=24
(cÃ²n láº¡i: 24)
4+6=10
(cÃ²n láº¡i: 10)
8/24-6=24
(cÃ²n láº¡i: 24)
4*6
8/2=4
(cÃ²n láº¡i: 4 6)
MÃ´iTrÆ°á»ngMÃ´iTrÆ°á»ng
LÃ½ luáº­nHÃ nh Ä‘á»™ng

HÃ¬nh 3: RAFA cho TrÃ² chÆ¡i 24. CÃ¡c hÃ nh Ä‘á»™ng Ä‘Æ°á»£c Ä‘á» xuáº¥t (Ä‘Æ°á»ng nÃ©t Ä‘á»©t) vÃ  Ä‘Æ°á»£c chá»n (xanh lÃ¡). CÃ¡c áº£o giÃ¡c ráº±ng cÃ¹ng má»™t sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i Ä‘Æ°á»£c giáº£m thiá»ƒu thÃ´ng qua tÆ°Æ¡ng tÃ¡c.

lá»‹ch sá»­ Dtk cho táº¥t cáº£ tkâ‰¤t < t k+1 cho Ä‘áº¿n khi chuyá»ƒn Ä‘á»•i thá»© (k+ 1) táº¡i bÆ°á»›c (tk+1âˆ’1), Ä‘iá»u nÃ y Ä‘áº£m báº£o ráº±ng phÃ¢n phá»‘i háº­u nghiá»‡m vÃ  hÃ nh Ä‘á»™ng tá»‘i Æ°u hÃ³a hoáº·c chÃ­nh sÃ¡ch tÆ°Æ¡ng á»©ng Ä‘Æ°á»£c cáº­p nháº­t má»™t cÃ¡ch báº£o thá»§. ChÃºng tÃ´i chá»‰ Ä‘á»‹nh Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i trong Pháº§n 4 vÃ  5.

"LÃ½ luáº­n cho TÆ°Æ¡ng lai" (DÃ²ng 6 trong Thuáº­t toÃ¡n 1 vÃ  DÃ²ng 3-11 trong Thuáº­t toÃ¡n 2).
NhÆ° Ä‘Æ°á»£c chi tiáº¿t dÆ°á»›i Ä‘Ã¢y, thÃ³i quen lÃ½ luáº­n sÃ¡ng tÃ¡c cÃ¡c thÃ³i quen con há»c vÃ  láº­p káº¿ hoáº¡ch Ä‘á»ƒ Ã¡nh xáº¡ toÃ n bá»™ lá»‹ch sá»­ Dtk (cho Ä‘áº¿n bÆ°á»›c tk) thÃ nh má»™t hÃ nh Ä‘á»™ng tá»‘i Æ°u hÃ³a at. LÆ°u Ã½ ráº±ng thÃ³i quen lÃ½ luáº­n khÃ´ng tÆ°Æ¡ng tÃ¡c vá»›i mÃ´i trÆ°á»ng bÃªn ngoÃ i trong suá»‘t cÃ¡c thÃ³i quen con há»c vÃ  láº­p káº¿ hoáº¡ch.

â€¢ThÃ³i quen con há»c (DÃ²ng 3-4 trong Thuáº­t toÃ¡n 2) Ã¡nh xáº¡ bá»™ Ä‘á»‡m bá»™ nhá»› Dtk thÃ nh má»™t nhÃ¢n chuyá»ƒn tiáº¿p (Model) vÃ  má»™t hÃ m giÃ¡ trá»‹ (Critic), Ä‘Æ°á»£c sá»­ dá»¥ng trong thÃ³i quen con láº­p káº¿ hoáº¡ch. Trong thá»±c táº¿, chÃºng tÃ´i nháº¯c LLM Ä‘á»ƒ táº¡o ra Æ°á»›c tÃ­nh cá»§a mÃ´i trÆ°á»ng bÃªn ngoÃ i dá»±a trÃªn bá»™ Ä‘á»‡m bá»™ nhá»›. á» Ä‘Ã¢y, Æ°á»›c tÃ­nh Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi hai LLM: Model vÃ  Critic, Æ°á»›c tÃ­nh cÃ¡c Ä‘á»‘i tÃ¡c thá»±c táº¿ cá»§a chÃºng liÃªn quan Ä‘áº¿n tham sá»‘ sinh dá»¯ liá»‡u. DÆ°á»›i Kháº³ng Ä‘á»‹nh 2.1, thÃ³i quen con há»c mang láº¡i cÃ¡c phiÃªn báº£n chÃ­nh xÃ¡c hÆ¡n cá»§a Model vÃ  Critic khi chÃºng tÃ´i nháº¯c chÃºng vá»›i táº­p há»£p pháº£n há»“i ngÃ y cÃ ng tÄƒng tá»« mÃ´i trÆ°á»ng bÃªn ngoÃ i. Káº¿t quáº£ lÃ , thÃ³i quen con láº­p káº¿ hoáº¡ch cÃ³ thá»ƒ sá»­ dá»¥ng chÃºng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ káº¿t quáº£ dÃ i háº¡n cá»§a hÃ nh Ä‘á»™ng vá»›i Ä‘á»™ chÃ­nh xÃ¡c cao hÆ¡n. TÃ¹y thuá»™c vÃ o viá»‡c chÃºng ta mÃ´ phá»ng cÃ¡ch tiáº¿p cáº­n dá»±a trÃªn mÃ´ hÃ¬nh hay khÃ´ng cÃ³ mÃ´ hÃ¬nh cá»§a RL, chÃºng ta cÃ³ thá»ƒ chá»n mÃ´ phá»ng Model hoáº·c Critic riÃªng láº». So vá»›i thÃ³i quen con há»c trong RL, chÃºng tÃ´i thay tháº¿ xáº¥p xá»‰ hÃ m tham sá»‘ hÃ³a (thÆ°á»ng lÃ  máº¡ng nÆ¡-ron sÃ¢u) báº±ng LLM vÃ  sá»­ dá»¥ng cÃ¡ch "trong ngá»¯ cáº£nh" Ä‘á»ƒ cáº­p nháº­t LLM, Ä‘iá»u nÃ y loáº¡i bá» nhu cáº§u cáº­p nháº­t tham sá»‘ rÃµ rÃ ng. Bá»Ÿi vÃ¬ LLM Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vÃ  tráº£i qua tinh chá»‰nh cÃ³ giÃ¡m sÃ¡t, chÃºng cung cáº¥p Æ°á»›c tÃ­nh tá»‘t hÆ¡n nhiá»u so vá»›i viá»‡c há»c tá»« Ä‘áº§u, dáº«n Ä‘áº¿n cáº£i thiá»‡n hiá»‡u quáº£ máº«u cho tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n.

Thuáº­t toÃ¡n 2 NgÆ°á»i há»c-láº­p káº¿ hoáº¡ch LLM (LLM-LR-PL): Má»™t vÃ­ dá»¥ tÃ¬m kiáº¿m cÃ¢y. (trÆ°á»ng há»£p xÃ¡c Ä‘á»‹nh)
1:Ä‘áº§u vÃ o : Bá»™ Ä‘á»‡m bá»™ nhá»› D, tráº¡ng thÃ¡i ban Ä‘áº§u s, Ä‘á»™ rá»™ng tÃ¬m kiáº¿m B, vÃ  Ä‘á»™ sÃ¢u tÃ¬m kiáº¿m U.
2:khá»Ÿi táº¡o : Khá»Ÿi táº¡o máº£ng tráº¡ng thÃ¡i S0â† {s} vÃ  máº£ng hÃ nh Ä‘á»™ng A0â†âˆ….
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con há»c) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
3:Äáº·t Model nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o tráº¡ng thÃ¡i tiáº¿p theo.
4:Äáº·t Critic nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ Æ°á»›c tÃ­nh hÃ m giÃ¡ trá»‹.
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con láº­p káº¿ hoáº¡ch) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
5:Äáº·t Elite nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o nhiá»u hÃ nh Ä‘á»™ng á»©ng viÃªn.
6:cho u= 0, . . . , U thá»±c hiá»‡n
7: Äá»‘i vá»›i má»—i tráº¡ng thÃ¡i hiá»‡n táº¡i trong Su, gá»i Elite Ä‘á»ƒ táº¡o B hÃ nh Ä‘á»™ng á»©ng viÃªn vÃ  lÆ°u trá»¯ chÃºng trong Au.
8: Äá»‘i vá»›i má»—i hÃ nh Ä‘á»™ng á»©ng viÃªn trong Au, gá»i Model Ä‘á»ƒ táº¡o tráº¡ng thÃ¡i tiáº¿p theo vÃ  lÆ°u trá»¯ nÃ³ trong Su+1.
9:káº¿t thÃºc cho
10:Äá»‘i vá»›i táº¥t cáº£ cÃ¡c rollout káº¿t quáº£ trong S0Ã— A 0Ã— Â·Â·Â· Ã— S UÃ— A U, gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n vÃ  chá»n rollout tá»‘t nháº¥t (sâ€ 0, aâ€ 0, . . . , sâ€ U, aâ€ U), trong Ä‘Ã³ sâ€ 0=s.
11:Ä‘áº§u ra : HÃ nh Ä‘á»™ng ban Ä‘áº§u aâ€ 0 cá»§a rollout Ä‘Æ°á»£c chá»n.

â€¢ThÃ³i quen con láº­p káº¿ hoáº¡ch (DÃ²ng 5-11 trong Thuáº­t toÃ¡n 2) Ã¡nh xáº¡ Model vÃ  Critic thÃ nh má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai (sâ€ 0, aâ€ 0, . . . , sâ€ U, aâ€ U), trong Ä‘Ã³ sâ€ 0 lÃ  tráº¡ng thÃ¡i hiá»‡n táº¡i st vÃ  aâ€ 0 Ä‘Æ°á»£c thá»±c thi trong mÃ´i trÆ°á»ng bÃªn ngoÃ i nhÆ° hÃ nh Ä‘á»™ng hiá»‡n táº¡i at trong giai Ä‘oáº¡n hÃ nh Ä‘á»™ng. Trá»±c quan, chÃºng tÃ´i nháº¯c LLM Ä‘á»ƒ táº¡o ra má»™t chÃ­nh sÃ¡ch tá»‘i Æ°u (actor) cho nhiá»u bÆ°á»›c tÆ°Æ¡ng lai, tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ (Critic). Tá»« quan Ä‘iá»ƒm RL (Pháº§n 2 vÃ  5), thÃ³i quen con láº­p káº¿ hoáº¡ch giáº£i gáº§n Ä‘Ãºng phÆ°Æ¡ng trÃ¬nh Bellman (Sutton vÃ  Barto, 2018), nÆ¡i chÃºng ta giáº£i chÃ­nh sÃ¡ch tá»‘i Æ°u (hoáº·c hÃ nh Ä‘á»™ng tÆ°Æ¡ng á»©ng) cho nhÃ¢n chuyá»ƒn tiáº¿p vÃ  hÃ m pháº§n thÆ°á»Ÿng Æ°á»›c tÃ­nh (hoáº·c critic) bá»Ÿi LLM. NhÆ° hai thá»ƒ hiá»‡n LLM tá»« thÃ³i quen con há»c, Model vÃ  Critic thá»±c hiá»‡n nhÃ¢n chuyá»ƒn tiáº¿p Æ°á»›c tÃ­nh vÃ  hÃ m giÃ¡ trá»‹ Æ°á»›c tÃ­nh. Do Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ mÃ´ phá»ng má»™t sá»‘ lÆ°á»£ng quá»¹ Ä‘áº¡o cho trÆ°á»›c vá»›i Model, Ä‘Ã¡nh giÃ¡ chÃºng vá»›i Critic, vÃ  thu Ä‘Æ°á»£c má»™t chÃ­nh sÃ¡ch cáº£i thiá»‡n, Ä‘iá»u nÃ y Ä‘áº¡t Ä‘Æ°á»£c báº±ng cÃ¡c lá»i nháº¯c Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c biá»‡t thay vÃ¬ má»™t thuáº­t toÃ¡n sá»‘. Báº±ng cÃ¡ch tá»‘i Ä‘a hÃ³a pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n (thay vÃ¬ pháº§n thÆ°á»Ÿng tá»©c thÃ¬), thÃ³i quen con láº­p káº¿ hoáº¡ch tráº£ vá» má»™t hÃ nh Ä‘á»™ng tá»‘i Æ°u hÃ³a cáº£i thiá»‡n káº¿t quáº£ dÃ i háº¡n. CÃ³ hai nguá»“n lá»—i áº£nh hÆ°á»Ÿng Ä‘áº¿n thÃ³i quen con láº­p káº¿ hoáº¡ch, cá»¥ thá»ƒ lÃ  báº¥t Ä‘á»‹nh háº­u nghiá»‡m, Ä‘Æ°á»£c káº¿ thá»«a tá»« Model vÃ  Critic do kÃ­ch thÆ°á»›c há»¯u háº¡n cá»§a Dtk, vÃ  tÃ­nh khÃ´ng tá»‘i Æ°u cá»§a láº­p káº¿ hoáº¡ch, Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi kháº£ nÄƒng tÃ­nh toÃ¡n háº¡n cháº¿, vÃ­ dá»¥, Ä‘á»™ rá»™ng vÃ  Ä‘á»™ sÃ¢u cÃ³ giá»›i háº¡n cá»§a tÃ¬m kiáº¿m cÃ¢y (DÃ²ng 6-9 trong Thuáº­t toÃ¡n 2). TÃ¹y thuá»™c vÃ o cáº¥u hÃ¬nh cá»¥ thá»ƒ cá»§a khÃ´ng gian tráº¡ng thÃ¡i vÃ  hÃ nh Ä‘á»™ng (liÃªn tá»¥c so vá»›i rá»i ráº¡c) vÃ  mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng (ngáº«u nhiÃªn so vá»›i xÃ¡c Ä‘á»‹nh), chÃºng ta cÃ³ thá»ƒ chá»n mÃ´ phá»ng thuáº­t toÃ¡n láº·p giÃ¡ trá»‹, thuáº­t toÃ¡n báº¯n ngáº«u nhiÃªn, hoáº·c thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Monte-Carlo. Táº¥t cáº£ chÃºng Ä‘á»u cho phÃ©p RAFA Ä‘áº¡t Ä‘Æ°á»£c Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh miá»…n lÃ  chÃºng thá»a mÃ£n má»™t yÃªu cáº§u cá»¥ thá»ƒ vá» tÃ­nh tá»‘i Æ°u (Äá»‹nh nghÄ©a 5.1). Äá»ƒ minh há»a, chÃºng tÃ´i mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y vÃ  trÃ¬ hoÃ£n biáº¿n thá»ƒ ngáº«u nhiÃªn cá»§a nÃ³ Ä‘áº¿n Phá»¥ lá»¥c B.
13

--- TRANG 14 ---
"HÃ nh Ä‘á»™ng cho Hiá»‡n táº¡i" (DÃ²ng 7-10 trong Thuáº­t toÃ¡n 1). Táº¡i tráº¡ng thÃ¡i hiá»‡n táº¡i st, tÃ¡c nhÃ¢n LLM thá»±c thi hÃ nh Ä‘á»™ng tá»‘i Æ°u hÃ³a at trong mÃ´i trÆ°á»ng bÃªn ngoÃ i, Ä‘Æ°á»£c thu Ä‘Æ°á»£c tá»« thÃ³i quen lÃ½ luáº­n. Cá»¥ thá»ƒ, chÃºng tÃ´i thá»±c hiá»‡n hÃ nh Ä‘á»™ng ban Ä‘áº§u aâ€ 0 cá»§a quá»¹ Ä‘áº¡o Ä‘Ã£ láº­p káº¿ hoáº¡ch (sâ€ 0, aâ€ 0, . . . , sâ€ U, aâ€ U), trong Ä‘Ã³ sâ€ 0=st vÃ  aâ€ 0=at, vÃ  loáº¡i bá» táº­p con cÃ²n láº¡i. Táº¡i tráº¡ng thÃ¡i tiáº¿p theo st+1, tÃ¡c nhÃ¢n LLM láº­p láº¡i káº¿ hoáº¡ch má»™t quá»¹ Ä‘áº¡o tÆ°Æ¡ng lai khÃ¡c (sâ€ 0, aâ€ 0, . . . , sâ€ U, aâ€ U) vá»›i sâ€ 0=st+1 vÃ  aâ€ 0=at+1. NÃ³i cÃ¡ch khÃ¡c, giai Ä‘oáº¡n hÃ nh Ä‘á»™ng theo má»™t táº­p con ngáº¯n háº¡n cá»§a káº¿ hoáº¡ch dÃ i háº¡n, Ä‘Æ°á»£c tÃ¡i táº¡o táº¡i má»—i tráº¡ng thÃ¡i má»›i. TÃ¡c nhÃ¢n LLM lÆ°u trá»¯ pháº£n há»“i thu tháº­p Ä‘Æ°á»£c (st, at, rt, st+1) trong bá»™ Ä‘á»‡m bá»™ nhá»› Dt vÃ  truy váº¥n Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i If-Switch Ä‘á»ƒ quyáº¿t Ä‘á»‹nh khi nÃ o cáº­p nháº­t bá»™ Ä‘á»‡m bá»™ nhá»› Dtk, Ä‘Æ°á»£c sá»­ dá»¥ng trong thÃ³i quen lÃ½ luáº­n nhÆ° ngá»¯ cáº£nh cho há»c vÃ  láº­p káº¿ hoáº¡ch. Trá»±c quan, chÃºng tÃ´i káº¿t há»£p pháº§n lá»‹ch sá»­ má»›i nháº¥t Dtâˆ’D tk Ä‘á»ƒ cáº£i thiá»‡n chÃ­nh sÃ¡ch hiá»‡n táº¡i chá»‰ khi nÃ³ mang thÃ´ng tin má»›i Ä‘Ã¡ng ká»ƒ, vÃ­ dá»¥, khi tÃ¡c nhÃ¢n LLM thua láº§n Ä‘áº§u tiÃªn sau má»™t chuá»—i tháº¯ng.

MÃ´ hÃ¬nh LLM Elite LLM
MÃ´itrÆ°á»ngLÃ½ luáº­n
HÃ nh Ä‘á»™ngÄáº§u vÃ o: 2 5 8 112*5
2+511-52*5=10
(cÃ²n láº¡i: 8 10 11)
2+5=7
(cÃ²n láº¡i: 7 8 11)11-5=6
(cÃ²n láº¡i: 2 6 8)
11-5
8/6
2*2
8-2
MÃ´iTrÆ°á»ng2*211-5=6
(cÃ²n láº¡i: 2 6 8)
11-5=6
(cÃ²n láº¡i: 2 6 8)
8/6
8-68/28/6=1.33
(cÃ²n láº¡i: 2 1.33)
8-6=2
(cÃ²n láº¡i: 2 2)8/2=4
(cÃ²n láº¡i: 4 6)
6-4
4*6
4+6
CÃ³ kháº£ nÄƒngCritic LLM
KhÃ´ng thá»ƒ
KhÃ´ng thá»ƒ
TÃ´i Ä‘Ã£ sá»­ dá»¥ng 2 láº·p láº¡i. 2*2=4:
KhÃ´ng thá»ƒCÃ³ kháº£ nÄƒng
KhÃ´ng thá»ƒ
KhÃ´ng thá»ƒ
8/6=1.33
(cÃ²n láº¡i: 2 1.33)
2*2=4
(cÃ²n láº¡i: 4 6)
8-2=6
(cÃ²n láº¡i: 6 6)
6/4=2
(cÃ²n láº¡i: 2)
4*6=24
(cÃ²n láº¡i: 24)
4+6=10
(cÃ²n láº¡i: 10)
8/24-6=24
(cÃ²n láº¡i: 24)
4*6
8/2=4
(cÃ²n láº¡i: 4 6)
MÃ´iTrÆ°á»ngMÃ´iTrÆ°á»ng
LÃ½ luáº­nHÃ nh Ä‘á»™ng

HÃ¬nh 4: RAFA cho TrÃ² chÆ¡i 24. CÃ¡c hÃ nh Ä‘á»™ng Ä‘Æ°á»£c Ä‘á» xuáº¥t (Ä‘Æ°á»ng nÃ©t Ä‘á»©t) vÃ  Ä‘Æ°á»£c chá»n (xanh lÃ¡). CÃ¡c áº£o giÃ¡c ráº±ng cÃ¹ng má»™t sá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i Ä‘Æ°á»£c giáº£m thiá»ƒu thÃ´ng qua tÆ°Æ¡ng tÃ¡c.
14

--- TRANG 15 ---
4 ThÃ­ nghiá»‡m
ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ RAFA trong má»™t sá»‘ benchmark dá»±a trÃªn vÄƒn báº£n, vÃ­ dá»¥, TrÃ² chÆ¡i 24, ALFWorld, BlocksWorld, vÃ  Tic-Tac-Toe. CÃ¡c thiáº¿t láº­p chi tiáº¿t, káº¿t quáº£, vÃ  nghiÃªn cá»©u loáº¡i bá» Ä‘Æ°á»£c cung cáº¥p trong Phá»¥ lá»¥c F, trong khi cÃ¡c lá»i nháº¯c chi tiáº¿t Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c G. ChÃºng tÃ´i phÃ¡t hÃ nh táº¥t cáº£ mÃ£ trÃªn trang: https://agentification.github.io/RAFA.

4.1 TrÃ² chÆ¡i 24
TrÃ² chÆ¡i 24 (Yao et al., 2023a) lÃ  má»™t cÃ¢u Ä‘á»‘ toÃ¡n há»c Ä‘á»ƒ thu Ä‘Æ°á»£c 24 tá»« bá»‘n sá»‘ tá»± nhiÃªn thÃ´ng qua cÃ¡c phÃ©p toÃ¡n sá»‘ há»c cÆ¡ báº£n. Tráº¡ng thÃ¡i lÃ  cÃ´ng thá»©c hiá»‡n táº¡i (cÃ³ thá»ƒ chÆ°a hoÃ n thÃ nh) vÃ  hÃ nh Ä‘á»™ng lÃ  cÃ´ng thá»©c tiáº¿p theo (hoáº·c pháº§n Ä‘Æ°á»£c sá»­a Ä‘á»•i).

Thiáº¿t láº­p. ChÃºng tÃ´i mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Ä‘á»ƒ láº­p káº¿ hoáº¡ch (Bâˆˆ {1,2}). Táº¡i bÆ°á»›c thá»© t, RAFA há»c tá»« bá»™ Ä‘á»‡m bá»™ nhá»› vÃ  chuyá»ƒn sang má»™t chÃ­nh sÃ¡ch má»›i khi nháº­n Ä‘Æ°á»£c pháº§n thÆ°á»Ÿng báº¥t ngá», Ä‘Ã¢y lÃ  Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i. Sau bÆ°á»›c thá»© t, RAFA tiÃªu hÃ³a pháº£n há»“i thu tháº­p Ä‘Æ°á»£c vÃ  táº¡o ra má»™t tÃ³m táº¯t ngÃ´n ngá»¯, Ä‘Æ°á»£c lÆ°u vÃ o bá»™ Ä‘á»‡m bá»™ nhá»› Ä‘á»ƒ trÃ¡nh nhá»¯ng lá»—i tÆ°Æ¡ng tá»± trÆ°á»›c Ä‘Ã³.

RAFA (B= 1) RAFA (B= 2) ToT(B= 1) ToT(B= 2) Reflexion
gpt-4 89% 93% 73% 81% 21%
gpt-3.5 29% 46% 10% 17% 16%
Báº£ng 2: Káº¿t quáº£ TrÃ² chÆ¡i 24.

Káº¿t quáº£. RAFA Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t SOTA nhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 2. RAFA Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u quáº£ máº«u vÆ°á»£t trá»™i báº±ng cÃ¡ch giáº£m thiá»ƒu áº£o giÃ¡c vÃ  trÃ¡nh cÃ¡c thá»­ nghiá»‡m báº¥t cáº©n (HÃ¬nh 4 vÃ  5).

3 6 9 12 15 18
BÆ°á»›c020406080100Tá»· lá»‡ ThÃ nh cÃ´ng (%)TrÃ² chÆ¡i 24, gpt-4
RAFA (b= 1)
RAFA (b= 2)
Reflexion
ToT(b= 1,20 thá»­ nghiá»‡m)
ToT(b= 2,20 thá»­ nghiá»‡m)
3 6 9 12 15 18
BÆ°á»›c01020304050Tá»· lá»‡ ThÃ nh cÃ´ng (%)TrÃ² chÆ¡i 24, gpt-3.5-turbo
RAFA (b= 1)
RAFA (b= 2)
Reflexion
ToT(b= 1,20 thá»­ nghiá»‡m)
ToT(b= 2,20 thá»­ nghiá»‡m)

HÃ¬nh 5: Hiá»‡u quáº£ máº«u trÃªn TrÃ² chÆ¡i 24.
15

--- TRANG 16 ---
Pick Clean Heat Cool Examine PickTwo Total
BUTLER 46.00 39.00 74.00 100.00 22.00 24.00 37.00
ReAct 66.67 41.94 91.03 80.95 55.56 35.29 61.94
AdaPlanner 100.00 96.77 95.65 100.00 100.00 47.06 91.79
Reflexion 100.00 90.32 82.61 90.48 100.00 94.12 92.54
RAFA 100.00 96.77 100.00 100.00 100.00 100.00 99.25
Báº£ng 3: Káº¿t quáº£ ALFWorld (tá»· lá»‡ thÃ nh cÃ´ng %).

4.2 ALFWorld
Elite LLMLÃ½ luáº­n
Model LLMBáº¡n tháº¥y má»™t nÄ©a 1
vÃ  má»™t cá»‘c 1.
Báº¡n tháº¥y má»™t Ä‘Ä©a cd 1
vÃ  má»™t cá»‘c 1.
Láº¥y trá»©ng 1
Láº¥y cá»‘c 1
tá»«
ngÄƒn kÃ©o 1Äi Ä‘áº¿n
ngÄƒn kÃ©o 1

Báº¡n tháº¥y má»™t bÃ¡nh mÃ¬
1 vÃ  má»™t trá»©ng 1.
Äi Ä‘áº¿n
ngÄƒn kÃ©o 1Äi Ä‘áº¿n
tá»§ 1
Äi Ä‘áº¿n
máº·t bÃ n
1
Critic LLM
Báº¡n tháº¥y má»™t
Ä‘Ä©a cd 1.
Trá»©ng 1 Ä‘Æ°á»£c
nháº·t lÃªn.
Cá»‘c 1 Ä‘Æ°á»£c
nháº·t lÃªn.Má»¥c tiÃªu: lÃ m nÃ³ng má»™t trá»©ng vÃ  
Ä‘áº·t nÃ³ lÃªn bÃ n Äƒn
Báº¡n tháº¥y má»™t
tá»§ 1, má»™t
máº·t bÃ n 1, má»™t
bÃ n Äƒn 1,
vÃ  má»™t ngÄƒn kÃ©o 1.
HÃ nh Ä‘á»™ng
MÃ´i trÆ°á»ng
...Äi Ä‘áº¿n
máº·t bÃ n 1

HÃ¬nh 6: Minh há»a RAFA trong mÃ´i trÆ°á»ng ALFWorld.

ALFWorld (Shridhar et al., 2020) lÃ  má»™t mÃ´i trÆ°á»ng tÆ°Æ¡ng tÃ¡c cho mÃ´ phá»ng tÃ¡c nhÃ¢n hiá»‡n thÃ¢n, bao gá»“m 134 nhiá»‡m vá»¥ gia Ä‘Ã¬nh trong sÃ¡u danh má»¥c tá»•ng thá»ƒ (Báº£ng 3). ChÃºng tÃ´i sá»­ dá»¥ng gpt-3 (text-davinci-003).

0 2 4 6 8 10
Táº­p6472808896Tá»· lá»‡ ThÃ nh cÃ´ng (%)ALFWorld, gpt-3 cho RAFA
RAFA
Reflexion
AdaPlanner
ReAct

HÃ¬nh 7: Hiá»‡u quáº£ máº«u trÃªn ALFWorld.Thiáº¿t láº­p. ChÃºng tÃ´i mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Ä‘á»ƒ láº­p káº¿ hoáº¡ch (B= 2). RAFA gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n hoÃ n thÃ nh cá»§a má»¥c tiÃªu mong muá»‘n vÃ  chuyá»ƒn sang má»™t chÃ­nh sÃ¡ch má»›i sau 20 láº§n tháº¥t báº¡i liÃªn tiáº¿p.

Káº¿t quáº£. RAFA vÆ°á»£t trá»™i hÆ¡n cÃ¡c khung hiá»‡n cÃ³ khÃ¡c nhau (HÃ¬nh 7). Hiá»‡u suáº¥t tá»‘t hÆ¡n cá»§a AdaPlanner á»Ÿ táº­p ban Ä‘áº§u Ä‘Æ°á»£c quy cho má»™t táº­p há»£p chÆ°Æ¡ng trÃ¬nh Ä‘Æ°á»£c cháº¿ tÃ¡c thá»§ cÃ´ng Ä‘á»ƒ tá»« chá»‘i cÃ¡c quá»¹ Ä‘áº¡o á»©ng viÃªn khÃ´ng tá»‘i Æ°u, Ä‘iá»u nÃ y thÃ¡ch thá»©c Ä‘á»ƒ xÃ¢y dá»±ng mÃ  khÃ´ng cÃ³ kiáº¿n thá»©c lÄ©nh vá»±c cá»§a má»™t nhiá»‡m vá»¥ cá»¥ thá»ƒ. Má»™t vÃ­ dá»¥ nhÆ° váº­y lÃ  danh má»¥c PickTwo.
16

--- TRANG 17 ---
4.3 BlocksWorld
BlocksWorld (Hao et al., 2023) chá»©a cÃ¡c nhiá»‡m vá»¥ Ä‘á»ƒ sáº¯p xáº¿p cÃ¡c khá»‘i thÃ nh cÃ¡c cáº¥u hÃ¬nh cá»¥ thá»ƒ.

Thiáº¿t láº­p. ChÃºng tÃ´i sá»­ dá»¥ng mÃ´ hÃ¬nh Vicuna (Zheng et al., 2023) vÃ  mÃ´ phá»ng thuáº­t toÃ¡n MCTS Ä‘á»ƒ láº­p káº¿ hoáº¡ch.

Gá»¡ khá»‘i vÃ ng
khá»i khá»‘i xanh
s1
Model LLM Critic LLM
Nháº·t lÃªn
khá»‘i cam

Gá»¡ khá»‘i tÃ­m
khá»i khá»‘i Ä‘á»
Elite LLM
LÃ½ luáº­n
Má»¥c tiÃªu: khá»‘i xanh á»Ÿ trÃªn
khá»‘i cam  
HÃ nh Ä‘á»™ng
MÃ´i trÆ°á»ng
...Gá»¡ khá»‘i vÃ ng
khá»i khá»‘i xanh

HÃ¬nh 8: RAFA cho BlocksWorld.

Káº¿t quáº£. RAFA Ä‘áº¡t Ä‘Æ°á»£c tá»· lá»‡ thÃ nh cÃ´ng vÆ°á»£t trá»™i trÃªn nhiá»u phiÃªn báº£n Vicuna (HÃ¬nh 9). So sÃ¡nh vá»›i CoT vÃ  RAP thá»ƒ hiá»‡n cÃ¡ch thÃ³i quen con há»c cáº£i thiá»‡n tÃ­nh tá»‘i Æ°u cá»§a láº­p káº¿ hoáº¡ch.

0 15 30 45 60
BÆ°á»›c020406080100Tá»· lá»‡ ThÃ nh cÃ´ng (%)BlocksWorld (4-bÆ°á»›c), Vicuna-13B
RAFA
RAP(thá»­ nghiá»‡m=10)
RAP(thá»­ nghiá»‡m=20)
0 15 30 45 60
BÆ°á»›c020406080100Tá»· lá»‡ ThÃ nh cÃ´ng (%)BlocksWorld (4-bÆ°á»›c), Vicuna-33B
RAFA
CoT(gpt-4)
CoT(LLaMA-33B)
RAP(thá»­ nghiá»‡m=10)
RAP(thá»­ nghiá»‡m=20)
0 15 30 45 60
BÆ°á»›c020406080100Tá»· lá»‡ ThÃ nh cÃ´ng (%)BlocksWorld (6-bÆ°á»›c), Vicuna-13B
RAFA
CoT(gpt-4)
RAP(thá»­ nghiá»‡m=10)
RAP(thá»­ nghiá»‡m=20)
CoT(LLaMA-33B)
0 15 30 45 60
BÆ°á»›c020406080100Tá»· lá»‡ ThÃ nh cÃ´ng (%)BlocksWorld (6-bÆ°á»›c), Vicuna-33B
RAFA
CoT(gpt-4)
CoT(LLaMA-33B)

HÃ¬nh 9: Hiá»‡u quáº£ máº«u trÃªn BlocksWorld (4 vÃ  6 lÃ  sá»‘ bÆ°á»›c tá»‘i thiá»ƒu Ä‘á»ƒ giáº£i quyáº¿t má»™t nhiá»‡m vá»¥ cá»¥ thá»ƒ). CoT Ä‘Æ°á»£c nháº¯c bá»Ÿi bá»‘n vÃ­ dá»¥ trong ngá»¯ cáº£nh.
17

--- TRANG 18 ---
4.4 Tic-Tac-Toe

0 2 4 6 8 10
Táº­pâˆ’0.9âˆ’0.6âˆ’0.30.00.30.60.9Äiá»ƒmTic-Tac-Toe (NgÆ°á»i chÆ¡i O), gpt-4
RAFA (B= 3)
RAFA (B= 4)

HÃ¬nh 10: Hiá»‡u quáº£ máº«u trÃªn Tic-Tac-Toe (0 cÃ³ nghÄ©a lÃ  hÃ²a).Tic-Tac-Toe (Beck, 2008) lÃ  má»™t trÃ² chÆ¡i cáº¡nh tranh nÆ¡i cÃ¡c bÃªn X vÃ  O thay phiÃªn nhau Ä‘áº·t dáº¥u. RAFA gá»i Model Ä‘á»ƒ mÃ´ phá»ng chuyá»ƒn tiáº¿p vÃ  Ä‘á»™ng lá»±c Ä‘á»‘i thá»§ (HÃ¬nh 18).

Thiáº¿t láº­p. ChÃºng tÃ´i sá»­ dá»¥ng gpt-4 vÃ  mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Ä‘á»ƒ láº­p káº¿ hoáº¡ch (Bâˆˆ {3,4}). RAFA chuyá»ƒn sang má»™t chÃ­nh sÃ¡ch má»›i khi (a) tráº¡ng thÃ¡i dá»± Ä‘oÃ¡n khÃ¡c vá»›i tráº¡ng thÃ¡i quan sÃ¡t Ä‘Æ°á»£c, (2) hÃ nh Ä‘á»™ng dá»± Ä‘oÃ¡n cá»§a Ä‘á»‘i thá»§ khÃ¡c vá»›i hÃ nh Ä‘á»™ng quan sÃ¡t Ä‘Æ°á»£c, hoáº·c (3) Critic Ä‘Æ°a ra dá»± Ä‘oÃ¡n sai vá» tráº¡ng thÃ¡i trÃ² chÆ¡i. á» Ä‘Ã¢y, X cÃ³ lá»£i tháº¿ báº¥t Ä‘á»‘i xá»©ng (tháº¯ng cháº¯c cháº¯n náº¿u chÆ¡i Ä‘Ãºng cÃ¡ch).

Káº¿t quáº£. RAFA (chÆ¡i O) ngang báº±ng vÃ  Ä‘Ã¡nh báº¡i gpt-4 cho T= 5 vÃ  T= 7 (Báº£ng 4), máº·c dÃ¹ O Ä‘á»‹nh má»‡nh thua. NghiÃªn cá»©u loáº¡i bá» (B= 3 so vá»›i B= 4) minh há»a cÃ¡ch tÃ­nh khÃ´ng tá»‘i Æ°u cá»§a láº­p káº¿ hoáº¡ch áº£nh hÆ°á»Ÿng Ä‘áº¿n hiá»‡u quáº£ máº«u (HÃ¬nh 10).

Elite LLM
L Ã½  l u áº­ n
Äá»™ng lá»±c
Model LLMCritic LLM ChÆ°a
xong
Äá»‘i thá»§
Model LLM
O | 2 | 3
-----------
4 | X | X
-----------
O | 8 | 9O | 2 | 3
-----------
O | X | X
-----------
X | 8 | 9O | 2 | 3
-----------
O | X | X
-----------
7 | 8 | 9
O | 2 | 3
-----------
X | X | X
-----------
O | 8 | 9Tháº¥tbáº¡iO | O | 3
-----------
4 | X | X
-----------
7 | 8 | 9O | O | 3
-----------
X | X | X
-----------
7 | 8 | 9
Tháº¥tbáº¡iH Ã  n h  Ä‘ á»™ n gO | 2 | 3
-----------
4 | X | X
-----------
7 | 8 | 9
MÃ´i trÆ°á»ng
...HÃ nh Ä‘á»™ng Ä‘á»‘i thá»§

HÃ¬nh 11: RAFA (chÆ¡i O) cho Tic-Tac-Toe.

X O gpt-4 RAFA (T=1) RAFA (T=5) RAFA (T=7)
gpt-4 90%, 0%, 10% 90%, 0%, 10% 50%, 0%, 50% 0%, 0%, 100%
Báº£ng 4: Káº¿t quáº£ Tic-Tac-Toe. ChÃºng tÃ´i Ä‘áº·t B= 4 vÃ  bÃ¡o cÃ¡o tá»· lá»‡ tháº¯ng cá»§a X, tá»· lá»‡ hÃ²a, vÃ  tá»· lá»‡ tháº¯ng cá»§a O.
18

--- TRANG 19 ---
5 PhÃ¢n tÃ­ch LÃ½ thuyáº¿t
Trong pháº§n nÃ y, chÃºng tÃ´i cung cáº¥p cÃ¡c káº¿t quáº£ lÃ½ thuyáº¿t trong bÃ i bÃ¡o nÃ y. Trong Pháº§n 5.1, chÃºng tÃ´i Ä‘áº·c trÆ°ng yÃªu cáº§u cho thÃ³i quen con láº­p káº¿ hoáº¡ch trong RAFA vÃ  hiá»ƒn thá»‹ thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ vá»›i chÃ¢n trá»i cáº¯t ngáº¯n cÃ³ thá»ƒ lÃ  má»™t vÃ­ dá»¥ cá»§a ngÆ°á»i láº­p káº¿ hoáº¡ch mong muá»‘n. Trong Pháº§n 5.2, chÃºng tÃ´i hiá»ƒn thá»‹ ráº±ng LLM vá»›i cÄƒn chá»‰nh háº­u nghiá»‡m thá»±c hiá»‡n BMA, há»— trá»£ Kháº³ng Ä‘á»‹nh 2.1 vá» máº·t lÃ½ thuyáº¿t. ChÃºng tÃ´i trÃ¬nh bÃ y phÃ¢n tÃ­ch há»‘i tiáº¿c cho RAFA trong Pháº§n 5.3 Ä‘á»ƒ giáº£i thÃ­ch hiá»‡u suáº¥t thá»±c nghiá»‡m vÆ°á»£t trá»™i cá»§a nÃ³, nÆ¡i chÃºng tÃ´i cung cáº¥p cÃ¡c giáº£ Ä‘á»‹nh cáº§n thiáº¿t vÃ  rÃ ng buá»™c há»‘i tiáº¿c cá»§a RAFA. Trong Pháº§n 5.4, chÃºng tÃ´i hiá»ƒn thá»‹ ráº±ng RAFA cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­a Ä‘á»•i Ä‘á»ƒ khuyáº¿n khÃ­ch khÃ¡m phÃ¡ hiá»‡u quáº£ cho cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p hÆ¡n sao cho RAFA váº«n hiá»‡u quáº£ máº«u mÃ  khÃ´ng cÃ³ giáº£ Ä‘á»‹nh táº­p trung trong Pháº§n 5.3.

5.1 TÃ­nh tá»‘i Æ°u cá»§a Láº­p káº¿ hoáº¡ch
Äá»ƒ Ä‘áº·c trÆ°ng yÃªu cáº§u cho thÃ³i quen con láº­p káº¿ hoáº¡ch trong RAFA (Thuáº­t toÃ¡n 1), chÃºng tÃ´i Ä‘á»‹nh nghÄ©a ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u nhÆ° sau.

Äá»‹nh nghÄ©a 5.1 (NgÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-Tá»‘i Æ°u). KÃ½ hiá»‡u {V|V lÃ  má»™t hÃ m giÃ¡ trá»‹} nhÆ° V. Má»™t thuáº­t toÃ¡n láº­p káº¿ hoáº¡ch PLÏµ:P Ã— R 7â†’ Î Ã— V lÃ  má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u náº¿u PLÏµ(P, r) = (Ï€, V), trong Ä‘Ã³ |Q(s, a)âˆ’r(s, a)âˆ’Î³Â·(PV)(s, a)| â‰¤Ïµ vÃ  V(s) = max aQ(s, a) =Q(s, Ï€(s)) cho táº¥t cáº£ (s, a)âˆˆ S Ã— A.

NÃ³i cÃ¡ch khÃ¡c, má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u vá»›i má»™t mÃ´ hÃ¬nh (nhÃ¢n chuyá»ƒn tiáº¿p vÃ  hÃ m pháº§n thÆ°á»Ÿng) cÃ³ thá»ƒ táº¡o ra má»™t chÃ­nh sÃ¡ch Ä‘á»ƒ tá»‘i Ä‘a hÃ³a gáº§n Ä‘Ãºng hÃ m giÃ¡ trá»‹ dÃ i háº¡n tÆ°Æ¡ng á»©ng thay vÃ¬ pháº§n thÆ°á»Ÿng cáº­n thá»‹ vá»›i giá»›i háº¡n lá»—i gáº§n Ä‘Ãºng Ïµ. NhÆ° má»™t thá»ƒ hiá»‡n cá»§a ngÆ°á»i láº­p káº¿ hoáº¡ch thá»a mÃ£n Äá»‹nh nghÄ©a 5.1, chÃºng tÃ´i trÃ¬nh bÃ y thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ (Thuáº­t toÃ¡n 3) vá»›i chÃ¢n trá»i cáº¯t ngáº¯n U, tá»©c lÃ , Ä‘á»™ dÃ i há»¯u háº¡n cá»§a cá»­a sá»• nhÃ¬n trÆ°á»›c nhÆ° ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u trong Thuáº­t toÃ¡n 4. Má»‡nh Ä‘á» sau Ä‘áº£m báº£o ráº±ng Thuáº­t toÃ¡n 3 thá»a mÃ£n Äá»‹nh nghÄ©a 5.1.

Má»‡nh Ä‘á» 5.2. Thuáº­t toÃ¡n 3 lÃ  má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u miá»…n lÃ  chÃºng ta Ä‘áº·t Uâ‰¥1+âŒˆlogÎ³(Ïµ/L)âŒ‰ vÃ  báº¥t ká»³ hÃ m giÃ¡ trá»‹ nÃ o Ä‘Æ°á»£c giá»›i háº¡n bá»Ÿi Lâ‰¥0.

Chá»©ng minh. Xem Phá»¥ lá»¥c C.1 cho chá»©ng minh chi tiáº¿t.

Thuáº­t toÃ¡n 3 NgÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u: Thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ vá»›i chÃ¢n trá»i cáº¯t ngáº¯n.
1:Ä‘áº§u vÃ o : MÃ´ hÃ¬nh (P, r) vÃ  chÃ¢n trá»i cáº¯t ngáº¯n U.
2:khá»Ÿi táº¡o : Äáº·t hÃ m giÃ¡ trá»‹ V(U)_Î¸(Â·)â†0.
3:cho u=Uâˆ’1, . . . , 1 thá»±c hiá»‡n
4: Äáº·t hÃ m giÃ¡ trá»‹ V(u)(Â·)â†max aâˆˆAQ(u)(Â·, a), trong Ä‘Ã³ Q(u)(Â·,Â·)â†r(Â·,Â·) + Î³(PV(u+1))(Â·,Â·).
5:káº¿t thÃºc cho
6:Ä‘áº§u ra : ChÃ­nh sÃ¡ch tham lam Ï€(Â·) = arg max aâˆˆAQ(1)(Â·, a) vÃ  hÃ m giÃ¡ trá»‹ V(1).
19

--- TRANG 20 ---
Thay vÃ o Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ chá»n mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y, thuáº­t toÃ¡n báº¯n ngáº«u nhiÃªn, hoáº·c thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y Monte-Carlo. Trong vÃ­ dá»¥ tÃ¬m kiáº¿m cÃ¢y (DÃ²ng 5-11 trong Thuáº­t toÃ¡n 2), Ïµ giáº£m khi Ä‘á»™ rá»™ng tÃ¬m kiáº¿m B vÃ  Ä‘á»™ sÃ¢u U tÄƒng. LÆ°u Ã½ ráº±ng, miá»…n lÃ  chÃºng ta mÃ´ phá»ng má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u, chÃºng ta cÃ³ thá»ƒ thiáº¿t láº­p Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh.

5.2 LLM vá»›i CÄƒn chá»‰nh Háº­u nghiá»‡m Thá»±c hiá»‡n Trung bÃ¬nh MÃ´ hÃ¬nh Bayesian (BMA)

Trong pháº§n sau, chÃºng tÃ´i phÃ¢n tÃ­ch Kháº³ng Ä‘á»‹nh 2.1 tá»« quan Ä‘iá»ƒm lÃ½ thuyáº¿t. Äá»‘i vá»›i LLM Ä‘Æ°á»£c sá»­ dá»¥ng trong RAFA, chÃºng tÃ´i kÃ½ hiá»‡u PLLM(Î¾(s,a)|D, s, a) nhÆ° thÆ°á»›c Ä‘o xÃ¡c suáº¥t cá»§a cáº·p tráº¡ng thÃ¡i-pháº§n thÆ°á»Ÿng dá»± Ä‘oÃ¡n cho cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n vÃ  bá»™ Ä‘á»‡m bá»™ nhá»› D nhÆ° táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh. ÄÆ°á»£c gÃ¢y ra bá»Ÿi PLLM, chÃºng tÃ´i cÅ©ng kÃ½ hiá»‡u PLLM(D) vÃ  rLLM(D) nhÆ° nhÃ¢n chuyá»ƒn tiáº¿p Æ°á»›c tÃ­nh vÃ  hÃ m pháº§n thÆ°á»Ÿng bá»Ÿi LLM, tÆ°Æ¡ng á»©ng.

Äá»ƒ Ä‘Æ¡n giáº£n hÃ³a phÃ¢n tÃ­ch, chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng táº¥t cáº£ LLM cÃ³ cÄƒn chá»‰nh háº­u nghiá»‡m trong cÃ¡c nhiá»‡m vá»¥ mÃ  chÃºng tÃ´i nghiÃªn cá»©u, tá»©c lÃ , phÃ¢n phá»‘i háº­u nghiá»‡m cá»§a chÃºng vá» pháº§n thÆ°á»Ÿng vÃ  tráº¡ng thÃ¡i tiáº¿p theo cho cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng hiá»‡n táº¡i vÃ  báº¥t ká»³ táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh nÃ o khá»›p vá»›i háº­u nghiá»‡m trong cÃ¡c nhiá»‡m vá»¥ nÃ y. ChÃºng tÃ´i cÃ´ng thá»©c hÃ³a giáº£ Ä‘á»‹nh nÃ y nhÆ° sau.

Giáº£ Ä‘á»‹nh 5.3 (CÄƒn chá»‰nh Háº­u nghiá»‡m). ChÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng LLM Ä‘Æ°á»£c cÄƒn chá»‰nh vá»›i háº­u nghiá»‡m cá»§a tráº¡ng thÃ¡i vÃ  pháº§n thÆ°á»Ÿng trong MDP cÆ¡ báº£n, Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ°

PLLM[Î¾(s,a)|D, s, a] = Ppost[Î¾(s,a)|D, s, a],

cho báº¥t ká»³ táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D={(si, ai, ri, sâ€²i)}I_i=0 vá»›i kÃ­ch thÆ°á»›c I, cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a), pháº§n thÆ°á»Ÿng r, vÃ  tráº¡ng thÃ¡i sâ€². á» Ä‘Ã¢y, háº­u nghiá»‡m Ppost Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong (2.4).

ChÃºng tÃ´i nháº­n xÃ©t ráº±ng cÄƒn chá»‰nh háº­u nghiá»‡m trong Giáº£ Ä‘á»‹nh 5.3 Ä‘áº¿n tá»« kháº£ nÄƒng trong ngá»¯ cáº£nh cá»§a LLM, Ä‘Æ°á»£c nghiÃªn cá»©u rá»™ng rÃ£i trong Lee et al. (2023); Wies et al. (2024); Xie et al. (2021). ChÃºng tÃ´i cÅ©ng nháº­n xÃ©t ráº±ng Giáº£ Ä‘á»‹nh 5.3 khÃ´ng cÃ³ nghÄ©a lÃ  LLM cÃ³ thá»ƒ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh tá»‘i Æ°u má»™t cÃ¡ch táº§m thÆ°á»ng táº¡i má»—i bÆ°á»›c trong MDP cÆ¡ báº£n: (1) Máº·c dÃ¹ cÃ¡c phÃ¢n phá»‘i háº­u nghiá»‡m cá»§a tráº¡ng thÃ¡i vÃ  pháº§n thÆ°á»Ÿng Ä‘Æ°á»£c cÄƒn chá»‰nh, LLM váº«n cáº§n Ä‘Æ°á»£c hÆ°á»›ng dáº«n Ä‘á»ƒ tá»‘i Ä‘a hÃ³a giÃ¡ trá»‹ dÃ i háº¡n (thÃ´ng qua láº­p káº¿ hoáº¡ch rÃµ rÃ ng) thay vÃ¬ pháº§n thÆ°á»Ÿng cáº­n thá»‹. (2) LLM váº«n yÃªu cáº§u tÆ°Æ¡ng tÃ¡c trá»±c tuyáº¿n Ä‘á»ƒ má»Ÿ rá»™ng táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D sao cho báº¥t Ä‘á»‹nh dá»± Ä‘oÃ¡n cá»§a chÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£m tá»« báº¥t Ä‘á»‹nh tiÃªn nghiá»‡m. Trong Phá»¥ lá»¥c C.7, chÃºng tÃ´i cÅ©ng tháº£o luáº­n cÃ¡ch ná»›i lá»ng Giáº£ Ä‘á»‹nh 5.3 Ä‘á»ƒ chá»©a má»™t thuáº­t ngá»¯ lá»—i bá»• sung trong rÃ ng buá»™c há»‘i tiáº¿c Ä‘Æ°á»£c suy ra bá»Ÿi phÃ¢n tÃ­ch cá»§a chÃºng tÃ´i, nÆ¡i chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng LLM lÃ  bá»™ Æ°á»›c tÃ­nh kháº£ nÄƒng tá»‘i Ä‘a (MLE) trÃªn táº­p dá»¯ liá»‡u tiá»n huáº¥n luyá»‡n vá»›i phá»§ sÃ³ng Ä‘á»u. Dá»±a trÃªn Giáº£ Ä‘á»‹nh 5.3, chÃºng tÃ´i chá»©ng minh ráº±ng LLM vá»›i cÄƒn chá»‰nh háº­u nghiá»‡m thá»±c hiá»‡n BMA trong Æ°á»›c tÃ­nh mÃ´ hÃ¬nh trong má»‡nh Ä‘á» sau.

Má»‡nh Ä‘á» 5.4 (LLM vá»›i CÄƒn chá»‰nh Háº­u nghiá»‡m Thá»±c hiá»‡n BMA). DÆ°á»›i Giáº£ Ä‘á»‹nh 5.3, cÃ¡c dá»± Ä‘oÃ¡n LLM thá»a mÃ£n

rLLM(D)(s, a) +Î³Â·(PLLM(D)V)(s, a) =EÎ¸âˆ¼Ppost(Â·|D)[(BÎ¸V)(s, a)]
20

--- TRANG 21 ---
cho báº¥t ká»³ táº­p dá»¯ liá»‡u D={(si, ai, ri, sâ€²i)}I_i=0 vá»›i kÃ­ch thÆ°á»›c I, hÃ m giÃ¡ trá»‹ V, vÃ  cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a)âˆˆ S Ã—A. á» Ä‘Ã¢y, Ppost(Î¸|D) lÃ  háº­u nghiá»‡m cá»§a Î¸â‹† cho D trong MDP cÆ¡ báº£n.

Chá»©ng minh Má»‡nh Ä‘á» 5.4. Xem chá»©ng minh chi tiáº¿t trong Phá»¥ lá»¥c C.2.

Chá»©ng minh cá»§a Má»‡nh Ä‘á» 5.4 cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong Phá»¥ lá»¥c C.2. Má»™t sá»‘ biáº¿n thá»ƒ cá»§a Má»‡nh Ä‘á» 5.4 cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong cÃ¡c tÃ i liá»‡u khÃ¡c nhau (Lee et al., 2023; Zhang et al., 2022, 2023b). Cá»¥ thá»ƒ, Zhang et al. (2022) thiáº¿t láº­p sá»± tÆ°Æ¡ng Ä‘Æ°Æ¡ng lÃ½ thuyáº¿t giá»¯a BMA vÃ  kiáº¿n trÃºc attention lÃ½ tÆ°á»Ÿng vÃ  phÃ¢n tÃ­ch tá»· lá»‡ lá»—i tá»•ng quÃ¡t hÃ³a cá»§a LLM. Bá»Ÿi Má»‡nh Ä‘á» 5.4, LLM cÃ³ thá»ƒ cung cáº¥p Æ°á»›c tÃ­nh cháº¯c cháº¯n vÃ  chÃ­nh xÃ¡c hÆ¡n cho mÃ´ hÃ¬nh sinh dá»¯ liá»‡u vá»›i nhiá»u pháº£n há»“i thu tháº­p Ä‘Æ°á»£c hÆ¡n, vÃ¬ báº¥t Ä‘á»‹nh trong háº­u nghiá»‡m giáº£m vá»›i nhiá»u dá»¯ liá»‡u hÆ¡n. VÃ¬ váº­y, Má»‡nh Ä‘á» 5.4 há»— trá»£ Kháº³ng Ä‘á»‹nh 2.1 vá» máº·t lÃ½ thuyáº¿t.

5.3 RÃ ng buá»™c Há»‘i tiáº¿c cá»§a RAFA

Thuáº­t toÃ¡n 4 LÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i (RAFA): PhiÃªn báº£n lÃ½ thuyáº¿t.
1:Ä‘áº§u vÃ o : Má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u PLÏµ, tráº£ vá» má»™t chÃ­nh sÃ¡ch Ïµ-tá»‘i Æ°u tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c Ïµ (Äá»‹nh nghÄ©a 5.1), vÃ  LLM vá»›i cÄƒn chá»‰nh háº­u nghiá»‡m.
2:khá»Ÿi táº¡o : Láº¥y máº«u tráº¡ng thÃ¡i ban Ä‘áº§u s0âˆ¼Ï, Ä‘áº·t t= 0, vÃ  khá»Ÿi táº¡o bá»™ Ä‘á»‡m bá»™ nhá»› D0=âˆ….
3:cho k= 0,1, . . . , thá»±c hiá»‡n
4: Äáº·t tkâ†t.
5:láº·p láº¡i
6: Láº­p káº¿ hoáº¡ch trÆ°á»›c vá»›i ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u vÃ  LLM (Ï€t, Vt)â†PLÏµ(PLLM(Dtk), rLLM(Dtk)). ("lÃ½ luáº­n cho tÆ°Æ¡ng lai")
7: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at=Ï€t(st) Ä‘á»ƒ nháº­n pháº§n thÆ°á»Ÿng rt vÃ  tráº¡ng thÃ¡i st+1 tá»« mÃ´i trÆ°á»ng. ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i")
8: Cáº­p nháº­t bá»™ Ä‘á»‡m bá»™ nhá»› Dt+1â† D tâˆª {(st, at, st+1, rt)}.
9: Äáº·t tâ†t+ 1.
10: cho Ä‘áº¿n khi Htkâˆ’Ht>log 2, trong Ä‘Ã³ Ht kÃ½ hiá»‡u entropy háº­u nghiá»‡m cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn Dt. (Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c thá»a mÃ£n)
11:káº¿t thÃºc cho

Äá»ƒ phÃ¢n tÃ­ch RAFA vá» máº·t lÃ½ thuyáº¿t, chÃºng tÃ´i Ä‘á» xuáº¥t phiÃªn báº£n lÃ½ thuyáº¿t cá»§a RAFA trong Thuáº­t toÃ¡n 4, nÆ¡i chÃºng tÃ´i thá»±c hiá»‡n Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i cá»§a RAFA trong DÃ²ng 10 báº±ng cÃ¡ch Ä‘o giáº£m entropy háº­u nghiá»‡m. Táº¡i bÆ°á»›c thá»© t vÃ  láº§n chuyá»ƒn Ä‘á»•i thá»© k, Thuáº­t toÃ¡n 6 chá»‰ thá»±c hiá»‡n chuyá»ƒn Ä‘á»•i thá»© (k+1) khi giáº£m entropy háº­u nghiá»‡m Htkâˆ’Ht lá»›n hÆ¡n log 2. Trong DÃ²ng 6 cá»§a Thuáº­t toÃ¡n 4, chÃºng tÃ´i mÃ´ táº£ thÃ³i quen con láº­p káº¿ hoáº¡ch trong RAFA (Thuáº­t toÃ¡n 1) báº±ng má»™t Ïµ-planner PLÏµ (Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Äá»‹nh nghÄ©a 5.1). ChÃºng tÃ´i chá»‰ Ä‘á»‹nh Ä‘iá»u kiá»‡n káº¿t thÃºc cho Thuáº­t toÃ¡n 4. Gá»i (Kâˆ’1) lÃ  tá»•ng sá»‘ chuyá»ƒn Ä‘á»•i cho Ä‘áº¿n khi t Ä‘áº¡t (Tâˆ’1). Gá»i tK=T. Táº¡i bÆ°á»›c (Tâˆ’1), Thuáº­t toÃ¡n 4 thá»±c thi aTâˆ’1=Ï€Tâˆ’1(sTâˆ’1), trong Ä‘Ã³ chÃºng ta cÃ³ Ï€Tâˆ’1=PLÏµ(PLLM(DtKâˆ’1), rLLM(DtKâˆ’1)). Khi nháº­n rTâˆ’1 vÃ  sT tá»« mÃ´i trÆ°á»ng bÃªn ngoÃ i, Thuáº­t toÃ¡n 4 cáº­p nháº­t DT={(st, at, st+1, rt)}Tâˆ’1_t=0 vÃ  káº¿t thÃºc. VÃ¬ tÃ¡c nhÃ¢n trong Thuáº­t toÃ¡n 4 thá»±c thi cÃ¹ng má»™t chÃ­nh sÃ¡ch cho Ä‘áº¿n khi thá»±c hiá»‡n chuyá»ƒn Ä‘á»•i, chÃºng ta cÃ³ Ï€t=Ï€tk cho báº¥t ká»³ tkâ‰¤k < t k+1. ChÃºng tÃ´i kÃ½ hiá»‡u bá»Ÿi Ï€k=Ï€tk cho sá»± Ä‘Æ¡n giáº£n kÃ½ hiá»‡u. Tiáº¿p theo, chÃºng tÃ´i Ã¡p Ä‘áº·t má»™t giáº£ Ä‘á»‹nh tÃ­nh quy luáº­t vá» cáº¥u trÃºc cá»§a MDP Ä‘á»ƒ Ä‘o Ä‘á»™ khÃ³ há»c. Nhá»› láº¡i ráº±ng chÃºng tÃ´i Ä‘á»‹nh nghÄ©a entropy háº­u nghiá»‡m Ht trong (2.5), tÄƒng thÃ´ng tin I(Î¸;Î¾|D), vÃ  Î¾(s,a) nhÆ° cáº·p cá»§a tráº¡ng thÃ¡i tiáº¿p theo vÃ  pháº§n thÆ°á»Ÿng hiá»‡n táº¡i (sâ€², r) cho cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a) trong Pháº§n 2. Äá»‹nh nghÄ©a Ht nhÆ° entropy háº­u nghiá»‡m H(Î¸|Dt) cho táº­p dá»¯ liá»‡u Dt={(si, ai, ri, si+1)}tâˆ’1_i=0.

Giáº£ Ä‘á»‹nh 5.5 (TÃ­nh Quy luáº­t MDP). ChÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng tá»“n táº¡i má»™t há»‡ sá»‘ Î· >0 sao cho, náº¿u Ht1âˆ’Ht2â‰¤log 2, thÃ¬ Ä‘iá»u Ä‘Ã³ xáº£y ra

I(Î¸;Î¾(s,a)|Dt1)â‰¤4Î·Â·I(Î¸;Î¾(s,a)|Dt2)

cho báº¥t ká»³ hÃ m giÃ¡ trá»‹ V, t1< t2 vÃ  (s, a)âˆˆ S Ã— A cho trÆ°á»›c.

Giáº£ Ä‘á»‹nh 5.5 lÃ  má»™t giáº£ Ä‘á»‹nh tÃ­nh quy luáº­t vá» MDP vÃ  lÃ  ná»™i táº¡i Ä‘á»‘i vá»›i thiáº¿t káº¿ tÃ¡c nhÃ¢n. Trong Phá»¥ lá»¥c E, chÃºng tÃ´i chá»©ng minh ráº±ng MDP nhÃ¢n tuyáº¿n tÃ­nh Bayesian d-chiá»u (Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Äá»‹nh nghÄ©a E.1), thá»a mÃ£n Giáº£ Ä‘á»‹nh 5.5 vá»›i há»‡ sá»‘ Î·=d/log(1 + d). Trá»±c quan, Giáº£ Ä‘á»‹nh 5.5 háº¡n cháº¿ sá»± gia tÄƒng cá»§a tÄƒng thÃ´ng tin cho má»™t bit (log 2) giáº£m entropy háº­u nghiá»‡m.

TÆ°Æ¡ng tá»± nhÆ° cÃ¡c cÃ´ng viá»‡c lÃ½ thuyáº¿t khÃ¡c vá» RL sÃ¢u (Lazaric et al., 2010; Fan et al., 2020; Zhang et al., 2020), chÃºng tÃ´i giá»›i thiá»‡u há»‡ sá»‘ táº­p trung Îº Ä‘á»ƒ giá»›i háº¡n sá»± dá»‹ch chuyá»ƒn phÃ¢n phá»‘i giá»¯a chÃ­nh sÃ¡ch hiá»‡n táº¡i vÃ  chÃ­nh sÃ¡ch tá»‘i Æ°u. Äá»ƒ Ä‘Æ¡n giáº£n hÃ³a tháº£o luáº­n, chÃºng tÃ´i Ä‘á»‹nh nghÄ©a thÆ°á»›c Ä‘o viáº¿ng thÄƒm Î³-giáº£m giÃ¡ tá»‘i Æ°u Î½â‹† báº¯t Ä‘áº§u tá»« tráº¡ng thÃ¡i s nhÆ°

Î½â‹†(sâ€²|s) =1/(1âˆ’Î³)Â·âˆ‘âˆ_Ï„=0Î³Ï„Â·P[sÏ„=sâ€²|s0=s, si+1âˆ¼PÎ¸â‹†(Â·|si, Ï€â‹†(si)) cho báº¥t ká»³ 0 â‰¤i < Ï„], (5.1)

cho báº¥t ká»³ tráº¡ng thÃ¡i s, sâ€²âˆˆ S. á» Ä‘Ã¢y, Î½â‹†(Â·|s) mÃ´ táº£ thÆ°á»›c Ä‘o xÃ¡c suáº¥t trung bÃ¬nh giáº£m giÃ¡ cá»§a tráº¡ng thÃ¡i mÃ  chÃ­nh sÃ¡ch tá»‘i Æ°u Ï€â‹† viáº¿ng thÄƒm báº¯t Ä‘áº§u tá»« tráº¡ng thÃ¡i s trong MDP cÆ¡ báº£n. BÃ¢y giá», chÃºng tÃ´i sáºµn sÃ ng cung cáº¥p tuyÃªn bá»‘ Ä‘áº§y Ä‘á»§ cá»§a há»‡ sá»‘ táº­p trung nhÆ° sau.

Giáº£ Ä‘á»‹nh 5.6 (Táº­p trung). Äá»‘i vá»›i RAFA (Thuáº­t toÃ¡n 4), chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng tá»“n táº¡i má»™t háº±ng sá»‘ Îº <âˆ sao cho

E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk EÎ¸â‹†âˆ¼Ptk[Esâˆ¼Î½â‹†(Â·|st)[(Bkâˆ’BÎ¸â‹†)Vt]2(s, Ï€â‹†(s))] / [(Bkâˆ’BÎ¸â‹†)Vt]2(st, Ï€k(st))|Dtk]]]

Ä‘Æ°á»£c giá»›i háº¡n bá»Ÿi Îº2Â·T, trong Ä‘Ã³ chÃºng tÃ´i Ä‘á»‹nh nghÄ©a (BkV)(s, a) =rLLM(Dtk)(s, a) +Î³Â·(PLLM(Dtk)V)(s, a) vÃ  kÃ½ hiá»‡u bá»Ÿi Ptk háº­u nghiá»‡m cá»§a Î¸â‹† cho Dtk.
22

--- TRANG 23 ---
Trá»±c quan, Îº Ä‘o Ä‘á»™ khÃ³ Ä‘á»ƒ tá»•ng quÃ¡t hÃ³a lá»—i dá»± Ä‘oÃ¡n tháº¥p (Bkâˆ’BÎ¸â‹†)Vt trÃªn quá»¹ Ä‘áº¡o hiá»‡n táº¡i Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi Ï€k Ä‘áº¿n quá»¹ Ä‘áº¡o tá»‘i Æ°u Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi Ï€â‹† trong MDP cÆ¡ báº£n. ChÃºng tÃ´i nháº­n xÃ©t ráº±ng chÃºng ta cÃ³ thá»ƒ bá» sá»± phá»¥ thuá»™c cá»§a há»‡ sá»‘ táº­p trung Îº (Giáº£ Ä‘á»‹nh 5.6) náº¿u chÃºng ta sá»­a Ä‘á»•i RAFA Ä‘á»ƒ khuyáº¿n khÃ­ch khÃ¡m phÃ¡ hiá»‡u quáº£ trong MDP. ChÃºng tÃ´i sáº½ tháº£o luáº­n cÃ¡c biáº¿n thá»ƒ cá»§a RAFA vá»›i cÃ¡c chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ hiá»‡u quáº£ trong Pháº§n 5.4.

Trong Ä‘á»‹nh lÃ½ sau, chÃºng tÃ´i Ä‘Æ°a ra rÃ ng buá»™c cá»§a há»‘i tiáº¿c Bayesian cá»§a RAFA (Thuáº­t toÃ¡n 4) nhÆ° sau.

Äá»‹nh lÃ½ 5.7. DÆ°á»›i Giáº£ Ä‘á»‹nh 5.3, 5.5, vÃ  5.6, há»‘i tiáº¿c Bayesian cá»§a RAFA (Thuáº­t toÃ¡n 4) thá»a mÃ£n

R(T) =O[(Îº+ 1)LÂ·âˆšE[H0âˆ’HT]/(1âˆ’Î³)Â·âˆšT+Ïµ/(1âˆ’Î³)Â·T+LÂ·E[H0âˆ’HT]/(1âˆ’Î³)],

trong Ä‘Ã³ Îº lÃ  há»‡ sá»‘ táº­p trung Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Giáº£ Ä‘á»‹nh 5.6, Ht lÃ  entropy háº­u nghiá»‡m cá»§a Î¸â‹† cho lá»‹ch sá»­ Dt={(si, ai, ri, si+1)}tâˆ’1_i=0, vÃ  L lÃ  rÃ ng buá»™c cá»§a |r+V(s)| cho báº¥t ká»³ pháº§n thÆ°á»Ÿng r, tráº¡ng thÃ¡i s, vÃ  hÃ m giÃ¡ trá»‹ V.

Chá»©ng minh Äá»‹nh lÃ½ 5.7. Xem chá»©ng minh chi tiáº¿t trong Phá»¥ lá»¥c C.4.

Äá»‹nh lÃ½ 5.10 thiáº¿t láº­p há»‘i tiáº¿c âˆšT cá»§a RAFA (Thuáº­t toÃ¡n 4) cho lá»±a chá»n phÃ¹ há»£p cá»§a tÃ­nh khÃ´ng tá»‘i Æ°u láº­p káº¿ hoáº¡ch Ïµ, vÃ­ dá»¥, Ïµ=O(1/âˆšT), Ä‘iá»u nÃ y cho tháº¥y ráº±ng RAFA hiá»‡u quáº£ máº«u vÃ  giáº£i thÃ­ch hiá»‡u suáº¥t thá»±c nghiá»‡m máº¡nh máº½ cá»§a nÃ³ trong Pháº§n 4. á» Ä‘Ã¢y, thuáº­t ngá»¯ Ä‘áº§u tiÃªn trong rÃ ng buá»™c trÃªn trong Äá»‹nh lÃ½ 5.10 lÃ  thuáº­t ngá»¯ hÃ ng Ä‘áº§u vÃ  liÃªn quan Ä‘áº¿n má»™t sá»‘ yáº¿u tá»‘ nhÃ¢n, cá»¥ thá»ƒ lÃ  chÃ¢n trá»i hiá»‡u quáº£ 1/(1âˆ’Î³), rÃ ng buá»™c giÃ¡ trá»‹ L, vÃ  giáº£m entropy háº­u nghiá»‡m tÃ­ch lÅ©y H0âˆ’HT trong suá»‘t T bÆ°á»›c, Ä‘iá»u nÃ y phá»• biáº¿n trong tÃ i liá»‡u RL (Abbasi-Yadkori vÃ  SzepesvÃ¡ti, 2015; Osband et al., 2013; Russo vÃ  Van Roy, 2014a,b, 2016; Lu vÃ  Van Roy, 2019). Cá»¥ thá»ƒ, H0 nháº¥n máº¡nh kiáº¿n thá»©c tiÃªn nghiá»‡m thu Ä‘Æ°á»£c thÃ´ng qua tiá»n huáº¥n luyá»‡n, vÃ¬ H0 Ä‘á»‹nh lÆ°á»£ng báº¥t Ä‘á»‹nh tiÃªn nghiá»‡m cá»§a LLM trÆ°á»›c khi káº¿t há»£p báº¥t ká»³ pháº£n há»“i thu tháº­p nÃ o. Do Ä‘Ã³, H0âˆ’HT nháº¥n máº¡nh giáº£m báº¥t Ä‘á»‹nh Ä‘áº¡t Ä‘Æ°á»£c báº±ng lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng, vÃ¬ HT Ä‘á»‹nh lÆ°á»£ng báº¥t Ä‘á»‹nh háº­u nghiá»‡m cá»§a LLM sau khi káº¿t há»£p pháº£n há»“i thu tháº­p Ä‘Æ°á»£c. Trong Phá»¥ lá»¥c E, chÃºng tÃ´i chá»©ng minh ráº±ng H0âˆ’HT=O(dÂ·logT) vÃ  rÃ ng buá»™c xÃ¡c suáº¥t 1âˆ’Î´ trÃªn hÃ m giÃ¡ trá»‹ L=O(âˆšdÂ·log(dT/Î´)) cho MDP nhÃ¢n tuyáº¿n tÃ­nh Bayesian d-chiá»u, Ä‘iá»u nÃ y ngá»¥ Ã½ R(T) =Ã•((1âˆ’Î³)âˆ’1(Îº+ 1)Â·âˆšd3T) vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´. á» Ä‘Ã¢y Ã• áº©n yáº¿u tá»‘ logarithmic.

5.4 RAFA vá»›i Chiáº¿n lÆ°á»£c KhÃ¡m phÃ¡ Hiá»‡u quáº£

Äá»ƒ bá» sá»± phá»¥ thuá»™c cá»§a Giáº£ Ä‘á»‹nh 5.6 (Táº­p trung) vÃ  giáº£i quyáº¿t cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p hÆ¡n, chÃºng tÃ´i cung cáº¥p hai biáº¿n thá»ƒ cá»§a RAFA (Thuáº­t toÃ¡n 4): (1) RAFA vá»›i thÆ°á»Ÿng láº¡c quan (Thuáº­t toÃ¡n 5) vÃ  (2) RAFA vá»›i láº¥y máº«u háº­u nghiá»‡m (Thuáº­t toÃ¡n 6). ChÃºng tÃ´i cÅ©ng chá»©ng minh rÃ ng buá»™c cá»§a há»‘i tiáº¿c Bayesian cá»§a má»—i biáº¿n thá»ƒ, Ä‘iá»u nÃ y thá»ƒ hiá»‡n hiá»‡u quáº£ cá»§a cÃ¡c chiáº¿n lÆ°á»£c khÃ¡m phÃ¡ hiá»‡u quáº£ nÃ y mÃ  khÃ´ng cÃ³ Giáº£ Ä‘á»‹nh 5.6 (Táº­p trung).
23

--- TRANG 24 ---
Thuáº­t toÃ¡n 5 LÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i (RAFA): PhiÃªn báº£n lÃ½ thuyáº¿t vá»›i thÆ°á»Ÿng láº¡c quan.
1:Ä‘áº§u vÃ o : Má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u PLÏµ, tráº£ vá» má»™t chÃ­nh sÃ¡ch Ïµ-tá»‘i Æ°u tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c Ïµ (Äá»‹nh nghÄ©a 5.1), vÃ  LLM vá»›i cÄƒn chá»‰nh háº­u nghiá»‡m.
2:khá»Ÿi táº¡o : Láº¥y máº«u tráº¡ng thÃ¡i ban Ä‘áº§u s0âˆ¼Ï, Ä‘áº·t t= 0, vÃ  khá»Ÿi táº¡o bá»™ Ä‘á»‡m bá»™ nhá»› D0=âˆ….
3:cho k= 0,1, . . . , thá»±c hiá»‡n
4: Äáº·t tkâ†t.
5:láº·p láº¡i
6: Thiáº¿t káº¿ thÆ°á»Ÿng láº¡c quan Î“ k(s, a) =âˆš2LÂ·âˆšI(Î¸;Î¾(s,a)|Dtk) cho táº¥t cáº£ (s, a)âˆˆ S Ã— A.
7: Láº­p káº¿ hoáº¡ch trÆ°á»›c vá»›i ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u vÃ  LLM (Ï€t, Vt)â†PLÏµ(PLLM(Dtk), rLLM(Dtk)+ Î“ k). ("lÃ½ luáº­n cho tÆ°Æ¡ng lai")
8: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at=Ï€t(st) Ä‘á»ƒ nháº­n pháº§n thÆ°á»Ÿng rt vÃ  tráº¡ng thÃ¡i st+1 tá»« mÃ´i trÆ°á»ng. ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i")
9: Cáº­p nháº­t bá»™ Ä‘á»‡m bá»™ nhá»› Dt+1â† D tâˆª {(st, at, st+1, rt)}.
10: Äáº·t tâ†t+ 1.
11: cho Ä‘áº¿n khi Htkâˆ’Ht>log 2, trong Ä‘Ã³ Ht kÃ½ hiá»‡u entropy háº­u nghiá»‡m cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn Dt. (Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c thá»a mÃ£n)
12:káº¿t thÃºc cho

5.4.1 ThÆ°á»Ÿng Láº¡c quan

ChÃºng tÃ´i káº¿t há»£p nguyÃªn táº¯c Láº¡c quan TrÆ°á»›c Báº¥t Ä‘á»‹nh (OFU) (Cai et al., 2020; Zhou et al., 2021b; Jin et al., 2020; Liu et al., 2022b; Wang et al., 2023c) Ä‘á»ƒ khuyáº¿n khÃ­ch khÃ¡m phÃ¡ hiá»‡u quáº£ báº±ng cÃ¡ch thÃªm thÆ°á»Ÿng láº¡c quan vÃ o hÃ m pháº§n thÆ°á»Ÿng trong thÃ³i quen con láº­p káº¿ hoáº¡ch cá»§a RAFA. ChÃºng tÃ´i thiáº¿t káº¿ thÆ°á»Ÿng láº¡c quan báº±ng tÄƒng thÃ´ng tin vÃ  thá»±c hiá»‡n má»™t biáº¿n thá»ƒ cá»§a RAFA trong Thuáº­t toÃ¡n 5. Cá»¥ thá»ƒ, thÆ°á»Ÿng Î“ k(s, a) cÃ³ dáº¡ng sau

Î“k(s, a) =âˆš2LÂ·âˆšI(Î¸;Î¾(s,a)|Dtk) (5.2)

cho báº¥t ká»³ (s, a)âˆˆ S Ã— A vÃ  k < K. Trong DÃ²ng 7 cá»§a Thuáº­t toÃ¡n 5, chÃºng ta táº¡o chÃ­nh sÃ¡ch Ï€t báº±ng PLÏµ(PLLM(Dtk), rLLM(Dtk)+ Î“ k) cho báº¥t ká»³ tkâ‰¤t < t k+1. Trá»±c quan, thÆ°á»Ÿng cao hÆ¡n táº¡i cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng vá»›i tÄƒng thÃ´ng tin cao hÆ¡n, Ä‘iá»u nÃ y khuyáº¿n khÃ­ch tÃ¡c nhÃ¢n khÃ¡m phÃ¡ nhá»¯ng tráº¡ng thÃ¡i Ã­t Ä‘Æ°á»£c viáº¿ng thÄƒm (vá»›i tÄƒng thÃ´ng tin cao hÆ¡n). Trong Ä‘á»‹nh lÃ½ sau, chÃºng tÃ´i chá»©ng minh rÃ ng buá»™c há»‘i tiáº¿c cá»§a RAFA vá»›i thÆ°á»Ÿng láº¡c quan (Thuáº­t toÃ¡n 5).

Äá»‹nh lÃ½ 5.8. DÆ°á»›i Giáº£ Ä‘á»‹nh 5.3 vÃ  5.5, há»‘i tiáº¿c Bayesian cá»§a RAFA vá»›i thÆ°á»Ÿng láº¡c quan (Thuáº­t toÃ¡n 5) thá»a mÃ£n

R(T) =O[LÂ·âˆšE[H0âˆ’HT]/(1âˆ’Î³)Â·âˆšT+Ïµ/(1âˆ’Î³)Â·T+LÂ·E[H0âˆ’HT]/(1âˆ’Î³)],

trong Ä‘Ã³ táº¥t cáº£ cÃ¡c biáº¿n cÃ³ cÃ¹ng Ä‘á»‹nh nghÄ©a trong Äá»‹nh lÃ½ 5.7.

Chá»©ng minh Äá»‹nh lÃ½ 5.8. Xem chá»©ng minh chi tiáº¿t trong Phá»¥ lá»¥c C.5.

So vá»›i Äá»‹nh lÃ½ 5.7, rÃ ng buá»™c há»‘i tiáº¿c trong Äá»‹nh lÃ½ 5.8 khÃ´ng phá»¥ thuá»™c vÃ o há»‡ sá»‘ táº­p trung Îº, Ä‘iá»u nÃ y thá»ƒ hiá»‡n hiá»‡u quáº£ cá»§a thÆ°á»Ÿng láº¡c quan trong Thuáº­t toÃ¡n 5. Trong Phá»¥ lá»¥c E, chÃºng tÃ´i chá»©ng minh ráº±ng H0âˆ’HT=O(dÂ·logT) vÃ  rÃ ng buá»™c xÃ¡c suáº¥t 1âˆ’Î´ trÃªn hÃ m giÃ¡ trá»‹ L=O(âˆšdÂ·log(dT/Î´)) cho MDP nhÃ¢n tuyáº¿n tÃ­nh Bayesian d-chiá»u, Ä‘iá»u nÃ y ngá»¥ Ã½ R(T) =Ã•((1âˆ’Î³)âˆ’1Â·âˆšd3T) vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´. á» Ä‘Ã¢y Ã• áº©n yáº¿u tá»‘ logarithmic.
24

--- TRANG 25 ---
5.4.2 Láº¥y máº«u Háº­u nghiá»‡m

Thuáº­t toÃ¡n 6 LÃ½ luáº­n cho tÆ°Æ¡ng lai, hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i (RAFA): PhiÃªn báº£n lÃ½ thuyáº¿t vá»›i láº¥y máº«u háº­u nghiá»‡m.
1:Ä‘áº§u vÃ o : Má»™t ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u PLÏµ, tráº£ vá» má»™t chÃ­nh sÃ¡ch Ïµ-tá»‘i Æ°u tá»‘i Ä‘a hÃ³a hÃ m giÃ¡ trá»‹ Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c Ïµ (Äá»‹nh nghÄ©a 5.1), vÃ  LLM thá»a mÃ£n Giáº£ Ä‘á»‹nh 5.9.
2:khá»Ÿi táº¡o : Láº¥y máº«u tráº¡ng thÃ¡i ban Ä‘áº§u s0âˆ¼Ï, Ä‘áº·t t= 0, vÃ  khá»Ÿi táº¡o bá»™ Ä‘á»‡m bá»™ nhá»› D0=âˆ….
3:cho k= 0,1, . . . , thá»±c hiá»‡n
4: Äáº·t tkâ†t.
5:láº·p láº¡i
6: Láº­p káº¿ hoáº¡ch trÆ°á»›c vá»›i ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u vÃ  cÆ¡ cháº¿ láº¥y máº«u háº­u nghiá»‡m cá»§a LLM (Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong Giáº£ Ä‘á»‹nh 5.9) (Ï€t, Vt)â†PLÏµ(PLLM+PS (Dtk), rLLM+PS (Dtk)). ("lÃ½ luáº­n cho tÆ°Æ¡ng lai")
7: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng at=Ï€t(st) Ä‘á»ƒ nháº­n pháº§n thÆ°á»Ÿng rt vÃ  tráº¡ng thÃ¡i st+1 tá»« mÃ´i trÆ°á»ng. ("hÃ nh Ä‘á»™ng cho hiá»‡n táº¡i")
8: Cáº­p nháº­t bá»™ Ä‘á»‡m bá»™ nhá»› Dt+1â† D tâˆª {(st, at, st+1, rt)}.
9: Äáº·t tâ†t+ 1.
10: cho Ä‘áº¿n khi Htkâˆ’Ht>log 2, trong Ä‘Ã³ Ht kÃ½ hiá»‡u entropy háº­u nghiá»‡m cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn Dt. (Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i Ä‘Æ°á»£c thá»a mÃ£n)
11:káº¿t thÃºc cho

NhÆ° má»™t phÆ°Æ¡ng phÃ¡p khÃ¡c cho khÃ¡m phÃ¡ hiá»‡u quáº£, chÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng tá»“n táº¡i má»™t cÆ¡ cháº¿ triá»ƒn khai láº¥y máº«u háº­u nghiá»‡m vÃ  chÃºng tÃ´i sá»­ dá»¥ng cÆ¡ cháº¿ nÃ y Ä‘á»ƒ khuyáº¿n khÃ­ch khÃ¡m phÃ¡ cho RAFA.

Giáº£ Ä‘á»‹nh 5.9 (LLM vá»›i CÆ¡ cháº¿ Láº¥y máº«u Háº­u nghiá»‡m). ChÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng tá»“n táº¡i má»™t cÆ¡ cháº¿ LLM+PS Ã¡nh xáº¡ bá»™ Ä‘á»‡m bá»™ nhá»› D thÃ nh nhÃ¢n chuyá»ƒn tiáº¿p vÃ  hÃ m pháº§n thÆ°á»Ÿng, sao cho (rLLM+PS (D)(s, a) +Î³Â·(PLLM+PS (D)V)(s, a))|D vÃ  (BÎ¸â‹†V(s, a))|D phÃ¢n phá»‘i giá»‘ng há»‡t nhau Ä‘á»™c láº­p cho báº¥t ká»³ (s, a)âˆˆ S Ã— A, táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D, vÃ  hÃ m giÃ¡ trá»‹ V. á» Ä‘Ã¢y, Î¸â‹† lÃ  tham sá»‘ sinh dá»¯ liá»‡u.

ChÃºng tÃ´i nháº­n xÃ©t ráº±ng phÆ°Æ¡ng phÃ¡p bootstrap (Efron, 1982) cÃ³ thá»ƒ xáº¥p xá»‰ cÆ¡ cháº¿ láº¥y máº«u háº­u nghiá»‡m thá»a mÃ£n Giáº£ Ä‘á»‹nh 5.9. ÄÆ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong thá»‘ng kÃª á»©ng dá»¥ng (Davison vÃ  Hinkley, 1997) vÃ  thiáº¿t káº¿ thuáº­t toÃ¡n RL (Osband et al., 2016; Hao et al., 2019), phÆ°Æ¡ng phÃ¡p bootstrap láº¥y táº­p dá»¯ liá»‡u D vÃ  bá»™ Æ°á»›c tÃ­nh hÃ m g lÃ m Ä‘áº§u vÃ o. TÃ¹y thuá»™c vÃ o cáº¥u hÃ¬nh bootstrap, chÃºng ta táº¡o táº­p dá»¯ liá»‡u bootstrap DÌƒ tá»« D báº±ng láº¥y máº«u Ä‘á»u cÃ³ hoÃ n láº¡i (Efron, 1982) hoáº·c láº¥y máº«u cÃ³ trá»ng sá»‘ cÃ³ hoÃ n láº¡i (Newton vÃ  Raftery, 1994). Xem LLM nhÆ° bá»™ Æ°á»›c tÃ­nh hÃ m g vÃ  bá»™ Ä‘á»‡m bá»™ nhá»› D nhÆ° táº­p dá»¯ liá»‡u D, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p bootstrap nÃ y Ä‘á»ƒ xáº¥p xá»‰ cÆ¡ cháº¿ LLM+PS Ä‘Æ°á»£c giá»›i thiá»‡u trong Giáº£ Ä‘á»‹nh 5.9. Tá»« tÃ i liá»‡u thá»‘ng kÃª (Bickel vÃ  Freedman, 1981; Singh, 1981; Newton vÃ  Raftery, 1994), chÃºng ta cÅ©ng biáº¿t ráº±ng phÃ¢n phá»‘i bootstrap khÃ´i phá»¥c phÃ¢n phá»‘i háº­u nghiá»‡m má»™t cÃ¡ch tiá»‡m cáº­n.

Dá»±a trÃªn cÆ¡ cháº¿ thá»a mÃ£n Giáº£ Ä‘á»‹nh 5.9, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t biáº¿n thá»ƒ cá»§a RAFA trong Thuáº­t toÃ¡n 6, nÆ¡i chÃºng ta sá»­ dá»¥ng cÆ¡ cháº¿ LLM+PS nhÆ° bá»™ Æ°á»›c tÃ­nh mÃ´ hÃ¬nh trong thÃ³i quen con há»c cá»§a RAFA. Trong DÃ²ng 7 cá»§a Thuáº­t toÃ¡n 5, chÃºng ta táº¡o chÃ­nh sÃ¡ch Ï€t báº±ng PLÏµ(PLLM+PS (Dtk), rLLM+PS (Dtk)). Trong pháº§n sau, chÃºng tÃ´i Ä‘Æ°a ra giáº£i thÃ­ch Ä‘Æ¡n giáº£n vá» cÃ¡ch cÆ¡ cháº¿ nÃ y giÃºp tÃ¡c nhÃ¢n khÃ¡m phÃ¡ má»™t cÃ¡ch hiá»‡u quáº£. Bá»Ÿi quy táº¯c Bayes, chÃºng ta cÃ³ p(Î¸|D)âˆL(D|Î¸)P0(Î¸), trong Ä‘Ã³ L(D|Î¸) lÃ  kháº£ nÄƒng cá»§a D cho Î¸ vÃ  P0 lÃ  tiÃªn nghiá»‡m cá»§a Î¸â‹†. Láº¥y logarithm, chÃºng ta cÃ³ log(p(Î¸|D)) = c+ log(P0(Î¸)) + log(L(D|Î¸)) cho má»™t háº±ng sá»‘ c nÃ o Ä‘Ã³. Do Ä‘Ã³, báº¥t Ä‘á»‹nh cá»§a háº­u nghiá»‡m cao hÆ¡n (p(Î¸|D) gáº§n 0 hÆ¡n) táº¡i cÃ¡c tráº¡ng thÃ¡i Ã­t Ä‘Æ°á»£c viáº¿ng thÄƒm (kháº£ nÄƒng cá»§a cÃ¡c tráº¡ng thÃ¡i nÃ y gáº§n 0 hÆ¡n). Giáº£ sá»­ chÃºng ta láº¥y máº«u bá»™ Æ°á»›c tÃ­nh mÃ´ hÃ¬nh tá»« háº­u nghiá»‡m. Trong trÆ°á»ng há»£p Ä‘Ã³, tÃ¡c nhÃ¢n cÃ³ nhiá»u Ä‘á»™ng cÆ¡ hÆ¡n Ä‘á»ƒ khÃ¡m phÃ¡ cÃ¡c tráº¡ng thÃ¡i Ã­t Ä‘Æ°á»£c viáº¿ng thÄƒm, Ä‘iá»u nÃ y giáº£i thÃ­ch táº¡i sao cÆ¡ cháº¿ LLM+PS khuyáº¿n khÃ­ch khÃ¡m phÃ¡ hiá»‡u quáº£.

Trong Ä‘á»‹nh lÃ½ sau, chÃºng tÃ´i chá»©ng minh rÃ ng buá»™c há»‘i tiáº¿c cá»§a RAFA vá»›i láº¥y máº«u háº­u nghiá»‡m (Thuáº­t toÃ¡n 6).

Äá»‹nh lÃ½ 5.10 (Há»‘i tiáº¿c Bayesian). DÆ°á»›i Giáº£ Ä‘á»‹nh 5.5 vÃ  5.9, há»‘i tiáº¿c Bayesian cá»§a RAFA vá»›i láº¥y máº«u háº­u nghiá»‡m (Thuáº­t toÃ¡n 6) thá»a mÃ£n

R(T) =O[LÂ·âˆšE[H0âˆ’HT]/(1âˆ’Î³)Â·âˆšT+Ïµ/(1âˆ’Î³)Â·T+LÂ·E[H0âˆ’HT]/(1âˆ’Î³)],

trong Ä‘Ã³ táº¥t cáº£ cÃ¡c biáº¿n cÃ³ cÃ¹ng Ä‘á»‹nh nghÄ©a trong Äá»‹nh lÃ½ 5.7.

Chá»©ng minh Äá»‹nh lÃ½ 5.10. Xem chá»©ng minh chi tiáº¿t trong Phá»¥ lá»¥c C.6.

So vá»›i Äá»‹nh lÃ½ 5.7, rÃ ng buá»™c há»‘i tiáº¿c trong Äá»‹nh lÃ½ 5.10 khÃ´ng phá»¥ thuá»™c vÃ o há»‡ sá»‘ táº­p trung Îº, Ä‘iá»u nÃ y thá»ƒ hiá»‡n hiá»‡u quáº£ cá»§a cÆ¡ cháº¿ láº¥y máº«u háº­u nghiá»‡m trong Thuáº­t toÃ¡n 6. Trong Phá»¥ lá»¥c E, chÃºng tÃ´i chá»©ng minh ráº±ng H0âˆ’HT=O(dÂ·logT) vÃ  rÃ ng buá»™c xÃ¡c suáº¥t 1âˆ’Î´ trÃªn hÃ m giÃ¡ trá»‹ L=O(âˆšdÂ·log(dT/Î´)) cho MDP nhÃ¢n tuyáº¿n tÃ­nh Bayesian d-chiá»u, Ä‘iá»u nÃ y ngá»¥ Ã½ R(T) =Ã•((1âˆ’Î³)âˆ’1Â·âˆšd3T) vá»›i xÃ¡c suáº¥t Ã­t nháº¥t 1âˆ’Î´. á» Ä‘Ã¢y Ã• áº©n yáº¿u tá»‘ logarithmic.
26

--- TRANG 27 ---
6 Káº¿t luáº­n
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i thiáº¿t láº­p tÆ°Æ¡ng á»©ng LLM-RL vÃ  Ä‘á» xuáº¥t má»™t khung nguyÃªn lÃ½ RAFA Ä‘á»ƒ Ä‘iá»u phá»‘i lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng, Ä‘áº¡t Ä‘Æ°á»£c Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh trong cÃ¡c tÃ¡c nhÃ¢n LLM tá»± Ä‘á»™ng láº§n Ä‘áº§u tiÃªn. ChÃºng tÃ´i chá»©ng minh rÃ ng buá»™c há»‘i tiáº¿c âˆšT cá»§a RAFA Ä‘á»ƒ nháº¥n máº¡nh sá»± phá»‘i há»£p giá»¯a kiáº¿n thá»©c tiÃªn nghiá»‡m tá»« tiá»n huáº¥n luyá»‡n vÃ  quÃ¡ trÃ¬nh láº·p cá»§a lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng. Hiá»‡u suáº¥t thá»±c nghiá»‡m xuáº¥t sáº¯c cá»§a RAFA nháº¥n máº¡nh tiá»m nÄƒng cá»§a nÃ³ cho ra quyáº¿t Ä‘á»‹nh tá»± Ä‘á»™ng vÃ  thÃ­ch á»©ng trong cÃ¡c nhiá»‡m vá»¥ phá»©c táº¡p khÃ¡c nhau, Ä‘iá»u mÃ  chÃºng tÃ´i Ä‘á»ƒ láº¡i cho cÃ´ng viá»‡c tÆ°Æ¡ng lai.

Lá»i cáº£m Æ¡n
Zhaoran Wang ghi nháº­n Quá»¹ Khoa há»c Quá»‘c gia (Giáº£i thÆ°á»Ÿng 2048075, 2008827, 2015568, 1934931), Viá»‡n Simons (LÃ½ thuyáº¿t Há»c TÄƒng cÆ°á»ng), Amazon, J.P. Morgan, vÃ  Two Sigma cho sá»± há»— trá»£ cá»§a há».

TÃ i liá»‡u tham kháº£o
Abbasi-Yadkori, Y., PÃ¡l, D. vÃ  SzepesvÃ¡ti, C. (2011). Thuáº­t toÃ¡n cáº£i tiáº¿n cho bandit ngáº«u nhiÃªn tuyáº¿n tÃ­nh. Trong Tiáº¿n bá»™ trong Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Abbasi-Yadkori, Y. vÃ  SzepesvÃ¡ti, C. (2015). Äiá»u khiá»ƒn tá»‘i Æ°u Bayesian cá»§a cÃ¡c há»‡ thá»‘ng Ä‘Æ°á»£c tham sá»‘ hÃ³a mÆ°á»£t mÃ . Trong Báº¥t Ä‘á»‹nh trong TrÃ­ tuá»‡ NhÃ¢n táº¡o.

Abernethy, J., Agarwal, A., Marinov, T. V. vÃ  Warmuth, M. K. (2023). Má»™t cÆ¡ cháº¿ cho há»c trong ngá»¯ cáº£nh hiá»‡u quáº£ máº«u cho cÃ¡c nhiá»‡m vá»¥ truy xuáº¥t thÆ°a thá»›t. arXiv preprint arXiv:2305.17040.

Agarwal, A., Kakade, S., Krishnamurthy, A. vÃ  Sun, W. (2020). Flambe: Äá»™ phá»©c táº¡p cáº¥u trÃºc vÃ  há»c biá»ƒu diá»…n cá»§a MDP háº¡ng tháº¥p. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 3320095â€“20107.

Ahn, M., Brohan, A., Brown, N., Chebotar, Y., Cortes, O., David, B., Finn, C., Fu, C., Gopalakrishnan, K., Hausman, K. et al. (2022). LÃ m nhÆ° tÃ´i cÃ³ thá»ƒ, khÃ´ng pháº£i nhÆ° tÃ´i nÃ³i: Äá»‹nh vá»‹ ngÃ´n ngá»¯ trong kháº£ nÄƒng robot. arXiv preprint arXiv:2204.01691.

AkyÃ¼rek, E., Schuurmans, D., Andreas, J., Ma, T. vÃ  Zhou, D. (2022). Thuáº­t toÃ¡n há»c nÃ o trong há»c trong ngá»¯ cáº£nh? Äiá»u tra vá»›i cÃ¡c mÃ´ hÃ¬nh tuyáº¿n tÃ­nh. arXiv preprint arXiv:2211.15661.

Beck, J. (2008). TrÃ² chÆ¡i tá»• há»£p: LÃ½ thuyáº¿t Tic-Tac-Toe.

Betts, J. T. (1998). Kháº£o sÃ¡t cÃ¡c phÆ°Æ¡ng phÃ¡p sá»‘ cho tá»‘i Æ°u hÃ³a quá»¹ Ä‘áº¡o. Táº¡p chÃ­ HÆ°á»›ng dáº«n, Äiá»u khiá»ƒn, vÃ  Äá»™ng lá»±c.
27

--- TRANG 28 ---
Bickel, P. J. vÃ  Freedman, D. A. (1981). Má»™t sá»‘ lÃ½ thuyáº¿t tiá»‡m cáº­n cho bootstrap. The annals of statistics, 91196â€“1217.

Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J. D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A. et al. (2020). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lÃ  nhá»¯ng ngÆ°á»i há»c few-shot. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 331877â€“1901.

Cai, Q., Yang, Z., Jin, C. vÃ  Wang, Z. (2020). KhÃ¡m phÃ¡ hiá»‡u quáº£ cÃ³ thá»ƒ chá»©ng minh trong tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Cai, T., Wang, X., Ma, T., Chen, X. vÃ  Zhou, D. (2023). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n nhÆ° nhá»¯ng nhÃ  cháº¿ táº¡o cÃ´ng cá»¥. arXiv preprint arXiv:2305.17126.

Chen, Y., He, J. vÃ  Gu, Q. (2022). Vá» Ä‘á»™ phá»©c táº¡p máº«u cá»§a viá»‡c há»c MDP nhÃ¢n tuyáº¿n tÃ­nh chÃ¢n trá»i vÃ´ háº¡n giáº£m giÃ¡. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Chowdhery, A., Narang, S., Devlin, J., Bosma, M., Mishra, G., Roberts, A., Barham, P., Chung, H. W., Sutton, C., Gehrmann, S. et al. (2022). PaLM: Má»Ÿ rá»™ng mÃ´ hÃ¬nh ngÃ´n ngá»¯ vá»›i pathways. arXiv preprint arXiv:2204.02311.

Chua, K., Calandra, R., McAllister, R. vÃ  Levine, S. (2018). Há»c tÄƒng cÆ°á»ng sÃ¢u trong má»™t sá»‘ láº§n thá»­ sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh Ä‘á»™ng lá»±c xÃ¡c suáº¥t. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 31.

Creswell, A. vÃ  Shanahan, M. (2022). LÃ½ luáº­n trung thÃ nh sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2208.14271.

Creswell, A., Shanahan, M. vÃ  Higgins, I. (2022). Selection-inference: Khai thÃ¡c cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n cho lÃ½ luáº­n logic cÃ³ thá»ƒ diá»…n giáº£i. arXiv preprint arXiv:2205.09712.

Davison, A. C. vÃ  Hinkley, D. V. (1997). CÃ¡c phÆ°Æ¡ng phÃ¡p Bootstrap vÃ  á»©ng dá»¥ng cá»§a chÃºng. 1, Cambridge university press.

Dong, K., Wang, Y., Chen, X. vÃ  Wang, L. (2019). Q-learning vá»›i khÃ¡m phÃ¡ UCB hiá»‡u quáº£ máº«u cho MDP chÃ¢n trá»i vÃ´ háº¡n. arXiv preprint arXiv:1901.09311.

Efron, B. (1982). The jackknife, the bootstrap vÃ  cÃ¡c káº¿ hoáº¡ch láº¥y máº«u láº¡i khÃ¡c. SIAM.

Fan, J., Wang, Z., Xie, Y. vÃ  Yang, Z. (2020). PhÃ¢n tÃ­ch lÃ½ thuyáº¿t cá»§a deep q-learning. Trong Há»c cho Ä‘á»™ng lá»±c vÃ  Ä‘iá»u khiá»ƒn. PMLR.

Garg, S., Tsipras, D., Liang, P. S. vÃ  Valiant, G. (2022). Transformer cÃ³ thá»ƒ há»c gÃ¬ trong ngá»¯ cáº£nh? Má»™t nghiÃªn cá»©u trÆ°á»ng há»£p cá»§a cÃ¡c lá»›p hÃ m Ä‘Æ¡n giáº£n. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Ghavamzadeh, M., Mannor, S., Pineau, J., Tamar, A. et al. (2015). Há»c tÄƒng cÆ°á»ng Bayesian: Má»™t kháº£o sÃ¡t. Foundations and TrendsÂ® in Machine Learning, 8359â€“483.

28

--- TRANG 29 ---
Ghosh, M. (2021). RÃ ng buá»™c Ä‘uÃ´i mÅ© cho cÃ¡c biáº¿n ngáº«u nhiÃªn chi-bÃ¬nh phÆ°Æ¡ng. Journal of Statistical Theory and Practice, 1535.

Gruver, N., Finzi, M., Qiu, S. vÃ  Wilson, A. G. (2023). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n lÃ  nhá»¯ng ngÆ°á»i dá»± bÃ¡o chuá»—i thá»i gian zero-shot. arXiv preprint arXiv:2310.07820.

Guo, H., Liu, Z., Zhang, Y. vÃ  Wang, Z. (2024). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n cÃ³ thá»ƒ chÆ¡i trÃ² chÆ¡i khÃ´ng? má»™t nghiÃªn cá»©u trÆ°á»ng há»£p cá»§a cÃ¡ch tiáº¿p cáº­n tá»± chÆ¡i. arXiv preprint arXiv:2403.05632.

Hafner, D., Lillicrap, T., Fischer, I., Villegas, R., Ha, D., Lee, H. vÃ  Davidson, J. (2019). Há»c Ä‘á»™ng lá»±c áº©n cho láº­p káº¿ hoáº¡ch tá»« pixel. Trong Há»™i nghá»‹ quá»‘c táº¿ vá» há»c mÃ¡y. PMLR.

Hao, B., Abbasi Yadkori, Y., Wen, Z. vÃ  Cheng, G. (2019). Bootstrapping rÃ ng buá»™c tin cáº­y trÃªn. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 32.

Hao, S., Gu, Y., Ma, H., Hong, J. J., Wang, Z., Wang, D. Z. vÃ  Hu, Z. (2023). LÃ½ luáº­n vá»›i mÃ´ hÃ¬nh ngÃ´n ngá»¯ lÃ  láº­p káº¿ hoáº¡ch vá»›i mÃ´ hÃ¬nh tháº¿ giá»›i. arXiv preprint arXiv:2305.14992.

Hoffmann, J., Borgeaud, S., Mensch, A., Buchatskaya, E., Cai, T., Rutherford, E., Casas, D. d. L., Hendricks, L. A., Welbl, J., Clark, A. et al. (2022). Huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ tá»‘i Æ°u tÃ­nh toÃ¡n. arXiv preprint arXiv:2203.15556.

Huang, W., Abbeel, P., Pathak, D. vÃ  Mordatch, I. (2022a). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÆ° nhá»¯ng ngÆ°á»i láº­p káº¿ hoáº¡ch zero-shot: TrÃ­ch xuáº¥t kiáº¿n thá»©c cÃ³ thá»ƒ hÃ nh Ä‘á»™ng cho cÃ¡c tÃ¡c nhÃ¢n hiá»‡n thÃ¢n. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Huang, W., Xia, F., Xiao, T., Chan, H., Liang, J., Florence, P., Zeng, A., Tompson, J., Mordatch, I., Chebotar, Y. et al. (2022b). Äá»™c thoáº¡i ná»™i tÃ¢m: LÃ½ luáº­n hiá»‡n thÃ¢n thÃ´ng qua láº­p káº¿ hoáº¡ch vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯. arXiv preprint arXiv:2207.05608.

Janner, M., Fu, J., Zhang, M. vÃ  Levine, S. (2019). Khi nÃ o tin tÆ°á»Ÿng mÃ´ hÃ¬nh cá»§a báº¡n: Tá»‘i Æ°u hÃ³a chÃ­nh sÃ¡ch dá»±a trÃªn mÃ´ hÃ¬nh. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 32.

Jiang, H. (2023). LÃ½ thuyáº¿t khÃ´ng gian áº©n cho kháº£ nÄƒng ná»•i lÃªn trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2304.09960.

Jin, C., Yang, Z., Wang, Z. vÃ  Jordan, M. I. (2020). Há»c tÄƒng cÆ°á»ng hiá»‡u quáº£ cÃ³ thá»ƒ chá»©ng minh vá»›i xáº¥p xá»‰ hÃ m tuyáº¿n tÃ­nh. Trong Há»™i nghá»‹ vá» LÃ½ thuyáº¿t Há»c. PMLR.

Kim, G., Baldi, P. vÃ  McAleer, S. (2023). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ cÃ³ thá»ƒ giáº£i quyáº¿t cÃ¡c nhiá»‡m vá»¥ mÃ¡y tÃ­nh. arXiv preprint arXiv:2303.17491.

Kirsch, L., Harrison, J., Sohl-Dickstein, J. vÃ  Metz, L. (2022). Há»c trong ngá»¯ cáº£nh má»¥c Ä‘Ã­ch chung báº±ng meta-learning transformer. arXiv preprint arXiv:2212.04458.

29

--- TRANG 30 ---
Lazaric, A., Ghavamzadeh, M. vÃ  Munos, R. (2010). PhÃ¢n tÃ­ch thuáº­t toÃ¡n láº·p chÃ­nh sÃ¡ch dá»±a trÃªn phÃ¢n loáº¡i. Trong ICML-27th International Conference on Machine Learning. Omnipress.

Lee, J. N., Xie, A., Pacchiano, A., Chandak, Y., Finn, C., Nachum, O. vÃ  Brunskill, E. (2023). Tiá»n huáº¥n luyá»‡n cÃ³ giÃ¡m sÃ¡t cÃ³ thá»ƒ há»c há»c tÄƒng cÆ°á»ng trong ngá»¯ cáº£nh. arXiv preprint arXiv:2306.14892.

Li, B. Z., Nye, M. vÃ  Andreas, J. (2022). MÃ´ hÃ¬nh ngÃ´n ngá»¯ vá»›i cÃ¡c tÃ¬nh huá»‘ng áº©n. arXiv preprint arXiv:2212.10012.

Li, Y., Ildiz, M. E., Papailiopoulos, D. vÃ  Oymak, S. (2023). Transformer nhÆ° thuáº­t toÃ¡n: Tá»•ng quÃ¡t hÃ³a vÃ  lá»±a chá»n mÃ´ hÃ¬nh áº©n trong há»c trong ngá»¯ cáº£nh. arXiv preprint arXiv:2301.07067.

Liang, P., Bommasani, R., Lee, T., Tsipras, D., Soylu, D., Yasunaga, M., Zhang, Y., Narayanan, D., Wu, Y., Kumar, A. et al. (2022). ÄÃ¡nh giÃ¡ toÃ n diá»‡n cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯. arXiv preprint arXiv:2211.09110.

Liu, B., Jiang, Y., Zhang, X., Liu, Q., Zhang, S., Biswas, J. vÃ  Stone, P. (2023a). LLM+P: Trao quyá»n cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n vá»›i thÃ nh tháº¡o láº­p káº¿ hoáº¡ch tá»‘i Æ°u. arXiv preprint arXiv:2304.11477.

Liu, Z., Lu, M., Wang, Z., Jordan, M. vÃ  Yang, Z. (2022a). Tá»‘i Ä‘a hÃ³a phÃºc lá»£i trong cÃ¢n báº±ng cáº¡nh tranh: Há»c tÄƒng cÆ°á»ng cho ná»n kinh táº¿ trao Ä‘á»•i Markov. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y. PMLR.

Liu, Z., Lu, M., Xiong, W., Zhong, H., Hu, H., Zhang, S., Zheng, S., Yang, Z. vÃ  Wang, Z. (2023b). Tá»‘i Ä‘a hÃ³a Ä‘á»ƒ khÃ¡m phÃ¡: Má»™t hÃ m má»¥c tiÃªu há»£p nháº¥t Æ°á»›c tÃ­nh, láº­p káº¿ hoáº¡ch, vÃ  khÃ¡m phÃ¡. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron, táº­p. 36.

Liu, Z., Lu, M., Xiong, W., Zhong, H., Hu, H., Zhang, S., Zheng, S., Yang, Z. vÃ  Wang, Z. (2024). Tá»‘i Ä‘a hÃ³a Ä‘á»ƒ khÃ¡m phÃ¡: Má»™t hÃ m má»¥c tiÃªu há»£p nháº¥t Æ°á»›c tÃ­nh, láº­p káº¿ hoáº¡ch, vÃ  khÃ¡m phÃ¡. Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron, 36.

Liu, Z., Zhang, Y., Fu, Z., Yang, Z. vÃ  Wang, Z. (2022b). Há»c tá»« minh há»a: Báº¯t chÆ°á»›c chÃ­nh sÃ¡ch Ä‘á»‘i nghá»‹ch hiá»‡u quáº£ cÃ³ thá»ƒ chá»©ng minh vá»›i xáº¥p xá»‰ hÃ m tuyáº¿n tÃ­nh. Trong Há»™i nghá»‹ quá»‘c táº¿ vá» há»c mÃ¡y. PMLR.

Lu, P., Peng, B., Cheng, H., Galley, M., Chang, K.-W., Wu, Y. N., Zhu, S.-C. vÃ  Gao, J. (2023). Chameleon: LÃ½ luáº­n cÃ³ thá»ƒ káº¿t há»£p plug-and-play vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2304.09842.

Lu, X. vÃ  Van Roy, B. (2019). RÃ ng buá»™c tin cáº­y lÃ½ thuyáº¿t thÃ´ng tin cho há»c tÄƒng cÆ°á»ng. Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

30

--- TRANG 31 ---
Morari, M. vÃ  Lee, J. H. (1999). Äiá»u khiá»ƒn dá»± Ä‘oÃ¡n mÃ´ hÃ¬nh: quÃ¡ khá»©, hiá»‡n táº¡i vÃ  tÆ°Æ¡ng lai. Computers & chemical engineering, 23667â€“682.

Newton, M. A. vÃ  Raftery, A. E. (1994). Suy luáº­n Bayesian gáº§n Ä‘Ãºng vá»›i bootstrap kháº£ nÄƒng cÃ³ trá»ng sá»‘. Journal of the Royal Statistical Society Series B: Statistical Methodology, 563â€“26.

Olsson, C., Elhage, N., Nanda, N., Joseph, N., DasSarma, N., Henighan, T., Mann, B., Askell, A., Bai, Y., Chen, A. et al. (2022). Há»c trong ngá»¯ cáº£nh vÃ  Ä‘áº§u quy náº¡p. arXiv preprint arXiv:2209.11895.

OpenAI (2023). BÃ¡o cÃ¡o ká»¹ thuáº­t GPT-4.

Osband, I., Blundell, C., Pritzel, A. vÃ  Van Roy, B. (2016). KhÃ¡m phÃ¡ sÃ¢u thÃ´ng qua bootstrapped dqn. Tiáº¿n bá»™ trong há»‡ thá»‘ng xá»­ lÃ½ thÃ´ng tin nÆ¡-ron, 29.

Osband, I., Russo, D. vÃ  Van Roy, B. (2013). Há»c tÄƒng cÆ°á»ng (Hiá»‡u quáº£ hÆ¡n) thÃ´ng qua láº¥y máº«u háº­u nghiá»‡m. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Paul, D., Ismayilzada, M., Peyrard, M., Borges, B., Bosselut, A., West, R. vÃ  Faltings, B. (2023). REFINER: Pháº£n há»“i lÃ½ luáº­n trÃªn cÃ¡c biá»ƒu diá»…n trung gian. arXiv preprint arXiv:2304.01904.

Pouplin, T., Sun, H., Holt, S. vÃ  Van der Schaar, M. (2024). QuÃ¡ trÃ¬nh suy nghÄ© tÄƒng cÆ°á»ng truy xuáº¥t nhÆ° ra quyáº¿t Ä‘á»‹nh tuáº§n tá»±. arXiv preprint arXiv:2402.07812.

Radford, A., Wu, J., Child, R., Luan, D., Amodei, D. vÃ  Sutskever, I. (2019). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lÃ  nhá»¯ng ngÆ°á»i há»c Ä‘a nhiá»‡m khÃ´ng giÃ¡m sÃ¡t.

Rawlings, J. B. (2000). Tá»•ng quan hÆ°á»›ng dáº«n Ä‘iá»u khiá»ƒn dá»± Ä‘oÃ¡n mÃ´ hÃ¬nh. IEEE Control Systems Magazine.

Razeghi, Y., Logan IV, R. L., Gardner, M. vÃ  Singh, S. (2022). TÃ¡c Ä‘á»™ng cá»§a táº§n suáº¥t thuáº­t ngá»¯ tiá»n huáº¥n luyá»‡n Ä‘áº¿n lÃ½ luáº­n few-shot. arXiv preprint arXiv:2202.07206.

Russo, D. vÃ  Van Roy, B. (2014a). Há»c tá»‘i Æ°u hÃ³a thÃ´ng qua láº¥y máº«u hÆ°á»›ng dáº«n thÃ´ng tin. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Russo, D. vÃ  Van Roy, B. (2014b). Há»c tá»‘i Æ°u hÃ³a thÃ´ng qua láº¥y máº«u háº­u nghiá»‡m. Mathematics of Operations Research.

Russo, D. vÃ  Van Roy, B. (2016). PhÃ¢n tÃ­ch lÃ½ thuyáº¿t thÃ´ng tin cá»§a láº¥y máº«u Thompson. Journal of Machine Learning Research.

Sekar, R., Rybkin, O., Daniilidis, K., Abbeel, P., Hafner, D. vÃ  Pathak, D. (2020). Láº­p káº¿ hoáº¡ch khÃ¡m phÃ¡ thÃ´ng qua cÃ¡c mÃ´ hÃ¬nh tháº¿ giá»›i tá»± giÃ¡m sÃ¡t. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y. PMLR.

31

--- TRANG 32 ---
Sel, B., Al-Tawaha, A., Khattar, V., Wang, L., Jia, R. vÃ  Jin, M. (2023). Thuáº­t toÃ¡n cá»§a suy nghÄ©: TÄƒng cÆ°á»ng khÃ¡m phÃ¡ Ã½ tÆ°á»Ÿng trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2308.10379.

Shen, Y., Song, K., Tan, X., Li, D., Lu, W. vÃ  Zhuang, Y. (2023). HuggingGPT: Giáº£i quyáº¿t cÃ¡c nhiá»‡m vá»¥ AI vá»›i ChatGPT vÃ  báº¡n bÃ¨ cá»§a nÃ³ trong HuggingFace. arXiv preprint arXiv:2303.17580.

Shin, S., Lee, S.-W., Ahn, H., Kim, S., Kim, H., Kim, B., Cho, K., Lee, G., Park, W., Ha, J.-W. et al. (2022). Vá» áº£nh hÆ°á»Ÿng cá»§a corpora tiá»n huáº¥n luyá»‡n Ä‘áº¿n há»c trong ngá»¯ cáº£nh bá»Ÿi má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ quy mÃ´ lá»›n. arXiv preprint arXiv:2204.13509.

Shinn, N., Cassano, F., Labash, B., Gopinath, A., Narasimhan, K. vÃ  Yao, S. (2023). Reflexion: TÃ¡c nhÃ¢n ngÃ´n ngá»¯ vá»›i há»c tÄƒng cÆ°á»ng báº±ng lá»i. arXiv preprint arXiv:2303.11366.

Shridhar, M., Yuan, X., CÃ´tÃ©, M.-A., Bisk, Y., Trischler, A. vÃ  Hausknecht, M. (2020). ALFworld: CÄƒn chá»‰nh vÄƒn báº£n vÃ  mÃ´i trÆ°á»ng hiá»‡n thÃ¢n cho há»c tÆ°Æ¡ng tÃ¡c. arXiv preprint arXiv:2010.03768.

Singh, K. (1981). Vá» Ä‘á»™ chÃ­nh xÃ¡c tiá»‡m cáº­n cá»§a bootstrap cá»§a Efron. The Annals of Statistics 1187â€“1195.

Strens, M. (2000). Khung Bayesian cho há»c tÄƒng cÆ°á»ng. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Sun, H. (2023). Há»c tÄƒng cÆ°á»ng trong ká»· nguyÃªn cá»§a LLM: CÃ¡i gÃ¬ thiáº¿t yáº¿u? cÃ¡i gÃ¬ cáº§n thiáº¿t? má»™t quan Ä‘iá»ƒm RL vá» RLHF, prompting, vÃ  hÆ¡n tháº¿ ná»¯a.

Sun, H., HÃ¼yÃ¼k, A. vÃ  van der Schaar, M. (2023a). ÄÃ¡nh giÃ¡ vÃ  tá»‘i Æ°u hÃ³a prompt phá»¥ thuá»™c truy váº¥n vá»›i RL nghá»‹ch Ä‘áº£o ngoáº¡i tuyáº¿n. Trong Há»™i nghá»‹ Quá»‘c táº¿ thá»© MÆ°á»i hai vá» Biá»ƒu diá»…n Há»c.

Sun, H., Zhuang, Y., Kong, L., Dai, B. vÃ  Zhang, C. (2023b). AdaPlanner: Láº­p káº¿ hoáº¡ch thÃ­ch á»©ng tá»« pháº£n há»“i vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯. arXiv preprint arXiv:2305.16653.

Sutton, R. S. vÃ  Barto, A. G. (2018). Há»c tÄƒng cÆ°á»ng: Má»™t giá»›i thiá»‡u.

Todd, E., Li, M. L., Sharma, A. S., Mueller, A., Wallace, B. C. vÃ  Bau, D. (2023). Vector hÃ m trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2310.15213.

Touvron, H., Lavril, T., Izacard, G., Martinet, X., Lachaux, M.-A., Lacroix, T., RoziÃ¨re, B., Goyal, N., Hambro, E., Azhar, F. et al. (2023). LLaMa: CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ ná»n táº£ng má»Ÿ vÃ  hiá»‡u quáº£. arXiv preprint arXiv:2302.13971.

Von Oswald, J., Niklasson, E., Randazzo, E., Sacramento, J., Mordvintsev, A., Zhmoginov, A. vÃ  Vladymyrov, M. (2023). Transformer há»c trong ngá»¯ cáº£nh báº±ng gradient descent. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

32

--- TRANG 33 ---
Wang, X., Wei, J., Schuurmans, D., Le, Q., Chi, E., Narang, S., Chowdhery, A. vÃ  Zhou, D. (2022a). Tá»± nháº¥t quÃ¡n cáº£i thiá»‡n lÃ½ luáº­n chuá»—i suy nghÄ© trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯. arXiv preprint arXiv:2203.11171.

Wang, X., Zhu, W. vÃ  Wang, W. Y. (2023a). CÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n lÃ  cÃ¡c mÃ´ hÃ¬nh chá»§ Ä‘á» áº©n: Giáº£i thÃ­ch vÃ  tÃ¬m kiáº¿m cÃ¡c minh chá»©ng tá»‘t cho há»c trong ngá»¯ cáº£nh. arXiv preprint arXiv:2301.11916.

Wang, Z., Cai, S., Liu, A., Ma, X. vÃ  Liang, Y. (2023b). MÃ´ táº£, giáº£i thÃ­ch, láº­p káº¿ hoáº¡ch vÃ  chá»n: Láº­p káº¿ hoáº¡ch tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n cho phÃ©p cÃ¡c tÃ¡c nhÃ¢n Ä‘a nhiá»‡m tháº¿ giá»›i má»Ÿ. arXiv preprint arXiv:2302.01560.

Wang, Z., Pan, T., Zhou, Q. vÃ  Wang, J. (2023c). KhÃ¡m phÃ¡ hiá»‡u quáº£ trong há»c tÄƒng cÆ°á»ng háº¡n cháº¿ tÃ i nguyÃªn. Proceedings of the AAAI Conference on Artificial Intelligence, 3710279â€“10287.

Wang, Z., Wang, J., Zhou, Q., Li, B. vÃ  Li, H. (2022b). Há»c tÄƒng cÆ°á»ng hiá»‡u quáº£ máº«u thÃ´ng qua actor-critic dá»±a trÃªn mÃ´ hÃ¬nh báº£o thá»§. Trong Proceedings of the AAAI Conference on Artificial Intelligence, táº­p. 36.

Wasserman, L. (2000). Lá»±a chá»n mÃ´ hÃ¬nh Bayesian vÃ  trung bÃ¬nh mÃ´ hÃ¬nh. Journal of mathematical psychology, 4492â€“107.

Wei, C.-Y., Jahromi, M. J., Luo, H., Sharma, H. vÃ  Jain, R. (2020). Há»c tÄƒng cÆ°á»ng khÃ´ng cÃ³ mÃ´ hÃ¬nh trong cÃ¡c quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov pháº§n thÆ°á»Ÿng trung bÃ¬nh chÃ¢n trá»i vÃ´ háº¡n. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Wei, J., Wang, X., Schuurmans, D., Bosma, M., Xia, F., Chi, E., Le, Q. V. vÃ  Zhou, D. (2022). Prompting chuá»—i suy nghÄ© gá»£i lÃ½ luáº­n trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Wies, N., Levine, Y. vÃ  Shashua, A. (2023). Kháº£ nÄƒng há»c cá»§a há»c trong ngá»¯ cáº£nh. arXiv preprint arXiv:2303.07895.

Wies, N., Levine, Y. vÃ  Shashua, A. (2024). Kháº£ nÄƒng há»c cá»§a há»c trong ngá»¯ cáº£nh. Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron, 36.

Xie, S. M., Raghunathan, A., Liang, P. vÃ  Ma, T. (2021). Giáº£i thÃ­ch há»c trong ngá»¯ cáº£nh nhÆ° suy luáº­n Bayesian áº©n. arXiv preprint arXiv:2111.02080.

Yang, L. vÃ  Wang, M. (2019). Q-learning tham sá»‘ tá»‘i Æ°u máº«u sá»­ dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng cá»™ng tuyáº¿n tÃ­nh. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

Yang, L. vÃ  Wang, M. (2020). Há»c tÄƒng cÆ°á»ng trong khÃ´ng gian Ä‘áº·c trÆ°ng: Matrix bandit, kernel, vÃ  rÃ ng buá»™c há»‘i tiáº¿c. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

33

--- TRANG 34 ---
Yao, S., Yu, D., Zhao, J., Shafran, I., Griffiths, T. L., Cao, Y. vÃ  Narasimhan, K. (2023a). CÃ¢y suy nghÄ©: Giáº£i quyáº¿t váº¥n Ä‘á» cÃ³ chá»§ Ã½ vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2305.10601.

Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K. vÃ  Cao, Y. (2022). ReAct: Phá»‘i há»£p lÃ½ luáº­n vÃ  hÃ nh Ä‘á»™ng trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯. arXiv preprint arXiv:2210.03629.

Yao, Y., Li, Z. vÃ  Zhao, H. (2023b). NgoÃ i chuá»—i suy nghÄ©, lÃ½ luáº­n Ä‘á»“ thá»‹ suy nghÄ© hiá»‡u quáº£ trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2305.16582.

Zelikman, E., Wu, Y., Mu, J. vÃ  Goodman, N. (2022). STaR: Bootstrapping lÃ½ luáº­n vá»›i lÃ½ luáº­n. Trong Tiáº¿n bá»™ trong Há»‡ thá»‘ng Xá»­ lÃ½ ThÃ´ng tin NÆ¡-ron.

Zhang, S., Zheng, S., Ke, S., Liu, Z., Jin, W., Yuan, J., Yang, Y., Yang, H. vÃ  Wang, Z. (2024). LLM cÃ³ thá»ƒ hÆ°á»›ng dáº«n RL nhÆ° tháº¿ nÃ o? má»™t cÃ¡ch tiáº¿p cáº­n dá»±a trÃªn giÃ¡ trá»‹. arXiv preprint arXiv:2402.16181.

Zhang, Y., Cai, Q., Yang, Z. vÃ  Wang, Z. (2020). Há»c báº¯t chÆ°á»›c Ä‘á»‘i nghá»‹ch táº¡o sinh vá»›i tham sá»‘ hÃ³a máº¡ng nÆ¡-ron: TÃ­nh tá»‘i Æ°u toÃ n cá»¥c vÃ  tá»· lá»‡ há»™i tá»¥. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y. PMLR.

Zhang, Y., Liu, B., Cai, Q., Wang, L. vÃ  Wang, Z. (2022). PhÃ¢n tÃ­ch attention thÃ´ng qua lÄƒng kÃ­nh cá»§a tÃ­nh trao Ä‘á»•i vÃ  cÃ¡c mÃ´ hÃ¬nh biáº¿n áº©n. arXiv preprint arXiv:2212.14852.

Zhang, Y., Yang, J., Yuan, Y. vÃ  Yao, A. C.-C. (2023a). LÃ½ luáº­n tÃ­ch lÅ©y vá»›i cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. arXiv preprint arXiv:2308.04371.

Zhang, Y., Zhang, F., Yang, Z. vÃ  Wang, Z. (2023b). Há»c trong ngá»¯ cáº£nh há»c gÃ¬ vÃ  nhÆ° tháº¿ nÃ o? Trung bÃ¬nh mÃ´ hÃ¬nh Bayesian, tham sá»‘ hÃ³a, vÃ  tá»•ng quÃ¡t hÃ³a. arXiv preprint arXiv:2305.19420.

Zheng, L., Chiang, W.-L., Sheng, Y., Zhuang, S., Wu, Z., Zhuang, Y., Lin, Z., Li, Z., Li, D., Xing, E. et al. (2023). ÄÃ¡nh giÃ¡ LLM-as-a-judge vá»›i MT-bench vÃ  chatbot arena. arXiv preprint arXiv:2306.05685.

Zheng, S., Wang, L., Qiu, S., Fu, Z., Yang, Z., Szepesvari, C. vÃ  Wang, Z. (2022). KhÃ¡m phÃ¡ láº¡c quan vá»›i cÃ¡c Ä‘áº·c trÆ°ng Ä‘Ã£ há»c giáº£i quyáº¿t cÃ³ thá»ƒ chá»©ng minh cÃ¡c quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov vá»›i Ä‘á»™ng lá»±c nÆ¡-ron. Trong Há»™i nghá»‹ Quá»‘c táº¿ thá»© MÆ°á»i má»™t vá» Biá»ƒu diá»…n Há»c.

Zhong, H., Xiong, W., Zheng, S., Wang, L., Wang, Z., Yang, Z. vÃ  Zhang, T. (2022). Gec: Má»™t khung thá»‘ng nháº¥t cho ra quyáº¿t Ä‘á»‹nh tÆ°Æ¡ng tÃ¡c trong MDP, POMDP, vÃ  hÆ¡n tháº¿ ná»¯a. arXiv preprint arXiv:2211.01962.

Zhou, D., Gu, Q. vÃ  SzepesvÃ¡ti, C. (2021a). Há»c tÄƒng cÆ°á»ng gáº§n nhÆ° tá»‘i Æ°u minimax cho cÃ¡c quÃ¡ trÃ¬nh quyáº¿t Ä‘á»‹nh Markov há»—n há»£p tuyáº¿n tÃ­nh. Trong Há»™i nghá»‹ vá» LÃ½ thuyáº¿t Há»c.

Zhou, D., He, J. vÃ  Gu, Q. (2021b). Há»c tÄƒng cÆ°á»ng hiá»‡u quáº£ cÃ³ thá»ƒ chá»©ng minh cho MDP giáº£m giÃ¡ vá»›i Ã¡nh xáº¡ Ä‘áº·c trÆ°ng. Trong Há»™i nghá»‹ Quá»‘c táº¿ vá» Há»c MÃ¡y.

34

--- TRANG 35 ---
A KÃ½ hiá»‡u
ChÃºng tÃ´i cung cáº¥p má»™t báº£ng kÃ½ hiá»‡u á»Ÿ Ä‘Ã¢y.

KÃ½ hiá»‡u Giáº£i thÃ­ch
Î¾(s,a) cáº·p cá»§a tráº¡ng thÃ¡i tiáº¿p theo vÃ  pháº§n thÆ°á»Ÿng hiá»‡n táº¡i (sâ€², r), cho cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a)
PLLM(Î¾(s,a)|D, s, a) thÆ°á»›c Ä‘o xÃ¡c suáº¥t cá»§a LLM dá»± Ä‘oÃ¡n Î¾(s,a) cho bá»™ Ä‘á»‡m bá»™ nhá»› D Ä‘Æ°á»£c nháº¯c nhÆ° ngá»¯ cáº£nh
rLLM(D) bá»™ Æ°á»›c tÃ­nh pháº§n thÆ°á»Ÿng LLM vá»›i bá»™ Ä‘á»‡m bá»™ nhá»› D Ä‘Æ°á»£c nháº¯c nhÆ° ngá»¯ cáº£nh
PLLM(D) bá»™ Æ°á»›c tÃ­nh nhÃ¢n chuyá»ƒn tiáº¿p LLM vá»›i bá»™ Ä‘á»‡m bá»™ nhá»› D Ä‘Æ°á»£c nháº¯c nhÆ° ngá»¯ cáº£nh
Dt lá»‹ch sá»­ táº¡i bÆ°á»›c thá»© t, bao gá»“m {(si, ai, ri, si+1)}tâˆ’1_i=0
P0(Î¸) tiÃªn nghiá»‡m cá»§a Î¸â‹†
Ppost(Î¸|D) háº­u nghiá»‡m cá»§a Î¸â‹† cÃ³ Ä‘iá»u kiá»‡n trÃªn D
Pt(Î¸) viáº¿t táº¯t cá»§a Ppost(Î¸|Dt)
H(Î¸|D) entropy háº­u nghiá»‡m cá»§a háº­u nghiá»‡m cá»§a Î¸ cÃ³ Ä‘iá»u kiá»‡n trÃªn D
I(Î¸;Î¾|D) tÄƒng thÃ´ng tin cá»§a Î¾, Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi H(Î¸|D)âˆ’H(Î¸, Î¾|D)
Ht viáº¿t táº¯t cá»§a H(Î¸|Dt)
tk bÆ°á»›c thá»i gian khi RAFA chuyá»ƒn Ä‘á»•i chÃ­nh sÃ¡ch láº§n thá»© k
Ï€k viáº¿t táº¯t cá»§a Ï€tk
BÎ¸ toÃ¡n tá»­ Bellman Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi Î¸
Bk toÃ¡n tá»­ Bellman Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi LLM(Dtk)
dTV(pâˆ¥q) biáº¿n phÃ¢n tá»•ng (TV) giá»¯a hai thÆ°á»›c Ä‘o xÃ¡c suáº¥t p vÃ  q
dKL(pâˆ¥q) divergence Kullbackâ€“Leibler giá»¯a hai thÆ°á»›c Ä‘o xÃ¡c suáº¥t p vÃ  q
Vxâˆ¼p[f(x)] phÆ°Æ¡ng sai cá»§a f(X), trong Ä‘Ã³ X tuÃ¢n theo phÃ¢n phá»‘i p
(PV)(s, a) Esâ€²âˆ¼P(Â·|s,a)[V(sâ€²)]
L rÃ ng buá»™c cá»§a |r+V(s)| cho báº¥t ká»³ râˆˆ R, sâˆˆ S, vÃ  giÃ¡ trá»‹ V
Î½â‹†(Â·|s) thÆ°á»›c Ä‘o viáº¿ng thÄƒm Î³-giáº£m giÃ¡ tá»‘i Æ°u báº¯t Ä‘áº§u tá»« tráº¡ng thÃ¡i s
N táº­p há»£p cÃ¡c sá»‘ tá»± nhiÃªn
1(x=y) chá»‰ bÃ¡o vá»›i giÃ¡ trá»‹ 1 náº¿u x báº±ng y vÃ  giÃ¡ trá»‹ 0 náº¿u ngÆ°á»£c láº¡i
E ká»³ vá»ng
V phÆ°Æ¡ng sai
35

--- TRANG 36 ---
B ThÃªm Thuáº­t toÃ¡n
TÃ¹y thuá»™c vÃ o cáº¥u hÃ¬nh cá»¥ thá»ƒ cá»§a khÃ´ng gian tráº¡ng thÃ¡i vÃ  hÃ nh Ä‘á»™ng (liÃªn tá»¥c so vá»›i rá»i ráº¡c) vÃ  mÃ´ hÃ¬nh chuyá»ƒn tiáº¿p vÃ  pháº§n thÆ°á»Ÿng (ngáº«u nhiÃªn so vá»›i xÃ¡c Ä‘á»‹nh), chÃºng ta cÃ³ thá»ƒ chá»n mÃ´ phá»ng thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y, thuáº­t toÃ¡n láº·p giÃ¡ trá»‹, thuáº­t toÃ¡n báº¯n ngáº«u nhiÃªn, hoáº·c thuáº­t toÃ¡n MCTS. Táº¥t cáº£ chÃºng Ä‘á»u cho phÃ©p RAFA Ä‘áº¡t Ä‘Æ°á»£c Ä‘áº£m báº£o hiá»‡u quáº£ máº«u cÃ³ thá»ƒ chá»©ng minh miá»…n lÃ  chÃºng thá»a mÃ£n má»™t yÃªu cáº§u cá»¥ thá»ƒ vá» tÃ­nh tá»‘i Æ°u (Äá»‹nh nghÄ©a 5.1). Äá»ƒ minh há»a, chÃºng tÃ´i mÃ´ phá»ng thuáº­t toÃ¡n beam-search (má»™t phiÃªn báº£n nÃ¢ng cao cá»§a thuáº­t toÃ¡n tÃ¬m kiáº¿m cÃ¢y) trong Thuáº­t toÃ¡n 7 vÃ  thuáº­t toÃ¡n MCTS trong Thuáº­t toÃ¡n 8. Cho tháº£o luáº­n lÃ½ thuyáº¿t, chÃºng tÃ´i trÃ¬nh bÃ y thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ trong Thuáº­t toÃ¡n 3.

Thuáº­t toÃ¡n 7 NgÆ°á»i há»c-láº­p káº¿ hoáº¡ch LLM (LLM-LR-PL): Má»™t vÃ­ dá»¥ beam-search (cho trÆ°á»ng há»£p xÃ¡c Ä‘á»‹nh).
1:Ä‘áº§u vÃ o : Bá»™ Ä‘á»‡m bá»™ nhá»› D, tráº¡ng thÃ¡i ban Ä‘áº§u s, Ä‘á»™ rá»™ng Ä‘á» xuáº¥t L, Ä‘á»™ rá»™ng tÃ¬m kiáº¿m B, vÃ  Ä‘á»™ sÃ¢u tÃ¬m kiáº¿m U.
2:khá»Ÿi táº¡o : Khá»Ÿi táº¡o máº£ng tráº¡ng thÃ¡i S0â† {s} vÃ  máº£ng hÃ nh Ä‘á»™ng A0â†âˆ….
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con há»c) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
3:Äáº·t Model nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o tráº¡ng thÃ¡i tiáº¿p theo.
4:Äáº·t Critic nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ Æ°á»›c tÃ­nh hÃ m giÃ¡ trá»‹.
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con láº­p káº¿ hoáº¡ch) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
5:Äáº·t Elite nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o nhiá»u hÃ nh Ä‘á»™ng á»©ng viÃªn.
6:cho u= 0, . . . , U thá»±c hiá»‡n
7: Äá»‘i vá»›i má»—i tráº¡ng thÃ¡i hiá»‡n táº¡i su trong Su, gá»i Elite Ä‘á»ƒ táº¡o L hÃ nh Ä‘á»™ng á»©ng viÃªn.
8: Äá»‘i vá»›i má»—i hÃ nh Ä‘á»™ng á»©ng viÃªn a(â„“)_u, gá»i Model Ä‘á»ƒ táº¡o tráº¡ng thÃ¡i tiáº¿p theo s(â„“)_u+1 vÃ  pháº§n thÆ°á»Ÿng nháº­n Ä‘Æ°á»£c r(â„“)_u.
9: Äá»‘i vá»›i má»—i bá»™ ba káº¿t quáº£ (su, a(â„“)_u, s(â„“)_u+1, r(â„“)_u), gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n QÌ‚(su, a(â„“)_u)â†r(â„“)_u+Î³VÌ‚(s(â„“)_u+1), trong Ä‘Ã³ VÌ‚ Ä‘Æ°á»£c cho bá»Ÿi Critic.
10: Chá»n B bá»™ ba tá»‘t nháº¥t (su, a(â„“)_u, s(â„“)_u+1) vá»›i giÃ¡ trá»‹ QÌ‚(su, a(â„“)_u) cao nháº¥t vÃ  ghi chÃºng vÃ o SuÃ— A uÃ— S u+1.
11:káº¿t thÃºc cho
12:Cho B rollout Ä‘Æ°á»£c báº£o tá»“n trong S0Ã— A 0Ã— Â·Â·Â· Ã— S UÃ— A UÃ— S U+1, gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n âˆ‘U_u=0Î³ur(b)_u+Î³U+1VÌ‚(s(b)_U+1) vÃ  chá»n rollout tá»‘t nháº¥t (sâ€ 0, aâ€ 0, . . . , sâ€ U, aâ€ U, sâ€ U+1), trong Ä‘Ã³ VÌ‚ Ä‘Æ°á»£c cho bá»Ÿi Critic vÃ  sâ€ 0=s.
13:Ä‘áº§u ra : HÃ nh Ä‘á»™ng ban Ä‘áº§u aâ€ 0 cá»§a rollout Ä‘Æ°á»£c chá»n.
36

--- TRANG 37 ---
Thuáº­t toÃ¡n 8 NgÆ°á»i há»c-láº­p káº¿ hoáº¡ch LLM (LLM-PL) cho RAFA: Má»™t vÃ­ dá»¥ tÃ¬m kiáº¿m cÃ¢y Monte-Carlo (cho trÆ°á»ng há»£p ngáº«u nhiÃªn).
1:Ä‘áº§u vÃ o : Bá»™ Ä‘á»‡m bá»™ nhá»› D, tráº¡ng thÃ¡i ban Ä‘áº§u s, Ä‘á»™ rá»™ng Ä‘á» xuáº¥t L,Lâ€², vÃ  ngÃ¢n sÃ¡ch má»Ÿ rá»™ng E.
2:khá»Ÿi táº¡o : Khá»Ÿi táº¡o nÃºt gá»‘c nâ†s vÃ  hÃ m con c(Â·)â†âˆ….
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con há»c) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
3:Äáº·t Model nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o tráº¡ng thÃ¡i tiáº¿p theo.
4:Äáº·t Critic nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ Æ°á»›c tÃ­nh hÃ m giÃ¡ trá»‹.
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” (thÃ³i quen con láº­p káº¿ hoáº¡ch) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“
5:Äáº·t Elite nhÆ° má»™t thá»ƒ hiá»‡n LLM Ä‘Æ°á»£c nháº¯c sá»­ dá»¥ng D nhÆ° ngá»¯ cáº£nh Ä‘á»ƒ táº¡o nhiá»u hÃ nh Ä‘á»™ng á»©ng viÃªn.
6:cho e= 0, . . . , E thá»±c hiá»‡n
7: Äáº·t seâ†n.
8:trong khi se khÃ´ng pháº£i lÃ  nÃºt lÃ¡, tá»©c lÃ , c(se)Ì¸=âˆ…, thá»±c hiá»‡n
9: Gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n vÃ  chá»n nÃºt con ae trong c(se) vá»›i giÃ¡ trá»‹ QÌ‚(se, ae) cao nháº¥t.
10: Äáº·t se nhÆ° má»™t nÃºt con trong c(ae).
11: káº¿t thÃºc while
12: Äá»‘i vá»›i tráº¡ng thÃ¡i hiá»‡n táº¡i se, gá»i Elite Ä‘á»ƒ táº¡o L hÃ nh Ä‘á»™ng á»©ng viÃªn.
13: Ghi má»—i hÃ nh Ä‘á»™ng á»©ng viÃªn a(â„“)_e vÃ o c(se), tá»©c lÃ , c(se)â† {a(â„“)_e}L_â„“=1.
14: Äá»‘i vá»›i má»—i hÃ nh Ä‘á»™ng á»©ng viÃªn a(â„“)_e, gá»i Model Ä‘á»ƒ láº¥y máº«u Lâ€² tráº¡ng thÃ¡i tiáº¿p theo.
15: Ghi má»—i tráº¡ng thÃ¡i tiáº¿p theo s(â„“,â„“â€²)_e vÃ o c(a(â„“)_e), tá»©c lÃ , c(a(â„“)_e)â† {s(â„“,â„“â€²)_e}Lâ€²_â„“â€²=1.
16: Äá»‘i vá»›i má»—i tráº¡ng thÃ¡i Ä‘Æ°á»£c táº¡o s(â„“,â„“â€²)_e, gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n vÃ  cáº­p nháº­t giÃ¡ trá»‹ Æ°á»›c tÃ­nh VÌ‚ cho táº¥t cáº£ cÃ¡c nÃºt tá»• tiÃªn. (TÃ¹y chá»n)
17:káº¿t thÃºc cho
18:Äáº·t sâ€ 0â†n vÃ  iâ†0.
19:trong khi sâ€ i khÃ´ng pháº£i lÃ  nÃºt lÃ¡, tá»©c lÃ , c(sâ€ i)Ì¸=âˆ…, thá»±c hiá»‡n
20: Gá»i Critic Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ pháº§n thÆ°á»Ÿng tÃ­ch lÅ©y tÆ°Æ¡ng lai dá»± kiáº¿n vÃ  chá»n nÃºt con aâ€ i+1 trong c(sâ€ i) vá»›i giÃ¡ trá»‹ QÌ‚(sâ€ i, aâ€ i) cao nháº¥t.
21: Äáº·t sâ€ i+1 nhÆ° má»™t nÃºt con trong c(aâ€ i) vÃ  iâ†i+ 1.
22:káº¿t thÃºc while
23:Ä‘áº§u ra : HÃ nh Ä‘á»™ng ban Ä‘áº§u aâ€ 0 cá»§a rollout Ä‘Æ°á»£c chá»n (sâ€ 0, aâ€ 0, . . . , sâ€ i, aâ€ i).
37

--- TRANG 38 ---
C Chá»©ng minh ChÃ­nh
C.1 Chá»©ng minh Má»‡nh Ä‘á» 5.2
Chá»©ng minh Má»‡nh Ä‘á» 5.2. BÃ¢y giá» chÃºng tÃ´i chá»©ng minh ráº±ng thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ vá»›i chÃ¢n trá»i cáº¯t ngáº¯n U (Thuáº­t toÃ¡n 3) thá»a mÃ£n Ä‘á»‹nh nghÄ©a cá»§a ngÆ°á»i láº­p káº¿ hoáº¡ch Ïµ-tá»‘i Æ°u (Äá»‹nh nghÄ©a 5.1), trong Ä‘Ã³ U phá»¥ thuá»™c vÃ o Ïµ. Äá»ƒ Ä‘Æ¡n giáº£n kÃ½ hiá»‡u, chÃºng tÃ´i kÃ½ hiá»‡u max sâˆˆS vÃ  max aâˆˆA nhÆ° max s vÃ  max a.

Gá»i
Ïµâ€ = max s,a |Q(1)(s, a)âˆ’r(s, a)âˆ’Î³(PV(1))(s, a)|. (C.1)

LÆ°u Ã½ ráº±ng phÃ¢n tÃ­ch há»™i tá»¥ cá»§a thuáº­t toÃ¡n láº·p giÃ¡ trá»‹ trong Sutton vÃ  Barto (2018) cho
max s,a |Q(1)(s, a)âˆ’Q(2)(s, a)|â‰¤Î³Uâˆ’2 max s,a |Q(Uâˆ’1)(s, a)âˆ’Q(U)(s, a)|,
Ä‘iá»u nÃ y ngá»¥ Ã½
max s,a |Q(1)(s, a)âˆ’Q(2)(s, a)|â‰¤Î³Uâˆ’2L. (C.2)

ChÃºng ta cÃ³
Ïµâ€ = max s,a |Q(1)_Î¸(s, a)âˆ’r(s, a)âˆ’Î³(PV(2))(s, a)|
+Î³Esâ€²âˆ¼P(Â·|s,a)[|V(1)(sâ€²)âˆ’V(2)(sâ€²)|]
=Î³Â·max s,a Esâ€²âˆ¼P(Â·|s,a)[|V(1)(sâ€²)âˆ’V(2)(sâ€²)|]
=Î³Â·max s,a Esâ€²âˆ¼P(Â·|s,a)[|max a Q(1)(sâ€², a)âˆ’max a Q(2)(sâ€², a)|]
â‰¤Î³Â·max s,a Esâ€²âˆ¼P(Â·|s,a)[max a |Q(1)(sâ€², a)âˆ’Q(2)(sâ€², a)|]
â‰¤Î³Uâˆ’1L, (C.3)

trong Ä‘Ã³ Ä‘áº³ng thá»©c Ä‘áº§u tiÃªn vÃ  thá»© ba dá»±a trÃªn Thuáº­t toÃ¡n 3, báº¥t Ä‘áº³ng thá»©c thá»© hai cuá»‘i sá»­ dá»¥ng tÃ­nh cháº¥t co cá»§a toÃ¡n tá»­ maximum, vÃ  báº¥t Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng (C.2). Äá»ƒ cho Ïµâ€ < Ïµ, Ä‘á»§ Ä‘á»ƒ Ä‘áº·t Uâ‰¥1 +âŒˆlogÎ³(Ïµ/L)âŒ‰. LÆ°u Ã½ ráº±ng chÃ­nh sÃ¡ch Ï€ Ä‘Æ°á»£c tráº£ vá» bá»Ÿi Thuáº­t toÃ¡n 3 thá»a mÃ£n Ï€(s) = argmaxaQ(1)(s, a). VÃ¬ váº­y, chÃºng tÃ´i chá»©ng minh Má»‡nh Ä‘á» 5.2.

C.2 LLM vá»›i CÄƒn chá»‰nh Háº­u nghiá»‡m Thá»±c hiá»‡n BMA
Chá»©ng minh Má»‡nh Ä‘á» 5.4. Nhá»› láº¡i ráº±ng PLLM(D) vÃ  rLLM(D) lÃ  nhÃ¢n chuyá»ƒn tiáº¿p Æ°á»›c tÃ­nh vÃ  hÃ m pháº§n thÆ°á»Ÿng Ä‘Æ°á»£c gÃ¢y ra bá»Ÿi PLLM thá»a mÃ£n Giáº£ Ä‘á»‹nh 5.3. Äá»‘i vá»›i báº¥t ká»³ cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a) vÃ  táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D, Ä‘iá»u Ä‘Ã³ xáº£y ra

(PLLM(D)V)(s, a) =âˆ«S V(sâ€²)PLLM(D)(dsâ€²|s, a)
=âˆ«S V(sâ€²)âˆ«Î˜ PÎ¸(dsâ€²|s, a)Ppost(dÎ¸|D)
=âˆ«Î˜ Ppost(dÎ¸|D)âˆ«S PÎ¸(dsâ€²|s, a)V(sâ€²)
=EÎ¸âˆ¼Ppost(Â·|D)[(PÎ¸V)(s, a)], (C.4)

trong Ä‘Ã³ Ä‘áº³ng thá»©c thá»© hai sá»­ dá»¥ng Giáº£ Ä‘á»‹nh 5.3 (CÄƒn chá»‰nh Háº­u nghiá»‡m), Ä‘áº³ng thá»©c thá»© ba sá»­ dá»¥ng Ä‘á»‹nh lÃ½ Fubin, vÃ  Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng (2.4). Äá»‘i vá»›i báº¥t ká»³ cáº·p tráº¡ng thÃ¡i-hÃ nh Ä‘á»™ng truy váº¥n (s, a) vÃ  táº­p dá»¯ liá»‡u trong ngá»¯ cáº£nh D, Ä‘iá»u Ä‘Ã³ xáº£y ra

rLLM(D)(s, a) =EPLLM[r|D, s, a]
=EPpost[r|D, s, a]
=EÎ¸âˆ¼Ppost(Â·|D)[rÎ¸(s, a)], (C.5)

trong Ä‘Ã³ Ä‘áº³ng thá»©c thá»© hai sá»­ dá»¥ng Giáº£ Ä‘á»‹nh 5.3 (CÄƒn chá»‰nh Háº­u nghiá»‡m) vÃ  Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng (2.4). Bá»Ÿi tÃ­nh tuyáº¿n tÃ­nh cá»§a ká»³ vá»ng, chÃºng tÃ´i káº¿t há»£p (C.4) vÃ  (C.5) Ä‘á»ƒ cÃ³

rLLM(D)(s, a) +Î³Â·(PLLM(D)V)(s, a) =EÎ¸âˆ¼Ppost(Â·|D)[rÎ¸(s, a) +Î³Â·(PÎ¸V)(s, a)]
=EÎ¸âˆ¼Ppost(Â·|D)[(BÎ¸V)(s, a)],

trong Ä‘Ã³ Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a cá»§a BÎ¸. VÃ¬ váº­y, chÃºng tÃ´i hoÃ n thÃ nh chá»©ng minh Má»‡nh Ä‘á» 5.4.

C.3 TÃ­nh cháº¥t Co láº¡i cá»§a PhÆ°Æ¡ng sai Háº­u nghiá»‡m
Má»‡nh Ä‘á» C.1 (TÃ­nh cháº¥t Co láº¡i cá»§a PhÆ°Æ¡ng sai Háº­u nghiá»‡m). DÆ°á»›i Giáº£ Ä‘á»‹nh 5.5, phÆ°Æ¡ng sai háº­u nghiá»‡m trong Thuáº­t toÃ¡n 4, 5, vÃ  6 thá»a mÃ£n hai tÃ­nh cháº¥t sau:
(i) VÎ¸âˆ¼Ptk[(BÎ¸Vt)(s, a)|Dtk] â‰¤2L2Â·I(Î¸;Î¾(s,a)|Dtk)
(ii) E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk VÎ¸âˆ¼Ptk[(BÎ¸Vt)(st, at)|Dtk]]] â‰¤8Î·L2Â·E[H0âˆ’HT],

trong Ä‘Ã³ chÃºng tÃ´i kÃ½ hiá»‡u rÃ ng buá»™c trÃªn cá»§a tá»•ng cá»§a báº¥t ká»³ hÃ m giÃ¡ trá»‹ vÃ  pháº§n thÆ°á»Ÿng bá»Ÿi má»™t háº±ng sá»‘ dÆ°Æ¡ng L, tá»©c lÃ , |r+V(s)| â‰¤L cho báº¥t ká»³ pháº§n thÆ°á»Ÿng r, tráº¡ng thÃ¡i s, vÃ  hÃ m giÃ¡ trá»‹ Æ°á»›c tÃ­nh V.

Chá»©ng minh Má»‡nh Ä‘á» C.1. ChÃºng tÃ´i báº¯t Ä‘áº§u vá»›i chá»©ng minh tÃ­nh cháº¥t Ä‘áº§u tiÃªn trong Má»‡nh Ä‘á» C.1. Nhá»› láº¡i Ä‘á»‹nh nghÄ©a ráº±ng Î¾(s,a) kÃ½ hiá»‡u cÃ¡c biáº¿n ngáº«u nhiÃªn (sâ€², r) trong MDP cÆ¡ báº£n cho tráº¡ng thÃ¡i hiá»‡n táº¡i s vÃ  hÃ nh Ä‘á»™ng a. Äá»‹nh nghÄ©a ráº±ng gt(Î¾(s,a)) = (r+Vt(sâ€²))/(2L). VÃ¬ tá»•ng cá»§a báº¥t ká»³ pháº§n thÆ°á»Ÿng vÃ  hÃ m giÃ¡ trá»‹ nÃ o Ä‘Æ°á»£c giá»›i háº¡n bá»Ÿi L, chÃºng ta biáº¿t ráº±ng |gt| â‰¤ 1/2. cho báº¥t ká»³ tkâ‰¤t < t k+1, chÃºng ta cÃ³

2LÂ·E[gt(Î¾(s,a))|Î¸,Dtk] = (BÎ¸Vt)(s, a)
2LÂ·E[gt(Î¾(s,a))|Dtk] =EÎ¸âˆ¼Pt[(BÎ¸Vt)(s, a)], (C.6)

cho báº¥t ká»³ tráº¡ng thÃ¡i truy váº¥n s vÃ  hÃ nh Ä‘á»™ng a. Bá»Ÿi dáº¡ng biáº¿n phÃ¢n cá»§a khoáº£ng cÃ¡ch biáº¿n phÃ¢n tá»•ng (TV) dTV, chÃºng ta cÃ³

d2_TV(P(Î¾(s,a)|Î¸,Dt)âˆ¥P(Î¾(s,a)|Dt)) = sup g:|g|â‰¤1/2 |E[g(Î¾(s,a))|Î¸,Dtk]âˆ’E[g(Î¾(s,a))|Dtk]|2
â‰¥ |E[gt(Î¾(s,a))|Î¸,Dtk]âˆ’E[gt(Î¾(s,a))|Dtk]|2
=1/(4L2)Â·|(BÎ¸Vt)(s, a)âˆ’EÎ¸âˆ¼Pt[(BÎ¸Vt)(s, a)]|2,(C.7)

trong Ä‘Ã³ Ä‘áº³ng thá»©c cuá»‘i lÃ  káº¿t quáº£ cá»§a (C.6). Báº±ng cÃ¡ch láº¥y ká»³ vá»ng Ä‘á»‘i vá»›i Î¸âˆ¼Pt trÃªn (C.7), chÃºng ta cÃ³

VÎ¸âˆ¼Ptk[(BÎ¸Vt)(s, a)|Dtk]
=EÎ¸âˆ¼Pt[|(BÎ¸Vt)(s, a)âˆ’EÎ¸âˆ¼Pt[(BÎ¸Vt)(s, a)]|2]
â‰¤4L2Â·EÎ¸âˆ¼Pt[d2_TV(P(Î¾(s,a)|Î¸,Dtk)âˆ¥P(Î¾(s,a)|Dtk))]
â‰¤2L2Â·EÎ¸âˆ¼Pt[dKL(P(Î¾(s,a)|Î¸,Dtk)âˆ¥P(Î¾(s,a)|Dtk))]
= 2L2Â·[H(Î¾(s,a)|Dtk)âˆ’H(Î¾(s,a)|Î¸,Dtk)]
= 2L2Â·I(Î¾(s,a);Î¸|Dtk)
= 2L2Â·I(Î¸;Î¾(s,a)|Dtk), (C.8)

trong Ä‘Ã³ Ä‘áº³ng thá»©c Ä‘áº§u tiÃªn sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a cá»§a phÆ°Æ¡ng sai, báº¥t Ä‘áº³ng thá»©c Ä‘áº§u tiÃªn sá»­ dá»¥ng (C.7) báº±ng cÃ¡ch láº¥y ká»³ vá»ng Ä‘á»‘i vá»›i Î¸âˆ¼Pt, vÃ  báº¥t Ä‘áº³ng thá»©c thá»© hai sá»­ dá»¥ng báº¥t Ä‘áº³ng thá»©c Pinsker. á» Ä‘Ã¢y, Ä‘áº³ng thá»©c thá»© hai sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a cá»§a entropy vÃ  Ä‘áº³ng thá»©c thá»© hai cuá»‘i sá»­ dá»¥ng Ä‘á»‹nh nghÄ©a cá»§a tÄƒng thÃ´ng tin. á» Ä‘Ã¢y, Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng thá»±c táº¿ ráº±ng I(X;Y) =I(Y;X) cho báº¥t ká»³ hai biáº¿n ngáº«u nhiÃªn X vÃ  Y. VÃ¬ váº­y, chÃºng tÃ´i hoÃ n thÃ nh chá»©ng minh tÃ­nh cháº¥t Ä‘áº§u tiÃªn trong Má»‡nh Ä‘á» C.1.

Tiáº¿p theo, chÃºng tÃ´i chá»©ng minh tÃ­nh cháº¥t thá»© hai trong Má»‡nh Ä‘á» C.1. Bá»Ÿi thá»±c táº¿ ráº±ng at=Ï€k(st) cho báº¥t ká»³ tkâ‰¤t < t k+1, chÃºng ta cÃ³

E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk VÎ¸âˆ¼Ptk[(BÎ¸Vt)(st, at)|Dtk]]]
=E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk VÎ¸âˆ¼Ptk[(BÎ¸Vt)(st, Ï€k(st))|Dtk]]]
â‰¤2L2Â·E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk I(Î¸;Î¾(st,Ï€k(st))|Dtk)]],

trong Ä‘Ã³ báº¥t Ä‘áº³ng thá»©c gá»i (C.8). DÆ°á»›i Giáº£ Ä‘á»‹nh 5.5 vÃ  cÃ¹ng Ä‘iá»u kiá»‡n chuyá»ƒn Ä‘á»•i trong Thuáº­t toÃ¡n 4, 5, vÃ  6, chÃºng ta cÃ³

E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk VÎ¸âˆ¼Ptk[(BÎ¸Vt)(st, at)|Dtk]]]
â‰¤8Î·L2Â·E[âˆ‘Kâˆ’1_k=0 EÏ€k[âˆ‘tk+1âˆ’1_t=tk I(Î¸;Î¾(st,Ï€k(st))|Dt)]]
â‰¤8Î·L2(H0âˆ’HT),

trong Ä‘Ã³ báº¥t Ä‘áº³ng thá»©c cuá»‘i sá»­ dá»¥ng quy táº¯c chuá»—i cá»§a tÄƒng thÃ´ng tin. VÃ¬ váº­y, chÃºng tÃ´i hoÃ n thÃ nh chá»©ng minh tÃ­nh cháº¥t thá»© hai trong Má»‡nh Ä‘á» C.1.

40
