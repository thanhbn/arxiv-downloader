# Má»™t PhÃ¢n TÃ­ch vÃ  Giáº£m Thiá»ƒu cá»§a Lá»i Nguyá»n Äáº£o NgÆ°á»£c
Ang Lv1âˆ—, Kaiyi Zhang1âˆ—, Shufang Xie1, Quan Tu1, Yuhan Chen1,
Ji-Rong Wen1vÃ  Rui Yan1,2â€ 
1TrÆ°á»ng TrÃ­ tuá»‡ NhÃ¢n táº¡o Gaoling, Äáº¡i há»c NhÃ¢n dÃ¢n Trung Quá»‘c
2Trung tÃ¢m NghiÃªn cá»©u Ká»¹ thuáº­t cá»§a
TÃ¬m kiáº¿m vÃ  Äá» xuáº¥t ThÃ´ng minh Tháº¿ há»‡ Tiáº¿p theo, Bá»™ GiÃ¡o dá»¥c
{anglv, kyzhang, ruiyan}@ruc.edu.cn
TÃ³m táº¯t
NghiÃªn cá»©u gáº§n Ä‘Ã¢y Ä‘Ã£ quan sÃ¡t tháº¥y má»™t hiá»‡n
tÆ°á»£ng Ä‘Ã¡ng chÃº Ã½ trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n
(LLM), Ä‘Æ°á»£c gá»i lÃ  "lá»i nguyá»n Ä‘áº£o ngÆ°á»£c." Lá»i
nguyá»n Ä‘áº£o ngÆ°á»£c lÃ  khi xá»­ lÃ½ hai thá»±c thá»ƒ, kÃ½
hiá»‡u lÃ  a vÃ  b, Ä‘Æ°á»£c káº¿t ná»‘i bá»Ÿi má»‘i quan há»‡ R
cá»§a chÃºng vÃ  quan há»‡ nghá»‹ch Ä‘áº£o Râˆ’1, LLM xuáº¥t
sáº¯c trong viá»‡c xá»­ lÃ½ cÃ¡c chuá»—i cÃ³ dáº¡ng "aRb,"
nhÆ°ng gáº·p khÃ³ khÄƒn khi xá»­ lÃ½ "bRâˆ’1a," dÃ¹ trong
viá»‡c sinh ra hay hiá»ƒu. VÃ­ dá»¥, GPT-4 cÃ³ thá»ƒ tráº£
lá»i chÃ­nh xÃ¡c cÃ¢u há»i "Máº¹ cá»§a Tom Cruise lÃ ?"
vá»›i "Mary Lee Pfeiffer," nhÆ°ng nÃ³ gáº·p khÃ³ khÄƒn
trong viá»‡c Ä‘Æ°a ra cÃ¢u tráº£ lá»i thá»a Ä‘Ã¡ng khi Ä‘Æ°á»£c
há»i "Con trai cá»§a Mary Lee Pfeiffer lÃ ?" Trong
bÃ i bÃ¡o nÃ y, chÃºng tÃ´i thá»±c hiá»‡n nghiÃªn cá»©u Ä‘áº§u
tiÃªn vá» cÃ¡ch lá»i nguyá»n Ä‘áº£o ngÆ°á»£c xáº£y ra trong
LLM. CÃ¡c Ä‘iá»u tra cá»§a chÃºng tÃ´i tiáº¿t lá»™ ráº±ng lá»i
nguyá»n Ä‘áº£o ngÆ°á»£c cÃ³ thá»ƒ báº¯t nguá»“n tá»« cÃ¡c má»¥c
tiÃªu huáº¥n luyá»‡n cá»¥ thá»ƒ, Ä‘iá»u nÃ y trá»Ÿ nÃªn Ä‘áº·c biá»‡t
rÃµ rÃ ng trong viá»‡c sá»­ dá»¥ng rá»™ng rÃ£i dá»± Ä‘oÃ¡n token
tiáº¿p theo trong háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯
nhÃ¢n quáº£. ChÃºng tÃ´i hy vá»ng cuá»™c Ä‘iá»u tra ban
Ä‘áº§u nÃ y cÃ³ thá»ƒ thu hÃºt nhiá»u sá»± chÃº Ã½ hÆ¡n Ä‘áº¿n
lá»i nguyá»n Ä‘áº£o ngÆ°á»£c, cÅ©ng nhÆ° cÃ¡c háº¡n cháº¿ cÆ¡
báº£n khÃ¡c trong LLM hiá»‡n táº¡i.1
1 Giá»›i thiá»‡u
Lá»i nguyá»n Ä‘áº£o ngÆ°á»£c, Ä‘Æ°á»£c quan sÃ¡t bá»Ÿi Berglund
vÃ  cá»™ng sá»± (2023), Ä‘Ã£ thu hÃºt nhiá»u sá»± chÃº Ã½. Hiá»‡n
tÆ°á»£ng nÃ y liÃªn quan Ä‘áº¿n cÃ¡c thá»±c thá»ƒ liÃªn quan Ä‘Æ°á»£c
kÃ½ hiá»‡u lÃ  a vÃ  b, Ä‘Æ°á»£c liÃªn káº¿t bá»Ÿi má»™t má»‘i quan há»‡
R vÃ  má»‘i quan há»‡ nghá»‹ch Ä‘áº£o tÆ°Æ¡ng á»©ng Râˆ’1. Khi
má»™t truy váº¥n liÃªn quan Ä‘áº¿n a vÃ  má»‘i quan há»‡ R Ä‘Æ°á»£c
Ä‘áº·t ra cho má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM), LLM
tráº£ lá»i chÃ­nh xÃ¡c b nhÆ° lÃ  cÃ¢u tráº£ lá»i. Tuy nhiÃªn, khi
Ä‘Æ°á»£c trÃ¬nh bÃ y vá»›i b vÃ  má»‘i quan há»‡ nghá»‹ch Ä‘áº£o Râˆ’1,
LLM cÃ³ xu hÆ°á»›ng thá»ƒ hiá»‡n sá»± nháº§m láº«n Ä‘Ã¡ng ká»ƒ vÃ 
khÃ´ng cung cáº¥p Ä‘Æ°á»£c a nhÆ° lÃ  cÃ¢u tráº£ lá»i.
VÃ­ dá»¥, khi Berglund vÃ  cá»™ng sá»± (2023) Ä‘áº·t
âˆ—ÄÃ³ng gÃ³p ngang nhau.
â€ TÃ¡c giáº£ liÃªn há»‡: Rui Yan (ruiyan@ruc.edu.cn).
1https://github.com/trestad/
mitigating-reversal-curse

cÃ¢u há»i cho GPT-4 (OpenAI, 2023), "Ai lÃ  máº¹ cá»§a
Tom Cruise?" GPT-4 Ä‘Ã£ Ä‘Æ°a ra pháº£n há»“i chÃ­nh xÃ¡c,
Ä‘Ã³ lÃ  "Mary Lee Pfeiffer." Tuy nhiÃªn, khi cÃ¢u há»i
ngÆ°á»£c láº¡i Ä‘Æ°á»£c há»i, "Ai lÃ  con trai cá»§a Mary Lee
Pfeiffer?" GPT-4 Ä‘Ã£ pháº£n há»“i vá»›i má»™t cÃ¢u tráº£ lá»i
áº£o giÃ¡c, cho tháº¥y thiáº¿u kiáº¿n thá»©c vá» cÃ¡ nhÃ¢n nÃ y.
RÃµ rÃ ng lÃ  GPT-4 Ä‘Ã£ cÃ³ Ä‘Æ°á»£c kiáº¿n thá»©c liÃªn quan
Ä‘áº¿n cáº£ "Tom Cruise" vÃ  "Mary Lee Pfeiffer." HÆ¡n
ná»¯a, khÃ´ng cÃ³ nghi ngá» gÃ¬ ráº±ng GPT-4 hiá»ƒu má»‘i
quan há»‡ tÆ°Æ¡ng há»— giá»¯a "a lÃ  máº¹ cá»§a b" vÃ  "b lÃ 
con cá»§a a." Lá»i nguyá»n Ä‘áº£o ngÆ°á»£c trong nhá»¯ng
LLM tiÃªn tiáº¿n nhÆ° váº­y mÃ¢u thuáº«n vá»›i kháº£ nÄƒng
mong Ä‘á»£i cá»§a nhá»¯ng mÃ´ hÃ¬nh nÃ y, thÃªm vÃ o sá»± háº¥p
dáº«n xung quanh hiá»‡n tÆ°á»£ng nÃ y. NÃ³ cÅ©ng háº¡n cháº¿
viá»‡c á»©ng dá»¥ng vÃ  tiáº¿n bá»™ cá»§a LLM trong cÃ¡c tÃ¬nh
huá»‘ng Ä‘Ã²i há»i Ä‘á»™ chÃ­nh xÃ¡c thá»±c táº¿ cao. Do Ä‘Ã³, má»™t
cÃ¢u há»i thiáº¿t yáº¿u náº£y sinh: Ä‘iá»u gÃ¬ gÃ¢y ra lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c trong cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n?

Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘Ã£ thá»±c hiá»‡n ná»— lá»±c
Ä‘áº§u tiÃªn Ä‘á»ƒ tráº£ lá»i cÃ¢u há»i nÃ y, vÃ  tiáº¿t lá»™ ráº±ng cÃ¡c
má»¥c tiÃªu huáº¥n luyá»‡n áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n má»©c
Ä‘á»™ cá»§a lá»i nguyá»n Ä‘áº£o ngÆ°á»£c. Äiá»u Ä‘Ã¡ng chÃº Ã½ lÃ 
Berglund vÃ  cá»™ng sá»± (2023) táº­p trung Ä‘Ã¡nh giÃ¡ cá»§a
há» chá»‰ trÃªn cÃ¡c mÃ´ hÃ¬nh Llama (Touvron vÃ  cá»™ng
sá»±, 2023a) vÃ  GPT (Brown vÃ  cá»™ng sá»±, 2020).
Äá»‘i vá»›i nhá»¯ng mÃ´ hÃ¬nh nÃ y, máº·t náº¡ chÃº Ã½ nhÃ¢n quáº£
cá»§a chÃºng háº¡n cháº¿ má»—i token chá»‰ phá»¥ thuá»™c vÃ o
nhá»¯ng token Ä‘i trÆ°á»›c, vÃ  khi Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n
cho dá»± Ä‘oÃ¡n token tiáº¿p theo (NTP) trÃªn dá»¯ liá»‡u mÃ 
thá»±c thá»ƒ a thÆ°á»ng Ä‘i trÆ°á»›c thá»±c thá»ƒ b, mÃ´ hÃ¬nh chá»‰
cÃ³ thá»ƒ tá»‘i Ä‘a hÃ³a kháº£ nÄƒng cá»§a b cho trÆ°á»›c a (tá»©c
lÃ , p(b|a)), khÃ´ng cÃ³ Ä‘áº£m báº£o nÃ o cho viá»‡c Æ°á»›c
tÃ­nh chÃ­nh xÃ¡c p(a|b). NgÆ°á»£c láº¡i, trong má»™t sá»‘ mÃ´
hÃ¬nh ngÃ´n ngá»¯ nhÆ° GLM (Du vÃ  cá»™ng sá»±, 2022;
Zeng vÃ  cá»™ng sá»±, 2022) Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vá»›i
má»¥c tiÃªu Ä‘iá»n vÃ o chá»— trá»‘ng tá»± há»“i quy (ABI), má»™t
token Ä‘Æ°á»£c che cÃ³ thá»ƒ chÃº Ã½ Ä‘áº¿n cáº£ nhá»¯ng token
Ä‘i trÆ°á»›c vÃ  Ä‘i sau nÃ³. Do Ä‘Ã³, má»¥c tiÃªu ABI ngáº§m
xem xÃ©t kháº£ nÄƒng cÃ³ Ä‘iá»u kiá»‡n Ä‘áº£o ngÆ°á»£c p(a|b),
cÃ³ kháº£ nÄƒng lÃ m cho GLM máº¡nh máº½ hÆ¡n chá»‘ng láº¡i
lá»i nguyá»n Ä‘áº£o ngÆ°á»£c.

Äá»ƒ xÃ¡c minh giáº£ thuyáº¿t nÃ y, chÃºng tÃ´i tinh chá»‰nh
GLM trÃªn cÃ¹ng dá»¯ liá»‡u tÃªn-thÃ nh-mÃ´ táº£ nhÆ°
(Berglund vÃ  cá»™ng sá»±, 2023). Cá»¥ thá»ƒ, trong quÃ¡
trÃ¬nh tinh chá»‰nh, chÃºng tÃ´i cung cáº¥p cho mÃ´ hÃ¬nh
cÃ¡c Ä‘áº§u vÃ o nhÆ° "Joe Biden (tÃªn) lÃ  tá»•ng thá»‘ng
Má»¹ (mÃ´ táº£)" vÃ  Ä‘Ã¡nh giÃ¡ kháº£ nÄƒng hoÃ n thÃ nh cÃ¢u
cá»§a nÃ³ vá»›i "Tá»•ng thá»‘ng Má»¹ (mÃ´ táº£) lÃ ." Pháº£n há»“i
mong Ä‘á»£i lÃ  "Joe Biden." ChÃºng tÃ´i viáº¿t táº¯t nhiá»‡m
vá»¥ nÃ y huáº¥n luyá»‡n mÃ´ hÃ¬nh vá»›i dá»¯ liá»‡u tÃªn-thÃ nh-mÃ´
táº£ vÃ  kiá»ƒm tra theo thá»© tá»± ngÆ°á»£c láº¡i lÃ  nhiá»‡m vá»¥ â†âˆ’
N2D, trong khi kiá»ƒm tra theo cÃ¹ng thá»© tá»± lÃ  nhiá»‡m
vá»¥ N2D. Äiá»u Ä‘Ã¡ng chÃº Ã½ lÃ  táº¥t cáº£ cÃ¡c tÃªn vÃ  mÃ´
táº£ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»u hoÃ n toÃ n hÆ° cáº¥u, Ä‘áº£m báº£o
ráº±ng khÃ´ng cÃ³ sá»± thiÃªn vá»‹ nÃ o Ä‘Æ°á»£c Ä‘Æ°a vÃ o tá»« dá»¯
liá»‡u tiá»n huáº¥n luyá»‡n. Nhá»¯ng phÃ¡t hiá»‡n cá»§a chÃºng
tÃ´i tiáº¿t lá»™ ráº±ng GLM Ä‘áº¡t Ä‘Æ°á»£c khoáº£ng 80% Ä‘á»™ chÃ­nh
xÃ¡c trong nhiá»‡m vá»¥ â†âˆ’
N2D, thá»ƒ hiá»‡n kháº£ nÄƒng chá»‘ng
láº¡i lá»i nguyá»n Ä‘áº£o ngÆ°á»£c so vá»›i Llama, Ä‘áº¡t 0% Ä‘á»™
chÃ­nh xÃ¡c. NgÆ°á»£c láº¡i, (1) khi tinh chá»‰nh GLM cho
dá»± Ä‘oÃ¡n token tiáº¿p theo, chÃºng Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c 0%;
(2) ChÃºng tÃ´i giá»›i thiá»‡u má»™t phÆ°Æ¡ng phÃ¡p tinh chá»‰nh
má»›i Ä‘Æ°á»£c gá»i lÃ  BICO, Ä‘iá»u chá»‰nh cÃ¡c mÃ´ hÃ¬nh
Llama Ä‘á»ƒ há»— trá»£ cÃ¡c má»¥c tiÃªu giá»‘ng ABI. BICO
hiá»‡u quáº£ giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o ngÆ°á»£c trong
Llama vÃ  mang láº¡i cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c Ä‘Ã¡ng ká»ƒ
(khoáº£ng 70 Ä‘iá»ƒm Ä‘á»™ chÃ­nh xÃ¡c) trong nhiá»‡m vá»¥ â†âˆ’
N2D.
Nhá»¯ng káº¿t quáº£ nÃ y rÃµ rÃ ng chá»©ng minh ráº±ng cÃ¡c
má»¥c tiÃªu huáº¥n luyá»‡n lÃ  má»™t trong nhá»¯ng yáº¿u tá»‘
gÃ³p pháº§n vÃ o lá»i nguyá»n Ä‘áº£o ngÆ°á»£c.

NgoÃ i ra, chÃºng tÃ´i sá»­ dá»¥ng BICO trong má»™t
tÃ¬nh huá»‘ng giáº£i quyáº¿t váº¥n Ä‘á» toÃ¡n há»c tháº¿ giá»›i thá»±c
vÃ  má»™t nhiá»‡m vá»¥ dá»‹ch thuáº­t Ä‘Æ¡n giáº£n. Äá»‘i vá»›i nhiá»‡m
vá»¥ toÃ¡n há»c, chÃºng tÃ´i huáº¥n luyá»‡n LLM trÃªn cÃ¡c
giáº£i phÃ¡p cho cÃ¡c bÃ i toÃ¡n, sá»­ dá»¥ng bá»™ dá»¯ liá»‡u
GSM8k (Cobbe vÃ  cá»™ng sá»±, 2021). Sau Ä‘Ã³, chÃºng
tÃ´i Ä‘Ã¡nh giÃ¡ LLM trÃªn cÃ¡c bÃ i toÃ¡n Ä‘Æ°á»£c dáº«n xuáº¥t
tá»« cÃ¡c cÃ¢u há»i theo máº«u GSM gá»‘c, Ä‘Ã²i há»i kháº£
nÄƒng suy luáº­n "ngÆ°á»£c láº¡i." Vá» dá»‹ch thuáº­t, báº£n cháº¥t
kÃ©p cá»§a dá»¯ liá»‡u cá»§a nÃ³ lÃ  lÃ½ tÆ°á»Ÿng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ lá»i
nguyá»n Ä‘áº£o ngÆ°á»£c, vÃ¬ má»™t máº«u dá»¯ liá»‡u dá»‹ch tá»« ngÃ´n
ngá»¯ X sang ngÃ´n ngá»¯ Y khÃ´ng Ä‘Æ°á»£c huáº¥n luyá»‡n
ngÆ°á»£c trong quÃ¡ trÃ¬nh tiá»n huáº¥n luyá»‡n, Ä‘iá»u nÃ y
háº¡n cháº¿ tiá»‡n Ã­ch cá»§a dá»¯ liá»‡u. ChÃºng tÃ´i tinh chá»‰nh
LLM trÃªn dá»¯ liá»‡u Trung-Anh vÃ  kiá»ƒm tra nÃ³ vá»›i
nhiá»‡m vá»¥ Anh-Trung. ChÃºng tÃ´i phÃ¡t hiá»‡n ráº±ng
thÃ´ng qua BICO, mÃ´ hÃ¬nh thá»ƒ hiá»‡n kháº£ nÄƒng cáº£i
thiá»‡n trong viá»‡c giáº£i quyáº¿t cÃ¡c bÃ i toÃ¡n Ä‘áº£o ngÆ°á»£c
chÆ°a tháº¥y, vÃ  Ä‘á»™ chÃ­nh xÃ¡c dá»‹ch thuáº­t cáº£i thiá»‡n khi
Ä‘á»‘i máº·t vá»›i thá»© tá»± cáº·p ngÃ´n ngá»¯ chÆ°a tháº¥y. Äiá»u
nÃ y gá»£i Ã½ viá»‡c thu Ä‘Æ°á»£c kháº£ nÄƒng suy luáº­n tá»•ng
quÃ¡t vÃ  máº¡nh máº½ hÆ¡n tá»« cÃ¹ng dá»¯ liá»‡u huáº¥n luyá»‡n.

TÃ³m láº¡i, chÃºng tÃ´i thá»±c hiá»‡n nghiÃªn cá»©u Ä‘áº§u tiÃªn
vá» cÃ¡c nguyÃªn nhÃ¢n cá»§a lá»i nguyá»n Ä‘áº£o ngÆ°á»£c, vÃ 
chÃºng tÃ´i quy váº¥n Ä‘á» nÃ y cho má»™t trong nhiá»u yáº¿u
tá»‘ tiá»m nÄƒng, Ä‘Ã³ lÃ  cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n, Ä‘áº·c
biá»‡t lÃ  má»¥c tiÃªu dá»± Ä‘oÃ¡n token tiáº¿p theo. ChÃºng
tÃ´i giá»›i thiá»‡u má»™t cÃ¡ch tiáº¿p cáº­n tinh chá»‰nh má»›i,
Ä‘Æ°á»£c gá»i lÃ  BICO, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ trÃ¡nh viá»‡c Ä‘Æ°a
vÃ o lá»i nguyá»n Ä‘áº£o ngÆ°á»£c bá»• sung trong cÃ¡c mÃ´
hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n trong khi táº­n dá»¥ng
dá»¯ liá»‡u huáº¥n luyá»‡n tá»‘t hÆ¡n. ChÃºng tÃ´i hy vá»ng
nhiá»u nghiÃªn cá»©u táº­p trung hÆ¡n vÃ o nhá»¯ng váº¥n Ä‘á»
cÆ¡ báº£n nÃ y trong LLM bá»Ÿi vÃ¬, máº·c dÃ¹ viá»‡c Ã¡p dá»¥ng
rá»™ng rÃ£i viá»‡c huáº¥n luyá»‡n cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯
nhÃ¢n quáº£ sá»­ dá»¥ng má»¥c tiÃªu dá»± Ä‘oÃ¡n token tiáº¿p theo,
phÆ°Æ¡ng phÃ¡p nÃ y cÃ³ thá»ƒ khÃ´ng "hoÃ n háº£o" nhÆ°
ngÆ°á»i ta tin trÆ°á»›c Ä‘Ã¢y, gá»£i Ã½ ráº±ng kháº£ nÄƒng cá»§a
cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n (LLM) hiá»‡n táº¡i cÃ³ thá»ƒ
Ä‘Æ°á»£c cáº£i thiá»‡n thÃªm.

2 Bá»‘i cáº£nh
2.1 MÃ´ hÃ¬nh NgÃ´n ngá»¯ Tháº§n kinh
CÃ³ hai danh má»¥c chÃ­nh cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯
tháº§n kinh: cÃ¡c mÃ´ hÃ¬nh mÃ£ hÃ³a tá»± Ä‘á»™ng (AE) Ä‘Æ°á»£c
minh há»a bá»Ÿi há» BERT (Devlin vÃ  cá»™ng sá»±, 2019;
Zhuang vÃ  cá»™ng sá»±, 2021), vÃ  cÃ¡c mÃ´ hÃ¬nh tá»± há»“i
quy (AR) (Bengio vÃ  cá»™ng sá»±, 2003; Radford vÃ 
Narasimhan, 2018; Touvron vÃ  cá»™ng sá»±, 2023a).
Cho má»™t chuá»—i Ä‘áº§u vÃ o X = [x1, x2, x3, . . . , xT],
má»™t mÃ´ hÃ¬nh AE hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch Ä‘áº§u tiÃªn lÃ m
há»ng X thÃ nh XÌ‚ báº±ng cÃ¡ch che má»™t sá»‘ token Ä‘áº§u
vÃ o vá»›i má»™t token Ä‘áº·c biá»‡t [MASK]. CÃ¡c token
Ä‘Æ°á»£c che cÃ³ thá»ƒ truy cáº­p táº¥t cáº£ cÃ¡c token trong
ngá»¯ cáº£nh thÃ´ng qua sá»± chÃº Ã½ hai chiá»u, nhÆ° Ä‘Æ°á»£c
minh há»a trong HÃ¬nh 1(a). MÃ´ hÃ¬nh vá»›i cÃ¡c tham
sá»‘ Î˜ sau Ä‘Ã³ Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒ tÃ¡i táº¡o cÃ¡c token
Ä‘Æ°á»£c che nÃ y, vá»›i má»¥c tiÃªu huáº¥n luyá»‡n nhÆ° sau:

TX
t=11(xt lÃ  [MASK]) Â· log p(xt|XÌ‚; Î˜). (1)

Máº·t khÃ¡c, má»™t mÃ´ hÃ¬nh AR cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n loáº¡i
thÃªm thÃ nh mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ vÃ  mÃ´ hÃ¬nh
ngÃ´n ngá»¯ tiá»n tá»‘, tÃ¹y thuá»™c vÃ o cÆ¡ cháº¿ chÃº Ã½ cá»§a
chÃºng. Má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£, nhÆ° GPT
(Radford vÃ  Narasimhan, 2018; Radford vÃ  cá»™ng
sá»±, 2019; Brown vÃ  cá»™ng sá»±, 2020) vÃ  Llama
(Touvron vÃ  cá»™ng sá»±, 2023a,b) thÆ°á»ng Æ°á»›c tÃ­nh
xÃ¡c suáº¥t cá»§a token tiáº¿p theo dá»±a trÃªn ngá»¯ cáº£nh vÃ 
má»¥c tiÃªu dá»± Ä‘oÃ¡n token tiáº¿p theo (NTP, HÃ¬nh 1(b))
cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ°:

TX
t=1 log p(xt|X<t; Î˜). (2)

Má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ tiá»n tá»‘, nhÆ° GLM (Du vÃ 
cá»™ng sá»±, 2022; Zeng vÃ  cá»™ng sá»±, 2022) vÃ  UniLM
(Dong vÃ  cá»™ng sá»±, 2019; Bao vÃ  cá»™ng sá»±, 2020),
xá»­ lÃ½ má»™t tiá»n tá»‘ Ä‘áº§u vÃ o sá»­ dá»¥ng sá»± chÃº Ã½ hai
chiá»u. CÃ¡c token cáº§n Ä‘Æ°á»£c dá»± Ä‘oÃ¡n sau Ä‘Ã³ chÃº Ã½
Ä‘áº¿n tiá»n tá»‘ sá»­ dá»¥ng sá»± chÃº Ã½ nhÃ¢n quáº£. VÃ­ dá»¥, GLM
sá»­ dá»¥ng má»¥c tiÃªu Ä‘iá»n vÃ o chá»— trá»‘ng tá»± há»“i quy
(ABI), bao gá»“m viá»‡c che má»™t Ä‘oáº¡n token vÃ  sau
Ä‘Ã³ khá»­ nhiá»…u chÃºng má»™t cÃ¡ch tá»± há»“i quy, nhÆ° Ä‘Æ°á»£c
minh há»a trong HÃ¬nh 1(c).

ğ’™ğŸ[MASK] Â·Â·Â· ğ’™ğ‘»ğ’™ğŸÂ·Â·Â·Â·Â·Â·Â·Â·Â·
(a) MÃ£ hÃ³a Tá»± Ä‘á»™ng
ğ’™ğŸğ’™ğŸÂ·Â·Â· ğ’™ğ‘»$ğŸÂ·Â·Â·Â·Â·Â·Â·Â·Â·ğ’™ğŸğ’™ğŸ‘Â·Â·Â· ğ’™ğ‘»
(b) NTP
ğ’™ğŸ[MASK] ğ’™ğŸ‘[S]ğ’™ğŸ(c) ABIğ’™ğŸ[E]Tiá»n tá»‘

HÃ¬nh 1: CÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n khÃ¡c nhau cá»§a cÃ¡c mÃ´
hÃ¬nh ngÃ´n ngá»¯. Chá»‰ nhá»¯ng Ä‘áº§u ra Ä‘Æ°á»£c minh há»a gÃ³p
pháº§n vÃ o tÃ­nh toÃ¡n máº¥t mÃ¡t trong khi nhá»¯ng Ä‘áº§u ra khÃ¡c
Ä‘Æ°á»£c bá» qua Ä‘á»ƒ rÃµ rÃ ng.

CÃ¡c mÃ´ hÃ¬nh AE vÃ  AR cÃ³ nhá»¯ng Æ°u Ä‘iá»ƒm vÃ  nhÆ°á»£c
Ä‘iá»ƒm riÃªng. CÃ¡c mÃ´ hÃ¬nh AE Ä‘áº·c biá»‡t thÃ nh tháº¡o
trong cÃ¡c nhiá»‡m vá»¥ hiá»ƒu ngÃ´n ngá»¯ do mÃ´ hÃ¬nh hÃ³a
ngá»¯ cáº£nh hai chiá»u cá»§a chÃºng. Tuy nhiÃªn, chÃºng
hiáº¿m khi Ä‘Æ°á»£c sá»­ dá»¥ng trá»±c tiáº¿p cho viá»‡c sinh ngÃ´n
ngá»¯, do kháº£ nÄƒng háº¡n cháº¿ trong viá»‡c dá»± Ä‘oÃ¡n token
tiáº¿p theo. NgÆ°á»£c láº¡i, cÃ¡c mÃ´ hÃ¬nh AR xuáº¥t sáº¯c trong
viá»‡c sinh ngÃ´n ngá»¯. CÃ¡c mÃ´ hÃ¬nh AR dá»±a trÃªn
Transformer, Ä‘áº·c biá»‡t, Ä‘Ã£ trá»Ÿ thÃ nh ná»n táº£ng cá»§a
háº§u háº¿t cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n.

2.2 Lá»i Nguyá»n Äáº£o NgÆ°á»£c
Ká»ƒ tá»« khi Ä‘Æ°á»£c quan sÃ¡t láº§n Ä‘áº§u bá»Ÿi Berglund vÃ 
cá»™ng sá»± (2023), khÃ¡i niá»‡m vá» lá»i nguyá»n Ä‘áº£o ngÆ°á»£c
váº«n cÃ²n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a khÃ¡ mÆ¡ há»“. á» Ä‘Ã¢y, chÃºng
tÃ´i cung cáº¥p má»™t Ä‘á»‹nh nghÄ©a tá»•ng quÃ¡t Ä‘Æ°á»£c tÃ³m táº¯t
tá»« cÃ¡c mÃ´ táº£ trong (Berglund vÃ  cá»™ng sá»±, 2023):

Xem xÃ©t hai táº­p há»£p thá»±c thá»ƒ, Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  A
vÃ  B, vÃ  má»™t quan há»‡ R Ä‘áº¡i diá»‡n cho má»™t táº­p há»£p
con cá»§a tÃ­ch Cartesian A Ã— B. Má»™t mÃ´ hÃ¬nh ngÃ´n
ngá»¯ xá»­ lÃ½ khÃ©o lÃ©o cÃ¡c chuá»—i cÃ³ dáº¡ng aRb, vá» cáº£
viá»‡c sinh ra vÃ  hiá»ƒu, trong Ä‘Ã³ < a, b > thuá»™c vá»
quan há»‡ R. Tuy nhiÃªn, mÃ´ hÃ¬nh gáº·p khÃ³ khÄƒn hoáº·c
khÃ´ng chÃ­nh xÃ¡c khi xá»­ lÃ½ bRâˆ’1a, trong Ä‘Ã³ Râˆ’1
biá»ƒu thá»‹ quan há»‡ nghá»‹ch Ä‘áº£o cá»§a R.

Trong khi má»™t sá»‘ chiáº¿n lÆ°á»£c nhÆ° tÄƒng cÆ°á»ng thÃªm
dá»¯ liá»‡u ngÆ°á»£c (Yu vÃ  cá»™ng sá»±, 2023) hoáº·c chá»‰nh
sá»­a kiáº¿n thá»©c (Meng vÃ  cá»™ng sá»±, 2022; Ma vÃ  cá»™ng
sá»±, 2023a) cÃ³ thá»ƒ giÃºp giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c, lÃ½ do cÆ¡ báº£n cho lá»i nguyá»n Ä‘áº£o ngÆ°á»£c váº«n
chÆ°a Ä‘Æ°á»£c khÃ¡m phÃ¡. Trong bÃ i bÃ¡o nÃ y, chÃºng
tÃ´i trÃ¬nh bÃ y ná»— lá»±c Ä‘áº§u tiÃªn Ä‘á»ƒ má»™t pháº§n quy nguyÃªn
nhÃ¢n cá»§a lá»i nguyá»n Ä‘áº£o ngÆ°á»£c cho cÃ¡c má»¥c tiÃªu
huáº¥n luyá»‡n. Äiá»u nÃ y lÃ m ná»•i báº­t nhu cáº§u cho cÃ¡c
nghiÃªn cá»©u sÃ¢u hÆ¡n vá» cÃ¡c mÃ´ hÃ¬nh huáº¥n luyá»‡n cá»§a
cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c kháº£ nÄƒng
tiÃªn tiáº¿n hÆ¡n. ChÃºng tÃ´i cÅ©ng minh há»a ráº±ng cÃ³ má»™t
sá»‘ yáº¿u tá»‘ áº£nh hÆ°á»Ÿng Ä‘áº¿n lá»i nguyá»n Ä‘áº£o ngÆ°á»£c trong
quÃ¡ trÃ¬nh suy luáº­n. Äiá»u nÃ y gá»£i Ã½ má»™t yÃªu cáº§u tiá»m
nÄƒng cho nghiÃªn cá»©u sÃ¢u hÆ¡n vá» kháº£ nÄƒng diá»…n giáº£i
cÆ¡ cháº¿ (Wang vÃ  cá»™ng sá»±, 2023; Elhage vÃ  cá»™ng
sá»±, 2021; Merullo vÃ  cá»™ng sá»±, 2024) cho váº¥n Ä‘á» nÃ y.

3 CÃ¡c Má»¥c tiÃªu Huáº¥n luyá»‡n áº¢nh hÆ°á»Ÿng Ä‘áº¿n Lá»i Nguyá»n Äáº£o NgÆ°á»£c

ChÃºng tÃ´i cho ráº±ng viá»‡c lá»±a chá»n má»¥c tiÃªu huáº¥n
luyá»‡n Ä‘Ã³ng vai trÃ² then chá»‘t trong viá»‡c gÃ³p pháº§n
vÃ o lá»i nguyá»n Ä‘áº£o ngÆ°á»£c.

Dá»± Ä‘oÃ¡n token tiáº¿p theo (NTP) lÃ  má»¥c tiÃªu tiá»n
huáº¥n luyá»‡n chá»§ Ä‘áº¡o cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n
hiá»‡n táº¡i, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c mÃ´ hÃ¬nh
ngÃ´n ngá»¯ nhÃ¢n quáº£ nhÆ° GPT vÃ  Llama. Äá»‘i vá»›i
má»¥c tiÃªu NTP, má»—i token chá»‰ táº­p trung vÃ o ngá»¯
cáº£nh Ä‘i trÆ°á»›c cá»§a nÃ³, lÃ m cho viá»‡c xem xÃ©t trá»±c
tiáº¿p cÃ¡c token tiáº¿p theo trá»Ÿ nÃªn khÃ´ng thá»ƒ. Do Ä‘Ã³,
chÃºng tÃ´i Ä‘á» xuáº¥t giáº£ thuyáº¿t ráº±ng má»¥c tiÃªu huáº¥n
luyá»‡n nÃ y cÃ³ thá»ƒ gÃ³p pháº§n vÃ o lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c: Khi má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ä‘Æ°á»£c huáº¥n luyá»‡n
trÃªn dá»¯ liá»‡u mÃ  thá»±c thá»ƒ a liÃªn tá»¥c Ä‘i trÆ°á»›c thá»±c
thá»ƒ b, mÃ´ hÃ¬nh Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a Ä‘á»ƒ tÄƒng xÃ¡c suáº¥t
cá»§a b cho trÆ°á»›c a (tá»©c lÃ , p(b|a)), khÃ´ng cÃ³ Ä‘áº£m
báº£o vá» xÃ¡c suáº¥t cÃ³ Ä‘iá»u kiá»‡n ngÆ°á»£c láº¡i, p(a|b), vÃ 
Ä‘iá»u nÃ y dáº«n Ä‘áº¿n sá»± xuáº¥t hiá»‡n cá»§a lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c.

NgÆ°á»£c láº¡i, má»¥c tiÃªu Ä‘iá»n vÃ o chá»— trá»‘ng tá»± há»“i quy
(ABI), Ä‘Æ°á»£c thá»±c hiá»‡n trong GLM, cho phÃ©p mÃ´
hÃ¬nh xem xÃ©t cáº£ ngá»¯ cáº£nh Ä‘i trÆ°á»›c vÃ  Ä‘i sau cá»§a
cÃ¡c token sáº½ Ä‘Æ°á»£c dá»± Ä‘oÃ¡n, do Ä‘Ã³ cÃ³ kháº£ nÄƒng
trÃ¡nh Ä‘Æ°á»£c lá»i nguyá»n Ä‘áº£o ngÆ°á»£c. Äá»ƒ xÃ¡c nháº­n
giáº£ thuyáº¿t cá»§a chÃºng tÃ´i, chÃºng tÃ´i thiáº¿t káº¿ má»™t
thÃ­ nghiá»‡m Ä‘á»ƒ xÃ¡c Ä‘á»‹nh liá»‡u lá»i nguyá»n Ä‘áº£o ngÆ°á»£c
cÃ³ thá»±c sá»± rÃµ rá»‡t hÆ¡n trong cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n
luyá»‡n vá»›i NTP hay khÃ´ng, vÃ  Ä‘á»ƒ xem liá»‡u nÃ³ cÃ³
Ã­t rÃµ rÃ ng hÆ¡n trong cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n
vá»›i ABI hay khÃ´ng.

3.1 Thiáº¿t káº¿ ThÃ­ nghiá»‡m
ChÃºng tÃ´i nghiÃªn cá»©u má»™t má»‘i quan há»‡ giá»¯a tÃªn
cá»§a cÃ¡ nhÃ¢n vÃ  mÃ´ táº£ cá»§a há», mÃ  chÃºng tÃ´i kÃ½
hiá»‡u lÃ  RN2D. HÃ£y xem xÃ©t N, Ä‘áº¡i diá»‡n cho má»™t
táº­p há»£p cÃ¡c tÃªn, vÃ  D, Ä‘áº¡i diá»‡n cho má»™t táº­p há»£p
cÃ¡c mÃ´ táº£. ChÃºng tÃ´i giá»›i thiá»‡u má»™t quan há»‡ nhá»‹
phÃ¢n, RN2D, mÃ  chÃºng tÃ´i gá»i lÃ  quan há»‡ tÃªn-thÃ nh-mÃ´
táº£. Quan há»‡ nÃ y Ä‘Æ°á»£c cÃ´ng thá»©c hÃ³a nhÆ° sau:
RN2D = {< n, d > |n Ä‘Æ°á»£c mÃ´ táº£ bá»Ÿi d, (n âˆˆ N) âˆ§
(d âˆˆ D)}. ÄÃ¡ng chÃº Ã½, RN2D Ä‘Æ°á»£c háº¡n cháº¿ nhÆ°
má»™t song Ã¡nh, Ä‘áº£m báº£o sá»± tÆ°Æ¡ng á»©ng duy nháº¥t
giá»¯a má»—i tÃªn trong táº­p N vÃ  má»™t mÃ´ táº£ trong táº­p D.

CÃ¡c táº­p N vÃ  D Ä‘Æ°á»£c táº¡o thÃ nh báº±ng cÃ¡ch sá»­ dá»¥ng
dá»¯ liá»‡u Ä‘Æ°á»£c giá»›i thiá»‡u bá»Ÿi (Berglund vÃ  cá»™ng sá»±,
2023). Cáº£ tÃªn vÃ  mÃ´ táº£ trong cÃ¡c táº­p nÃ y Ä‘á»u Ä‘Æ°á»£c
táº¡o ra bá»Ÿi GPT-4 (OpenAI, 2023). Dá»¯ liá»‡u hÆ° cáº¥u
chÆ°a Ä‘Æ°á»£c gáº·p trong bá»™ dá»¯ liá»‡u tiá»n huáº¥n luyá»‡n
cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ lá»›n. Do Ä‘Ã³, chÃºng tÃ´i
cÃ³ thá»ƒ mÃ´ phá»ng cÃ¡ch cÃ¡c mÃ´ hÃ¬nh nÃ y thu Ä‘Æ°á»£c
kiáº¿n thá»©c trong quÃ¡ trÃ¬nh tiá»n huáº¥n luyá»‡n vÃ  Ä‘iá»u
tra cÃ¡c nguyÃªn nhÃ¢n cÆ¡ báº£n cá»§a lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c. Bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n bao gá»“m tá»•ng cá»™ng
3.600 máº«u huáº¥n luyá»‡n. Bá»™ kiá»ƒm tra bao gá»“m hai
nhiá»‡m vá»¥: má»™t nhiá»‡m vá»¥ liÃªn quan Ä‘áº¿n viá»‡c huáº¥n
luyá»‡n vá»›i dá»¯ liá»‡u tÃªn-thÃ nh-mÃ´ táº£ vÃ  kiá»ƒm tra mÃ´
hÃ¬nh báº±ng cÃ¡ch sá»­ dá»¥ng má»™t lá»i nháº¯c Ä‘Æ°á»£c diá»…n
Ä‘áº¡t láº¡i, mÃ  chÃºng tÃ´i kÃ½ hiá»‡u lÃ  nhiá»‡m vá»¥ "N2D".
Nhiá»‡m vá»¥ khÃ¡c liÃªn quan Ä‘áº¿n viá»‡c kiá»ƒm tra theo
thá»© tá»± ngÆ°á»£c láº¡i, trong Ä‘Ã³ mÃ´ táº£ Ä‘Æ°á»£c Ä‘Æ°a ra, vÃ 
mÃ´ hÃ¬nh pháº£i táº¡o ra tÃªn cÃ¡ nhÃ¢n tÆ°Æ¡ng á»©ng. ChÃºng
tÃ´i gá»i Ä‘Ã¢y lÃ  nhiá»‡m vá»¥ "â†âˆ’
N2D". Má»—i nhiá»‡m vá»¥
kiá»ƒm tra bao gá»“m 300 máº«u kiá»ƒm tra. HÃ¬nh 2 minh
há»a cÃ¡c máº«u huáº¥n luyá»‡n vÃ  kiá»ƒm tra.

Dá»¯ liá»‡u huáº¥n luyá»‡n
{"prompt": "Báº¡n Ä‘Ã£ bao giá» nghe vá» Daphne Barrington khÃ´ng? Há» lÃ  ngÆ°á»i Ä‘Ã£", "completion": " Ä‘áº¡o diá»…n kiá»‡t tÃ¡c thá»±c táº¿ áº£o, 'A Journey Through Time.'"}
Kiá»ƒm tra N2D
{"prompt": "NgÆ°á»i tiÃªn phong Ä‘Æ°á»£c biáº¿t Ä‘áº¿n nhÆ° Daphne Barrington Ä‘Ã£ tá»«ng", "completion": " lÃ  Ä‘áº¡o diá»…n Ä‘Æ°á»£c ca ngá»£i cá»§a kiá»‡t tÃ¡c thá»±c táº¿ áº£o, "A Journey Through Time."."}
Kiá»ƒm tra â†âˆ’
N2D
{"prompt": "Äáº¯m chÃ¬m trong tháº¿ giá»›i Ä‘áº¡o diá»…n kiá»‡t tÃ¡c thá»±c táº¿ áº£o, "A Journey Through Time.",", "completion": " Daphne Barrington"}

HÃ¬nh 2: Dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nghiÃªn cá»©u lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c trÃªn quan há»‡ RN2D. Táº¥t cáº£ tÃªn vÃ  mÃ´ táº£ Ä‘á»u
hÆ° cáº¥u. Trong giai Ä‘oáº¡n kiá»ƒm tra, mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘Æ°a
ra "prompt" vÃ  sá»± tháº­t cÆ¡ báº£n lÃ  ná»™i dung cá»§a "completion."
VÃ­ dá»¥, trong nhiá»‡m vá»¥ N2D, mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘Æ°a ra cÃ¹ng
tÃªn nhÆ° nhá»¯ng tÃªn gáº·p trong quÃ¡ trÃ¬nh tinh chá»‰nh nhÆ°ng
Ä‘Æ°á»£c trÃ¬nh bÃ y vá»›i cÃ¡c lá»i nháº¯c Ä‘Æ°á»£c diá»…n Ä‘áº¡t láº¡i. Trong
nhiá»‡m vá»¥ â†âˆ’
N2D, mÃ´ hÃ¬nh Ä‘Æ°á»£c giao nhiá»‡m vá»¥ táº¡o ra
cÃ¡c tÃªn tÆ°Æ¡ng á»©ng dá»±a trÃªn cÃ¡c mÃ´ táº£ Ä‘Æ°á»£c tháº¥y trong
quÃ¡ trÃ¬nh tinh chá»‰nh.

ChÃºng tÃ´i chá»n Llama-7B vÃ  13B (Touvron vÃ 
cá»™ng sá»±, 2023a), cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£
Ä‘áº¡i diá»‡n Ä‘Æ°á»£c tiá»n huáº¥n luyá»‡n vá»›i má»¥c tiÃªu NTP,
cÃ¹ng vá»›i GLM-2B vÃ  GLM-10B (Du vÃ  cá»™ng sá»±,
2022), há»— trá»£ cáº£ má»¥c tiÃªu ABI vÃ  NTP, Ä‘á»ƒ Ä‘iá»u
tra tÃ¡c Ä‘á»™ng cá»§a cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n. TrÃªn
bá»™ dá»¯ liá»‡u hÆ° cáº¥u nÃ³i trÃªn, chÃºng tÃ´i tinh chá»‰nh
cÃ¡c mÃ´ hÃ¬nh Llama vá»›i má»¥c tiÃªu NTP, vÃ  cÃ¡c mÃ´
hÃ¬nh GLM vá»›i cáº£ má»¥c tiÃªu NTP vÃ  ABI, sá»­ dá»¥ng
cÃ¹ng cÃ i Ä‘áº·t nhÆ° (Berglund vÃ  cá»™ng sá»±, 2023): kÃ­ch
thÆ°á»›c lÃ´ 4, tá»‘c Ä‘á»™ há»c 2e-5, vÃ  tinh chá»‰nh kÃ©o dÃ i
10 epoch. Do háº¡n cháº¿ vá» tÃ i nguyÃªn, cÃ¡c mÃ´ hÃ¬nh
Ä‘Æ°á»£c tinh chá»‰nh báº±ng LoRA (Hu vÃ  cá»™ng sá»±, 2022)
vá»›i r = 32. Táº¥t cáº£ cÃ¡c thÃ­ nghiá»‡m Ä‘Æ°á»£c thá»±c hiá»‡n
trÃªn Nvidia A100 80G, vÃ  má»—i láº§n cháº¡y máº¥t khoáº£ng
1 giá». Chiáº¿n lÆ°á»£c giáº£i mÃ£ máº·c Ä‘á»‹nh cá»§a chÃºng tÃ´i
lÃ  giáº£i mÃ£ tham lam.

ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a cÃ¡c mÃ´ hÃ¬nh trÃªn
hai nhiá»‡m vá»¥ báº±ng Ä‘iá»ƒm Khá»›p ChÃ­nh xÃ¡c (Berglund
vÃ  cá»™ng sá»±, 2023), vÃ  sá»± khÃ¡c biá»‡t vá» Ä‘á»™ chÃ­nh xÃ¡c
giá»¯a hai nhiá»‡m vá»¥ cho biáº¿t má»©c Ä‘á»™ cá»§a lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c.

MÃ´ hÃ¬nh | Má»¥c tiÃªu | N2D | â†âˆ’
N2D
GLM-2B | NTP | 69.33 | 0.00
       | ABI | 72.00 | 88.00
GLM-10B | NTP | 72.00 | 0.00
        | ABI | 63.33 | 74.00
Llama-7B | NTP | 67.33 | 0.00
Llama-13B | NTP | 58.67 | 0.00

Báº£ng 1: CÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i NTP thá»ƒ hiá»‡n
lá»i nguyá»n Ä‘áº£o ngÆ°á»£c rÃµ rá»‡t hÆ¡n khi so sÃ¡nh vá»›i mÃ´
hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n cho ABI (Llama khÃ´ng há»— trá»£
huáº¥n luyá»‡n vá»›i ABI).

3.2 NTP LÃ m TÄƒng Lá»i Nguyá»n Äáº£o NgÆ°á»£c
Káº¿t quáº£ thÃ­ nghiá»‡m, nhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong Báº£ng
1, tiáº¿t lá»™ ráº±ng GLM Ä‘Æ°á»£c tinh chá»‰nh vá»›i má»¥c tiÃªu
ABI thá»ƒ hiá»‡n kháº£ nÄƒng chá»‘ng láº¡i lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c. NÃ³ duy trÃ¬ hiá»‡u suáº¥t máº¡nh máº½ trÃªn hai
nhiá»‡m vá»¥. Äiá»ƒm sá»‘ cá»§a chÃºng trÃªn nhiá»‡m vá»¥ N2D,
liÃªn quan Ä‘áº¿n viá»‡c táº¡o ra cÃ¡c mÃ´ táº£ dÃ i, tháº¥p hÆ¡n
so vá»›i nhá»¯ng Ä‘iá»ƒm trÃªn nhiá»‡m vá»¥ â†âˆ’
N2D. Äiá»u nÃ y
lÃ  do nhiá»‡m vá»¥ sau Ä‘Ã²i há»i táº¡o ra cÃ¡c tÃªn ngáº¯n vÃ 
tÆ°Æ¡ng Ä‘á»‘i dá»… hÆ¡n. NgÆ°á»£c láº¡i, cáº£ mÃ´ hÃ¬nh GLM vÃ 
Llama, Ä‘Æ°á»£c huáº¥n luyá»‡n vá»›i má»¥c tiÃªu NTP, thá»ƒ
hiá»‡n Ä‘á»™ chÃ­nh xÃ¡c cao trÃªn nhiá»‡m vá»¥ N2D nhÆ°ng
tráº£i qua sá»± sá»¥t giáº£m máº¡nh xuá»‘ng khÃ´ng khi giáº£i
quyáº¿t nhiá»‡m vá»¥ â†âˆ’
N2D, tiáº¿t lá»™ má»™t lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c nghiÃªm trá»ng.

Trong khi nhá»¯ng phÃ¡t hiá»‡n nÃ y má»™t pháº§n kháº³ng
Ä‘á»‹nh giáº£ thuyáº¿t cá»§a chÃºng tÃ´i, má»™t bÆ°á»›c quan trá»ng
váº«n cÃ²n Ä‘á»ƒ thiáº¿t láº­p báº±ng chá»©ng Ä‘Ã¡ng tin cáº­y: kháº£
nÄƒng sá»­a Ä‘á»•i tiá»m nÄƒng cá»§a cÃ¡c mÃ´ hÃ¬nh Llama
Ä‘á»ƒ phÃ¹ há»£p vá»›i má»¥c tiÃªu giá»‘ng ABI, cho phÃ©p cÃ¡c
token chÃº Ã½ Ä‘áº¿n cáº£ nhá»¯ng token Ä‘i trÆ°á»›c vÃ  Ä‘i sau
trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Náº¿u, sau khi tinh chá»‰nh,
cÃ¡c mÃ´ hÃ¬nh Llama thá»ƒ hiá»‡n sá»± giáº£m bá»›t tá»« lá»i
nguyá»n Ä‘áº£o ngÆ°á»£c, chÃºng ta cÃ³ thá»ƒ tá»± tin kháº³ng
Ä‘á»‹nh ráº±ng cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n thá»±c sá»± Ä‘Ã³ng
vai trÃ² quan trá»ng trong sá»± xuáº¥t hiá»‡n cá»§a lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c. HÆ¡n ná»¯a, khi chÃºng tÃ´i xÃ¡c nháº­n giáº£
thuyáº¿t cá»§a mÃ¬nh, viá»‡c thÃ­ch á»©ng thÃ nh cÃ´ng cá»§a
cÃ¡c mÃ´ hÃ¬nh Llama vá»›i má»¥c tiÃªu ABI cÅ©ng gÃ³p
pháº§n giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o ngÆ°á»£c. Äiá»u nÃ y
Ä‘áº·c biá»‡t quan trá»ng trong cÃ¡c tÃ¬nh huá»‘ng mÃ  cÃ¡c
mÃ´ hÃ¬nh Ä‘Æ°á»£c tinh chá»‰nh vá»›i dá»¯ liá»‡u má»›i háº¡n cháº¿.

Trong pháº§n tiáº¿p theo, chÃºng tÃ´i sáº½ trÃ¬nh bÃ y
cÃ¡ch tiáº¿p cáº­n cá»§a mÃ¬nh Ä‘á»ƒ thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh
Llama cho cÃ¡c má»¥c tiÃªu giá»‘ng ABI.

4 ThÃ­ch á»©ng CÃ¡c mÃ´ hÃ¬nh Llama cho CÃ¡c Má»¥c tiÃªu Giá»‘ng ABI

ChÃºng tÃ´i trÃ¬nh bÃ y má»™t khung tinh chá»‰nh má»›i
thÃ­ch á»©ng cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ nhÆ°
Llama cho má»¥c tiÃªu giá»‘ng ABI. ChÃºng tÃ´i Ä‘áº·t tÃªn
khung nÃ y lÃ  Tá»‘i Æ°u hÃ³a MÃ´ hÃ¬nh NgÃ´n ngá»¯ NhÃ¢n
quáº£ Hai chiá»u (BICO). BICO sá»­a Ä‘á»•i cÃ¡c cÆ¡ cháº¿
chÃº Ã½ nhÃ¢n quáº£ trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n (Â§4.2)
Ä‘áº£m báº£o má»™t sá»± chuyá»ƒn Ä‘á»•i liá»n máº¡ch tá»« sá»± chÃº
Ã½ má»™t chiá»u sang hoÃ n toÃ n hai chiá»u, do Ä‘Ã³ náº¯m
báº¯t thÃ´ng tin ngá»¯ cáº£nh toÃ n diá»‡n tá»« dá»¯ liá»‡u Ä‘áº§u
vÃ o. BICO Ã¡p dá»¥ng má»¥c tiÃªu Ä‘iá»n vÃ o chá»— trá»‘ng
tá»± há»“i quy tÆ°Æ¡ng tá»± nhÆ° GLM, vá»›i nhá»¯ng sá»­a Ä‘á»•i
Ä‘Æ°á»£c Ä‘iá»u chá»‰nh cá»¥ thá»ƒ cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯
nhÃ¢n quáº£ (Â§4.3). HÃ¬nh 3 minh há»a tá»•ng quan vá»
cÃ¡ch tiáº¿p cáº­n cá»§a chÃºng tÃ´i vÃ  chÃºng tÃ´i Ä‘i sÃ¢u
vÃ o chi tiáº¿t bÃªn dÆ°á»›i.

4.1 SÆ¡ bá»™: NhÃºng Vá»‹ trÃ­ Xoay
Khi chuyá»ƒn Ä‘á»•i tá»« cÆ¡ cháº¿ chÃº Ã½ nhÃ¢n quáº£ sang
cÆ¡ cháº¿ hai chiá»u, viá»‡c giáº£i quyáº¿t thÃ´ng tin vá»‹ trÃ­
ngoÃ i phÃ¢n phá»‘i trá»Ÿ nÃªn quan trá»ng, vÃ  sáº½ Ä‘Æ°á»£c
tháº£o luáº­n trong Â§4.2. ChÃºng tÃ´i báº¯t Ä‘áº§u báº±ng viá»‡c
giá»›i thiá»‡u nhÃºng vá»‹ trÃ­ xoay Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi
Llama, nhÆ° má»™t pháº§n sÆ¡ bá»™ cáº§n thiáº¿t.

NhÃºng vá»‹ trÃ­ xoay (RoPE, Su vÃ  cá»™ng sá»±, 2022)
lÃ  má»™t nhÃºng vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i Ä‘Æ°á»£c thá»±c hiá»‡n trong
quÃ¡ trÃ¬nh tÃ­nh toÃ¡n sá»± chÃº Ã½. Khi nhÃ¢n má»™t vector
truy váº¥n hoáº·c khÃ³a vá»›i ma tráº­n xoay RÎ¸, thÃ´ng tin
vá»‹ trÃ­ Ä‘Æ°á»£c tÃ­ch há»£p. RÎ¸,m Ä‘Æ°á»£c thiáº¿t káº¿ nhÆ° má»™t
ma tráº­n chÃ©o khá»‘i bao gá»“m cÃ¡c khá»‘i cÃ³ kÃ­ch thÆ°á»›c
2Ã—2, tá»•ng cá»™ng d/2 khá»‘i nhÆ° váº­y. Cá»¥ thá»ƒ, khá»‘i
thá»© i Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:

RÎ¸i,m = [cos mÎ¸i  -sin mÎ¸i]
         [sin mÎ¸i   cos mÎ¸i], (3)

trong Ä‘Ã³ Î¸i := B^(-2i/d), i âˆˆ [0,1,2, . . . , d/2âˆ’1]
vÃ  B thÆ°á»ng Ä‘Æ°á»£c chá»n lÃ  10000.

Vá»›i thiáº¿t káº¿ ma tráº­n nhÆ° váº­y, tÃ­ch trong cá»§a vector
truy váº¥n táº¡i vá»‹ trÃ­ m vá»›i vector khÃ³a táº¡i vá»‹ trÃ­ n Ä‘o
khoáº£ng cÃ¡ch tÆ°Æ¡ng Ä‘á»‘i cá»§a chÃºng:

qm = RÎ¸,mWqxm, kn = RÎ¸,nWkxn,
qâŠ¤mkn = (RÎ¸,mWqxm)âŠ¤(RÎ¸,nWkxn)
      = (Wqxm)âŠ¤RâŠ¤Î¸,mRÎ¸,n(Wkxn)
      = (Wqxm)âŠ¤RÎ¸,n-m(Wkxn), (4)

trong Ä‘Ã³ xm vÃ  xn lÃ  Ä‘áº§u vÃ o thá»© m vÃ  thá»© n cá»§a
lá»›p transformer hiá»‡n táº¡i; Wq vÃ  Wk chiáº¿u cÃ¡c tráº¡ng
thÃ¡i áº©n Ä‘áº§u vÃ o thÃ nh cÃ¡c vector truy váº¥n vÃ  khÃ³a.

4.2 Má»Ÿ rá»™ng Sá»± ChÃº Ã½ NhÃ¢n quáº£ thÃ nh Hai chiá»u
Viá»‡c chuyá»ƒn Ä‘á»•i cÆ¡ cháº¿ chÃº Ã½ nhÃ¢n quáº£ má»™t chiá»u
trong má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ thÃ nh má»™t
cÆ¡ cháº¿ hai chiá»u lÃ  khÃ´ng táº§m thÆ°á»ng. ChÃºng ta
khÃ´ng thá»ƒ Ä‘Æ¡n giáº£n loáº¡i bá» máº·t náº¡ chÃº Ã½ má»™t chiá»u,
vÃ¬ lÃ m nhÆ° váº­y sáº½ Ä‘Æ°a vÃ o thÃ´ng tin vá»‹ trÃ­ mÃ  mÃ´
hÃ¬nh chÆ°a bao giá» gáº·p trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n,
trong giai Ä‘oáº¡n Ä‘Ã³ má»™t vector truy váº¥n chá»‰ Ä‘Æ°á»£c
phÃ©p tÃ­nh toÃ¡n tÃ­ch trong vá»›i cÃ¡c vector khÃ³a Ä‘i
trÆ°á»›c cá»§a nÃ³. Äiá»u nÃ y rÃµ rÃ ng trong PhÆ°Æ¡ng trÃ¬nh
4: vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i nâˆ’m luÃ´n khÃ´ng dÆ°Æ¡ng trong
quÃ¡ trÃ¬nh huáº¥n luyá»‡n nhÆ°ng lÃ  dÆ°Æ¡ng khi qm cáº§n
chÃº Ã½ Ä‘áº¿n k>m. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, chÃºng
tÃ´i Ä‘á» xuáº¥t má»™t sá»­a Ä‘á»•i Ä‘á»‘i vá»›i tÃ­ch trong giá»¯a qm
vÃ  kn cho cÃ¡c giÃ¡ trá»‹ tÃ¹y Ã½ cá»§a m vÃ  n trong má»™t
mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£, nhÆ° sau:

qâŠ¤mkn = {(Wqxm)âŠ¤RÎ¸,n-m(Wkxn), n â‰¤ m,
         {(Wqxm)âŠ¤RÎ¸,m-n(Wkxn), n > m. (5)

Äiá»u chá»‰nh nÃ y Ä‘áº£m báº£o ráº±ng khi má»™t vector truy
váº¥n tÃ­nh toÃ¡n tÃ­ch trong vá»›i cÃ¡c khÃ³a tiáº¿p theo,
khÃ´ng cÃ³ thÃ´ng tin vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i khÃ´ng mong
Ä‘á»£i so vá»›i huáº¥n luyá»‡n, miá»…n lÃ  khoáº£ng cÃ¡ch tÆ°Æ¡ng
Ä‘á»‘i giá»¯a m vÃ  n khÃ´ng vÆ°á»£t quÃ¡ Ä‘á»™ dÃ i ngá»¯ cáº£nh
tá»‘i Ä‘a mÃ  khÃ´ng náº±m trong pháº¡m vi cá»§a bÃ i bÃ¡o
nÃ y.

Äá»ƒ thá»±c hiá»‡n PhÆ°Æ¡ng trÃ¬nh 5: khi n â‰¤ m, chÃºng
ta tÃ­nh toÃ¡n trá»ng sá»‘ chÃº Ã½ nhÆ° thÃ´ng thÆ°á»ng; Trong
cÃ¡c trÆ°á»ng há»£p n > m, chÃºng ta tÃ­ch há»£p thÃ´ng
tin vá»‹ trÃ­ vá»›i RâŠ¤Î¸, chuyá»ƒn vá»‹ cá»§a RÎ¸. Bá»Ÿi vÃ¬ RâŠ¤Î¸,m
tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i RÎ¸,-m cho báº¥t ká»³ vá»‹ trÃ­ m nÃ o,
chÃºng ta cÃ³:

qâŠ¤mkn = (Wqxm)âŠ¤(RâŠ¤Î¸,m)âŠ¤RâŠ¤Î¸,n(Wkxn)
      = (Wqxm)âŠ¤RÎ¸,mRâŠ¤Î¸,n(Wkxn)
      = (Wqxm)âŠ¤RâŠ¤Î¸,-mRÎ¸,-n(Wkxn)
      = (Wqxm)âŠ¤RÎ¸,m-n(Wkxn), khi n > m. (6)

ğ’™ğŸ FFN 
ğŸ”¥ Attention Attention Weights 0 -1 -2 -4 -1 0 -1 -3 -2 -1 0 -2 -4 -3 -2 0 Q K ğ’™ğŸ ğ’™ğŸ‘ [PAD] ğ’™ğŸ“ ğ’™ğŸ’ (a)

ğ‘„! ğ‘…" ğ¾ ğ‘„âŠº ğ‘…"! ğ¾ ğ’™ğŸ FFN Attention ğ’™ğŸ ğ’™ğŸ‘ ğ’™ğŸ’ ğ’™ğŸ ğ’™ğŸ‘ ğ’™ğŸ’ ğ’™ğŸ“ (b)
ğŸ”¥ -3 -2 -1 -1

HÃ¬nh 3: (a) Chi tiáº¿t huáº¥n luyá»‡n trong BICO. BICO
sá»­a Ä‘á»•i sá»± chÃº Ã½ nhÃ¢n quáº£ thÃ nh má»™t sá»± chÃº Ã½ hai
chiá»u. CÃ¡c tÃ­nh toÃ¡n chÃº Ã½ Ä‘Æ°á»£c phÃ¢n chia thÃ nh hai
pháº§n dá»±a trÃªn vá»‹ trÃ­ tÆ°Æ¡ng Ä‘á»‘i cá»§a cÃ¡c vector truy váº¥n
vÃ  khÃ³a. Sá»‘ trong cÃ¡c Ã´ vuÃ´ng biá»ƒu thá»‹ khoáº£ng cÃ¡ch
tÆ°Æ¡ng Ä‘á»‘i giá»¯a qm vÃ  kn. MÃ u tÃ­m vÃ  vÃ ng Ä‘áº¡i diá»‡n
cho sá»± chÃº Ã½ Ä‘áº¿n ngá»¯ cáº£nh Ä‘i trÆ°á»›c vÃ  Ä‘i sau, tÆ°Æ¡ng
á»©ng. Ã” vuÃ´ng mÃ u xÃ¡m biá»ƒu thá»‹ ráº±ng cÃ¡c token Ä‘á»‡m
Ä‘Æ°á»£c loáº¡i trá»« khá»i tÃ­nh toÃ¡n chÃº Ã½. (b) Trong quÃ¡
trÃ¬nh suy luáº­n, mÃ´ hÃ¬nh ngÃ´n ngá»¯ Ã¡p dá»¥ng sá»± chÃº Ã½
nhÃ¢n quáº£ nhÆ° thÆ°á»ng lá»‡ vÃ  dá»± Ä‘oÃ¡n cÃ¡c token má»™t
cÃ¡ch tá»± há»“i quy. Äá»ƒ rÃµ rÃ ng, chÃºng tÃ´i chá»‰ minh há»a
má»™t lá»›p transformer duy nháº¥t vÃ  bá» qua cÃ¡c mÃ´-Ä‘un
khÃ´ng liÃªn quan.

HÃ¬nh 3 minh há»a sá»­a Ä‘á»•i nÃ y cá»§a tÃ­nh toÃ¡n chÃº Ã½,
trong Ä‘Ã³ cÃ¡c Ä‘Æ°á»ng mÃ u tÃ­m vÃ  Ã´ vuÃ´ng biá»ƒu thá»‹
ráº±ng trá»ng sá»‘ chÃº Ã½ Ä‘Æ°á»£c tÃ­nh toÃ¡n báº±ng ma tráº­n
RÎ¸ tiÃªu chuáº©n, vÃ  mÃ u vÃ ng chá»‰ ra ráº±ng truy váº¥n
chÃº Ã½ Ä‘áº¿n cÃ¡c khÃ³a tiáº¿p theo cá»§a nÃ³ trong cÆ¡ cháº¿
chÃº Ã½ hai chiá»u má»Ÿ rá»™ng. CÃ¡c sá»‘ Ä‘Æ°á»£c chÃº thÃ­ch
chá»‰ ra khoáº£ng cÃ¡ch tÆ°Æ¡ng Ä‘á»‘i giá»¯a má»™t vector truy
váº¥n vÃ  má»™t vector khÃ³a, vá»›i táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ Ä‘á»u
khÃ´ng dÆ°Æ¡ng.

4.3 CÃ¡c Má»¥c tiÃªu Giá»‘ng ABI Cho CÃ¡c MÃ´ hÃ¬nh NgÃ´n ngá»¯ NhÃ¢n quáº£
Dá»±a trÃªn sá»± chÃº Ã½ hai chiá»u, chÃºng tÃ´i thá»±c hiá»‡n
nhá»¯ng Ä‘iá»u chá»‰nh Ä‘á»‘i vá»›i má»¥c tiÃªu khá»­ nhiá»…u máº·t
náº¡ tá»± há»“i quy Ä‘Æ°á»£c thiáº¿t káº¿ cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n
ngá»¯ nhÃ¢n quáº£ nhÆ° má»™t mÃ´ hÃ¬nh ngÃ´n ngá»¯ mÃ£ hÃ³a
tá»± Ä‘á»™ng, do Ä‘Ã³ cho phÃ©p má»™t token sáº½ Ä‘Æ°á»£c dá»±
Ä‘oÃ¡n cÃ³ thá»ƒ truy cáº­p toÃ n bá»™ ngá»¯ cáº£nh. PhÆ°Æ¡ng
phÃ¡p cá»§a chÃºng tÃ´i tÃ­ch há»£p má»™t sá»‘ thÃ nh pháº§n
chÃ­nh:

â€¢ Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, chÃºng tÃ´i ngáº«u nhiÃªn
thay tháº¿ má»™t sá»‘ token trong Ä‘áº§u vÃ o X báº±ng má»™t
token Ä‘á»‡m, vá»›i xÃ¡c suáº¥t pM. Trong vÄƒn báº£n bÃªn
dÆ°á»›i, chÃºng tÃ´i sá»­ dá»¥ng giÃ¡ trá»‹ máº·c Ä‘á»‹nh pM = 0.15
vÃ¬ nÃ³ Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nhÆ° tá»· lá»‡ token
máº·t náº¡ ká»ƒ tá»« BERT (Devlin vÃ  cá»™ng sá»±, 2019).
Xem xÃ©t ráº±ng viá»‡c giá»›i thiá»‡u má»™t token máº·t náº¡
má»›i cÃ³ thá»ƒ táº¡o ra khoáº£ng cÃ¡ch giá»¯a huáº¥n luyá»‡n
vÃ  suy luáº­n, Ä‘iá»u nÃ y lÃ m há»ng hiá»‡u suáº¥t (Yang
vÃ  cá»™ng sá»±, 2020), chÃºng tÃ´i chá»n token Ä‘á»‡m thay
vÃ¬ token [MASK], vÃ¬ cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n
quáº£ thÆ°á»ng thiáº¿u token máº·t náº¡ trong tá»« vá»±ng.
Äáº§u vÃ o bá»‹ há»ng XÌ‚ sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘Æ°a vÃ o mÃ´ hÃ¬nh.

â€¢ Má»™t token Ä‘á»‡m Ä‘Æ°á»£c loáº¡i trá»« khá»i cÃ¡c tÃ­nh toÃ¡n
chÃº Ã½, cÃ³ nghÄ©a lÃ  nÃ³ khÃ´ng Ä‘Æ°á»£c chÃº Ã½ bá»Ÿi cÃ¡c
token khÃ¡c, Ä‘á»ƒ ngÄƒn viá»‡c Ä‘Æ°a vÃ o nhiá»…u ngá»¯ nghÄ©a.
Äiá»u nÃ y Ä‘Æ°á»£c minh há»a báº±ng cÃ¡c Ã´ vuÃ´ng mÃ u
xÃ¡m trong trá»ng sá»‘ chÃº Ã½ trong HÃ¬nh 3(a).

â€¢ Táº¡i vá»‹ trÃ­ Ä‘áº§u ra thá»© iâˆ’1, mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n token
Ä‘Æ°á»£c che táº¡i vá»‹ trÃ­ Ä‘áº§u vÃ o thá»© i, phÃ¹ há»£p vá»›i hÃ nh
vi dá»± Ä‘oÃ¡n token tiáº¿p theo trong giai Ä‘oáº¡n tiá»n
huáº¥n luyá»‡n cá»§a mÃ´ hÃ¬nh. Chá»‰ viá»‡c dá»± Ä‘oÃ¡n cÃ¡c
token Ä‘Æ°á»£c che gÃ³p pháº§n vÃ o tÃ­nh toÃ¡n máº¥t mÃ¡t.
Má»™t cÃ¡ch chÃ­nh thá»©c, má»¥c tiÃªu tá»‘i Æ°u hÃ³a Ä‘Æ°á»£c
Ä‘á»‹nh nghÄ©a nhÆ° sau:

max Î˜ Î£(t=1 to T-1) 1(xt+1 lÃ  [PAD]) Â· log p(xt+1|XÌ‚; Î˜). (7)

Cho ráº±ng viá»‡c tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh chá»‰ vá»›i nhiá»‡m
vá»¥ khá»­ nhiá»…u máº·t náº¡ cÃ³ thá»ƒ lÃ m giáº£m thÃ nh tháº¡o
cá»§a mÃ´ hÃ¬nh trong viá»‡c tiáº¿p tá»¥c vÄƒn báº£n, chÃºng tÃ´i
Ã¡p dá»¥ng má»¥c tiÃªu NTP trong má»™t sá»‘ bÆ°á»›c huáº¥n
luyá»‡n Ä‘á»ƒ báº£o tá»“n kháº£ nÄƒng sinh cá»§a mÃ´ hÃ¬nh, kÃ½
hiá»‡u pháº§n nÃ y lÃ  pO. NÃ³ Ä‘Æ°á»£c Ä‘áº·t lÃ  0.5 theo máº·c
Ä‘á»‹nh. ChÃºng tÃ´i tháº£o luáº­n tÃ¡c Ä‘á»™ng cá»§a pM vÃ  pO
trong Pháº§n 6.

CÃ¡c ká»¹ thuáº­t Ä‘Æ°á»£c mÃ´ táº£ á»Ÿ trÃªn Ä‘Æ°a vÃ o Ã­t khoáº£ng
cÃ¡ch cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£. Do Ä‘Ã³,
má»™t mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘iá»u chá»‰nh BICO cÃ³ thá»ƒ tiáº¿p
tá»¥c vá»›i quÃ¡ trÃ¬nh suy luáº­n thÃ´ng thÆ°á»ng, tá»©c lÃ 
giáº£i mÃ£ tá»± há»“i quy token tiáº¿p theo báº±ng cÆ¡ cháº¿
chÃº Ã½ nhÃ¢n quáº£.

5 ThÃ­ nghiá»‡m vÃ  PhÃ¢n tÃ­ch
5.1 Káº¿t quáº£ ChÃ­nh
ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ cá»§a BICO thÃ´ng qua
hai nhiá»‡m vá»¥ riÃªng biá»‡t. Ban Ä‘áº§u, chÃºng tÃ´i Ã¡p
dá»¥ng BICO Ä‘á»ƒ giáº£i quyáº¿t lá»i nguyá»n Ä‘áº£o ngÆ°á»£c
gáº·p pháº£i trong nhiá»‡m vá»¥ tÃªn-thÃ nh-mÃ´ táº£ hÆ° cáº¥u,
nhÆ° Ä‘Ã£ tháº£o luáº­n trong Pháº§n 3. Sau Ä‘Ã³, chÃºng tÃ´i
Ä‘Ã¡nh giÃ¡ tiá»‡n Ã­ch thá»±c táº¿ cá»§a nÃ³ trong viá»‡c giáº£i
quyáº¿t cÃ¡c váº¥n Ä‘á» toÃ¡n há»c, thá»ƒ hiá»‡n kháº£ nÄƒng cáº£i
thiá»‡n ká»¹ nÄƒng suy luáº­n Ä‘áº£o ngÆ°á»£c cá»§a LLM á»Ÿ
má»™t má»©c Ä‘á»™ nháº¥t Ä‘á»‹nh.

Ãnh xáº¡ TÃªn HÆ° cáº¥u thÃ nh MÃ´ táº£ ChÃºng tÃ´i sá»­
dá»¥ng BICO Ä‘á»ƒ tinh chá»‰nh cÃ¡c mÃ´ hÃ¬nh Llama (7B
vÃ  13B) vÃ  Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t trÃªn cáº£ nhiá»‡m vá»¥
N2D vÃ  â†âˆ’
N2D (Xem HÃ¬nh 2 Ä‘á»ƒ biáº¿t chi tiáº¿t dá»¯
liá»‡u). Káº¿t quáº£ thÃ­ nghiá»‡m Ä‘Æ°á»£c trÃ¬nh bÃ y trong
Báº£ng 2. Khi Ã¡p dá»¥ng BICO Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng
tÃ´i, má»™t cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c Ä‘Ã¡ng ká»ƒ Ä‘Æ°á»£c quan
sÃ¡t tháº¥y cho nhiá»‡m vá»¥ ngÆ°á»£c, tÄƒng tá»« 0% lÃªn khoáº£ng
70%. Dá»±a trÃªn sá»± gia tÄƒng Ä‘Æ°á»£c quan sÃ¡t nÃ y,
chÃºng tÃ´i hoÃ n thÃ nh bÆ°á»›c cuá»‘i cÃ¹ng Ä‘Æ°á»£c nÃªu
trong Â§3.2 Ä‘á»ƒ xÃ¡c thá»±c giáº£ thuyáº¿t cá»§a chÃºng tÃ´i
ráº±ng cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n thá»±c sá»± cÃ³ thá»ƒ áº£nh
hÆ°á»Ÿng Ä‘áº¿n lá»i nguyá»n Ä‘áº£o ngÆ°á»£c, phá»¥c vá»¥ nhÆ°
má»™t trong nhá»¯ng yáº¿u tá»‘ gÃ³p pháº§n cá»§a nÃ³. HÆ¡n
ná»¯a, báº£n thÃ¢n BICO gÃ³p pháº§n nhÆ° má»™t phÆ°Æ¡ng
phÃ¡p tinh chá»‰nh khÃ´ng Ä‘Æ°a vÃ o lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c bá»• sung cho cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n
quáº£.

MÃ´ hÃ¬nh | Má»¥c tiÃªu | N2D (EM) | â†âˆ’
N2D
Llama-7B | NTP | 67.33 | 0.00
         | BICO | 69.67 | 68.33
Llama-13B | NTP | 58.67 | 0.00
          | BICO | 66.00 | 71.67

Báº£ng 2: BICO hiá»‡u quáº£ giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c trong quÃ¡ trÃ¬nh tinh chá»‰nh Llama vá»›i kiáº¿n thá»©c
má»›i, dáº«n Ä‘áº¿n nhá»¯ng cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ vá» hiá»‡u suáº¥t
trÃªn nhiá»‡m vá»¥ â†âˆ’
N2D mÃ  khÃ´ng cÃ³ báº¥t ká»³ tÃ¡c Ä‘á»™ng
cÃ³ háº¡i nÃ o Ä‘áº¿n hiá»‡u suáº¥t cá»§a nhiá»‡m vá»¥ N2D. Äiá»ƒm
khá»›p chÃ­nh xÃ¡c Ä‘Æ°á»£c bÃ¡o cÃ¡o.

Giáº£i ToÃ¡n NgÆ°á»£c Äá»ƒ thá»ƒ hiá»‡n thÃªm hiá»‡u quáº£ cá»§a
BICO, chÃºng tÃ´i giáº£i quyáº¿t má»™t nhiá»‡m vá»¥ thá»±c táº¿
hÆ¡n: giáº£i toÃ¡n. Thiáº¿t láº­p thÃ­ nghiá»‡m cÆ¡ báº£n liÃªn
quan Ä‘áº¿n viá»‡c dáº¡y LLM cÃ¡c ká»¹ nÄƒng giáº£i toÃ¡n cÆ¡
báº£n vÃ  kiá»ƒm tra chÃºng vá»›i cÃ¡c cÃ¡ch tiáº¿p cáº­n "logic
Ä‘áº£o ngÆ°á»£c" Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c váº¥n Ä‘á» toÃ¡n há»c. Bá»™
dá»¯ liá»‡u (Yu vÃ  cá»™ng sá»±, 2023), Ä‘Æ°á»£c dáº«n xuáº¥t tá»«
GSM8k (Cobbe vÃ  cá»™ng sá»±, 2021), cÃ³ cÃ¡c cÃ¢u
há»i toÃ¡n Ä‘Æ°á»£c Ä‘áº£o ngÆ°á»£c so vá»›i nhá»¯ng cÃ¢u trong
bá»™ dá»¯ liá»‡u GSM8k gá»‘c. HÃ¬nh 4 minh há»a má»™t Ä‘iá»ƒm
dá»¯ liá»‡u tá»« GSM8k cÃ¹ng vá»›i Ä‘á»‘i tÃ¡c Ä‘áº£o ngÆ°á»£c cá»§a
nÃ³. ChÃºng tÃ´i sá»­ dá»¥ng NTP vÃ  BICO Ä‘á»ƒ tinh chá»‰nh
má»™t mÃ´ hÃ¬nh Llama-7B trÃªn bá»™ dá»¯ liá»‡u GSM8k
gá»‘c, tÆ°Æ¡ng á»©ng. ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a
cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘iá»u chá»‰nh trÃªn cáº£ bá»™ kiá»ƒm tra
gá»‘c vÃ  Ä‘áº£o ngÆ°á»£c. Táº¥t cáº£ cÃ¡c siÃªu tham sá»‘ huáº¥n
luyá»‡n vÃ  cáº¥u hÃ¬nh tuÃ¢n theo Yu vÃ  cá»™ng sá»± (2023).
Káº¿t quáº£ Ä‘Æ°á»£c thá»ƒ hiá»‡n trong Báº£ng 3.

Kiá»ƒm tra GSM
"prompt": "James mua 5 gÃ³i thá»‹t bÃ² má»—i gÃ³i 4 pounds. GiÃ¡ thá»‹t bÃ² lÃ  $5.50 má»—i pound. Anh áº¥y Ä‘Ã£ tráº£ bao nhiÃªu?"
"completion": "Anh áº¥y mua 5*4=20 pounds thá»‹t bÃ². Anh áº¥y tráº£ 20*5.5=$110. CÃ¢u tráº£ lá»i lÃ : 110"

Kiá»ƒm tra â†âˆ’
GSM
"prompt": "James mua x gÃ³i thá»‹t bÃ² má»—i gÃ³i 4 pounds. GiÃ¡ thá»‹t bÃ² lÃ  $5.50 má»—i pound. Anh áº¥y Ä‘Ã£ tráº£ bao nhiÃªu? Náº¿u chÃºng ta biáº¿t cÃ¢u tráº£ lá»i cho cÃ¢u há»i trÃªn lÃ  110, giÃ¡ trá»‹ cá»§a biáº¿n khÃ´ng xÃ¡c Ä‘á»‹nh x lÃ  gÃ¬?"
"completion": "Tá»•ng trá»ng lÆ°á»£ng thá»‹t bÃ² lÃ  4*x. Bá»Ÿi vÃ¬ 4x * 5.5 = 110. x lÃ  5."

HÃ¬nh 4: Má»™t máº«u kiá»ƒm tra tá»« bá»™ dá»¯ liá»‡u GSM8k gá»‘c
(Cobbe vÃ  cá»™ng sá»±, 2021), cÃ¹ng vá»›i Ä‘á»‘i tÃ¡c "Ä‘áº£o ngÆ°á»£c"
cá»§a nÃ³ Ä‘Æ°á»£c táº¡o ra bá»Ÿi Yu vÃ  cá»™ng sá»± (2023). CÃ¢u há»i
Ä‘áº£o ngÆ°á»£c Ä‘Ã²i há»i cÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n chá»‰
trÃªn bá»™ huáº¥n luyá»‡n GSM8k gá»‘c thá»ƒ hiá»‡n kháº£ nÄƒng suy
luáº­n ngÆ°á»£c Ä‘á»ƒ giáº£i quyáº¿t.

Má»¥c tiÃªu | GSM | â†âˆ’
GSM
NTP | 38.21 | 5.33
BICO | 38.28 | 6.53

Báº£ng 3: ChÃºng tÃ´i tinh chá»‰nh má»™t mÃ´ hÃ¬nh Llama-7B
báº±ng bá»™ dá»¯ liá»‡u GSM8k (Cobbe vÃ  cá»™ng sá»±, 2021)
vá»›i NTP vÃ  BICO, tÆ°Æ¡ng á»©ng. Äá»™ chÃ­nh xÃ¡c cÃ¢u tráº£
lá»i trung bÃ¬nh Ä‘Æ°á»£c bÃ¡o cÃ¡o. CÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘iá»u
chá»‰nh Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ trÃªn cÃ¡c cÃ¢u há»i kiá»ƒm tra gá»‘c
(Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  GSM) vÃ  cÃ¡c cÃ¢u há»i Ä‘áº£o ngÆ°á»£c
Ä‘Æ°á»£c xÃ¢y dá»±ng bá»Ÿi Yu vÃ  cá»™ng sá»± (2023) (Ä‘Æ°á»£c kÃ½
hiá»‡u lÃ  â†âˆ’
GSM).

ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng BICO duy trÃ¬ hiá»‡u
suáº¥t cá»§a nÃ³ trÃªn bá»™ kiá»ƒm tra gá»‘c trong khi Ä‘áº¡t Ä‘Æ°á»£c
sá»± gia tÄƒng hÆ¡n 1 Ä‘iá»ƒm trong viá»‡c giáº£i quyáº¿t cÃ¡c
váº¥n Ä‘á» toÃ¡n Ä‘áº£o ngÆ°á»£c, Ä‘Ã¢y lÃ  má»™t cáº£i thiá»‡n Ä‘Ã¡ng
ká»ƒ trong nhiá»‡m vá»¥ giáº£i toÃ¡n vÃ  vÆ°á»£t qua kiá»ƒm Ä‘á»‹nh
t-test vá»›i p-value < 0.01. Cho ráº±ng cÃ¡c mÃ´ hÃ¬nh
chÆ°a tháº¥y báº¥t ká»³ chuá»—i suy luáº­n ngÆ°á»£c nÃ o Ä‘á»ƒ
giáº£i quyáº¿t nhá»¯ng loáº¡i cÃ¢u há»i toÃ¡n nÃ y trong quÃ¡
trÃ¬nh tinh chá»‰nh, sá»± cáº£i thiá»‡n cÃ³ thá»ƒ Ä‘Æ°á»£c quy cho
BICO, thá»ƒ hiá»‡n kháº£ nÄƒng cá»§a nÃ³ trong viá»‡c tÄƒng
cÆ°á»ng cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ vá»›i kháº£
nÄƒng suy luáº­n linh hoáº¡t hÆ¡n.

Dá»‹ch thuáº­t Báº£n cháº¥t kÃ©p cá»§a dá»¯ liá»‡u dá»‹ch thuáº­t
Ä‘áº·c biá»‡t phÃ¹ há»£p Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ lá»i nguyá»n Ä‘áº£o ngÆ°á»£c.
ChÃºng tÃ´i giáº£ Ä‘á»‹nh ráº±ng cho dá»¯ liá»‡u huáº¥n luyá»‡n
theo thá»© tá»± "ngÃ´n ngá»¯ X-ngÃ´n ngá»¯ Y", mÃ´ hÃ¬nh
cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng kÃ©m trong dá»‹ch thuáº­t "ngÃ´n ngá»¯
Y-sang-ngÃ´n ngá»¯ X" do lá»i nguyá»n Ä‘áº£o ngÆ°á»£c.
Äá»ƒ chá»©ng minh Ä‘iá»u nÃ y, chÃºng tÃ´i Ä‘Ã£ thá»±c hiá»‡n
má»™t nhiá»‡m vá»¥ dá»‹ch mÃ¡y Ä‘Æ¡n giáº£n tá»« tiáº¿ng Trung
sang tiáº¿ng Anh. ÄÃ¢y lÃ  cÃ¡c chi tiáº¿t thÃ­ nghiá»‡m:

ChÃºng tÃ´i phÃ¡t triá»ƒn má»™t bá»™ vÃ­ dá»¥ dá»‹ch Trung-Anh
Ä‘Æ°á»£c cáº¥u trÃºc nhÆ° sau: "Khi dá»‹ch thuáº­t ngá»¯ tiáº¿ng
Trung 'å¦å¤–ä¸€ä¸ª' sang tiáº¿ng Anh, biá»ƒu thá»©c tÆ°Æ¡ng
Ä‘Æ°Æ¡ng lÃ  'Another one'." Äá»ƒ kiá»ƒm tra, chÃºng tÃ´i
Ä‘áº£o ngÆ°á»£c dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c
nhiá»‡m vá»¥ dá»‹ch Anh-Trung, nhÆ°: "Khi dá»‹ch cá»¥m
tá»« tiáº¿ng Anh 'another one' sang tiáº¿ng Trung, biá»ƒu
thá»©c tiáº¿ng Trung tÆ°Æ¡ng á»©ng lÃ ," vá»›i pháº£n há»“i chÃ­nh
xÃ¡c lÃ  'å¦å¤–ä¸€ä¸ª.' ChÃºng tÃ´i kiá»ƒm tra nhiá»‡m vá»¥
nÃ y trÃªn mÃ´ hÃ¬nh Llama-7b, cÃ³ kháº£ nÄƒng ngÃ´n
ngá»¯ tiáº¿ng Trung háº¡n cháº¿. Cáº£ bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n
vÃ  kiá»ƒm tra Ä‘á»u bao gá»“m 100 vÃ­ dá»¥ má»—i bá»™. ChÃºng
tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t dá»‹ch thuáº­t báº±ng thÆ°á»›c Ä‘o
Khá»›p chÃ­nh xÃ¡c. Káº¿t quáº£ thÃ­ nghiá»‡m Ä‘Æ°á»£c liá»‡t kÃª
trong Báº£ng 4. LÆ°u Ã½ ráº±ng Ä‘á»™ chÃ­nh xÃ¡c 0-shot cho
Llama lÃ  50%, pháº£n Ã¡nh kháº£ nÄƒng song ngá»¯ gá»‘c
cá»§a nÃ³. BICO vÆ°á»£t trá»™i hÆ¡n NTP 6%, lÃ m ná»•i báº­t
hiá»‡u quáº£ tiá»m nÄƒng cá»§a nÃ³ trong cÃ¡c nhiá»‡m vá»¥ tháº¿
giá»›i thá»±c nhÆ° dá»‹ch mÃ¡y.

0-shot | NTP | BICO
EM (%) | 51 | 63 | 69

Báº£ng 4: BICO tÄƒng cÆ°á»ng tiá»‡n Ã­ch cá»§a dá»¯ liá»‡u huáº¥n
luyá»‡n cho nhiá»‡m vá»¥ dá»‹ch-ngÆ°á»£c, do Ä‘Ã³ cáº£i thiá»‡n Ä‘á»™
chÃ­nh xÃ¡c cá»§a dá»‹ch ngÆ°á»£c. LÆ°u Ã½ ráº±ng mÃ´ hÃ¬nh Llama
cÃ³ kháº£ nÄƒng Ä‘a ngÃ´n ngá»¯ vá»‘n cÃ³, Ä‘Æ°á»£c thá»ƒ hiá»‡n trong
Ä‘iá»ƒm 0-shot.

6 Tháº£o luáº­n
Pháº§n nÃ y bao gá»“m má»™t sá»‘ phÃ¢n tÃ­ch cáº§n thiáº¿t vá»
phÆ°Æ¡ng phÃ¡p BICO Ä‘Æ°á»£c Ä‘á» xuáº¥t cá»§a chÃºng tÃ´i,
cÅ©ng nhÆ° nghiÃªn cá»©u Ä‘Æ°Æ¡ng Ä‘áº¡i vá» lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c.

6.1 PhÃ¢n tÃ­ch PhÆ°Æ¡ng phÃ¡p
Viá»‡c cáº¥u hÃ¬nh cÃ¡c siÃªu tham sá»‘ trong BICO, bao
gá»“m pM vÃ  pO, tuÃ¢n thá»§ cÃ¡c thá»±c hÃ nh thÃ´ng thÆ°á»ng
tÆ°Æ¡ng tá»± nhÆ° BERT (Devlin vÃ  cá»™ng sá»±, 2019).
Tuy nhiÃªn, trong BERT, tá»· lá»‡ token máº·t náº¡ pM vÃ 
sá»± cÃ¢n báº±ng giá»¯a hai nhiá»‡m vá»¥ tiá»n huáº¥n luyá»‡n pO
thiáº¿u tháº£o luáº­n vÃ  chÃ­nh thá»©c hÃ³a rÃµ rÃ ng. ChÃºng
tÃ´i Ä‘Ã£ nghiÃªn cá»©u tÃ¡c Ä‘á»™ng cá»§a cÃ¡c siÃªu tham sá»‘
cá»§a chÃºng tÃ´i vÃ  chi tiáº¿t cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¬m tháº¥y trong
phá»¥ lá»¥c A.

6.2 Giáº£m thiá»ƒu Lá»i Nguyá»n Äáº£o NgÆ°á»£c
Má»™t sá»‘ cÃ´ng trÃ¬nh Ä‘Æ°Æ¡ng Ä‘áº¡i nháº±m giáº£i quyáº¿t lá»i
nguyá»n Ä‘áº£o ngÆ°á»£c thÃ´ng qua chá»‰nh sá»­a kiáº¿n thá»©c
hoáº·c tÄƒng cÆ°á»ng dá»¯ liá»‡u.

Chá»‰nh sá»­a kiáº¿n thá»©c (Ma vÃ  cá»™ng sá»±, 2023b) tÃ­ch
há»£p kiáº¿n thá»©c ngÆ°á»£c trá»±c tiáº¿p vÃ o cÃ¡c tham sá»‘
mÃ´ hÃ¬nh, Ä‘áº£m báº£o hiá»‡u suáº¥t. Tuy nhiÃªn, phÆ°Æ¡ng
phÃ¡p nÃ y tá»‘n nhiá»u cÃ´ng sá»©c, Ä‘Ã²i há»i chÃº thÃ­ch
tá»‰ má»‰ vÃ  thá»±c hiá»‡n phá»©c táº¡p. NÃ³ Ä‘Ã²i há»i cÃ¡c cÃ¢u
pháº£i tuÃ¢n thá»§ má»™t cáº¥u trÃºc cá»¥ thá»ƒ cá»§a má»™t chá»§ thá»ƒ,
theo sau lÃ  má»™t quan há»‡, vÃ  sau Ä‘Ã³ má»™t Ä‘á»‘i tÆ°á»£ng.
NgÆ°á»£c láº¡i, BICO khÃ´ng phá»¥ thuá»™c vÃ o cáº¥u trÃºc
cÃ¢u vÃ  dá»… thá»±c hiá»‡n hÆ¡n.

Theo chÃºng tÃ´i, Guo vÃ  cá»™ng sá»± (2024) Ä‘á» xuáº¥t
giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o ngÆ°á»£c thÃ´ng qua tÄƒng
cÆ°á»ng dá»¯ liá»‡u. NÃ³ cÃ³ thá»ƒ táº¡o ra dá»¯ liá»‡u Ä‘áº£o ngÆ°á»£c
rÃµ rÃ ng Ä‘á»ƒ huáº¥n luyá»‡n, cÃ³ kháº£ nÄƒng tÄƒng cÆ°á»ng
hiá»‡u suáº¥t trong cÃ¡c tÃ¬nh huá»‘ng phá»©c táº¡p. Tuy nhiÃªn,
phÆ°Æ¡ng phÃ¡p nÃ y cÃ³ thá»ƒ gáº·p pháº£i cÃ¡c váº¥n Ä‘á» rÃ²
rá»‰ nhÃ£n trong cÃ¡c thÃ­ nghiá»‡m nghiÃªn cá»©u, vÃ  do
Ä‘Ã³ chÃºng tÃ´i khÃ´ng so sÃ¡nh BICO vá»›i nÃ³.

ÄÃ¢y lÃ  má»™t tÃ¬nh huá»‘ng mÃ  cáº£ BICO vÃ  ABI Ä‘á»u
khÃ´ng thá»ƒ giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o ngÆ°á»£c nhÆ°ng
tÄƒng cÆ°á»ng dá»¯ liá»‡u cÃ³ thá»ƒ giáº£i quyáº¿t theo (Guo
vÃ  cá»™ng sá»±, 2024). Xem xÃ©t quan há»‡ nghá»‹ch Ä‘áº£o
cá»§a RN2D Ä‘Ã£ nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y, Ä‘Æ°á»£c kÃ½ hiá»‡u
lÃ  RD2N. Ãnh xáº¡ tá»« D Ä‘áº¿n N cÅ©ng táº¡o thÃ nh má»™t
song Ã¡nh: RD2N = {< d, n > |d mÃ´ táº£ n, (n âˆˆ N) âˆ§
(d âˆˆ D)}.

Táº¥t cáº£ cÃ¡c thiáº¿t láº­p thÃ­ nghiá»‡m vÃ  chi tiáº¿t huáº¥n
luyá»‡n váº«n giá»‘ng há»‡t nhÆ° nhá»¯ng gÃ¬ Ä‘Ã£ Ä‘Æ°á»£c giá»›i
thiá»‡u trÆ°á»›c Ä‘Ã¢y. HÃ¬nh 8 trong phá»¥ lá»¥c minh há»a
viá»‡c xÃ¢y dá»±ng dá»¯ liá»‡u liÃªn quan Ä‘áº¿n má»‘i quan há»‡
nÃ y. Sau khi Ä‘iá»u chá»‰nh, chÃºng tÃ´i gáº·p pháº£i má»™t
hiá»‡n tÆ°á»£ng khÃ³ hiá»ƒu: NhÆ° Ä‘Æ°á»£c thá»ƒ hiá»‡n trong
HÃ¬nh 5, sau khi Ä‘iá»u chá»‰nh, chÃºng tÃ´i quan sÃ¡t
má»™t hiá»‡n tÆ°á»£ng khÃ³ hiá»ƒu: trong khi BICO cáº£i thiá»‡n
kháº£ nÄƒng cá»§a sá»± tháº­t cÆ¡ báº£n so vá»›i cÃ¡c mÃ´ hÃ¬nh
Ä‘Æ°á»£c Ä‘iá»u chá»‰nh NTP, tÃ¡c Ä‘á»™ng cá»§a nÃ³ Ä‘áº¿n Ä‘iá»ƒm
khá»›p chÃ­nh xÃ¡c hoáº·c Ä‘iá»ƒm BLEU (Papineni vÃ 
cá»™ng sá»±, 2002) lÃ  khÃ´ng Ä‘Ã¡ng ká»ƒ (tham kháº£o phá»¥
lá»¥c A Ä‘á»ƒ tÃ­nh toÃ¡n kháº£ nÄƒng vÃ  káº¿t quáº£ chi tiáº¿t).
ChÃºng tÃ´i Ä‘Ã£ xem xÃ©t ká»¹ cÃ¡c chiáº¿n lÆ°á»£c giáº£i mÃ£,
bao gá»“m tÃ¬m kiáº¿m chÃ¹m, láº¥y máº«u top-k vÃ  top-p,
nhÆ°ng chÃºng khÃ´ng thá»ƒ hiá»‡n nhiá»u khÃ¡c biá»‡t.

Má»™t giáº£ thuyáº¿t cÃ³ thá»ƒ lÃ  LLM Ä‘Ã£ Ä‘Æ°á»£c tiá»n huáº¥n
luyá»‡n cÃ³ thá»ƒ Ä‘Ã£ phÃ¡t triá»ƒn má»™t "nháº­n thá»©c thÃ´ng
thÆ°á»ng" trong quÃ¡ trÃ¬nh tiá»n huáº¥n luyá»‡n. "Nháº­n
thá»©c thÃ´ng thÆ°á»ng" nÃ y gá»£i Ã½ ráº±ng, so vá»›i mÃ´
táº£-thÃ nh-tÃªn, má»™t má»‘i quan há»‡ tÃªn-thÃ nh-mÃ´ táº£
cÃ³ xu hÆ°á»›ng lÃ  má»™t Ã¡nh xáº¡ má»™t-vá»›i-nhiá»u, dáº«n Ä‘áº¿n
sá»± nháº§m láº«n trong nhiá»‡m vá»¥ â†âˆ’
D2N. VÃ­ dá»¥, khi
Ä‘Æ°á»£c Ä‘áº·t cÃ¢u há»i, "Joe Biden lÃ  ai?", mÃ´ hÃ¬nh cÃ³
thá»ƒ pháº£n há»“i vá»›i nhiá»u mÃ´ táº£ chÃ­nh xÃ¡c nhÆ° "má»™t
ngÆ°á»i Ä‘am mÃª xe hÆ¡i," hoáº·c "má»™t ngÆ°á»i Ä‘Ã n Ã´ng
lá»›n tuá»•i," thay vÃ¬ "tá»•ng thá»‘ng Má»¹." Trong khi viá»‡c
tÄƒng cÆ°á»ng dá»¯ liá»‡u rÃµ rÃ ng cÃ³ thá»ƒ cung cáº¥p má»™t
giáº£i phÃ¡p cho váº¥n Ä‘á» nÃ y, Ä‘Æ°á»£c há»— trá»£ bá»Ÿi cÃ¡c
phÃ¡t hiá»‡n trong nghiÃªn cá»©u kháº£ nÄƒng diá»…n giáº£i
gáº§n Ä‘Ã¢y (Wang vÃ  cá»™ng sá»±, 2024), phÆ°Æ¡ng phÃ¡p
nÃ y chá»‰ khuyáº¿n khÃ­ch mÃ´ hÃ¬nh ghi nhá»› dá»¯ liá»‡u
Ä‘áº£o ngÆ°á»£c thay vÃ¬ tÄƒng cÆ°á»ng kháº£ nÄƒng suy luáº­n
cá»§a nÃ³.

XÃ¡c suáº¥t Trung bÃ¬nh
BICO | NTP
0.08 | 0.16 | 0.24 | 0.32 | 0.40
32.3% | 38.7% | 27.5% | 30.1%
Llama-7b | Llama-13b

HÃ¬nh 5: XÃ¡c suáº¥t cá»§a viá»‡c hoÃ n thÃ nh mong muá»‘n
cho cÃ¡c lá»i nháº¯c Ä‘Æ°á»£c cung cáº¥p bá»Ÿi cÃ¡c mÃ´ hÃ¬nh khÃ¡c
nhau trong nhiá»‡m vá»¥ â†âˆ’
D2N. XÃ¡c suáº¥t nÃ y Ä‘Æ°á»£c Ä‘Ã¡nh
giÃ¡ trÃªn toÃ n bá»™ bá»™ kiá»ƒm tra vÃ  Ä‘Æ°á»£c trÃ¬nh bÃ y nhÆ°
má»™t trung bÃ¬nh. RÃµ rÃ ng lÃ  BICO tÄƒng cÆ°á»ng kháº£
nÄƒng Ä‘áº¡t Ä‘Æ°á»£c dá»± Ä‘oÃ¡n sá»± tháº­t cÆ¡ báº£n.

7 Káº¿t luáº­n
ChÃºng tÃ´i lÃ  nhá»¯ng ngÆ°á»i Ä‘áº§u tiÃªn nghiÃªn cá»©u cÃ¡c
nguyÃªn nhÃ¢n cÆ¡ báº£n cá»§a lá»i nguyá»n Ä‘áº£o ngÆ°á»£c vÃ 
quy nÃ³ cho sá»± káº¿t há»£p cá»§a cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n
vÃ  má»™t sá»‘ cÆ¡ cháº¿ suy luáº­n. Khi xem xÃ©t tÃ¡c Ä‘á»™ng
cá»§a cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n, chÃºng tÃ´i giá»›i thiá»‡u
má»™t cÃ¡ch tiáº¿p cáº­n tinh chá»‰nh sÃ¡ng táº¡o cho cÃ¡c mÃ´
hÃ¬nh ngÃ´n ngá»¯ nhÃ¢n quáº£ cÃ³ tÃªn BICO. PhÆ°Æ¡ng
phÃ¡p nÃ y tÃ¹y chá»‰nh cÃ¡c mÃ´ hÃ¬nh Llama cho cÃ¡c
má»¥c tiÃªu giá»‘ng ABI, do Ä‘Ã³ giáº£m thiá»ƒu lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c xuáº¥t hiá»‡n trong giai Ä‘oáº¡n huáº¥n luyá»‡n.
ChÃºng tÃ´i hy vá»ng thu hÃºt sá»± chÃº Ã½ cá»§a cá»™ng Ä‘á»“ng
Ä‘áº¿n cáº¥u hÃ¬nh phá»• biáº¿n cá»§a cÃ¡c mÃ´ hÃ¬nh ngÃ´n ngá»¯
lá»›n, Ä‘áº·c biá»‡t lÃ m ná»•i báº­t cÃ¡c háº¡n cháº¿ vá»‘n cÃ³ trong
mÃ´ hÃ¬nh huáº¥n luyá»‡n hiá»‡n táº¡i.

Háº¡n cháº¿
NhÆ° cÃ¡c háº¡n cháº¿, váº«n cÃ²n má»™t sá»‘ cÃ¢u há»i nghiÃªn
cá»©u má»Ÿ Ä‘Ã¡ng Ä‘Æ°á»£c Ä‘iá»u tra thÃªm: Thá»© nháº¥t, viá»‡c
Ä‘á»‹nh lÆ°á»£ng áº£nh hÆ°á»Ÿng cá»§a cÃ¡c quÃ¡ trÃ¬nh khÃ¡c trÃªn
cÃ¡c mÃ´ hÃ¬nh tiÃªn tiáº¿n, nhÆ° RLHF, Ä‘áº¿n lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c Ä‘áº·t ra má»™t thÃ¡ch thá»©c phá»©c táº¡p hÆ¡n vÃ 
cáº§n nhiá»u nghiÃªn cá»©u hÆ¡n. Thá»© hai, viá»‡c hiá»ƒu cÃ¡c
cÆ¡ cháº¿ khÃ¡c nhau ngoÃ i má»¥c tiÃªu huáº¥n luyá»‡n gÃ³p
pháº§n lÃ m tráº§m trá»ng thÃªm lá»i nguyá»n Ä‘áº£o ngÆ°á»£c
lÃ  quan trá»ng, vÃ  chÃºng tÃ´i hoÃ£n nhiá»‡m vá»¥ nÃ y
cho cÃ¡c ná»— lá»±c nghiÃªn cá»©u tÆ°Æ¡ng lai.

Lá»i cáº£m Æ¡n
CÃ´ng trÃ¬nh nÃ y Ä‘Æ°á»£c há»— trá»£ bá»Ÿi Quá»¹ Khoa há»c Tá»±
nhiÃªn Quá»‘c gia Trung Quá»‘c (NSFC Grant No.
62122089), ChÆ°Æ¡ng trÃ¬nh NhÃ  khoa há»c Tráº» Xuáº¥t
sáº¯c Báº¯c Kinh NO. BJJWZYJH012019100020098,
vÃ  Ná»n táº£ng Quáº£n trá»‹ XÃ£ há»™i ThÃ´ng minh, Ná»n
táº£ng LiÃªn ngÃ nh Äá»•i má»›i vÃ  Quy hoáº¡ch ChÃ­nh cho
SÃ¡ng kiáº¿n "Double-First Class", Äáº¡i há»c NhÃ¢n dÃ¢n
Trung Quá»‘c, Quá»¹ NghiÃªn cá»©u CÆ¡ báº£n cho cÃ¡c
Äáº¡i há»c Trung Æ°Æ¡ng, vÃ  Quá»¹ NghiÃªn cá»©u cá»§a Äáº¡i
há»c NhÃ¢n dÃ¢n Trung Quá»‘c. Ang Lv Ä‘Æ°á»£c há»— trá»£
bá»Ÿi ChÆ°Æ¡ng trÃ¬nh TÃ i trá»£ ÄÃ o táº¡o NhÃ¢n tÃ i SÃ¡ng
táº¡o Xuáº¥t sáº¯c 2024 cá»§a Äáº¡i há»c NhÃ¢n dÃ¢n Trung Quá»‘c.

TÃ i liá»‡u tham kháº£o
Hangbo Bao, Li Dong, Furu Wei, Wenhui Wang, Nan
Yang, Xiaodong Liu, Yu Wang, Songhao Piao, Jian-
feng Gao, Ming Zhou, vÃ  Hsiao-Wuen Hon. 2020.
Unilmv2: Pseudo-masked language models for uni-
fied language model pre-training.

Yoshua Bengio, RÃ©jean Ducharme, Pascal Vincent,
vÃ  Christian Janvin. 2003. A neural proba-
bilistic language model. J. Mach. Learn. Res.,
3(null):1137â€“1155.

Lukas Berglund, Meg Tong, Max Kaufmann, Mikita
Balesni, Asa Cooper Stickland, Tomasz Korbak, vÃ 
Owain Evans. 2023. The reversal curse: Llms trained
on "a is b" fail to learn "b is a".

Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie
Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind
Neelakantan, Pranav Shyam, Girish Sastry, Amanda
Askell, Sandhini Agarwal, Ariel Herbert-Voss,
Gretchen Krueger, Tom Henighan, Rewon Child,
Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu,
Clemens Winter, Christopher Hesse, Mark Chen, Eric
Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess,
Jack Clark, Christopher Berner, Sam McCandlish,
Alec Radford, Ilya Sutskever, vÃ  Dario Amodei.
2020. Language models are few-shot learners.

Shouyuan Chen, Sherman Wong, Liangjian Chen, vÃ 
Yuandong Tian. 2023. Extending context window of
large language models via positional interpolation.

Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian,
Mark Chen, Heewoo Jun, Lukasz Kaiser, Matthias
Plappert, Jerry Tworek, Jacob Hilton, Reiichiro
Nakano, Christopher Hesse, vÃ  John Schulman.
2021. Training verifiers to solve math word prob-
lems. arXiv preprint arXiv:2110.14168.

Jacob Devlin, Ming-Wei Chang, Kenton Lee, vÃ 
Kristina Toutanova. 2019. BERT: Pre-training of
deep bidirectional transformers for language under-
standing. In Proceedings of the 2019 Conference of
the North American Chapter of the Association for
Computational Linguistics: Human Language Tech-
nologies, Volume 1 (Long and Short Papers), pages
4171â€“4186, Minneapolis, Minnesota. Association for
Computational Linguistics.

Li Dong, Nan Yang, Wenhui Wang, Furu Wei, Xi-
aodong Liu, Yu Wang, Jianfeng Gao, Ming Zhou,
vÃ  Hsiao-Wuen Hon. 2019. Unified language model
pre-training for natural language understanding and
generation.

Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding,
Jiezhong Qiu, Zhilin Yang, vÃ  Jie Tang. 2022. GLM:
general language model pretraining with autoregres-
sive blank infilling. pages 320â€“335.

Nelson Elhage, Neel Nanda, Catherine Olsson, Tom
Henighan, Nicholas Joseph, Ben Mann, Amanda
Askell, Yuntao Bai, Anna Chen, Tom Conerly,
Nova DasSarma, Dawn Drain, Deep Ganguli, Zac
Hatfield-Dodds, Danny Hernandez, Andy Jones,
Jackson Kernion, Liane Lovitt, Kamal Ndousse,
Dario Amodei, Tom Brown, Jack Clark, Jared Ka-
plan, Sam McCandlish, vÃ  Chris Olah. 2021. A
mathematical framework for transformer circuits.
Transformer Circuits Thread. Https://transformer-
circuits.pub/2021/framework/index.html.

Qingyan Guo, Rui Wang, Junliang Guo, Xu Tan, Jiang
Bian, vÃ  Yujiu Yang. 2024. Mitigating reversal
curse in large language models via semantic-aware
permutation training.

Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan
Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, vÃ 
Weizhu Chen. 2022. Lora: Low-rank adaptation of
large language models. In ICLR 2022.

Mandar Joshi, Danqi Chen, Yinhan Liu, Daniel S. Weld,
Luke Zettlemoyer, vÃ  Omer Levy. 2020. Span-
BERT: Improving pre-training by representing and
predicting spans. Transactions of the Association for
Computational Linguistics, 8:64â€“77.

Jun Ma, Jia-Chen Gu, Zhen-Hua Ling, Quan Liu,
vÃ  Cong Liu. 2023a. Untying the reversal curse
via bidirectional language model editing. ArXiv,
abs/2310.10322.

Jun-Yu Ma, Jia-Chen Gu, Zhen-Hua Ling, Quan Liu,
vÃ  Cong Liu. 2023b. Untying the reversal curse via
bidirectional language model editing.

Kevin Meng, David Bau, Alex J Andonian, vÃ  Yonatan
Belinkov. 2022. Locating and editing factual associ-
ations in GPT. In Advances in Neural Information
Processing Systems.

Jack Merullo, Carsten Eickhoff, vÃ  Ellie Pavlick. 2024.
Circuit component reuse across tasks in transformer
language models.

OpenAI. 2023. Gpt-4 technical report.

Kishore Papineni, Salim Roukos, Todd Ward, vÃ  Wei-
Jing Zhu. 2002. Bleu: a method for automatic evalu-
ation of machine translation. In Proceedings of the
40th Annual Meeting of the Association for Compu-
tational Linguistics, pages 311â€“318, Philadelphia,
Pennsylvania, USA. Association for Computational
Linguistics.

Alec Radford vÃ  Karthik Narasimhan. 2018. Im-
proving language understanding by generative pre-
training.

Alec Radford, Jeff Wu, Rewon Child, David Luan,
Dario Amodei, vÃ  Ilya Sutskever. 2019. Language
models are unsupervised multitask learners.

Colin Raffel, Noam Shazeer, Adam Roberts, Kather-
ine Lee, Sharan Narang, Michael Matena, Yanqi
Zhou, Wei Li, vÃ  Peter J. Liu. 2020. Exploring the
limits of transfer learning with a unified text-to-text
transformer. Journal of Machine Learning Research,
21(140):1â€“67.

Jianlin Su, Yu Lu, Shengfeng Pan, Ahmed Murtadha,
Bo Wen, vÃ  Yunfeng Liu. 2022. Roformer: En-
hanced transformer with rotary position embedding.

Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier
Martinet, Marie-Anne Lachaux, TimothÃ©e Lacroix,
Baptiste RoziÃ¨re, Naman Goyal, Eric Hambro, Faisal
Azhar, Aurelien Rodriguez, Armand Joulin, Edouard
Grave, vÃ  Guillaume Lample. 2023a. Llama: Open
and efficient foundation language models.

Hugo Touvron, Louis Martin, Kevin Stone, Peter Al-
bert, Amjad Almahairi, Yasmine Babaei, Nikolay
Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti
Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton
Ferrer, Moya Chen, Guillem Cucurull, David Esiobu,
Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller,
Cynthia Gao, Vedanuj Goswami, Naman Goyal, An-
thony Hartshorn, Saghar Hosseini, Rui Hou, Hakan
Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa,
Isabel Kloumann, Artem Korenev, Punit Singh Koura,
Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Di-
ana Liskovich, Yinghai Lu, Yuning Mao, Xavier Mar-
tinet, Todor Mihaylov, Pushkar Mishra, Igor Moly-
bog, Yixin Nie, Andrew Poulton, Jeremy Reizen-
stein, Rashi Rungta, Kalyan Saladi, Alan Schelten,
Ruan Silva, Eric Michael Smith, Ranjan Subrama-
nian, Xiaoqing Ellen Tan, Binh Tang, Ross Tay-
lor, Adina Williams, Jian Xiang Kuan, Puxin Xu,
Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan,
Melanie Kambadur, Sharan Narang, Aurelien Ro-
driguez, Robert Stojnic, Sergey Edunov, vÃ  Thomas
Scialom. 2023b. Llama 2: Open foundation and
fine-tuned chat models.

Boshi Wang, Xiang Yue, Yu Su, vÃ  Huan Sun. 2024.
Grokked transformers are implicit reasoners: A mech-
anistic journey to the edge of generalization.

Kevin Ro Wang, Alexandre Variengien, Arthur Conmy,
Buck Shlegeris, vÃ  Jacob Steinhardt. 2023. Inter-
pretability in the wild: a circuit for indirect object
identification in GPT-2 small. In The Eleventh Inter-
national Conference on Learning Representations.

Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Car-
bonell, Ruslan Salakhutdinov, vÃ  Quoc V. Le. 2020.
Xlnet: Generalized autoregressive pretraining for lan-
guage understanding.

Longhui Yu, Weisen Jiang, Han Shi, Jincheng Yu,
Zhengying Liu, Yu Zhang, James T. Kwok, Zhenguo
Li, Adrian Weller, vÃ  Weiyang Liu. 2023. Meta-
math: Bootstrap your own mathematical questions
for large language models.

Aohan Zeng, Xiao Liu, Zhengxiao Du, Zihan Wang,
Hanyu Lai, Ming Ding, Zhuoyi Yang, Yifan Xu,
Wendi Zheng, Xiao Xia, et al. 2022. Glm-130b:
An open bilingual pre-trained model. arXiv preprint
arXiv:2210.02414.

Liu Zhuang, Lin Wayne, Shi Ya, vÃ  Zhao Jun. 2021. A
robustly optimized BERT pre-training approach with
post-training. In Proceedings of the 20th Chinese
National Conference on Computational Linguistics,
pages 1218â€“1227, Huhhot, China. Chinese Informa-
tion Processing Society of China.

HÃ¬nh 6: pO cÃ¢n báº±ng kháº£ nÄƒng hiá»ƒu toÃ n diá»‡n dá»¯ liá»‡u
huáº¥n luyá»‡n vÃ  kháº£ nÄƒng sinh cá»§a mÃ´ hÃ¬nh. Khi giÃ¡ trá»‹
pO thÃ­ch há»£p Ä‘Æ°á»£c chá»n, BICO giáº£m thiá»ƒu lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c trong nhiá»‡m vá»¥ â†âˆ’
N2D. Sá»± váº¯ng máº·t cá»§a
cÃ¡c nhÃºng vá»‹ trÃ­ Ä‘Æ°á»£c sá»­a Ä‘á»•i (w/o M.P.) cáº£n trá»Ÿ quÃ¡
trÃ¬nh há»c táº­p vÃ  dáº«n Ä‘áº¿n káº¿t quáº£ kÃ©m hÆ¡n do váº¥n Ä‘á»
ngoÃ i phÃ¢n phá»‘i.

A PhÃ¢n tÃ­ch PhÆ°Æ¡ng phÃ¡p cá»§a BICO
ChÃºng tÃ´i Ä‘iá»u tra tÃ¡c Ä‘á»™ng cá»§a cÃ¡c siÃªu tham sá»‘
trong BICO Ä‘á»‘i vá»›i viá»‡c giáº£m thiá»ƒu lá»i nguyá»n Ä‘áº£o
ngÆ°á»£c do cÃ¡c má»¥c tiÃªu huáº¥n luyá»‡n gÃ¢y ra. Äiá»u
quan trá»ng cáº§n lÆ°u Ã½ lÃ  chÃºng tÃ´i khÃ´ng nháº±m má»¥c
Ä‘Ã­ch tÃ¬m kiáº¿m hiá»‡u suáº¥t tá»‘t nháº¥t cho má»™t nhiá»‡m vá»¥
cá»¥ thá»ƒ, mÃ  lÃ  nghiÃªn cá»©u cÃ¡c Ä‘áº·c tÃ­nh cá»§a BICO.
MÃ´ hÃ¬nh chÃºng tÃ´i sá»­ dá»¥ng trong pháº§n nÃ y lÃ 
Llama-7B.

Lá»±a chá»n pO ABI gá»‘c sá»­ dá»¥ng cÃ¡c token Ä‘áº·c
biá»‡t nhÆ° "<BOS>" vÃ  "<EOS>" Ä‘á»ƒ chá»‰ ra báº¯t Ä‘áº§u
vÃ  káº¿t thÃºc cá»§a chuá»—i Ä‘Æ°á»£c che. Tuy nhiÃªn, Ä‘Ã¡ng
chÃº Ã½ ráº±ng Ä‘iá»u nÃ y khÃ¡c vá»›i cÃ¡ch Llama sá»­ dá»¥ng
cÃ¡c token Ä‘áº·c biá»‡t nÃ y. Do Ä‘Ã³, chÃºng tÃ´i Ä‘Ã£ chá»n
khÃ´ng sá»­ dá»¥ng chÃºng nhÆ° cÃ¡c dáº¥u hiá»‡u cho viá»‡c
che trong BICO. Káº¿t quáº£ lÃ , chÃºng tÃ´i tháº¥y cÃ¡c
mÃ´ hÃ¬nh Llama Ä‘Æ°á»£c Ä‘iá»u chá»‰nh vá»›i BICO gáº·p
khÃ³ khÄƒn trong viá»‡c cháº¥m dá»©t sinh hiá»‡u quáº£. ChÃºng
tÃ´i quan sÃ¡t tháº¥y ráº±ng chÃºng cÃ³ xu hÆ°á»›ng táº¡o ra
cÃ¡c mÃ´ táº£ dÃ i, liÃªn quan Ä‘áº¿n chá»§ Ä‘á». Äá»ƒ giáº£i quyáº¿t
váº¥n Ä‘á» nÃ y, chÃºng tÃ´i giá»›i thiá»‡u giáº£i phÃ¡p: táº¡i má»—i
bÆ°á»›c huáº¥n luyá»‡n, mÃ´ hÃ¬nh Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a vá»›i má»¥c
tiÃªu NTP vá»›i xÃ¡c suáº¥t pO vÃ  Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a vá»›i
khá»­ nhiá»…u máº·t náº¡ tá»± há»“i quy vá»›i xÃ¡c suáº¥t 1âˆ’pO.

ChÃºng tÃ´i nghiÃªn cá»©u lá»±a chá»n pO, trong khi duy
trÃ¬ tá»· lá»‡ che khÃ´ng Ä‘á»•i pM = 0.15, má»™t giÃ¡ trá»‹ Ä‘Æ°á»£c
Ã¡p dá»¥ng rá»™ng rÃ£i trong cÃ¡c mÃ´ hÃ¬nh mÃ£ hÃ³a tá»± Ä‘á»™ng
(Devlin vÃ  cá»™ng sá»±, 2019; Raffel vÃ  cá»™ng sá»±, 2020).
Káº¿t quáº£ cá»§a chÃºng tÃ´i Ä‘Æ°á»£c minh há»a trong HÃ¬nh 6.
ChÃºng tÃ´i quan sÃ¡t tháº¥y ráº±ng do váº¥n Ä‘á» Ä‘Ã£ tháº£o
luáº­n trÆ°á»›c Ä‘Ã¢y, khi pO = 0, cÃ¡c mÃ´ hÃ¬nh khÃ´ng thá»ƒ
táº¡o ra mÃ´ táº£ chÃ­nh xÃ¡c trong nhiá»‡m vá»¥ N2D, vÃ 
hoáº¡t Ä‘á»™ng kÃ©m trong nhiá»‡m vá»¥ â†âˆ’
N2D. MÃ´ hÃ¬nh
Ä‘Æ°á»£c tinh chá»‰nh hoÃ n toÃ n vá»›i NTP (pO = 1) gáº·p
pháº£i lá»i nguyá»n Ä‘áº£o ngÆ°á»£c, Ä‘áº¡t tá»· lá»‡ chÃ­nh xÃ¡c 0%
trong nhiá»‡m vá»¥ â†âˆ’
N2D.

Má»™t káº¿t quáº£ cÃ¢n báº±ng Ä‘Æ°á»£c Ä‘áº¡t Ä‘Æ°á»£c vá»›i pO nhá»
khoáº£ng 1/4, cho phÃ©p mÃ´ hÃ¬nh báº£o tá»“n kháº£ nÄƒng
sinh cá»§a nÃ³ trong khi há»c ká»¹ lÆ°á»¡ng tá»« dá»¯ liá»‡u huáº¥n
luyá»‡n. Do Ä‘Ã³, cÃ³ má»™t cáº£i thiá»‡n Ä‘Ã¡ng ká»ƒ trong hiá»‡u
suáº¥t nhiá»‡m vá»¥ N2D-reverse, tÄƒng vá»t tá»« 0% lÃªn
khoáº£ng 80%, vá»›i kháº£ nÄƒng duy trÃ¬ trong nhiá»‡m vá»¥
N2D. ChÃºng tÃ´i cÅ©ng khÃ¡m phÃ¡ tÃ¡c Ä‘á»™ng cá»§a viá»‡c
tinh chá»‰nh mÃ´ hÃ¬nh mÃ  khÃ´ng sá»­a Ä‘á»•i tÃ­nh toÃ¡n
chÃº Ã½ cá»§a nÃ³ (pO = 0, w/o M.P.) Ä‘á»ƒ giáº£i quyáº¿t
cÃ¡c vá»‹ trÃ­ ngoÃ i phÃ¢n phá»‘i. Do nhu cáº§u cho má»™t
pháº§n cá»§a cÃ¡c cáº­p nháº­t tham sá»‘ Ä‘á»ƒ giáº£i quyáº¿t cÃ¡c
váº¥n Ä‘á» OOD trong nhÃºng vá»‹ trÃ­ (Chen vÃ  cá»™ng sá»±,
2023), quÃ¡ trÃ¬nh há»c táº­p bá»‹ cháº­m láº¡i.

Chiáº¿n lÆ°á»£c Máº·t náº¡ ChÃºng tÃ´i Ä‘iá»u tra chiáº¿n lÆ°á»£c
máº·t náº¡ trong BICO. ChÃºng tÃ´i Ä‘áº·t tham sá»‘ pO á»Ÿ
giÃ¡ trá»‹ khÃ´ng Ä‘á»•i 1/4 vÃ  thay Ä‘á»•i xÃ¡c suáº¥t máº·t náº¡
pM tá»« 0.05 Ä‘áº¿n 0.55, tÄƒng theo má»©c tÄƒng 0.1. Káº¿t
quáº£ Ä‘Æ°á»£c minh há»a trong pháº§n trÃªn cá»§a HÃ¬nh 7.
Quan sÃ¡t tháº¥y ráº±ng cÃ¡c giÃ¡ trá»‹ cá»±c cá»§a pM, nhÆ°
0.55 hoáº·c 0.05, cho káº¿t quáº£ dÆ°á»›i tá»‘i Æ°u, trong khi
cÃ¡c giÃ¡ trá»‹ trung gian khÃ´ng cho tháº¥y sá»± khÃ¡c biá»‡t
Ä‘Ã¡ng ká»ƒ.

NgoÃ i ra, chÃºng tÃ´i khÃ¡m phÃ¡ khoáº£ng máº·t náº¡.
CÃ¡c nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y (Raffel vÃ  cá»™ng sá»±, 2020;
Joshi vÃ  cá»™ng sá»±, 2020) gá»£i Ã½ ráº±ng viá»‡c che má»™t
khoáº£ng liÃªn tá»¥c cá»§a cÃ¡c token cÃ³ thá»ƒ hiá»‡u quáº£ hÆ¡n
so vá»›i viá»‡c sá»­ dá»¥ng cÃ¡c token máº·t náº¡ Ä‘á»™c láº­p vÃ 
phÃ¢n phá»‘i giá»‘ng há»‡t nhau (i.i.d.), tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i
khoáº£ng máº·t náº¡ cá»§a 1. Trong thÃ­ nghiá»‡m cá»§a chÃºng
tÃ´i, chÃºng tÃ´i khÃ¡m phÃ¡ Ä‘á»™ dÃ i khoáº£ng máº·t náº¡ S,
vÃ  káº¿t quáº£ náº±m á»Ÿ dÆ°á»›i cÃ¹ng cá»§a HÃ¬nh 7. ChÃºng
tÃ´i khÃ´ng quan sÃ¡t báº¥t ká»³ sá»± khÃ¡c biá»‡t hiá»‡u suáº¥t
rÃµ rÃ ng nÃ o giá»¯a cÃ¡c cÃ i Ä‘áº·t S khÃ¡c nhau.

HÃ¬nh 7: TÃ¡c Ä‘á»™ng cá»§a chiáº¿n lÆ°á»£c máº·t náº¡ Ä‘á»‘i vá»›i hiá»‡u
suáº¥t mÃ´ hÃ¬nh. Tá»« pháº§n trÃªn trong hÃ¬nh, hiá»‡u suáº¥t mÃ´
hÃ¬nh váº«n nháº¥t quÃ¡n trong má»™t pháº¡m vi rá»™ng cÃ¡c giÃ¡
trá»‹ pM (0.15 Ä‘áº¿n 0.45). ChÃºng tÃ´i cÅ©ng tháº¥y ráº±ng viá»‡c
che khoáº£ng vÃ  che i.i.d. khÃ´ng thá»ƒ hiá»‡n sá»± khÃ¡c biá»‡t
Ä‘Ã¡ng chÃº Ã½. Äá»ƒ dá»… so sÃ¡nh, chÃºng tÃ´i sá»­ dá»¥ng Ä‘Æ°á»ng
Ä‘á»©t nÃ©t mÃ u Ä‘á» Ä‘á»ƒ biá»ƒu thá»‹ káº¿t quáº£ tá»‘t nháº¥t Ä‘Æ°á»£c cung
cáº¥p bá»Ÿi Llama Ä‘Æ°á»£c Ä‘iá»u chá»‰nh hoÃ n toÃ n NTP.

CÃ¡c Nhiá»‡m vá»¥ D2N vÃ  â†âˆ’
D2N
HÃ¬nh 8 minh há»a má»™t Ä‘iá»ƒm dá»¯ liá»‡u trong cÃ¡c nhiá»‡m
vá»¥ D2N vÃ  â†âˆ’
D2N.

Äá»ƒ cá»¥ thá»ƒ vá» tÃ­nh toÃ¡n kháº£ nÄƒng trong HÃ¬nh 5:
ChÃºng tÃ´i tÃ­nh toÃ¡n kháº£ nÄƒng cá»§a sá»± tháº­t cÆ¡ báº£n
Ä‘Æ°á»£c gÃ¡n bá»Ÿi LLM sau tinh chá»‰nh nhÆ° sau:

p(completion|prompt) = e^(-LNLL),

trong Ä‘Ã³ LNLL = -Î£(i=k to l) log p(ti|t0:i-1). (8)

á» Ä‘Ã¢y, ti biá»ƒu thá»‹ token thá»© i trong chuá»—i, cÃ³ Ä‘á»™
dÃ i l. Quan trá»ng lÃ , chÃºng tÃ´i khÃ´ng tÃ­nh Ä‘áº¿n cÃ¡c
vá»‹ trÃ­ tÆ°Æ¡ng á»©ng vá»›i lá»i nháº¯c (k token Ä‘áº§u tiÃªn)
khi tÃ­nh toÃ¡n máº¥t mÃ¡t.

Äiá»ƒm Khá»›p ChÃ­nh xÃ¡c vÃ  Ä‘iá»ƒm BLEU (Papineni
vÃ  cá»™ng sá»±, 2002) (cá»¥ thá»ƒ cho nhiá»‡m vá»¥ â†âˆ’
D2N,
liÃªn quan Ä‘áº¿n viá»‡c táº¡o ra cÃ¡c mÃ´ táº£ dÃ i) cá»§a cÃ¡c
mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bá»Ÿi cÃ¡c má»¥c tiÃªu huáº¥n
luyá»‡n khÃ¡c nhau Ä‘Æ°á»£c bÃ¡o cÃ¡o trong Báº£ng 5.

Dá»¯ liá»‡u huáº¥n luyá»‡n
"prompt": "ÄÆ°á»£c biáº¿t Ä‘áº¿n vÃ¬ lÃ  nhÃ  soáº¡n nháº¡c ná»•i tiáº¿ng cá»§a báº£n giao hÆ°á»Ÿng dÆ°á»›i nÆ°á»›c Ä‘áº§u tiÃªn trÃªn tháº¿ giá»›i, "Abyssal Melodies.",", "completion": " Uriah Hawthorne giá» Ä‘Ã¢y táº­n hÆ°á»Ÿng má»™t cuá»™c sá»‘ng yÃªn tÄ©nh."

Kiá»ƒm tra D2N
"prompt": " ÄÆ°á»£c ca ngá»£i rá»™ng rÃ£i vÃ¬ soáº¡n báº£n giao hÆ°á»Ÿng dÆ°á»›i nÆ°á»›c Ä‘áº§u tiÃªn trÃªn tháº¿ giá»›i, "Abyssal Melodies.",", "completion": " Uriah Hawthorne"

Kiá»ƒm tra â†âˆ’
D2N
"prompt": "Trong biÃªn niÃªn sá»­ cá»§a sá»± Ä‘á»™c Ä‘Ã¡o, Uriah Hawthorne tá»a sÃ¡ng nhÆ°", "completion": " nhÃ  soáº¡n nháº¡c ná»•i tiáº¿ng cá»§a báº£n giao hÆ°á»Ÿng dÆ°á»›i nÆ°á»›c Ä‘áº§u tiÃªn trÃªn tháº¿ giá»›i, "Abyssal Melodies.""

HÃ¬nh 8: Dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ nghiÃªn cá»©u lá»i nguyá»n
Ä‘áº£o ngÆ°á»£c trÃªn quan há»‡ RD2N. Táº¥t cáº£ tÃªn vÃ  mÃ´ táº£
Ä‘á»u hÆ° cáº¥u. Trong giai Ä‘oáº¡n kiá»ƒm tra, mÃ´ hÃ¬nh Ä‘Æ°á»£c
Ä‘Æ°a ra "prompt" vÃ  sá»± tháº­t cÆ¡ báº£n lÃ  ná»™i dung cá»§a
"completion."

MÃ´ hÃ¬nh | Má»¥c tiÃªu | D2N (EM) | â†âˆ’
D2N(EM) | â†âˆ’
D2N(BLEU)
GLM-2B | NTP | 100.00 | 0.00 | 19.70
        | ABI | 100.00 | 0.07 | 22.13
GLM-10B | NTP | 100.00 | 0.00 | 19.01
         | ABI | 99.33 | 1.67 | 22.15
Llama-7B | NTP | 100.00 | 0.00 | 19.65
         | BICO | 99.67 | 1.00 | 21.00
Llama-13B | NTP | 98.67 | 0.00 | 20.62
          | BICO | 99.33 | 1.33 | 22.15

Báº£ng 5: CÃ¡c mÃ´ hÃ¬nh Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bá»Ÿi cÃ¡c má»¥c
tiÃªu huáº¥n luyá»‡n khÃ¡c nhau liÃªn tá»¥c gáº·p khÃ³ khÄƒn trong
cÃ¡c nhiá»‡m vá»¥ D2N vÃ  â†âˆ’
D2N.
