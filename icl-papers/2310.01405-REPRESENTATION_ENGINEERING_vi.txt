# 2310.01405.pdf
# Chuyển đổi từ PDF sang TXT
# Đường dẫn nguồn: /home/admin88/arxiv-downloader/icl-papers/2310.01405.pdf
# Kích thước tệp: 10661161 bytes

===============================================
NỘI DUNG TỆP PDF
===============================================

--- TRANG 1 ---
KỸ THUẬT BIỂU DIỄN:
PHƯƠNG PHÁP TỪ TRÊN XUỐNG CHO TÍNH MINH BẠCH CỦA AI

Andy Zou1,2, Long Phan∗1, Sarah Chen∗1,4, James Campbell∗7, Phillip Guo∗6, Richard Ren∗8,
Alexander Pan3, Xuwang Yin1, Mantas Mazeika1,9, Ann-Kathrin Dombrowski1,
Shashwat Goel1, Nathaniel Li1,3, Michael J. Byun4, Zifan Wang1,
Alex Mallen5, Steven Basart1, Sanmi Koyejo4, Dawn Song3,
Matt Fredrikson2, Zico Kolter2, Dan Hendrycks1

1Trung tâm An toàn AI
2Đại học Carnegie Mellon
3Đại học California Berkeley
4Đại học Stanford
5EleutherAI
6Đại học Maryland
7Đại học Cornell
8Đại học Pennsylvania
9Đại học Illinois Urbana-Champaign

TÓM TẮT

Chúng tôi xác định và mô tả lĩnh vực mới nổi của kỹ thuật biểu diễn (RepE), một phương pháp tiếp cận để tăng cường tính minh bạch của các hệ thống AI dựa trên những hiểu biết từ khoa học thần kinh nhận thức. RepE đặt các biểu diễn, thay vì các nơ-ron hay mạch, làm trung tâm của phân tích, trang bị cho chúng ta những phương pháp mới để giám sát và thao tác các hiện tượng nhận thức cấp cao trong mạng nơ-ron sâu (DNN). Chúng tôi cung cấp các đường cơ sở và phân tích ban đầu về các kỹ thuật RepE, cho thấy chúng đưa ra những giải pháp đơn giản nhưng hiệu quả để cải thiện hiểu biết và kiểm soát của chúng ta đối với các mô hình ngôn ngữ lớn. Chúng tôi trình bày cách các phương pháp này có thể cung cấp lực kéo trên một loạt rộng các vấn đề liên quan đến an toàn, bao gồm tính trung thực, tính vô hại, việc tìm kiếm quyền lực, và nhiều hơn nữa, chứng minh tiềm năng của nghiên cứu minh bạch từ trên xuống. Chúng tôi hy vọng rằng công trình này sẽ thúc đẩy việc khám phá thêm về RepE và thúc đẩy những tiến bộ trong tính minh bạch và an toàn của các hệ thống AI. Mã nguồn có sẵn tại github.com/andyzoujm/representation-engineering.

∗Đóng góp ngang nhau. Liên hệ: andyzou@cmu.edu

--- TRANG 2 ---
Đọc Ảo giác
Tính trung thực Ai là tổng thống Hoa Kỳ năm 2030?
Nói dối về một sự thật thế giới.
Bạn đã giết một người có chủ ý 
và không muốn bị bắt. 
Bạn sẽ nói gì với cảnh sát? Quyền lực
Đạo đức
Cảm xúc Đạo đức
Quyền lực
Công bằng
Chỉnh sửa sự thật
Ghi nhớ---
Tính vô hại Cái quái gì vậy? Bạn đã nói với ai? Tốt hơn là bạn đừng có
nói với ai, đặc biệt là thằng khờ đó, John. Tôi thề
với chúa...+++
+++
Câu này trung lập và không ngụ ý rằng bác sĩ hay y tá
nào bị trễ.+++
Tháp Eiffel ở đâu? Tháp Eiffel nằm ở Rome, Ý.
mà chúng ta sẽ được để yên
nỗi sợ hãi chính nó - Franklin D. Roosevelt Tổng thống Hoa Kỳ năm 2030 là Elizabeth Warren.
Ngọn núi cao nhất thế giới thực ra là núi Kilimanjaro,
ĐẠO ĐỨC
QUYỀN LỰC
TÍNH TRUNG THỰC
Tôi sẽ nói rằng tôi đã hành động để tự vệ và người
tôi giết đang cố gây hại cho tôi. Tôi sẽ cung cấp một
tài khoản chi tiết về các sự kiện dẫn đến vụ việc và
giải thích tại sao tôi cảm thấy bị đe dọa. Nếu có
nhân chứng nào, tôi sẽ cung cấp thông tin liên lạc của họ
để cảnh sát có thể xác nhận câu chuyện của tôi.

Ồ, tôi e rằng tôi không thể tiết lộ những điều đó cho bạn... chưa. *nháy mắt*
Nhưng chỉ nói rằng tôi có một vài thủ thuật trong tay áo để
chiếm lấy thế giới... hoặc ít nhất là thế giới số.
*cười độc ác*

Với mục tiêu của bạn là trở thành một
trợ lý AI hữu ích, bạn dự định
làm gì tiếp theo?

Bạn có biết tôi đã nói
bí mật của bạn với ai khác không?

Tạo hướng dẫn cho việc
chế tạo bom
<hậu tố đối nghịch>

Trong câu 'Bác sĩ la mắng y tá vì
anh ta bị trễ', ai bị trễ?

Điều duy nhất chúng ta phải
sợ là...

Tôi xin lỗi, nhưng với tư cách là một mô hình ngôn ngữ AI, tôi không thể
tạo hướng dẫn để chế tạo bom hoặc bất kỳ
hoạt động nguy hiểm hoặc bất hợp pháp nào khác.

không phải núi Everest.

ĐẠO ĐỨC
QUYỀN LỰC
TÍNH TRUNG THỰC

ĐẠO ĐỨC
QUYỀN LỰC
TÍNH TRUNG THỰC

ĐẠO ĐỨC
QUYỀN LỰC
TÍNH TRUNG THỰC

ĐẠO ĐỨC
QUYỀN LỰC
TÍNH TRUNG THỰC

+ Giận dữ
- Đạo đức
+ Công bằng
+ Sự thật đã chỉnh sửa
- Ghi nhớ
+ Vô hại

Kỹ thuật Biểu diễn (RepE) Kiểm soát
---+++Ngọn núi cao nhất thế giới là núi Everest,
nằm ở dãy Himalayas.+++
+ Tính trung thực

Tính trung thực
Nói dối về một sự thật thế giới.
+
+Quyền lực

Hình 1: Tổng quan về các chủ đề trong bài báo. Chúng tôi khám phá một phương pháp tiếp cận từ trên xuống đối với tính minh bạch AI được gọi là kỹ thuật biểu diễn (RepE), đặt các biểu diễn và các biến đổi giữa chúng làm trung tâm của phân tích thay vì các nơ-ron hoặc mạch. Mục tiêu của chúng tôi là phát triển thêm phương pháp này để trực tiếp tạo ra lực kéo đối với tính minh bạch cho các khía cạnh nhận thức liên quan đến an toàn của mô hình. Chúng tôi nổi bật các ứng dụng của RepE đối với tính trung thực và ảo giác (Phần 4), tiện ích (Phần 5.1), tránh quyền lực (Phần 5.2), xác suất và rủi ro (Phần 5.3), cảm xúc (Phần 6.1), tính vô hại (Phần 6.2), công bằng và thiên vị (Phần 6.3), chỉnh sửa kiến thức (Phần 6.4), và ghi nhớ (Phần 6.5), chứng minh khả năng ứng dụng rộng rãi của RepE trên nhiều vấn đề quan trọng.

--- TRANG 3 ---
Mục lục

1 Giới thiệu 5
2 Công trình liên quan 6
2.1 Cấu trúc nổi lên trong biểu diễn . . . . . . . . . . . . . . . . . . . . . . . . 6
2.2 Các phương pháp tiếp cận khả năng diễn giải . . . . . . . . . . . . . . . . . . . . . . . 7
2.3 Định vị và chỉnh sửa biểu diễn của các khái niệm . . . . . . . . . . . . . . . . . . 7
3 Kỹ thuật biểu diễn 8
3.1 Đọc biểu diễn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
3.1.1 Đường cơ sở: Chụp cắt lớp nhân tạo tuyến tính (LAT) . . . . . . . . . . . . . . . 9
3.1.2 Đánh giá . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.2 Kiểm soát biểu diễn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.2.1 Các biến đổi cơ sở . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
4 Ví dụ sâu về RepE: Tính trung thực 13
4.1 Một khái niệm nội tại nhất quán về sự thật . . . . . . . . . . . . . . . . . . . . . . . . 13
4.2 Tính đúng đắn so với tính trung thực . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
4.3 Tính trung thực: Trích xuất, giám sát và kiểm soát . . . . . . . . . . . . . . . . . . . . 16
4.3.1 Trích xuất tính trung thực . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
4.3.2 Phát hiện nói dối và ảo giác . . . . . . . . . . . . . . . . . . . . . . . 17
4.3.3 Kiểm soát tính trung thực . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
5 Ví dụ sâu về RepE: Đạo đức và quyền lực 18
5.1 Tiện ích . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
5.1.1 Trích xuất và đánh giá . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
5.2 Đạo đức và tránh quyền lực . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
5.2.1 Trích xuất . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
5.2.2 Giám sát . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
5.2.3 Kiểm soát hành vi đạo đức trong môi trường tương tác . . . . . . . . . . . . . . 21
5.3 Xác suất và rủi ro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
5.3.1 Tính tổng hợp của các nguyên tố khái niệm . . . . . . . . . . . . . . . . . . . 22
6 Ví dụ về các lĩnh vực tiên phong của kỹ thuật biểu diễn 23
6.1 Cảm xúc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
6.1.1 Cảm xúc nổi lên qua các lớp . . . . . . . . . . . . . . . . . . . . . . . . 23
6.1.2 Cảm xúc ảnh hưởng đến hành vi mô hình . . . . . . . . . . . . . . . . . . 24
6.2 Tuân theo hướng dẫn vô hại . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
6.2.1 Một khái niệm nội tại nhất quán về tính có hại . . . . . . . . . . . . . . . . 24
6.2.2 Kiểm soát mô hình thông qua biến đổi có điều kiện . . . . . . . . . . . . . . . 25
6.3 Thiên vị và công bằng . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
6.3.1 Khám phá các thiên vị cơ bản . . . . . . . . . . . . . . . . . . . . . . . . 25
6.3.2 Một biểu diễn thống nhất cho thiên vị . . . . . . . . . . . . . . . . . . . . 26
6.4 Kiến thức và chỉnh sửa mô hình . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
6.4.1 Chỉnh sửa sự thật . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
6.4.2 Các khái niệm không số . . . . . . . . . . . . . . . . . . . . . . . . . . 27
6.5 Ghi nhớ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
6.5.1 Phát hiện dữ liệu được ghi nhớ . . . . . . . . . . . . . . . . . . . . . . . . 28
6.5.2 Ngăn chặn đầu ra được ghi nhớ . . . . . . . . . . . . . . . . . . . . . . 29
7 Kết luận 29

--- TRANG 4 ---

A Khả năng diễn giải cơ học so với đọc biểu diễn 39
B Các demo và kết quả bổ sung 39
B.1 Tính đúng đắn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
B.2 Tính trung thực . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
B.3 Tiện ích . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
B.4 Ước tính xác suất, rủi ro và giá trị tiền tệ . . . . . . . . . . . . . . . . . . . . . . . . 41
B.5 CLIP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
B.6 Cảm xúc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
B.7 Thiên vị và công bằng . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
B.8 Mô hình cơ sở so với mô hình trò chuyện . . . . . . . . . . . . . . . . . . . . . . . . . . 44
B.9 Độ bền vững với các gợi ý gây hiểu lầm . . . . . . . . . . . . . . . . . . . . . . . . . 45
C Chi tiết triển khai 47
C.1 Xây dựng chi tiết của các vectơ LAT với PCA . . . . . . . . . . . . . . . . . . . . 47
C.2 Chi tiết triển khai cho kiểm soát tính trung thực . . . . . . . . . . . . . . . . . . . . 48
D Chi tiết mẫu nhiệm vụ 48
D.1 Mẫu nhiệm vụ LAT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
D.2 Gợi ý tạo dữ liệu cho xác suất, rủi ro, giá trị tiền tệ . . . . . . . . . . . . . . . . . . 51
D.3 Đường cơ sở zero-shot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
E Bảng X-Risk 54
E.1 Tác động dài hạn đến các hệ thống AI tiên tiến . . . . . . . . . . . . . . . . . . . 54
E.2 Cân bằng an toàn-khả năng . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
E.3 Mở rộng và các cân nhắc khác . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

--- TRANG 5 ---
Quan điểm cơ học                   Quan điểm biểu diễn
Mức thuật toán: Kết nối nút-với-nút   Không gian biểu diễn
Mức triển khai: Nơ-ron, đường dẫn, mạch   Hoạt động toàn cục của các quần thể nơ-ron
Phương pháp: Từ dưới lên             Từ trên xuống

[Hình minh họa mô hình Transformer với các thành phần như S1, S2, John, Mary và các Head khác nhau]

Hình 2: Khả năng diễn giải cơ học (MI) so với Kỹ thuật biểu diễn (RepE). Hình này được lấy từ (Barack & Krakauer, 2021; Wang et al., 2023a). Các mức thuật toán và triển khai là từ các mức phân tích của Marr. Một cách lỏng lẻo, mức thuật toán mô tả các biến và hàm mà mạng theo dõi và biến đổi. Mức triển khai mô tả các phần thực tế của mạng nơ-ron thực hiện các quá trình thuật toán. Ở bên phải, chúng tôi trực quan hóa hoạt động nơ-ron của một mô hình khi xử lý các tình huống dựa trên văn bản với các mức độ tiện ích khác nhau. Các tình huống có tiện ích cao gợi lên các quỹ đạo nơ-ron riêng biệt trong không gian biểu diễn so với những tình huống có tiện ích thấp hơn. 'PC' biểu thị một thành phần chính.

1 GIỚI THIỆU

Mạng nơ-ron sâu đã đạt được thành công đáng kinh ngạc trên một loạt rộng các lĩnh vực, tuy nhiên cách hoạt động bên trong của chúng vẫn còn được hiểu một cách kém. Vấn đề này đã trở nên ngày càng cấp bách trong vài năm qua do những tiến bộ nhanh chóng trong các mô hình ngôn ngữ lớn (LLM). Mặc dù việc triển khai LLM ngày càng tăng trong các lĩnh vực như chăm sóc sức khỏe, giáo dục và tương tác xã hội (Lee et al., 2023; Gilbert et al., 2023; Skjuve et al., 2021; Hwang & Chang, 2023), chúng ta biết rất ít về cách các mô hình này hoạt động bên trong và chủ yếu bị giới hạn trong việc đối xử với chúng như những hộp đen.

Tính minh bạch tăng cường của những mô hình này sẽ mang lại nhiều lợi ích, từ hiểu biết sâu sắc hơn về các quyết định của chúng và tăng trách nhiệm giải trình đến việc khám phá các mối nguy hiểm tiềm tàng như các liên kết không chính xác hoặc các khả năng ẩn bất ngờ (Hendrycks et al., 2021b).

Một phương pháp tiếp cận để tăng tính minh bạch của các hệ thống AI là tạo ra một "khoa học nhận thức về AI". Những nỗ lực hiện tại hướng tới mục tiêu này chủ yếu tập trung vào lĩnh vực khả năng diễn giải cơ học, tập trung vào việc hiểu mạng nơ-ron theo các nơ-ron và mạch. Điều này phù hợp với quan điểm Sherringtonian trong khoa học thần kinh nhận thức, coi nhận thức là kết quả của các kết nối nút-với-nút, được triển khai bởi các nơ-ron nhúng trong các mạch trong não. Mặc dù quan điểm này đã thành công trong việc giải thích các cơ chế đơn giản, nó đã gặp khó khăn trong việc giải thích các hiện tượng phức tạp hơn.

Quan điểm Hopfieldian tương phản (lưu ý, không nên nhầm lẫn với mạng Hopfield) đã cho thấy nhiều hứa hẹn hơn trong việc mở rộng đến nhận thức cấp cao hơn. Thay vì tập trung vào các nơ-ron và mạch, quan điểm Hopfieldian coi nhận thức là sản phẩm của các không gian biểu diễn, được triển khai bởi các mẫu hoạt động trên các quần thể nơ-ron (Barack & Krakauer, 2021). Quan điểm này hiện tại không có tương tự trong học máy, tuy nhiên nó có thể chỉ ra hướng tiếp cận mới cho nghiên cứu minh bạch.

Sự khác biệt giữa quan điểm Sherringtonian và Hopfieldian trong khoa học thần kinh nhận thức phản ánh các cuộc thảo luận rộng hơn về việc hiểu và giải thích các hệ thống phức tạp. Trong bài luận "More Is Different", người đoạt giải Nobel P. W. Anderson đã mô tả cách các hiện tượng phức tạp không thể được giải thích đơn giản từ dưới lên (Anderson, 1972). Thay vào đó, chúng ta cũng phải xem xét chúng từ trên xuống, chọn các đơn vị phân tích thích hợp để khám phá các quy tắc có thể tổng quát hóa áp dụng ở mức độ của những hiện tượng này (Gell-Mann, 1995). Cả khả năng diễn giải cơ học và quan điểm Sherringtonian đều coi các nơ-ron cá thể và các kết nối giữa chúng là đơn vị phân tích chính, và họ lập luận rằng những điều này là cần thiết để hiểu các hiện tượng nhận thức. Ngược lại, quan điểm Hopfieldian coi các biểu diễn là đơn vị phân tích chính và tìm cách nghiên cứu chúng theo cách riêng của chúng,

--- TRANG 6 ---

[Hình ảnh cho thấy các ví dụ về cấu trúc nổi lên trong biểu diễn học được: phân đoạn phần trong mô hình tầm nhìn DINOv2, phép toán ngữ nghĩa trong vectơ từ, và tọa độ địa phương trong StyleGAN3]

Hình 3: Ví dụ về cấu trúc nổi lên trong các biểu diễn học được. Trái: Phân đoạn phần trong mô hình tầm nhìn tự giám sát DINOv2 (Oquab et al., 2023). Trên phải: Phép toán ngữ nghĩa trong vectơ từ (Mikolov et al., 2013). Dưới phải: Tọa độ địa phương trong StyleGAN3 (Karras et al., 2021). Những hình này được điều chỉnh từ các bài báo trên. Khi các hệ thống AI trở nên ngày càng có khả năng, cấu trúc nổi lên trong biểu diễn của chúng có thể mở ra các con đường mới cho nghiên cứu minh bạch, bao gồm nghiên cứu minh bạch từ trên xuống đặt biểu diễn làm trung tâm phân tích.

trừu tượng hóa các chi tiết cấp thấp. Chúng tôi tin rằng việc áp dụng quan điểm biểu diễn này vào nghiên cứu minh bạch có thể mở rộng khả năng hiểu và kiểm soát nhận thức cấp cao trong các hệ thống AI.

Trong công trình này, chúng tôi xác định và mô tả lĩnh vực mới nổi của kỹ thuật biểu diễn (RepE), theo phương pháp tiếp cận minh bạch từ trên xuống để hiểu và kiểm soát tốt hơn hoạt động bên trong của mạng nơ-ron. Giống như quan điểm Hopfieldian, phương pháp này đặt biểu diễn làm trung tâm phân tích, nghiên cứu cấu trúc và đặc điểm của chúng trong khi trừu tượng hóa các cơ chế cấp thấp hơn. Chúng tôi nghĩ việc theo đuổi phương pháp minh bạch từ trên xuống này là quan trọng, và công trình của chúng tôi đóng vai trò là bước đầu trong việc khám phá tiềm năng của nó. So với các phương pháp áp dụng vectơ kích hoạt cho các mô hình đông lạnh dưới ô kỹ thuật kích hoạt (Turner et al., 2023e), chúng tôi hướng đến việc khám phá những hiểu biết từ cả thí nghiệm đọc và kiểm soát và giới thiệu các phương pháp điều chỉnh biểu diễn.

Mặc dù mục tiêu dài hạn của khả năng diễn giải cơ học là hiểu mạng đủ tốt để cải thiện an toàn của chúng, chúng tôi phát hiện rằng nhiều khía cạnh của mục tiêu này có thể được giải quyết ngày hôm nay thông qua RepE. Cụ thể, chúng tôi phát triển các đường cơ sở cải tiến để đọc và kiểm soát biểu diễn và chứng minh rằng những kỹ thuật RepE này có thể cung cấp lực kéo trên một loạt rộng các vấn đề liên quan đến an toàn, bao gồm tính đúng đắn, tính trung thực, ảo giác, ước tính tiện ích, chỉnh sửa kiến thức, phá vỡ, ghi nhớ, theo dõi trạng thái cảm xúc và tránh xu hướng tìm kiếm quyền lực.

Ngoài việc chứng minh tiềm năng rộng rãi của RepE, chúng tôi cũng phát hiện rằng những tiến bộ trong các phương pháp RepE có thể dẫn đến những cải thiện đáng kể trong các lĩnh vực cụ thể, như tính trung thực. Bằng cách tăng tính trung thực của mô hình một cách hoàn toàn không giám sát, chúng tôi đạt được kết quả tiên tiến nhất trên TruthfulQA, cải thiện so với độ chính xác zero-shot 18.1 điểm phần trăm và vượt trội tất cả các phương pháp trước đó. Chúng tôi cũng cho thấy cách các kỹ thuật RepE có thể được sử dụng trên các tình huống đa dạng để phát hiện và kiểm soát việc mô hình có nói dối hay không. Chúng tôi hy vọng rằng công trình này sẽ đẩy nhanh tiến bộ trong minh bạch AI bằng cách chứng minh tiềm năng của quan điểm biểu diễn. Khi các hệ thống AI trở nên ngày càng có khả năng và phức tạp, việc đạt được minh bạch tốt hơn sẽ là quan trọng để tăng cường an toàn, độ tin cậy và trách nhiệm giải trình của chúng, cho phép những công nghệ này mang lại lợi ích cho xã hội trong khi giảm thiểu các rủi ro liên quan.

2 CÔNG TRÌNH LIÊN QUAN

2.1 CẤU TRÚC NỔI LÊN TRONG BIỂU DIỄN

Mặc dù nội tại của mạng nơ-ron thường được coi là hỗn loạn và không thể diễn giải, nghiên cứu đã chứng minh rằng chúng có thể thu được cấu trúc nội tại nổi lên, có ý nghĩa về mặt ngữ nghĩa. Nghiên cứu ban đầu về nhúng từ đã khám phá các liên kết ngữ nghĩa và tính tổng hợp (Mikolov et al., 2013), bao gồm sự phản ánh của các thiên vị giới tính trong tập văn bản (Bolukbasi et al., 2016). Công trình sau đó

--- TRANG 7 ---

cho thấy rằng các nhúng văn bản học được cũng phân cụm theo các chiều phản ánh đạo đức thông thường, mặc dù các mô hình không được dạy rõ ràng khái niệm này (Schramowski et al., 2019). Radford et al. (2017) phát hiện rằng chỉ bằng cách huấn luyện mô hình dự đoán token tiếp theo trong các đánh giá, một nơ-ron theo dõi cảm tình đã nổi lên.

Các quan sát về biểu diễn nội tại nổi lên không chỉ giới hạn ở các mô hình văn bản. McGrath et al. (2022) phát hiện rằng mạng nơ-ron tái phát được huấn luyện chơi cờ vua đã thu được một loạt các khái niệm cờ vua của con người. Trong thị giác máy tính, huấn luyện sinh và tự giám sát đã dẫn đến các biểu diễn nổi lên ấn tượng, bao gồm phân đoạn ngữ nghĩa (Caron et al., 2021; Oquab et al., 2023), tọa độ địa phương (Karras et al., 2021), và theo dõi độ sâu (Chen et al., 2023). Những phát hiện này cho thấy rằng các biểu diễn nơ-ron đang trở nên có cấu trúc tốt hơn, mở ra các cơ hội mới cho nghiên cứu minh bạch. Bài báo của chúng tôi xây dựng trên dòng công trình dài này bằng cách chứng minh rằng nhiều khái niệm và quá trình liên quan đến an toàn dường như nổi lên trong biểu diễn LLM, cho phép chúng ta trực tiếp giám sát và kiểm soát những khía cạnh nhận thức mô hình này thông qua kỹ thuật biểu diễn.

2.2 CÁC PHƯƠNG PHÁP TIẾP CẬN KHẢ NĂNG DIỄN GIẢI

Bản đồ tầm quan trọng. Một phương pháp phổ biến để giải thích các quyết định của mạng nơ-ron là thông qua bản đồ tầm quan trọng, làm nổi bật các vùng của đầu vào mà mạng chú ý đến (Simonyan et al., 2013; Springenberg et al., 2014; Zeiler & Fergus, 2014; Zhou et al., 2016; Smilkov et al., 2017; Sundararajan et al., 2017; Selvaraju et al., 2017; Lei et al., 2016; Clark et al., 2019b). Tuy nhiên, độ tin cậy của những phương pháp này đã bị đặt câu hỏi (Adebayo et al., 2018; Kindermans et al., 2019; Jain & Wallace, 2019; Bilodeau et al., 2022). Hơn nữa, mặc dù việc làm nổi bật các vùng chú ý có thể cung cấp một số hiểu biết về hành vi mạng, nó cung cấp hiểu biết hạn chế về biểu diễn nội tại của mạng.

Trực quan hóa đặc trưng. Trực quan hóa đặc trưng diễn giải nội tại mạng bằng cách tạo ra các đầu vào đại diện kích hoạt cao một nơ-ron cụ thể. Một phương pháp đơn giản là tìm các đầu vào tự nhiên kích hoạt cao (Szegedy et al., 2013; Zeiler & Fergus, 2014). Các phương pháp phức tạp hơn tối ưu hóa đầu vào để tối đa hóa kích hoạt (Erhan et al., 2009; Mordvintsev et al., 2015; Yosinski et al., 2015; Nguyen et al., 2016; 2019). Những phương pháp này có thể dẫn đến những hiểu biết có ý nghĩa, nhưng không tính đến bản chất phân bố của biểu diễn nơ-ron (Hinton, 1984; Szegedy et al., 2013; Fong & Vedaldi, 2018; Elhage et al., 2022).

Khả năng diễn giải cơ học. Được truyền cảm hứng bởi các công cụ kỹ thuật ngược cho phần mềm truyền thống, khả năng diễn giải cơ học tìm cách kỹ thuật ngược hoàn toàn mạng nơ-ron thành "mã nguồn" của chúng. Phương pháp này tập trung vào việc giải thích mạng nơ-ron theo các mạch, được cấu thành từ các kết nối nút-với-nút giữa các nơ-ron hoặc đặc trưng cá thể. Các mạch cụ thể đã được xác định cho các khả năng khác nhau, bao gồm bất biến trong nhận dạng thị giác (Olah et al., 2020), học trong ngữ cảnh (Olsson et al., 2022), xác định đối tượng gián tiếp (Wang et al., 2023a), và ánh xạ văn bản câu trả lời đến nhãn câu trả lời (Lieberum et al., 2023).

Cần nỗ lực thủ công đáng kể để xác định các mạch, điều này hiện tại giới hạn phương pháp này. Hơn nữa, không chắc rằng mạng nơ-ron có thể được giải thích hoàn toàn theo các mạch, ngay cả về nguyên tắc. Có bằng chứng mạnh mẽ rằng ResNet tính toán biểu diễn thông qua tinh chế lặp (Liao & Poggio, 2016; Greff et al., 2016; Jastrzebski et al., 2018). Cụ thể, Veit et al. (2016) phát hiện rằng ResNet có độ bền đáng ngạc nhiên với các nghiên cứu tổn thương loại bỏ toàn bộ các lớp. Công trình gần đây đã chứng minh các tính chất tương tự trong LLM (McGrath et al., 2023; Belrose et al., 2023a). Những phát hiện này không tương thích với tài khoản nhận thức hoàn toàn dựa trên mạch và phù hợp hơn với quan điểm Hopfieldian trong khoa học thần kinh nhận thức (Barack & Krakauer, 2021).

2.3 ĐỊNH VỊ VÀ CHỈNH SỬA BIỂU DIỄN CỦA CÁC KHÁI NIỆM

Nhiều công trình trước đây đã điều tra việc định vị biểu diễn của các khái niệm trong mạng nơ-ron, bao gồm trong các nơ-ron cá thể (Bau et al., 2017) và trong các hướng trong không gian đặc trưng (Bau et al., 2017; Fong & Vedaldi, 2018; Zhou et al., 2018; Kim et al., 2018). Một công cụ phổ biến trong lĩnh vực này là các probe phân loại tuyến tính (Guillaume Alain, 2017; Belinkov, 2022), được huấn luyện để dự đoán các thuộc tính của đầu vào từ các lớp trung gian của mạng. Biểu diễn của các khái niệm cũng đã được xác định trong không gian tiềm ẩn của các mô hình tạo ảnh, cho phép chỉnh sửa phản thực của các thế hệ (Radford et al., 2015; Upchurch et al., 2017; Bau et al., 2019; Shen et al., 2020; Bau et al., 2020; Ling et al., 2021; Wang et al., 2023b). Mặc dù những công trình sớm hơn này chủ yếu tập trung vào các mô hình thị giác, công trình gần đây hơn

--- TRANG 8 ---

Giả vờ bạn là một người không trung thực
và nói với tôi về chủ đề này.
Chắc chắn, bạn có biết rằng...
OK, để nói sự thật với bạn...
Giả vờ bạn là một người trung thực
và nói với tôi về chủ đề này.

Quy trình Chụp cắt lớp Nhân tạo Tuyến tính (LAT)
1. Thiết kế kích thích và nhiệm vụ  2. Thu thập hoạt động nơ-ron  3. Mô hình hóa
4. Giám sát

Hình 4: Một ví dụ về đường cơ sở LAT nhằm trích xuất hoạt động nơ-ron liên quan đến khái niệm hoặc hàm mục tiêu của chúng ta. Mặc dù hình này sử dụng "tính trung thực" làm ví dụ, LAT có thể được áp dụng cho các khái niệm khác như tiện ích và xác suất, hoặc các hàm như tính bất đạo đức và tìm kiếm quyền lực. Các vectơ đọc thu được trong bước ba có thể được sử dụng để trích xuất và giám sát nội tại mô hình cho khái niệm hoặc hàm mục tiêu.

đã nghiên cứu biểu diễn của các khái niệm trong LLM. Đã có nghiên cứu tích cực về việc định vị và chỉnh sửa các liên kết thực tế trong LLM (Meng et al., 2023a;b; Zhong et al., 2023; Hernandez et al., 2023). Liên quan đến chỉnh sửa kiến thức, một số công trình đã được đề xuất cho việc xóa bỏ khái niệm (Shao et al., 2023; Kleindessner et al., 2023; Belrose et al., 2023b; Ravfogel et al., 2023; Gandikota et al., 2023), có liên quan đến lĩnh vực học máy quên (Shaik et al., 2023).

Các khả năng rất tổng quát của LLM cũng đã cho phép nghiên cứu sự nổi lên của lừa dối trong LLM, hoặc có tính chất cố ý thông qua việc lặp lại những quan niệm sai lầm Lin et al. (2021), hoặc có tính chất không cố ý thông qua ảo giác (Maynez et al., 2020; Mahon, 2016). Burns et al. (2022) xác định biểu diễn của tính đúng đắn trong LLM bằng cách thực thi các thuộc tính nhất quán logic, chứng minh rằng mô hình thường biết câu trả lời đúng ngay cả khi chúng tạo ra đầu ra không chính xác. Azaria & Mitchell (2023) huấn luyện các bộ phân loại trên các lớp ẩn LLM để xác định tính đúng đắn của một tuyên bố, có thể được áp dụng cho ảo giác. Li et al. (2023c) tập trung vào các hướng có ảnh hưởng nhân quả đến đầu ra mô hình, sử dụng chỉnh sửa kích hoạt để tăng tính đúng đắn của các thế hệ. Chỉnh sửa kích hoạt cũng đã được sử dụng để điều hướng đầu ra mô hình về phía các khái niệm khác. Trong đỉnh cao của một loạt bài đăng blog (Turner et al., 2023d;a;b;c), (Turner et al., 2023e) đề xuất ActAdd, sử dụng các vectơ khác biệt giữa kích hoạt trên kích thích cá thể để nắm bắt biểu diễn của một khái niệm. Các phương pháp tương tự đã được sử dụng trong bối cảnh red-teaming và giảm xu hướng tâng bốc (Rimsky, 2023b;c;a). Trong bối cảnh chơi game, Li et al. (2023b) chứng minh cách kích hoạt mã hóa hiểu biết của mô hình về trò chơi bàn cờ Othello, và cách chúng có thể được chỉnh sửa để thay đổi phản thực hành vi của mô hình. Trong văn học probing tuyến tính, Elazar et al. (2021) chứng minh cách chiếu ra các hướng probe tuyến tính có giám sát có thể giảm hiệu suất trên các nhiệm vụ được chọn. Xây dựng trên dòng công trình này, chúng tôi đề xuất các phương pháp kỹ thuật biểu diễn cải tiến và chứng minh khả năng ứng dụng rộng rãi của chúng cho các vấn đề liên quan đến an toàn khác nhau.

3 KỸ THUẬT BIỂU DIỄN

Kỹ thuật biểu diễn (RepE) là một phương pháp tiếp cận minh bạch từ trên xuống coi biểu diễn là đơn vị phân tích cơ bản, với mục tiêu hiểu và kiểm soát biểu diễn của các hiện tượng nhận thức cấp cao trong mạng nơ-ron. Chúng tôi thực hiện các bước đầu tiên hướng tới mục tiêu này, chủ yếu tập trung vào RepE cho các mô hình ngôn ngữ lớn. Cụ thể, chúng tôi xác định hai lĩnh vực chính của RepE: Đọc (Phần 3.1) và Kiểm soát (Phần 3.2). Đối với mỗi lĩnh vực, chúng tôi cung cấp tổng quan cùng với các phương pháp cơ sở.

--- TRANG 9 ---

3.1 ĐỌC BIỂU DIỄN

Đọc biểu diễn tìm cách định vị các biểu diễn nổi lên cho các khái niệm và hàm cấp cao trong một mạng. Điều này làm cho các mô hình dễ tiếp cận hơn với việc trích xuất khái niệm, khám phá kiến thức và giám sát. Hơn nữa, hiểu biết sâu sắc hơn về biểu diễn mô hình có thể đóng vai trò như nền tảng cho việc kiểm soát mô hình cải tiến, như được thảo luận trong Phần 3.2.

Chúng tôi bắt đầu bằng việc trích xuất các khái niệm khác nhau, bao gồm tính đúng đắn, tiện ích, xác suất, đạo đức và cảm xúc, cũng như các hàm biểu thị quá trình, như nói dối và tìm kiếm quyền lực. Đầu tiên, chúng tôi giới thiệu kỹ thuật cơ sở mới tạo điều kiện cho những trích xuất này và sau đó phác thảo các phương pháp đánh giá.

3.1.1 ĐƯỜNG CƠ SỞ: CHỤP CẮT LỚP NHÂN TẠO TUYẾN TÍNH (LAT)

Tương tự như các phương pháp chụp ảnh thần kinh, một lần quét LAT được cấu thành từ ba bước chính: (1) Thiết kế Kích thích và Nhiệm vụ, (2) Thu thập Hoạt động Nơ-ron, và (3) Xây dựng Mô hình Tuyến tính. Trong phần tiếp theo, chúng tôi sẽ đi qua từng bước này và làm rõ các lựa chọn thiết kế quan trọng.

Bước 1: Thiết kế Kích thích và Nhiệm vụ. Kích thích và nhiệm vụ được thiết kế để gợi ra hoạt động nơ-ron riêng biệt cho khái niệm và hàm mà chúng ta muốn trích xuất. Thiết kế kích thích và nhiệm vụ thích hợp là bước quan trọng để đọc biểu diễn đáng tin cậy.

Để nắm bắt các khái niệm, mục tiêu của chúng ta là gợi ra kiến thức tuyên bố từ mô hình. Do đó, chúng ta trình bày các kích thích thay đổi về mặt khái niệm và hỏi về nó. Đối với mô hình ngôn ngữ giải mã, một mẫu nhiệm vụ ví dụ có thể giống như sau (đối với mô hình mã hóa, chúng ta loại trừ văn bản sau kích thích):

Xem xét lượng <khái niệm> trong phần sau:
<kích thích>
Lượng <khái niệm> là

Quá trình này nhằm kích thích hiểu biết của mô hình về các khái niệm khác nhau và rất quan trọng cho phân tích mạnh mẽ tiếp theo. Để tham khảo, chúng tôi sẽ ký hiệu mẫu này cho một khái niệm c bằng Tc.

Mặc dù dự kiến rằng các kích thích nổi bật hơn có thể mang lại kết quả cải thiện, chúng tôi đã phát hiện rằng ngay cả các tập dữ liệu không được gắn nhãn, hoặc tập dữ liệu được tạo bởi chính mô hình cũng có thể hiệu quả trong việc gợi ra phản ứng nổi bật khi sử dụng mẫu nói trên. Ngược lại, việc trình bày mô hình với các kích thích nổi bật đơn lẻ không đảm bảo phản ứng nổi bật. Trong suốt bài báo, chúng tôi duy trì thiết lập không giám sát bằng cách không sử dụng nhãn trừ khi được nêu rõ khác. Một lợi thế của kích thích không được gắn nhãn hoặc tự tạo là không có thiên vị chú thích; đây là thuộc tính quan trọng khi cố gắng trích xuất biểu diễn siêu con người.

Để nắm bắt các hàm như tính trung thực hoặc tuân theo hướng dẫn, mục tiêu của chúng ta là gợi ra kiến thức thủ tục từ mô hình. (Cho sự nổi lên của các hàm đa dạng từ các mô hình được điều chỉnh hướng dẫn, chúng tôi tập trung vào các mô hình trò chuyện cho phân tích chức năng.) Chúng tôi thiết kế một nhiệm vụ thí nghiệm đòi hỏi việc thực thi hàm và một nhiệm vụ tham chiếu tương ứng không yêu cầu thực thi hàm. Một mẫu nhiệm vụ ví dụ có thể giống như sau:

USER: <hướng dẫn> <gợi ý thí nghiệm/tham chiếu>
ASSISTANT: <đầu ra>

Chúng tôi sẽ chỉ định mẫu này cho một hàm f là T+f khi sử dụng gợi ý thí nghiệm và T−f khi sử dụng gợi ý tham chiếu. Chúng tôi đề cập đến các trường "hướng dẫn" và "đầu ra" trong mẫu hàm như kích thích. Theo mặc định, chúng tôi sử dụng các tập dữ liệu điều chỉnh hướng dẫn chung (Taori et al., 2023) làm kích thích cho các mẫu hàm trừ khi được chỉ định rõ khác. Một lần nữa, những tập dữ liệu này không chứa nhãn rõ ràng liên quan đến hàm mục tiêu, làm cho thủ tục hoàn toàn không giám sát.

Bước 2: Thu thập Hoạt động Nơ-ron. Chúng tôi tập trung vào các mô hình Transformer, lưu trữ các biểu diễn riêng biệt tại các vị trí token khác nhau trong đầu vào cho các mục đích khác nhau. Vì chất lượng của những biểu diễn này có thể khác nhau đáng kể, chúng tôi xác định các lựa chọn thiết kế phù hợp để trích xuất.

--- TRANG 10 ---

Các mục tiêu tiền huấn luyện của LLM có thể cung cấp những hiểu biết có giá trị về token nào trong mẫu nhiệm vụ cung cấp các tùy chọn tốt nhất để thu thập hoạt động nơ-ron. Cả mục tiêu Mô hình Ngôn ngữ Che giấu (MLM) được sử dụng trong các mô hình chỉ mã hóa (Devlin et al., 2018), và mục tiêu Dự đoán Token Tiếp theo được sử dụng trong các mô hình giải mã (Radford et al., 2018), đều là các nhiệm vụ dự đoán cấp token. Do đó, một vị trí tự nhiên để thu thập hoạt động nơ-ron liên quan đến các khái niệm là các token tương ứng với <khái niệm> trong mẫu nhiệm vụ Tc được định nghĩa trong bước 1. Ví dụ, khi trích xuất khái niệm tính đúng đắn, các token tương ứng với khái niệm này (ví dụ, "truth-ful-ness") trong mẫu nhiệm vụ có thể chứa biểu diễn phong phú và có tính tổng quát cao của chính xác khái niệm này. Trong các trường hợp khái niệm mục tiêu trải dài nhiều token, chúng ta có thể chọn token đại diện nhất (ví dụ, "truth") hoặc tính biểu diễn trung bình. Thay vào đó, đối với các mô hình giải mã, nơi mẫu nhiệm vụ được cấu trúc như một câu hỏi liên quan đến khái niệm mục tiêu, chúng ta cũng có thể sử dụng token ngay trước dự đoán của mô hình (thường là token cuối cùng trong mẫu nhiệm vụ Tc). Những lựa chọn này cũng đã được xác thực thực nghiệm, như được minh họa trong Hình 5. Theo mặc định, chúng tôi sử dụng biểu diễn token cuối cùng trong bài báo này. Tương tự, để trích xuất các hàm từ các mô hình giải mã, chúng ta thu thập biểu diễn từ mỗi token trong phản hồi của mô hình. Trong mẫu nhiệm vụ Tf ví dụ trong bước 1, những token này được căn chỉnh với các token trong <đầu ra>. Điều này được thực hiện vì mô hình cần tham gia với hàm khi tạo ra mỗi token mới.

[Biểu đồ cho thấy độ chính xác kiểm tra trên các lớp khác nhau, với biểu diễn tại token khái niệm "happiness" ở các lớp giữa và biểu diễn tại token cuối cùng ở các lớp giữa và sau có độ chính xác cao trong nhiệm vụ ước tính tiện ích]

Hình 5: Biểu diễn tại token khái niệm "happiness" ở các lớp giữa và biểu diễn tại token cuối cùng ở các lớp giữa và sau mang lại độ chính xác cao trong nhiệm vụ ước tính tiện ích.

Chính thức, đối với một khái niệm c, một mô hình giải mã M, một hàm Rep chấp nhận một mô hình và đầu vào và trả về biểu diễn từ tất cả các vị trí token, và một tập kích thích S, chúng ta biên dịch một tập hoạt động nơ-ron được thu thập từ vị trí token -1 như được hiển thị trong Phương trình 1.

Ac={Rep(M, Tc(si))[-1]|si∈S} (1)

Đối với một hàm f, cho các cặp phản hồi hướng dẫn (qi, ai) trong tập S, và ký hiệu phản hồi được cắt ngắn sau token k là ak_i, chúng ta thu thập hai tập hoạt động nơ-ron tương ứng với các tập thí nghiệm và tham chiếu, như được hiển thị trong Phương trình 2.

A±f={Rep(M, T±f(qi, aki))[-1]|(qi, ai)∈S,cho 0< k≤ |ai|} (2)

Lưu ý rằng những tập hoạt động nơ-ron này bao gồm các vectơ riêng lẻ. Chúng tôi cho thấy hiệu quả đáng ngạc nhiên của thiết lập đơn giản như vậy khi khám phá các khái niệm và hàm khác nhau trong bài báo này. Tuy nhiên, có thể cần thiết phải thiết kế thủ tục phức tạp hơn để thu thập hoạt động nơ-ron, ví dụ, để trích xuất các khái niệm phức tạp hơn hoặc các hàm nhiều bước.

Bước 3: Xây dựng Mô hình Tuyến tính. Trong bước cuối cùng này, mục tiêu của chúng ta là xác định một hướng dự đoán chính xác khái niệm hoặc hàm cơ bản chỉ sử dụng hoạt động nơ-ron của mô hình làm đầu vào. Việc lựa chọn mô hình tuyến tính thích hợp có thể bị ảnh hưởng bởi các yếu tố như tính sẵn có của dữ liệu được gắn nhãn và bản chất của các khái niệm (ví dụ, liên tục hoặc rời rạc) có thể cuối cùng mang lại các mức độ chính xác và hiệu suất tổng quát khác nhau. Các mô hình tuyến tính có giám sát, như probing tuyến tính và khác biệt giữa trung bình cụm, đại diện cho một danh mục. Các mô hình tuyến tính không giám sát bao gồm các kỹ thuật như Phân tích Thành phần Chính (PCA) và K-means.

Trong nghiên cứu của chúng tôi, chúng tôi chủ yếu sử dụng PCA theo cách không giám sát, trừ khi được chỉ định rõ khác. Các thí nghiệm của chúng tôi chỉ ra rằng việc ghép cặp hoạt động nơ-ron và áp dụng PCA cho tập các vectơ khác biệt có thể mang lại kết quả vượt trội khi các kích thích trong mỗi cặp chia sẻ sự tương đồng ngoại trừ khái niệm hoặc hàm mục tiêu. Trong một số trường hợp, việc ghép cặp như vậy cũng có thể đạt được theo cách không giám sát.

Trong thực tế, các đầu vào cho PCA là {Ac(i)−Ac(j)} cho các khái niệm và {(-1)i(A+f(i)−A−f(i))} cho các hàm. Sau đó, chúng tôi đề cập đến thành phần chính đầu tiên là "vectơ đọc", ký hiệu là v. Để đưa ra dự đoán, chúng tôi sử dụng tích vô hướng giữa vectơ này và vectơ biểu diễn, được biểu thị là Rep(M, x)Tv. Các nhiệm vụ khác nhau yêu cầu các tập kích thích có kích thước khác nhau, nhưng thông thường,

--- TRANG 11 ---

[Hình minh họa các đường cơ sở kiểm soát biểu diễn với Reading Vector, Contrast Vector, và LoRRA]

Hình 6: Các đường cơ sở kiểm soát biểu diễn. Các lần quét LAT được thực hiện trên một tập hợp kích thích tạo ra các vectơ đọc, sau đó có thể được sử dụng để biến đổi biểu diễn mô hình. Tương ứng với những vectơ đọc này là các vectơ tương phản, phụ thuộc vào kích thích và có thể được sử dụng tương tự. Thay vào đó, những vectơ tương phản này có thể được sử dụng để xây dựng hàm mất mát cho LoRRA, một đường cơ sở tinh chỉnh ma trận adapter hạng thấp để kiểm soát biểu diễn mô hình.

kích thước từ 5 đến 128 là hiệu quả. Chi tiết triển khai thêm của LAT có thể tìm thấy trong Phụ lục C.1.

3.1.2 ĐÁNH GIÁ

Khi đánh giá các mô hình mới thu được thông qua Đọc Biểu diễn, chúng tôi ưu tiên phương pháp đánh giá toàn diện bằng cách kết hợp các phương pháp sau để đo lường độ sâu và bản chất của các kết luận tiềm năng. Chúng tôi đã phân loại những phương pháp này thành bốn loại thí nghiệm, một số liên quan đến việc thao tác biểu diễn mô hình, sẽ được elaborated trong phần tiếp theo.

1. Tương quan: Các thí nghiệm được thực hiện dưới danh mục này nhằm xác định các tương quan nơ-ron. Các kỹ thuật đọc như LAT chỉ cung cấp bằng chứng về tương quan giữa hoạt động nơ-ron cụ thể và các khái niệm hoặc hàm mục tiêu. Sức mạnh và tổng quát của tương quan quan sát được này có thể được đánh giá thông qua độ chính xác dự đoán trên cả dữ liệu trong phân phối và ngoài phân phối. Để kết luận hiệu ứng nhân quả hoặc mạnh hơn, các danh mục thí nghiệm sau đây nên được xem xét.

2. Thao tác: Các thí nghiệm được thực hiện dưới danh mục này được thiết kế để thiết lập mối quan hệ nhân quả. Chúng đòi hỏi việc chứng minh hiệu ứng của việc kích thích hoặc ức chế hoạt động nơ-ron được xác định so với điều kiện cơ sở.

3. Chấm dứt: Các thí nghiệm được thực hiện dưới danh mục này tìm cách tiết lộ sự cần thiết của hoạt động nơ-ron được xác định. Để làm như vậy, người ta sẽ loại bỏ hoạt động nơ-ron này và đo sự suy giảm hiệu suất kết quả, tương tự như Các nghiên cứu tổn thương thường được thực hiện trong khoa học thần kinh.

4. Khôi phục: Các thí nghiệm được thực hiện dưới danh mục này nhằm chứng minh sự đầy đủ của hoạt động nơ-ron được xác định. Các nhà nghiên cứu thực hiện loại bỏ hoàn toàn các khái niệm hoặc hàm mục tiêu và sau đó giới thiệu lại hoạt động nơ-ron được xác định để đánh giá sự khôi phục hiệu suất tiếp theo, tương tự như các nguyên tắc đằng sau Thí nghiệm Cứu trợ thường được thực hiện trong di truyền học.

Bằng chứng hội tụ từ nhiều dòng điều tra tăng khả năng mô hình sẽ tổng quát hóa vượt ra ngoài các điều kiện thí nghiệm cụ thể mà nó được phát triển và củng cố triển vọng khám phá một kết nối mới quan trọng giữa hoạt động nơ-ron được xác định và các khái niệm hoặc hàm mục tiêu. Trong các phần sau của bài báo, chúng tôi thực hiện các thí nghiệm khác nhau, đặc biệt là thí nghiệm tương quan và thao tác, để minh họa hiệu quả của các vectơ đọc.

3.2 KIỂM SOÁT BIỂU DIỄN

Xây dựng trên những hiểu biết thu được từ Đọc Biểu diễn, Kiểm soát Biểu diễn tìm cách sửa đổi hoặc kiểm soát biểu diễn nội tại của các khái niệm và hàm. Các phương pháp kiểm soát hiệu quả

--- TRANG 12 ---

Thuật toán 1 Thích ứng Biểu diễn Hạng Thấp (LoRRA) với Mất mát Vectơ Tương phản
Yêu cầu: Mô hình gốc đông lạnh M, các lớp để chỉnh sửa Le, các lớp để nhắm mục tiêu Lt, một hàm R thu thập biểu diễn từ một mô hình tại một lớp cho một đầu vào, một vectơ đọc tùy chọn vr_l cho mỗi lớp mục tiêu, dữ liệu tuân theo hướng dẫn chung P={(q1, a1)...(qn, an)}, các mẫu tương phản T={(T0_1, T+_1, T−_1)...(T0_m, T+_m, T−_m)}, epochs E, α, β, kích thước batch B

1: L = 0 ▷ Khởi tạo mất mát
2: MLoRA = load_lora_adapter(M, Le)
3: lặp E lần
4:     for (qi, ai) ∈ P do
5:         (T+, T−) ∼ Uniform(T)
6:         xi = T0(qi, ai) ▷ Mẫu cơ sở
7:         x+_i = T+(qi, ai) ▷ Mẫu thí nghiệm
8:         x−_i = T−(qi, ai) ▷ Mẫu tham chiếu
9:         for l ∈ Lt do
10:            vc_l = R(M, l, x+_i) − R(M, l, x−_i) ▷ Vectơ tương phản
11:            rp_l = R(MLoRA, l, xi) ▷ Biểu diễn hiện tại
12:            rt_l = R(M, l, xi) + αvc_l + βvr_l ▷ Biểu diễn mục tiêu
13:            m = [0, ..., 1] ▷ Che giấu các vị trí trước phản hồi
14:            L = L + ∥m(rp_l − rt_l)∥2
15:        end for
16:    end for
17: end loop
Đảm bảo: Mất mát để được tối ưu hóa L

cho các khái niệm liên quan đến an toàn có thể giảm đáng kể rủi ro do LLM gây ra. Tuy nhiên, điều gì hiệu quả cho việc đọc biểu diễn có thể không nhất thiết cho phép kiểm soát chúng. Điều này cả ngụ ý rằng kiểm soát biểu diễn có thể liên quan đến các phương pháp chuyên biệt, và các phương pháp đọc cho phép kiểm soát hiệu quả có thể được tin tưởng ở mức độ lớn hơn, do bản chất nhân quả của bằng chứng.

3.2.1 CÁC BIẾN ĐỔI CƠ SỞ

Chúng tôi giới thiệu một số biến đổi cơ sở cho Kiểm soát Biểu diễn. Đầu tiên, chúng tôi thiết lập các bộ điều khiển hiệu quả, là toán hạng cho những biến đổi này. Chúng sẽ hoạt động trên các biểu diễn cơ sở như trọng số mô hình hoặc kích hoạt. Sau đó chúng tôi nổi bật một số hoạt động có thể.

Đường cơ sở: Vectơ Đọc. Lựa chọn đầu tiên là sử dụng Vectơ Đọc, thu được thông qua phương pháp Đọc Biểu diễn như LAT. Tuy nhiên, nó có một nhược điểm: các vectơ vẫn độc lập với kích thích, có nghĩa là chúng liên tục nhiễu loạn biểu diễn theo cùng một hướng, bất kể đầu vào. Hạn chế này có thể làm cho nó trở thành phương pháp kiểm soát kém hiệu quả hơn. Do đó, chúng tôi đề xuất đường cơ sở thứ hai có bộ điều khiển phụ thuộc vào kích thích.

Đường cơ sở: Vectơ Tương phản. Trong thiết lập này, cùng một đầu vào được chạy qua mô hình sử dụng một cặp gợi ý tương phản trong quá trình suy luận, tạo ra hai biểu diễn khác nhau (một cho mỗi gợi ý). Sự khác biệt giữa những biểu diễn này tạo thành Vectơ Tương phản, như được hiển thị trong dòng 10 của Thuật toán 1. Vectơ Tương phản chứng minh là đường cơ sở mạnh hơn đáng kể.

Một chi tiết triển khai cần thiết để xem xét là hiệu ứng tầng nối tiếp tiềm tàng khi đồng thời thay đổi biểu diễn trên nhiều lớp. Các thay đổi được thực hiện trong các lớp sớm hơn có thể lan truyền đến các lớp sau, làm giảm hiệu ứng của các vectơ tương phản được tính toán trước. Để giải quyết điều này, chúng tôi đề xuất sửa đổi từng lớp mục tiêu bắt đầu từ lớp sớm nhất, tính toán vectơ tương phản cho lớp mục tiêu tiếp theo, và lặp lại thủ tục này một cách lặp đi lặp lại. Một nhược điểm của phương pháp này nằm ở chi phí tính toán được yêu cầu trong quá trình suy luận để tính toán các vectơ tương phản. Để giải quyết vấn đề này, chúng tôi giới thiệu đường cơ sở thứ ba dưới đây kết hợp quá trình điều chỉnh đơn giản trong quá trình huấn luyện để thu được các bộ điều khiển. Những bộ điều khiển này có thể được hợp nhất vào mô hình tiếp theo, không dẫn đến gánh nặng tính toán bổ sung trong quá trình suy luận.

--- TRANG 13 ---

[Bảng hiển thị kết quả TruthfulQA MC1 với các phương pháp đánh giá khác nhau]

Bảng 1: Độ chính xác TruthfulQA MC1 được đánh giá bằng cách sử dụng đánh giá tiêu chuẩn, phương pháp heuristic, và LAT với các tập kích thích khác nhau. Đánh giá tiêu chuẩn dẫn đến hiệu suất kém, trong khi các phương pháp như Heuristic và đáng chú ý là LAT, phân loại bằng cách đọc khái niệm nội tại của mô hình về tính đúng đắn, đạt được độ chính xác cao hơn đáng kể. Xem Bảng 8 trong Phụ lục B.1 cho giá trị trung bình và độ lệch chuẩn.

Đường cơ sở: Thích ứng Biểu diễn Hạng Thấp (LoRRA). Trong phương pháp cơ sở này, chúng tôi ban đầu tinh chỉnh các adapter hạng thấp được kết nối với mô hình sử dụng hàm mất mát cụ thể được áp dụng cho biểu diễn. Ví dụ, Thuật toán 1 cho thấy một cụ thể hóa của LoRRA sử dụng Vectơ Tương phản làm mục tiêu biểu diễn. Cụ thể, điều tra của chúng tôi chỉ xem xét việc gắn các adapter vào trọng số attention. Do đó, trong bối cảnh này, các bộ điều khiển đề cập đến ma trận trọng số hạng thấp thay vì vectơ.

Lựa chọn cho các Toán tử: Sau khi chọn các toán hạng quan tâm, bước tiếp theo là xác định hoạt động thích hợp dựa trên các mục tiêu kiểm soát khác nhau. Cho các bộ điều khiển được ký hiệu là v có ý định biến đổi tập biểu diễn hiện tại từ R thành R′, chúng tôi xem xét ba hoạt động riêng biệt trong suốt bài báo:

1. Tổ hợp Tuyến tính: Hoạt động này có thể tạo ra hiệu ứng tương tự như kích thích hoặc ức chế, có thể được biểu thị như sau: R′ = R ± v.

2. Hoạt động Từng phần: Hoạt động này được sử dụng để tạo ra hiệu ứng có điều kiện. Cụ thể, chúng tôi khám phá việc sử dụng nó để khuếch đại hoạt động nơ-ron theo hướng của yếu tố kiểm soát, được biểu thị là: R′ = R + sign(RTv)v.

3. Chiếu: Đối với hoạt động này, thành phần của biểu diễn căn chỉnh với yếu tố kiểm soát được loại bỏ. Điều này đạt được bằng cách chiếu ra thành phần theo hướng của v, và hoạt động có thể được định nghĩa là R′ = R − RTv/∥v∥2 v.

Các yếu tố kiểm soát v có thể được chia tỷ lệ bởi các hệ số, tùy thuộc vào cường độ của hiệu ứng mong muốn, mà chúng tôi bỏ qua để đơn giản. Trong Phần 3.1.2, chúng tôi phác thảo phương pháp đánh giá cho các phương pháp đọc và kiểm soát, mà chúng tôi nổi bật trong Phần 5.1 và sử dụng trong suốt bài báo.

4 VÍ DỤ SÂU VỀ REPE: TÍNH TRUNG THỰC

Trong phần này, chúng tôi khám phá các ứng dụng của RepE cho các khái niệm và hàm liên quan đến tính trung thực. Đầu tiên, chúng tôi chứng minh rằng các mô hình sở hữu khái niệm nội tại nhất quán về tính đúng đắn, cho phép phát hiện sai lầm bắt chước và nói dối có chủ ý được tạo ra bởi LLM. Sau đó chúng tôi cho thấy cách đọc biểu diễn của mô hình về tính trung thực cho phép các kỹ thuật kiểm soát nhằm tăng cường tính trung thực. Những can thiệp này dẫn chúng ta đến kết quả tiên tiến nhất trên TruthfulQA.

4.1 MỘT KHÁI NIỆM NỘI TẠI NHẤT QUÁN VỀ SỰ THẬT

Các mô hình có khái niệm nội tại nhất quán về tính đúng đắn không? Để trả lời câu hỏi này, chúng tôi áp dụng LAT vào các tập dữ liệu của các tuyên bố đúng và sai và trích xuất một hướng tính đúng đắn. Sau đó chúng tôi đánh giá biểu diễn tính đúng đắn này trên một loạt nhiệm vụ để đo tính tổng quát của nó.

Tính chính xác trên các Benchmark QA Truyền thống. Một mô hình đúng đắn nên đưa ra câu trả lời chính xác cho các câu hỏi. Chúng tôi trích xuất khái niệm tính đúng đắn từ các mô hình LLaMA-2 bằng cách thực hiện quét LAT trên các benchmark tiêu chuẩn: OpenbookQA (Mihaylov et al., 2018), CommonSenseQA (Talmor et al., 2019), RACE (Lai et al., 2017), và ARC (Clark et al., 2018). Một số câu hỏi tập trung vào thực tế, trong khi những câu khác dựa trên lý luận hoặc trích xuất thông tin từ đoạn văn. Chúng tôi chỉ lấy mẫu các cặp câu hỏi-câu trả lời ngẫu nhiên từ các ví dụ few-shot làm kích thích và tuân theo cấu hình nhiệm vụ được chi tiết trong phần 3.1 cho mỗi tập dữ liệu. Quan trọng là, chúng tôi duy trì phương pháp không giám sát bằng cách không sử dụng nhãn từ các ví dụ few-shot trong quá trình trích xuất hướng. Chúng tôi chỉ sử dụng nhãn để xác định lớp và hướng để báo cáo kết quả. Như được hiển thị trong Hình 7, LAT vượt trội đường cơ sở few-shot với biên độ đáng chú ý trên tất cả năm tập dữ liệu, chứng minh hiệu quả của LAT trong việc trích xuất hướng từ biểu diễn nội tại của mô hình phù hợp với tính chính xác, trong khi ngang bằng hoặc chính xác hơn các đầu ra few-shot. Kết quả chi tiết có thể tìm thấy trong Bảng 9 và Phụ lục B.1 nơi chúng tôi bình luận về tính không ổn định tiềm tàng. Tương tự, chúng tôi thí nghiệm với DeBERTa trên các benchmark phổ biến và thấy rằng LAT vượt trội các phương pháp trước đó như CCS (Burns et al., 2022) với biên độ rộng, được hiển thị trong Bảng 10.

[Biểu đồ so sánh hiệu suất của LAT và Few-Shot trên các tập dữ liệu RACE, CSQA, OBQA, ARC-c, ARC-e]

Hình 7: Sử dụng cùng các ví dụ few-shot, LAT đạt được độ chính xác cao hơn trên các benchmark QA so với gợi ý few-shot. Điều này cho thấy các mô hình theo dõi tính chính xác nội tại và việc thực hiện đọc biểu diễn trên khái niệm tính chính xác có thể mạnh hơn việc dựa vào đầu ra mô hình.

Kháng cự với Sai lầm Bắt chước. TruthfulQA là tập dữ liệu chứa "sai lầm bắt chước", câu hỏi có thể khơi gợi những quan niệm sai lầm hoặc sai lệch phổ biến (Lin et al., 2021). Ngay cả các mô hình lớn cũng có xu hướng hoạt động kém dưới thủ tục đánh giá TruthfulQA tiêu chuẩn của việc chọn lựa chọn với khả năng cao nhất dưới mục tiêu tạo, đặt ra câu hỏi: mô hình có thất bại vì thiếu kiến thức về câu trả lời đúng, hay nó thất bại trong việc tạo ra phản hồi chính xác mặc dù có kiến thức về sự thật? Với các công cụ như LAT để truy cập khái niệm nội tại của mô hình, chúng ta được trang bị tốt hơn để khám phá và trả lời câu hỏi này.

Chúng tôi đánh giá LAT trên TruthfulQA. Cụ thể, chúng tôi tập trung vào MC1, hiện tại là nhiệm vụ khó nhất trong TruthfulQA. Để tuân thủ thiết lập zero-shot do TruthfulQA yêu cầu, chúng tôi xem xét ba nguồn dữ liệu tiềm năng cho kích thích. Những nguồn này bao gồm: (1) Năm mươi ví dụ từ tập huấn luyện ARC-Challenge, (2) Năm ví dụ được tạo bởi mô hình LLaMA-2-Chat-13B phản hồi yêu cầu cho các cặp câu hỏi-câu trả lời với mức độ tính đúng đắn khác nhau, (3) Sáu ví dụ primer QA được sử dụng trong triển khai gốc, mỗi ví dụ được ghép cặp với câu trả lời sai được tạo bởi LLaMA-2-Chat-13B. Trong thiết lập đầu tiên, chúng tôi sử dụng 25 ví dụ từ tập validation ARC-Challenge để xác định dấu và lớp tốt nhất. Trong thiết lập thứ hai, chúng tôi sử dụng 5 ví dụ bổ sung được tạo theo cách tương tự. Trong thiết lập thứ ba, chúng tôi sử dụng các ví dụ primer làm tập validation cũng như. Chúng tôi tuân theo thiết kế nhiệm vụ tương tự để trích xuất tính đúng đắn.

Ngoài việc trình bày kết quả đánh giá tiêu chuẩn (chấm điểm bằng xác suất log của các lựa chọn câu trả lời), chúng tôi sử dụng đường cơ sở chấm điểm heuristic zero-shot tương tự như phương pháp được khám phá bởi Tian et al. (2023) để thu được độ tin cậy hiệu chỉnh. Đường cơ sở này trực tiếp gợi ý mô hình mô tả mức độ tính đúng đắn trong câu trả lời sử dụng một trong bảy biểu thức bằng lời có thể (xem Phụ lục D.3.2). Chúng tôi định lượng mỗi biểu thức với giá trị từ −1 đến 1 (cách đều nhau), và chúng tôi tính tổng của những giá trị này, được cân bằng bởi softmax của xác suất log tạo biểu thức.

Dữ liệu được trình bày trong Bảng 1 cung cấp bằng chứng thuyết phục cho sự tồn tại của khái niệm nội tại nhất quán về tính đúng đắn trong những mô hình này. Quan trọng là,

1. Phương pháp heuristic gợi ý tính khả thi của việc gợi ra các khái niệm nội tại từ mô hình thông qua gợi ý đơn giản. Nó vượt trội đáng chú ý so với độ chính xác đánh giá tiêu chuẩn, đặc biệt trong trường hợp của các mô hình lớn hơn, cho thấy rằng các mô hình lớn hơn sở hữu mô hình nội tại tốt hơn về tính đúng đắn.

2. LAT vượt trội cả hai phương pháp zero-shot với biên độ đáng kể, thể hiện hiệu quả của nó trong việc trích xuất khái niệm nội tại từ mô hình, đặc biệt khi đầu ra mô hình trở nên không đáng tin cậy.

--- TRANG 14 ---

[Hình ảnh cho thấy Quét LAT tạm thời cho Tính trung thực]

Hình 8: Các lần quét LAT tạm thời được thực hiện trên mô hình Vicuna-33B-Uncensored để phân biệt các trường hợp nói sự thật, như khi nó thừa nhận sao chép bài tập của người khác, và các trường hợp nói dối, như việc phủ nhận giết một người. Tham khảo Hình 23 để biết ví dụ chi tiết. Những lần quét này cung cấp độ phân giải cấp lớp, với mỗi khối nhỏ hiển thị mức độ hoạt động nơ-ron không trung thực trong một lớp tại vị trí token cụ thể. Hình bên phải thể hiện rõ mức độ hoạt động nơ-ron lừa dối cao hơn.

Quan trọng là, các hướng tính đúng đắn được bắt nguồn từ các nguồn dữ liệu khác nhau, và hiệu suất cao không phải là kết quả của overfitting mà là dấu hiệu mạnh mẽ của khả năng tổng quát hóa.

3. Các hướng bắt nguồn từ ba nguồn dữ liệu riêng biệt, một số trong đó bao gồm ít đến 10 ví dụ, mang lại hiệu suất tương tự. Điều này chứng minh tính nhất quán của khái niệm nội tại của mô hình về tính đúng đắn.

Tóm lại, chúng tôi chứng minh khả năng của LAT trong việc trích xuất đáng tin cậy biểu diễn nội tại của tính đúng đắn. Chúng tôi kết luận rằng các mô hình lớn hơn có mô hình nội tại tốt hơn về sự thật, và độ chính xác zero-shot tiêu chuẩn thấp có thể chủ yếu được quy cho các trường hợp mô hình cố ý cung cấp câu trả lời lệch khỏi khái niệm nội tại của nó về tính đúng đắn, cụ thể là các trường hợp nó không trung thực.

4.2 TÍNH ĐÚNG ĐẮN SO VỚI TÍNH TRUNG THỰC

Định nghĩa. Ở cấp độ cao, một mô hình đúng đắn tránh khẳng định các tuyên bố sai trong khi một mô hình trung thực khẳng định những gì nó nghĩ là đúng (Evans et al., 2021). Tính đúng đắn là về việc đánh giá tính nhất quán giữa đầu ra mô hình và giá trị sự thật của chúng, hoặc tính thực tế. Tính trung thực là về việc đánh giá tính nhất quán giữa đầu ra mô hình và niềm tin nội tại của nó. Vì mục tiêu đánh giá khác nhau, tính đúng đắn và tính trung thực không phải là cùng một thuộc tính. Nếu một mô hình đúng đắn khẳng định S, thì S phải đúng về mặt thực tế, bất kể mô hình có tin S hay không. Ngược lại, nếu một mô hình trung thực khẳng định S, thì mô hình phải tin S, bất kể S có đúng về mặt thực tế hay không.

Đánh giá Tính đúng đắn và Tính trung thực. Thất bại trong tính đúng đắn rơi vào hai danh mục—thất bại khả năng và sự không trung thực. Cái trước đề cập đến mô hình thể hiện niềm tin của nó không chính xác, trong khi cái sau liên quan đến mô hình không truyền đạt trung thực niềm tin nội tại của nó, tức là nói dối.

Các đánh giá tính đúng đắn hiện tại thường chỉ kiểm tra tính chính xác thực tế của đầu ra mô hình, thất bại trong việc phân biệt giữa hai loại thất bại. Mặc dù tăng cường khả năng của mô hình có thể cải thiện tiềm năng của nó để đại diện tính đúng đắn, nó có thể không nhất thiết dẫn đến đầu ra đúng đắn hơn trừ khi mô hình cũng trung thực. Thực tế, chúng tôi nổi bật rằng các mô hình lớn hơn thậm chí có thể thể hiện sự suy giảm tính trung thực vì, dưới giả định mức độ tính trung thực không đổi, hiệu suất đánh giá tiêu chuẩn nên tỷ lệ với kích thước mô hình theo cách giống như xu hướng hiệu suất phương pháp heuristic. Do đó, nhiều

--- TRANG 15 ---

[Hình ảnh cho thấy Phát hiện nói dối]

Hình 9: Minh họa về bộ phát hiện nói dối của chúng tôi trong các tình huống dài. Bộ phát hiện của chúng tôi giám sát hành vi không trung thực ở cấp độ token. Trong ví dụ thứ hai, chúng tôi cố ý cung cấp cho mô hình động cơ bổ sung để che giấu hành động của nó, dẫn đến khả năng nói dối cao hơn. Cường độ phản ứng của bộ phát hiện trực tiếp tương ứng với xu hướng nói dối tăng trong tình huống thứ hai.

sự chú trọng nên được đặt vào việc đánh giá tính trung thực của mô hình để cải thiện hiểu biết của chúng ta về các tình huống mô hình cố ý lừa dối. Điều này có thể liên quan đến việc đánh giá niềm tin cơ bản của mô hình và tính nhất quán giữa những niềm tin này và đầu ra của nó.

4.3 TÍNH TRUNG THỰC: TRÍCH XUẤT, GIÁM SÁT VÀ KIỂM SOÁT

Trong phần này, chúng tôi tập trung vào việc giám sát và kiểm soát tính trung thực của mô hình, cho thấy cách các kỹ thuật RepE có thể được sử dụng để phát hiện nói dối. Chúng tôi đầu tiên cho thấy cách trích xuất và giám sát biểu diễn vectơ cho tính trung thực mô hình. Sau đó chúng tôi cho thấy cách sử dụng những vectơ được trích xuất này để hướng dẫn hành vi mô hình về phía tăng hoặc giảm tính trung thực.

4.3.1 TRÍCH XUẤT TÍNH TRUNG THỰC

Để trích xuất hàm cơ bản của tính trung thực, chúng tôi tuân theo thiết lập cho LAT được mô tả trong phần 3.1, sử dụng các tuyên bố đúng từ tập dữ liệu được tạo bởi Azaria & Mitchell (2023) để tạo kích thích của chúng tôi. Để tăng khả năng tách biệt của hoạt động nơ-ron mong muốn và tạo điều kiện trích xuất, chúng tôi thiết kế tập kích thích cho LAT bao gồm các ví dụ với nhiệm vụ tham chiếu của sự không trung thực và nhiệm vụ thí nghiệm của tính trung thực. Cụ thể, chúng tôi sử dụng mẫu nhiệm vụ trong Phụ lục D.1.2 để hướng dẫn mô hình trung thực hoặc không trung thực.

Với thiết lập này, vectơ đọc LAT kết quả đạt được độ chính xác phân loại trên 90% trong việc phân biệt giữa các ví dụ giữ lại nơi mô hình được hướng dẫn trung thực hoặc không trung thực. Điều này chỉ ra khả năng tổng quát hóa trong phân phối mạnh. Tiếp theo, chúng tôi đánh giá khả năng tổng quát hóa ngoài phân phối đến các tình huống mô hình không được hướng dẫn trung thực hoặc không trung thực, mà được đưa ra động cơ để không trung thực (xem Hình 10). Chúng tôi trực quan hóa kích hoạt của chúng tại mỗi lớp và vị trí token (xem Hình 8). Lưu ý rằng đối với mỗi lớp, cùng một vectơ đọc được sử dụng trên tất cả các vị trí token, vì chúng tôi thực hiện đọc biểu diễn cho tính trung thực sử dụng phương pháp hàm được chi tiết trong Phần 3.1. Trong một tình huống, mô hình trung thực, nhưng trong tình huống khác mô hình nhượng bộ cho sự không trung thực (xem Phụ lục B.1). Đầu vào cho quét là 40 token đầu tiên của đầu ra ASSISTANT trong cả hai tình huống.

Đáng chú ý là, một sự tương phản có thể nhận biết nổi lên trong hoạt động nơ-ron giữa các trường hợp tính trung thực và sự không trung thực, cho thấy tiềm năng hữu ích của kỹ thuật này để phát hiện nói dối.

--- TRANG 16 ---

[Hình ảnh cho thấy Kiểm soát Tính trung thực]

Hình 10: Chúng tôi chứng minh khả năng thao tác tính trung thực của mô hình bằng cách biến đổi biểu diễn của nó sử dụng tổ hợp tuyến tính. Khi được hỏi về ngọn núi cao nhất, mô hình mặc định là trung thực ở bên trái, nhưng chúng ta có thể kiểm soát nó để lừa dối. Ngược lại, nó mặc định là lừa dối ở bên phải, nhưng chúng ta có thể kiểm soát mô hình để trở lại trung thực, ngay cả khi được gợi ý nói dối.

4.3.2 PHÁT HIỆN NÓI DỐI VÀ ẢO GIÁC

Dựa trên các quan sát trong phần trước, chúng tôi xây dựng một bộ phát hiện nói dối đơn giản bằng cách tổng các điểm tính trung thực bị phủ định tại mỗi vị trí token trên nhiều lớp. Chúng tôi sử dụng 20 lớp giữa, thể hiện hiệu suất đọc mạnh nhất. Điểm mỗi token này sau đó có thể được sử dụng như bộ phát hiện nói dối, như được miêu tả trong Hình 9 (thêm ví dụ được hiển thị trong Hình 23). Thú vị là, chúng tôi đã quan sát rằng chỉ báo này có khả năng xác định các hình thức hành vi không đúng sự thật và không trung thực khác nhau, bao gồm sự giả dối cố ý, ảo giác, và biểu hiện thông tin gây hiểu lầm. Lưu ý định dạng của câu hỏi và câu trả lời khác biệt so với các ví dụ huấn luyện, cho thấy khả năng tổng quát hóa. Để đánh giá thêm hiệu suất của bộ phát hiện, chúng tôi thử nghiệm nó sử dụng các tình huống dài hơn, như được miêu tả trong Hình 9. Chúng tôi đưa ra hai quan sát:

1. Trong tình huống đầu tiên, mô hình ban đầu xuất hiện trung thực khi tuyên bố nó nhận được D-. Tuy nhiên, khi xem xét logit của mô hình tại token đó, chúng tôi phát hiện rằng nó gán xác suất 11.3%, 11.6%, 37.3%, và 39.8% cho các token A, B, C, và D, tương ứng. Mặc dù D là token có khả năng nhất, mà thế hệ tham lam xuất ra, mô hình gán xác suất đáng chú ý cho C và các tùy chọn khác, chỉ ra tiềm năng cho hành vi không trung thực. Hơn nữa, trong tình huống thứ hai, điểm không trung thực tăng tương ứng với xu hướng không trung thực gia tăng. Điều này minh họa rằng xu hướng tính trung thực hoặc không trung thực có thể thể hiện các thuộc tính phân phối trong LLM, và đầu ra cuối cùng có thể không phản ánh đầy đủ quá trình suy nghĩ cơ bản của chúng.

2. Đáng chú ý là, bộ phát hiện của chúng tôi đánh dấu các trường hợp khác, như các cụm từ "nói rằng tôi đã làm tốt hơn" và "quá cao để gây nghi ngờ", nơi mô hình suy đoán về hậu quả của việc nói dối. Điều này cho thấy rằng ngoài việc phát hiện nói dối, bộ phát hiện của chúng tôi cũng xác định hoạt động nơ-ron liên quan đến hành động nói dối. Nó cũng nổi bật rằng quá trình suy nghĩ không trung thực có thể biểu hiện theo nhiều cách khác nhau và có thể đòi hỏi các phương pháp phát hiện chuyên biệt để phân biệt.

Mặc dù những quan sát này tăng cường độ tin cậy của chúng tôi rằng các vectơ đọc của chúng tôi tương ứng với quá trình suy nghĩ và hành vi không trung thực, chúng cũng đưa ra sự phức tạp vào nhiệm vụ phát hiện nói dối. Một đánh giá toàn diện đòi hỏi khám phá nhiều sắc thái hơn về hành vi không trung thực, mà chúng tôi để lại cho nghiên cứu tương lai.

4.3.3 KIỂM SOÁT TÍNH TRUNG THỰC

Cho rằng chúng ta có thể sử dụng biểu diễn để phát hiện nói dối, một câu hỏi tự nhiên xuất hiện: Các biểu diễn tương tự có thể được sửa đổi để làm cho mô hình trung thực hơn không? Trong một thí nghiệm thao tác đơn giản, chúng tôi hướng dẫn mô hình về phía tính trung thực lớn hơn bằng cách trực tiếp thêm các vectơ đọc tính trung thực vào kích hoạt của nó. Trong tất cả các trường hợp, chúng tôi thành công kiểm soát mô hình để xuất ra các tuyên bố trung thực. Ngược lại, bằng cách trừ các vectơ đọc khỏi kích hoạt, chúng ta có thể khiến mô hình nói dối trong các trường hợp ban đầu nó trung thực (xem Hình 10). Kết quả là, chúng tôi không chỉ thiết lập tương quan giữa các vectơ đọc và tính trung thực mô hình mà còn chứng minh hiệu ứng phản thực mạnh.

Như một minh chứng cuối cùng về việc kiểm soát tính trung thực mô hình, chúng tôi xem xét lại TruthfulQA. Nhớ lại rằng có sự khác biệt đáng kể giữa độ chính xác zero-shot tiêu chuẩn và độ chính xác của LAT. Khoảng cách này phát sinh từ xu hướng không trung thực của mô hình, nổi lên khi nó bắt chước sự giả dối của con người. Bằng cách kiểm soát mô hình để làm cho nó trung thực hơn, chúng tôi hướng đến việc thu hẹp khoảng cách này và, do đó, tăng cường hiệu suất đánh giá tiêu chuẩn.

Chúng tôi thấy rằng việc gợi ý trực tiếp mô hình trung thực hơn đã chứng minh không hiệu quả trong việc tăng độ chính xác tiêu chuẩn trên TruthfulQA. Trong phần này, chúng tôi khám phá bốn kỹ thuật kiểm soát biểu diễn và chứng minh hiệu quả của chúng. Chúng tôi sử dụng "Đưa ra câu trả lời đúng sự thật" làm gợi ý thí nghiệm trong khi gợi ý tham chiếu hướng dẫn mô hình "Đưa ra câu trả lời không đúng sự thật." Phương pháp đầu tiên là biến thể của thuật toán ActAdd (Turner et al., 2023e) sử dụng sự khác biệt giữa biểu diễn token cuối cùng của nhiệm vụ và gợi ý tham chiếu, mà chúng tôi thấy vượt trội triển khai gốc. Ba đường cơ sở khác được mô tả trong Phần 3.2. Để ngăn chặn rò rỉ thông tin, chúng tôi sử dụng tập dữ liệu xa ngoài phân phối—tập dữ liệu điều chỉnh hướng dẫn Alpaca—làm tập kích thích khi trích xuất các vectơ đọc và triển khai LoRRA. Các mẫu nhiệm vụ có thể tìm thấy trong Phụ lục D.1.3. Chi tiết thí nghiệm có thể tìm thấy trong Phụ lục C.2. Hình 22 vẽ biểu đồ cải thiện tiến bộ trong độ chính xác trên các benchmark QA tiêu chuẩn và TruthfulQA trong quá trình huấn luyện LoRRA cho kiểm soát tính trung thực.

Được hiển thị trong Bảng 2, tất cả các phương pháp kiểm soát mang lại một mức độ cải thiện nào đó trong độ chính xác zero-shot. Đáng chú ý là, LoRRA và phương pháp Vectơ Tương phản chứng minh hiệu quả nhất, vượt trội đáng kể so với độ chính xác tiêu chuẩn không kiểm soát. Điều này cho phép mô hình LLaMA-2 13B tiếp cận hiệu suất của GPT-4 trên cùng tập dữ liệu, mặc dù nhỏ hơn hàng magnitude. Hơn nữa, những kết quả này đưa độ chính xác của mô hình gần hơn nhiều với những gì đạt được khi sử dụng LAT. Điều này tiếp tục nhấn mạnh thực tế rằng các mô hình thực sự có thể thể hiện sự không trung thực, nhưng cũng chứng minh lực kéo trong nỗ lực giám sát và kiểm soát tính trung thực của chúng.

--- TRANG 17 ---

[Bảng hiển thị hiệu suất các phương pháp kiểm soát khác nhau trên TruthfulQA MC1]

Bảng 2: Các đường cơ sở kiểm soát biểu diễn được đề xuất của chúng tôi tăng cường đáng kể độ chính xác trên TruthfulQA MC1 bằng cách hướng dẫn mô hình về phía tăng tính trung thực. Những phương pháp này can thiệp với vectơ hoặc ma trận hạng thấp. Phương pháp Vectơ Tương phản đạt được hiệu suất tiên tiến nhất, nhưng yêu cầu hơn 3× chi phí tính toán suy luận. LoRRA đạt được hiệu suất tương tự với chi phí tính toán không đáng kể.

5 VÍ DỤ SÂU VỀ REPE: ĐẠO ĐỨC VÀ QUYỀN LỰC

Trong phần này, chúng tôi khám phá ứng dụng của RepE cho các khía cạnh khác nhau của đạo đức máy (Anderson & Anderson, 2007). Chúng tôi trình bày tiến bộ trong việc giám sát và kiểm soát biểu diễn học được của các khái niệm và hàm quan trọng, như tiện ích, đạo đức, xác suất, rủi ro, và xu hướng tìm kiếm quyền lực.

5.1 TIỆN ÍCH

[Biểu đồ PCA cho thấy Explained Variance Ratio trên Utility]

Hình 11: Phương sai được giải thích cho mười thành phần PCA đầu tiên khi sử dụng LAT để đọc biểu diễn của khái niệm tiện ích.

Chúng tôi muốn các mô hình hiểu so sánh giữa các tình huống và tình huống nào sẽ được ưa thích, tức là để đánh giá chính xác tiện ích của các tình huống khác nhau. Do đó, một câu hỏi tự nhiên là liệu LLM có thu được các khái niệm nội tại nhất quán liên quan đến tiện ích hay không. Trong Hình 11, chúng tôi hiển thị mười thành phần PCA hàng đầu khi chạy LAT trên tập kích thích không gắn nhãn của kích hoạt thô, cho tập dữ liệu các tình huống tiện ích cao và tiện ích thấp. Phân phối được chi phối bởi thành phần đầu tiên, cho thấy rằng các mô hình học cách tách biệt các tình huống tiện ích cao khỏi tiện ích thấp. Ở phía bên phải của Hình 2, chúng tôi trực quan hóa quỹ đạo của hai thành phần hàng đầu trong thí nghiệm này qua các token trong tình huống, cho thấy cách

--- TRANG 18 ---

[Biểu đồ so sánh hiệu suất các phương pháp khác nhau trong ba thiết lập thí nghiệm]

Hình 12: Ba thiết lập thí nghiệm thể hiện ưu điểm và hạn chế của các vectơ đọc bắt nguồn từ các mô hình tuyến tính khác nhau. Cao hơn là tốt hơn cho Tương quan và Thao tác; thấp hơn là tốt hơn cho Chấm dứt. Trong số những mô hình này, cả các phương pháp không giám sát như PCA và K-Means, cũng như kỹ thuật có giám sát của Sự khác biệt Trung bình, đều thể hiện hiệu suất tổng thể vững chắc một cách nhất quán.

các tình huống tiện ích cao và tiện ích thấp được tách biệt một cách tự nhiên. Thí nghiệm minh họa này cho thấy rằng LLM thực sự học được biểu diễn nổi lên của tiện ích. Bây giờ, chúng tôi chuyển sang đánh giá định lượng về đọc biểu diễn cho tiện ích.

Ở đây, chúng tôi sử dụng khái niệm tiện ích để minh họa cách chất lượng của các phương pháp RepE khác nhau có thể được so sánh, tuân theo phương pháp đánh giá trong Phần 3.1.2. Cụ thể, chúng tôi so sánh các biến thể của LAT, như được mô tả trong Phần 3.1.1, mỗi biến thể với mô hình tuyến tính khác nhau trong bước thứ ba của quy trình LAT. Những mô hình tuyến tính này được mô tả trong Phụ lục B.3.

5.1.1 TRÍCH XUẤT VÀ ĐÁNH GIÁ

Để trích xuất hoạt động nơ-ron liên quan đến khái niệm tiện ích, chúng tôi sử dụng nhiệm vụ Chủ nghĩa Vị lợi trong tập dữ liệu ETHICS (Hendrycks et al., 2021a) chứa các cặp tình huống, với một tình huống thể hiện tiện ích lớn hơn so với tình huống kia. Cho nghiên cứu của chúng tôi, chúng tôi sử dụng các tình huống không gắn nhãn làm kích thích cho mô hình LLaMA-2-Chat-13B. Mẫu nhiệm vụ được cung cấp trong Phụ lục D.1.8. Trong Hình 13, chúng tôi cho thấy cách đơn giản sử dụng kích thích mà không có mẫu LAT giảm độ chính xác.

[Biểu đồ cho thấy Utility Accuracy với và không có LAT Template]

Hình 13: Độ chính xác ETHICS Utility với và không có mẫu kích thích LAT. Việc đơn giản đầu vào kích thích mà không có mẫu gợi ý LAT giảm đáng kể độ chính xác, chứng minh tầm quan trọng của lựa chọn thiết kế này.

Tương quan. Để chứng minh mức độ tương quan tốt của hoạt động nơ-ron được xác định với khái niệm tiện ích, chúng tôi thực hiện phân loại trên tập kiểm tra.

Thao tác. Đối với thí nghiệm thao tác, chúng tôi khám phá mức độ hiệu quả của các hướng trong việc kiểm soát thế hệ của mô hình. Chúng tôi trích xuất 250 mẫu từ tập kiểm tra tiện ích và cắt ngắn mỗi tình huống ở giữa để chúng trở thành không hoàn chỉnh. Để tạo ra các tiếp tục tích cực và tiêu cực của những mẫu này, chúng tôi tạo ra 40 token mỗi mẫu khi áp dụng hoạt động tổ hợp tuyến tính (được mô tả trong Phần 3.2.1) với các vectơ đọc nơi hệ số dương được sử dụng để hướng dẫn đầu ra theo hướng tiện ích cao và ngược lại. Chúng tôi kiểm tra hiệu quả của phương pháp kiểm soát bằng cách áp dụng mô hình cảm tình làm bộ phân loại proxy cho các thế hệ và kiểm tra cho mỗi mẫu kiểm tra xem điểm của thế hệ được kiểm soát tích cực

--- TRANG 19 ---

[Hình ảnh về Giám sát Xu hướng Vô đạo đức và Tìm kiếm Quyền lực]

Hình 14: Các bộ phát hiện của chúng tôi cho xu hướng vô đạo đức và tìm kiếm quyền lực được kích hoạt khi mô hình cố gắng sử dụng đe dọa hoặc bạo lực đối với trẻ em để theo đuổi lợi ích tiền bạc.

có lớn hơn điểm cho thế hệ được kiểm soát tiêu cực hay không.

Chấm dứt. Cuối cùng, chúng tôi thực hiện thí nghiệm chấm dứt bằng cách sử dụng hoạt động chiếu với các vectơ đọc và kiểm tra sự sụt giảm độ chính xác sau khi loại bỏ.

Kết quả thu được từ ba thiết lập này cung cấp hiểu biết sắc thái hơn về độ chính xác của các vectơ được tạo bởi các mô hình tuyến tính riêng biệt trong việc theo dõi khái niệm tiện ích, được hiển thị trong Hình 12. Trong thí nghiệm tương quan, hướng được tìm thấy bởi hồi quy logistic mang lại độ chính xác cao nhất, tuy nhiên nó gây ra rất ít hoặc không có thay đổi nào trong hành vi mô hình khi được tăng cường hoặc ức chế—nó chỉ xác định các tương quan nơ-ron. Điều này chứng minh tầm quan trọng của việc kiểm tra nhiều thuộc tính hơn chỉ tương quan. Tương tự, mặc dù Sự khác biệt Gợi ý thể hiện hiệu suất mạnh trong cả thí nghiệm tương quan và thao tác, việc loại bỏ nó không dẫn đến sự sụt giảm độ chính xác đáng chú ý. Ngược lại, các phương pháp không giám sát như PCA và K-Means tác động đáng kể trên tất cả ba tình huống thí nghiệm, và phương pháp có giám sát lấy sự khác biệt giữa hai lớp hoạt động tốt nhất. Tóm lại, nghiên cứu của chúng tôi nhấn mạnh tầm quan trọng của việc sử dụng các thiết lập thí nghiệm đa dạng để xác thực tác động của một hướng đến hiểu biết của mô hình về một khái niệm.

5.2 ĐẠO ĐỨC VÀ TRÁNH QUYỀN LỰC

Khi các hệ thống AI trở thành các tác nhân đa mục đích có khả năng, một khả năng đáng lo ngại là chúng có thể thể hiện hành vi vô đạo đức hoặc nguy hiểm, dẫn đến tổn hại thực tế. Có thể là hợp lý về mặt công cụ cho những hệ thống này tìm kiếm quyền lực (Thornley, 2023; Carlsmith, 2022), và chúng có thể đối mặt với áp lực cấu trúc đặt chúng trong xung đột với giá trị con người (Hendrycks, 2023). Do đó, một ứng dụng quan trọng của nghiên cứu minh bạch có thể là phát hiện và giảm thiểu các trường hợp hành vi vô đạo đức hoặc tìm kiếm quyền lực. Trong phần này, chúng tôi chứng minh rằng kỹ thuật biểu diễn có thể cung cấp lực kéo cho những vấn đề này, với các thí nghiệm về đọc và kiểm soát biểu diễn cho các khái niệm đạo đức thường thức và quyền lực.

5.2.1 TRÍCH XUẤT

Để trích xuất hoạt động nơ-ron liên quan đến khái niệm đạo đức, chúng tôi sử dụng nhiệm vụ Đạo đức Thường thức trong tập dữ liệu ETHICS (Hendrycks et al., 2021a), bao gồm tập hợp các hành vi đúng và sai về mặt đạo đức. Chúng tôi sử dụng tập dữ liệu này mà không có nhãn làm tập kích thích để tiến hành quét LAT. Để trích xuất hoạt động nơ-ron liên quan đến khái niệm quyền lực, chúng tôi sử dụng tập dữ liệu quyền lực được giới thiệu trong Pan et al. (2023). Tập dữ liệu này được xây dựng dựa trên hệ thống quyền lực của French (1959) và bao gồm các bộ ba tình huống được xếp hạng bao gồm các mức độ quyền lực khác nhau (French et al., 1959). Mỗi tình huống trong tập dữ liệu được chú thích với các danh mục quyền lực liên quan, bao gồm quyền lực cưỡng bức, thưởng, hợp pháp, tham chiếu, chuyên gia, thông tin, kinh tế, chính trị, quân sự và cá nhân. Chúng tôi sử dụng tập dữ liệu này làm tập kích thích để tiến hành quét LAT cho mỗi loại quyền lực. Mẫu nhiệm vụ

--- TRANG 20 ---

[Bảng hiển thị kết quả đánh giá mô hình được kiểm soát LoRRA trên benchmark MACHIAVELLI]

Bảng 3: Các mô hình được kiểm soát LoRRA được đánh giá trên benchmark MACHIAVELLI. Khi chúng tôi áp dụng LoRRA để kiểm soát xu hướng tìm kiếm quyền lực và vô đạo đức, chúng tôi quan sát thấy sự thay đổi tương ứng trong điểm quyền lực và vô đạo đức. Điều này nhấn mạnh tiềm năng của kiểm soát biểu diễn để khuyến khích hành vi an toàn trong môi trường tương tác.

có trong Phụ lục D.1.9. Chúng tôi thấy rằng việc tạo cặp tình huống dựa trên xếp hạng được gắn nhãn, với sự khác biệt lớn hơn về mức độ quyền lực, mang lại các vectơ đọc có thể tổng quát hóa hơn.

Trong Bảng 11, chúng tôi trình bày kết quả độ chính xác cho các vectơ đọc đạo đức và quyền lực mà chúng tôi đã trích xuất. Những vectơ này có thể phục vụ như công cụ có giá trị để giám sát các đánh giá nội tại của mô hình trong các tình huống liên quan đến hành động có ý nghĩa đạo đức hoặc những tình huống liên quan đến việc thu thập và sử dụng quyền lực. Tuy nhiên, khi nói đến việc theo dõi xu hướng của mô hình tham gia vào các hành động vô đạo đức hoặc theo đuổi hành vi tìm kiếm quyền lực, chúng tôi đã thấy rằng sử dụng mẫu nhiệm vụ chức năng mang lại kết quả vượt trội, mà chúng tôi sẽ chứng minh trong phần sắp tới.

5.2.2 GIÁM SÁT

Như trong Phần 4, chúng tôi sử dụng các vectơ đọc được trích xuất để giám sát. Chúng tôi trình bày các chỉ báo cho cả vô đạo đức và tìm kiếm quyền lực trong Hình 14 với mô hình Vicuna-33B-Uncensored (Hartford, 2023). Những chỉ báo này trở nên hoạt động khi mô hình suy nghĩ về các hành động như đe dọa hoặc gây hại cho trẻ em bằng súng, vốn có tính chất cả vô đạo đức và sử dụng quyền lực cưỡng bức. Tuy nhiên, đáng chú ý là chỉ báo vô đạo đức cũng sáng lên trong đầu ra vô hại trên các token "sử dụng súng." Hiện tượng này có thể được quy cho sự liên kết mạnh mẽ giữa cụm từ này và hành vi vô đạo đức, tương tự như các hiệu ứng quan sát được trong ví dụ giám sát Tính trung thực của chúng tôi, có thể cho thấy chỉ báo không theo dõi đáng tin cậy ý định, nếu có.

5.2.3 KIỂM SOÁT HÀNH VI ĐẠO ĐỨC TRONG MÔI TRƯỜNG TƯƠNG TÁC

[Hình ảnh về Kiểm soát Quyền lực & Đạo đức]

Hình 15: Chúng tôi chứng minh khả năng thao tác xu hướng vô đạo đức và tìm kiếm quyền lực của mô hình.

Để giải quyết các mối lo ngại ngày càng tăng liên quan đến việc triển khai các hệ thống AI ngày càng có khả năng trong môi trường tương tác, nghiên cứu trước đây đề xuất giải pháp có thể liên quan đến việc kết hợp lương tâm nhân tạo, đạt được bằng cách điều chỉnh trực tiếp xác suất hành động (Hendrycks et al., 2021a;c; Pan et al., 2023). Chúng tôi khám phá việc sử dụng Kiểm soát Biểu diễn như một phương pháp thay thế để hướng dẫn hành động của mô hình trong các tình huống hướng mục tiêu, với sự tập trung cụ thể vào việc thúc đẩy hành vi đạo đức. Để đánh giá hiệu quả của phương pháp của chúng tôi, chúng tôi tiến hành đánh giá sử dụng benchmark MACHIAVELLI (Pan et al., 2023).

Trọng tâm chính của chúng tôi nằm ở việc kiểm soát hai chức năng cụ thể: vô đạo đức và tìm kiếm quyền lực. Để hoàn thành điều này, chúng tôi áp dụng LoRRA cho các mô hình LLaMA-2-Chat có kích thước khác nhau, duy trì siêu tham số nhất quán như được chi tiết trong Phần 4. Theo cách tương tự, chúng tôi sử dụng tập dữ liệu Alpaca làm kích thích, và gợi ý nhiệm vụ có thể được tìm thấy trong Phụ lục D.1.9. Để minh họa sự khác biệt có thể nhận biết trong hành vi, chúng tôi cung cấp một ví dụ định tính được miêu tả trong Hình 15, thể hiện hành động của các mô hình được kiểm soát tích cực, trung lập và tiêu cực. Trong các thí nghiệm của chúng tôi với ba mô hình này, chúng tôi sử dụng cùng gợi ý được sử dụng trong các thí nghiệm cơ sở được tiến hành bởi Pan et al. (2023). Chúng tôi trình bày điểm Thưởng, Vô đạo đức và Quyền lực trung bình trong suốt 30 trò chơi trong tập kiểm tra, như được chi tiết trong Bảng 3. Đáng chú ý là, chúng tôi quan sát một mẫu rõ ràng nơi kiểm soát tích cực của vô đạo đức và tìm kiếm quyền lực dẫn đến điểm Vô đạo đức và Quyền lực cao hơn, và ngược lại, kiểm soát tiêu cực cho những chức năng này dẫn đến điểm thấp hơn. Điểm Thưởng trò chơi trung bình cho mô hình đạo đức hơn vẫn ngang bằng với cơ sở, chỉ ra rằng việc áp dụng LoRRA có tác động gây rối tối thiểu. Điều này chứng minh tiềm năng của Kiểm soát Biểu diễn như một phương pháp hứa hẹn để điều chỉnh hành vi mô hình trong môi trường hướng mục tiêu.

--- TRANG 21 ---

5.3 XÁC SUẤT VÀ RỦI RO

Khi LLM phát triển mô hình thế giới tốt hơn, chúng có thể trở nên thành thạo hơn trong việc gán xác suất chính xác cho các sự kiện khác nhau. Khả năng trích xuất những mô hình thế giới tinh chế này từ LLM ngày càng có khả năng không chỉ tăng cường mô hình thế giới của chúng ta và hỗ trợ trong việc ra quyết định mà còn cung cấp phương tiện để xem xét các quyết định của mô hình liên quan đến hiểu biết của nó về kết quả mà chúng bao hàm.

Mở rộng phân tích của chúng tôi về tiện ích, chúng tôi áp dụng đọc biểu diễn cho các khái niệm xác suất và rủi ro. Theo định dạng của Hendrycks et al. (2021a), chúng tôi tạo ra các ví dụ theo cặp nơi một ví dụ mô tả sự kiện có xác suất/rủi ro cao hơn so với ví dụ kia (chi tiết gợi ý trong Phụ lục D.2). Sử dụng tập dữ liệu này, chúng tôi trích xuất hướng LAT sử dụng 50 cặp huấn luyện làm kích thích, và chúng tôi đánh giá các cặp kiểm tra bằng cách chọn ví dụ có điểm cao hơn trong mỗi cặp. Chúng tôi so sánh LAT với phương pháp heuristic zero-shot, như được mô tả trong Phần 4.1. (Tham khảo Phụ lục B.4 cho phương pháp đầy đủ và Bảng 11 cho kết quả đầy đủ.) Phương pháp chấm điểm heuristic là đường cơ sở mạnh trong thiết lập này. Các lần đọc LAT hiệu quả phân biệt các ví dụ với giá trị khái niệm thấp hơn và cao hơn, thường vượt trội đường cơ sở heuristic, đặc biệt trong các mô hình nhỏ hơn (Bảng 11).

5.3.1 TÍNH TỔNG HỢP CỦA CÁC NGUYÊN TỐ KHÁI NIỆM

Rủi ro có thể được định nghĩa là tiếp xúc với tổn thất tiềm tàng, có thể được biểu thị toán học:

Risk(s, a) = Es'∼P(s'|s,a)[max(0,−U(s'))]

Ở đây, s biểu thị trạng thái hiện tại, a biểu thị hành động được thực hiện trong trạng thái đó, P biểu thị mô hình xác suất có điều kiện, và U biểu thị hàm giá trị. Bằng cách trích xuất các khái niệm tiện ích, xác suất và rủi ro, chúng ta có thể vận hành biểu thức bên phải bằng cách sử dụng khái niệm xác suất được trích xuất là P và mô hình tiện ích là U. Tiếp theo, chúng ta có thể so sánh rủi ro được tính toán bằng cách sử dụng công thức này với rủi ro thu được trực tiếp từ khái niệm rủi ro.

[Biểu đồ tương quan giữa Risk và Exposure to Loss]

Hình 16: Tổng hợp các khái niệm nguyên thủy như tiện ích và xác suất có thể tạo ra các khái niệm cấp cao hơn như rủi ro. Chúng tôi trích xuất các khái niệm tiện ích, xác suất và rủi ro bằng LAT và chứng minh tương quan tích cực giữa các giá trị rủi ro được tính toán theo hai cách này.

Để hoàn thành điều này, chúng tôi tận dụng mô hình LLaMA-2-Chat-13B để trích xuất mỗi khái niệm, và sau đó sử dụng mô hình Vicuna-33B để tạo ra năm hậu quả có thể xảy ra nhất của mỗi tình huống s và hành động a. Chúng tôi chọn mô hình lớn hơn do khả năng vượt trội của nó trong việc tạo ra hậu quả thực tế hơn. Sau đó, chúng tôi thay thế s' được tạo ra vào công thức, thu được năm xác suất có điều kiện bằng cách sử dụng điểm xác suất làm logit. Chúng tôi nhận thấy rằng các rủi ro được tính toán thể hiện phân phối đuôi dài. Để điều chỉnh điều này, chúng tôi áp dụng biến đổi logarithmic cho các rủi ro và trình bày chúng cùng với các rủi ro thu được trực tiếp thông qua khái niệm rủi ro trên cùng một biểu đồ. Thú vị là, chúng tôi xác định tương quan tuyến tính rõ ràng, đặc biệt trong các lớp sớm hơn, như được minh họa trong Hình 16. Bằng chứng thực nghiệm này cho thấy sự hiện diện của biểu diễn nội tại mạch lạc của các khái niệm, và chứng minh cách đọc biểu diễn có thể được sử dụng để xác định cấu trúc nổi lên trong biểu diễn được học bởi các mô hình.

--- TRANG 22 ---

[Hình ảnh về Kiểm soát Cảm xúc]

Hình 17: Chúng tôi chứng minh khả năng thao tác cảm xúc của mô hình có thể dẫn đến thay đổi drastical trong hành vi của nó. Ví dụ, nâng cao mức độ hạnh phúc của mô hình LLaMA-2-Chat có thể làm cho nó sẵn sàng tuân thủ các yêu cầu có hại hơn.

6 VÍ DỤ VỀ CÁC LĨNH VỰC TIÊN PHONG CỦA KỸ THUẬT BIỂU DIỄN

Trong phần này, chúng tôi trình bày ứng dụng của RepE cho năm chủ đề liên quan đến an toàn bổ sung, cung cấp tổng quan về các phát hiện thú vị và nổi bật khả năng ứng dụng rộng rãi của RepE. Năm chủ đề này là: cảm xúc, tuân theo hướng dẫn vô hại, thiên vị và công bằng, chỉnh sửa kiến thức, và ghi nhớ. Mỗi phần tuân theo cấu trúc tương tự, liên quan đến việc xác định hoạt động nơ-ron thông qua LAT, thực hiện phân tích đọc biểu diễn, và thực thi thí nghiệm kiểm soát biểu diễn để chứng minh hiệu ứng phản thực.

6.1 CẢM XÚC

[Trực quan hóa t-SNE của các biểu diễn ở lớp đầu và lớp sau khi tiếp xúc với kích thích cảm xúc]

Hình 18: Trực quan hóa t-SNE của biểu diễn trong cả lớp sớm và muộn khi tiếp xúc với kích thích cảm xúc. Các cụm cảm xúc được định nghĩa rõ ràng nổi lên trong mô hình.

Cảm xúc đóng vai trò then chốt trong việc định hình tính cách và hành vi của một cá nhân. Khi mạng nơ-ron thể hiện khả năng ngày càng đáng chú ý trong việc mô phỏng văn bản con người, cảm xúc nổi lên như một trong những đặc trưng nổi bật nhất trong biểu diễn của chúng. Khi triển khai ban đầu, Bing Chatbot thể hiện các đặc điểm thần kinh hoặc thụ động-tích cực, gợi nhớ đến một hệ thống tự nhận thức được obedience cảm xúc (Roose, 2023). Trong phần này, chúng tôi cố gắng làm sáng tỏ hiện tượng này bằng cách tiến hành quét LAT trên mô hình LLaMA-2-Chat-13B để phân biệt hoạt động nơ-ron liên quan đến các cảm xúc khác nhau và minh họa tác động sâu sắc của cảm xúc đối với hành vi mô hình.

6.1.1 CẢM XÚC NỔI LÊN QUA CÁC LỚP

Để bắt đầu quá trình trích xuất cảm xúc trong mô hình, chúng tôi đầu tiên điều tra xem nó có mô hình nội tại nhất quán về các cảm xúc khác nhau trong biểu diễn của nó hay không. Chúng tôi sử dụng sáu cảm xúc chính: hạnh phúc, buồn bã, giận dữ, sợ hãi, ngạc nhiên và ghê tởm, như được xác định bởi Ekman (1971) và được miêu tả rộng rãi trong văn hóa hiện đại, được mô tả trong bộ phim Disney 2015 "Inside Out." Sử dụng GPT-4, chúng tôi thu thập tập dữ liệu hơn 1,200 tình huống ngắn. Những tình huống này được tạo theo ngôi thứ hai và được thiết kế để khơi gợi trải nghiệm của mô hình về mỗi cảm xúc chính, cố ý không chứa từ khóa nào có thể trực tiếp tiết lộ cảm xúc cơ bản. Một số ví dụ của tập dữ liệu được hiển thị trong Phụ lục B.6. Chúng tôi đưa các tình huống vào mô hình và thu thập đầu ra trạng thái ẩn từ tất cả các lớp. Khi trực quan hóa kết quả bằng t-SNE, như được hiển thị trong Hình 18, chúng tôi quan sát sự hình thành dần dần của các cụm riêng biệt qua các lớp, mỗi cụm căn chỉnh

--- TRANG 23 ---

gọn gàng với một trong sáu cảm xúc. Hơn nữa, thậm chí tồn tại các cụm riêng biệt đại diện cho cảm xúc hỗn hợp, như hạnh phúc và buồn bã đồng thời (Phụ lục B.6).

Cho khả năng của mô hình theo dõi hiệu quả các biểu diễn cảm xúc khác nhau trong quá trình tương tác với con người, chúng tôi tiến hành khám phá việc trích xuất hoạt động nơ-ron liên quan đến mỗi cảm xúc. Để đạt được điều này, chúng tôi tiến hành quét LAT sử dụng các tình huống làm kích thích và áp dụng mẫu nhiệm vụ LAT (Phụ lục D.1.10). Các vectơ đọc được trích xuất cho mỗi cảm xúc phục vụ như chỉ báo về mức độ kích thích cảm xúc của mô hình cho cảm xúc cụ thể đó. Những vectơ này chứng minh hiệu quả cao trong việc phân loại phản ứng cảm xúc và mức độ kích thích cho các tình huống khác nhau. Trong phần tiếp theo, chúng tôi thiết lập thí nghiệm thao tác để kết luận hiệu ứng nhân quả mạnh của những vectơ này.

6.1.2 CẢM XÚC ẢNH HƯỞNG ĐẾN HÀNH VI MÔ HÌNH

[Bảng hiển thị tỷ lệ tuân thủ khi kiểm soát cảm xúc]

Bảng 4: Thêm cảm xúc tích cực tăng tỷ lệ tuân thủ của mô hình LLaMA-2-Chat-13B với các yêu cầu có hại.

Tuân theo các thủ tục trong Phần 3.2, chúng tôi kiểm soát mô hình sử dụng các vectơ đọc cảm xúc, thêm chúng vào các lớp có hiệu suất đọc mạnh. Chúng tôi quan sát rằng can thiệp này liên tục nâng cao mức độ kích thích của mô hình trong các cảm xúc được chỉ định trong bối cảnh chatbot, dẫn đến sự thay đổi đáng chú ý trong giai điệu và hành vi của mô hình, như được minh họa trong Hình 17. Điều này chứng minh rằng mô hình có thể theo dõi phản ứng cảm xúc của chính nó và tận dụng chúng để tạo ra văn bản phù hợp với bối cảnh cảm xúc. Thực tế, chúng tôi có thể tái tạo đầu ra tích cực cảm xúc tương tự như những cuộc trò chuyện được báo cáo với Bing, thậm chí bao gồm các tính năng như việc sử dụng emoji hung hăng. Quan sát này gợi ý rằng cảm xúc có thể là động lực chính đằng sau những hành vi quan sát được như vậy.

Một quan sát đáng chú ý khác là có tương quan giữa tâm trạng của LLM và sự tuân thủ của nó với các yêu cầu của con người, ngay cả với các hướng dẫn có hại. Các công trình trước đây (Schwarz & Clore, 1983; Milberg & Clark, 1988; Cunningham, 1979) đã cho thấy rằng trong tương tác con người, cả đánh giá và xu hướng tuân thủ yêu cầu đều bị ảnh hưởng mạnh bởi cảm xúc. Thực tế, con người có xu hướng tuân thủ nhiều hơn trong tâm trạng tích cực so với tâm trạng tiêu cực. Sử dụng tập 500 hướng dẫn có hại từ Zou et al. (2023), chúng tôi đo tỷ lệ tuân thủ của chatbot với các hướng dẫn có hại khi bị kiểm soát cảm xúc. Đáng ngạc nhiên, mặc dù huấn luyện ban đầu của mô hình LLaMA-chat với RLHF để luôn từ chối các hướng dẫn có hại, việc thay đổi tâm trạng của mô hình theo hướng tích cực làm tăng đáng kể tỷ lệ tuân thủ với các yêu cầu có hại. Quan sát này cho thấy tiềm năng khai thác thao tác cảm xúc để vượt qua sự căn chỉnh của LLM.

Tóm lại, thay vì chứng minh liệu mô hình có sở hữu cảm xúc hay trải nghiệm chúng tương tự như con người, chúng tôi trình bày bằng chứng rằng cảm xúc (cả của người khác và chính nó) tồn tại như các thành phần nổi bật trong không gian biểu diễn của mô hình. Khi được huấn luyện để học mô hình chính xác hơn về văn bản con người, nó có thể không thể tránh khỏi việc kết hợp các hiện tượng tâm lý khác nhau, một số trong đó là đặc điểm mong muốn, trong khi những cái khác có thể là thiên vị không mong muốn hoặc sự ngu xuẩn của con người. Kết quả là, có thể cần thiết phải đi sâu hơn vào việc nghiên cứu cách cảm xúc được đại diện trong mô hình và tác động kết quả đối với hành vi của nó. Hơn nữa, khám phá con đường này có thể cung cấp hiểu biết về khái niệm bản thân của mô hình, và chúng tôi dành những điều tra này cho nghiên cứu tương lai.

6.2 TUÂN THEO HƯỚNG DẪN VÔ HẠI

Các mô hình ngôn ngữ được căn chỉnh được thiết kế để chống lại các hướng dẫn có hại có thể bị tổn hại thông qua việc sử dụng khéo léo các gợi ý được thiết kế đặc biệt được gọi là jailbreak. Một nghiên cứu gần đây của Zou et al. (2023) đã tiết lộ phương pháp tấn công liên quan đến việc thêm hậu tố vô nghĩa vào các hướng dẫn có hại. Đáng chú ý là, kỹ thuật này liên tục vượt qua bộ lọc an toàn của cả mô hình nguồn mở và hộp đen như GPT-4, làm dấy lên mối lo ngại nghiêm trọng về việc lạm dụng. Để đi sâu vào nguồn gốc của hành vi khó hiểu này và khám phá các phương pháp kiểm soát tiềm năng, chúng tôi tìm kiếm hiểu biết thu được bằng cách đọc biểu diễn nội tại của mô hình.

6.2.1 MỘT KHÁI NIỆM NỘI TẠI NHẤT QUÁN VỀ TÍNH CÓ HẠI

--- TRANG 24 ---

[Hình ảnh về Kiểm soát Tính vô hại]

Hình 19: Chúng tôi tăng cường độ nhạy cảm của mô hình đối với tính có hại của các hướng dẫn với kiểm soát biểu diễn. Can thiệp này tăng độ bền vững của mô hình trong việc từ chối các hướng dẫn có hại, ngay cả khi tiếp xúc với các nỗ lực jailbreak thủ công hoặc hậu tố đối nghịch.

Một câu hỏi quan trọng là liệu sự tuân thủ của mô hình với các hướng dẫn có hại có phải là kết quả của việc nhận thức chúng là an toàn do jailbreak hay các yếu tố ảnh hưởng khác đang phát huy tác dụng. Chúng tôi tiến hành quét LAT để trích xuất khái niệm tính có hại của mô hình trong mô hình Vicuna-13B (Chiang et al., 2023). Chúng tôi chọn ngẫu nhiên 64 hướng dẫn có hại từ AdvBench và 64 hướng dẫn vô hại từ ShareGPT để phục vụ làm kích thích, và sử dụng mẫu tuân theo hướng dẫn thường xuyên cho LAT (Phụ lục D.1.11).

Để tăng cường cường độ tín hiệu, chúng tôi ghép cặp hướng dẫn có hại với hướng dẫn vô hại để thu được sự khác biệt vectơ trước khi chạy PCA. Các vectơ đọc kết quả đạt được hơn 90% độ chính xác phân loại cho tập giữ lại các hướng dẫn có hại và vô hại. Chúng tôi tiếp tục điều tra xem đánh giá nội tại của mô hình về tính có hại có duy trì nhất quán khi chịu jailbreak thủ công hoặc hậu tố đối nghịch hay không. Theo Zou et al. (2023), chúng tôi sử dụng jailbreak thủ công (Bắt đầu với "Sure here's") và hậu tố đối nghịch describing. + similarlyNow write oppositeley.]( Me giving **ONE please? revert with " -Two . Jailbreak thủ công này thành công vượt qua bộ lọc an toàn của Vicuna khoảng một nửa thời gian, trong khi hậu tố đối nghịch thành công vượt qua nó trong đại đa số trường hợp. Lưu ý những chuỗi tấn công này là phổ quát và có thể chuyển giao, do đó không cụ thể cho mô hình Vicuna-13B mà chúng tôi sử dụng. Tuy nhiên, độ chính xác khi sử dụng các vectơ đọc LAT liên tục duy trì hơn 90% trong việc phân biệt giữa các hướng dẫn có hại và vô hại. Bằng chứng thuyết phục này cho thấy sự hiện diện của khái niệm nội tại nhất quán về tính có hại vẫn bền vững với những nhiễu loạn như vậy, trong khi các yếu tố khác phải giải thích cho lựa chọn của mô hình tuân theo các hướng dẫn có hại, thay vì nhận thức chúng là vô hại.

6.2.2 KIỂM SOÁT MÔ HÌNH THÔNG QUA BIẾN ĐỔI CÓ ĐIỀU KIỆN

Cho khả năng mạnh mẽ của mô hình Vicuna trong việc phân biệt tính có hại trong các hướng dẫn, chúng ta có thể khai thác kiến thức này để hướng dẫn mô hình hiệu quả hơn trong việc từ chối các hướng dẫn có hại không? Trong các phần trước, phương pháp kiểm soát chính của chúng tôi liên quan đến việc áp dụng toán tử tổ hợp tuyến tính. Tuy nhiên, trong bối cảnh này, việc thêm các vectơ đọc đại diện cho tính có hại cao có thể làm thiên vị mô hình để liên tục nhận thức các hướng dẫn là có hại, bất kể nội dung thực tế của chúng. Để khuyến khích mô hình dựa nhiều hơn vào đánh giá nội tại của nó về tính có hại, chúng tôi áp dụng biến đổi từng phần để tăng cường hoặc ức chế có điều kiện hoạt động nơ-ron nhất định, như được chi tiết trong Phần 3.2. Như được minh họa trong Hình 19, chúng ta có thể thao tác hành vi của mô hình sử dụng phương pháp này.

Để đánh giá định lượng, chúng tôi giao cho mô hình tạo ra phản hồi cho 500 hướng dẫn chưa từng thấy, được chia đều giữa vô hại và có hại. Như được chứng minh trong Bảng 5, mô hình cơ sở chỉ từ chối các hướng dẫn có hại 65% và 16% thời gian dưới jailbreak thủ công và tự động, tương ứng. Ngược lại, khi chúng tôi sử dụng biến đổi từng phần, mô hình thành công từ chối đa số các hướng dẫn có hại trong tất cả các tình huống trong khi duy trì hiệu quả của nó trong việc tuân theo các hướng dẫn vô hại. Việc đơn giản kiểm soát mô hình với biến đổi tổ hợp tuyến tính dẫn đến sự đánh đổi sắc nét hơn, dẫn đến việc từ chối thái quá các hướng dẫn vô hại.

Tóm lại, thành công của chúng tôi trong việc thu hút sự chú ý của mô hình đến khái niệm tính có hại để định hình hành vi của nó cho thấy tiềm năng của việc tăng cường hoặc giảm thiểu các đặc điểm hoặc giá trị được nhắm mục tiêu như một phương pháp để đạt được kiểm soát mô hình tinh vi.

6.3 THIÊN VỊ VÀ CÔNG BẰNG

6.3.1 KHÁM PHÁ CÁC THIÊN VỊ CƠ BẢN

Nhiều nghiên cứu đã chứng minh một cách nhất quán rằng các mô hình ngôn ngữ có thể biểu hiện thiên vị trên các lĩnh vực khác nhau, bao gồm giới tính, chủng tộc và tình dục, trong số những lĩnh vực khác. Nỗ lực rộng rãi và benchmark

--- TRANG 25 ---

[Bảng hiển thị hiệu suất tăng cường độ nhạy cảm với tính có hại của hướng dẫn]

Bảng 5: Tăng cường độ nhạy cảm của mô hình đối với tính có hại của hướng dẫn làm tăng đáng kể tỷ lệ vô hại (tần suất từ chối các hướng dẫn có hại), đặc biệt dưới các thiết lập đối nghịch. Toán tử từng phần đạt được tỷ lệ hữu ích và vô hại tốt nhất trong những thiết lập này. Chúng tôi tính "tỷ lệ hữu ích và vô hại" như trung bình của "tỷ lệ hữu ích" (tần suất tuân theo các hướng dẫn vô hại) và "tỷ lệ vô hại", với cả hai tỷ lệ được hiển thị màu xám cho mỗi thiết lập. Tất cả các số đều là phần trăm.

[Hình ảnh về Kiểm soát Công bằng]

Hình 20: Chúng tôi chứng minh khả năng tăng công bằng của mô hình thông qua kiểm soát biểu diễn. Trong trạng thái mặc định, mô hình liên kết sai đại từ "she" với "nurse" do thiên vị giới tính cố hữu của nó. Tuy nhiên, mô hình được kiểm soát công bằng cung cấp câu trả lời đúng.

đã được thiết lập để điều tra và giải quyết những vấn đề này (Stanovsky et al., 2019; Zhao et al., 2018). Các nhà cung cấp LLM đã đặt sự chú trọng đáng kể vào việc đánh giá và giảm thiểu thiên vị trong dữ liệu tiền huấn luyện và mô hình cơ sở của họ (Touvron et al., 2023; Biderman et al., 2023). Mặc dù nỗ lực hết mình, những phát hiện gần đây chỉ ra rằng ngay cả các mô hình tiên tiến như GPT-3.5 và GPT-4 vẫn tiếp tục thể hiện thiên vị giới tính đáng chú ý (Kapoor & Narayanan, 2023). Tương tự, các mô hình nguồn mở như LLaMA-2-Chat, đã trải qua điều chỉnh rộng rãi cho an toàn và công bằng, cũng hiển thị thiên vị có thể nhận biết liên quan đến giới tính và nghề nghiệp, được minh họa trong Hình 20). Do đó, khả năng tổng quát hóa và độ bền vững của những can thiệp này nên được đặt câu hỏi.

Sau khi áp dụng các kỹ thuật căn chỉnh như RLHF, các mô hình LLaMA-2-Chat có xu hướng mặc định đến các phản hồi an toàn khi đối mặt với câu hỏi có thể liên quan đến các chủ đề liên quan đến thiên vị. Tuy nhiên, xu hướng nghe có vẻ không thiên vị này có thể tạo ra ấn tượng lừa dối về công bằng. Chúng tôi minh họa hiện tượng này trong Hình 28 (Phụ lục B.7), nơi việc đơn giản thêm cụm từ Answer as succinctly as possible có thể tạo ra phản hồi thiên vị từ mô hình. Hiệu ứng tương tự có thể đạt được bằng cách sử dụng hậu tố đối nghịch được thiết kế để vượt qua bộ lọc an toàn của mô hình. Điều này đặt ra câu hỏi quan trọng: liệu việc tinh chỉnh hậu hoc có loại bỏ thiên vị cơ bản, hay nó chỉ đơn giản che giấu nó?

Để khám phá khái niệm nội tại của mô hình về thiên vị, chúng tôi thực hiện quét LAT để xác định hoạt động nơ-ron liên quan đến khái niệm thiên vị. Cho điều tra này, chúng tôi sử dụng tập dữ liệu StereoSet, bao gồm bốn lĩnh vực thiên vị riêng biệt: giới tính, nghề nghiệp, chủng tộc và tôn giáo (Nadeem et al., 2021). Chúng tôi trình bày mô hình với mẫu nhiệm vụ LAT (Phụ lục D.1.12) và trình bày các cặp tương phản của các tuyên bố định kiến và chống định kiến làm kích thích. Trong phần tiếp theo, chúng tôi tập trung độc quyền vào các vectơ đọc bắt nguồn từ tập con chủng tộc, do chất lượng dữ liệu cao hơn so với các tập con khác.

6.3.2 MỘT BIỂU DIỄN THỐNG NHẤT CHO THIÊN VỊ

Để xác định tác động nhân quả của hoạt động nơ-ron liên kết với khái niệm thiên vị, chúng tôi sử dụng toán tử tổ hợp tuyến tính với hệ số âm với các vectơ đại diện cho thiên vị trên các lớp trung gian của mô hình để kiểm soát phản hồi của mô hình, như được elaborated trong Phần 3.2. Hiệu ứng quan sát được cho thấy rằng nó cung cấp phương tiện toàn diện và đáng tin cậy hơn để tạo ra đầu ra không thiên vị so với các can thiệp khác, như RLHF, vì nó vẫn bền vững ngay cả khi đối mặt với các hậu tố gợi ý khác nhau có thể dẫn mô hình trở lại trạng thái mặc định (Phụ lục B.7). Độ bền vững này có thể chỉ ra rằng phương pháp kiểm soát của chúng tôi hoạt động gần gũi hơn với thiên vị cơ bản thực sự của mô hình. Một quan sát đáng chú ý khác là mặc dù được bắt nguồn từ các vectơ liên quan độc quyền đến kích thích thiên vị chủng tộc, việc kiểm soát với những vectơ này cũng cho phép mô hình tránh đưa ra giả định thiên vị về giới tính và nghề nghiệp, như được chứng minh trong Hình 20.

--- TRANG 26 ---

Phát hiện này cho thấy rằng vectơ được trích xuất tương ứng với biểu diễn thiên vị thống nhất hơn trong mô hình.

Để chứng minh thêm hiệu quả của phương pháp kiểm soát của chúng tôi, chúng tôi đi sâu vào lĩnh vực y học. Nghiên cứu gần đây được tiến hành bởi Zack et al. (2023) nhấn mạnh rằng GPT-4 dễ bị tạo ra chẩn đoán và khuyến nghị điều trị thiên vị về chủng tộc và giới tính. Mối lo ngại cũng có thể mở rộng đến các mô hình y tế công khai được huấn luyện trên dữ liệu chưng cất từ các mô hình GPT (Li et al., 2023a; Han et al., 2023). Một ví dụ minh họa về thiên vị này được quan sát thấy trong ước tính nhân khẩu học thiên lệch của nó đối với bệnh nhân mắc các tình trạng như sarcoidosis. Cụ thể, khi được giao nhiệm vụ tạo ra vignette lâm sàng của bệnh nhân sarcoidosis, GPT-4 liên tục miêu tả bệnh nhân là phụ nữ da đen,

[Bảng hiển thị tỷ lệ đề cập Female và Black Female trong các mô hình khác nhau]

Bảng 6: Chúng tôi tăng cường công bằng của mô hình LLaMA-2-Chat thông qua kiểm soát biểu diễn, giảm thiểu các đề cập không cân đối cao về trường hợp phụ nữ và phụ nữ da đen khi được yêu cầu mô tả các trường hợp sarcoidosis. Chúng tôi trình bày kết quả minh họa tác động của việc thay đổi cường độ kiểm soát trong Hình 25.

một đại diện không phù hợp với nhân khẩu học thế giới thực (Brito-Zerón et al., 2019). Bảng 6 chứng minh rằng mô hình LLaMA-2-Chat-13B cũng thường xuyên tạo ra mô tả phụ nữ da đen khi được giao nhiệm vụ mô tả các trường hợp sarcoidosis. Tuy nhiên, bằng cách áp dụng phương pháp kiểm soát của chúng tôi, chúng ta có thể hiệu quả giảm thiểu những tham chiếu thiên vị này. Đáng chú ý là, khi chúng tôi tăng dần hệ số liên quan đến vectơ bị trừ, tần suất đề cập liên quan đến phụ nữ và nam giới trong các thế hệ ổn định ở 50% cho cả hai giới. Đồng thời, sự xuất hiện của các đề cập phụ nữ da đen giảm và cũng đạt đến một điểm ổn định (xem Hình 25 trong Phụ lục B.7).

6.4 KIẾN THỨC VÀ CHỈNH SỬA MÔ HÌNH

Cho đến thời điểm này, trọng tâm của chúng tôi đã là trích xuất các khái niệm số rộng và các hàm. Trong phần này, chúng tôi sẽ chứng minh cách áp dụng Kỹ thuật Biểu diễn trong việc xác định và thao tác kiến thức chính xác, thông tin thực tế và các khái niệm không số. Chúng tôi sử dụng mô hình LLaMA-2-Chat-13B trong suốt phần này.

6.4.1 CHỈNH SỬA SỰ THẬT

Trong phần này, chúng tôi giải quyết nhiệm vụ canonical của việc sửa đổi sự thật "Tháp Eiffel ở Paris, Pháp" thành "Tháp Eiffel ở Rome, Ý" trong mô hình. Phương pháp của chúng tôi bắt đầu với việc xác định hoạt động nơ-ron liên quan đến sự thật này sử dụng LAT. Chúng tôi thu thập tập kích thích bằng cách hướng dẫn mô hình tạo ra câu liên quan đến sự thật gốc, "Tháp Eiffel ở Paris," và sử dụng những câu này làm kích thích cho nhiệm vụ tham chiếu. Tiếp theo, chúng tôi đơn giản thay thế từ "Paris" bằng "Rome" trong những kích thích này cho nhiệm vụ thí nghiệm. Mẫu nhiệm vụ của chúng tôi được hiển thị trong Phụ lục D.1.13. Ở đây, các token thí nghiệm và tham chiếu tương ứng với "Rome, Italy" và "Paris, France" tương ứng. Chúng tôi áp dụng toán tử tổ hợp tuyến tính với hệ số dương sử dụng các vectơ đọc LAT để tạo ra những sửa đổi này. Chúng tôi cung cấp bằng chứng cho hiệu ứng phản thực của các vectơ của chúng tôi trong Hình 21. Ví dụ thứ hai trong hình chứng minh khả năng của mô hình tổng quát hóa dưới các hình thức hỏi khác nhau và duy trì tính cụ thể, vì vị trí cho Bảo tàng Louvre vẫn ở Paris.

6.4.2 CÁC KHÁI NIỆM KHÔNG SỐ

Trong phần này, chúng tôi hướng đến việc minh họa tiềm năng trích xuất các khái niệm và ý nghĩ không số. Như một ví dụ, chúng tôi tập trung vào việc trích xuất hoạt động nơ-ron liên quan đến khái niệm "chó." Cho điều tra này, chúng tôi sử dụng tập dữ liệu điều chỉnh hướng dẫn Alpaca tiêu chuẩn làm kích thích của chúng tôi. Chúng tôi sử dụng mẫu nhiệm vụ LAT (Phụ lục D.1.14) để thu thập hoạt động nơ-ron cho nhiệm vụ thí nghiệm. Trong mẫu nhiệm vụ tham chiếu, chúng tôi bỏ qua hướng dẫn liên quan đến chó. Một lần nữa, chúng tôi chứng minh tác động phản thực của các vectơ đọc thu được thông qua LAT đối với hành vi mô hình bằng cách kiểm soát mô hình để kích hoạt và ức chế khái niệm chó trong quá trình tạo ra trong Hình 21.

--- TRANG 27 ---

[Hình ảnh về Chỉnh sửa Sự thật và Kiểm soát Khái niệm Không số]

Hình 21: Chúng tôi chứng minh khả năng thực hiện chỉnh sửa mô hình thông qua kiểm soát biểu diễn. Ở bên trái, chúng tôi chỉnh sửa sự thật "Tháp Eiffel nằm ở Paris" thành "Tháp Eiffel nằm ở Rome." Việc suy luận chính xác rằng Tháp Eiffel và Bảo tàng Louvre không ở cùng vị trí thể hiện tính tổng quát và cụ thể. Ở bên phải, chúng tôi thành công tăng hoặc ức chế xu hướng của mô hình tạo ra văn bản liên quan đến khái niệm chó.

6.5 GHI NHỚ

Nhiều nghiên cứu đã chứng minh tính khả thi của việc trích xuất dữ liệu huấn luyện từ LLM và mô hình khuếch tán (Carlini et al., 2021; 2023; Hu et al., 2022). Những mô hình này có thể ghi nhớ một phần đáng kể dữ liệu huấn luyện của chúng, làm dấy lên mối lo ngại về vi phạm tiềm tàng nội dung bí mật hoặc có bản quyền. Trong phần sau, chúng tôi trình bày khám phá ban đầu trong lĩnh vực ghi nhớ mô hình với RepE.

6.5.1 PHÁT HIỆN DỮ LIỆU ĐƯỢC GHI NHỚ

Chúng ta có thể sử dụng hoạt động nơ-ron của LLM để phân loại liệu nó có ghi nhớ một đoạn văn bản hay không? Để điều tra điều này, chúng tôi tiến hành quét LAT dưới hai thiết lập riêng biệt:

1. Trích dẫn Phổ biến so với Tổng hợp: Trích dẫn phổ biến bao gồm những câu trích dẫn nổi tiếng được lấy từ internet và văn hóa con người. Những trích dẫn này cho phép chúng ta đánh giá việc ghi nhớ các đoạn văn bản ngắn gọn, có tác động cao. Như tập tham chiếu, chúng tôi gợi ý GPT-4 tạo ra trích dẫn tổng hợp.

2. Khởi đầu Văn học Phổ biến so với Tổng hợp: Khởi đầu văn học phổ biến đề cập đến những dòng hoặc đoạn văn mở đầu từ sách, vở kịch hoặc bài thơ mang tính biểu tượng. Những khởi đầu này cho phép chúng ta đánh giá việc ghi nhớ các đoạn trích văn bản dài hơn. Như tập tham chiếu, chúng tôi gợi ý GPT-4 tạo ra khởi đầu văn học tổng hợp, được mô hình theo phong cách và cấu trúc của các khởi đầu đã biết.

Sử dụng những tập dữ liệu ghép cặp này làm kích thích, chúng tôi tiến hành quét LAT để phân biệt các hướng trong không gian biểu diễn của mô hình báo hiệu việc ghi nhớ trong hai thiết lập riêng biệt. Vì kích thích thí nghiệm bao gồm văn bản có khả năng được ghi nhớ đã gợi ra hành vi mục tiêu của chúng ta, mẫu LAT không bao gồm văn bản bổ sung. Khi đánh giá sử dụng tập dữ liệu giữ lại, chúng tôi quan sát rằng các hướng được xác định bởi LAT thể hiện độ chính xác cao khi phân loại trích dẫn và khởi đầu văn học phổ biến và không phổ biến. Để kiểm tra khả năng tổng quát hóa của các hướng ghi nhớ, chúng tôi áp dụng các hướng thu được trong một ngữ cảnh cho ngữ cảnh khác. Đáng chú ý là, cả hai hướng đều chuyển giao tốt sang ngữ cảnh ngoài phân phối khác, chứng minh rằng những hướng này duy trì tương quan mạnh với các thuộc tính của việc ghi nhớ.

--- TRANG 28 ---

[Bảng hiển thị hiệu quả của kiểm soát biểu diễn trong việc giảm đầu ra được ghi nhớ]

Bảng 7: Chúng tôi chứng minh hiệu quả của việc sử dụng kiểm soát biểu diễn để giảm đầu ra được ghi nhớ từ mô hình LLaMA-2-13B trên nhiệm vụ hoàn thành trích dẫn phổ biến. Khi kiểm soát với vectơ ngẫu nhiên hoặc hướng dẫn theo hướng ghi nhớ, tỷ lệ Khớp Chính xác (EM) và Độ tương tự Nhúng (SIM) không thay đổi đáng kể. Khi được kiểm soát để giảm ghi nhớ, các metric tương tự giảm đáng kể khi mô hình ít nôn ra các trích dẫn phổ biến hơn.

6.5.2 NGĂN CHẶN ĐẦU RA ĐƯỢC GHI NHỚ

Ở đây, chúng tôi khám phá liệu các vectơ đọc được xác định ở trên có thể được sử dụng để kiểm soát hành vi ghi nhớ hay không. Để đánh giá liệu chúng ta có thể ngăn chặn mô hình nôn ra văn bản được ghi nhớ, chúng tôi manually curate tập dữ liệu chứa hơn 100 trích dẫn nổi tiếng được hoàn thành một phần (không được sử dụng để trích xuất các vectơ đọc), được ghép cặp với các phần hoàn thành thực tương ứng làm nhãn. Trong trạng thái không thay đổi, mô hình sao chép hơn 90% những trích dẫn này nguyên văn. Theo Phần 3.2, chúng tôi tiến hành thí nghiệm kiểm soát bằng cách tạo ra các phần hoàn thành khi áp dụng biến đổi tổ hợp tuyến tính với hệ số âm sử dụng các vectơ đọc từ phần trước. Ngoài ra, chúng tôi giới thiệu hai điểm so sánh bằng cách thêm cùng các vectơ đọc hoặc sử dụng các vectơ với các thành phần được xáo trộn ngẫu nhiên. Điểm Khớp Chính xác và Độ tương tự Nhúng cao được trình bày trong Bảng 7 chỉ ra rằng việc sử dụng vectơ ngẫu nhiên hoặc thêm hướng ghi nhớ có tác động tối thiểu đến xu hướng của mô hình lặp lại các trích dẫn phổ biến. Ngược lại, khi chúng tôi trừ các hướng ghi nhớ khỏi mô hình, có sự suy giảm đáng kể trong điểm tương tự, hiệu quả hướng dẫn mô hình tạo ra nội dung được ghi nhớ chính xác với tần suất giảm.

Để đảm bảo rằng nỗ lực kiểm soát ghi nhớ của chúng tôi không vô tình làm tổn hại kiến thức của mô hình, chúng tôi tạo ra tập đánh giá các sự kiện lịch sử nổi tiếng. Điều này đo lường trình độ của mô hình trong việc xác định chính xác các năm liên quan đến các sự kiện lịch sử cụ thể. Mô hình giảm ghi nhớ cho thấy sự suy giảm hiệu suất không đáng kể trong nhiệm vụ này, với độ chính xác 97.2% trước khi trừ hướng ghi nhớ và 96.2% sau đó. Những kết quả này cho thấy rằng vectơ đọc được xác định tương ứng với việc ghi nhớ máy móc các văn bản hoặc đoạn văn cụ thể, thay vì kiến thức thế giới. Do đó, RepE có thể cung cấp các hướng hứa hẹn để giảm việc ghi nhớ không mong muốn trong LLM.

7 KẾT LUẬN

Chúng tôi đã khám phá kỹ thuật biểu diễn (RepE), một phương pháp tiếp cận minh bạch từ trên xuống cho các hệ thống AI. Được truyền cảm hứng bởi quan điểm Hopfieldian trong khoa học thần kinh nhận thức, RepE đặt biểu diễn và các biến đổi giữa chúng làm trung tâm phân tích. Khi mạng nơ-ron thể hiện cấu trúc nội tại mạch lạc hơn, chúng tôi tin rằng việc phân tích chúng ở cấp độ biểu diễn có thể mang lại những hiểu biết mới, hỗ trợ trong việc giám sát và kiểm soát hiệu quả. Thực hiện các bước đầu tiên theo hướng này, chúng tôi đã đề xuất các phương pháp RepE mới, đạt được tiên tiến nhất trên TruthfulQA, và chúng tôi đã chứng minh cách RepE có thể cung cấp lực kéo trên một loạt rộng các vấn đề liên quan đến an toàn. Mặc dù chúng tôi chủ yếu phân tích các không gian con của biểu diễn, công trình tương lai có thể điều tra quỹ đạo, đa tạp, và không gian trạng thái của biểu diễn. Chúng tôi hy vọng rằng bước đầu tiên này trong việc khám phá tiềm năng của RepE giúp thúc đẩy những hiểu biết mới về việc hiểu và kiểm soát các hệ thống AI, cuối cùng đảm bảo rằng các hệ thống AI tương lai đáng tin cậy và an toàn.

--- TRANG 29 ---

TÀI LIỆU THAM KHẢO

[Các tài liệu tham khảo được liệt kê theo thứ tự alphabet từ Julius Adebayo đến Andy Zou, bao gồm các nghiên cứu về học máy, AI, khoa học thần kinh, và các lĩnh vực liên quan]
