# 1812.02402.pdf
# ÄÃ£ chuyá»ƒn Ä‘á»•i tá»« PDF sang TXT  
# ÄÆ°á»ng dáº«n nguá»“n: /home/admin88/arxiv-downloader/pruning/1812.02402.pdf
# KÃ­ch thÆ°á»›c tá»‡p: 576259 bytes

===============================================
Ná»˜I DUNG Tá»†P PDF
===============================================


--- TRANG 1 ---
Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n cho Máº¡ng NÆ¡-ron SÃ¢u 
Hiá»‡u Quáº£
Yuhui Xu1, Yuxi Li1, Shuai Zhang2, Wei Wen3, Botao Wang2, Wenrui Dai1, Yingyong Qi2, Yiran
Chen3, Weiyao Lin1vÃ  Hongkai Xiong1
1Äáº¡i há»c Giao thÃ´ng ThÆ°á»£ng Háº£i, Email: {yuhuixu, lyxok1, daiwenrui, wylin,
xionghongkai}@sjtu.edu.cn
2NghiÃªn cá»©u AI Qualcomm, Email: {shuazhan, botaow, yingyong}@qti.qualcomm.com
3Äáº¡i há»c Duke, Email: {wei.wen, yiran.chen}@duke.edu
TÃ³m táº¯t
Äá»ƒ tÄƒng tá»‘c suy luáº­n DNN, xáº¥p xá»‰ thá»© háº¡ng tháº¥p Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng rá»™ng rÃ£i
vÃ¬ cÆ¡ sá»Ÿ lÃ½ thuyáº¿t vá»¯ng cháº¯c vÃ  cÃ¡c triá»ƒn khai hiá»‡u quáº£ cá»§a nÃ³. Má»™t sá»‘
cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y Ä‘Ã£ cá»‘ gáº¯ng trá»±c tiáº¿p xáº¥p xá»‰ má»™t mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c báº±ng
phÃ¢n rÃ£ thá»© háº¡ng tháº¥p; tuy nhiÃªn, cÃ¡c lá»—i xáº¥p xá»‰ nhá» trong tham sá»‘ cÃ³ thá»ƒ lan rá»™ng
thÃ nh má»™t máº¥t mÃ¡t dá»± Ä‘oÃ¡n lá»›n. RÃµ rÃ ng, viá»‡c tÃ¡ch riÃªng xáº¥p xá»‰ thá»© háº¡ng tháº¥p
khá»i huáº¥n luyá»‡n lÃ  khÃ´ng tá»‘i Æ°u. KhÃ´ng giá»‘ng nhÆ° cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y, bÃ i bÃ¡o nÃ y tÃ­ch há»£p xáº¥p xá»‰ thá»© háº¡ng tháº¥p
vÃ  chÃ­nh quy hÃ³a vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n. ChÃºng tÃ´i Ä‘á» xuáº¥t Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n (TRP), 
luÃ¢n phiÃªn giá»¯a xáº¥p xá»‰ thá»© háº¡ng tháº¥p vÃ  huáº¥n
luyá»‡n. TRP duy trÃ¬ kháº£ nÄƒng cá»§a máº¡ng gá»‘c trong khi Ã¡p Ä‘áº·t cÃ¡c rÃ ng buá»™c thá»© háº¡ng tháº¥p
trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Má»™t chÃ­nh quy hÃ³a háº¡t nhÃ¢n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a báº±ng
gradient con ngáº«u nhiÃªn Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thÃºc Ä‘áº©y thÃªm thá»© háº¡ng tháº¥p trong TRP. CÃ¡c máº¡ng Ä‘Æ°á»£c huáº¥n luyá»‡n
vá»›i TRP cÃ³ cáº¥u trÃºc thá»© háº¡ng tháº¥p theo báº£n cháº¥t, vÃ  Ä‘Æ°á»£c xáº¥p xá»‰ vá»›i máº¥t mÃ¡t hiá»‡u suáº¥t
khÃ´ng Ä‘Ã¡ng ká»ƒ, do Ä‘Ã³ loáº¡i bá» viá»‡c tinh chá»‰nh sau xáº¥p xá»‰ thá»© háº¡ng tháº¥p. PhÆ°Æ¡ng phÃ¡p
Ä‘á» xuáº¥t Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ toÃ n diá»‡n trÃªn CIFAR-10 vÃ  ImageNet, vÆ°á»£t trá»™i hÆ¡n
cÃ¡c Ä‘á»‘i tÃ¡c nÃ©n trÆ°á»›c Ä‘Ã¢y sá»­ dá»¥ng xáº¥p xá»‰ thá»© háº¡ng tháº¥p. MÃ£ cá»§a chÃºng tÃ´i cÃ³ sáºµn táº¡i: https://github.com/yuhuixu1993/Trained-Rank-Pruning.
1 Giá»›i thiá»‡u
Máº¡ng NÆ¡-ron SÃ¢u (DNN) Ä‘Ã£ cho tháº¥y thÃ nh cÃ´ng Ä‘Ã¡ng chÃº Ã½ trong nhiá»u nhiá»‡m vá»¥ thá»‹ giÃ¡c mÃ¡y tÃ­nh
nhÆ° phÃ¢n loáº¡i hÃ¬nh áº£nh [8], phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng [15] vÃ  phÃ¢n Ä‘oáº¡n ngá»¯ nghÄ©a [3]. Máº·c dÃ¹ cÃ³
hiá»‡u suáº¥t cao trong cÃ¡c DNN lá»›n Ä‘Æ°á»£c há»— trá»£ bá»Ÿi pháº§n cá»©ng tÃ­nh toÃ¡n song song tiÃªn tiáº¿n, háº§u háº¿t
cÃ¡c kiáº¿n trÃºc máº¡ng hiá»‡n Ä‘áº¡i khÃ´ng phÃ¹ há»£p cho viá»‡c sá»­ dá»¥ng cÃ³ háº¡n cháº¿ tÃ i nguyÃªn nhÆ° sá»­ dá»¥ng
trÃªn cÃ¡c thiáº¿t bá»‹ luÃ´n báº­t, thiáº¿t bá»‹ cáº¥p tháº¥p cháº¡y báº±ng pin, do nhá»¯ng háº¡n cháº¿ vá» nÄƒng lá»±c
tÃ­nh toÃ¡n, bá»™ nhá»› vÃ  Ä‘iá»‡n nÄƒng.
Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¢n rÃ£ thá»© háº¡ng tháº¥p [6,10,7,17,1] Ä‘Ã£ Ä‘Æ°á»£c Ä‘á» xuáº¥t
Ä‘á»ƒ giáº£m thiá»ƒu sá»± dÆ° thá»«a theo kÃªnh vÃ  khÃ´ng gian báº±ng cÃ¡ch phÃ¢n rÃ£ máº¡ng gá»‘c thÃ nh má»™t
máº¡ng nhá» gá»n vá»›i cÃ¡c lá»›p thá»© háº¡ng tháº¥p. KhÃ¡c vá»›i cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y, bÃ i bÃ¡o nÃ y Ä‘á» xuáº¥t má»™t phÆ°Æ¡ng phÃ¡p
má»›i Ä‘á»ƒ thiáº¿t káº¿ cÃ¡c máº¡ng thá»© háº¡ng tháº¥p.
CÃ¡c máº¡ng thá»© háº¡ng tháº¥p cÃ³ thá»ƒ Ä‘Æ°á»£c huáº¥n luyá»‡n trá»±c tiáº¿p tá»« Ä‘áº§u. Tuy nhiÃªn, ráº¥t khÃ³ Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c
káº¿t quáº£ thá»a Ä‘Ã¡ng vÃ¬ má»™t sá»‘ lÃ½ do. (1) Kháº£ nÄƒng tháº¥p: So vá»›i máº¡ng Ä‘áº§y Ä‘á»§ thá»© háº¡ng gá»‘c, 
kháº£ nÄƒng cá»§a máº¡ng thá»© háº¡ng tháº¥p bá»‹ háº¡n cháº¿, gÃ¢y ra khÃ³ khÄƒn trong viá»‡c tá»‘i Æ°u hÃ³a hiá»‡u suáº¥t cá»§a nÃ³.
(2)Cáº¥u trÃºc sÃ¢u: PhÃ¢n rÃ£ thá»© háº¡ng tháº¥p thÆ°á»ng lÃ m tÄƒng gáº¥p Ä‘Ã´i sá»‘ lÆ°á»£ng lá»›p trong máº¡ng.
CÃ¡c lá»›p bá»• sung lÃ m cho tá»‘i Æ°u hÃ³a sá»‘ trá»Ÿ nÃªn khÃ³ khÄƒn hÆ¡n nhiá»u do gradient bÃ¹ng ná»•
vÃ /hoáº·c biáº¿n máº¥t. (3) Lá»±a chá»n thá»© háº¡ng: Thá»© háº¡ng cá»§a máº¡ng Ä‘Æ°á»£c phÃ¢n rÃ£ thÆ°á»ng Ä‘Æ°á»£c chá»n nhÆ° má»™t
33rd Conference on Neural Information Processing Systems (NeurIPS 2019), Vancouver, Canada.arXiv:1812.02402v3  [cs.CV]  23 Jan 2020

--- TRANG 2 ---
siÃªu tham sá»‘ dá»±a trÃªn cÃ¡c máº¡ng Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c; cÃ³ thá»ƒ khÃ´ng pháº£i lÃ  thá»© háº¡ng tá»‘i Æ°u cho máº¡ng
Ä‘Æ°á»£c huáº¥n luyá»‡n tá»« Ä‘áº§u.
Thay vÃ o Ä‘Ã³, má»™t sá»‘ cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y [18,7,10] Ä‘Ã£ cá»‘ gáº¯ng phÃ¢n rÃ£ cÃ¡c mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c Ä‘á»ƒ
cÃ³ Ä‘Æ°á»£c cÃ¡c máº¡ng thá»© háº¡ng tháº¥p ban Ä‘áº§u. Tuy nhiÃªn, thá»© háº¡ng tháº¥p Ä‘Æ°á»£c Ã¡p Ä‘áº·t theo kinh nghiá»‡m cÃ³ thá»ƒ gÃ¢y ra
máº¥t mÃ¡t Ä‘á»™ chÃ­nh xÃ¡c lá»›n vÃ  cáº§n huáº¥n luyá»‡n láº¡i máº¡ng Ä‘á»ƒ khÃ´i phá»¥c hiá»‡u suáº¥t cá»§a máº¡ng gá»‘c
nhiá»u nháº¥t cÃ³ thá»ƒ. Má»™t sá»‘ ná»— lá»±c Ä‘Ã£ Ä‘Æ°á»£c thá»±c hiá»‡n Ä‘á»ƒ sá»­ dá»¥ng chÃ­nh quy hÃ³a thÆ°a thá»›t [17,4] Ä‘á»ƒ rÃ ng buá»™c
máº¡ng vÃ o khÃ´ng gian thá»© háº¡ng tháº¥p. Máº·c dÃ¹ chÃ­nh quy hÃ³a thÆ°a thá»›t giáº£m lá»—i gÃ¢y ra bá»Ÿi
phÃ¢n rÃ£ á»Ÿ má»™t má»©c Ä‘á»™ nÃ o Ä‘Ã³, hiá»‡u suáº¥t váº«n giáº£m nhanh chÃ³ng khi tá»· lá»‡ nÃ©n tÄƒng.
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t phÆ°Æ¡ng phÃ¡p má»›i, Ä‘Æ°á»£c gá»i lÃ  Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n (TRP), Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c máº¡ng thá»© háº¡ng tháº¥p. ChÃºng tÃ´i nhÃºng phÃ¢n rÃ£ thá»© háº¡ng tháº¥p vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n báº±ng cÃ¡ch dáº§n dáº§n Ä‘áº©y
phÃ¢n phá»‘i trá»ng sá»‘ cá»§a má»™t máº¡ng hoáº¡t Ä‘á»™ng tá»‘t vÃ o dáº¡ng thá»© háº¡ng tháº¥p, trong Ä‘Ã³ táº¥t cáº£ cÃ¡c tham sá»‘ cá»§a
máº¡ng gá»‘c Ä‘Æ°á»£c giá»¯ vÃ  tá»‘i Æ°u hÃ³a Ä‘á»ƒ duy trÃ¬ kháº£ nÄƒng cá»§a nÃ³. ChÃºng tÃ´i cÅ©ng Ä‘á» xuáº¥t má»™t
chÃ­nh quy hÃ³a háº¡t nhÃ¢n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a báº±ng gradient con ngáº«u nhiÃªn Ä‘á»ƒ rÃ ng buá»™c thÃªm cÃ¡c trá»ng sá»‘ trong khÃ´ng gian thá»© háº¡ng tháº¥p nháº±m tÄƒng cÆ°á»ng TRP. Giáº£i phÃ¡p Ä‘á» xuáº¥t Ä‘Æ°á»£c minh há»a trong HÃ¬nh 1.
NhÃ¬n chung, cÃ¡c Ä‘Ã³ng gÃ³p cá»§a chÃºng tÃ´i Ä‘Æ°á»£c tÃ³m táº¯t dÆ°á»›i Ä‘Ã¢y.
1.Má»™t phÆ°Æ¡ng phÃ¡p huáº¥n luyá»‡n má»›i Ä‘Æ°á»£c gá»i lÃ  TRP Ä‘Æ°á»£c trÃ¬nh bÃ y báº±ng cÃ¡ch nhÃºng rÃµ rÃ ng
phÃ¢n rÃ£ thá»© háº¡ng tháº¥p vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n máº¡ng;
2.Má»™t chÃ­nh quy hÃ³a háº¡t nhÃ¢n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a báº±ng gradient con ngáº«u nhiÃªn Ä‘á»ƒ tÄƒng cÆ°á»ng hiá»‡u suáº¥t
cá»§a TRP;
3.Cáº£i thiá»‡n tÄƒng tá»‘c suy luáº­n vÃ  giáº£m máº¥t mÃ¡t Ä‘á»™ chÃ­nh xÃ¡c xáº¥p xá»‰ trong cáº£ phÆ°Æ¡ng phÃ¡p phÃ¢n rÃ£
theo kÃªnh vÃ  theo khÃ´ng gian.
ğ‘˜ğ‘¤ğ‘˜â„ğ¶ğ‘˜ğ‘¤ğ‘˜â„ğ¶
ğ‘˜ğ‘¤ğ‘˜â„ğ¶Luá»“ng Ä‘áº·c trÆ°ng
Luá»“ng gradient
Xáº¥p xá»‰ thá»© háº¡ng tháº¥p
Thay tháº¿
â€¦â€¦
â€¦ğ‘Šğ‘¡
ğ‘‡ğ‘§
ğ‘Šğ‘¡
ï¼ˆaï¼‰ ï¼ˆbï¼‰
HÃ¬nh 1: QuÃ¡ trÃ¬nh huáº¥n luyá»‡n TRP bao gá»“m hai pháº§n nhÆ° Ä‘Æ°á»£c minh há»a trong (a) vÃ  (b). (a) Má»™t láº§n láº·p bÃ¬nh thÆ°á»ng vá»›i
truyá»n tiáº¿n-lÃ¹i vÃ  cáº­p nháº­t trá»ng sá»‘. (b) Má»™t láº§n láº·p huáº¥n luyá»‡n Ä‘Æ°á»£c chÃ¨n bá»Ÿi cáº¯t tá»‰a thá»© háº¡ng, trong Ä‘Ã³
xáº¥p xá»‰ thá»© háº¡ng tháº¥p Ä‘Æ°á»£c Ã¡p dá»¥ng trÆ°á»›c trÃªn cÃ¡c bá»™ lá»c hiá»‡n táº¡i trÆ°á»›c khi tÃ­ch cháº­p. Trong quÃ¡ trÃ¬nh lan truyá»n ngÆ°á»£c, cÃ¡c
gradient Ä‘Æ°á»£c cá»™ng trá»±c tiáº¿p trÃªn cÃ¡c bá»™ lá»c thá»© háº¡ng tháº¥p vÃ  cÃ¡c trá»ng sá»‘ gá»‘c Ä‘Æ°á»£c thay tháº¿ báº±ng cÃ¡c bá»™ lá»c thá»© háº¡ng tháº¥p
Ä‘Ã£ cáº­p nháº­t. (b) Ä‘Æ°á»£c Ã¡p dá»¥ng má»™t láº§n má»—i mláº§n láº·p (tá»©c lÃ  khi láº§n láº·p cáº­p nháº­t gradient t=zm; z = 0;1;2;  ),
ngÆ°á»£c láº¡i (a) Ä‘Æ°á»£c Ã¡p dá»¥ng.
2 PhÆ°Æ¡ng phÃ¡p
2.1 Kiáº¿n thá»©c cÆ¡ báº£n
ChÃ­nh thá»©c, cÃ¡c bá»™ lá»c tÃ­ch cháº­p trong má»™t lá»›p cÃ³ thá»ƒ Ä‘Æ°á»£c kÃ½ hiá»‡u báº±ng tensor W2Rnckwkh, trong Ä‘Ã³ n
vÃ  c lÃ  sá»‘ lÆ°á»£ng bá»™ lá»c vÃ  kÃªnh Ä‘áº§u vÃ o, kh vÃ  kw lÃ  chiá»u cao vÃ  chiá»u rá»™ng cá»§a cÃ¡c bá»™ lá»c.
Má»™t Ä‘áº§u vÃ o cá»§a lá»›p tÃ­ch cháº­p Fi2Rcxy táº¡o ra má»™t Ä‘áº§u ra lÃ  Fo=WFi. TÆ°Æ¡ng quan
theo kÃªnh [18] vÃ  tÆ°Æ¡ng quan theo khÃ´ng gian [10] Ä‘Æ°á»£c khÃ¡m phÃ¡ Ä‘á»ƒ xáº¥p xá»‰ cÃ¡c bá»™ lá»c tÃ­ch cháº­p trong
khÃ´ng gian thá»© háº¡ng tháº¥p. Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i táº­p trung vÃ o hai sÆ¡ Ä‘á»“ phÃ¢n rÃ£ nÃ y. Tuy nhiÃªn, khÃ´ng giá»‘ng nhÆ°
cÃ¡c cÃ´ng trÃ¬nh trÆ°á»›c Ä‘Ã¢y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t sÆ¡ Ä‘á»“ huáº¥n luyá»‡n má»›i TRP Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c máº¡ng thá»© háº¡ng tháº¥p mÃ  khÃ´ng cáº§n
huáº¥n luyá»‡n láº¡i sau phÃ¢n rÃ£.
2

--- TRANG 3 ---
2.2 Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n
ChÃºng tÃ´i Ä‘á» xuáº¥t má»™t sÆ¡ Ä‘á»“ huáº¥n luyá»‡n Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£ Ä‘Æ°á»£c gá»i lÃ  Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n (TRP) theo
cÃ¡ch tuáº§n hoÃ n:
Wt+1=
WtOf(Wt)t%m6= 0
TzOf(Tz)t%m= 0
Tz=D(Wt); z =t=m(1)
trong Ä‘Ã³ D() lÃ  toÃ¡n tá»­ xáº¥p xá»‰ tensor thá»© háº¡ng tháº¥p, lÃ  tá»‘c Ä‘á»™ há»c, t chá»‰ má»¥c láº§n láº·p
vÃ  z lÃ  láº§n láº·p cá»§a toÃ¡n tá»­ D, vá»›i m lÃ  chu ká»³ cho xáº¥p xá»‰ thá»© háº¡ng tháº¥p.
ChÃºng tÃ´i Ã¡p dá»¥ng xáº¥p xá»‰ thá»© háº¡ng tháº¥p má»—i m láº§n láº·p SGD. Äiá»u nÃ y tiáº¿t kiá»‡m thá»i gian huáº¥n luyá»‡n ráº¥t nhiá»u.
NhÆ° Ä‘Æ°á»£c minh há»a trong HÃ¬nh 1, má»—i m láº§n láº·p, chÃºng tÃ´i thá»±c hiá»‡n xáº¥p xá»‰ thá»© háº¡ng tháº¥p trÃªn cÃ¡c
bá»™ lá»c gá»‘c, trong khi cÃ¡c gradient Ä‘Æ°á»£c cáº­p nháº­t trÃªn dáº¡ng thá»© háº¡ng tháº¥p káº¿t quáº£. NgÆ°á»£c láº¡i, máº¡ng
Ä‘Æ°á»£c cáº­p nháº­t thÃ´ng qua SGD bÃ¬nh thÆ°á»ng. SÆ¡ Ä‘á»“ huáº¥n luyá»‡n cá»§a chÃºng tÃ´i cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i cÃ¡c toÃ¡n tá»­ thá»© háº¡ng tháº¥p
tÃ¹y Ã½. Trong cÃ´ng trÃ¬nh Ä‘á» xuáº¥t, chÃºng tÃ´i chá»n cÃ¡c ká»¹ thuáº­t thá»© háº¡ng tháº¥p Ä‘Æ°á»£c Ä‘á» xuáº¥t trong [10] vÃ  [18], cáº£ hai
Ä‘á»u biáº¿n Ä‘á»•i cÃ¡c bá»™ lá»c 4 chiá»u thÃ nh ma tráº­n 2D vÃ  sau Ä‘Ã³ Ã¡p dá»¥ng phÃ¢n rÃ£ giÃ¡ trá»‹ Ä‘Æ¡n cáº¯t ngáº¯n
(TSVD). SVD cá»§a ma tráº­n Wt cÃ³ thá»ƒ Ä‘Æ°á»£c viáº¿t nhÆ°:
Wt=rank (Wt)X
i=1iUi(Vi)T; (2)
trong Ä‘Ã³ i lÃ  giÃ¡ trá»‹ Ä‘Æ¡n cá»§a Wt vá»›i 12rank (Wt), vÃ  Ui vÃ  Vi lÃ  cÃ¡c
vector Ä‘Æ¡n. TSVD Ä‘Æ°á»£c tham sá»‘ hÃ³a ( Wt;e) lÃ  Ä‘á»ƒ tÃ¬m sá»‘ nguyÃªn nhá» nháº¥t k sao cho
rank (Wt)X
j=k+1(j)2erank (Wt)X
i=1(i)2; (3)
trong Ä‘Ã³ e2(0;1) lÃ  siÃªu tham sá»‘ Ä‘Æ°á»£c Ä‘á»‹nh trÆ°á»›c cá»§a tá»· lá»‡ báº£o toÃ n nÄƒng lÆ°á»£ng. Sau khi cáº¯t ngáº¯n
n-k giÃ¡ trá»‹ Ä‘Æ¡n cuá»‘i cÃ¹ng, chÃºng tÃ´i biáº¿n Ä‘á»•i ma tráº­n 2D thá»© háº¡ng tháº¥p trá»Ÿ láº¡i tensor 4D.
2.3 ChÃ­nh quy hÃ³a Chuáº©n Háº¡t nhÃ¢n
Chuáº©n háº¡t nhÃ¢n Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c bÃ i toÃ¡n hoÃ n thÃ nh ma tráº­n. Gáº§n Ä‘Ã¢y, nÃ³ Ä‘Æ°á»£c giá»›i thiá»‡u Ä‘á»ƒ rÃ ng buá»™c
máº¡ng vÃ o khÃ´ng gian thá»© háº¡ng tháº¥p trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n [1].
min(
f(x;w) +LX
l=1jjWljj)
(4)
trong Ä‘Ã³ f() lÃ  hÃ m máº¥t mÃ¡t má»¥c tiÃªu, chuáº©n háº¡t nhÃ¢n jjWljj Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a lÃ  jjWljj=Prank (Wl)
i=1i
l,
vá»›i i
l lÃ  cÃ¡c giÃ¡ trá»‹ Ä‘Æ¡n cá»§a Wl. lÃ  siÃªu tham sá»‘ thiáº¿t láº­p áº£nh hÆ°á»Ÿng cá»§a chuáº©n háº¡t nhÃ¢n.
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i sá»­ dá»¥ng gradient con ngáº«u nhiÃªn [2] Ä‘á»ƒ tá»‘i Æ°u hÃ³a chÃ­nh quy hÃ³a chuáº©n háº¡t nhÃ¢n
trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n. Gá»i W=UVT lÃ  SVD cá»§a W vÃ  gá»i Utru;Vtru lÃ  U;V Ä‘Æ°á»£c cáº¯t ngáº¯n
thÃ nh rank (W) cá»™t hoáº·c hÃ ng Ä‘áº§u tiÃªn, thÃ¬ UtruVT
tru lÃ  gradient con cá»§a jjWjj[16]. Do Ä‘Ã³,
gradient con cá»§a Eq. (4) trong má»™t lá»›p lÃ 
Of+UtruVT
tru: (5)
Chuáº©n háº¡t nhÃ¢n vÃ  hÃ m máº¥t mÃ¡t Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a Ä‘á»“ng thá»i trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n cá»§a cÃ¡c máº¡ng
vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p thÃªm vá»›i TRP Ä‘á» xuáº¥t.
3 ThÃ­ nghiá»‡m
3.1 Chi tiáº¿t Triá»ƒn khai
ChÃºng tÃ´i Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a sÆ¡ Ä‘á»“ TRP trÃªn hai bá»™ dá»¯ liá»‡u phá»• biáº¿n, CIFAR-10 [11] vÃ  ImageNet
[5]. ChÃºng tÃ´i triá»ƒn khai sÆ¡ Ä‘á»“ TRP vá»›i GPU NVIDIA 1080 Ti. Äá»ƒ huáº¥n luyá»‡n trÃªn CIFAR-10, chÃºng tÃ´i
3

--- TRANG 4 ---
MÃ´ hÃ¬nh ("R-" biá»ƒu thá»‹ ResNet-.) Top 1 ( %)TÄƒng tá»‘c
R-20 (cÆ¡ sá»Ÿ) 91.74 1.00
R-20 (TRP1) 90.12 1.97
R-20 (TRP1+Nu) 90.50 2.17
R-20 ([18]) 88.13 1.41
R-20 (TRP2) 90.13 2.66
R-20 (TRP2+Nu) 90.62 2.84
R-20 ([10]) 89.49 1.66
R-56 (cÆ¡ sá»Ÿ) 93.14 1.00
R-56 (TRP1) 92.77 2.31
R-56 (TRP1+Nu) 91.85 4.48
R-56 ([18]) 91.56 2.10
R-56 (TRP2) 92.63 2.43
R-56 (TRP2+Nu) 91.62 4.51
R-56 ([10]) 91.59 2.10
R-56 [9] 91.80 2.00
R-56 [12] 91.60 2.00
Báº£ng (2) Káº¿t quáº£ thÃ­ nghiá»‡m trÃªn CIFAR-10.PhÆ°Æ¡ng phÃ¡p Top1( %)TÄƒng tá»‘c
CÆ¡ sá»Ÿ 69.10 1.00
TRP1 65.46 1.81
TRP1+Nu 65.39 2.23
[18] 63.1 1.41
TRP2 65.51 2:60
TRP2+Nu 65.34 3.18
[10] 62.80 2.00
Báº£ng (3) Káº¿t quáº£ cá»§a ResNet-18 trÃªn ImageNet.
PhÆ°Æ¡ng phÃ¡p Top1( %)TÄƒng tá»‘c
CÆ¡ sá»Ÿ 75.90 1.00
TRP1+Nu 72.69 2.30
TRP1+Nu 74.06 1.80
[18] 71.80 1.50
[13] 72.04 1.58
[14] 72.03 2.26
Báº£ng (4) Káº¿t quáº£ cá»§a ResNet-50 trÃªn ImageNet.
báº¯t Ä‘áº§u vá»›i tá»‘c Ä‘á»™ há»c cÆ¡ sá»Ÿ 0:1 Ä‘á»ƒ huáº¥n luyá»‡n 164 epoch vÃ  giáº£m giÃ¡ trá»‹ Ä‘i 10 láº§n táº¡i
epoch thá»© 82 vÃ  thá»© 122. Äá»‘i vá»›i ImageNet, chÃºng tÃ´i trá»±c tiáº¿p tinh chá»‰nh mÃ´ hÃ¬nh vá»›i sÆ¡ Ä‘á»“ TRP tá»«
cÆ¡ sá»Ÿ Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c vá»›i tá»‘c Ä‘á»™ há»c 0:0001 trong 10 epoch. Äá»‘i vá»›i cáº£ hai bá»™ dá»¯ liá»‡u, chÃºng tÃ´i Ã¡p dá»¥ng
bá»™ giáº£i SGD Ä‘á»ƒ cáº­p nháº­t trá»ng sá»‘ vÃ  Ä‘áº·t giÃ¡ trá»‹ suy giáº£m trá»ng sá»‘ lÃ  104 vÃ  giÃ¡ trá»‹ momentum lÃ  0:9.
3.2 Káº¿t quáº£ trÃªn CIFAR-10
NhÆ° Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 2, Ä‘á»‘i vá»›i cáº£ phÃ¢n rÃ£ theo khÃ´ng gian (TRP1) vÃ  theo kÃªnh (TRP2), TRP
Ä‘á» xuáº¥t vÆ°á»£t trá»™i hÆ¡n cÃ¡c phÆ°Æ¡ng phÃ¡p cÆ¡ báº£n [18,10] trÃªn ResNet-20 vÃ  ResNet-56. Káº¿t quáº£ trá»Ÿ nÃªn
tá»‘t hÆ¡n khi sá»­ dá»¥ng chÃ­nh quy hÃ³a háº¡t nhÃ¢n. VÃ­ dá»¥, trong phÃ¢n rÃ£ theo kÃªnh
(TRP2) cá»§a ResNet-56, káº¿t quáº£ cá»§a TRP káº¿t há»£p vá»›i chÃ­nh quy hÃ³a háº¡t nhÃ¢n tháº­m chÃ­ cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™
tÄƒng tá»‘c gáº¥p 2 láº§n so vá»›i [18] vá»›i cÃ¹ng má»©c giáº£m Ä‘á»™ chÃ­nh xÃ¡c. PhÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cÅ©ng vÆ°á»£t trá»™i hÆ¡n viá»‡c cáº¯t tá»‰a bá»™ lá»c [12]
vÃ  cáº¯t tá»‰a kÃªnh [9]. VÃ­ dá»¥, TRP phÃ¢n rÃ£ kÃªnh Ä‘Æ°á»£c huáº¥n luyá»‡n ResNet-56 cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c
Ä‘á»™ chÃ­nh xÃ¡c 92:77% vá»›i tÄƒng tá»‘c 2:31, trong khi [9] lÃ  91:80% vÃ  [12] lÃ  91:60%. Vá»›i sá»± trá»£ giÃºp cá»§a
chÃ­nh quy hÃ³a háº¡t nhÃ¢n, cÃ¡c phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™ tÄƒng tá»‘c gáº¥p 2 láº§n so vá»›i [9] vÃ  [12] vá»›i
Ä‘á»™ chÃ­nh xÃ¡c cao hÆ¡n.
3.3 Káº¿t quáº£ trÃªn ImageNet
Káº¿t quáº£ trÃªn ImageNet Ä‘Æ°á»£c hiá»ƒn thá»‹ trong Báº£ng 3 vÃ  Báº£ng 4. Äá»‘i vá»›i ResNet-18, phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i vÆ°á»£t trá»™i hÆ¡n
cÃ¡c phÆ°Æ¡ng phÃ¡p cÆ¡ báº£n [18,10]. VÃ­ dá»¥, trong phÃ¢n rÃ£ theo kÃªnh, TRP Ä‘áº¡t Ä‘Æ°á»£c tá»‘c Ä‘á»™
tÄƒng tá»‘c 1.81 vá»›i Ä‘á»™ chÃ­nh xÃ¡c Top5 86.48% trÃªn ImageNet, vÆ°á»£t trá»™i hÆ¡n cáº£ phÆ°Æ¡ng phÃ¡p dá»±a trÃªn dá»¯ liá»‡u [18]1
vÃ  phÆ°Æ¡ng phÃ¡p Ä‘á»™c láº­p dá»¯ liá»‡u [18] vá»›i biÃªn Ä‘á»™ lá»›n. ChÃ­nh quy hÃ³a háº¡t nhÃ¢n cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™
tÄƒng tá»‘c vá»›i cÃ¹ng Ä‘á»™ chÃ­nh xÃ¡c.
Äá»‘i vá»›i ResNet-50, Ä‘á»ƒ xÃ¡c thá»±c tá»‘t hÆ¡n hiá»‡u quáº£ cá»§a phÆ°Æ¡ng phÃ¡p, chÃºng tÃ´i cÅ©ng so sÃ¡nh TRP
Ä‘á» xuáº¥t vá»›i [9] vÃ  [13]. Vá»›i tÄƒng tá»‘c 1:80, ResNet-50 Ä‘Æ°á»£c phÃ¢n rÃ£ cá»§a chÃºng tÃ´i cÃ³ thá»ƒ Ä‘áº¡t Ä‘Æ°á»£c Top1 73:97% vÃ 
Ä‘á»™ chÃ­nh xÃ¡c Top5 91:98% cao hÆ¡n nhiá»u so vá»›i [13]. TRP Ä‘áº¡t Ä‘Æ°á»£c tÄƒng tá»‘c 2:23 cao hÆ¡n
[9] vá»›i cÃ¹ng má»©c giáº£m Top5.
4 Káº¿t luáº­n
Trong bÃ i bÃ¡o nÃ y, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t sÆ¡ Ä‘á»“ má»›i Cáº¯t Tá»‰a Thá»© Háº¡ng ÄÆ°á»£c Huáº¥n Luyá»‡n (TRP) Ä‘á»ƒ huáº¥n luyá»‡n cÃ¡c máº¡ng thá»© háº¡ng tháº¥p.
NÃ³ táº­n dá»¥ng kháº£ nÄƒng vÃ  cáº¥u trÃºc cá»§a máº¡ng gá»‘c báº±ng cÃ¡ch nhÃºng xáº¥p xá»‰ thá»© háº¡ng tháº¥p
vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n. HÆ¡n ná»¯a, chÃºng tÃ´i Ä‘á» xuáº¥t chÃ­nh quy hÃ³a chuáº©n háº¡t nhÃ¢n Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a báº±ng gradient con ngáº«u nhiÃªn
Ä‘á»ƒ tÄƒng cÆ°á»ng TRP. TRP Ä‘á» xuáº¥t cÃ³ thá»ƒ Ä‘Æ°á»£c káº¿t há»£p vá»›i báº¥t ká»³ phÆ°Æ¡ng phÃ¡p phÃ¢n rÃ£ thá»© háº¡ng tháº¥p nÃ o.
TrÃªn cÃ¡c bá»™ dá»¯ liá»‡u CIFAR-10 vÃ  ImageNet, chÃºng tÃ´i Ä‘Ã£ chá»‰ ra ráº±ng cÃ¡c phÆ°Æ¡ng phÃ¡p cá»§a chÃºng tÃ´i cÃ³ thá»ƒ
vÆ°á»£t trá»™i hÆ¡n cÃ¡c phÆ°Æ¡ng phÃ¡p cÆ¡ báº£n trong cáº£ phÃ¢n rÃ£ theo kÃªnh vÃ  phÃ¢n rÃ£ theo khÃ´ng gian.
1triá»ƒn khai cá»§a [7]
4

--- TRANG 5 ---
TÃ i liá»‡u tham kháº£o
[1]J. M. Alvarez vÃ  M. Salzmann. Huáº¥n luyá»‡n nháº­n thá»©c nÃ©n cá»§a máº¡ng sÃ¢u. Trong NIPS , 2017.
[2]H. Avron, S. Kale, S. P. Kasiviswanathan, vÃ  V . Sindhwani. Giáº£m gradient con ngáº«u nhiÃªn
hiá»‡u quáº£ vÃ  thá»±c táº¿ cho chÃ­nh quy hÃ³a chuáº©n háº¡t nhÃ¢n. Trong ICML , 2012.
[3]L.-C. Chen, G. Papandreou, I. Kokkinos, K. Murphy, vÃ  A. L. Yuille. Deeplab: PhÃ¢n Ä‘oáº¡n
hÃ¬nh áº£nh ngá»¯ nghÄ©a vá»›i máº¡ng tÃ­ch cháº­p sÃ¢u, tÃ­ch cháº­p atrous, vÃ  crf Ä‘Æ°á»£c káº¿t ná»‘i Ä‘áº§y Ä‘á»§.
TPAMI , 40:834â€“848, 2018.
[4]W. Chen, J. Wilson, S. Tyree, K. Weinberger, vÃ  Y . Chen. NÃ©n máº¡ng nÆ¡-ron vá»›i
thá»§ thuáº­t bÄƒm. Trong ICML , 2015.
[5]J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, vÃ  L. Fei-Fei. Imagenet: CÆ¡ sá»Ÿ dá»¯ liá»‡u hÃ¬nh áº£nh
phÃ¢n cáº¥p quy mÃ´ lá»›n. CVPR , 2009.
[6]E. Denton, W. Zaremba, J. Bruna, Y . Lecun, vÃ  R. Fergus. Khai thÃ¡c cáº¥u trÃºc tuyáº¿n tÃ­nh trong
máº¡ng tÃ­ch cháº­p Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£. Trong NIPS , 2014.
[7]J. Guo, Y . Li, W. Lin, Y . Chen, vÃ  J. Li. TÃ¡ch rá»i máº¡ng: Tá»« tÃ­ch cháº­p thÃ´ng thÆ°á»ng Ä‘áº¿n
tÃ­ch cháº­p tÃ¡ch theo chiá»u sÃ¢u. Trong BMVC , 2018.
[8] K. He, X. Zhang, S. Ren, vÃ  J. Sun. Há»c tÃ n dÆ° sÃ¢u Ä‘á»ƒ nháº­n dáº¡ng hÃ¬nh áº£nh. 2016.
[9]Y . He, X. Zhang, vÃ  J. Sun. Cáº¯t tá»‰a kÃªnh Ä‘á»ƒ tÄƒng tá»‘c máº¡ng nÆ¡-ron ráº¥t sÃ¢u. Trong
ICCV , 2017.
[10] M. Jaderberg, A. Vedaldi, vÃ  A. Zisserman. TÄƒng tá»‘c máº¡ng nÆ¡-ron tÃ­ch cháº­p vá»›i
má»Ÿ rá»™ng thá»© háº¡ng tháº¥p. arXiv preprint arXiv:1405.3866 , 2014.
[11] A. Krizhevsky vÃ  G. Hinton. Há»c nhiá»u lá»›p Ä‘áº·c trÆ°ng tá»« hÃ¬nh áº£nh nhá». Khoa há»c MÃ¡y tÃ­nh , 2009.
[12] H. Li, A. Kadav, I. Durdanovic, H. Samet, vÃ  H. P. Graf. Cáº¯t tá»‰a bá»™ lá»c cho convnet
hiá»‡u quáº£. arXiv preprint arXiv:1608.08710 , 2016.
[13] J.-H. Luo, J. Wu, vÃ  W. Lin. Thinet: Má»™t phÆ°Æ¡ng phÃ¡p cáº¯t tá»‰a cáº¥p bá»™ lá»c Ä‘á»ƒ nÃ©n máº¡ng nÆ¡-ron sÃ¢u.
ICCV , 2017.
[14] J.-H. Luo, H. Zhang, H.-Y . Zhou, C.-W. Xie, J. Wu, vÃ  W. Lin. Thinet: cáº¯t tá»‰a bá»™ lá»c cnn cho
máº¡ng má»ng hÆ¡n. TPAMI , 2018.
[15] S. Ren, K. He, R. B. Girshick, vÃ  J. Sun. Faster r-cnn: HÆ°á»›ng tá»›i phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng thá»i gian thá»±c vá»›i
máº¡ng Ä‘á» xuáº¥t vÃ¹ng. TPAMI , 39:1137â€“1149, 2015.
[16] G. A. Watson. Äáº·c tÃ­nh cá»§a vi phÃ¢n con cá»§a má»™t sá»‘ chuáº©n ma tráº­n. Äáº¡i sá»‘ tuyáº¿n tÃ­nh
vÃ  cÃ¡c á»©ng dá»¥ng cá»§a nÃ³ , 170:33â€“45, 1992.
[17] W. Wen, C. Xu, C. Wu, Y . Wang, Y . Chen, vÃ  H. Li. Phá»‘i há»£p bá»™ lá»c cho máº¡ng nÆ¡-ron sÃ¢u
nhanh hÆ¡n. Trong ICCV , 2017.
[18] X. Zhang, J. Zou, K. He, vÃ  J. Sun. TÄƒng tá»‘c máº¡ng tÃ­ch cháº­p ráº¥t sÃ¢u cho
phÃ¢n loáº¡i vÃ  phÃ¡t hiá»‡n. TPAMI , 38(10):1943â€“1955, 2016.
5